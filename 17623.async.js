"use strict";(self.webpackChunkscene_pro=self.webpackChunkscene_pro||[]).push([[17623,66882],{92643:function(e,r,t){t.d(r,{Ch:function(){return _},EX:function(){return S},G:function(){return E},H0:function(){return D},Ht:function(){return R},K6:function(){return N},O:function(){return A},WC:function(){return L},Y3:function(){return x},_Y:function(){return I},_j:function(){return T},c9:function(){return H},gp:function(){return F},jQ:function(){return u},mj:function(){return G},nR:function(){return V},sJ:function(){return O},vG:function(){return Z},xr:function(){return k}});var n=t(53147),o=t(3480),i=t(28947),s=t(99574),a=t(73749),c=t(27583);function u(e){return"r"in e&&"g"in e&&"b"in e}function f(e){return"h"in e&&"s"in e&&"v"in e}function l(e){return"l"in e&&"a"in e&&"b"in e}function p(e){return"l"in e&&"c"in e&&"h"in e}const m=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],d=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function h(e,r){const t=[];let n,o;if(e[0].length!==r.length)throw new Error("dimensions do not match");const i=e.length,s=e[0].length;let a=0;for(n=0;n<i;n++){for(a=0,o=0;o<s;o++)a+=e[n][o]*r[o];t.push(a)}return t}function y(e){const r=[e.r/255,e.g/255,e.b/255].map((e=>e<=.04045?e/12.92:((e+.055)/1.055)**2.4)),t=h(m,r);return{x:100*t[0],y:100*t[1],z:100*t[2]}}function b(e){const r=h(d,[e.x/100,e.y/100,e.z/100]).map((e=>{const r=e<=.0031308?12.92*e:1.055*e**(1/2.4)-.055;return Math.min(1,Math.max(r,0))}));return{r:Math.round(255*r[0]),g:Math.round(255*r[1]),b:Math.round(255*r[2])}}function v(e){const r=[e.x/95.047,e.y/100,e.z/108.883].map((e=>e>(6/29)**3?e**(1/3):1/3*(29/6)**2*e+4/29));return{l:116*r[1]-16,a:500*(r[0]-r[1]),b:200*(r[1]-r[2])}}function M(e){const r=e.l,t=[(r+16)/116+e.a/500,(r+16)/116,(r+16)/116-e.b/200].map((e=>e>6/29?e**3:3*(6/29)**2*(e-4/29)));return{x:95.047*t[0],y:100*t[1],z:108.883*t[2]}}function g(e){return function(e){const r=e.l,t=e.a,n=e.b,o=Math.sqrt(t*t+n*n);let i=Math.atan2(n,t);return i=i>0?i:i+2*Math.PI,{l:r,c:o,h:i}}(v(y(e)))}function C(e){return b(M(function(e){const r=e.l,t=e.c,n=e.h;return{l:r,a:t*Math.cos(n),b:t*Math.sin(n)}}(e)))}function k(e){return u(e)?e:p(e)?C(e):l(e)?function(e){return b(M(e))}(e):function(e){return"x"in e&&"y"in e&&"z"in e}(e)?b(e):f(e)?function(e){const r=(e.h+360)%360/60,t=e.s/100,n=e.v/100*255,o=n*t,i=o*(1-Math.abs(r%2-1));let s;switch(Math.floor(r)){case 0:s={r:o,g:i,b:0};break;case 1:s={r:i,g:o,b:0};break;case 2:s={r:0,g:o,b:i};break;case 3:s={r:0,g:i,b:o};break;case 4:s={r:i,g:0,b:o};break;case 5:case 6:s={r:o,g:0,b:i};break;default:s={r:0,g:0,b:0}}return s.r=Math.round(s.r+n-o),s.g=Math.round(s.g+n-o),s.b=Math.round(s.b+n-o),s}(e):e}function I(e){return f(e)?e:function(e){const r=e.r,t=e.g,n=e.b,o=Math.max(r,t,n),i=o-Math.min(r,t,n);let s=o,a=0===i?0:o===r?(t-n)/i%6:o===t?(n-r)/i+2:(r-t)/i+4,c=0===i?0:i/s;return a<0&&(a+=6),a*=60,c*=100,s*=100/255,{h:a,s:c,v:s}}(k(e))}function x(e){return l(e)?e:function(e){return v(y(e))}(k(e))}function O(e){return p(e)?e:g(k(e))}function w(e){let{r:r,g:t,b:o,a:i}=e;return i<1&&(r=Math.round(i*r+255*(1-i)),t=Math.round(i*t+255*(1-i)),o=Math.round(i*o+255*(1-i))),new n.Z({r:r,g:t,b:o})}function S(e,r){const{r:t,g:n,b:o}=r?.ignoreAlpha?e:w(e);return.2126*t+.7152*n+.0722*o}var N,P;function G(e,r=N.High){return S(e,{ignoreAlpha:!0})>r?new n.Z([0,0,0,e.a]):new n.Z([255,255,255,e.a])}function T(e,r){const t=x(e);t.l*=1-r;const n=k(t),o=e.clone();return o.setColor(n),o.a=e.a,o}function E(e,r){const t=e.clone();return t.a*=r,t}function Z(e,r){const t=I(e);t.s*=r;const n=k(t),o=e.clone();return o.setColor(n),o.a=e.a,o}function A(e){return n.Z.toUnitRGBA(e)}function L(e,r){return e===r||null!=e&&e.equals(r)}function R(e,r){return e===r||null!=e&&null!=r&&(0,a.e)(e,r)}function F(e){return(0,c.al)(e[0],e[1],e[2],e.length>3?e[3]:1)}function H(e){return e[0]??=0,e[1]??=0,e[2]??=0,e}function V(e){return e.length=4,H(e),e[3]??=1,(0,s.uZ)(e[3],0,1),e}function _(e,r){const t=n.Z.toUnitRGBA(e);return t[3]*=r,t}function D(e,r,t={}){if(0===e.length||r<=0)return[];if(1===(e=e.map((e=>"string"==typeof e?new n.Z(e):e))).length||1===r){const t=[],n=e[0];for(let e=0;e<r;e++)t.push(n.clone());return t}if(t.shuffle&&(e=(0,o.TV)((0,i.d9)(e),t.seed)),e.length>=r){const t=[],n=(e.length-1)/(r-1);for(let o=0;o<r;o++){const r=Math.round(o*n);t.push(e[r].clone())}return t}return function(e,r,t={}){const n=[],i=e.length-1,s=Math.ceil((r-e.length)/i);e:for(let o=0;o<i;o++){const i=e[o],a=e[o+1];for(let o=1;o<=s;o++){const c=o/(s+1);if(n.push(U(i,a,c,t)),n.length+e.length===r)break e}}return[...e.map((e=>e.clone())),...(0,o.TV)(n,t.seed??1)]}(e,r,t)}(P=N||(N={}))[P.Low=160]="Low",P[P.High=225]="High";const $=(e,r)=>{const t=Math.floor(10*r())-5;return Math.min(255,Math.max(0,e+t))};function U(e,r,t,i={}){const s=e.r,a=e.g,c=e.b,u=r.r,f=r.g,l=r.b,p=Math.round(s+(u-s)*t),m=Math.round(a+(f-a)*t),d=Math.round(c+(l-c)*t);if(!i.offset)return new n.Z([p,m,d]);const h=(0,o.FS)(i.seed);return new n.Z([$(p,h),$(m,h),$(d,h)])}},17623:function(e,r,t){t.d(r,{OverrideHelper:function(){return l}});var n=t(53147),o=t(92643),i=t(28947),s=t(299),a=t(15065),c=t(61421),u=t(66882);const f=e=>{if(!e)return[0,0,0,0];const{r:r,g:t,b:n,a:o}=e;return[r,t,n,255*o]};class l{static findApplicableOverrides(e,r,t){if(e&&r){if(e.primitiveName){let n=!1;for(const r of t)if(r.primitiveName===e.primitiveName){n=!0;break}if(!n)for(const n of r)n.primitiveName===e.primitiveName&&t.push(n)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const n of e.effects)l.findApplicableOverrides(n,r,t);if(e.symbolLayers)for(const n of e.symbolLayers)l.findApplicableOverrides(n,r,t);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(e.effects)for(const n of e.effects)l.findApplicableOverrides(n,r,t);if(e.markerPlacement&&l.findApplicableOverrides(e.markerPlacement,r,t),"CIMVectorMarker"===e.type){if(e.markerGraphics)for(const n of e.markerGraphics)l.findApplicableOverrides(n,r,t),l.findApplicableOverrides(n.symbol,r,t)}else"CIMCharacterMarker"===e.type?l.findApplicableOverrides(e.symbol,r,t):"CIMHatchFill"===e.type?l.findApplicableOverrides(e.lineSymbol,r,t):"CIMPictureMarker"===e.type&&l.findApplicableOverrides(e.animatedSymbolProperties,r,t)}}}static findEffectOverrides(e,r){if(!e)return null;if("CIMGeometricEffectDashes"===e.type&&(0,c.hU)(e),!r||!e.primitiveName)return{type:"cim-effect-param",effect:e,overrides:[]};const t=(0,c.Ml)(e),n=e.primitiveName,o=[];for(const e of r)e.primitiveName===n&&o.push((0,c.Ml)(e));return{type:"cim-effect-param",effect:t,overrides:(0,c.Ul)(o)}}static async resolveSymbolOverrides(e,r,t,n,o,a,u){if(!e?.symbol)return null;let{symbol:f,primitiveOverrides:p}=e;const m=!!p;if(!m&&!n)return f;f=(0,i.d9)(f),p=(0,i.d9)(p);let d=!0;if(r||(r={attributes:{}},d=!1),m){if(d||(p=p.filter((e=>!e.valueExpressionInfo?.expression.includes("$feature")))),u||(p=p.filter((e=>!e.valueExpressionInfo?.expression.includes("$view")))),p.length>0){const e=(0,c.Qf)(r.attributes),n={spatialReference:t,fields:e,geometryType:o};await l.createRenderExpressions(p,n),l.evaluateOverrides(p,r,o??"esriGeometryPoint",a,u,new s.Z(e))}l.applyOverrides(f,p)}return n&&l.applyDictionaryTextOverrides(f,r,n,null),f}static{this._expressionToRenderExpression=new Map}static async createRenderExpressions(e,r){const t=[];for(const n of e){const e=n.valueExpressionInfo;if(!e||l._expressionToRenderExpression.has(e.expression))continue;const o=(0,a.Yi)(e.expression,r.spatialReference);t.push(o),o.then((r=>l._expressionToRenderExpression.set(e.expression,r)))}t.length>0&&await Promise.all(t)}static evaluateOverrides(e,r,t,n,i,s){const a={$view:{scale:i?.scale}};for(const i of e){i.value&&"object"==typeof i.value&&(0,o.jQ)(i.value)&&("Color"===i.propertyName||"StrokeColor"===i.propertyName)&&(i.value=f(i.value));const e=i.valueExpressionInfo;if(!e)continue;const c=l._expressionToRenderExpression.get(e.expression);c&&(i.value=(0,u.default)(c,r,a,t,s,n))}}static applyDictionaryTextOverrides(e,r,t,n,o="Normal"){if(e?.type)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const i=e.symbolLayers;if(!i)return;for(const s of i)s&&"CIMVectorMarker"===s.type&&l.applyDictionaryTextOverrides(s,r,t,n,"CIMTextSymbol"===e.type?e.textCase:o)}break;case"CIMVectorMarker":{const o=e.markerGraphics;if(!o)return;for(const e of o)e&&l.applyDictionaryTextOverrides(e,r,t,n)}break;case"CIMMarkerGraphic":{const i=e.textString;if(i&&i.includes("[")){const s=(0,c.H1)(i,t);e.textString=(0,c.E_)(r,s,n,o)}}}}static applyOverrides(e,r,t,n){if(e.primitiveName)for(const o of r)if(o.primitiveName===e.primitiveName){const r=(0,c.Le)(o.propertyName);if(n&&n.push({cim:e,nocapPropertyName:r,value:e[r]}),t){let r=!1;for(const n of t)n.primitiveName===e.primitiveName&&(r=!0);r||t.push(o)}null!=o.value&&(e[r]=o.value)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const o of e.effects)l.applyOverrides(o,r,t,n);if(e.symbolLayers)for(const o of e.symbolLayers)l.applyOverrides(o,r,t,n);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(e.effects)for(const o of e.effects)l.applyOverrides(o,r,t,n);if("CIMVectorMarker"===e.type&&e.markerGraphics)for(const o of e.markerGraphics)l.applyOverrides(o,r,t,n),l.applyOverrides(o.symbol,r,t,n)}}static restoreOverrides(e){for(const r of e)r.cim[r.nocapPropertyName]=r.value}static buildOverrideKey(e){let r="";for(const t of e)void 0!==t.value&&(r+=`${t.primitiveName}${t.propertyName}${JSON.stringify(t.value)}`);return r}static toValue(e,r){if("DashTemplate"===e)return r.split(" ").map((e=>Number(e)));if("Color"===e){const e=new n.Z(r).toRgba();return e[3]*=255,e}return r}}},66882:function(e,r,t){t.d(r,{default:function(){return s}});var n=t(88194),o=t(96711),i=t(96610);function s(e,r,t,n,i,s){if(null==e)return null;const a=e.references("geometry")&&s?c(r,n,s):r,u=e.repurposeFeature(a,i);try{return e.evaluate(u,t)}catch(e){return o.Z.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",e),null}}const a=new Map;function c(e,r,t){const{transform:s,hasZ:c,hasM:u}=t;a.has(r)||a.set(r,function(e){const r={};switch(e){case"esriGeometryPoint":return(e,t,n,o)=>(0,i.U1)(t,r,e,n,o);case"esriGeometryPolygon":return(e,t,n,o)=>(0,i.Ie)(t,r,e,n,o);case"esriGeometryPolyline":return(e,t,n,o)=>(0,i.G6)(t,r,e,n,o);case"esriGeometryMultipoint":return(e,t,n,o)=>(0,i.J9)(t,r,e,n,o);default:return o.Z.getLogger("esri.views.2d.support.arcadeOnDemand").error(new n.Z("mapview-arcade",`Unable to handle geometryType: ${e}`)),e=>e}}(r));const f=a.get(r)(e.geometry,s,c,u);return{...e,geometry:f}}}}]);