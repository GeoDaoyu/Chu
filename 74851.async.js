"use strict";(self.webpackChunkscene_pro=self.webpackChunkscene_pro||[]).push([[74851,34042],{34042:function(e,t,i){i.d(t,{it:function(){return S},aX:function(){return x},hR:function(){return b}});var n=i(81001),r=i(88194),o=i(96711),s=i(67764),a=i(62197),l=i(76264),c=i(8554),h=i(97290),d=i(78619),p=i(90756),u=i(56545);var g=i(95490),m=i(93333);const y=()=>o.Z.getLogger("esri.geometry.support.normalizeUtils");function v(e){return"polygon"===e[0].type}function f(e){return"polyline"===e[0].type}function b(e,t){if(!(e instanceof a.Z||e instanceof s.Z)){const e="straightLineDensify: the input geometry is neither polyline nor polygon";throw y().error(e),new r.Z("internal:geometry",e)}const i=(0,l.x3)(e),n=[];for(const e of i){const i=[];n.push(i),i.push([e[0][0],e[0][1]]);for(let n=0;n<e.length-1;n++){const r=e[n][0],o=e[n][1],s=e[n+1][0],a=e[n+1][1],l=Math.sqrt((s-r)*(s-r)+(a-o)*(a-o)),c=(a-o)/l,h=(s-r)/l,d=l/t;if(d>1){for(let e=1;e<=d-1;e++){const n=e*t,s=h*n+r,a=c*n+o;i.push([s,a])}const e=(l+Math.floor(d-1)*t)/2,n=h*e+r,s=c*e+o;i.push([n,s])}i.push([s,a])}}return function(e){return"polygon"===e.type}(e)?new s.Z({rings:n,spatialReference:e.spatialReference}):new a.Z({paths:n,spatialReference:e.spatialReference})}function _(e,t,i){if(t){const t=b(e,1e6);e=(0,h.Sx)(t,!0)}return i&&(e=(0,l.Sy)(e,i)),e}function w(e,t,i){if(Array.isArray(e)){const n=e[0];if(n>t){const i=(0,l.XZ)(n,t);e[0]=n+i*(-2*t)}else if(n<i){const t=(0,l.XZ)(n,i);e[0]=n+t*(-2*i)}}else{const n=e.x;if(n>t){const i=(0,l.XZ)(n,t);e=e.clone().offset(i*(-2*t),0)}else if(n<i){const t=(0,l.XZ)(n,i);e=e.clone().offset(t*(-2*i),0)}}return e}function C(e,t){let i=-1;for(let n=0;n<t.cutIndexes.length;n++){const r=t.cutIndexes[n],o=t.geometries[n],s=(0,l.x3)(o);for(let e=0;e<s.length;e++){const t=s[e];t.some((i=>{if(i[0]<180)return!0;{let i=0;for(let e=0;e<t.length;e++){const n=t[e][0];i=n>i?n:i}i=Number(i.toFixed(9));const n=-360*(0,l.XZ)(i,180);for(let i=0;i<t.length;i++){const t=o.getPoint(e,i);o.setPoint(e,i,t.clone().offset(n,0))}return!0}}))}if(r===i){if(v(e))for(const t of(0,l.x3)(o))e[r]=e[r].addRing(t);else if(f(e))for(const t of(0,l.x3)(o))e[r]=e[r].addPath(t)}else i=r,e[r]=o}return e}async function x(e,t,i){if(!Array.isArray(e))return x([e],t);t&&"string"!=typeof t&&y().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const r="string"==typeof t?t:t?.url??n.default.geometryServiceUrl;let o,v,f,b,S,M,T,P,I=0;const Z=[],k=[];for(const t of e)if(null!=t)if(o||(o=t.spatialReference,v=(0,c.C5)(o),f=o.isWebMercator,M=f?102100:4326,b=l.UZ[M].maxX,S=l.UZ[M].minX,T=l.UZ[M].plus180Line,P=l.UZ[M].minus180Line),v)if("mesh"===t.type)k.push(t);else if("point"===t.type)k.push(w(t.clone(),b,S));else if("multipoint"===t.type){const e=t.clone();e.points=e.points.map((e=>w(e,b,S))),k.push(e)}else if("extent"===t.type){const e=t.clone()._normalize(!1,!1,v);k.push(e.rings?new s.Z(e):e)}else if(t.extent){const e=t.extent,i=(0,l.XZ)(e.xmin,S)*(2*b);let n=0===i?t.clone():(0,l.Sy)(t.clone(),i);e.offset(i,0);let{xmin:r,xmax:o}=e;r=Number(r.toFixed(9)),o=Number(o.toFixed(9)),e.intersects(T)&&o!==b?(I=o>I?o:I,n=_(n,f),Z.push(n),k.push("cut")):e.intersects(P)&&r!==S?(I=o*(2*b)>I?o*(2*b):I,n=_(n,f,360),Z.push(n),k.push("cut")):k.push(n)}else k.push(t.clone());else k.push(t);else k.push(t);let R=(0,l.XZ)(I,b),L=-90;const O=R,G=new a.Z;for(;R>0;){const e=360*R-180;G.addPath([[e,L],[e,-1*L]]),L*=-1,R--}if(Z.length>0&&O>0){const t=C(Z,await async function(e,t,i,n){const r=(0,u.en)(e),o=t[0].spatialReference,s={...n,responseType:"json",query:{...r.query,f:"json",sr:(0,c.B9)(o),target:JSON.stringify({geometryType:(0,p.Ji)(t[0]),geometries:t}),cutter:JSON.stringify(i)}},a=await(0,d.Z)(r.path+"/cut",s),{cutIndexes:l,geometries:h=[]}=a.data;return{cutIndexes:l,geometries:h.map((e=>{const t=(0,p.im)(e);return t.spatialReference=o,t}))}}(r,Z,G,i)),n=[],o=[];for(let i=0;i<k.length;i++){const r=k[i];if("cut"!==r)o.push(r);else{const r=t.shift(),s=e[i];null!=s&&"polygon"===s.type&&s.rings&&s.rings.length>1&&r.rings.length>=s.rings.length?(n.push(r),o.push("simplify")):o.push(f?(0,h.$)(r):r)}}if(!n.length)return o;const s=await async function(e,t,i){const n="string"==typeof e?(0,g.mN)(e):e,r=t[0].spatialReference,o=(0,p.Ji)(t[0]),s={...i,query:{...n.query,f:"json",sr:(0,c.B9)(r),geometries:JSON.stringify((0,m.F)(t))}},{data:a}=await(0,d.Z)(n.path+"/simplify",s);return(0,m.o)(a.geometries,o,r)}(r,n,i),a=[];for(let e=0;e<o.length;e++){const t=o[e];"simplify"!==t?a.push(t):a.push(f?(0,h.$)(s.shift()):s.shift())}return a}const $=[];for(let e=0;e<k.length;e++){const t=k[e];if("cut"!==t)$.push(t);else{const e=Z.shift();$.push(!0===f?(0,h.$)(e):e)}}return $}function S(e,t,i){const n=(0,c.C5)(i);if(null==n)return e;const[r,o]=n.valid,s=2*o;let a=0,l=0;t>o?a=Math.ceil(Math.abs(t-o)/s):t<r&&(a=-Math.ceil(Math.abs(t-r)/s)),e>o?l=Math.ceil(Math.abs(e-o)/s):e<r&&(l=-Math.ceil(Math.abs(e-r)/s));let h=e+(a-l)*s;const d=h-t;return d>o?h-=s:d<r&&(h+=s),h}},76264:function(e,t,i){i.d(t,{Sy:function(){return l},UZ:function(){return s},XZ:function(){return a},x3:function(){return c}});var n=i(62197),r=i(45213),o=i(90756);const s={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new n.Z({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:r.Z.WebMercator}),minus180Line:new n.Z({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:r.Z.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new n.Z({paths:[[[180,-180],[180,180]]],spatialReference:r.Z.WGS84}),minus180Line:new n.Z({paths:[[[-180,-180],[-180,180]]],spatialReference:r.Z.WGS84})}};function a(e,t){return Math.ceil((e-t)/(2*t))}function l(e,t){const i=c(e);for(const e of i)for(const i of e)i[0]+=t;return e}function c(e){return(0,o.oU)(e)?e.rings:e.paths}},17045:function(e,t,i){i.d(t,{h:function(){return o}});let n=e=>({vnodeSelector:"",properties:void 0,children:void 0,text:e.toString(),domNode:null}),r=(e,t,i)=>{for(let o=0,s=t.length;o<s;o++){let s=t[o];Array.isArray(s)?r(e,s,i):null!=s&&!1!==s&&("string"==typeof s&&(s=n(s)),i.push(s))}};function o(e,t,i){if(Array.isArray(t))i=t,t=void 0;else if(t&&("string"==typeof t||t.hasOwnProperty("vnodeSelector"))||i&&("string"==typeof i||i.hasOwnProperty("vnodeSelector")))throw new Error("h called with invalid arguments");let n,o;return i&&1===i.length&&"string"==typeof i[0]?n=i[0]:i&&(o=[],r(e,i,o),0===o.length&&(o=void 0)),{vnodeSelector:e,properties:t,children:o,text:""===n?void 0:n,domNode:null}}},34615:function(e,t,i){i.d(t,{Y:function(){return r}});var n=i(5826);const r={readOnly:!0,get(){return(0,n.R)(this.view)}}},93333:function(e,t,i){i.d(t,{F:function(){return r},o:function(){return o}});var n=i(90756);function r(e){return{geometryType:(0,n.Ji)(e[0]),geometries:e.map((e=>e.toJSON()))}}function o(e,t,i){const r=(0,n.q9)(t);return e.map((e=>{const t=r.fromJSON(e);return t.spatialReference=i,t}))}},56545:function(e,t,i){i.d(t,{LP:function(){return d},cv:function(){return h},en:function(){return c},lA:function(){return l}});var n=i(81001),r=i(10218),o=i(28947),s=i(95490),a=i(82674);function l(e,t){return t?{...t,query:{...e??{},...t.query}}:{query:e}}function c(e){return"string"==typeof e?(0,s.mN)(e):(0,o.d9)(e)}function h(e,t,i){const n={};for(const r in e){if("declaredClass"===r)continue;const o=e[r];if(null!=o&&"function"!=typeof o)if(Array.isArray(o))n[r]=o.map((e=>h(e)));else if("object"==typeof o)if(o.toJSON){const e=o.toJSON(i?.[r]);n[r]=t?e:JSON.stringify(e)}else n[r]=t?o:JSON.stringify(o);else n[r]=o}return n}async function d(e,t,o){const s=function(e,t){return e?t&&(0,a.rU)(e)?t:(0,a.Pi)(e)??r.id?.findCredential(e)?.token:null}(e,t);if(s)return s;!r.id&&n.default.request.useIdentity&&await i.e(39428).then(i.bind(i,39428));return(await r.id.getCredential(e,o))?.token}},65015:function(e,t,i){i.d(t,{$:function(){return n},l:function(){return r}});const n=50,r=5},55623:function(e,t,i){i.d(t,{RN:function(){return u},TS:function(){return p},wK:function(){return g}});var n=i(26636),r=i(60508),o=i(62197),s=i(45213),a=i(95872),l=i(34042),c=i(8554),h=i(97290),d=i(65015);function p(e,t,i){const n=1===e?10:e;return n**(i?Math.round(function(e,t){return Math.log(e)/Math.log(t)}(d.$/t,n)):0)}function u(e){const{isGeographic:t,isWebMercator:i}=e;return!t&&!i}function g(e,t,i){const d="number"==typeof e?null:e,p=i??d?.spatialReference;if(null==p||!(0,c.JY)(p)||u(p))return(0,n.c9)(p);let g=d?.x??e,m=d?.y??t;const y=1/Math.sqrt(2);let v=g+y,f=m+y;const{isWebMercator:b,isGeographic:_}=p;let w=_&&!(0,a.Gb)(p)?s.Z.WGS84:p;if(b){let e=new r.Z({x:g,y:m,spatialReference:p});(0,h.Sx)(e,!0,e),g=e.x,m=e.y,e=new r.Z({x:v,y:f,spatialReference:p}),(0,h.Sx)(e,!0,e),v=e.x,f=e.y,w=s.Z.WGS84}const C=new o.Z({paths:[[[g,m],[v,f]]],spatialReference:w}),x=(0,l.hR)(C,10);let S;try{[S]=(0,a.Jf)([x],"meters")}catch{return(0,n.c9)(p)}return S}},11058:function(e,t,i){i.d(t,{Z:function(){return h}});var n=i(73440),r=i(53147),o=i(70880),s=i(17155),a=(i(61432),i(96711),i(83850),i(48023)),l=(i(45357),i(17045));i(59143);const c={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right","bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"};let h=class extends o.Z{get position(){return[this.x,this.y]}set position(e){this._set("x",e[0]),this._set("y",e[1])}get _textShadowColor(){const{textColor:e,backgroundColor:t}=this,i=t.clone();return i.a*=e.a,i}get _textShadow(){const e=this._textShadowColor.toCss(!0);return`0 0 ${this._textShadowSize}px ${e}`}get padding(){return.5*this.fontSize}get borderRadius(){return this.padding}set borderRadius(e){this._overrideIfSome("borderRadius",e)}constructor(e){super(e),this.x=0,this.y=0,this.text="-",this.fontSize=14,this.anchor="center",this.visible=!0,this.isDecoration=!0,this.backgroundColor=new r.Z([0,0,0,.6]),this.textColor=new r.Z([255,255,255]),this._textShadowSize=1}render(){return(0,l.h)("div",{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+"px",lineHeight:this.fontSize+"px",backgroundColor:this.backgroundColor.toCss(!0),color:this.textColor.toCss(!0),padding:this.padding+"px",borderRadius:this.borderRadius+"px",textShadow:this._textShadow}},[this.text])}renderCanvas(e){if(!this.visible)return;const t=e.font.replace(/^(.*?)px/,"");e.font=`${this.fontSize}px ${t}`;const{padding:i,borderRadius:n}=this,r=e.measureText(this.text).width,o=""!==this.text?this.fontSize:0,s=d[this.anchor];e.textAlign="center",e.textBaseline="middle";const a=r+2*i,l=o+2*i,c=this.x+s.x*a,h=this.y+s.y*l;this._roundedRect(e,c,h,a,l,n),e.fillStyle=this.backgroundColor.toCss(!0),e.fill();const p=this.x+(s.x+.5)*a,u=this.y+(s.y+.5)*l;this._renderTextShadow(e,this.text,p,u),e.fillStyle=this.textColor.toCss(!0),e.fillText(this.text,p,u)}_renderTextShadow(e,t,i,n){e.lineJoin="miter",e.fillStyle=`rgba(${this._textShadowColor.r}, ${this._textShadowColor.g}, ${this._textShadowColor.b}, ${1/p.length})`;const r=this._textShadowSize;for(const[o,s]of p)e.fillText(t,i+r*o,n+r*s)}_roundedRect(e,t,i,n,r,o){o=Math.min(o,r/2,n/2),e.beginPath(),e.moveTo(t,i+o),e.arcTo(t,i,t+o,i,o),e.lineTo(t+n-o,i),e.arcTo(t+n,i,t+n,i+o,o),e.lineTo(t+n,i+r-o),e.arcTo(t+n,i+r,t+n-o,i+r,o),e.lineTo(t+o,i+r),e.arcTo(t,i+r,t,i+r-o,o),e.closePath()}_cssClasses(){const e={"esri-text-overlay-item":!0};let t;for(t in c)e[c[t]]=this.anchor===t;return e}};(0,n._)([(0,s.Cb)()],h.prototype,"x",void 0),(0,n._)([(0,s.Cb)()],h.prototype,"y",void 0),(0,n._)([(0,s.Cb)()],h.prototype,"position",null),(0,n._)([(0,s.Cb)()],h.prototype,"text",void 0),(0,n._)([(0,s.Cb)()],h.prototype,"fontSize",void 0),(0,n._)([(0,s.Cb)()],h.prototype,"anchor",void 0),(0,n._)([(0,s.Cb)()],h.prototype,"visible",void 0),(0,n._)([(0,s.Cb)()],h.prototype,"isDecoration",void 0),(0,n._)([(0,s.Cb)()],h.prototype,"backgroundColor",void 0),(0,n._)([(0,s.Cb)()],h.prototype,"textColor",void 0),(0,n._)([(0,s.Cb)()],h.prototype,"_textShadowSize",void 0),(0,n._)([(0,s.Cb)()],h.prototype,"_textShadowColor",null),(0,n._)([(0,s.Cb)()],h.prototype,"_textShadow",null),(0,n._)([(0,s.Cb)()],h.prototype,"padding",null),(0,n._)([(0,s.Cb)()],h.prototype,"borderRadius",null),h=(0,n._)([(0,a.j)("esri.views.overlay.TextOverlayItem")],h);const d={bottom:{x:-.5,y:-1,textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},"top-right":{x:-1,y:0,textAlign:"right",textBaseline:"top"}},p=[];{const e=16;for(let t=0;t<360;t+=360/e)p.push([Math.cos(Math.PI*t/180),Math.sin(Math.PI*t/180)])}},74851:function(e,t,i){i.r(t),i.d(t,{default:function(){return se}});var n=i(73440),r=i(53147),o=(i(55214),i(85168)),s=i(96711),a=i(90403),l=i(51067),c=i(17155),h=(i(61432),i(83850),i(48023)),d=i(1803),p=i(84644),u=i(46512),g=i(82504),m=i(68808),y=i(24225),v=i(23039),f=i(87833),b=i(99574),_=i(61100),w=i(26636),C=i(60508),x=i(13132),S=i(4469),M=i(63255),T=i(79775);let P=class extends M.Z{constructor(e){super(e),this.center=new C.Z,this.dynamicScaling=!0,this.majorLineColor=r.Z.fromArray([115,115,115,1]),this.majorLineInterval=10,this.minorLineColor=r.Z.fromArray([165,165,165,1]),this.rotateWithMap=!1,this.rotation=0,this.spacing=1,this.type="measured",this.units="miles"}};(0,n._)([(0,c.Cb)()],P.prototype,"center",void 0),(0,n._)([(0,c.Cb)()],P.prototype,"dynamicScaling",void 0),(0,n._)([(0,c.Cb)()],P.prototype,"majorLineColor",void 0),(0,n._)([(0,c.Cb)()],P.prototype,"majorLineInterval",void 0),(0,n._)([(0,c.Cb)()],P.prototype,"minorLineColor",void 0),(0,n._)([(0,c.Cb)()],P.prototype,"rotateWithMap",void 0),(0,n._)([(0,c.Cb)()],P.prototype,"rotation",void 0),(0,n._)([(0,c.Cb)()],P.prototype,"spacing",void 0),(0,n._)([(0,T.J)({measured:"measured"})],P.prototype,"type",void 0),(0,n._)([(0,c.Cb)()],P.prototype,"units",void 0),P=(0,n._)([(0,h.j)("esri.grids.MeasuredGrid")],P);var I=i(60856),Z=i(34615),k=i(38096),R=i(19886),L=i(65015),O=i(55623),G=i(84982),$=(i(34605),i(13154),i(56156),i(96620)),E=i(18753),A=i(81972),j=i(29668),N=i(70880);let U=class extends N.Z{constructor(e){super(e),this.color=new r.Z([255,127,0,1]),this.isDecoration=!0,this.length=34,this.rotation=0,this.thickness=2,this.visible=!0}get _strokeStyle(){return this.color.toCss(!0)}render(){const{x:e,y:t,length:i,thickness:n,rotation:r}=this,o=i/2,s=`0 0 ${i} ${i}`,a=`M${o} 0 V${i} M0 ${o} H${i}`;return(0,v.u)("div",{classes:{"esri-box-overlay-item":!0},dir:"ltr",styles:{left:(e??0)-o+"px",top:(t??0)-o+"px",width:`${i}px`,height:`${i}px`,transform:`rotate(${r}deg)`,visibility:this.visible?"visible":"hidden"}},(0,v.u)("svg",{styles:{overflow:"visible"},viewbox:s},(0,v.u)("path",{d:a,stroke:this._strokeStyle,"stroke-width":n})))}renderCanvas(){}};(0,n._)([(0,c.Cb)()],U.prototype,"color",void 0),(0,n._)([(0,c.Cb)()],U.prototype,"isDecoration",void 0),(0,n._)([(0,c.Cb)()],U.prototype,"length",void 0),(0,n._)([(0,c.Cb)()],U.prototype,"rotation",void 0),(0,n._)([(0,c.Cb)()],U.prototype,"thickness",void 0),(0,n._)([(0,c.Cb)()],U.prototype,"visible",void 0),(0,n._)([(0,c.Cb)()],U.prototype,"x",void 0),(0,n._)([(0,c.Cb)()],U.prototype,"y",void 0),(0,n._)([(0,c.Cb)({readOnly:!0})],U.prototype,"_strokeStyle",null),U=(0,n._)([(0,h.j)("esri.views.overlay.CrosshairOverlayItem")],U);var D=i(11058),W=i(54074),B=i(8316),V=i(86225);const z=e=>{if(null==e||isNaN(e))return 0;const t=e+180;return Math.trunc((0,b.HS)(t,360))},q=(e,t)=>{if(!e||t.length<3)return;const[i,n,o,s]=t,[a,l]=void 0===s?[1,.25]:[s,.25*s];e.majorLineColor=r.Z.fromArray([i,n,o,a]),e.minorLineColor=r.Z.fromArray([i,n,o,l])},J=Symbol("grid-interactivity");let X=class extends f.Z.EventedAccessor{constructor(e){super(e),this._drawGraphicTool=null,this._keybindings=null,this._crosshairLabel=null,this._crosshairItem=null,this.snappingManager=null,this.snappingOptions=null,this.view=null,this.placementDisabled=!1,this._mostRecentlyShownGrid=null,this._sketchedVertexCount=0}initialize(){this.addHandles([(0,a.gx)((()=>!this.displayEnabled),(()=>{this.interactivePlacementState=null})),(0,a.YP)((()=>this.view?.viewpoint),(()=>{this._renderOverlays()})),(0,a.YP)((()=>this.snappingOptions?.gridEnabled),(e=>{null!=e&&this.trySetDisplayEnabled(e)})),(0,a.YP)((()=>this.view?.grid),((e,t)=>{this._mostRecentlyShownGrid=!e&&t?t:null}))])}destroy(){this._resetGridPlacementState(),this._crosshairItem&&(this.view?.overlay?.removeItem(this._crosshairItem),this._crosshairItem=(0,_.SC)(this._crosshairItem)),this._crosshairLabel&&(this.view?.overlay?.removeItem(this._crosshairLabel),this._crosshairLabel=(0,_.SC)(this._crosshairLabel))}get displayEnabled(){return!!this.view?.grid}get dynamicScaling(){return this.grid?.dynamicScaling??!1}set dynamicScaling(e){this.grid&&(this.grid.dynamicScaling=e)}get grid(){return this.view?.grid??this._mostRecentlyShownGrid}set gridColor(e){if(e?.equals(this.grid?.majorLineColor))return;if(!e)return;const[t,i,n,r]=e.toArray();q(this.grid,[t,i,n,r/255])}get gridColor(){return this.grid?.majorLineColor}get gridControlsEnabled(){return this.displayEnabled&&!this.interactivePlacementState}set interactivePlacementState(e){this._set("interactivePlacementState",e),this._resetGridPlacementState(),e&&this._startGridManipulation(e)}get majorLineInterval(){return this.grid?.majorLineInterval??10}set majorLineInterval(e){this.grid&&(this.grid.majorLineInterval=e<1?1:e>15?15:e)}get rotateWithMap(){return this.grid?.rotateWithMap??!1}set rotateWithMap(e){this.grid&&(this.grid.rotateWithMap=e)}get rotation(){return this.grid?.rotation??-180}set rotation(e){this.grid&&(this.grid.rotation=e)}get snappingEnabled(){return(this.grid&&this.snappingOptions?.gridEnabled)??!1}set snappingEnabled(e){const{snappingOptions:t}=this;t&&(t.gridEnabled=e)}get spacing(){return this.grid?.spacing??1}set spacing(e){this.grid&&e>0&&(this.grid.spacing=e)}get unit(){return this.grid?.units}set unit(e){this.grid&&(this.grid.units=e)}get gridOutOfScale(){return!this.dynamicScaling&&null!=this._pixelsPerStride&&this._pixelsPerStride<L.l}get effectiveSpacingAfterDynamicScaling(){return this.majorLineInterval<1||!this.dynamicScaling||!this.view||null==this._pixelsPerStride||!this.grid?.spacing?null:this.grid.spacing*(0,O.TS)(this.majorLineInterval,this._pixelsPerStride,this.dynamicScaling)}get numericSpacingInputShouldBeVisible(){return!!this.view?.spatialReference&&(0,O.RN)(this.view.spatialReference)}get _metersPerSRUnit(){if(!(this.view&&this.displayEnabled&&this.grid&&(0,x.isLoadedOrLoadFor)(this.grid.center.spatialReference,this.view.spatialReference)))return null;const e=(0,x.project)(this.grid.center,this.view.spatialReference);return(0,O.wK)(e)}get _pixelsPerStride(){if(!this.view?.scale||!this.displayEnabled||!this.grid||null==this._metersPerSRUnit)return null;const e=this.grid,{scale:t,spatialReference:i}=this.view;return(0,w.En)(e.spacing,e.units,"meters")/(this._metersPerSRUnit*(0,S.dp)(t,i))}get _isPlacing(){if(!this._drawGraphicTool)return!1;const e=this.interactivePlacementState;return"place"===e||"interactive"===e&&0===this._sketchedVertexCount}get _isRotating(){if(!this._drawGraphicTool)return!1;const e=this.interactivePlacementState;return"rotate"===e||"interactive"===e&&1===this._sketchedVertexCount}get _isScaling(){return!!this._drawGraphicTool&&("interactive"===this.interactivePlacementState&&1===this._sketchedVertexCount)}togglePlacementState(e){this.interactivePlacementState=this.interactivePlacementState===e?null:e}trySetDisplayEnabled(e){const{view:t}=this;if(t?.ready)if(!t.grid&&e)if(this._mostRecentlyShownGrid)t.grid=this._mostRecentlyShownGrid;else{const e="imperial"===this.defaultUnit?"feet":"meters";t.grid=new P({units:e,center:t.center??new C.Z,rotateWithMap:!0}),q(this.grid,[115,115,115])}else e||(t.grid=null);else s.Z.getLogger(this).warn("Attempting to enable grid display while view is not ready")}async startPlacement(e){const{view:t,snappingManager:i}=this;if(!t)return;this._set("interactivePlacementState",e),this._sketchedVertexCount=0;const n=new G.m({view:t,graphicProperties:{attributes:{[j.Ry]:j.Ry}},sketchOptions:{tooltips:{enabled:!0,visibleElements:{direction:!1,rotation:!1,totalLength:!1,elevation:!1,distance:!1,area:!1}}},geometryType:"polyline",mode:"click",snapToScene:!1,snappingManager:i,forceUniformSize:!0,centered:!1,cursor:"interactive"===this.interactivePlacementState||"place"===this.interactivePlacementState?"none":null,regularVerticesSymbol:void 0,activeVertexSymbol:F,activeLineSymbol:H,graphicSymbol:H,automaticAreaMeasurementUtils:await(0,W.A)(),automaticLengthMeasurementUtils:await(0,B.U)()});if(this._drawGraphicTool=n,t.addAndActivateTool(n),this._renderOverlays(),!this._keybindings){const e=new E.G7;e.add(E.Sn.complete,(()=>this._onDrawComplete())),e.add(E.Sn.vertexAdd,(()=>this._drawGraphicTool?.drawOperation.commitStagedVertex())),this._keybindings=e}this.addHandles([n.on("cursor-update",(e=>this._onCursorUpdate(e))),n.on("complete",(()=>this._onDrawComplete())),n.on("vertex-add",(t=>this._onVertexAdd(t,e))),this._keybindings.register(t,$.f.WIDGET)],J)}async _startGridManipulation(e){const{view:t}=this;if(!t)return void(this.interactivePlacementState=null);const i=new CustomEvent("before-placement",{cancelable:!0});this.emit("before-placement",i),i.defaultPrevented||await this.startPlacement(e)}_onCursorUpdate(e){try{if(this._isPlacing){const t=e.vertices[0].coordinates;return void this._handlePlace(t)}if(this._drawGraphicTool.cursor=null,this._isRotating&&this._handleRotate(e.vertices[0].coordinates),this._isScaling){const e=this._drawGraphicTool?.drawOperation.cursorVertex;this._handleScale(e)}}finally{this._renderOverlays()}}_onDrawComplete(){this._drawGraphicTool.cursor=null,this.interactivePlacementState=null}_onVertexAdd(e,t){const i=e.vertices[0].coordinates;this._isPlacing&&this._handlePlace(i),this._isRotating&&this._sketchedVertexCount>0&&this._handleRotate(i),this._isScaling&&this._sketchedVertexCount>0&&this._handleScale((0,I.T)(i[0],i[1],void 0,this.view.spatialReference)),this._sketchedVertexCount++,this._drawGraphicTool.cursor=null,2!==this._sketchedVertexCount&&"interactive"===t||(this.interactivePlacementState=null),this._renderOverlays()}_handlePlace(e){const{grid:t,view:i}=this;t&&i&&(t.center=new C.Z({x:e[0],y:e[1],spatialReference:i.spatialReference}))}_handleRotate(e){const{grid:t,view:i}=this;if(!t||!i)return;this._drawGraphicTool?.sketchOptions.tooltips.set("enabled",!1);const{x:n,y:r}=t.center,[o,s]=e,a=i.toScreen(t.center,{pickClosestTarget:!0}),l=a&&i.toMap(a),c=i.toScreen((0,I.T)(o,s,void 0,i.spatialReference),{pickClosestTarget:!0}),h=c&&i.toMap(c),d=l?l.x:n,p=l?l.y:r,u=d-(h?h.x:o),g=p-(h?h.y:s);if(0===u&&0===g)return;const m=Math.atan2(g,u),y=(0,b.BV)(m),v=t.rotateWithMap,f=i.viewpoint.rotation??0,_=v?y:y-f;t.rotation=Math.fround(_)%360}_handleScale(e){const{view:t,grid:i,_drawGraphicTool:n,interactivePlacementState:r,_metersPerSRUnit:o}=this;if(!(e&&t&&i&&n&&o))return;n.sketchOptions.tooltips.enabled=!1;const s="interactive"===r?i.center:n.drawOperation.firstVertex;if(!s||!e)return;const a=t?.toScreen(s),l=a&&t.toMap(a),c=t?.toScreen(e),h=l??s,d=(c&&t.toMap(c))??e,p=Math.sqrt((h.x-d.x)**2+(h.y-d.y)**2),u=(0,w.En)(p*o,"meters",i.units);this.spacing=u}_renderOverlays(){this._renderCrosshairOverlay(),this._renderTextOverlay()}_renderTextOverlay(){const{grid:e,view:t,_drawGraphicTool:i}=this,n=this._getCrosshairLabel();if(!(e&&t?.overlay&&i&&n))return;const r=t.toScreen(e.center,{pickClosestTarget:!0});r&&(n.position=[r.x+12,r.y+12]),this._isRotating?(n.text=`${z(e.rotation)}${V.A4}`,n.visible=!0):n.visible=!1}_renderCrosshairOverlay(){const{grid:e,view:t,_drawGraphicTool:i}=this;if(!e||!t?.overlay||!i)return;const n=this._getCrosshair();if(!n)return;const r=t.toScreen(e.center);r&&(n.x=r.x,n.y=r.y,n.rotation=e.rotateWithMap?t.viewpoint.rotation-e.rotation:-e.rotation,n.visible=!!i)}_getCrosshairLabel(){if(this._crosshairLabel)return this._crosshairLabel;const{grid:e,view:t,_drawGraphicTool:i}=this;if(!e||!t?.overlay||!i)return null;const n=new D.Z({anchor:"top-left",fontSize:10,textColor:new r.Z([21,21,21]),backgroundColor:new r.Z([248,248,248]),padding:8,borderRadius:20});return t.overlay.addItem(n),this._crosshairLabel=n,n}_getCrosshair(){const{_crosshairItem:e,view:t}=this;return t?.overlay?e&&t.overlay.items.includes(e)?e:(this._crosshairItem=new U({color:t.effectiveTheme.accentColor,thickness:4,length:36,visible:!0}),t.overlay?.addItem(this._crosshairItem),this._crosshairItem):null}_resetGridPlacementState(){this.removeHandles(J),this._crosshairItem&&(this._crosshairItem.visible=!1),this._crosshairLabel&&(this._crosshairLabel.visible=!1),this._drawGraphicTool&&(this.view?.activeTool===this._drawGraphicTool&&(this.view.activeTool=null),this.view?.tools.remove(this._drawGraphicTool)),this._drawGraphicTool=(0,_.SC)(this._drawGraphicTool)}};(0,n._)([(0,c.Cb)(Z.Y)],X.prototype,"defaultUnit",void 0),(0,n._)([(0,c.Cb)({readOnly:!0})],X.prototype,"displayEnabled",null),(0,n._)([(0,c.Cb)()],X.prototype,"dynamicScaling",null),(0,n._)([(0,c.Cb)()],X.prototype,"grid",null),(0,n._)([(0,c.Cb)()],X.prototype,"gridColor",null),(0,n._)([(0,c.Cb)({readOnly:!0})],X.prototype,"gridControlsEnabled",null),(0,n._)([(0,c.Cb)()],X.prototype,"interactivePlacementState",null),(0,n._)([(0,c.Cb)()],X.prototype,"majorLineInterval",null),(0,n._)([(0,c.Cb)()],X.prototype,"rotateWithMap",null),(0,n._)([(0,c.Cb)()],X.prototype,"rotation",null),(0,n._)([(0,c.Cb)()],X.prototype,"snappingEnabled",null),(0,n._)([(0,c.Cb)()],X.prototype,"snappingManager",void 0),(0,n._)([(0,c.Cb)({type:A.Z})],X.prototype,"snappingOptions",void 0),(0,n._)([(0,c.Cb)()],X.prototype,"spacing",null),(0,n._)([(0,c.Cb)()],X.prototype,"unit",null),(0,n._)([(0,c.Cb)()],X.prototype,"view",void 0),(0,n._)([(0,c.Cb)({readOnly:!0})],X.prototype,"gridOutOfScale",null),(0,n._)([(0,c.Cb)({readOnly:!0})],X.prototype,"effectiveSpacingAfterDynamicScaling",null),(0,n._)([(0,c.Cb)({readOnly:!0})],X.prototype,"numericSpacingInputShouldBeVisible",null),(0,n._)([(0,c.Cb)()],X.prototype,"placementDisabled",void 0),(0,n._)([(0,c.Cb)()],X.prototype,"_metersPerSRUnit",null),(0,n._)([(0,c.Cb)()],X.prototype,"_pixelsPerStride",null),(0,n._)([(0,c.Cb)()],X.prototype,"_isPlacing",null),(0,n._)([(0,c.Cb)()],X.prototype,"_isRotating",null),(0,n._)([(0,c.Cb)()],X.prototype,"_isScaling",null),(0,n._)([(0,c.Cb)()],X.prototype,"_mostRecentlyShownGrid",void 0),(0,n._)([(0,c.Cb)()],X.prototype,"_sketchedVertexCount",void 0),X=(0,n._)([(0,h.j)("esri.widgets.support.GridControls.GridControlsViewModel")],X);const H=new k.Z({width:0}),F=new R.Z({color:r.Z.fromArray([0,0,0,0]),outline:new k.Z({color:r.Z.fromArray([0,0,0,0])})});var Y=i(88512),K=i(37964);const Q="esri-grid-controls",ee={base:Q,borderedSwitch:`${Q}__switch--bordered`,container:`${Q}__container`,numericInputsContainer:`${Q}__numeric-inputs__container`,tilegroup:`${Q}__tilegroup`,tile:`${Q}__tile`,tileDisabled:`${Q}__tile--disabled`,tileContent:`${Q}__tile__content`,suffixedInputContainer:`${Q}__input-with-suffix__container`,inlineIcon:`${Q}__inline-icon`},te={widgetIcon:"grid-unit",gridTheme:{light:"circle",dark:"circle-area",custom:"palette"},placementState:{interactive:"maximum-territory-distance",place:"move",rotate:"rotate"},warning:"exclamation-mark-triangle"},ie=r.Z.fromArray([115,115,115]),ne=r.Z.fromArray([200,200,200]),re=["interactive","place","rotate"];let oe=class extends d.Z{constructor(e,t){super(e,t),this.customColor=null,this.messages=null,this.messagesUnits=null,this.viewModel=new X,this.visibleElements=new Y.Z,(0,o.Pq)(s.Z.getLogger(this),"Grid Controls","arcgis-grid-controls",{version:"4.33"})}initialize(){this.addHandles([(0,a.YP)((()=>this.viewModel.gridColor),(e=>{!e||ie.equals(e)||ne.equals(e)||(this.customColor=e)}),a.nn)])}loadDependencies(){return Promise.all([(0,p.h)({action:()=>Promise.all([i.e(58268),i.e(55001),i.e(11030)]).then(i.bind(i,11030)),"action-bar":()=>Promise.all([i.e(58268),i.e(62737),i.e(55001),i.e(71823),i.e(79767),i.e(94568)]).then(i.bind(i,4649)),label:()=>Promise.all([i.e(58268),i.e(36650)]).then(i.bind(i,36650)),icon:()=>Promise.all([i.e(58268),i.e(4204)]).then(i.bind(i,4204)),popover:()=>Promise.all([i.e(58268),i.e(62737),i.e(55001),i.e(71823),i.e(24006)]).then(i.bind(i,24006)),tooltip:()=>Promise.all([i.e(58268),i.e(62737),i.e(70514)]).then(i.bind(i,70514)),"color-picker":()=>Promise.all([i.e(58268),i.e(55001),i.e(17345),i.e(26041),i.e(61637),i.e(33833),i.e(63243),i.e(60030)]).then(i.bind(i,60030)),"input-number":()=>Promise.all([i.e(58268),i.e(17345),i.e(26041),i.e(33833),i.e(60709)]).then(i.bind(i,33833))}),(0,g.n)()])}get icon(){return te.widgetIcon}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages.widgetLabel}set label(e){this._overrideIfSome("label",e)}get snappingManager(){return this.viewModel.snappingManager}set snappingManager(e){this.viewModel.snappingManager=e}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get theme(){const e=this.viewModel.gridColor;return e?ie.equals(e)?"dark":ne.equals(e)?"light":"custom":null}set theme(e){const{viewModel:t,customColor:i,view:n}=this;switch(e){case"light":t.gridColor=ne;break;case"dark":t.gridColor=ie;break;case"custom":t.gridColor=i??n?.effectiveTheme.accentColor??ie}}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){return(0,v.u)("div",{"aria-label":this.label,class:this.classes(ee.base,u.z.widget,u.z.panel)},(0,v.u)("div",{class:ee.container},this._renderContent()))}_renderContent(){const{visibleElements:e}=this;return[e.gridEnabledToggle?this._renderEnabledToggle():null,e.placementButtons?this._renderGridPlacementButtons():null,e.numericInputs?this._renderNumericInputs():null,e.lineIntervalInput?this._renderIntervalInput():null,e.gridSnapEnabledToggle&&this.viewModel.snappingOptions?this._renderSnappingToggle():null,e.dynamicScaleToggle?this._renderDynamicScaleToggle():null,e.rotateWithMapToggle?this._renderRotateToggle():null,e.colorSelection?this._renderColorSelection():null]}_renderGridPlacementButtons(){const{interactivePlacementState:e,placementDisabled:t,gridControlsEnabled:i}=this.viewModel,n=t||!i;return(0,v.u)("calcite-label",{key:"grid-placement-buttons",scale:"s"},this.messages.placementOptions,(0,v.u)("calcite-action-bar",{expandDisabled:!0,layout:"horizontal"},re.map((t=>this._renderPlacementModeButton(t,n,e)))))}_renderPlacementModeButton(e,t,i){const n=this.messages.placementState[e],r=`__placement-action-${e}`;return(0,v.u)("div",null,(0,v.u)("calcite-action",{active:i===e,alignment:"center",disabled:t,icon:te.placementState[e],id:r,onclick:()=>this.viewModel.togglePlacementState(e),text:n}),(0,v.u)("calcite-tooltip",{overlayPositioning:"fixed",placement:"top",referenceElement:r},n))}_renderNumericInputs(){const{rotation:e,spacing:t,effectiveSpacingAfterDynamicScaling:i,numericSpacingInputShouldBeVisible:n,unit:r="meters"}=this.viewModel,o=this.messagesUnits.units[r].abbr,s=this.viewModel.gridControlsEnabled,a=null!=i&&i!==this.viewModel.spacing,c=`__spacing_input_scaled-${this.id}`;return(0,v.u)("div",{class:this.classes(ee.numericInputsContainer)},[n?(0,v.u)("calcite-label",{key:"spacing-label",scale:"s"},(0,v.u)("span",null,this.messages.inputLabel.spacing,a?(0,v.u)("calcite-icon",{class:this.classes(ee.inlineIcon),icon:te.warning,id:c,scale:"s",tabIndex:0}):void 0),(0,v.u)("div",{class:ee.suffixedInputContainer},(0,v.u)("calcite-input-number",{disabled:!s,numberButtonType:"none",suffixText:o,value:`${t?.toFixed(2)}`,onCalciteInputNumberChange:({currentTarget:e})=>{const t=parseFloat(e.value);this.viewModel.spacing=t,t!==this.viewModel.spacing&&(e.value=`${this.viewModel.spacing}`)}}),a?(0,v.u)("calcite-tooltip",{overlayPositioning:"fixed",placement:"leading",referenceElement:c},(0,K.n)(this.messages.warnings.dynamicSpacing,{actualSpacingIncludingUnit:(0,l.VG)(this.messagesUnits,i,r,2,"plural")})):void 0)):void 0,(0,v.u)("calcite-label",{key:"angle-label",scale:"s"},this.messages.inputLabel.angle,(0,v.u)("calcite-input-number",{disabled:!s,integer:!0,numberButtonType:"none",suffixText:this.messagesUnits.units.degrees.abbr,value:`${z(e)}`,onCalciteInputNumberChange:({currentTarget:e})=>this.viewModel.rotation=(e=>{let t=e;return null==t?0:("string"==typeof t&&(t=parseInt(t,10)),isNaN(t)?0:(0,b.HS)(Math.trunc(t),360)-180)})(e.value)}))])}_renderIntervalInput(){const{majorLineInterval:e,gridControlsEnabled:t}=this.viewModel;return(0,v.u)("div",{class:this.classes(ee.numericInputsContainer)},(0,v.u)("calcite-label",{scale:"s"},this.messages.inputLabel.interval,(0,v.u)("calcite-input-number",{disabled:!t,integer:!0,max:15,min:1,numberButtonType:"vertical",value:`${e}`,onCalciteInputNumberChange:({currentTarget:e})=>{const t=Number.parseInt(e.value,10);this.viewModel.majorLineInterval=t,t!==this.viewModel.majorLineInterval&&(e.value=`${this.viewModel.majorLineInterval}`)}})))}_renderSnappingToggle(){const{snappingOptions:e,gridControlsEnabled:t}=this.viewModel;return(0,v.u)(g.t,{checked:!!e?.gridEnabled,disabled:!(t&&e),key:"grid-snap-enabled-toggle",label:this.messages.switchLabel.snap,onChange:e=>this.viewModel.snappingOptions?.set("gridEnabled",e)})}_renderDynamicScaleToggle(){const{viewModel:e,messages:t}=this,i=this.visibleElements.outOfScaleWarning&&e.gridOutOfScale;return(0,v.u)(g.t,{checked:e.dynamicScaling,disabled:!e.gridControlsEnabled,hint:i?t.warnings.outOfScale:void 0,hintIcon:te.warning,hintKind:"warning",key:`grid-dynamic-scale-toggle-${this.id}`,label:t.switchLabel.scaling,onChange:t=>e.dynamicScaling=t})}_renderRotateToggle(){const{gridControlsEnabled:e,rotateWithMap:t}=this.viewModel;return(0,v.u)(g.t,{checked:t,disabled:!e,key:"grid-rotate-map-toggle",label:this.messages.switchLabel.rotateWithMap,onChange:e=>this.viewModel.rotateWithMap=e})}_renderEnabledToggle(){return(0,v.u)("div",{class:ee.borderedSwitch},(0,v.u)(g.t,{checked:this.viewModel.displayEnabled,disabled:!!this.viewModel.interactivePlacementState,key:"grid-enabled-toggle",label:this.messages.switchLabel.display,onChange:e=>this.viewModel.trySetDisplayEnabled(e)}))}_renderColorSelection(){const{customColor:e}=this,t=`${this.id}--custom-grid-color-button`;return(0,v.u)("calcite-label",{scale:"s"},this.messages.inputLabel.theme,(0,v.u)("div",{class:ee.tilegroup},[this._renderThemeTile({value:"dark"}),this._renderThemeTile({value:"light"}),this._renderThemeTile({value:"custom",id:t}),(0,v.u)("calcite-popover",{autoClose:!0,label:this.messages.gridLineColorPopoverLabel,overlayPositioning:"fixed",referenceElement:t},(0,v.u)("calcite-color-picker",{alphaChannel:!0,savedDisabled:!0,value:e?.toHex({digits:8})??"#000000ff",onCalciteColorPickerChange:e=>{const t=r.Z.fromHex(e.currentTarget.value);t&&(this.customColor=t,this.theme="custom")}}))]))}_renderThemeTile(e){const{theme:t}=this,{value:i}=e,n=this.messages.gridTheme[i],r=`${this.id}--theme_tile_${i}`,o=`${r}__label`,s=te.gridTheme[i],a=this.viewModel.gridControlsEnabled;return(0,v.u)("div",{class:(0,m.Sh)({[ee.tile]:!0,[ee.tileDisabled]:!a}),id:e.id,role:"button"},(0,v.u)("input",{"aria-labelledby":o,checked:t===i,disabled:!a,id:r,name:`${this.id}--theme`,onchange:e=>{this.theme=i,e.target?.focus()},tabIndex:0,type:"radio"}),(0,v.u)("div",{class:ee.tileContent},(0,v.u)("calcite-icon",{icon:s,scale:"l"}),(0,v.u)("calcite-label",{for:r,id:o},n)))}};(0,n._)([(0,c.Cb)({type:r.Z})],oe.prototype,"customColor",void 0),(0,n._)([(0,c.Cb)()],oe.prototype,"icon",null),(0,n._)([(0,c.Cb)()],oe.prototype,"label",null),(0,n._)([(0,c.Cb)(),(0,y.H)("esri/widgets/support/GridControls/t9n/GridControls")],oe.prototype,"messages",void 0),(0,n._)([(0,c.Cb)(),(0,y.H)("esri/core/t9n/Units")],oe.prototype,"messagesUnits",void 0),(0,n._)([(0,c.Cb)()],oe.prototype,"snappingManager",null),(0,n._)([(0,c.Cb)()],oe.prototype,"snappingOptions",null),(0,n._)([(0,c.Cb)()],oe.prototype,"theme",null),(0,n._)([(0,c.Cb)()],oe.prototype,"view",null),(0,n._)([(0,c.Cb)({type:X})],oe.prototype,"viewModel",void 0),(0,n._)([(0,c.Cb)({type:Y.Z,nonNullable:!0})],oe.prototype,"visibleElements",void 0),oe=(0,n._)([(0,h.j)("esri.widgets.support.GridControls")],oe);const se=oe}}]);