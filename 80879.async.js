"use strict";(self.webpackChunkscene_pro=self.webpackChunkscene_pro||[]).push([[80879],{5640:function(e,t,i){i.d(t,{QueueProcessor:function(){return u}});var n=i(61100),s=i(93568),r=i(92462),o=i(87422),l=i(99153),a=i(39355);class c{constructor(e,t){this.item=e,this.controller=t,this.promise=null}}class u{constructor(e){this._schedule=null,this._deferreds=new o.Z,this._controllers=new o.Z,this._processingItems=new o.Z,this._pausedSignal=(0,a.t)(!1),this.concurrency=1,e.concurrency&&(this.concurrency=e.concurrency),this._queue=new r.Z(e.peeker),this.process=e.process}destroy(){this.clear(),this._schedule=(0,n.hw)(this._schedule)}get updating(){return this.running}get length(){return this._processingItems.size+this._queue.length}get running(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}abort(e){const t=this._controllers.get(e);t&&t.abort()}clear(){this._queue.clear();const e=[];this._controllers.forEach((t=>e.push(t))),this._controllers.clear(),e.forEach((e=>e.abort())),this._processingItems.clear(),this._cancelNext()}forEach(e){this._deferreds.forEach(((t,i)=>e(i)))}get(e){const t=this._deferreds.get(e);return t?t.promise:void 0}isOngoing(e){return this._processingItems.has(e)}has(e){return this._deferreds.has(e)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(e,t){const i=this.get(e);if(i)return i;const n=new AbortController;let r=null;t&&(r=(0,s.fu)(t,(()=>n.abort())));const o=()=>{l.remove(),null!=r&&r.remove(),this._removeItem(e),this._queue.remove(e),this._scheduleNext()},l=(0,s.$F)(n.signal,(()=>{const t=this._processingItems.get(e);t&&t.controller.abort(),o(),a.reject((0,s.zE)())})),a=(0,s.hh)();return this._deferreds.set(e,a),this._controllers.set(e,n),a.promise.then(o,o),this._queue.push(e),this._scheduleNext(),a.promise}last(){return this._queue.last()}lastPromise(){const e=this.last();return e?this.get(e):null}peek(){return this._queue.peek()}popLast(){const e=this._queue.popLast();return e&&(this._deferreds.get(e)?.reject((0,s.zE)()),this._removeItem(e)),e}reset(){const e=Array.from(this._processingItems.values());this._processingItems.clear();for(const t of e)this._queue.push(t.item),t.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const e=[];for(;this._queue.length;)e.push(this._queue.pop());return this.clear(),e}_removeItem(e){this._deferreds.delete(e),this._controllers.delete(e),this._processingItems.delete(e)}_scheduleNext(){this._pausedSignal.value||this._schedule||(this._schedule=(0,l.Os)((()=>{this._schedule=null,this._next()})))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(e,t){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).resolve(t))}_processError(e,t){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).reject(t))}_canProcessFulfillment(e){return!!this._deferreds.get(e.item)&&this._processingItems.get(e.item)===e}_process(e){if(null==e)return;let t;const i=new AbortController,n=new c(e,i);this._processingItems.set(e,n);try{t=this.process(e,i.signal)}catch(e){this._processError(n,e)}(0,s.y8)(t)?(n.promise=t,t.then((e=>this._processResult(n,e)),(e=>this._processError(n,e)))):this._processResult(n,t)}}},87422:function(e,t,i){i.d(t,{Z:function(){return r}});var n=i(53227),s=i(18002);class r{constructor(e){this._observable=new s.s,this._map=new Map(e)}get size(){return(0,n.it)(this._observable),this._map.size}clear(){this._map.size>0&&(this._map.clear(),this._observable.notify())}delete(e){const t=this._map.delete(e);return t&&this._observable.notify(),t}entries(){return(0,n.it)(this._observable),this._map.entries()}forEach(e,t){(0,n.it)(this._observable),this._map.forEach(((i,n)=>e.call(t,i,n,this)),t)}get(e){return(0,n.it)(this._observable),this._map.get(e)}has(e){return(0,n.it)(this._observable),this._map.has(e)}keys(){return(0,n.it)(this._observable),this._map.keys()}set(e,t){return this._map.set(e,t),this._observable.notify(),this}values(){return(0,n.it)(this._observable),this._map.values()}[Symbol.iterator](){return(0,n.it)(this._observable),this._map[Symbol.iterator]()}[Symbol.dispose](){this._observable.destroy()}get[Symbol.toStringTag](){return this._map[Symbol.toStringTag]}}},9642:function(e,t,i){i.d(t,{r:function(){return M}});var n=i(73440),s=i(78619),r=i(88194),o=i(96711),l=i(17155),a=i(95226),c=(i(61432),i(83850),i(79775)),u=i(1194),h=i(48023),p=i(60508),d=i(45213),f=i(8554),m=i(66619),y=i(93295),g=i(68004),x=i(78434),_=i(62494),b=i(40577),w=i(97550),v=i(74379),R=i(56679),I=i(57528),S=i(32931),C=i(25937),k=i(9524),T=i(13381),z=i(49539),F=i(66164),P=i(68230),B=i(45387),N=i(17714),D=i(43827),O=i(28145);const M=e=>{let t=class extends e{constructor(...e){super(...e),this._isConstructedFromFunctionRaster=!1,this.bandIds=null,this.copyright=null,this.interpolation=null,this.multidimensionalSubset=null,this.raster=null,this.serviceRasterInfo=null,this.sourceJSON=null,this.spatialReference=null,this.symbolizer=null,this._isConstructedFromFunctionRaster=(0,v.p)(e[0]?.raster)}destroy(){this._shutdownJobHandler()}get fullExtent(){return this.serviceRasterInfo?.extent}set multidimensionalDefinition(e){this._set("multidimensionalDefinition",e),this.updateRenderer()}set rasterFunction(e){"none"===e?.functionName?.toLowerCase()&&(e=void 0),this._set("rasterFunction",e),this.updateRasterFunction()}set url(e){this._set("url",(0,m.Nm)(e,o.Z.getLogger(this)))}get renderer(){if("imagery-tile"!==this.type)return this.internalRenderer;const{activePresetRendererName:e,presetRenderers:t}=this;if(e){const i=t?.find((({name:t})=>t===e));return i?.renderer.clone()}return this.internalRenderer}set renderer(e){"imagery-tile"===this.type&&(this.activePresetRendererName=null),this.internalRenderer=e}set internalRenderer(e){null==e&&null==this.rasterFunction?this._configDefaultRenderer("override"):(this._set("internalRenderer",e),this.updateRenderer())}readRenderer(e,t,i){const n=t?.layerDefinition?.drawingInfo?.renderer;return(0,P.ij)(n,i)||void 0}async computeStatisticsHistograms(e,t){await this.load(t),e=(0,a.TJ)(B.Z,e).clone();const{serviceRasterInfo:i}=this;if(null==i)throw new r.Z("imagery-tile-mixin:compute-statistics-histograms","serviceRasterInfo must be specified");const{geometry:n}=e;if(null==n)throw new r.Z("imagery-tile-mixin:compute-statistics-histograms","geometry must be specified");let s=n;const{spatialReference:o}=i;if(!n.spatialReference.equals(o)){await(0,k.zD)();const e="extent"===n.type?(0,k.tB)(n,o):(0,k.Wt)(n,o);if(null==e)throw new r.Z("imagery-tile-mixin:compute-statistics-histograms","geometry cannot be projected to the data source");s=e}const l=e.pixelSize??new p.Z({x:i.pixelSize.x,y:i.pixelSize.y,spatialReference:o}),{extent:c,width:u,height:h}=(0,S.kO)(i,s,l),d=await this.fetchPixels(c,u,h,{...t,interpolation:"nearest"});if(null==d.pixelBlock)throw new r.Z("imagery-tile-mixin:compute-statistics-histograms","failed to fetch pixels");const f=await(0,S.oq)(d.pixelBlock,c,s),m=this._rasterJobHandler;return m?m.computeStatisticsHistograms({pixelBlock:f},t):(0,T.js)(f)}normalizeRasterFetchOptions(e){const{multidimensionalInfo:t}=this.serviceRasterInfo??{};if(null==t)return e;const i=(0,I.Qm)({rasterInfo:this.raster.rasterInfo,multidimensionalDefinition:e.multidimensionalDefinition||this.multidimensionalDefinition,timeExtent:e.timeExtent??this.timeExtent,multidimensionalSubset:this.multidimensionalSubset});return{...e,multidimensionalDefinition:i,timeExtent:void 0}}async updateRasterFunction(){return this.loaded&&"imagery-tile"===this.type&&(this.rasterFunction||this._cachedRasterFunctionJson)&&JSON.stringify(this.rasterFunction)!==JSON.stringify(this._cachedRasterFunctionJson)?(this._cachedRasterFunctionJson=this.rasterFunction?.toJSON(),this._rasterFunctionUpdatePromise=this._updateRasterFunction(),this._rasterFunctionUpdatePromise):this._rasterFunctionUpdatePromise}async updateRenderer(){const{loaded:e,symbolizer:t,renderer:i}=this;if(!e||!t||!i)return;const{rasterInfo:n}=this.raster,s=(0,I.N3)(n,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset})?.name,r=(0,z.FI)(n,s);return this._updateSymbolizer(t,i,s,r)}async applyRenderer(e,t,i){const n=e?.pixelBlock;if(!(null!=n&&n.pixels&&n.pixels.length>0))return null;await this.updateRenderer();const s=this.bandIds??[],{pixelBlock:r}=await this._symbolize({pixelData:e,simpleStretchParams:t,bandIds:s,symbolizer:this.symbolizer},i);return r}getTileUrl(e,t,i){return"RasterTileServer"===this.raster.datasetFormat?`${this.url}/tile/${e}/${t}/${i}`:""}getCompatibleTileInfo(e,t,i=!1){if(!this.loaded||null==t)return null;if(i&&e.equals(this.spatialReference))return this.tileInfo;const n=(0,f.C5)(e);return w.Z.create({size:256,spatialReference:e,origin:n?{x:n.origin[0],y:n.origin[1]}:{x:t.xmin,y:t.ymax}})}getCompatibleFullExtent(e){return this.loaded?(this._compatibleFullExtent?.spatialReference.equals(e)||(this._compatibleFullExtent=this.raster.computeExtent(e)),this._compatibleFullExtent):null}async fetchTile(e,t,i,n={}){if(M(this),n.requestAsImageElement){const r=this.getTileUrl(e,t,i);return(0,s.Z)(r,{responseType:"image",query:{...this.refreshParameters,...this.raster.ioConfig.customFetchParameters},signal:n.signal}).then((e=>e.data))}const{serviceRasterInfo:r}=this;if(null!=r.multidimensionalInfo&&null==(n=this.normalizeRasterFetchOptions(n)).multidimensionalDefinition){const s=n.tileInfo||r.storageInfo.tileInfo;return{extent:this.raster.getTileExtentFromTileInfo(e,t,i,s),pixelBlock:null}}return await this._initJobHandler(),await this.updateRasterFunction(),"raster-shaded-relief"===this.renderer?.type&&(n={...n,buffer:{cols:1,rows:1}}),this.raster.fetchTile(e,t,i,n)}async fetchPixels(e,t,i,n={}){return null!=this.serviceRasterInfo.multidimensionalInfo&&null==(n=this.normalizeRasterFetchOptions(n)).multidimensionalDefinition?{extent:e,pixelBlock:null}:(await this._initJobHandler(),await this.updateRasterFunction(),t=Math.round(t),i=Math.round(i),this.raster.fetchPixels(e,t,i,n))}async getSamples(e,t){if(await this.load(),(e=(0,a.TJ)(D.Z,e).clone()).interpolation&&"nearest"!==e.interpolation)throw new r.Z("imagery-tile-mixin:get-samples","only nearest interpolation is currently supported");const i=e.mosaicRule?.multidimensionalDefinition,n={...t,multidimensionalDefinition:i},s=(await this._getSampleLocations(e)).map((e=>this.identify(e,n).then((t=>(t.location=e,t))))),o=(await Promise.all(s)).flatMap(((e,t)=>this._convertRasterIdentifyResultToSample(e,t)));return new O.Z({samples:o})}async identify(e,t={}){await this.load();const{raster:i,serviceRasterInfo:n}=this;if(null!=n?.multidimensionalInfo&&(!n.hasMultidimensionalTranspose||!(0,I.WU)(t.multidimensionalDefinition)&&!t.transposedVariableName)&&null==(t=this.normalizeRasterFetchOptions(t)).multidimensionalDefinition)return{location:e,value:null};const s=this.multidimensionalSubset?.areaOfInterest;if(s&&!s.contains(e))throw new r.Z("imagery-tile-mixin:identify","the request cannot be fulfilled when falling outside of the multidimensional subset");const o=this.serviceRasterInfo?.storageInfo.isBsqTile&&this.bandIds?.length?this.bandIds:void 0;return i.identify(e,{...t,bandIds:o})}hasStandardTime(){const e=this.serviceRasterInfo?.multidimensionalInfo;if(null==e||"standard-time"!==this.serviceRasterInfo?.dataType)return!1;const t=this.multidimensionalDefinition,i=t?.[0]?.variableName;return e.variables.some((e=>e.name===i&&(!t?.[0].dimensionName||e.dimensions.some((e=>"StdTime"===e.name)))))}getStandardTimeValue(e){return new Date((0,I.de)(e)).toISOString()}getMultidimensionalSubsetVariables(e){const t=e??this.serviceRasterInfo?.multidimensionalInfo;return(0,I.jj)(this.multidimensionalSubset,t)}_configDefaultSettings(){this._configDefaultInterpolation(),this.multidimensionalDefinition||(this.multidimensionalDefinition=(0,I.Tj)(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset})),this.rasterFunction&&(0,v.p)(this.raster)&&(this._cachedRasterFunctionJson=this.rasterFunction.toJSON()),this._configDefaultRenderer()}async _initJobHandler(){if(!this._rasterJobHandler)return super._initJobHandler().then((async()=>{if(!this._rasterJobHandler)return;M(this);const{raster:e}=this;e.rasterJobHandler=this._rasterJobHandler,(0,v.p)(e)&&e.syncJobHandler(),this.rasterFunction&&await this.updateRasterFunction().catch((()=>{})),this.renderer&&this.updateRenderer()})).catch((()=>{}))}_shutdownJobHandler(){super._shutdownJobHandler(),this.raster&&(this.raster.rasterJobHandler=null)}async _getSampleLocations(e){const{geometry:t}=e;if("point"===t.type)return[t];const{spatialReference:n,type:s}=t;if("multipoint"===s)return t.points.map((e=>new p.Z({x:e[0],y:e[1],spatialReference:n})));if("polyline"===s){let s=t;if(e.sampleCount||e.sampleDistance){const n=await Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(56013)]).then(i.bind(i,56013)),r=(await Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(63923)]).then(i.bind(i,59751))).execute(t,{unit:"meters"}),o=Math.min(e.sampleCount||100,1e3);let l=e.sampleDistance;l||(l=r/(o+(2===s.paths[0].length?1:0))),s=n.execute(t,l,{unit:"meters"})}return s.paths.flatMap((e=>e.map((e=>new p.Z({x:e[0],y:e[1],spatialReference:n})))))}const r=Math.min(e.sampleCount||100,1e3),o="extent"===t.type,l=o?t:t.extent,a=Math.sqrt(l.width*l.height/r),c=l.height/a,u=l.width/a,{xmin:h,ymax:d}=l,f=[];for(let e=0;e<c;e++)for(let i=0;i<u;i++){const s=new p.Z({x:h+(i+.5)*a,y:d-(e+.5)*a,spatialReference:n});(o||t.contains(s))&&f.push(s)}return f}_configDefaultInterpolation(){if(null==this.interpolation){M(this);const{raster:e}=this,t=(0,z.In)(e.rasterInfo,e.tileType,this.sourceJSON?.defaultResamplingMethod);this._set("interpolation",t)}}_configDefaultRenderer(e="no"){M(this);const{rasterInfo:t}=this.raster,i=(0,I.N3)(t,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset})?.name,n=(0,z.RA)({variableName:i,rasterFunctionName:this.rasterFunction?.functionName,presetRenderers:this.presetRenderers});if(!this.bandIds&&t.bandCount>1&&(this.bandIds=n?.bandIds??(0,z.YD)(t)),!this.renderer||"override"===e){const e=(0,z.kc)(this.raster),s=n?.renderer??(0,z.Ob)(t,{bandIds:this.bandIds,variableName:i,rasterFunctionColorRamp:e}),r=t.statistics,o=r&&r.length>0?r[0]:null,l=o?.max??0,a=o?.min??0;"WCSServer"===this.raster.datasetFormat&&"raster-stretch"===s.type&&(l>1e24||a<-1e24)&&(s.dynamicRangeAdjustment=!0,s.customStatistics=null,"none"===s.stretchType&&(s.stretchType="min-max")),this.renderer=s}const s=(0,z.ol)({...this.renderer.toJSON(),variableName:i}),r=(0,z.FI)(t,i);this.symbolizer?(this.symbolizer.rendererJSON=s,this.symbolizer.rasterInfo=r):this.symbolizer=new F.Z({rendererJSON:s,rasterInfo:r});const l=this.symbolizer.bind();if(l.success){if("auto"===e){const{colormap:e}=this.raster.rasterInfo,t=this.renderer;if(null!=e&&"raster-colormap"===t.type){const e=(0,z.Ob)(this.raster.rasterInfo);JSON.stringify(e)!==JSON.stringify(t)&&this._configDefaultRenderer("override")}else if("raster-stretch"===t.type){const e=this.bandIds?.length,i=t.customStatistics?.length;!t.dynamicRangeAdjustment&&i&&e&&i!==e&&this._configDefaultRenderer("override")}}}else o.Z.getLogger(this).warn("imagery-tile-mixin",l.error||"The given renderer is not supported by the layer."),"auto"===e&&this._configDefaultRenderer("override")}async _updateRasterFunction(){if(this._isConstructedFromFunctionRaster&&(0,v.p)(this.raster)){const e=this.raster.rasterFunction.toJSON();return void(!this.rasterFunction&&e&&this._set("rasterFunction",b.Z.fromJSON(e)))}let e,t=this.raster,i=!1;(0,v.p)(t)?(e=t.primaryRasters.rasters,t=e[0],i=!0):e=[t];const{rasterFunction:n}=this;if(n){const i={raster:t};e.length>1&&e.forEach((e=>i[e.url]=e));const s=(0,C.Ue)(n.functionDefinition?.toJSON()??n.toJSON(),i),r=new R.Z({rasterFunction:s});r.rasterJobHandler=this._rasterJobHandler,await r.open(),this.raster=r}else this.raster=t,await t.open();if(this._cachedRendererJson=void 0,!i&&!n)return;const{bandIds:s}=this,{bandCount:r}=this.raster.rasterInfo,o=s?.length?s.some((e=>e>=r)):r>=3;s&&(o||this.renderer&&"raster-stretch"!==this.renderer.type)&&this._set("bandIds",null),this._configDefaultRenderer("auto")}_convertRasterIdentifyResultToSample(e,t){const{rasterInfo:i}=this.raster,n=i.storageInfo.pyramidScalingFactor**(e.pyramidLevel??0),s=(i.pixelSize.x+i.pixelSize.y)/2*n;if(!e.dataSeries?.length)return[new N.Z({location:e.location,pixelValue:e.value,locationId:t,resolution:s})];const r=[];return e.dataSeries.forEach((({value:i,multidimensionalDefinition:n},o)=>{const l={Variables:n[0].variableName,Dimensions:n.flatMap((({dimensionName:e})=>e)).join(",")};for(const{dimensionName:e,values:t}of n){l[e]=Array.isArray(t[0])?t[0][0]:t[0];const i=t[t.length-1];l[`${e}_Max`]=Array.isArray(i)?i[i.length-1]:i}const a=new N.Z({location:e.location,pixelValue:i,rasterId:o,locationId:t,resolution:s,attributes:l});r.push(a)})),r}};function M(e){if(!e.raster||!e.serviceRasterInfo)throw new r.Z("imagery-tile","no raster")}return(0,n._)([(0,l.Cb)({clonable:!1})],t.prototype,"_cachedRasterFunctionJson",void 0),(0,n._)([(0,l.Cb)({clonable:!1})],t.prototype,"_compatibleFullExtent",void 0),(0,n._)([(0,l.Cb)({clonable:!1})],t.prototype,"_isConstructedFromFunctionRaster",void 0),(0,n._)([(0,l.Cb)({clonable:!1})],t.prototype,"_rasterFunctionUpdatePromise",void 0),(0,n._)([(0,l.Cb)({type:[a.z8],json:{write:{overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType||"0,1,2"!==this.bandIds?.join(",")}}}}})],t.prototype,"bandIds",void 0),(0,n._)([(0,l.Cb)({json:{origins:{service:{read:{source:"copyrightText"}}}}})],t.prototype,"copyright",void 0),(0,n._)([(0,l.Cb)({json:{read:!1}})],t.prototype,"fullExtent",null),(0,n._)([(0,l.Cb)({json:{write:{overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType||"bilinear"!==this.interpolation}}}}}),(0,c.J)(_.cl)],t.prototype,"interpolation",void 0),(0,n._)([(0,l.Cb)()],t.prototype,"ioConfig",void 0),(0,n._)([(0,l.Cb)({type:[g.Z],json:{write:!0}})],t.prototype,"multidimensionalDefinition",null),(0,n._)([(0,l.Cb)({type:x.Z,json:{write:!0}})],t.prototype,"multidimensionalSubset",void 0),(0,n._)([(0,l.Cb)()],t.prototype,"raster",void 0),(0,n._)([(0,l.Cb)({type:b.Z})],t.prototype,"rasterFunction",null),(0,n._)([(0,l.Cb)()],t.prototype,"serviceRasterInfo",void 0),(0,n._)([(0,l.Cb)()],t.prototype,"sourceJSON",void 0),(0,n._)([(0,l.Cb)({readOnly:!0,type:d.Z,json:{read:!1}})],t.prototype,"spatialReference",void 0),(0,n._)([(0,l.Cb)({type:w.Z})],t.prototype,"tileInfo",void 0),(0,n._)([(0,l.Cb)(y.HQ)],t.prototype,"url",null),(0,n._)([(0,l.Cb)()],t.prototype,"renderer",null),(0,n._)([(0,l.Cb)({types:P.dr,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy(){const e="raster-stretch"===this.renderer?.type&&"none"===this.renderer.stretchType&&!this.renderer.useGamma;return{enabled:!this.loaded||"Raster"===this.raster.tileType||!e}}},origins:{"web-scene":{types:P.FK,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:e=>({enabled:e&&"vector-field"!==e.type&&"flow"!==e.type})}}}}})],t.prototype,"internalRenderer",null),(0,n._)([(0,u.r)("internalRenderer")],t.prototype,"readRenderer",null),(0,n._)([(0,l.Cb)({clonable:!1})],t.prototype,"symbolizer",void 0),t=(0,n._)([(0,h.j)("esri.layers.mixins.ImageryTileMixin")],t),t}},45107:function(e,t,i){i.d(t,{Z:function(){return c}});var n,s=i(73440),r=i(63255),o=i(17155),l=i(95226),a=(i(61432),i(83850),i(48023));let c=class extends r.Z{static{n=this}constructor(e){super(e),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new n({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};(0,s._)([(0,o.Cb)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],c.prototype,"cols",void 0),(0,s._)([(0,o.Cb)({type:l.z8,json:{write:!0}})],c.prototype,"level",void 0),(0,s._)([(0,o.Cb)({type:String,json:{write:!0}})],c.prototype,"levelValue",void 0),(0,s._)([(0,o.Cb)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],c.prototype,"origin",void 0),(0,s._)([(0,o.Cb)({type:Number,json:{write:!0}})],c.prototype,"resolution",void 0),(0,s._)([(0,o.Cb)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],c.prototype,"rows",void 0),(0,s._)([(0,o.Cb)({type:Number,json:{write:!0}})],c.prototype,"scale",void 0),c=n=(0,s._)([(0,a.j)("esri.layers.support.LOD")],c)},97550:function(e,t,i){i.d(t,{Z:function(){return w}});var n,s=i(73440),r=i(41773),o=i(63255),l=i(26636),a=i(17155),c=i(95226),u=(i(61432),i(83850),i(1194)),h=i(48023),p=i(29884),d=i(60508),f=i(45213),m=i(47566),y=i(8554),g=i(97290),x=i(45107),_=i(31743);const b=new r.X({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});let w=class extends o.Z{static{n=this}static create(e={}){const{resolutionFactor:t=1,scales:i,size:s=256,spatialReference:r=f.Z.WebMercator,numLODs:o=24}=e;if(!(0,y.JY)(r)){const e=[];if(i)for(let t=0;t<i.length;t++){const n=i[t];e.push(new x.Z({level:t,scale:n,resolution:n}))}else{let t=5e-4;for(let i=o-1;i>=0;i--)e.unshift(new x.Z({level:i,scale:t,resolution:t})),t*=2}return new n({dpi:96,lods:e,origin:new d.Z(0,0,r),size:[s,s],spatialReference:r})}const a=(0,y.C5)(r),c=e.origin?new d.Z({x:e.origin.x,y:e.origin.y,spatialReference:r}):new d.Z(a?{x:a.origin[0],y:a.origin[1],spatialReference:r}:{x:0,y:0,spatialReference:r}),u=1/(39.37*(0,l.c9)(r)*96),h=[];if(i)for(let e=0;e<i.length;e++){const t=i[e],n=t*u;h.push(new x.Z({level:e,scale:t,resolution:n}))}else{let e=(0,y.sT)(r)?512/s*591657527.5917094:256/s*591657527.591555;const i=Math.ceil(o/t);h.push(new x.Z({level:0,scale:e,resolution:e*u}));for(let n=1;n<i;n++){const i=e/2**t,s=i*u;h.push(new x.Z({level:n,scale:i,resolution:s})),e=i}}return new n({dpi:96,lods:h,origin:c,size:[s,s],spatialReference:r})}constructor(e){super(e),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:e,origin:t}=this;if(e&&t){const i=(0,y.C5)(e);return e.isWrappable&&!!i&&Math.abs(i.origin[0]-t.x)<=i.dx}return!1}readOrigin(e,t){return d.Z.fromJSON({spatialReference:t.spatialReference,...e})}set lods(e){let t=0,i=0;const n=[],s=this._levelToLOD={};e&&(t=-1/0,i=1/0,e.forEach((e=>{n.push(e.scale),t=e.scale>t?e.scale:t,i=e.scale<i?e.scale:i,s[e.level]=e}))),this._set("scales",n),this._set("lods",e),this._initializeUpsampleLevels()}readSize(e,t){return[t.cols,t.rows]}writeSize(e,t){t.cols=e[0],t.rows=e[1]}zoomToScale(e){const t=this.scales;if(e<=0)return t[0];if(e>=t.length-1)return t[t.length-1];const i=Math.floor(e),n=i+1;return t[i]/(t[i]/t[n])**(e-i)}scaleToZoom(e){const t=this.scales,i=t.length-1;let n=0;for(;n<i;n++){const i=t[n],s=t[n+1];if(i<=e)return n;if(s===e)return n+1;if(i>e&&s<e)return n+Math.log(i/e)/Math.log(i/s)}return n}tileAt(e,t,i,n){const s=this.lodAt(e);if(!s)return null;let r,o;if("number"==typeof t)r=t,o=i;else if((0,y.fS)(t.spatialReference,this.spatialReference))r=t.x,o=t.y,n=i;else{const e=(0,g.iV)(t,this.spatialReference);if(null==e)return null;r=e.x,o=e.y,n=i}const l=s.resolution*this.size[0],a=s.resolution*this.size[1];return n||(n=new _.f(null,0,0,0,(0,m.Ue)())),n.level=e,n.row=Math.floor((this.origin.y-o)/a+.001),n.col=Math.floor((r-this.origin.x)/l+.001),this.updateTileInfo(n),n}updateTileInfo(e,t=n.ExtrapolateOptions.NONE){let i=this.lodAt(e.level);if(!i&&t===n.ExtrapolateOptions.POWER_OF_TWO){const t=this.lods[this.lods.length-1];t.level<e.level&&(i=t)}if(!i)return;const s=e.level-i.level,r=i.resolution*this.size[0]/2**s,o=i.resolution*this.size[1]/2**s;e.id=`${e.level}/${e.row}/${e.col}`,e.extent||(e.extent=(0,m.Ue)()),e.extent[0]=this.origin.x+e.col*r,e.extent[1]=this.origin.y-(e.row+1)*o,e.extent[2]=e.extent[0]+r,e.extent[3]=e.extent[1]+o}upsampleTile(e){const t=this._upsampleLevels[e.level];return!(!t||-1===t.parentLevel||(e.level=t.parentLevel,e.row=Math.floor(e.row/t.factor+.001),e.col=Math.floor(e.col/t.factor+.001),this.updateTileInfo(e),0))}getTileBounds(e,t){const i=this.lodAt(t.level);if(null==i)return null;const{resolution:n}=i,s=n*this.size[0],r=n*this.size[1];return e[0]=this.origin.x+t.col*s,e[1]=this.origin.y-(t.row+1)*r,e[2]=e[0]+s,e[3]=e[1]+r,e}lodAt(e){return this._levelToLOD?.[e]??null}clone(){return n.fromJSON(this.write({}))}getCompatibleForVTL(e){if(this.size[0]!==this.size[1]||256===this.size[0]&&512===e)return null;const t=(512===this.size[0]&&256===e?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===e&&0===t)return this;const i=[],s=this.lods.length-t;for(let e=0;e<s;e++){const n=e+t,{scale:s,resolution:r}=n>=0?this.lods[n]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};i.push(new x.Z({level:e,scale:s,resolution:r}))}return new n({size:[e,e],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:i})}_initializeUpsampleLevels(){const e=this.lods;this._upsampleLevels=[];let t=null;for(let i=0;i<e.length;i++){const n=e[i];this._upsampleLevels[n.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/n.resolution:0},t=n}}};(0,s._)([(0,a.Cb)({type:Number,json:{write:!0}})],w.prototype,"compressionQuality",void 0),(0,s._)([(0,a.Cb)({type:Number,json:{write:!0}})],w.prototype,"dpi",void 0),(0,s._)([(0,a.Cb)({type:String,json:{read:b.read,write:b.write,origins:{"web-scene":{read:!1,write:!1}}}})],w.prototype,"format",void 0),(0,s._)([(0,a.Cb)({readOnly:!0})],w.prototype,"isWrappable",null),(0,s._)([(0,a.Cb)({type:d.Z,json:{write:!0}})],w.prototype,"origin",void 0),(0,s._)([(0,u.r)("origin")],w.prototype,"readOrigin",null),(0,s._)([(0,a.Cb)({type:[x.Z],value:null,json:{write:!0}})],w.prototype,"lods",null),(0,s._)([(0,a.Cb)({readOnly:!0})],w.prototype,"scales",void 0),(0,s._)([(0,a.Cb)({cast:e=>Array.isArray(e)?e:"number"==typeof e?[e,e]:[256,256]})],w.prototype,"size",void 0),(0,s._)([(0,u.r)("size",["rows","cols"])],w.prototype,"readSize",null),(0,s._)([(0,p.c)("size",{cols:{type:c.z8},rows:{type:c.z8}})],w.prototype,"writeSize",null),(0,s._)([(0,a.Cb)({type:f.Z,json:{write:!0}})],w.prototype,"spatialReference",void 0),w=n=(0,s._)([(0,h.j)("esri.layers.support.TileInfo")],w),function(e){var t;(t=e.ExtrapolateOptions||(e.ExtrapolateOptions={}))[t.NONE=0]="NONE",t[t.POWER_OF_TWO=1]="POWER_OF_TWO"}(w||(w={}))},31743:function(e,t,i){i.d(t,{f:function(){return n}});class n{constructor(e,t,i,n,s){this.id=e,this.level=t,this.row=i,this.col=n,this.extent=s}}},36129:function(e,t,i){i.d(t,{Z:function(){return M}});var n=i(73440),s=i(78619),r=i(88194),o=i(63255),l=i(96711),a=i(93568),c=i(5640),u=i(17155),h=i(95226),p=(i(61432),i(83850),i(48023)),d=i(71354),f=i(60508),m=i(45213),y=i(66619),g=i(93295),x=i(68004),_=i(45107),b=i(17710),w=i(97550),v=i(74379),R=i(57528);var I=i(9524);const S=new Map,C=new class{constructor(e=15e3,t=5e3){this._timer=null,this._cachedBlocks=new Map,this._size=-1,this._duration=e,this._interval=Math.min(e,t)}decreaseRefCount(e,t){const i=e+"/"+t,n=this._cachedBlocks;if(n.has(i)){const e=n.get(i);return e.refCount--,e.refCount<=0&&(n.delete(i),e.controller&&e.controller.abort()),e.refCount}return 0}getBlock(e,t){const i=e+"/"+t,n=this._cachedBlocks;if(n.has(i)){const e=n.get(i);return e.ts=Date.now(),e.refCount++,n.delete(i),n.set(i,e),e.block}return null}putBlock(e,t,i,n){const s=this._cachedBlocks,r=e+"/"+t;if(s.has(r)){const e=s.get(r);e.ts=Date.now(),e.refCount++}else s.set(r,{block:i,ts:Date.now(),refCount:1,controller:n});this._trim(),this._updateTimer()}deleteBlock(e,t){const i=this._cachedBlocks,n=e+"/"+t;i.has(n)&&i.delete(n)}updateMaxSize(e){this._size=e,this._trim()}empty(){this._cachedBlocks.clear(),this._clearTimer()}getCurrentSize(){return this._cachedBlocks.size}_updateTimer(){if(null!=this._timer)return;const e=this._cachedBlocks;this._timer=setInterval((()=>{const t=Array.from(e),i=Date.now();for(let n=0;n<t.length&&t[n][1].ts<=i-this._duration;n++)e.delete(t[n][0]);0===e.size&&this._clearTimer()}),this._interval)}_trim(){const e=this._cachedBlocks;if(-1===this._size||this._size>=e.size)return;const t=Array.from(e);for(let i=0;i<t.length-this._size;i++)e.delete(t[i][0])}_clearTimer(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)}};function k(e,t,i){const n=S.get(e);if(!n)return null==t?C.decreaseRefCount(e,i):0;if(null==t||null==n[t])return C.decreaseRefCount(e,i);const s=n[t]?.cache,r=s?.get(i);if(s&&r){if(r.refCount--,0===r.refCount){s.delete(i);for(let e=0;e<n.length;e++)n[e]?.cache.delete(i);r.controller&&r.controller.abort()}return r.refCount}return 0}function T(e,t,i){const n=S.get(e);if(!n)return null==t?C.getBlock(e,i):null;if(null==t||null==n[t]){for(let e=0;e<n.length;e++){const t=n[e]?.cache.get(i);if(t)return t.refCount++,t.block}return C.getBlock(e,i)}const s=n[t]?.cache.get(i);if(s)return s.refCount++,s.block;for(let e=0;e<n.length;e++){if(e===t||!n[e])continue;const s=n[e]?.cache,r=s?.get(i);if(s&&r)return r.refCount++,s.set(i,r),r.block}return null}function z(e,t,i,n,s=null){const r=S.get(e);if(!r)return void(null==t&&C.putBlock(e,i,n,s));if(null==t||null==r[t])return void C.putBlock(e,i,n,s);const o={refCount:1,block:n,isResolved:!1,isRejected:!1,controller:s};n.then((()=>o.isResolved=!0)).catch((()=>o.isRejected=!0)),r[t]?.cache.set(i,o)}function F(e,t,i){const n=S.get(e);n?null!=t&&null!=n[t]?n[t]?.cache.delete(i):C.deleteBlock(e,i):null==t&&C.deleteBlock(e,i)}var P=i(2003),B=i(89014),N=i(91172),D=i(44946);let O=0,M=class extends o.Z{constructor(){super(...arguments),this._tileFetchQueue=new c.QueueProcessor({concurrency:32,process:(e,t)=>this._fetchRawTile(e.pyramidLevel,e.row,e.col,{...e.options,signal:t})}),this.datasetName=null,this.datasetFormat=null,this.hasUniqueSourceStorageInfo=!0,this.rasterInfo=null,this.ioConfig={sampling:"closest"}}normalizeCtorArgs(e){return e?.ioConfig&&(e={...e,ioConfig:{resolution:null,bandIds:null,sampling:"closest",tileInfo:w.Z.create(),...e.ioConfig}}),e}get _isGlobalWrappableSource(){const{rasterInfo:e}=this,t=(0,I.ut)(e.spatialReference);return null!=t&&e.extent.width>=t/2}get _hasNoneOrGCSShiftTransform(){const{transform:e}=this.rasterInfo;return null==e||"gcs-shift"===e.type}set rasterJobHandler(e){this._set("rasterJobHandler",e),(0,v.p)(this)&&this.primaryRasters?.rasters?.forEach((t=>t.rasterJobHandler=e))}get rasterId(){return this.url||"rasterId-"+O++}set url(e){this._set("url",(0,y.Nm)(e,l.Z.getLogger(this)))}async open(e){return this._openPromise??=(0,I.zD)().then((()=>this._open(e))),this._openPromise}async fetchTile(e,t,i,n={}){const s=n.tileInfo||this.rasterInfo.storageInfo.tileInfo,r=this.getTileExtentFromTileInfo(e,t,i,s);return n={noClip:!0,...n},this.fetchPixels(r,s.size[0],s.size[1],n)}async identify(e,t={}){e=(0,h.TJ)(f.Z,e).clone().normalize();const{multidimensionalDefinition:i,timeExtent:n}=t,{rasterInfo:s}=this,{hasMultidimensionalTranspose:r,multidimensionalInfo:o}=s;let{transposedVariableName:l}=t;const a=null!=o&&r&&(null!=n||(0,R.WU)(i));a&&!l&&(l=null!=i&&i.length>0?i[0].variableName??void 0:o.variables[0].name,t={...t,transposedVariableName:l}),t=this._getRequestOptionsWithSliceId(t);const{spatialReference:c,extent:u}=s,{datumTransformation:p}=t;let m=(0,I.nF)(e,c,p);if(!u.intersects(m))return{location:m,value:null};if(null!=s.transform){const e=s.transform.inverseTransform(m);if(!s.nativeExtent.intersects(e))return{location:e,value:null};m=e}let y=0;const g=null!=l&&null!=o&&s.hasMultidimensionalTranspose;if((0,v.p)(this)){const e=this.primaryRasters.rasters[0];if(g)return e.identify(m,t);const{pixelSize:n}=s,r=3,o=n.x*r/2,l=n.y*r/2,a=new d.Z({xmin:m.x-o,xmax:m.x+o,ymin:m.y-l,ymax:m.y+l,spatialReference:c}),u={interpolation:"nearest",multidimensionalDefinition:i,sliceId:t.sliceId},{pixelBlock:h}=await e.fetchPixels(a,r,r,u),{pixelBlock:p}=await this.fetchPixels(a,r,r,u);if(null==h)return{location:m,value:null};const f=Math.floor(r*r*.5),y=!h.mask||h.mask[f]?h.pixels.map((e=>e[f])):null;let x;return null!=p&&(x=!p.mask||p.mask[f]?p.pixels.map((e=>e[f])):void 0),{location:m,value:y,processedValue:x,pyramidLevel:0}}if(!g)if(t.srcResolution)y=(0,I.kr)(t.srcResolution,s,this.ioConfig.sampling).pyramidLevel;else if(y=await this.computeBestPyramidLevelForLocation(e,t),null==y)return{location:m,value:null};const x=this.identifyPixelLocation(m,y,null,g);if(null===x)return{location:m,value:null};const{row:_,col:b,rowOffset:w,colOffset:S,blockWidth:C}=x,k=await this._tileFetchQueue.push({pyramidLevel:y,row:_,col:b,options:t},{signal:t.signal});if(!k?.pixels?.length)return{location:m,value:null};const T=w*C+S;return this._processIdentifyResult(k,{srcLocation:m,position:T,pyramidLevel:y,useTransposedTile:!!g,requestSomeSlices:a,identifyOptions:t})}async fetchPixels(e,t,i,n={}){e=(0,I.Fi)(e),n=this._getRequestOptionsWithSliceId(n);const{_hasNoneOrGCSShiftTransform:s}=this;if(n.requestRawData&&s)return this._fetchPixels(e,t,i,n);const r=(0,I.ut)(e.spatialReference),o=(0,I.Hq)(e);if(null==r||0===o||1===o&&this._isGlobalWrappableSource&&s)return this._fetchPixels(e,t,i,n);if(o>=3)return{extent:e,pixelBlock:null};const l=[],{xmin:a,xmax:c}=e,u=Math.round(r/(c-a)*t),h=u-Math.round((r/2-a)/(c-a)*t);let p=0;const f=[];for(let s=0;s<=o;s++){const m=new d.Z({xmin:0===s?a:-r/2,xmax:s===o?c-r*s:r/2,ymin:e.ymin,ymax:e.ymax,spatialReference:e.spatialReference}),y=0===s?u-h:s===o?t-p:u;p+=y,f.push(y);const g=n.disableWrapAround&&s>0?null:this._fetchPixels(m,y,i,n);l.push(g)}const m=(await Promise.all(l)).map((e=>e?.pixelBlock));let y=null;const g={width:t,height:i};return y=this.rasterJobHandler?(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:m,srcMosaicSize:g,destDimension:null,coefs:null,sampleSpacing:null,interpolation:"nearest",alignmentInfo:null,blockWidths:f},n)).pixelBlock:(0,N.us)(m,g,{blockWidths:f}),{extent:e,srcExtent:(0,I.tB)(e,this.rasterInfo.spatialReference,n.datumTransformation),pixelBlock:y}}async fetchRawPixels(e,t,i,n={}){t={x:Math.floor(t.x),y:Math.floor(t.y)};const s=await this._fetchRawTiles(e,t,i,n),{nativeExtent:r,nativePixelSize:o,storageInfo:l}=this.rasterInfo,a=2**e,c=o.x*a,u=o.y*a,h=new d.Z({xmin:r.xmin+c*t.x,xmax:r.xmin+c*(t.x+i.width-1),ymin:r.ymax-u*(t.y+i.height-1),ymax:r.ymax-u*t.y,spatialReference:r.spatialReference});if(!s)return{extent:h,srcExtent:h,pixelBlock:null};const{pixelBlocks:p,mosaicSize:f}=s;if(1===p.length&&null!=p[0]&&p[0].width===i.width&&p[0].height===i.height)return{extent:h,srcExtent:h,pixelBlock:s.pixelBlocks[0]};const m=e>0?l.pyramidBlockWidth:l.blockWidth,y=e>0?l.pyramidBlockHeight:l.blockHeight,g={x:t.x%m,y:t.y%y};let x;return x=this.rasterJobHandler?(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:p,srcMosaicSize:f,destDimension:i,clipOffset:g,clipSize:i,coefs:null,sampleSpacing:null,interpolation:n.interpolation,alignmentInfo:null,blockWidths:null},n)).pixelBlock:(0,N.us)(p,f,{clipOffset:g,clipSize:i}),{extent:h,srcExtent:h,pixelBlock:x}}fetchRawTile(e,t,i,n){throw new r.Z("BaseRaster:read-not-implemented","fetchRawTile() is not implemented")}computeExtent(e){return(0,I.tB)(this.rasterInfo.extent,e)}decodePixelBlock(e,t){return!this.rasterJobHandler||t.useCanvas?(0,B.J)(e,t):this.rasterJobHandler.decode({data:e,options:t})}async request(e,t,i=0){const{customFetchParameters:n}=this.ioConfig,{range:r,query:o,headers:l}=t;i=i??t.retryCount??this.ioConfig.retryCount;const a=r?{Range:`bytes=${r.from}-${r.to}`}:null;try{return await(0,s.Z)(e,{...t,query:{...o,...n},headers:{...l,...a}})}catch(n){if(i>0)return i--,this.request(e,t,i);throw n}}getSliceIndex(e){const{multidimensionalInfo:t}=this.rasterInfo;return null==t||null==e||0===e.length?null:(0,R.gk)(e,t)}getTileExtentFromTileInfo(e,t,i,n){const s=n.lodAt(e);return this.getTileExtent({x:s.resolution,y:s.resolution},t,i,n.origin,n.spatialReference,n.size)}updateTileInfo(){const{storageInfo:e,spatialReference:t,extent:i,pixelSize:n}=this.rasterInfo,{pyramidResolutions:s}=e;if(!e.tileInfo){const r=[],o=e.maximumPyramidLevel||0;let l=(n.x+n.y)/2,a=1/.0254*96*l;for(let e=0;e<=o&&(r.unshift(new _.Z({level:o-e,resolution:l,scale:a})),e!==o);e++)if(s){const t=(s[e].x+s[e].y)/2;a*=t/l,l=t}else l*=2,a*=2;const c=new f.Z({x:i.xmin,y:i.ymax,spatialReference:t});e.tileInfo=new w.Z({origin:c,size:[e.blockWidth,e.blockHeight],spatialReference:t,lods:r}),e.isVirtualTileInfo=!0}}createRemoteDatasetStorageInfo(e,t=512,i=512,n){const{width:s,height:r,nativeExtent:o,pixelSize:l,spatialReference:a}=e,c=new f.Z({x:o.xmin,y:o.ymax,spatialReference:a});null==n&&(n=Math.max(0,Math.round(Math.log(Math.max(s,r))/Math.LN2-8)));const u=this.computeBlockBoundary(o,512,512,{x:o.xmin,y:o.ymax},[l],n);e.storageInfo=new b.Z({blockWidth:t,blockHeight:i,pyramidBlockWidth:t,pyramidBlockHeight:i,origin:c,firstPyramidLevel:1,maximumPyramidLevel:n,blockBoundary:u})}async computeBestPyramidLevelForLocation(e,t={}){return 0}computeBlockBoundary(e,t,i,n,s,r=0,o=2){if(1===s.length&&r>0){s=[...s];let{x:e,y:t}=s[0];for(let i=0;i<r;i++)e*=o,t*=o,s.push({x:e,y:t})}const l=[],{x:a,y:c}=n;for(let n=0;n<s.length;n++){const{x:r,y:o}=s[n];l.push({minCol:Math.floor((e.xmin-a+.1*r)/t/r),maxCol:Math.floor((e.xmax-a-.1*r)/t/r),minRow:Math.floor((c-e.ymax+.1*o)/i/o),maxRow:Math.floor((c-e.ymin-.1*o)/i/o)})}return l}getPyramidPixelSize(e){const{nativePixelSize:t}=this.rasterInfo,{pyramidResolutions:i,pyramidScalingFactor:n}=this.rasterInfo.storageInfo;if(0===e)return t;if(null!=i&&i.length)return i[e-1];const s=n**e;return{x:t.x*s,y:t.y*s}}identifyPixelLocation(e,t,i,n){const{spatialReference:s,nativeExtent:r,storageInfo:o}=this.rasterInfo,{maximumPyramidLevel:l,origin:a,transposeInfo:c}=o,u=n&&null!=c?c.tileSize[0]:o.blockWidth,h=n&&null!=c?c.tileSize[1]:o.blockHeight,p=(0,I.nF)(e,s,i);if(!r.intersects(p))return null;if(t<0||t>l)return null;const d=this.getPyramidPixelSize(t),{x:f,y:m}=d,y=(a.y-p.y)/m/h,g=(p.x-a.x)/f/u,x=Math.min(h-1,Math.floor((y-Math.floor(y))*h)),_=Math.min(u-1,Math.floor((g-Math.floor(g))*u));return{pyramidLevel:t,row:Math.floor(y),col:Math.floor(g),rowOffset:x,colOffset:_,blockWidth:u,srcLocation:p}}getTileExtent(e,t,i,n,s,r){const[o,l]=r,a=n.x+i*o*e.x,c=a+o*e.x,u=n.y-t*l*e.y,h=u-l*e.y;return new d.Z({xmin:a,xmax:c,ymin:h,ymax:u,spatialReference:s})}getBlockWidthHeight(e){return{blockWidth:e>0?this.rasterInfo.storageInfo.pyramidBlockWidth:this.rasterInfo.storageInfo.blockWidth,blockHeight:e>0?this.rasterInfo.storageInfo.pyramidBlockHeight:this.rasterInfo.storageInfo.blockHeight}}isBlockOutside(e,t,i){const n=this.rasterInfo.storageInfo.blockBoundary[e];return!n||n.maxRow<t||n.maxCol<i||n.minRow>t||n.minCol>i}updateImageSpaceRasterInfo(e){const{pixelSize:t}=e,{width:i,height:n}=e,s=m.Z.WebMercator;e.spatialReference=s,e.extent=e.nativeExtent=new d.Z({xmin:-.5,ymax:.5,xmax:i-.5,ymin:.5-n,spatialReference:s}),e.isPseudoSpatialReference=!0,e.transform=null,e.pixelSize=new f.Z({x:1,y:1,spatialReference:s});const{extent:r,storageInfo:o}=e;if(o){o.origin=new f.Z({x:r.xmin,y:r.ymax,spatialReference:s});const{pyramidResolutions:i,tileInfo:n}=o;if(i&&i.forEach((e=>{e.x/=t.x,e.y/=t.y})),n){n.origin=o.origin;const t=(e.nativePixelSize.x+e.nativePixelSize.y)/2;n.lods.forEach(((e,i)=>{e.resolution=t*2**i,e.scale=96*e.resolution/.0254}))}}}async _fetchPixels(e,t,i,n={}){let s=(0,I.Hq)(e);if(s>=2)return{extent:e,pixelBlock:null};const r=this._getSourceDataInfo(e,t,i,n),{pyramidLevel:o,srcResolution:l,srcExtent:a,srcWidth:c,srcHeight:u,ul:h}=r;if(0===c||0===u)return{extent:e,srcExtent:a,pixelBlock:null};const{rasterInfo:p}=this,d=p.transform,m="gcs-shift"===d?.type,y=null!=(0,I.ut)(e.spatialReference);!m&&y||(s=(0,I.Hq)(r.srcExtent,m));const g=await this._fetchRawTiles(o,h,{width:c,height:u,wrapCount:s},n);if(!g)return{extent:e,srcExtent:a,pixelBlock:null};const x=p.storageInfo,_=o>0?x.pyramidBlockWidth:x.blockWidth,b=o>0?x.pyramidBlockHeight:x.blockHeight;let{x:w,y:v}=p.pixelSize;if(o>0){const{pyramidResolutions:e,pyramidScalingFactor:t}=x;if(null!=e&&e[o-1])({x:w,y:v}=e[o-1]);else{const e=t**o;w*=e,v*=e}}const R=p.spatialReference,S=new f.Z({x:w,y:v,spatialReference:R}),C=_===c&&b===u&&h.x%_==0&&h.y%b==0,k=new f.Z({x:(e.xmax-e.xmin)/t,y:(e.ymax-e.ymin)/i,spatialReference:e.spatialReference}),T=!e.spatialReference.equals(R),z=R.isGeographic?1e-9:1e-4,{datumTransformation:F}=n;if(!T&&C&&1===g.pixelBlocks.length&&_===t&&b===i&&function(e,t,i){return Math.abs(e.x-t.x)<i&&Math.abs(e.y-t.y)<i}(l,k,z))return{extent:e,srcExtent:a,srcTilePixelSize:S,pixelBlock:g.pixelBlocks[0]};const P=y&&null!=(0,I.ut)(a.spatialReference)&&this._hasNoneOrGCSShiftTransform,B=n.requestProjectedLocalDirections&&this.rasterInfo.dataType.startsWith("vector");B&&!this.rasterJobHandler&&await(0,I.zD)();const O=this.rasterJobHandler?await this.rasterJobHandler.getProjectionOffsetGrid({projectedExtent:e,srcBufferExtent:g.extent,pixelSize:k.toJSON(),datumTransformation:F,rasterTransform:d,hasWrapAround:s>0||P,isAdaptive:!1!==this.ioConfig.optimizeProjectionAccuracy,includeGCSGrid:B},n):(0,I.Qp)({projectedExtent:e,srcBufferExtent:g.extent,pixelSize:k,datumTransformation:F,rasterTransform:d,hasWrapAround:s>0||P,isAdaptive:!1,includeGCSGrid:B});let M;const Z=!n.requestRawData,E={rows:O.spacing[0],cols:O.spacing[1]},J=this._hasNoneOrGCSShiftTransform?this._getRasterTileAlignmentInfo(o,g.extent.xmin):void 0,{pixelBlocks:H,mosaicSize:W,isPartiallyFilled:L}=g;let q=null;if(this.rasterJobHandler){const e=await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:H,srcMosaicSize:W,destDimension:Z?{width:t,height:i}:null,coefs:Z?O.coefficients:null,sampleSpacing:Z?E:null,projectDirections:B,gcsGrid:B?O.gcsGrid:null,isUV:"vector-uv"===this.rasterInfo.dataType,interpolation:n.interpolation,alignmentInfo:J,blockWidths:null},n);({pixelBlock:M,localNorthDirections:q}=e)}else{const e=(0,N.us)(H,W,{alignmentInfo:J});M=Z?(0,N.Uk)(e,{width:t,height:i},O.coefficients,E,n.interpolation):e,B&&O.gcsGrid&&(q=(0,N.Qh)({width:t,height:i},O.gcsGrid),M=(0,D.xQ)(M,this.rasterInfo.dataType,q))}return n.requestRawData||B?{extent:e,srcExtent:a,srcTilePixelSize:S,pixelBlock:M,transformGrid:O,localNorthDirections:q,isPartiallyFilled:L}:{extent:e,srcExtent:a,srcTilePixelSize:S,pixelBlock:M}}async _fetchRawTiles(e,t,i,n){const{origin:s,blockBoundary:r}=this.rasterInfo.storageInfo,{blockWidth:o,blockHeight:l}=this.getBlockWidthHeight(e);let{x:a,y:c}=t,{width:u,height:h,wrapCount:p}=i;const f=this._getRasterTileAlignmentInfo(e,0);n.buffer&&(a-=n.buffer.cols,c-=n.buffer.rows,u+=2*n.buffer.cols,h+=2*n.buffer.rows);let m=0,y=0,g=0;p&&null!=f&&(({worldColumnCountFromOrigin:y,originColumnOffset:g,rightPadding:m}=f),y*f.blockWidth-m>=a+u&&(m=0));const x=Math.floor(a/o),_=Math.floor(c/l),b=Math.floor((a+u+m-1)/o),w=Math.floor((c+h+m-1)/l),v=r[e];if(!v)return null;const{minRow:R,minCol:I,maxCol:S,maxRow:C}=v;if(0===p&&(w<R||b<I||_>C||x>S))return null;const k=new Array;let T=!1;const z=null==this.ioConfig.allowPartialFill?n.allowPartialFill:this.ioConfig.allowPartialFill;for(let t=_;t<=w;t++)for(let i=x;i<=b;i++){let s=i;if(!n.disableWrapAround&&p&&null!=f&&y<=i&&(s=i-y-g),t>=R&&s>=I&&C>=t&&S>=s){const i=this._tileFetchQueue.push({pyramidLevel:e,row:t,col:s,options:n},{signal:n.signal});z?k.push(new Promise((e=>{i.then((t=>e(t))).catch((()=>{T=!0,e(null)}))}))):k.push(i)}else k.push(Promise.resolve(null))}if(0===k.length)return null;const F=await Promise.all(k),P={height:(w-_+1)*l,width:(b-x+1)*o},{spatialReference:B}=this.rasterInfo,N=this.getPyramidPixelSize(e),{x:D,y:O}=N;return{extent:new d.Z({xmin:s.x+x*o*D,xmax:s.x+(b+1)*o*D,ymin:s.y-(w+1)*l*O,ymax:s.y-_*l*O,spatialReference:B}),pixelBlocks:F,mosaicSize:P,isPartiallyFilled:T}}_fetchRawTile(e,t,i,n){const{storageInfo:s}=this.rasterInfo,r=null!=s.transposeInfo&&!!n.transposedVariableName;if(!r){const n=s.blockBoundary[e];if(!n)return Promise.resolve(null);const{minRow:r,minCol:o,maxCol:l,maxRow:a}=n;if(t<r||i<o||t>a||i>l)return Promise.resolve(null)}const o=r?n.transposeVariableName:n.sliceId,l=this.rasterInfo.storageInfo.isBsqTile?n.bandIds:null,c=function(e,t,i){const n=[];return null!=t&&n.push(`sliceId=${t}`),null!=i&&n.push(`bandIds=${i.join(",")}`),n.length?`${e}?${n.join("&")}`:e}(this.rasterId,o,l),u=`${e}/${t}/${i}`;let h=T(c,n.registryId,u);if(null==h){const s=new AbortController;h=this.fetchRawTile(e,t,i,{...n,signal:s.signal}),z(c,n.registryId,u,h,s),h.catch((()=>F(c,n.registryId,u)))}return n.signal&&(0,a.fu)(n,(()=>{k(c,n.registryId,u)})),h}_computeMagDirValues(e){const{bandCount:t,dataType:i}=this.rasterInfo;if((2!==t||"vector-magdir"!==i)&&"vector-uv"!==i||2!==e?.length||!e[0]?.length)return null;const n=e[0].length;if("vector-magdir"===i){const t=e[1].map((e=>(e+360)%360));return[e[0],t]}const[s,r]=e,o=[],l=[];for(let e=0;e<n;e++){const[t,i]=(0,D.Tg)([s[e],r[e]]);o.push(t),l.push(i)}return[o,l]}_getRasterTileAlignmentInfo(e,t){return null==this._rasterTileAlignmentInfo&&(this._rasterTileAlignmentInfo=(0,I.P_)(this.rasterInfo)),null==this._rasterTileAlignmentInfo.pyramidsInfo?null:{startX:t,halfWorldWidth:this._rasterTileAlignmentInfo.halfWorldWidth,hasGCSSShiftTransform:this._rasterTileAlignmentInfo.hasGCSSShiftTransform,...this._rasterTileAlignmentInfo.pyramidsInfo[e]}}_getSourceDataInfo(e,t,i,n={}){const s={datumTransformation:n.datumTransformation,pyramidLevel:0,pyramidResolution:null,srcExtent:null,srcHeight:0,srcResolution:null,srcWidth:0,ul:{x:0,y:0}};n.srcResolution&&(s.srcResolution=n.srcResolution,this._updateSourceDataInfo(e,s));const r=this.rasterInfo.storageInfo.maximumPyramidLevel||0,{srcWidth:o,srcHeight:l,pyramidLevel:a}=s,c=o/t,u=l/i,h=a<r&&c*u>=16,p=a===r&&this._requireTooManySrcTiles(o,l,t,i);if(h||p||0===o||0===l){const o=new f.Z({x:(e.xmax-e.xmin)/t,y:(e.ymax-e.ymin)/i,spatialReference:e.spatialReference});let l=(0,I.VO)(o,this.rasterInfo.spatialReference,e,s.datumTransformation);const p=!l||n.srcResolution&&l.x+l.y<n.srcResolution.x+n.srcResolution.y;if(h&&n.srcResolution&&p){const e=Math.round(Math.log(Math.max(c,u))/Math.LN2)-1;if(r-a+3>=e){const t=2**e;l={x:n.srcResolution.x*t,y:n.srcResolution.y*t}}}l&&(s.srcResolution=l,this._updateSourceDataInfo(e,s))}return this._requireTooManySrcTiles(s.srcWidth,s.srcHeight,t,i)&&(s.srcWidth=0,s.srcHeight=0),s}_requireTooManySrcTiles(e,t,i,n){const{tileInfo:s}=this.rasterInfo.storageInfo,r=e/i,o=t/n;return Math.ceil(e/s.size[0])*Math.ceil(t/s.size[1])>=256*Math.max(1,(i+n)/1024)||r>8||o>8}_updateSourceDataInfo(e,t){t.srcWidth=0,t.srcHeight=0;const{rasterInfo:i}=this,n=i.spatialReference,{srcResolution:s,datumTransformation:r}=t,{pyramidLevel:o,pyramidResolution:l,excessiveReading:a}=(0,I.kr)(s,i,this.ioConfig.sampling);if(a)return;let c=t.srcExtent||(0,I.tB)(e,n,r);if(null==c)return;const u=i.transform;u&&(c=u.inverseTransform(c)),t.srcExtent=c;const{x:h,y:p}=i.storageInfo.origin,d=Math.floor((c.xmin-h)/l.x+.1),f=Math.floor((p-c.ymax)/l.y+.1),m=Math.floor((c.xmax-h)/l.x-.1),y=Math.floor((p-c.ymin)/l.y-.1),g=c.width<.1*l.x?0:m-d+1,x=c.height<.1*l.y?0:y-f+1;t.pyramidLevel=o,t.pyramidResolution=l,t.srcWidth=g,t.srcHeight=x,t.ul={x:d,y:f}}_getRequestOptionsWithSliceId(e){return null!=this.rasterInfo.multidimensionalInfo&&null==e.sliceId&&(e={...e,sliceId:this.getSliceIndex(e.multidimensionalDefinition)}),e}_processIdentifyResult(e,t){const{srcLocation:i,position:n,pyramidLevel:s,useTransposedTile:r}=t,o=e.pixels[0].length/e.width/e.height;if(e.mask&&!e.mask[n])return{location:i,value:null};const{multidimensionalInfo:l}=this.rasterInfo;if(null==l||!r){const t=e.pixels.map((e=>e[n])),r={location:i,value:t,pyramidLevel:s},o=this._computeMagDirValues(t.map((e=>[e])));return o?.length&&(r.magdirValue=o.map((e=>e[0]))),r}let a=e.pixels.map((e=>e.slice(n*o,n*o+o))),c=this._computeMagDirValues(a);const{requestSomeSlices:u,identifyOptions:h}=t;let p=(0,R.MO)(l,h.transposedVariableName);if(u){const e=(0,R.Ur)(p,h.multidimensionalDefinition,h.timeExtent);a=a.map((t=>e.map((e=>t[e])))),c=c?.map((t=>e.map((e=>t[e])))),p=e.map((e=>p[e]))}const d=e.noDataValues||this.rasterInfo.noDataValue,f={pixels:a,pixelType:e.pixelType};let m;return null!=d&&((0,P.Ao)(f,d),m=f.mask),{location:i,value:null,dataSeries:p.map(((e,t)=>{const i={value:0===m?.[t]?null:a.map((e=>e[t])),multidimensionalDefinition:e.multidimensionalDefinition.map((e=>new x.Z({...e,isSlice:!0})))};return c?.length&&(i.magdirValue=[c[0][t],c[1][t]]),i})),pyramidLevel:s}}};(0,n._)([(0,u.Cb)()],M.prototype,"_rasterTileAlignmentInfo",void 0),(0,n._)([(0,u.Cb)()],M.prototype,"_tileFetchQueue",void 0),(0,n._)([(0,u.Cb)({readOnly:!0})],M.prototype,"_isGlobalWrappableSource",null),(0,n._)([(0,u.Cb)({readOnly:!0})],M.prototype,"_hasNoneOrGCSShiftTransform",null),(0,n._)([(0,u.Cb)()],M.prototype,"_openPromise",void 0),(0,n._)([(0,u.Cb)()],M.prototype,"rasterJobHandler",null),(0,n._)([(0,u.Cb)({readOnly:!0})],M.prototype,"rasterId",null),(0,n._)([(0,u.Cb)(g.HQ)],M.prototype,"url",null),(0,n._)([(0,u.Cb)({type:String,json:{write:!0}})],M.prototype,"datasetName",void 0),(0,n._)([(0,u.Cb)({type:String,json:{write:!0}})],M.prototype,"datasetFormat",void 0),(0,n._)([(0,u.Cb)()],M.prototype,"hasUniqueSourceStorageInfo",void 0),(0,n._)([(0,u.Cb)()],M.prototype,"rasterInfo",void 0),(0,n._)([(0,u.Cb)()],M.prototype,"ioConfig",void 0),(0,n._)([(0,u.Cb)()],M.prototype,"sourceJSON",void 0),M=(0,n._)([(0,p.j)("esri.layers.support.rasterDatasets.BaseRaster")],M)},56679:function(e,t,i){i.d(t,{Z:function(){return d}});var n=i(73440),s=i(88194),r=i(17155),o=(i(61432),i(96711),i(83850),i(48023)),l=i(67764),a=i(36129),c=i(32931),u=i(91172),h=i(9524),p=i(13878);let d=class extends a.Z{constructor(){super(...arguments),this.datasetFormat="Function",this.tileType="Raster",this.rasterFunction=null,this._clippingGeometry=new Map}async fetchPixels(e,t,i,n={}){const{rasters:s,rasterIds:r}=this.primaryRasters;let o=!1;const{interpolation:l}=n,a=this.rasterFunction.flatWebGLFunctionChain?.hasFocalFunction;!n.requestRawData&&a&&(o=1===s.length&&!n.skipRasterFunction,n={...n,interpolation:"bilinear",requestRawData:o});const h=s.map((s=>s.fetchPixels(e,t,i,n))),p=await Promise.all(h),d=p.map((e=>e.pixelBlock)),f=o||n.requestRawData?p.map((e=>e.srcTilePixelSize)):null;if(n.skipRasterFunction||d.every((e=>null==e)))return p[0];const m=p.find((e=>null!=e.pixelBlock))?.extent??e;let y=this.rasterJobHandler?await this.rasterJobHandler.process({extent:m,primaryPixelBlocks:d,primaryPixelSizes:f,primaryRasterIds:r}):this.rasterFunction.process({extent:m,primaryPixelBlocks:d,primaryPixelSizes:f,primaryRasterIds:r});const{transformGrid:g}=p[0];if(!o||null==y||null==g){const e=n.noClip?null:this.getClippingGeometry(m.spatialReference);return n.noClip||n.requestRawData||null==y||!e||(y=await(0,c.oq)(y,m,e)),{...p[0],pixelBlock:y}}const x={rows:g.spacing[0],cols:g.spacing[1]};let _;_=this.rasterJobHandler?(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:[y],srcMosaicSize:{width:y.width,height:y.height},destDimension:{width:t,height:i},coefs:g.coefficients,sampleSpacing:x,projectDirections:!1,gcsGrid:null,isUV:!1,interpolation:l,alignmentInfo:void 0,blockWidths:null},n)).pixelBlock:(0,u.Uk)(y,{width:t,height:i},g.coefficients,x,l);const b=n.noClip?null:this.getClippingGeometry(e.spatialReference);return n.noClip||n.requestRawData||null==_||null==b||(_=await(0,c.oq)(_,e,b)),{extent:e,srcExtent:p[0].srcExtent,pixelBlock:_}}getClippingGeometry(e){const t=this._clippingGeometry.get("0");if(!e||!t)return t;const i=function(e){return String(e.wkid??e.wkt??e.wkt2)}(e);let n=this._clippingGeometry.get(i);return null!=n||(n=e.equals(t.spatialReference)?t:(0,h.Wt)(t,e),this._clippingGeometry.set(i,n)),n}async _open(e){const{rasterFunction:t}=this;t.isRoot=!0,this.primaryRasters?.rasters?.length?t.sourceRasters=this.primaryRasters.rasters:(this.primaryRasters=t.getPrimaryRasters(),this.rasterJobHandler&&this.primaryRasters.rasters?.forEach((e=>e.rasterJobHandler=this.rasterJobHandler)));const{rasters:i,rasterIds:n}=this.primaryRasters,r=i.map((t=>t.rasterInfo?void 0:t.open(e)));await Promise.all(r);const o=i.map((({rasterInfo:e})=>e)),l=t.bind({rasterInfos:o,rasterIds:n});if(t.rawSourceRasterInfos=o,!l.success||0===o.length)throw new s.Z("raster-function:open",`cannot bind the function: ${l.error??""}`);const a="Table"===t.functionName?t:t.functionArguments?.raster;"Table"===a?.functionName&&(t.rasterInfo.attributeTable=p.Z.fromJSON(a.functionArguments.attributeTableAsRecordSet)),await this.syncJobHandler();const c=o[0];this.hasUniqueSourceStorageInfo=1===o.length||o.slice(1).every((e=>function(e,t){const{storageInfo:i,pixelSize:n,spatialReference:s,extent:r}=e,{storageInfo:o,pixelSize:l,spatialReference:a,extent:c}=t;return n.x===l.x&&n.y===l.y&&s.equals(a)&&r.equals(c)&&i.blockHeight===o.blockHeight&&i.blockWidth===o.blockWidth&&i.maximumPyramidLevel===o.maximumPyramidLevel}(e,c))),this.set("sourceJSON",i[0].sourceJSON),this.set("rasterInfo",t.rasterInfo),await this._updateClipGeometry()}async syncJobHandler(){return this.rasterJobHandler?.updateRasterFunction(this.rasterFunction)}async _updateClipGeometry(){const e=this.rasterFunction.getClippingGeometries()[0];let t=e?.clippingGeometry;if(t&&"inside"===e.clippingType){const{extent:e}=this.rasterInfo,n=await Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(56013)]).then(i.bind(i,56013)),s=await Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(26637)]).then(i.bind(i,26637));let r=n.execute(l.Z.fromExtent(e),2*(e.width+e.height)/40);r=(0,h.Wt)(r,t.spatialReference),t=s.execute(r,t)}this._clippingGeometry.clear(),t&&this._clippingGeometry.set("0",t)}};(0,n._)([(0,r.Cb)({type:String,json:{write:!0}})],d.prototype,"datasetFormat",void 0),(0,n._)([(0,r.Cb)()],d.prototype,"tileType",void 0),(0,n._)([(0,r.Cb)()],d.prototype,"rasterFunction",void 0),(0,n._)([(0,r.Cb)()],d.prototype,"primaryRasters",void 0),d=(0,n._)([(0,o.j)("esri.layers.support.rasterDatasets.FunctionRaster")],d)},8761:function(e,t,i){function n(e,t){if(!e||!t)return[];let i=t;t.includes("/")?(i=t.slice(0,t.indexOf("/")),t=t.slice(t.indexOf("/")+1)):t="";const s=[];if(t){const r=n(e,i);for(let e=0;e<r.length;e++)n(r[e],t).forEach((e=>s.push(e)));return s}const r=e.getElementsByTagNameNS("*",i);if(!r||0===r.length)return[];for(let e=0;e<r.length;e++)s.push(r[e]||r.item(e));return s}function s(e,t){if(!e||!t)return null;let i=t;t.includes("/")?(i=t.slice(0,t.indexOf("/")),t=t.slice(t.indexOf("/")+1)):t="";const r=n(e,i);return r.length>0?t?s(r[0],t):r[0]:null}function r(e,t=null){const i=t?s(e,t):e;let n;return i?(n=i.textContent||i.nodeValue,n?n.trim():null):null}function o(e,t){const i=n(e,t),s=[];let r;for(let e=0;e<i.length;e++)r=i[e].textContent||i[e].nodeValue,r&&(r=r.trim(),""!==r&&s.push(r));return s}function l(e,t=null){return r(e,t)?.split(" ").map((e=>Number(e)))??[]}function a(e,t){return o(e,t).map((e=>Number(e)))}function c(e,t){const i=r(e,t);return Number(i)}function u(e,t){const i=e?.nodeName?.toLowerCase(),n=t.toLowerCase();return i.slice(i.lastIndexOf(":")+1)===n}function h(e){return e.nodeName.slice(e.nodeName.lastIndexOf(":")+1)}i.d(t,{$3:function(){return n},N:function(){return c},W9:function(){return u},Y:function(){return r},ZB:function(){return h},kH:function(){return l},sb:function(){return s},tz:function(){return o},uu:function(){return a}})}}]);