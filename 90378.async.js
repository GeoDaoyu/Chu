"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[90378,17623,82738,50820,66882],{95365:function(e,t,i){i.d(t,{r6:function(){return y}});var r,o=i(28947);i(44783),i(44252);function n(e){switch(e){case"circle":return{rings:[[[8.5,.2],[7.06,.33],[5.66,.7],[4.35,1.31],[3.16,2.14],[2.14,3.16],[1.31,4.35],[.7,5.66],[.33,7.06],[.2,8.5],[.33,9.94],[.7,11.34],[1.31,12.65],[2.14,13.84],[3.16,14.86],[4.35,15.69],[5.66,16.3],[7.06,16.67],[8.5,16.8],[9.94,16.67],[11.34,16.3],[12.65,15.69],[13.84,14.86],[14.86,13.84],[15.69,12.65],[16.3,11.34],[16.67,9.94],[16.8,8.5],[16.67,7.06],[16.3,5.66],[15.69,4.35],[14.86,3.16],[13.84,2.14],[12.65,1.31],[11.34,.7],[9.94,.33],[8.5,.2]]]};case"square":return{rings:[[[.5,.5],[.5,16.5],[16.5,16.5],[16.5,.5],[.5,.5]]]};case"diamond":return{rings:[[[8.5,.5],[.2,8.5],[8.5,16.5],[16.5,8.5],[8.5,.5]]]};case"hexagon-pointy":return{rings:[[[15.86,12.75],[15.86,4.25],[8.5,0],[1.14,4.25],[1.14,12.75],[8.5,17],[15.86,12.75]]]};case"hexagon-flat":return{rings:[[[12.75,15.86],[17,8.5],[12.75,1.14],[4.25,1.14],[0,8.5],[4.25,15.86],[12.75,15.86]]]}}}function l(e){return"CIMVectorMarker"===e?.type?e.markerGraphics?.[0]:void 0}function s(e){return"CIMPolygonSymbol"===e?.symbol?.type?e.symbol.symbolLayers?.[0]:void 0}function a(e,t){"CIMVectorMarker"===e?.type&&null!=t&&(e.size=t)}function c(e,t){const i=l(e);i&&null!=t&&(i.geometry=n(t))}function u(e,t){const i=s(l(e));i&&null!=t&&(i.color=t.toArray())}function f(e,t,i){const r=s(l(e));r&&null!=t&&i&&(r.colorLocked=t)}function y(e,t){const{outerRingSize:i,innerDotSize:n,type:l,color:s,colorLocked:y,primitiveOverrides:m}=t,p="CIMPolygonSymbol"===e.data.symbol?.type?e.data.symbol.symbolLayers:null;if(2===p?.length)for(const e of p){const t=e.primitiveName===r.OuterRing;a(e,t?i:n),c(e,l),u(e,s),f(e,y,t)}return null!=i&&null!=n&&(e.data.primitiveOverrides=null),void 0!==m&&(e.data.primitiveOverrides=(0,o.d9)(m)),e}!function(e){e.OuterRing="reference-size-outer-ring",e.InnerDot="reference-size-inner-dot"}(r||(r={}))},50820:function(e,t,i){i.r(t),i.d(t,{CIMSymbolRasterizer:function(){return y}});var r=i(90756),o=i(88890),n=i(35236);class l{constructor(){this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null,this.geometryEnginePromise=null}destroy(){this._inFlightResourceMap.clear(),this._resourceMap.clear()}getResource(e){return this._resourceMap.get(e)??null}async fetchResource(e,t){const i=this._resourceMap.get(e);if(i)return{width:i.width,height:i.height};let r=this._inFlightResourceMap.get(e);return r?r.then((e=>({width:e.width,height:e.height}))):(r=(0,n.n$)(e,t),this._inFlightResourceMap.set(e,r),r.then((t=>(this._inFlightResourceMap.delete(e),this._resourceMap.set(e,t),{width:t.width,height:t.height})),(()=>({width:0,height:0}))))}deleteResource(e){this._inFlightResourceMap.delete(e),this._resourceMap.delete(e)}loadFont(e){return(0,o.mx)(e)}}var s=i(32566),a=i(80746),c=i(17623),u=i(84210),f=i(61421);class y{constructor(e){this._spatialReference=e,this._imageDataCanvas=null,this._cimResourceManager=new l}get _canvas(){return this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas")),this._imageDataCanvas}get resourceManager(){return this._cimResourceManager}async rasterizeCIMSymbolAsync(e,t,i,o,n,l,s,y,p,h){if(!e)return null;const{data:d}=e;if(!d||"CIMSymbolReference"!==d.type||!d.symbol)return null;const{symbol:g}=d;l||(l=(0,f.JW)(g));const v=await c.OverrideHelper.resolveSymbolOverrides(d,t,this._spatialReference,n,l,s,y),b=this._cimResourceManager,w=[];a.B$.fetchResources(v,b,w),a.B$.fetchFonts(v,b,w),w.length>0&&await Promise.all(w);const{width:M,height:C}=i;let S=m(l,M,C,o,h);const I=a.B$.getEnvelope(v,S,b);if(!I)return null;I.x===1/0&&(I.x=M+2),I.y===1/0&&(I.y=-C/2),I.width===-1/0&&(I.width=M),I.height===-1/0&&(I.height=C);let x=1,k=0,R=0;switch(g.type){case"CIMPointSymbol":case"CIMTextSymbol":{let e=1;I.width>M&&(e=M/I.width);let t=1;I.height>C&&(t=C/I.height),"preview"===o&&(I.width<M&&(e=M/I.width),I.height<C&&(t=C/I.height)),x=Math.min(e,t),k=I.x+I.width/2,R=I.y+I.height/2}break;case"CIMLineSymbol":if(h){R=I.y+I.height/2,k=I.x+I.width/2;const e=I.width-M,t=I.height-C;S={paths:(0,u.bA)(S.paths,{xmin:-1*I.width/2+e,xmax:I.width/2-e,ymin:-1*I.height/2+t,ymax:I.height/2-t,width:I.width-2*e,height:I.height-2*t})}}else{(p||I.height>C)&&(x=C/I.height),R=I.y+I.height/2;const e=I.x*x+M/2,t=(I.x+I.width)*x+M/2,i=(0,r.l9)(S)?S.paths:(0,r.oU)(S)?S.rings:null;if(null===i)throw new Error("Bad geometry, can't rasterise symbol!");i[0][0][0]-=e/x,i[0][2][0]-=(t-M)/x}break;case"CIMPolygonSymbol":if(h){R=I.y+I.height/2,k=I.x+I.width/2;const e=I.width-M,t=I.height-C;S={paths:(0,u.bA)(S.rings,{xmin:-1*I.width/2+e,xmax:I.width/2-e,ymin:-1*I.height/2+t,ymax:I.height/2-t,width:I.width-2*e,height:I.height-2*t})}}else{k=I.x+I.width/2,R=I.y+I.height/2;const e=I.x*x+M/2,t=(I.x+I.width)*x+M/2,i=I.y*x+C/2,r=(I.y+I.height)*x+C/2,{rings:o}=S;e<0&&(o[0][0][0]-=e,o[0][3][0]-=e,o[0][4][0]-=e),i<0&&(o[0][0][1]+=i,o[0][1][1]+=i,o[0][4][1]+=i),t>M&&(o[0][1][0]-=t-M,o[0][2][0]-=t-M),r>C&&(o[0][2][1]+=r-C,o[0][3][1]+=r-C)}}const z={type:"cim",data:{type:"CIMSymbolReference",symbol:v}};return this.rasterize(z,M,C,k,R,x,l,1,S)}rasterize(e,t,i,r,o,n,l,a=0,c=null,u=window.devicePixelRatio||1){const{data:y}=e;if(!y||"CIMSymbolReference"!==y.type||!y.symbol)return null;const{symbol:p}=y,h=this._canvas,d=1.3333333333333333*u;h.width=t*d,h.height=i*d,l||(l=(0,f.JW)(p)),c||(c=m(l,t,i,"legend")),h.width+=2*a,h.height+=2*a;const g=h.getContext("2d",{willReadFrequently:!0}),v=s.zA.createIdentity();return v.translate(-r,-o),v.scale(n*d,-n*d),v.translate(t*d/2+a,i*d/2+a),g.clearRect(0,0,h.width,h.height),new s.cD(g,this._cimResourceManager,v,!0).drawSymbol(p,c),g.getImageData(0,0,h.width,h.height)}}function m(e,t,i,r,o){const n=-t/2+1,l=t/2-1,s=i/2-1,a=-i/2+1;if(o&&("esriGeometryPolygon"===e||"esriGeometryPolyline"===e)){const r=function(e,t,i,r){return"esriGeometryPolygon"===t?{rings:(0,u.Iu)((0,u.bA)(e.rings,{xmin:0,ymin:0,width:i,height:r}),-1*i/2,-1*r/2)}:"esriGeometryPolyline"===t?{paths:(0,u.Iu)((0,u.bA)(e.paths,{xmin:0,ymin:0,width:i,height:r}),-1*i/2,-1*r/2)}:null}(o,e,t,i);if(r)return r}switch(e){case"esriGeometryPoint":return{x:0,y:0};case"esriGeometryPolyline":return{paths:[[[n,0],[0,0],[l,0]]]};default:return"legend"===r?{rings:[[[n,s],[l,0],[l,a],[n,a],[n,s]]]}:{rings:[[[n,s],[l,s],[l,a],[n,a],[n,s]]]}}}},17623:function(e,t,i){i.d(t,{OverrideHelper:function(){return f}});var r=i(53147),o=i(92643),n=i(28947),l=i(299),s=i(15065),a=i(61421),c=i(66882);const u=e=>{if(!e)return[0,0,0,0];const{r:t,g:i,b:r,a:o}=e;return[t,i,r,255*o]};class f{static findApplicableOverrides(e,t,i){if(e&&t){if(e.primitiveName){let r=!1;for(const t of i)if(t.primitiveName===e.primitiveName){r=!0;break}if(!r)for(const r of t)r.primitiveName===e.primitiveName&&i.push(r)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const r of e.effects)f.findApplicableOverrides(r,t,i);if(e.symbolLayers)for(const r of e.symbolLayers)f.findApplicableOverrides(r,t,i);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(e.effects)for(const r of e.effects)f.findApplicableOverrides(r,t,i);if(e.markerPlacement&&f.findApplicableOverrides(e.markerPlacement,t,i),"CIMVectorMarker"===e.type){if(e.markerGraphics)for(const r of e.markerGraphics)f.findApplicableOverrides(r,t,i),f.findApplicableOverrides(r.symbol,t,i)}else"CIMCharacterMarker"===e.type?f.findApplicableOverrides(e.symbol,t,i):"CIMHatchFill"===e.type?f.findApplicableOverrides(e.lineSymbol,t,i):"CIMPictureMarker"===e.type&&f.findApplicableOverrides(e.animatedSymbolProperties,t,i)}}}static findEffectOverrides(e,t){if(!e)return null;if("CIMGeometricEffectDashes"===e.type&&(0,a.hU)(e),!t||!e.primitiveName)return{type:"cim-effect-param",effect:e,overrides:[]};const i=(0,a.Ml)(e),r=e.primitiveName,o=[];for(const e of t)e.primitiveName===r&&o.push((0,a.Ml)(e));return{type:"cim-effect-param",effect:i,overrides:(0,a.Ul)(o)}}static async resolveSymbolOverrides(e,t,i,r,o,s,c){if(!e?.symbol)return null;let{symbol:u,primitiveOverrides:y}=e;const m=!!y;if(!m&&!r)return u;u=(0,n.d9)(u),y=(0,n.d9)(y);let p=!0;if(t||(t={attributes:{}},p=!1),m){if(p||(y=y.filter((e=>!e.valueExpressionInfo?.expression.includes("$feature")))),c||(y=y.filter((e=>!e.valueExpressionInfo?.expression.includes("$view")))),y.length>0){const e=(0,a.Qf)(t.attributes),r={spatialReference:i,fields:e,geometryType:o};await f.createRenderExpressions(y,r),f.evaluateOverrides(y,t,o??"esriGeometryPoint",s,c,new l.Z(e))}f.applyOverrides(u,y)}return r&&f.applyDictionaryTextOverrides(u,t,r,null),u}static{this._expressionToRenderExpression=new Map}static async createRenderExpressions(e,t){const i=[];for(const r of e){const e=r.valueExpressionInfo;if(!e||f._expressionToRenderExpression.has(e.expression))continue;const o=(0,s.Yi)(e.expression,t.spatialReference);i.push(o),o.then((t=>f._expressionToRenderExpression.set(e.expression,t)))}i.length>0&&await Promise.all(i)}static evaluateOverrides(e,t,i,r,n,l){const s={$view:{scale:n?.scale}};for(const n of e){n.value&&"object"==typeof n.value&&(0,o.jQ)(n.value)&&("Color"===n.propertyName||"StrokeColor"===n.propertyName)&&(n.value=u(n.value));const e=n.valueExpressionInfo;if(!e)continue;const a=f._expressionToRenderExpression.get(e.expression);a&&(n.value=(0,c.default)(a,t,s,i,l,r))}}static applyDictionaryTextOverrides(e,t,i,r,o="Normal"){if(e?.type)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const n=e.symbolLayers;if(!n)return;for(const l of n)l&&"CIMVectorMarker"===l.type&&f.applyDictionaryTextOverrides(l,t,i,r,"CIMTextSymbol"===e.type?e.textCase:o)}break;case"CIMVectorMarker":{const o=e.markerGraphics;if(!o)return;for(const e of o)e&&f.applyDictionaryTextOverrides(e,t,i,r)}break;case"CIMMarkerGraphic":{const n=e.textString;if(n&&n.includes("[")){const l=(0,a.H1)(n,i);e.textString=(0,a.E_)(t,l,r,o)}}}}static applyOverrides(e,t,i,r){if(e.primitiveName)for(const o of t)if(o.primitiveName===e.primitiveName){const t=(0,a.Le)(o.propertyName);if(r&&r.push({cim:e,nocapPropertyName:t,value:e[t]}),i){let t=!1;for(const r of i)r.primitiveName===e.primitiveName&&(t=!0);t||i.push(o)}null!=o.value&&(e[t]=o.value)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const o of e.effects)f.applyOverrides(o,t,i,r);if(e.symbolLayers)for(const o of e.symbolLayers)f.applyOverrides(o,t,i,r);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(e.effects)for(const o of e.effects)f.applyOverrides(o,t,i,r);if("CIMVectorMarker"===e.type&&e.markerGraphics)for(const o of e.markerGraphics)f.applyOverrides(o,t,i,r),f.applyOverrides(o.symbol,t,i,r)}}static restoreOverrides(e){for(const t of e)t.cim[t.nocapPropertyName]=t.value}static buildOverrideKey(e){let t="";for(const i of e)void 0!==i.value&&(t+=`${i.primitiveName}${i.propertyName}${JSON.stringify(i.value)}`);return t}static toValue(e,t){if("DashTemplate"===e)return t.split(" ").map((e=>Number(e)));if("Color"===e){const e=new r.Z(t).toRgba();return e[3]*=255,e}return t}}},82738:function(e,t,i){i.d(t,{S:function(){return h},previewCIMSymbol:function(){return d}});var r=i(96094),o=i(80746),n=i(50820),l=i(17623),s=i(61421),a=i(77423),c=i(47967);const u=new n.CIMSymbolRasterizer(null),f=(0,r.Wz)(a.b_.size),y=(0,r.Wz)(a.b_.maxSize),m=(0,r.Wz)(a.b_.lineWidth);async function p(e,t,i){const r=t?.size;let o=null!=r&&"object"==typeof r&&"width"in r?r.width:r,n=null!=r&&"object"==typeof r&&"height"in r?r.height:r;if(!o||!n)if("esriGeometryPolygon"===i)o=n=t.maxSize?Math.min(t.maxSize,f):f;else{const r=await h(e,t,i);r&&(o=r.width,n=r.height),"esriGeometryPolyline"===i&&(o=t.maxSize?Math.min(t.maxSize,m):m),o=null!=o&&isFinite(o)?Math.min(o,y):f,n=null!=n&&isFinite(n)?Math.max(Math.min(n,y),1):f}return"legend"===t.style&&"esriGeometryPolyline"===i&&(o=m),{width:o,height:n}}async function h(e,t={},i){const r=t.cimOptions||t;i??=r.geometryType||(0,s.JW)(e?.data?.symbol);const{feature:n,fieldMap:a,viewParams:c}=r,f=await l.OverrideHelper.resolveSymbolOverrides(e.data,n,null,a,i,null,c);if(!f)return null;(e=e.clone()).data={type:"CIMSymbolReference",symbol:f},e.data.primitiveOverrides=void 0;const y=[];return o.B$.fetchResources(f,u.resourceManager,y),o.B$.fetchFonts(f,u.resourceManager,y),y.length>0&&await Promise.all(y),o.B$.getEnvelope(f,null,u.resourceManager)}async function d(e,t={}){const{node:i,opacity:o,symbolConfig:n}=t,l=null!=n&&"object"==typeof n&&"isSquareFill"in n&&n.isSquareFill,a=t.cimOptions||t,f=a.geometryType||(0,s.JW)(e?.data?.symbol),y=await p(e,t,f),{feature:m,fieldMap:h}=a,d=t?.geometry||l||"esriGeometryPolygon"!==f?"preview":"legend";let g=y;const v=y;if(t?.geometry&&("esriGeometryPolygon"===f||"esriGeometryPolyline"===f)){const e=200;if((0,r.F2)(y.width)<e||(0,r.F2)(y.height)<e){const t=y.width>y.height?(0,r.Wz)(e)*y.height/y.width:(0,r.Wz)(e);g={width:y.width>y.height?(0,r.Wz)(e):(0,r.Wz)(e)*y.width/y.height,height:t}}}const b=await u.rasterizeCIMSymbolAsync(e,m,g,d,h,f,null,a.viewParams,a.allowScalingUp,t?.geometry?.toJSON());if(!b)return null;const{width:w,height:M}=b,C=document.createElement("canvas");C.width=w,C.height=M,C.getContext("2d").putImageData(b,0,0);const S=(0,r.F2)(v.width),I=(0,r.F2)(v.height),x=new Image(S,I);x.src=C.toDataURL(),x.ariaLabel=t.ariaLabel??null,x.alt=t.ariaLabel??"",null!=o&&(x.style.opacity=`${o}`);let k=x;if(null!=t.effectView){const e={shape:{type:"image",x:0,y:0,width:S,height:I,src:x.src},fill:null,stroke:null,offset:[0,0]};k=(0,c.wh)([[e]],[S,I],t)}return i&&k&&i.appendChild(k),k}},66882:function(e,t,i){i.d(t,{default:function(){return l}});var r=i(88194),o=i(96711),n=i(96610);function l(e,t,i,r,n,l){if(null==e)return null;const s=e.references("geometry")&&l?a(t,r,l):t,c=e.repurposeFeature(s,n);try{return e.evaluate(c,i)}catch(e){return o.Z.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",e),null}}const s=new Map;function a(e,t,i){const{transform:l,hasZ:a,hasM:c}=i;s.has(t)||s.set(t,function(e){const t={};switch(e){case"esriGeometryPoint":return(e,i,r,o)=>(0,n.U1)(i,t,e,r,o);case"esriGeometryPolygon":return(e,i,r,o)=>(0,n.Ie)(i,t,e,r,o);case"esriGeometryPolyline":return(e,i,r,o)=>(0,n.G6)(i,t,e,r,o);case"esriGeometryMultipoint":return(e,i,r,o)=>(0,n.J9)(i,t,e,r,o);default:return o.Z.getLogger("esri.views.2d.support.arcadeOnDemand").error(new r.Z("mapview-arcade",`Unable to handle geometryType: ${e}`)),e=>e}}(t));const u=s.get(t)(e.geometry,l,a,c);return{...e,geometry:u}}},90378:function(e,t,i){i.d(t,{getRampStops:function(){return P},p5:function(){return I},QB:function(){return x}});var r=i(53147),o=i(92643),n=i(89151),l=i(95365),s=i(28947),a=i(96094),c=(i(44783),i(44252));const u="spike-height-override";(0,a.Wz)(8),(0,a.Wz)(20);function f(e){const{strokeColor:t,strokeWidth:i,symbolStyle:r}=e,o=r?.includes("solid-fill")||r?.includes("gradient-fill");let n=t?.toArray(),l=!1;return r?.includes("outline")&&o?l=!0:n=e.color?.toArray(),{type:"CIMSolidStroke",effects:y(r),enable:!0,colorLocked:l,capStyle:c.kP.Round,joinStyle:c.r4.Round,lineStyle3D:c.mC.Strip,miterLimit:4,width:i??(0,a.Wz)(1),color:n}}function y(e){if(!e?.includes("closed"))return[{type:"CIMGeometricEffectAddControlPoints",angleTolerance:90,primitiveName:"spike-control-points"},{type:"CIMGeometricEffectSuppress",suppress:!0,invert:!0,primitiveName:"spike-stroke-suppress"}]}function m(e){const{color:t,symbolStyle:i}=e,r=i?.includes("solid-fill"),o=i?.includes("gradient-fill");if(!r&&!o||!t)return;if(r)return{type:"CIMSolidFill",enable:!0,colorLocked:!1,color:t?.toArray()};const n=t.clone();return n.a=0,{type:"CIMGradientFill",enable:!0,angle:90,colorRamp:{type:"CIMMultipartColorRamp",colorRamps:[{type:"CIMLinearContinuousColorRamp",fromColor:t.toArray(),toColor:n.toArray()}],weights:[1]},gradientMethod:"Linear",gradientSize:70,gradientSizeUnits:"Relative",gradientType:"Continuous"}}function p(e,t){const{defaultHeight:i,baseWidth:o,color:n,strokeColor:l,primitiveOverrides:a,symbolStyle:c,strokeWidth:y}=t,p="CIMPointSymbol"===e.data.symbol?.type?e.data.symbol:null,d=p?.symbolLayers;if(!d)return e;const g=p.effects,v=g?.find((e=>"CIMGeometricEffectTaperedPolygon"===e.type)),b=g?.find((e=>"CIMGeometricEffectRadial"===e.type&&e.primitiveName===u));null!=o&&v&&(v.fromWidth=o),null!=i&&b&&(b.length=i);const w=d?.find((e=>"CIMSolidStroke"===e.type)),M=d?.find((e=>"CIMSolidFill"===e.type)),C=d?.find((e=>"CIMGradientFill"===e.type)),S="CIMMultipartColorRamp"===C?.colorRamp?.type&&"CIMLinearContinuousColorRamp"===C.colorRamp.colorRamps[0]?.type?C.colorRamp.colorRamps[0]:null;if(c){const e=M?.color??S?.fromColor??w?.color,i=n??(e?new r.Z(e):void 0),o=w?.color??e,s=l??(o?new r.Z(o):void 0),a=c.includes("solid-fill"),u=c.includes("gradient-fill");if(a||u||h(d,M??C),i)if(a)h(d,C),M?M.color=i?.toArray():d.push(m({...t,color:i}));else if(u)if(h(d,M),C){if(S&&n){const e=i.clone();e.a=0,S.fromColor=i.toArray(),S.toColor=e.toArray()}}else d.push(m({...t,color:i}));if(w){const e=f({...t,strokeColor:s,color:i});w.effects=e.effects,w.color=e.color,w.width=e.width,w.colorLocked=e.colorLocked}}else if(w&&(l&&(w.color=l.toArray()),null!=y&&(w.width=y)),M&&n&&(M.color=n.toArray()),S&&n){const e=n.clone();e.a=0,S.fromColor=n.toArray(),S.toColor=e.toArray()}return void 0!==a&&(e.data.primitiveOverrides=(0,s.d9)(a)),e}function h(e,t){if(!t)return;const i=e.indexOf(t);-1!==i&&e.splice(i,1)}var d=i(38096),g=i(19886),v=i(27737),b=i(82738),w=i(68578),M=i(30903),C=i(94117),S=(i(68808),i(48207));const I=30,x=12,k=[255,255,255],R=[200,200,200],z=[128,128,128];async function P(e,t,r,o,l,s,a){const c=t.legendOptions?.customValues,u=a||await L(e,r),f=t.stops,y=!!u,m=!!c,p=null!=t.minSize&&null!=t.maxSize,h=f&&f.length>1,d=!!t.target;if(!y||!m&&!(p||h&&!d))return;const g=(0,M.YW)(u);let v=!1,w=null,S=null;w=g&&!h?(0,n.NM)([t.minDataValue,t.maxDataValue]):c??await async function(e,t,r,o){const l=(await Promise.resolve().then(i.bind(i,71618))).getSizeRangeAtScale(e,r,o),s=l&&A(l);if(!l||!s)return;let a=s.map((t=>function(e,t,i){const r=i.minSize,o=i.maxSize,n=t.minDataValue,l=t.maxDataValue;let s;s=e<=r?n:e>=o?l:(e-r)/(o-r)*(l-n)+n;return s}(t,e,l)));a=(0,n.NM)(a);for(let i=1;i<a.length-1;i++){const n=await _(e,t,a[i],a[i-1],r,o);n&&(a[i]=n[0],s[i]=n[1])}return a}(t,u,o,l?.type);const I=e?.authoringInfo,x="univariate-color-size"===I?.type,k=x&&"above-and-below"===I?.univariateTheme,R=!!(0,C.$1)(e,"reference-size"),z=!!(0,C.$1)(e,"spike");if(!w&&h&&(w=f.map((e=>e.value)),v=f.some((e=>!!e.label)),"flow"===e.type&&(w=(0,n.NM)(w)),v&&(S=f.map((e=>e.label)))),g&&null!=w&&w?.length>2&&!k&&(w=[w[0],w[w.length-1]]),!w)return null;x&&5!==w?.length&&(w=A({minSize:w[0],maxSize:w[w.length-1]}));const P=g?O(e,w):null,G=(0,M.Y6)(u),N=v?null:function(e,t){const i=e.length-1;return e.map(((e,r)=>(0,C.MN)(e,r,i,t)))}(w,s),D=await Promise.all(w.map((async(i,r)=>{let n=g?P[r]:await F(t,u,i,o,l?.type),s=n;R&&(n*=24/t.maxSize||1,s=24);const a=E(u,n,e,r);return z&&"cim"===a.type&&(s=await(0,b.S)(a)),{value:i,symbol:a,label:v?S[r]:N[r],size:s,outlineSize:G}})));return D.reverse()}function O(e,t){const i=e?.authoringInfo,r="univariate-color-size"===i?.type;let o=[x,I];if(r){const e=t[0],i=t[t.length-1],r=x,n=I;o=t.map((t=>r+(t-e)/(i-e)*(n-r)))}return r&&"below"===i?.univariateTheme&&o.reverse(),o}async function L(e,t){if("flow"===e.type)return(0,C.y$)(e,t);if("pie-chart"===e.type)return new g.Z({color:null,outline:e.outline?.width?e.outline:new d.Z});let i=null,n=null;if("simple"===e.type)i=e.symbol;else if("class-breaks"===e.type){const t=e.classBreakInfos;i=t&&t[0]&&t[0].symbol,n=t.length>1}else if("unique-value"===e.type){const t=e.uniqueValueInfos;i=t?.[0]?.symbol,n=null!=t&&t.length>1}if(!i||function(e){return(0,w.dU)(e)?e.symbolLayers?.some((e=>"fill"===e?.type))??!1:e?.type.includes("fill")??!1}(i))return null;if(i=i.clone(),t||n)if(i.type.includes("3d"))G(i);else if((0,C.$1)(e,"reference-size")&&"cim"===i.type)(0,l.r6)(i,{color:t??("class-breaks"!==e.type?new r.Z(R):null)});else if((0,C.$1)(e,"spike")&&"cim"===i.type){const e=new r.Z(R),n=new r.Z(z),l=!!("CIMPointSymbol"===i.data.symbol?.type?i.data.symbol:null)?.symbolLayers?.find((({type:e})=>"CIMSolidStroke"===e))?.colorLocked;let s,a=t??void 0;if(a){const t=(0,o.EX)(a),i=(0,S.Yc)();(!i&&t>225||i&&t<25)&&(a=e,s=l?n:e)}else a=e,s=l?n:e;p(i,{color:a,strokeColor:s})}else N(i);return i}function G(e){"line-3d"===e.type?e.symbolLayers.forEach((e=>{e.material={color:z}})):e.symbolLayers.forEach((e=>{"icon"!==e.type||e.resource?.href?e.material={color:R}:(e.material={color:k},e.outline={color:z,size:1.5})}))}function N(e){const t=(0,S.Yc)();if("cim"===e.type)(0,v.ZB)(e,new r.Z(R));else if(e.type.includes("line"))e.color=z;else if(e.color=t?z:k,"simple-marker"===e.type)if(e.outline){const t=e.outline?.color?.toHex();"#ffffff"===t&&(e.outline.color=z)}else e.outline={color:z,width:1.5}}function A(e){const t=e.minSize,i=(e.maxSize-t)/4,r=[];for(let e=0;e<5;e++)r.push(t+i*e);return r}async function _(e,t,i,r,o,l){const s=await F(e,t,i,o,l),a=await F(e,t,r,o,l),c=(0,n.D2)(i),u=c.fractional;let f=c.integer,y=null,m=null;i>0&&i<1&&(y=10**u,f=(0,n.D2)(i*=y).integer);for(let r=f-1;r>=0;r--){const c=10**r;let u=Math.floor(i/c)*c,f=Math.ceil(i/c)*c;null!=y&&(u/=y,f/=y);let p=(u+f)/2;[,p]=(0,n.NM)([u,p,f],{indexes:[1]});const h=await F(e,t,u,o,l),d=await F(e,t,f,o,l),g=await F(e,t,p,o,l),v=(0,n.f1)(s,h,a,null),b=(0,n.f1)(s,d,a,null),w=(0,n.f1)(s,g,a,null);let M=v.previous<=20,C=b.previous<=20;if(M&&C&&(v.previous<=b.previous?(M=!0,C=!1):(C=!0,M=!1)),M?m=[u,h]:C?m=[f,d]:w.previous<=20&&(m=[p,g]),m)break}return m}async function F(e,t,r,o,n){const{getSize:l}=await Promise.resolve().then(i.bind(i,71618));return l(e,r,{scale:o,view:n,shape:"simple-marker"===t.type?t.style:null})}function E(e,t,i,r){"univariate-color-size"===i?.authoringInfo?.type&&"above-and-below"===i?.authoringInfo?.univariateTheme&&"class-breaks"===i.type&&(e=function(e,t){const i=e.classBreakInfos,r=i.length,o=r<2||!(t>=2)?i[0].symbol.clone():i[r-1].symbol.clone(),n=e.visualVariables?.some((e=>"color"===e.type));return n&&(o.type.includes("3d")?G(o):N(o)),o}(i,r));const o=e.clone();if((0,w.dU)(o))(0,M.YW)(o)||o.symbolLayers.forEach((e=>{"fill"!==e.type&&(e.size=t)}));else if(function(e){return"esri.symbols.SimpleMarkerSymbol"===e.declaredClass}(o))o.size=t;else if(function(e){return"esri.symbols.PictureMarkerSymbol"===e.declaredClass}(o)){const e=o.width,i=o.height;o.height=t,o.width=t*(e/i)}else!function(e){return"esri.symbols.SimpleLineSymbol"===e.declaredClass}(o)?function(e){return"esri.symbols.TextSymbol"===e.declaredClass}(o)?o.font&&(o.font.size=t):"cim"===o.type&&(0,C.$1)(i,"reference-size")?(0,l.r6)(o,{innerDotSize:t,outerRingSize:24}):"cim"===o.type&&(0,C.$1)(i,"spike")&&p(o,{defaultHeight:t,primitiveOverrides:null}):o.width=t;return o}}}]);