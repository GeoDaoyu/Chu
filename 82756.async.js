"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[82756],{82756:function(t,e,n){n.d(e,{previewSymbol2D:function(){return S}});var i=n(53147),o=n(92643),a=n(88194),l=n(88890),s=n(96094),h=n(96610),r=n(48922),c=n(77423),u=n(47967),p=n(2156);const m="picture-fill",d=c.b_.size,g=c.b_.maxSize,f=c.b_.maxOutlineSize,y=c.b_.lineWidth,w=document.createElement("canvas");function x(t,e,n){if("polygon"===t.type){const i=t.extent,o=0===i.width?1:i.width,a=0===i.height?1:i.height;t=(0,h.Kq)({originPosition:"upperLeft",scale:[o/e,a/n],translate:[i.xmin,i.ymax]},{},t);let l="";for(let e=0;e<t.rings.length;e++){const n=t.rings[e];for(let t=0;t<n.length;t++){const e=n[t][0],i=n[t][1];let o="";0===t?(o=`M${e.toString()} ${i.toString()}`,""!==l&&(o=` ${o}`),l+=o):t===n.length-1?(o=`l${e.toString()} ${i.toString()} Z`,""!==l&&(o=` ${o}`),l+=o):(o=`l${e.toString()} ${i.toString()}`,""!==l&&(o=` ${o}`),l+=o)}}return l}if("polyline"===t.type){const i=t.extent,o=0===i.width?1:i.width,a=0===i.height?1:i.height;t=(0,h.s9)({originPosition:"upperLeft",scale:[o/e,a/n],translate:[i.xmin,i.ymax]},{},t);let l="";for(let e=0;e<t.paths.length;e++){const n=t.paths[e];for(let t=0;t<n.length;t++){const e=n[t][0],i=n[t][1];let o="";0===t?(o=`M${e.toString()} ${i.toString()}`,""!==l&&(o=` ${o}`),l+=o):(o=`l${e.toString()} ${i.toString()}`,""!==l&&(o=` ${o}`),l+=o)}}return l}return""}function b(t,e){const n=w.getContext("2d"),i=[];e&&(e.weight&&i.push(e.weight),e.size&&i.push(e.size+"px"),e.family&&i.push(e.family)),n.font=i.join(" ");const{width:o,actualBoundingBoxLeft:a,actualBoundingBoxRight:l,actualBoundingBoxAscent:s,actualBoundingBoxDescent:h}=n.measureText(t);return{width:Math.ceil(Math.max(o,a+l)),height:Math.ceil(s+h),x:Math.floor(a),y:Math.floor((s-h)/2)}}function M(t){const e=t?.size;return{width:null!=e&&"object"==typeof e&&"width"in e?(0,s.F2)(e.width):null,height:null!=e&&"object"==typeof e&&"height"in e?(0,s.F2)(e.height):null}}function v(t,e){return t>e?"dark":"light"}async function S(t,e){const{shapeDescriptor:n,size:i,renderOptions:o,outputSize:h}=function(t,e){const n="number"==typeof e?.size?e?.size:null,i=null!=n?(0,s.F2)(n):null,o=null!=e?.maxSize?(0,s.F2)(e.maxSize):null;let a="angle"in t?t.angle:null;null!=e?.rotation&&(a=(a??0)+e.rotation);const l=(0,r._M)(t);let h=(0,r.mx)(t);"dark"!==k(t,245)||e?.ignoreWhiteSymbols||(h={width:.75,...h,color:"#bdc3c7"});let u=null;const p={shape:null,fill:l,stroke:h,offset:[0,0]};h?.width&&(h.width=Math.min(h.width,f));const w=h?.width||0;let v=null!=e?.size&&(null==e?.scale||e?.scale),S=0,z=0,L=!1;switch(t.type){case"simple-marker":{const n=t.style,{width:l,height:h}=M(e);let r=l===h&&null!=l?l:null!=i?i:Math.min((0,s.F2)(t.size),o||g);if(!0===e?.useMarkerSymbolSize&&null!==l&&null!==h){const e=Math.min((0,s.F2)(t.size),o||g);r=e>l&&e>h?Math.min(l,h):e}switch(S=r,z=r,n){case"circle":p.shape={type:"circle",cx:0,cy:0,r:.5*r},v||(S+=w,z+=w);break;case"cross":p.shape={type:"path",path:[{command:"M",values:[0,.5*z]},{command:"L",values:[S,.5*z]},{command:"M",values:[.5*S,0]},{command:"L",values:[.5*S,z]}]};break;case"diamond":p.shape={type:"path",path:[{command:"M",values:[0,.5*z]},{command:"L",values:[.5*S,0]},{command:"L",values:[S,.5*z]},{command:"L",values:[.5*S,z]},{command:"Z",values:[]}]},v||(S+=w,z+=w);break;case"square":p.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[S,0]},{command:"L",values:[S,z]},{command:"L",values:[0,z]},{command:"Z",values:[]}]},v||(S+=w,z+=w),a&&(L=!0);break;case"triangle":p.shape={type:"path",path:[{command:"M",values:[.5*S,0]},{command:"L",values:[S,z]},{command:"L",values:[0,z]},{command:"Z",values:[]}]},v||(S+=w,z+=w),a&&(L=!0);break;case"x":p.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[S,z]},{command:"M",values:[S,0]},{command:"L",values:[0,z]}]},a&&(L=!0);break;case"path":p.shape={type:"path",path:t.path||""},v||(S+=w,z+=w),a&&(L=!0),v=!0}break}case"simple-line":{const{width:t,height:n}=M(e),o=(0,r.iI)(h).reduce(((t,e)=>t+e),0),a=o&&Math.ceil(y/o),l=n??i??w,s=t??(o*a||y);if(v=!0,"polyline"===e?.geometry?.type&&e?.geometry?.extent){S=s,z=n??S;const t=1e3,i=.15*t;u=[S,z],z=u[0]>u[1]?t*u[1]/u[0]:t,S=u[0]>u[1]?t:t*u[0]/u[1],h?.width&&(h.width=h.width*t/(u[1]>u[0]?u[1]:u[0]),h.width>i&&(h.width=i)),p.shape={type:"path",path:x(e.geometry,S,z)}}else S=null!=e?.maxSize?Math.min(s,e.maxSize):s,z=l,h&&(h.width=l),p.shape={type:"path",path:[{command:"M",values:[l/2,z/2]},{command:"L",values:[S-l/2,z/2]}]};break}case m:case"simple-fill":{const t="object"==typeof e?.symbolConfig&&!!e?.symbolConfig?.isSquareFill,{width:n,height:o}=M(e);S=!t&&n!==o||null==n?null!=i?i:d:n,z=!t&&n!==o||null==o?S:o,v||(S+=w,z+=w),v=!0,e?.geometry?.extent&&"polygon"===e?.geometry?.type?(u=[S,z],z=u[0]>u[1]?1e3*u[1]/u[0]:1e3,S=u[0]>u[1]?1e3:1e3*u[0]/u[1],p.shape={type:"path",path:x(e.geometry,S,z)}):p.shape=t?{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[S,0]},{command:"L",values:[S,z]},{command:"L",values:[0,z]},{command:"L",values:[0,0]},{command:"Z",values:[]}]}:c.JZ.fill[0];break}case"picture-marker":{const n=Math.min((0,s.F2)(t.width),o||g),l=Math.min((0,s.F2)(t.height),o||g),{width:h,height:r}=M(e),c=h===r&&null!=h?h:null!=i?i:Math.max(n,l),u=t.width/t.height;S=u<=1?Math.ceil(c*u):c,z=u<=1?c:Math.ceil(c/u),p.shape={type:"image",x:-Math.round(S/2),y:-Math.round(z/2),width:S,height:z,src:t.url||""},a&&(L=!0);break}case"text":{const n=t,a=e?.overrideText||n.text||"Aa",l=n.font,{width:h,height:r}=M(e),c=null!=r?r:null!=i?i:Math.min((0,s.F2)(l.size),o||g),{width:u,height:m}=b(a,{weight:l.weight,size:c,family:l.family}),d=/[\uE600-\uE6FF]/.test(a);S=h??(d?c:u),z=d?c:m;let f=.5*(d?c:m);d&&(f+=5),p.shape={type:"text",text:a,x:n.xoffset||0,y:n.yoffset||f,align:"middle",alignBaseline:n.verticalAlignment,decoration:l&&l.decoration,rotated:n.rotated,kerning:n.kerning},p.font=l&&{size:c,style:l.style,decoration:l.decoration,weight:l.weight,family:l.family};break}}return{shapeDescriptor:p,size:[S,z],outputSize:u,renderOptions:{node:e?.node,scale:v,opacity:e?.opacity,rotations:[a],useRotationSize:L,effectView:e?.effectView,ariaLabel:e?.ariaLabel,clipBloomEffect:e?.clipBloomEffect}}}(t,e);if(!n.shape)throw new a.Z("symbolPreview: renderPreviewHTML2D","symbol not supported.");await async function(t,e){const n=e.fill,i=t.color;if("pattern"===n?.type&&i&&t.type!==m){const t=await(0,r.Od)(n.src,i.toCss(!0));n.src=t,e.fill=n}}(t,n),await async function(t,e,n,i){if(!("font"in t)||!t.font||"text"!==e.shape.type)return;try{await(0,l.mx)(t.font)}catch{}const{width:o,height:a}=M(i);if(!/[\uE600-\uE6FF]/.test(e.shape.text)){const{width:l,height:s,x:h,y:r}=b(e.shape.text,{weight:e.font?.weight,size:e.font?.size,family:e.font?.family});n[0]=o??l,n[1]=a??s,e.shape.x=h,e.shape.y=r;let c="angle"in t?t.angle:null;if(null!=i?.rotation&&(c=(c??0)+i.rotation),c){const t=c*(Math.PI/180),e=Math.abs(Math.sin(t)),i=Math.abs(Math.cos(t));n[1]=n[0]*e+n[1]*i}}}(t,n,i,e);const w=[[n]];if("object"==typeof e?.symbolConfig&&e?.symbolConfig?.applyColorModulation){const t=.6*i[0];w.unshift([{...n,offset:[-t,0],fill:(0,c.dc)(n.fill,-.3)}]),w.push([{...n,offset:[t,0],fill:(0,c.dc)(n.fill,.3)}]),i[0]+=2*t,o.scale=!1}"text"===t.type&&function(t,e,n,i,o){if(null!=t.haloColor&&null!=t.haloSize){o.masking??=n.map((()=>[]));const a=(0,s.F2)(t.haloSize);i[0]+=a,i[1]+=a,n.unshift([{...e,fill:null,stroke:{color:t.haloColor,width:2*a,join:"round",cap:"round"}}]),o.masking.unshift([{shape:{type:"rect",x:0,y:0,width:i[0]+2*p.c9,height:i[1]+2*p.c9},fill:[255,255,255],stroke:null},{...e,fill:[0,0,0,0],stroke:null}])}null==t.backgroundColor&&null==t.borderLineColor||(i[0]+=2*p.c9,i[1]+=2*p.c9,n.unshift([{shape:{type:"rect",x:0,y:0,width:i[0],height:i[1]},fill:t.backgroundColor,stroke:{color:t.borderLineColor,width:(0,s.F2)(t.borderLineSize)}}]),o.masking?.unshift([]))}(t,n,w,i,o);const v=(0,u.wh)(w,i,o);if(h&&v){const t="img"===v.nodeName.toLowerCase()?v:v.firstChild;"svg"===t.nodeName.toLowerCase()&&t.setAttribute("viewBox",`0 0 ${i[0].toString()} ${i[1].toString()}`),t.setAttribute("width",h[0].toString()),t.setAttribute("height",h[1].toString()),h.length>2&&(t.style.setProperty("padding-left",h[2]?.toString()+"px"),t.style.setProperty("padding-right",h[2]?.toString()+"px"),t.style.setProperty("padding-top",h[3]?.toString()+"px"),t.style.setProperty("padding-bottom",h[3]?.toString()+"px"),t.style.setProperty("box-sizing","border-box"))}return v}function k(t,e=225){const n=(0,r._M)(t),a=(0,r.mx)(t),l=!n||"type"in n?null:new i.Z(n),s=a?.color?new i.Z(a?.color):null,h=l?v((0,o.EX)(l),e):null,c=s?v((0,o.EX)(s),e):null;return c?h?h===c?h:e>=225?"light":"dark":c:h}}}]);