"use strict";(self.webpackChunkscene_pro=self.webpackChunkscene_pro||[]).push([[22149],{73749:function(t,e,n){n.d(e,{a:function(){return w},b:function(){return m},c:function(){return o},d:function(){return h},e:function(){return C},f:function(){return d},g:function(){return u},h:function(){return y},i:function(){return a},j:function(){return p},l:function(){return _},n:function(){return g},s:function(){return s},t:function(){return x},v:function(){return I}});var r=n(66130);function o(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function a(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function s(t,e,n,r,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t}function u(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function i(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function c(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function l(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function h(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function f(t,e){const n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2],a=e[3]-t[3];return Math.sqrt(n*n+r*r+o*o+a*a)}function d(t,e){const n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2],a=e[3]-t[3];return n*n+r*r+o*o+a*a}function p(t){const e=t[0],n=t[1],r=t[2],o=t[3];return Math.sqrt(e*e+n*n+r*r+o*o)}function m(t){const e=t[0],n=t[1],r=t[2],o=t[3];return e*e+n*n+r*r+o*o}function g(t,e){const n=e[0],r=e[1],o=e[2],a=e[3];let s=n*n+r*r+o*o+a*a;return s>0&&(s=1/Math.sqrt(s),t[0]=n*s,t[1]=r*s,t[2]=o*s,t[3]=a*s),t}function y(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function _(t,e,n,r){const o=e[0],a=e[1],s=e[2],u=e[3];return t[0]=o+r*(n[0]-o),t[1]=a+r*(n[1]-a),t[2]=s+r*(n[2]-s),t[3]=u+r*(n[3]-u),t}function x(t,e,n){const r=e[0],o=e[1],a=e[2],s=e[3];return t[0]=n[0]*r+n[4]*o+n[8]*a+n[12]*s,t[1]=n[1]*r+n[5]*o+n[9]*a+n[13]*s,t[2]=n[2]*r+n[6]*o+n[10]*a+n[14]*s,t[3]=n[3]*r+n[7]*o+n[11]*a+n[15]*s,t}function w(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function C(t,e){const n=t[0],o=t[1],a=t[2],s=t[3],u=e[0],i=e[1],c=e[2],l=e[3],h=(0,r.bn)();return Math.abs(n-u)<=h*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(o-i)<=h*Math.max(1,Math.abs(o),Math.abs(i))&&Math.abs(a-c)<=h*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(s-l)<=h*Math.max(1,Math.abs(s),Math.abs(l))}const R=i,M=c,b=l,T=f,S=d,F=p,q=m,I=Object.freeze(Object.defineProperty({__proto__:null,add:u,ceil:function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},copy:o,copyVec3:a,dist:T,distance:f,div:b,divide:l,dot:y,equals:C,exactEquals:w,floor:function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},inverse:function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},len:F,length:p,lerp:_,max:function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},min:function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},mul:M,multiply:c,negate:function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},normalize:g,random:function(t,e=1){const n=r.FD;let o,a,s,u,i,c;do{o=2*n()-1,a=2*n()-1,i=o*o+a*a}while(i>=1);do{s=2*n()-1,u=2*n()-1,c=s*s+u*u}while(c>=1);const l=Math.sqrt((1-i)/c);return t[0]=e*o,t[1]=e*a,t[2]=e*s*l,t[3]=e*u*l,t},round:function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},scale:h,scaleAndAdd:function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},set:s,sqrDist:S,sqrLen:q,squaredDistance:d,squaredLength:m,str:function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},sub:R,subtract:i,transformMat4:x,transformQuat:function(t,e,n){const r=e[0],o=e[1],a=e[2],s=n[0],u=n[1],i=n[2],c=n[3],l=c*r+u*a-i*o,h=c*o+i*r-s*a,f=c*a+s*o-u*r,d=-s*r-u*o-i*a;return t[0]=l*c+d*-s+h*-i-f*-u,t[1]=h*c+d*-u+f*-s-l*-i,t[2]=f*c+d*-i+l*-u-h*-s,t[3]=e[3],t}},Symbol.toStringTag,{value:"Module"}))},27583:function(t,e,n){function r(){return[0,0,0,0]}function o(t){return[t[0],t[1],t[2],t[3]]}function a(t,e,n,r){return[t,e,n,r]}function s(t,e,n,r){return[t,e,n,r]}function u(t,e=[0,0,0,0]){const n=Math.min(4,t.length);for(let r=0;r<n;++r)e[r]=t[r];return e}function i(){return[0,0,0,0]}function c(){return a(1,1,1,1)}function l(){return a(1,0,0,0)}function h(){return a(0,1,0,0)}function f(){return a(0,0,1,0)}function d(){return a(0,0,0,1)}n.d(e,{AG:function(){return p},Ue:function(){return r},al:function(){return a},d9:function(){return o},hq:function(){return m},iU:function(){return c},nI:function(){return u},vV:function(){return s}});const p=[0,0,0,0],m=c(),g=l(),y=h(),_=f(),x=d();Object.freeze(Object.defineProperty({__proto__:null,ONES:m,UNIT_W:x,UNIT_X:g,UNIT_Y:y,UNIT_Z:_,ZEROS:p,clone:o,create:r,freeze:s,fromArray:u,fromValues:a,ones:c,unitW:d,unitX:l,unitY:h,unitZ:f,zeros:i},Symbol.toStringTag,{value:"Module"}))},38415:function(t,e,n){n.r(e),n.d(e,{default:function(){return R}});var r=n(29292),o=n(88194),a=n(96711),s=n(99574),u=n(93568),i=n(8914),c=n(8554),l=n(64246),h=n(57536),f=n(95014),d=n(85240),p=n(33235),m=n(18763),g=n(31879),y=n(72866),_=n(299),x=n(43462),w=n(41801);const C="esri.layers.WFSLayer";class R{constructor(){this._customParameters=null,this._queryEngine=null,this._supportsPagination=!0}destroy(){this._queryEngine?.destroy(),this._queryEngine=null}async load(t,e={}){const{getFeatureUrl:n,getFeatureOutputFormat:r,fields:a,geometryType:s,featureType:i,maxRecordCount:c,maxTotalRecordCount:l,maxPageCount:h,objectIdField:m,customParameters:g}=t,{spatialReference:x,getFeatureSpatialReference:C}=(0,y.fU)(n,i,t.spatialReference);try{await(0,d._W)(C,x)}catch{throw new o.Z("unsupported-projection","Projection not supported",{inSpatialReference:C,outSpatialReference:x})}(0,u.k_)(e),this._customParameters=g,this._featureType=i,this._fieldsIndex=_.Z.fromLayerJSON({fields:a,dateFieldsTimeReference:a.some((t=>"esriFieldTypeDate"===t.type))?{timeZoneIANA:w.pt}:null}),this._geometryType=s,this._getFeatureUrl=n,this._getFeatureOutputFormat=r,this._getFeatureSpatialReference=C,this._maxRecordCount=c,this._maxTotalRecordCount=l,this._maxPageCount=h,this._objectIdField=m,this._spatialReference=x;let R=await this._snapshotFeatures(e);if(R.errors.length>0&&(this._supportsPagination=!1,R=await this._snapshotFeatures(e),R.errors.length>0))throw R.errors[0];const b={type:"object-id",fieldName:m};return this._queryEngine=new p.qq({fieldsIndex:this._fieldsIndex,geometryType:s,hasM:!1,hasZ:!1,featureIdInfo:b,spatialReference:x,timeInfo:null,featureStore:new f.Z({geometryType:s,hasM:!1,hasZ:!1})}),this._queryEngine.featureStore.addMany(R.features),{warnings:M(R),extent:(await this._queryEngine.fetchRecomputedExtents()).fullExtent}}async applyEdits(){throw new o.Z("wfs-source:editing-not-supported","applyEdits() is not supported on WFSLayer")}async queryFeatures(t={},e={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQuery(t,e.signal)}async queryFeatureCount(t={},e={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForCount(t,e.signal)}async queryObjectIds(t={},e={}){return await this._waitSnapshotComplete(),(await this._queryEngine.executeQueryForIds(t,e.signal)).filter(x.hj)}async queryExtent(t={},e={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForExtent(t,e.signal)}async querySnapping(t,e={}){return await this._waitSnapshotComplete(),(0,h.T)(this._queryEngine,t,e.signal)}async queryAttributeBins(t,e={}){return await this._waitSnapshotComplete(),this._queryEngine.executeAttributeBinsQuery(t,e.signal)}async refresh(t){return this._customParameters=t.customParameters,this._maxRecordCount=t.maxRecordCount,this._maxTotalRecordCount=t.maxTotalRecordCount,this._maxPageCount=t.maxPageCount,this._snapshotTask?.abort(),this._snapshotTask=(0,r.vr)((t=>this._snapshotFeatures({signal:t}))),this._snapshotTask.promise.then((t=>{this._queryEngine.featureStore.clear(),this._queryEngine.featureStore.addMany(t.features);for(const e of M(t))a.Z.getLogger(C).warn(new i.Z("wfs-layer:refresh-warning",e.message,e.details));t.errors?.length&&a.Z.getLogger(C).warn(new i.Z("wfs-layer:refresh-error","Refresh completed with errors",{errors:t.errors}))}),(()=>{this._queryEngine.featureStore.clear()})),await this._waitSnapshotComplete(),{extent:(await this._queryEngine.fetchRecomputedExtents()).fullExtent}}async _waitSnapshotComplete(){if(this._snapshotTask&&!this._snapshotTask.finished){try{await this._snapshotTask.promise}catch{}return this._waitSnapshotComplete()}}async _snapshotFeatures(t){const e=t?.signal,n=this._maxTotalRecordCount,r=this._maxPageCount,o=this._supportsPagination&&r>1?await(0,y.bx)(this._getFeatureUrl,this._featureType.typeName,{customParameters:this._customParameters,signal:e}):void 0;let a=[];const i=[];if(null==o)try{a=await this._singleQuery(e)}catch(t){(0,u.D_)(t)||i.push(t)}else{const t=Math.min(o,n),c=function*(t,e,n){for(let r=0;r<e;r++)yield t._pageQuery(r,n)}(this,(0,s.uZ)(Math.ceil(t/this._maxRecordCount),1,r),e);await Promise.allSettled(Array.from({length:10}).map((()=>async function(t,e,n){let r=t.next();for(;!r.done;){try{const t=await r.value;e.push(...t)}catch(t){(0,u.D_)(t)||n.push(t)}r=t.next()}}(c,a,i))))}return(0,u.k_)(e),{features:a,totalRecordCount:o,maxTotalRecordCount:n,maxPageCount:r,errors:i}}async _singleQuery(t){const e=Number.isFinite(this._maxRecordCount)&&this._maxRecordCount>0?this._maxRecordCount:void 0,n=await(0,y.Bm)(this._getFeatureUrl,this._featureType.typeName,this._getFeatureSpatialReference,this._getFeatureOutputFormat,{customParameters:this._customParameters,count:e,signal:t});return this._processGeoJSON(n,{signal:t})}async _pageQuery(t,e){const n=t*this._maxRecordCount,r=await(0,y.Bm)(this._getFeatureUrl,this._featureType.typeName,this._getFeatureSpatialReference,this._getFeatureOutputFormat,{customParameters:this._customParameters,startIndex:n,count:this._maxRecordCount,signal:e});return this._processGeoJSON(r,{startIndex:n,signal:e})}_processGeoJSON(t,e){(0,m.O3)(t,this._getFeatureSpatialReference.wkid);const{startIndex:n,signal:r}=e;(0,u.k_)(r);const o=(0,m.lG)(t,{geometryType:this._geometryType,hasZ:!1,objectIdField:this._objectIdField});if(!(0,c.fS)(this._spatialReference,this._getFeatureSpatialReference))for(const t of o)null!=t.geometry&&(t.geometry=(0,l.GH)((0,d.iV)((0,l.di)(t.geometry,this._geometryType,!1,!1),this._getFeatureSpatialReference,this._spatialReference)));let a=n??1;for(const t of o){const e={};(0,g.O0)(this._fieldsIndex,e,t.attributes,!0),t.attributes=e,null==e[this._objectIdField]&&(t.objectId=e[this._objectIdField]=a++)}return o}}function M(t){const e=[];return null!=t.totalRecordCount&&(t.features.length<t.totalRecordCount&&e.push({name:"wfs-layer:maxRecordCount-too-low",message:`Could only fetch ${t.features.length} of ${t.totalRecordCount} in ${t.maxPageCount} queries. Try increasing the value of WFSLayer.maxRecordCount.`,details:{recordCount:t.features.length,totalRecordCount:t.totalRecordCount}}),t.totalRecordCount>t.maxTotalRecordCount&&e.push({name:"wfs-layer:large-dataset",message:`The number of ${t.totalRecordCount} features exceeds the maximum allowed of ${t.maxTotalRecordCount}.`,details:{recordCount:t.features.length,totalRecordCount:t.totalRecordCount,maxTotalRecordCount:t.maxTotalRecordCount}})),e}},31879:function(t,e,n){n.d(e,{O0:function(){return f},av:function(){return i},b:function(){return g},d1:function(){return l},eR:function(){return y},og:function(){return m}});var r=n(70243),o=n(8554),a=n(76554);class s{constructor(t){this.description=t,this.code=null}}class u{constructor(t){this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error=new s(t)}}function i(t){return new u(t)}class c{constructor(t){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=t}}function l(t){return new c(t)}const h=new Set;function f(t,e,n,r=!1){h.clear();for(const o in n){const s=t.get(o);if(!s)continue;const u=d(s,n[o]);if(h.add(s.name),s&&(r||s.editable)){const t=(0,a.Qc)(s,u);if(t)return i((0,a.vP)(t,s,u));e[s.name]=u}}for(const e of t.requiredFields??[])if(!h.has(e.name))return i(`missing required field "${e.name}"`);return null}function d(t,e){let n=e;return(0,a.H7)(t)&&"string"==typeof e?n=parseFloat(e):(0,a.qN)(t)&&null!=e&&"string"!=typeof e?n=String(e):(0,a.y2)(t)&&"string"==typeof e&&(n=(0,r.sG)(e)),(0,a.Pz)(n)}let p;function m(t,e){if(!t||!(0,o.JY)(e))return t;if("rings"in t||"paths"in t){if(null==p)throw new TypeError("geometry engine not loaded");return p.simplify(e,t)}return t}async function g(t,e){!(0,o.JY)(t)||"esriGeometryPolygon"!==e&&"esriGeometryPolyline"!==e||await async function(){return null==p&&(p=await Promise.all([n.e(27093),n.e(13323)]).then(n.bind(n,69339))),p}()}const y={supportsAutoIntervalBin:!0,supportsFixedIntervalBin:!0,supportsFixedBoundariesBin:!0,supportsDateBin:!0,supportsStackBy:!0,supportsSplitBy:!0,supportsNormalization:!0,supportedStatisticTypes:["COUNT","SUM","AVG","VAR","STDDEV","MIN","MAX","PERCENTILE_CONT","PERCENTILE_DISC","CentroidAggregate","EnvelopeAggregate","ConvexHullAggregate"],supportedNormalizationTypes:["field","log","naturalLog","percentOfTotal","squareRoot"]}}}]);