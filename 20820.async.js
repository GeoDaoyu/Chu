"use strict";(self.webpackChunkscene_pro=self.webpackChunkscene_pro||[]).push([[20820,46551],{66040:function(t,e,n){n.d(e,{d:function(){return s}});var o=n(99574),r=n(38766);function s(t,e,n){const s=Array.isArray(t),l=s?t.length/e:t.byteLength/(4*e),f=s?t:new Uint32Array(t,0,l*e),d=n?.minReduction??0,h=n?.originalIndices||null,g=h?h.length:0,p=n?.componentOffsets||null;let N=0;if(p)for(let t=0;t<p.length-1;t++){const e=p[t+1]-p[t];e>N&&(N=e)}else N=l;const T=Math.floor(1.1*N)+1;(null==u||u.length<2*T)&&(u=new Uint32Array((0,o.Sf)(2*T)));for(let t=0;t<2*T;t++)u[t]=0;let I=0;const A=!!p&&!!h,O=A?g:l;let S=(0,r.$z)(l);const m=new Uint32Array(g),w=1.96;let E=0!==d?Math.ceil(4*w*w/(d*d)*d*(1-d)):O,y=1,v=p?p[1]:O;for(let t=0;t<O;t++){if(t===E){const e=1-I/t;if(e+w*Math.sqrt(e*(1-e)/t)<d)return null;E*=2}if(t===v){for(let t=0;t<2*T;t++)u[t]=0;if(h)for(let t=p[y-1];t<p[y];t++)m[t]=S[h[t]];v=p[++y]}const n=A?h[t]:t,o=n*e,r=a(f,o,e);let s=r%T,c=I;for(;0!==u[2*s+1];){if(u[2*s]===r){const t=u[2*s+1]-1;if(i(f,o,t*e,e)){c=S[t];break}}s++,s>=T&&(s-=T)}c===I&&(u[2*s]=r,u[2*s+1]=n+1,I++),S[n]=c}if(0!==d&&1-I/l<d)return null;if(A){for(let t=p[y-1];t<m.length;t++)m[t]=S[h[t]];S=(0,r.UB)(m)}const U=s?new Array(I):new Uint32Array(I*e);I=0;for(let t=0;t<O;t++)S[t]===I&&(c(f,(A?h[t]:t)*e,U,I*e,e),I++);if(h&&!A){const t=new Uint32Array(g);for(let e=0;e<t.length;e++)t[e]=S[h[e]];S=(0,r.UB)(t)}return{buffer:Array.isArray(U)?U:U.buffer,indices:S,uniqueCount:I}}function i(t,e,n,o){for(let r=0;r<o;r++)if(t[e+r]!==t[n+r])return!1;return!0}function c(t,e,n,o,r){for(let s=0;s<r;s++)n[o+s]=t[e+s]}function a(t,e,n){let o=0;for(let r=0;r<n;r++)o=t[e+r]+o|0,o=o+(o<<11)+(o>>>2)|0;return o>>>0}let u=null},46551:function(t,e,n){n.d(e,{EdgeInputBufferLayout:function(){return i},Hr:function(){return l},dG:function(){return u},dx:function(){return a},k3:function(){return f},rD:function(){return c}});var o=n(72894),r=n(52890),s=n(52061);const i=(0,r.U$)().vec3f(s.T.POSITION).u16(s.T.COMPONENTINDEX).freeze(),c=(0,r.U$)().vec2u8(s.T.SIDENESS).freeze(),a=(0,o.K)(c),u=(0,r.U$)().vec3f(s.T.POSITION0).vec3f(s.T.POSITION1).vec2i16(s.T.NORMALCOMPRESSED).u16(s.T.COMPONENTINDEX).u8(s.T.VARIANTOFFSET,{glNormalized:!0}).u8(s.T.VARIANTSTROKE).u8(s.T.VARIANTEXTENSION,{glNormalized:!0}).freeze(),l=(0,r.U$)().vec3f(s.T.POSITION0).vec3f(s.T.POSITION1).vec2i16(s.T.NORMALCOMPRESSED).vec2i16(s.T.NORMAL2COMPRESSED).u16(s.T.COMPONENTINDEX).u8(s.T.VARIANTOFFSET,{glNormalized:!0}).u8(s.T.VARIANTSTROKE).u8(s.T.VARIANTEXTENSION,{glNormalized:!0}).freeze(),f=new Map([[s.T.POSITION0,0],[s.T.POSITION1,1],[s.T.COMPONENTINDEX,2],[s.T.VARIANTOFFSET,3],[s.T.VARIANTSTROKE,4],[s.T.VARIANTEXTENSION,5],[s.T.NORMALCOMPRESSED,6],[s.T.NORMAL2COMPRESSED,7],[s.T.SIDENESS,8]])},78785:function(t,e,n){n.d(e,{D:function(){return N},q:function(){return T}});var o=n(83850),r=n(24910),s=n(82846),i=n(72894),c=n(72913),a=n(46551);class u{updateSettings(t){this.settings=t,this._edgeHashFunction=t.reducedPrecision?g:h}write(t,e,n){A.seed=this._edgeHashFunction(n);const o=A.getIntRange(0,255),r=A.getIntRange(0,this.settings.variants-1),s=A.getFloat(),i=255*(.5*function(t,e){return Math.abs(t)**e*Math.sign(t)}(-(1-Math.min(s/.7,1))+Math.max(0,s-.7)/(1-.7),1.2)+.5);t.position0.setVec(e,n.position0),t.position1.setVec(e,n.position1),t.componentIndex.set(e,n.componentIndex),t.variantOffset.set(e,o),t.variantStroke.set(e,r),t.variantExtension.set(e,i)}}const l=new Float32Array(6),f=new Uint32Array(l.buffer),d=new Uint32Array(1);function h(t){return l[0]=t.position0[0],l[1]=t.position0[1],l[2]=t.position0[2],l[3]=t.position1[0],l[4]=t.position1[1],l[5]=t.position1[2],d[0]=31*(31*(31*(31*(31*(166811+f[0])+f[1])+f[2])+f[3])+f[4])+f[5],d[0]}function g(t){const e=l;e[0]=p(t.position0[0]),e[1]=p(t.position0[1]),e[2]=p(t.position0[2]),e[3]=p(t.position1[0]),e[4]=p(t.position1[1]),e[5]=p(t.position1[2]),d[0]=5381;for(let t=0;t<f.length;t++)d[0]=31*d[0]+f[t];return d[0]}function p(t){return Math.round(1e4*t)/1e4}class N{constructor(){this._commonWriter=new u}updateSettings(t){this._commonWriter.updateSettings(t)}allocate(t){return a.dG.createBuffer(t)}write(t,e,n){this._commonWriter.write(t,e,n),(0,r.f)(I,n.faceNormal0,n.faceNormal1),(0,r.n)(I,I);const{typedBuffer:o,typedBufferStride:s}=t.normalCompressed;(0,c.hd)(o,e,I[0],I[1],I[2],s)}static{this.Layout=a.dG}static{this.glLayout=(0,i.K)(a.dG,1)}}class T{constructor(){this._commonWriter=new u}updateSettings(t){this._commonWriter.updateSettings(t)}allocate(t){return a.Hr.createBuffer(t)}write(t,e,n){this._commonWriter.write(t,e,n);{const{typedBuffer:o,typedBufferStride:r}=t.normalCompressed;(0,c.hd)(o,e,n.faceNormal0[0],n.faceNormal0[1],n.faceNormal0[2],r)}{const{typedBuffer:o,typedBufferStride:r}=t.normal2Compressed;(0,c.hd)(o,e,n.faceNormal1[0],n.faceNormal1[1],n.faceNormal1[2],r)}}static{this.Layout=a.Hr}static{this.glLayout=(0,i.K)(a.Hr,1)}}const I=(0,s.Ue)(),A=new o.Z},7048:function(t,e,n){n.d(e,{n:function(){return c}});var o=n(99574),r=n(63974),s=n(24910),i=n(82846);function c(t,e,n){const o=t.vertices.position,r=t.vertices.componentIndex,i=g.position0,c=g.position1,l=g.faceNormal0,d=g.faceNormal1,{edges:h,normals:p}=u(t),N=h.length/4,T=e.allocate(N);let I=0;const A=N,m=n?.allocate(A);let E=0,y=0,v=0;f.length=0;for(let t=0;t<N;++t){const e=4*t;o.getVec(h.data[e],i),o.getVec(h.data[e+1],c);const n=f.pushNew();n.index=4*t,n.length=(0,s.j)(i,c)}f.sort(((t,e)=>e.length-t.length));const U=new Array,M=new Array;f.forAll((({length:t,index:u})=>{const f=h.data[u],N=h.data[u+1],A=h.data[u+2],R=h.data[u+3],P=-1===R;if(o.getVec(f,i),o.getVec(N,c),P){const t=3*A;(0,s.i)(l,p.data[t],p.data[t+1],p.data[t+2]),(0,s.c)(d,l),g.componentIndex=r.get(f),g.cosAngle=(0,s.e)(l,d)}else{let t=3*A;if((0,s.i)(l,p.data[t],p.data[t+1],p.data[t+2]),t=3*R,(0,s.i)(d,p.data[t],p.data[t+1],p.data[t+2]),g.componentIndex=r.get(f),g.cosAngle=(0,s.e)(l,d),function(t,e){return t.cosAngle>e}(g,S))return;g.cosAngle<-.9999&&(0,s.c)(d,l)}y+=t,v++,P||function(t,e){return t.cosAngle<e}(g,w)?(e.write(T,I++,g),U.push(t)):a(g,O)&&(m&&n&&n.write(m,E++,g),M.push(t))}));const R=new Float32Array(U.reverse()),P=new Float32Array(M.reverse()),V=m&&n?{instancesData:m.slice(0,E),lodInfo:{lengths:P}}:void 0;return{regular:{instancesData:T.slice(0,I),lodInfo:{lengths:R}},silhouette:V,averageEdgeLength:y/v}}function a(t,e){const n=(0,o.ZF)(t.cosAngle);return(0,s.E)(N,t.position1,t.position0),n*((0,s.e)((0,s.h)(p,t.faceNormal0,t.faceNormal1),N)>0?-1:1)>e}function u(t){const e=t.faces.length/3,n=t.faces,o=t.neighbors,r=t.vertices.position;d.length=h.length=0;for(let t=0;t<e;t++){const e=3*t,i=o[e],c=o[e+1],a=o[e+2],u=n[e],l=n[e+1],f=n[e+2];r.getVec(u,T),r.getVec(l,I),r.getVec(f,A),(0,s.d)(I,I,T),(0,s.d)(A,A,T),(0,s.h)(T,I,A),(0,s.n)(T,T),h.pushArray(T),(-1===i||u<l)&&(d.push(u),d.push(l),d.push(t),d.push(i)),(-1===c||l<f)&&(d.push(l),d.push(f),d.push(t),d.push(c)),(-1===a||f<u)&&(d.push(f),d.push(u),d.push(t),d.push(a))}return{edges:d,normals:h}}class l{constructor(){this.index=0,this.length=0}}const f=new r.Z({allocator:t=>t||new l,deallocator:null}),d=new r.Z({deallocator:null}),h=new r.Z({deallocator:null}),g=new class{constructor(){this.position0=(0,i.Ue)(),this.position1=(0,i.Ue)(),this.faceNormal0=(0,i.Ue)(),this.faceNormal1=(0,i.Ue)(),this.componentIndex=0,this.cosAngle=0}},p=(0,i.Ue)(),N=(0,i.Ue)(),T=(0,i.Ue)(),I=(0,i.Ue)(),A=(0,i.Ue)(),O=(0,o.Vl)(4),S=Math.cos(O),m=(0,o.Vl)(35),w=Math.cos(m)},20820:function(t,e,n){n.d(e,{Kl:function(){return l},extractComponentsEdgeLocationsLayout:function(){return N},kY:function(){return f},Yr:function(){return p}});var o=n(66040);function r(t,e,n){const o=e/3,r=new Uint32Array(n+1),s=new Uint32Array(n+1),i=(t,e)=>{t<e?r[t+1]++:s[e+1]++};for(let e=0;e<o;e++){const n=t[3*e],o=t[3*e+1],r=t[3*e+2];i(n,o),i(o,r),i(r,n)}let c=0,a=0;for(let t=0;t<n;t++){const e=r[t+1],n=s[t+1];r[t+1]=c,s[t+1]=a,c+=e,a+=n}const u=new Uint32Array(6*o),l=r[n],f=(t,e,n)=>{if(t<e){const o=r[t+1]++;u[2*o]=e,u[2*o+1]=n}else{const o=s[e+1]++;u[2*l+2*o]=t,u[2*l+2*o+1]=n}};for(let e=0;e<o;e++){const n=t[3*e],o=t[3*e+1],r=t[3*e+2];f(n,o,e),f(o,r,e),f(r,n,e)}const d=(t,e)=>{const n=2*t,o=e-t;for(let t=1;t<o;t++){const e=u[n+2*t],o=u[n+2*t+1];let r=t-1;for(;r>=0&&u[n+2*r]>e;r--)u[n+2*r+2]=u[n+2*r],u[n+2*r+3]=u[n+2*r+1];u[n+2*r+2]=e,u[n+2*r+3]=o}};for(let t=0;t<n;t++)d(r[t],r[t+1]),d(l+s[t],l+s[t+1]);const h=new Int32Array(3*o),g=(e,n)=>e===t[3*n]?0:e===t[3*n+1]?1:e===t[3*n+2]?2:-1,p=(t,e)=>{const n=g(t,e);h[3*e+n]=-1},N=(t,e,n,o)=>{const r=g(t,e);h[3*e+r]=o;const s=g(n,o);h[3*o+s]=e};for(let t=0;t<n;t++){let e=r[t];const n=r[t+1];let o=s[t];const i=s[t+1];for(;e<n&&o<i;){const n=u[2*e],r=u[2*l+2*o];n===r?(N(t,u[2*e+1],r,u[2*l+2*o+1]),e++,o++):n<r?(p(t,u[2*e+1]),e++):(p(r,u[2*l+2*o+1]),o++)}for(;e<n;)p(t,u[2*e+1]),e++;for(;o<i;)p(u[2*l+2*o],u[2*l+2*o+1]),o++}return h}var s=n(52890),i=n(52061),c=n(46551),a=n(78785),u=n(7048);function l(t){const e=f(t.data,t.skipDeduplicate,t.indices,t.indicesLength);return h.updateSettings(t.writerSettings),g.updateSettings(t.writerSettings),(0,u.n)(e,h,g)}function f(t,e,n,s){if(e){const e=r(n,s,t.count);return new d(n,s,e,t)}const i=(0,o.d)(t.buffer,t.stride/4,{originalIndices:n}),a=r(i.indices,s,i.uniqueCount);return{faces:i.indices,facesLength:i.indices.length,neighbors:a,vertices:c.EdgeInputBufferLayout.createView(i.buffer)}}class d{constructor(t,e,n,o){this.faces=t,this.facesLength=e,this.neighbors=n,this.vertices=o}}const h=new a.D,g=new a.q,p=(0,s.U$)().vec3f(i.T.POSITION0).vec3f(i.T.POSITION1),N=(0,s.U$)().vec3f(i.T.POSITION0).vec3f(i.T.POSITION1).u16(i.T.COMPONENTINDEX)}}]);