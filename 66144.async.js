"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[66144],{45415:function(e,t,i){function n(e,t,i,n,s){r(e,t,i||0,n||e.length-1,s||o)}function r(e,t,i,n,o){for(;n>i;){if(n-i>600){var l=n-i+1,a=t-i+1,u=Math.log(l),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(l-c)/l)*(a-l/2<0?-1:1);r(e,t,Math.max(i,Math.floor(t-a*c/l+h)),Math.min(n,Math.floor(t+(l-a)*c/l+h)),o)}var p=e[t],d=i,f=n;for(s(e,i,t),o(e[n],p)>0&&s(e,i,n);d<f;){for(s(e,d,f),d++,f--;o(e[d],p)<0;)d++;for(;o(e[f],p)>0;)f--}0===o(e[i],p)?s(e,i,f):s(e,++f,n),f<=t&&(i=f+1),t<=f&&(n=f-1)}}function s(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function o(e,t){return e<t?-1:e>t?1:0}i.d(t,{q:function(){return n}})},58426:function(e,t,i){i.d(t,{$c:function(){return d},Hg:function(){return f},jW:function(){return p},xb:function(){return y}});var n=i(70880),r=i(43254),s=i(22018);const o=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function l(e){return e instanceof n.Z}function a(e){return e instanceof r.Z?Object.keys(e.items):l(e)?(0,s.vw)(e).keys():e?Object.keys(e):[]}function u(e,t){return e instanceof r.Z?e.items[t]:e[t]}function c(e){return e?e.declaredClass:null}function h(e,t){const i=e.diff;if(i&&"function"==typeof i)return i(e,t);const n=a(e),r=a(t);if(0===n.length&&0===r.length)return;if(!n.length||!r.length||function(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}(e,t))return{type:"complete",oldValue:e,newValue:t};const s=r.filter((e=>!n.includes(e))),p=n.filter((e=>!r.includes(e))),d=n.filter((i=>r.includes(i)&&u(e,i)!==u(t,i))).concat(s,p).sort(),f=c(e);if(f&&o.has(f)&&d.length)return{type:"complete",oldValue:e,newValue:t};let y;const g=l(e)&&l(t);for(const n of d){const r=u(e,n),s=u(t,n);let o;if((g||"function"!=typeof r&&"function"!=typeof s)&&r!==s&&(null!=r||null!=s)){if(i&&i[n]&&"function"==typeof i[n])o=i[n]?.(r,s);else if(r instanceof Date&&s instanceof Date){if(r.getTime()===s.getTime())continue;o={type:"complete",oldValue:r,newValue:s}}else o="object"==typeof r&&"object"==typeof s&&c(r)===c(s)?h(r,s):{type:"complete",oldValue:r,newValue:s};null!=o&&(null!=y?y.diff[n]=o:y={type:"partial",diff:{[n]:o}})}}return y}function p(e,t){return function(e,t){if(null==e)return!1;const i=t.split(".");let n=e;for(const e of i){if("complete"===n.type)return!0;if("partial"!==n.type)return!1;{const t=n.diff[e];if(!t)return!1;n=t}}return!0}(e,t)}function d(e,t){if(!e)return!1;if("partial"===e.type){const i=Object.keys(e.diff);return 1===i.length&&i[0]===t}return!1}function f(e,t){if("function"!=typeof e&&"function"!=typeof t&&(null!=e||null!=t))return null==e||null==t||"object"==typeof e&&"object"==typeof t&&c(e)!==c(t)?{type:"complete",oldValue:e,newValue:t}:h(e,t)}function y(e){if(null==e)return!0;switch(e.type){case"complete":return!1;case"collection":{const t=e;for(const e of t.added)if(!y(e))return!1;for(const e of t.removed)if(!y(e))return!1;for(const e of t.changed)if(!y(e))return!1;return!0}case"partial":for(const t in e.diff)if(!y(e.diff[t]))return!1;return!0}}},96946:function(e,t,i){i.d(t,{Q:function(){return l},b:function(){return E}});var n=i(3480),r=i(79487),s=(i(61432),i(63974)),o=i(45415);class l{constructor(e=9,t){this._compareMinX=p,this._compareMinY=d,this._toBBox=e=>e,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this._toBBox=t:this._initFormat(t)),this.clear()}destroy(){this.clear(),x.prune(),v.prune(),w.prune(),S.prune()}all(e){a(this._data,e)}search(e,t){let i=this._data;const n=this._toBBox;if(_(e,i))for(x.clear();i;){for(let r=0,s=i.children.length;r<s;r++){const s=i.children[r],o=i.leaf?n(s):s;_(e,o)&&(i.leaf?t(s):b(e,o)?a(s,t):x.push(s))}i=x.pop()}}collides(e){let t=this._data;const i=this._toBBox;if(!_(e,t))return!1;for(x.clear();t;){for(let n=0,r=t.children.length;n<r;n++){const r=t.children[n],s=t.leaf?i(r):r;if(_(e,s)){if(t.leaf||b(e,s))return!0;x.push(r)}}t=x.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let t=0,i=e.length;t<i;t++)this.insert(e[t]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(this._data.children.length)if(this._data.height===t.height)this._splitRoot(this._data,t);else{if(this._data.height<t.height){const e=this._data;this._data=t,t=e}this._insert(t,this._data.height-t.height-1,!0)}else this._data=t;return this}insert(e){return e&&this._insert(e,this._data.height-1),this}clear(){return this._data=new O([]),this}remove(e){if(!e)return this;let t,i=this._data,s=null,o=0,l=!1;const a=this._toBBox(e);for(w.clear(),S.clear();i||w.length>0;){if(i||(i=w.pop(),s=w.data[w.length-1],o=S.pop()??0,l=!0),i.leaf&&(t=(0,n.cq)(i.children,(0,r.CY)(e),i.children.length,i.indexHint),-1!==t))return i.children.splice(t,1),w.push(i),this._condense(w),this;l||i.leaf||!b(i,a)?s?(o++,i=s.children[o],l=!1):i=null:(w.push(i),S.push(o),o=0,s=i,i=i.children[0])}return this}toJSON(){return this._data}fromJSON(e){return this._data=e,this}_build(e,t,i,n){const r=i-t+1;let s=this._maxEntries;if(r<=s){const n=new O(e.slice(t,i+1));return u(n,this._toBBox),n}n||(n=Math.ceil(Math.log(r)/Math.log(s)),s=Math.ceil(r/s**(n-1)));const o=new V([]);o.height=n;const l=Math.ceil(r/s),a=l*Math.ceil(Math.sqrt(s));C(e,t,i,a,this._compareMinX);for(let r=t;r<=i;r+=a){const t=Math.min(r+a-1,i);C(e,r,t,l,this._compareMinY);for(let i=r;i<=t;i+=l){const r=Math.min(i+l-1,t);o.children.push(this._build(e,i,r,n-1))}}return u(o,this._toBBox),o}_insert(e,t,i){const n=this._toBBox,r=i?e:n(e);w.clear();const s=function(e,t,i,n){for(;n.push(t),!0!==t.leaf&&n.length-1!==i;){let i,n=1/0,r=1/0;for(let s=0,o=t.children.length;s<o;s++){const o=t.children[s],l=f(o),a=g(e,o)-l;a<r?(r=a,n=l<n?l:n,i=o):a===r&&l<n&&(n=l,i=o)}t=i||t.children[0]}return t}(r,this._data,t,w);for(s.children.push(e),h(s,r);t>=0&&w.data[t].children.length>this._maxEntries;)this._split(w,t),t--;!function(e,t,i){for(let n=i;n>=0;n--)h(t.data[n],e)}(r,w,t)}_split(e,t){const i=e.data[t],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);const s=this._chooseSplitIndex(i,r,n);if(!s)return;const o=i.children.splice(s,i.children.length-s),l=i.leaf?new O(o):new V(o);l.height=i.height,u(i,this._toBBox),u(l,this._toBBox),t?e.data[t-1].children.push(l):this._splitRoot(i,l)}_splitRoot(e,t){this._data=new V([e,t]),this._data.height=e.height+1,u(this._data,this._toBBox)}_chooseSplitIndex(e,t,i){let n,r,s;n=r=1/0;for(let o=t;o<=i-t;o++){const t=c(e,0,o,this._toBBox),l=c(e,o,i,this._toBBox),a=m(t,l),u=f(t)+f(l);a<n?(n=a,s=o,r=u<r?u:r):a===n&&u<r&&(r=u,s=o)}return s}_chooseSplitAxis(e,t,i){const n=e.leaf?this._compareMinX:p,r=e.leaf?this._compareMinY:d;this._allDistMargin(e,t,i,n)<this._allDistMargin(e,t,i,r)&&e.children.sort(n)}_allDistMargin(e,t,i,n){e.children.sort(n);const r=this._toBBox,s=c(e,0,t,r),o=c(e,i-t,i,r);let l=y(s)+y(o);for(let n=t;n<i-t;n++){const t=e.children[n];h(s,e.leaf?r(t):t),l+=y(s)}for(let n=i-t-1;n>=t;n--){const t=e.children[n];h(o,e.leaf?r(t):t),l+=y(o)}return l}_condense(e){for(let t=e.length-1;t>=0;t--){const i=e.data[t];if(0===i.children.length)if(t>0){const r=e.data[t-1],s=r.children;s.splice((0,n.cq)(s,i,s.length,r.indexHint),1)}else this.clear();else u(i,this._toBBox)}}_initFormat(e){const t=["return a"," - b",";"];this._compareMinX=new Function("a","b",t.join(e[0])),this._compareMinY=new Function("a","b",t.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function a(e,t){let i=e;for(v.clear();i;){if(!0===i.leaf)for(const e of i.children)t((0,r.CY)(e));else v.pushArray(i.children);i=v.pop()??null}}function u(e,t){c(e,0,e.children.length,t,e)}function c(e,t,i,n,r){r||(r=new O([])),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s,o=t;o<i;o++)s=e.children[o],h(r,e.leaf?n(s):s);return r}function h(e,t){e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY)}function p(e,t){return e.minX-t.minX}function d(e,t){return e.minY-t.minY}function f(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function y(e){return e.maxX-e.minX+(e.maxY-e.minY)}function g(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function m(e,t){const i=Math.max(e.minX,t.minX),n=Math.max(e.minY,t.minY),r=Math.min(e.maxX,t.maxX),s=Math.min(e.maxY,t.maxY);return Math.max(0,r-i)*Math.max(0,s-n)}function b(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function _(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function C(e,t,i,n,r){const s=[t,i];for(;s.length;){const t=s.pop(),i=s.pop();if(t-i<=n)continue;const l=i+Math.ceil((t-i)/n/2)*n;(0,o.q)(e,l,i,t,r),s.push(i,l,l,t)}}const x=new s.Z,v=new s.Z,w=new s.Z,S=new s.Z({deallocator:void 0});class E{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class M extends E{constructor(){super(...arguments),this.height=1,this.indexHint=new n.SO}}class O extends M{constructor(e){super(),this.children=e,this.leaf=!0}}class V extends M{constructor(e){super(),this.children=e,this.leaf=!1}}},92680:function(e,t,i){i.d(t,{e:function(){return o},s:function(){return l}});var n=i(3480),r=(i(61432),i(88194)),s=i(87644);function o(e){return null==e||"simple"===e.type||"unique-value"===e.type||"class-breaks"===e.type||"dictionary"===e.type||"heatmap"===e.type}function l(e,t){if(null==e)return null;if(!o(e))return new r.Z("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${e.type||e.declaredClass}'`,{renderer:e});switch(e.type){case"simple":return function(e,t){const i={...s.K,...t,cimFallbackEnabled:!0};return a(e,(0,s.q)(e.symbol,i).error)}(e,t);case"unique-value":return function(e,t){const i={...s.K,...t,cimFallbackEnabled:!0},r=e.uniqueValueInfos?.map((e=>(0,s.q)(e.symbol,i).error)).filter(n.pC),o=(0,s.q)(e.defaultSymbol,i);return o.error&&r?.unshift(o.error),a(e,r)}(e,t);case"class-breaks":return function(e,t){const i={...s.K,...t,cimFallbackEnabled:!0},r=e.classBreakInfos.map((e=>(0,s.q)(e.symbol,i).error)).filter(n.pC),o=(0,s.q)(e.defaultSymbol,i);return o.error&&r.unshift(o.error),a(e,r)}(e,t);case"dictionary":case"heatmap":return null}return null}function a(e,t){if(!t)return null;if(Array.isArray(t)||(t=[t]),t.length>0){const i=t.map((e=>e.details.symbol.type||e.details.symbol.declaredClass)).filter((e=>!!e));i.sort();const n=new Array;return i.forEach(((e,t)=>{0!==t&&e===i[t-1]||n.push(e)})),new r.Z("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${n.join(", ")}) which are not supported in 3D`,{renderer:e,symbolErrors:t})}return null}},9350:function(e,t,i){i.d(t,{CJ:function(){return u},Rz:function(){return h},js:function(){return p},xA:function(){return a},z3:function(){return c}});i(61432);var n=i(89636),r=i(38096),s=i(19886),o=i(45433),l=i(54914);const a=s.Z.fromJSON(l.I4),u=r.Z.fromJSON(l.ET),c=n.Z.fromJSON(l.lF),h=o.Z.fromJSON(l.qP);function p(e){if(null==e)return null;switch(e.type){case"mesh":return null;case"point":case"multipoint":return a;case"polyline":return u;case"polygon":case"extent":return c}return null}s.Z.fromJSON(l.eG),r.Z.fromJSON(l.wW),n.Z.fromJSON(l.lj)},54914:function(e,t,i){i.d(t,{ET:function(){return o},I4:function(){return s},SQ:function(){return n},X1:function(){return r},eG:function(){return u},lF:function(){return l},lj:function(){return h},qP:function(){return a},wW:function(){return c}});const n=[252,146,31,255],r=[153,153,153,255],s={type:"esriSMS",style:"esriSMSCircle",size:6,color:n,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},o={type:"esriSLS",style:"esriSLSSolid",width:.75,color:n},l={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},a={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},u={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},c={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},h={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},39088:function(e,t,i){i.r(t),i.d(t,{default:function(){return C}});var n=i(73440),r=i(88194),s=i(61100),o=i(90403),l=i(17155),a=(i(61432),i(96711),i(83850),i(48023)),u=i(24381),c=i(21143),h=i(98185),p=i(51335),d=i(15165),f=i(94125),y=i(5527),g=i(43295),m=i(27546),b=i(92105);let _=class extends((0,u.A)(y.Z)){constructor(){super(...arguments),this.type="graphics-3d",this.symbologySnappingSupported=!0,this._slicePlaneEnabled=!1,this.fullExtentInLocalViewSpatialReference=null,this.ignoresMemoryFactor=!0}get highlightOptions(){return null}initialize(){this._set("processor",new h.D({owner:this,scaleVisibilityEnabled:!0,frustumVisibilityEnabled:!0})),this.addResolvingPromise(this.processor.initializePromise),this.addHandles(this.layer.on("graphic-update",(e=>this.processor.graphicsCore.graphicUpdateHandler(e)))),this.layer.internal?this.notifyChange("updating"):("local"===this.view.viewingMode&&this.addResolvingPromise((async()=>this.fullExtentInLocalViewSpatialReference=await(0,b.i)(this.layer.fullExtent,this.view.spatialReference))()),this.addHandles((0,o.gx)((()=>this.view?.basemapTerrain?.ready),(()=>()=>this.notifyChange("updating")),{once:!0})))}destroy(){this._updatingHandles.removeAll(),this._set("processor",(0,s.SC)(this.processor))}get loadedGraphics(){return this.layer.graphics}get legendEnabled(){return this.canResume()&&!this.processor?.frustumVisibilitySuspended}get visibleAtCurrentScale(){return(0,m.Dc)()?(0,m.GB)(this.layer.effectiveScaleRange,this.view.scale):!this.processor?.scaleVisibilitySuspended}get slicePlaneEnabled(){const e=this.layer.internal;return this._slicePlaneEnabled&&!e}set slicePlaneEnabled(e){this._slicePlaneEnabled=e}getSuspendInfo(){const e=super.getSuspendInfo();return e.outsideOfView=this.processor?.frustumVisibilitySuspended??!1,e}getHit(e){return this.processor.getHit(e)}whenGraphicBounds(e,t){return this.processor.whenGraphicBounds(e,t)}computeAttachmentOrigin(e,t){return this.processor?.computeAttachmentOrigin(e,t)}getSymbolLayerSize(e,t){return this.processor.getSymbolLayerSize(e,t)}queryGraphics(){return Promise.resolve(this.loadedGraphics)}maskOccludee(e){return this.processor.maskOccludee(e)}highlight(e,t){return this.processor.highlight(e,t?.name??g.b)}notifyContentGeometryUpdate(){this.emit("visible-geometry-changed")}async elevationAlignPointsInFeatures(e,t){const{processor:i}=this;if(null==i?.graphics3DGraphics)throw new r.Z("graphicslayerview3d:missing-processor","A Graphics3D processor is needed to resolve graphics elevation.");const{graphics3DGraphics:n}=i;return(0,c.W)(this.view,this.layer,(e=>"number"==typeof e?n.get(e):void 0),e,t)}async queryForSymbologySnapping(e,t){return(0,p.c)(this.processor,e,t)}get updatePolicy(){return this.processor?.graphicsCore.effectiveUpdatePolicy||f.j.SYNC}isUpdating(){return this.view&&this.layer&&!(!this.processor?.updating&&(this.layer.internal||this.view.basemapTerrain?.ready))}get performanceInfo(){return new d.W(this.usedMemory,this.loadedGraphics.length,-1,-1)}get usedMemory(){return this.processor?.graphicsCore?.usedMemory??0}get unloadedMemory(){return this.processor?.graphicsCore?.unprocessedMemoryEstimate}get test(){return{graphics3DProcessor:this.processor,loadedGraphics:this.loadedGraphics}}};(0,n._)([(0,l.Cb)()],_.prototype,"highlightOptions",null),(0,n._)([(0,l.Cb)()],_.prototype,"loadedGraphics",null),(0,n._)([(0,l.Cb)({readOnly:!0})],_.prototype,"legendEnabled",null),(0,n._)([(0,l.Cb)()],_.prototype,"layer",void 0),(0,n._)([(0,l.Cb)({readOnly:!0})],_.prototype,"processor",void 0),(0,n._)([(0,l.Cb)({readOnly:!0})],_.prototype,"visibleAtCurrentScale",null),(0,n._)([(0,l.Cb)()],_.prototype,"_slicePlaneEnabled",void 0),(0,n._)([(0,l.Cb)({type:Boolean})],_.prototype,"slicePlaneEnabled",null),_=(0,n._)([(0,a.j)("esri.views.3d.layers.GraphicsLayerView3D")],_);const C=_},24381:function(e,t,i){i.d(t,{A:function(){return c}});var n=i(73440),r=i(50702),s=i(93568),o=i(90403),l=i(17155),a=(i(61432),i(96711),i(83850),i(48023)),u=i(73584);const c=e=>{let t=class extends e{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(){super.postscript(),(0,u.qC)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}async _validateHeightModelInfo(){const e=new AbortController,t=e.signal;this.addHandles((0,r.kB)((()=>e.abort()))),await(0,o.N1)((()=>this.view.defaultsFromMap?.heightModelInfoReady),t),(0,s.k_)(t);const i=(0,u.Wt)(this.layer,this.view.heightModelInfo,this.supportsHeightUnitConversion);if(i)throw i}};return(0,n._)([(0,l.Cb)()],t.prototype,"view",void 0),(0,n._)([(0,l.Cb)()],t.prototype,"slicePlaneEnabled",void 0),t=(0,n._)([(0,a.j)("esri.views.3d.layers.LayerView3D")],t),t}},98185:function(e,t,i){i.d(t,{D:function(){return P}});var n=i(73440),r=i(46451),s=i(70880),o=i(50702),l=i(61100),a=i(93568),u=i(90403),c=i(17155),h=(i(61432),i(96711),i(83850),i(48023)),p=i(58426),d=i(60147),f=i(38209),y=i(74774),g=i(56216),m=i(29191),b=i(94808),_=i(47451),C=i(28994),x=i(5473),v=i(18234),w=i(62564),S=i(66290),E=i(36027),M=i(78637),O=i(94125),V=i(27546);let P=class extends s.Z{constructor(e){super(e),this.drapeSourcePriorityOffset=0,this.type="graphics-3d",this.graphicsCore=null,this.drapeSourceType=b.Lw.Features,this.scaleVisibilityEnabled=!1,this.frustumVisibilityEnabled=!1,this._suspendResumeExtent=null,this._updatingHandles=new d.R}initialize(){const{layer:e}=this,t="effectiveScaleRange"in e?e:null,i=!(0,V.Dc)()&&this.scaleVisibilityEnabled&&null!=t,n=new C.w({owner:this,layer:this.owner.layer,preferredUpdatePolicy:O.j.SYNC,graphicSymbolSupported:!0,componentFactories:{elevationAlignment:(e,t)=>new x._({graphicsCoreOwner:this,graphicsCore:e,queryGraphicUIDsInExtent:t,elevationProvider:this.view.elevationProvider}),scaleVisibility:i?(e,i)=>new S.c({graphicsCoreOwner:this,layer:t,queryGraphicUIDsInExtent:i,graphicsCore:e,basemapTerrain:this.owner.view.basemapTerrain}):null,objectStates:e=>new w.d(e)}});if(this._set("graphicsCore",n),this.frustumVisibilityEnabled&&this._set("frustumVisibility",new v.L({graphicsCoreOwner:this})),"fullOpacity"in this.owner){const e=this.owner;this._updatingHandles.add((()=>e.fullOpacity),(()=>this.graphicsCore.opacityChange()))}if("elevationInfo"in e){const t=e;this._updatingHandles.add((()=>t.elevationInfo),((e,t)=>{(0,p.Hg)(e,t)&&this._updatingHandles.addPromise(this.graphicsCore.elevationInfoChange())}))}this._set("initializePromise",this._initializeAsync()),this._updatingHandles.addPromise(this.initializePromise)}async _initializeAsync(){try{await this.graphicsCore.initializePromise}catch(e){if((0,a.D_)(e))return;throw e}this.destroyed||(this.addHandles((0,u.YP)((()=>this.view.clippingArea),(()=>this._updateClippingExtent()),u.Z_)),this._updateClippingExtent(),this._setupSuspendResumeExtent(),this.graphicsCore.startCreateGraphics())}destroy(){this._updatingHandles.destroy(),this._set("frustumVisibility",(0,l.SC)(this.frustumVisibility)),this._set("graphicsCore",(0,l.SC)(this.graphicsCore))}get layer(){return this.owner.layer}get layerViewUid(){return this.owner.uid}get view(){return this.owner.view}get scaleVisibility(){return this.graphicsCore?.scaleVisibility}get elevationAlignment(){return this.graphicsCore?.elevationAlignment}get scaleVisibilitySuspended(){return!(null==this.scaleVisibility||!this.scaleVisibility.suspended)}get frustumVisibilitySuspended(){return null!=this.frustumVisibility&&this.frustumVisibility.suspended}get suspended(){return this.owner.suspended??!1}get updating(){return!!(this.graphicsCore?.updating||null!=this.scaleVisibility&&this.scaleVisibility.updating||null!=this.frustumVisibility&&this.frustumVisibility.updating||this._updatingHandles.updating)}get graphics3DGraphics(){return this.graphicsCore?.graphics3DGraphics}get graphics3DGraphicsByObjectID(){return this.graphicsCore?.graphics3DGraphicsByObjectID}get loadedGraphics(){return this.owner.loadedGraphics}get fullOpacity(){return this.owner.fullOpacity??1}get slicePlaneEnabled(){return this.owner.slicePlaneEnabled}get updatePolicy(){return this.owner.updatePolicy}notifyGraphicGeometryChanged(e){this.graphicsCore.notifyGraphicGeometryChanged(e)}notifyGraphicVisibilityChanged(e){this.graphicsCore.notifyGraphicVisibilityChanged(e)}notifyContentGeometryUpdate(){this.owner.notifyContentGeometryUpdate?.()}getRenderingInfo(e,t,i){const n=(0,g.Kb)(e,{renderer:t,arcade:i});if(n?.color){const e=n.color;e[0]=e[0]/255,e[1]=e[1]/255,e[2]=e[2]/255}return n}getRenderingInfoAsync(e,t,i,n){return(0,g.xn)(e,{renderer:t,arcade:i,...n})}getHit(e){if(this.owner.loadedGraphics){const t=this.owner.loadedGraphics.find((t=>t.uid===e));if(t){const e=this.layer instanceof f.Z?this.layer:null,i=(0,y.mW)(t,e);return{type:"graphic",graphic:i,layer:i.layer}}}return null}whenGraphicBounds(e,t){return this.graphicsCore?this.graphicsCore.whenGraphicBounds(e,t):Promise.reject()}computeAttachmentOrigin(e,t){return this.graphicsCore?this.graphicsCore.computeAttachmentOrigin(e,t):null}getSymbolLayerSize(e,t){return this.graphicsCore?this.graphicsCore.getSymbolLayerSize(e,t):null}maskOccludee(e){const t=this.graphicsCore?.objectStates;if(!t)return(0,o.kB)();const{set:i,handle:n}=t.acquireOccludeeSet(null);return t.setUid(i,e.uid),n}highlight(e,t){const i=this.graphicsCore?.objectStates;if(!i)return B;if(e instanceof m.Z)return B;const n=(0,M.OL)(e);if(0===n.length)return B;if(n[0]instanceof r.Z){const e=n.map((e=>e.uid)),{set:r,handle:s}=i.acquireHighlightSet(t,null);return i.setUids(r,e),s}if("number"==typeof n[0]){const e=n,{set:r,handle:s}=i.acquireHighlightSet(t,null);return i.setObjectIds(r,e),s}return B}_setupSuspendResumeExtent(){const{scaleVisibility:e,frustumVisibility:t}=this;if(null==e&&null==t)return;const i=({computedExtent:i,extentPadding:n})=>{this._suspendResumeExtent=(0,E.Go)(i,this._suspendResumeExtent,_.PY,n),null!=e&&e.setExtent(this._suspendResumeExtent),null!=t&&t.setExtent(this._suspendResumeExtent)};this.addHandles((0,u.YP)((()=>({computedExtent:this.graphicsCore?.computedExtent,extentPadding:this.graphicsCore?.extentPadding})),(e=>i(e)),u.tX))}_updateClippingExtent(){const e=this.view.clippingArea;this.graphicsCore.setClippingExtent(e,this.view.spatialReference)&&this.graphicsCore.recreateAllGraphics()}};(0,n._)([(0,c.Cb)()],P.prototype,"drapeSourcePriorityOffset",void 0),(0,n._)([(0,c.Cb)()],P.prototype,"type",void 0),(0,n._)([(0,c.Cb)({constructOnly:!0})],P.prototype,"owner",void 0),(0,n._)([(0,c.Cb)()],P.prototype,"layer",null),(0,n._)([(0,c.Cb)()],P.prototype,"layerViewUid",null),(0,n._)([(0,c.Cb)()],P.prototype,"view",null),(0,n._)([(0,c.Cb)({constructOnly:!0})],P.prototype,"graphicsCore",void 0),(0,n._)([(0,c.Cb)()],P.prototype,"scaleVisibility",null),(0,n._)([(0,c.Cb)({constructOnly:!0})],P.prototype,"frustumVisibility",void 0),(0,n._)([(0,c.Cb)()],P.prototype,"elevationAlignment",null),(0,n._)([(0,c.Cb)()],P.prototype,"scaleVisibilitySuspended",null),(0,n._)([(0,c.Cb)({readOnly:!0})],P.prototype,"frustumVisibilitySuspended",null),(0,n._)([(0,c.Cb)()],P.prototype,"suspended",null),(0,n._)([(0,c.Cb)({readOnly:!0})],P.prototype,"updating",null),(0,n._)([(0,c.Cb)()],P.prototype,"loadedGraphics",null),(0,n._)([(0,c.Cb)()],P.prototype,"fullOpacity",null),(0,n._)([(0,c.Cb)()],P.prototype,"slicePlaneEnabled",null),(0,n._)([(0,c.Cb)()],P.prototype,"drapeSourceType",void 0),(0,n._)([(0,c.Cb)()],P.prototype,"updatePolicy",null),(0,n._)([(0,c.Cb)({constructOnly:!0})],P.prototype,"scaleVisibilityEnabled",void 0),(0,n._)([(0,c.Cb)({constructOnly:!0})],P.prototype,"frustumVisibilityEnabled",void 0),(0,n._)([(0,c.Cb)()],P.prototype,"initializePromise",void 0),P=(0,n._)([(0,h.j)("esri.views.3d.layers.graphics.GraphicsProcessor")],P);const B=(0,o.kB)()},5527:function(e,t,i){i.d(t,{Z:function(){return f}});var n=i(73440),r=i(70880),s=i(87833),o=i(15894),l=i(96711),a=i(61100),u=i(76329),c=i(17155),h=(i(61432),i(83850),i(48023)),p=i(60147),d=i(27546);let f=class extends(o.Z.IdentifiableMixin(u.Z.EsriPromiseMixin(s.Z.EventedMixin(r.Z)))){get spatialReferenceSupported(){return!0}constructor(e){super(e),this._updatingHandles=new p.R,this.layer=null,this.parent=null}initialize(){this.when().catch((e=>{if("layerview:create-error"!==e.name){const t=this.layer&&this.layer.id||"no id",i=this.layer?.title||"no title";l.Z.getLogger(this).error("#resolve()",`Failed to resolve layer view (layer title: '${i}', id: '${t}')`,e)}}))}destroy(){this._updatingHandles=(0,a.SC)(this._updatingHandles)}get fullOpacity(){return(this.layer?.opacity??1)*(this.parent?.fullOpacity??1)}get suspended(){return this.destroyed||!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this._updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get updateSuspended(){return this.suspended}get visible(){return!0===this.layer?.visible}set visible(e){this._overrideIfSome("visible",e)}get visibleAtCurrentScale(){return!0}get visibleAtCurrentTimeExtent(){const e=this.view.timeExtent,t=this.layer?.visibilityTimeExtent;return!e||!t||!e.intersection(t).isEmpty}canResume(){const e=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return this.visible&&this.layer?.loaded&&this.parent&&!this.parent.suspended&&this.view?.ready&&(0,d.Cy)(e)&&this.visibleAtCurrentScale&&this.visibleAtCurrentTimeExtent||!1}getSuspendInfo(){const e=this.parent?.suspended?this.parent.suspendInfo:{};this.view?.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0);const t=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return(0,d.Cy)(t)&&this.visibleAtCurrentScale||(e.outsideScaleRange=!0),this.visibleAtCurrentTimeExtent||(e.outsideVisibilityTimeExtent=!0),this.visible||(e.layerInvisible=!0),e}isUpdating(){return!1}};(0,n._)([(0,c.Cb)({readOnly:!0})],f.prototype,"spatialReferenceSupported",null),(0,n._)([(0,c.Cb)()],f.prototype,"view",void 0),(0,n._)([(0,c.Cb)()],f.prototype,"fullOpacity",null),(0,n._)([(0,c.Cb)()],f.prototype,"layer",void 0),(0,n._)([(0,c.Cb)()],f.prototype,"parent",void 0),(0,n._)([(0,c.Cb)({readOnly:!0})],f.prototype,"suspended",null),(0,n._)([(0,c.Cb)({readOnly:!0})],f.prototype,"suspendInfo",null),(0,n._)([(0,c.Cb)({readOnly:!0})],f.prototype,"legendEnabled",null),(0,n._)([(0,c.Cb)({type:Boolean,readOnly:!0})],f.prototype,"updating",null),(0,n._)([(0,c.Cb)({readOnly:!0})],f.prototype,"updatingProgress",null),(0,n._)([(0,c.Cb)()],f.prototype,"updateSuspended",null),(0,n._)([(0,c.Cb)()],f.prototype,"visible",null),(0,n._)([(0,c.Cb)({readOnly:!0})],f.prototype,"visibleAtCurrentScale",null),(0,n._)([(0,c.Cb)({readOnly:!0})],f.prototype,"visibleAtCurrentTimeExtent",null),f=(0,n._)([(0,h.j)("esri.views.layers.LayerView")],f)},85754:function(e,t,i){i.d(t,{V5:function(){return s},e7:function(){return r},zc:function(){return o}});var n=i(76554);async function r(e,t=e.popupTemplate){if(null==t)return[];const i=await t.getRequiredFields(e.fieldsIndex),{lastEditInfoEnabled:r}=t,{objectIdField:s,typeIdField:o,globalIdField:l,relationships:a}=e;if(i.includes("*"))return["*"];const u=r?(0,n.CH)(e):[],c=(0,n.Q0)(e.fieldsIndex,[...i,...u]);return o&&c.push(o),c&&s&&e.fieldsIndex?.has(s)&&!c.includes(s)&&c.push(s),c&&l&&e.fieldsIndex?.has(l)&&!c.includes(l)&&c.push(l),a&&a.forEach((t=>{const{keyField:i}=t;c&&i&&e.fieldsIndex?.has(i)&&!c.includes(i)&&c.push(i)})),c}function s(e,t){return e.popupTemplate?e.popupTemplate:null!=t&&t.defaultPopupTemplateEnabled&&null!=e.defaultPopupTemplate?e.defaultPopupTemplate:null}function o(e,t){return null!=s(e,{defaultPopupTemplateEnabled:t})}}}]);