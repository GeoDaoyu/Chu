"use strict";(self.webpackChunkscene_pro=self.webpackChunkscene_pro||[]).push([[15239],{75259:function(e,t,i){i.d(t,{Z:function(){return a}});var o=i(95051),n=i(44194),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"minus",theme:"outlined"},r=i(43638),l=function(e,t){return n.createElement(r.Z,(0,o.Z)({},e,{ref:t,icon:s}))};var a=n.forwardRef(l)},87864:function(e,t,i){i.d(t,{Qc:function(){return c},WU:function(){return l},lt:function(){return d},ti:function(){return r}});var o=i(29138),n=i(74765);const s={ar:[".",","],bg:[","," "],bs:[",","."],ca:[",","."],cs:[","," "],da:[",","."],de:[",","."],"de-ch":[".","’"],el:[",","."],en:[".",","],"en-au":[".",","],es:[",","."],"es-mx":[".",","],et:[","," "],fi:[","," "],fr:[","," "],"fr-ch":[","," "],he:[".",","],hi:[".",",","#,##,##0.###"],hr:[",","."],hu:[","," "],id:[",","."],it:[",","."],"it-ch":[".","’"],ja:[".",","],ko:[".",","],lt:[","," "],lv:[","," "],mk:[",","."],nb:[","," "],nl:[",","."],no:[","," "],pl:[","," "],pt:[",","."],"pt-pt":[","," "],ro:[",","."],ru:[","," "],sk:[","," "],sl:[",","."],sr:[",","."],sv:[","," "],th:[".",","],tr:[",","."],uk:[","," "],vi:[",","."],zh:[".",","]};function r(e=(0,n.Kd)()){let t=(e=e.toLowerCase())in s;if(!t){const i=e.split("-");i.length>1&&i[0]in s&&(e=i[0],t=!0),t||(e="en")}const[i,o,r="#,##0.###"]=s[e];return{decimal:i,group:o,pattern:r}}function l(e,t){const i=r((t={...t}).locale);t.customs=i;const o=t.pattern||i.pattern;return isNaN(e)||Math.abs(e)===1/0?null:function(e,t,i){const o=(i=i||{}).customs.group,n=i.customs.decimal,s=t.split(";"),r=s[0];if((t=s[e<0?1:0]||"-"+r).includes("%"))e*=100;else if(t.includes("‰"))e*=1e3;else{if(t.includes("¤"))throw new Error("currency notation not supported");if(t.includes("E"))throw new Error("exponential notation not supported")}const l=a,d=r.match(l);if(!d)throw new Error("unable to find a number expression in pattern: "+t);return!1===i.fractional&&(i.places=0),t.replace(l,function(e,t,i){!0===(i=i||{}).places&&(i.places=0),i.places===1/0&&(i.places=6);const o=t.split("."),n="string"==typeof i.places&&i.places.indexOf(",");let s=i.places;n?s=i.places.slice(n+1):+s>=0||(s=(o[1]||[]).length),i.round<0||(e=Number(e.toFixed(Number(s))));const r=String(Math.abs(e)).split("."),l=r[1]||"";if(o[1]||i.places){n&&(i.places=i.places.slice(0,Math.max(0,n)));const e=void 0!==i.places?i.places:o[1]&&o[1].lastIndexOf("0")+1;+e>l.length&&(r[1]=l.padEnd(Number(e),"0")),+s<l.length&&(r[1]=l.slice(0,Math.max(0,Number(s))))}else r[1]&&r.pop();const a=o[0].replace(",","");let d=a.indexOf("0");-1!==d&&(d=a.length-d,d>r[0].length&&(r[0]=r[0].padStart(d,"0")),a.includes("#")||(r[0]=r[0].slice(-d)));let c,p,u=o[0].lastIndexOf(",");if(-1!==u){c=o[0].length-u-1;const e=o[0].slice(0,u);u=e.lastIndexOf(","),-1!==u&&(p=e.length-u-1)}const h=[];for(let e=r[0];e;){const t=e.length-c;h.push(t>0?e.slice(Math.max(0,t)):e),e=t>0?e.slice(0,t):"",p&&(c=p,p=void 0)}return r[0]=h.reverse().join(i.group||","),r.join(i.decimal||".")}(e,d[0],{decimal:n,group:o,places:i.places,round:i.round}))}(e,o,t)}const a=/[#0,]*[#0](?:\.0*#*)?/;function d(e){const t=r((e=e||{}).locale),i=e.pattern||t.pattern,n=t.group,s=t.decimal;let l=1;if(i.includes("%"))l/=100;else if(i.includes("‰"))l/=1e3;else if(i.includes("¤"))throw new Error("currency notation not supported");const d=i.split(";");1===d.length&&d.push("-"+d[0]);const c=u(d,(t=>(t="(?:"+(0,o.Qs)(t,".")+")").replace(a,(t=>{const i={signed:!1,separator:e.strict?n:[n,""],fractional:e.fractional,decimal:s,exponent:!1},o=t.split(".");let r=e.places;1===o.length&&1!==l&&(o[1]="###"),1===o.length||0===r?i.fractional=!1:(void 0===r&&(r=e.pattern?o[1].lastIndexOf("0")+1:1/0),r&&null==e.fractional&&(i.fractional=!0),!e.places&&+r<o[1].length&&(r+=","+o[1].length),i.places=r);const a=o[0].split(",");return a.length>1&&(i.groupSize=a.pop().length,a.length>1&&(i.groupSize2=a.pop().length)),"("+function(e){"places"in(e=e||{})||(e.places=1/0),"string"!=typeof e.decimal&&(e.decimal="."),"fractional"in e&&!String(e.places).startsWith("0")||(e.fractional=[!0,!1]),"exponent"in e||(e.exponent=[!0,!1]),"eSigned"in e||(e.eSigned=[!0,!1]);const t=p(e),i=u(e.fractional,(t=>{let i="";return t&&0!==e.places&&(i="\\"+e.decimal,e.places===1/0?i="(?:"+i+"\\d+)?":i+="\\d{"+e.places+"}"),i}),!0);let o=t+i;return i&&(o="(?:(?:"+o+")|(?:"+i+"))"),o+u(e.exponent,(t=>t?"([eE]"+p({signed:e.eSigned})+")":""))}(i)+")"}))),!0);return{regexp:c.replaceAll(/[\xa0 ]/g,"[\\s\\xa0]"),group:n,decimal:s,factor:l}}function c(e,t){const i=d(t),o=new RegExp("^"+i.regexp+"$").exec(e);if(!o)return NaN;let n=o[1];if(!o[1]){if(!o[2])return NaN;n=o[2],i.factor*=-1}return n=n.replaceAll(new RegExp("["+i.group+"\\s\\xa0]","g"),"").replace(i.decimal,"."),Number(n)*i.factor}function p(e){return"signed"in(e=e||{})||(e.signed=[!0,!1]),"separator"in e?"groupSize"in e||(e.groupSize=3):e.separator="",u(e.signed,(e=>e?"[-+]":""),!0)+u(e.separator,(t=>{if(!t)return"(?:\\d+)";" "===(t=(0,o.Qs)(t))?t="\\s":" "===t&&(t="\\s\\xa0");const i=e.groupSize,n=e.groupSize2;if(n){const e="(?:0|[1-9]\\d{0,"+(n-1)+"}(?:["+t+"]\\d{"+n+"})*["+t+"]\\d{"+i+"})";return i-n>0?"(?:"+e+"|(?:0|[1-9]\\d{0,"+(i-1)+"}))":e}return"(?:0|[1-9]\\d{0,"+(i-1)+"}(?:["+t+"]\\d{"+i+"})*)"}),!0)}const u=(e,t,i)=>{if(!Array.isArray(e))return t(e);const o=[];for(let i=0;i<e.length;i++)o.push(t(e[i]));return h(o.join("|"),Boolean(i))},h=(e,t)=>"("+(t?"?:":"")+e+")"},17256:function(e,t,i){i.d(t,{$B:function(){return m},$i:function(){return _},BZ:function(){return h},DR:function(){return y},Ow:function(){return b},QU:function(){return c},cZ:function(){return g},kR:function(){return a},on:function(){return v},ul:function(){return u},wS:function(){return p},zD:function(){return d}});var o=i(88194),n=i(53286),s=i(60508),r=i(45213),l=i(40030);function a(){return(0,n.i)()}function d(){return(0,n.l)()}function c(e,t){const i=f(t),o=e.replaceAll(/[\u00B0\u00BA]/g,"^").replaceAll("′","'").replaceAll("″",'"'),l=[];return n.b.dmsToGeog(i,1,[o],l)?new s.Z(l[0][0],l[0][1],t||r.Z.WGS84):null}function p(e){return e&&a()?(0,l.p3)(e)??c(`0° 0' 0" N | ${e}`)?.longitude??c(`0 N | ${e}`)?.longitude??null:null}function u(e){return e&&a()?(0,l.p3)(e)??c(`${e} | 0° 0' 0" E`)?.latitude??c(`${e} | 0 E`)?.latitude??null:null}function h(e,t,i){const o=[],l=w(i);if(-1===l)return console.warn(`invalid conversionMode: ${i}`),null;const a=f(t);return n.e.mgrsToGeogExtended(a,1,[e],l,o)?new s.Z(o[0][0],o[0][1],t||r.Z.WGS84):null}function g(e,t){const i=[];!t&&/\(.+27/.test(e)&&(t=r.Z.GCS_NAD_1927);const o=f(t);return n.c.usngToGeog(o,1,[e],i)?new s.Z(i[0][0],i[0][1],t||r.Z.WGS84):null}function y(e,t,i){const o=[],l=C(i);if(-1===l)return console.warn(`invalid conversionMode: ${i}`),null;const a=f(t);return n.d.utmToGeog(a,1,[e],l,o)?new s.Z(o[0][0],o[0][1],t||r.Z.WGS84):null}function b(e,t,i=0){const o=[[e.x,e.y]],s=[],r=f(e.spatialReference);let l=0;switch(t){case"dd":l=n.b.geogToDd(r,1,o,i,s);break;case"ddm":l=n.b.geogToDdm(r,1,o,i,s);break;case"dms":l=n.b.geogToDms(r,1,o,i,s);break;default:return console.warn(`invalid format: ${t}`),null}return l?s[0]:null}function m(e,t,i=0,o=!1){const s=[[e.x,e.y]],r=[],l=f(e.spatialReference);let a=w(t);return-1===a?(console.warn(`invalid conversionMode: ${t}`),null):(o&&(a|=n.e.PE_MGRS_ADD_SPACES),n.e.geogToMgrsExtended(l,1,s,i,!1,a,r)?r[0]:null)}function v(e,t=0,i=!1){const o=[[e.x,e.y]],s=[],r=f(e.spatialReference);return n.c.geogToUsng(r,1,o,t,!1,i,s)?s[0]:null}function _(e,t,i=!1){const o=[[e.x,e.y]],s=[],r=f(e.spatialReference);let l=C(t);return-1===l?(console.warn(`invalid conversionMode: ${t}`),null):(i&&(l|=n.d.PE_UTM_OPTS_ADD_SPACES),n.d.geogToUtm(r,1,o,l,s)?s[0]:null)}function f(e){if(e??=r.Z.WGS84,e.wkid){const t=n.P.geogcs(e.wkid);if(!t)throw new o.Z("coordinate-formatter:invalid-spatial-reference","wkid is not valid");return t}const t=e.wkt2??e.wkt;if(t){const e=n.P.fromString(n.a.PE_TYPE_GEOGCS,t);if(!e)throw new o.Z("coordinate-formatter:invalid-spatial-reference","wkt is not valid");return e}throw new o.Z("coordinate-formatter:invalid-spatial-reference","wkid and wkt are missing")}function w(e){switch(e){case"automatic":return n.e.PE_MGRS_STYLE_AUTO;case"new-180-in-zone-01":return n.e.PE_MGRS_STYLE_NEW|n.e.PE_MGRS_180_ZONE_1_PLUS;case"new-180-in-zone-60":return n.e.PE_MGRS_STYLE_NEW;case"old-180-in-zone-01":return n.e.PE_MGRS_STYLE_OLD|n.e.PE_MGRS_180_ZONE_1_PLUS;case"old-180-in-zone-60":return n.e.PE_MGRS_STYLE_OLD;default:return-1}}function C(e){switch(e){case"latitude-band-indicators":return n.d.PE_UTM_OPTS_NONE;case"north-south-indicators":return n.d.PE_UTM_OPTS_NS;default:return-1}}},47635:function(e,t,i){i.r(t),i.d(t,{default:function(){return q}});var o=i(73440),n=i(997),s=i(84060),r=i(93568),l=i(95490),a=i(17155),d=i(61432),c=i(96711),p=(i(83850),i(48023)),u=i(71354),h=i(45213),g=i(98842),y=i(38209),b=i(88194),m=i(97006),v=i(82592),_=i(67764),f=i(73967),w=i(13878);let C=class extends m.Z{constructor(){super(...arguments),this.type="geojson",this.refresh=(0,r.Ds)((async e=>{await this.load();const{extent:t,timeExtent:i}=await this._connection.invoke("refresh",e);return this.sourceJSON.extent=t,i&&(this.sourceJSON.timeInfo.timeExtent=[i.start,i.end]),{dataChanged:!0,updates:{extent:this.sourceJSON.extent,timeInfo:this.sourceJSON.timeInfo}}}))}load(e){const t=null!=e?e.signal:null;return this.addResolvingPromise(this._startWorker(t)),Promise.resolve(this)}destroy(){this._connection?.close(),this._connection=null}applyEdits(e){return this.load().then((()=>this._applyEdits(e)))}openPorts(){return this.load().then((()=>this._connection.openPorts()))}queryFeatures(e,t={}){return this.load(t).then((()=>this._connection.invoke("queryFeatures",e?e.toJSON():null,t))).then((e=>w.Z.fromJSON(e)))}queryFeaturesJSON(e,t={}){return this.load(t).then((()=>this._connection.invoke("queryFeatures",e?e.toJSON():null,t)))}queryFeatureCount(e,t={}){return this.load(t).then((()=>this._connection.invoke("queryFeatureCount",e?e.toJSON():null,t)))}queryObjectIds(e,t={}){return this.load(t).then((()=>this._connection.invoke("queryObjectIds",e?e.toJSON():null,t)))}queryExtent(e,t={}){return this.load(t).then((()=>this._connection.invoke("queryExtent",e?e.toJSON():null,t))).then((e=>({count:e.count,extent:u.Z.fromJSON(e.extent)})))}querySnapping(e,t={}){return this.load(t).then((()=>this._connection.invoke("querySnapping",e,t)))}async queryAttributeBins(e,t={}){return await this.load(),this._connection.invoke("queryAttributeBins",e?.toJSON(),t)}_applyEdits(e){if(!this._connection)throw new b.Z("geojson-layer-source:edit-failure","Memory source not loaded");const t=this.layer.objectIdField,i=[],o=[],n=[];if(e.addFeatures)for(const t of e.addFeatures)i.push(this._serializeFeature(t));if(e.deleteFeatures)for(const i of e.deleteFeatures)"objectId"in i&&null!=i.objectId?o.push(i.objectId):"attributes"in i&&null!=i.attributes[t]&&o.push(i.attributes[t]);if(e.updateFeatures)for(const t of e.updateFeatures)n.push(this._serializeFeature(t));return this._connection.invoke("applyEdits",{adds:i,updates:n,deletes:o}).then((({extent:e,timeExtent:t,featureEditResults:i})=>(this.sourceJSON.extent=e,t&&(this.sourceJSON.timeInfo.timeExtent=[t.start,t.end]),this._createEditsResult(i))))}_createEditsResult(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(e){const t=!0===e.success?null:e.error||{code:void 0,description:""};return{objectId:e.objectId,globalId:e.globalId,error:t?new b.Z("geojson-layer-source:edit-failure",t.description,{code:t.code}):null}}_serializeFeature(e){const{attributes:t}=e,i=this._geometryForSerialization(e);return i?{geometry:i.toJSON(),attributes:t}:{attributes:t}}_geometryForSerialization(e){const{geometry:t}=e;return null==t?null:"mesh"===t.type||"extent"===t.type?_.Z.fromExtent(t.extent):t}async _startWorker(e){this._connection=await(0,v.bA)("GeoJSONSourceWorker",{strategy:(0,d.Z)("feature-layers-workers")?"dedicated":"local",signal:e,registryTarget:this});const{fields:t,spatialReference:i,hasZ:o,geometryType:n,objectIdField:s,url:r,timeInfo:l,customParameters:a}=this.layer,p="defaults"===this.layer.originOf("spatialReference"),u={url:r,customParameters:a,fields:t&&t.map((e=>e.toJSON())),geometryType:g.Mk.toJSON(n),hasZ:o,objectIdField:s,timeInfo:l?l.toJSON():null,spatialReference:p?null:i&&i.toJSON()},h=await this._connection.invoke("load",u,{signal:e});for(const e of h.warnings)c.Z.getLogger(this.layer).warn("#load()",`${e.message} (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{warning:e});h.featureErrors.length&&c.Z.getLogger(this.layer).warn("#load()",`Encountered ${h.featureErrors.length} validation errors while loading features. (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{errors:h.featureErrors}),this.sourceJSON=h.layerDefinition,this.capabilities=(0,f.MS)(this.sourceJSON.hasZ,!0)}};(0,o._)([(0,a.Cb)()],C.prototype,"capabilities",void 0),(0,o._)([(0,a.Cb)()],C.prototype,"type",void 0),(0,o._)([(0,a.Cb)({constructOnly:!0})],C.prototype,"layer",void 0),(0,o._)([(0,a.Cb)()],C.prototype,"sourceJSON",void 0),C=(0,o._)([(0,p.j)("esri.layers.graphics.sources.GeoJSONSource")],C);var T=i(83263),S=i(55591),M=i(7150),O=i(15303),E=i(88920),P=i(85330),x=i(90833),I=i(27202),L=i(19306),k=i(3752),F=i(99671),Z=i(30472),D=i(93295),R=i(88792),N=i(11755),$=i(49651),A=i(13545),B=i(76554),G=i(89428),V=i(80862),z=i(60541),j=i(29191),H=i(99382),U=i(88097);const W=(0,A.v)();let Y=class extends((0,x.c_)((0,M.tM)((0,S.N)((0,E.M)((0,O.b)((0,T.h7)((0,F.n)((0,Z._)((0,k.M)((0,L.Q)((0,P.q)((0,I.I)((0,s.R)(y.Z)))))))))))))){constructor(e){super(e),this.attributeTableTemplate=null,this.copyright=null,this.dateFieldsTimeZone=null,this.definitionExpression=null,this.displayField=null,this.editingEnabled=!1,this.elevationInfo=null,this.fields=null,this.fieldsIndex=null,this.fullExtent=null,this.geometryType=null,this.hasZ=void 0,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.operationalLayerType="GeoJSON",this.outFields=null,this.popupEnabled=!0,this.popupTemplate=null,this.screenSizePerspectiveEnabled=!0,this.source=new C({layer:this}),this.spatialReference=h.Z.WGS84,this.templates=null,this.title="GeoJSON",this.type="geojson"}destroy(){this.source?.destroy()}load(e){const t=this.loadFromPortal({supportedTypes:["GeoJson"],supportsData:!1},e).catch(r.r9).then((()=>this.source.load(e))).then((()=>{this.read(this.source.sourceJSON,{origin:"service",url:this.parsedUrl}),this.revert(["objectIdField","fields","timeInfo"],"service"),(0,B.YN)(this.renderer,this.fieldsIndex),(0,B.UF)(this.timeInfo,this.fieldsIndex)}));return this.addResolvingPromise(t),Promise.resolve(this)}get capabilities(){return this.source?this.source.capabilities:null}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("capabilities"),(this._get("createQueryVersion")||0)+1}get defaultPopupTemplate(){return this.createPopupTemplate()}get isTable(){return this.loaded&&null==this.geometryType}get parsedUrl(){return this.url?(0,l.mN)(this.url):null}set renderer(e){(0,B.YN)(e,this.fieldsIndex),this._set("renderer",e)}set url(e){if(!e)return void this._set("url",e);const t=(0,l.mN)(e);this._set("url",t.path),t.query&&(this.customParameters={...this.customParameters,...t.query})}async applyEdits(e,t){const{applyEdits:o}=await Promise.all([i.e(99813),i.e(5876)]).then(i.bind(i,99813));await this.load();const n=await o(this,this.source,e,t);return this.read({extent:this.source.sourceJSON.extent,timeInfo:this.source.sourceJSON.timeInfo},{origin:"service",ignoreDefaults:!0}),n}on(e,t){return super.on(e,t)}createPopupTemplate(e){return(0,H.eZ)(this,e)}createQuery(){const e=new j.Z,t=this.capabilities?.data;e.returnGeometry=!0,t&&t.supportsZ&&(e.returnZ=!0),e.outFields=["*"],e.where=this.definitionExpression||"1=1";const{timeOffset:i,timeExtent:o}=this;return e.timeExtent=null!=i&&null!=o?o.offset(-i.value,i.unit):o||null,e}getFieldDomain(e,t){return this.getField(e)?.domain}getField(e){return this.fieldsIndex.get(e)}queryFeatures(e,t){return this.load().then((()=>this.source.queryFeatures(j.Z.from(e)||this.createQuery(),t))).then((e=>{if(e?.features)for(const t of e.features)t.layer=t.sourceLayer=this;return e}))}queryObjectIds(e,t){return this.load().then((()=>this.source.queryObjectIds(j.Z.from(e)||this.createQuery(),t)))}queryFeatureCount(e,t){return this.load().then((()=>this.source.queryFeatureCount(j.Z.from(e)||this.createQuery(),t)))}queryExtent(e,t){return this.load().then((()=>this.source.queryExtent(j.Z.from(e)||this.createQuery(),t)))}async queryAttributeBins(e,t){const{source:o,capabilities:n}=await this.load();(0,R.O2)(e,n,"GeoJSONLayer");const s=await Promise.all([i.e(37608),i.e(34042)]).then(i.bind(i,37608)),r=await o.queryAttributeBins(s.default.from(e),t);if(r.features)for(const e of r.features)e.layer=e.sourceLayer=this;return r}async hasDataChanged(){try{const{dataChanged:e,updates:t}=await this.source.refresh(this.customParameters);return null!=t&&this.read(t,{origin:"service",url:this.parsedUrl,ignoreDefaults:!0}),e}catch{}return!1}};(0,o._)([(0,a.Cb)(D.t4)],Y.prototype,"attributeTableTemplate",void 0),(0,o._)([(0,a.Cb)({readOnly:!0,json:{read:!1,write:!1}})],Y.prototype,"capabilities",null),(0,o._)([(0,a.Cb)({type:String})],Y.prototype,"copyright",void 0),(0,o._)([(0,a.Cb)({readOnly:!0})],Y.prototype,"createQueryVersion",null),(0,o._)([(0,a.Cb)((0,U.mi)("dateFieldsTimeReference"))],Y.prototype,"dateFieldsTimeZone",void 0),(0,o._)([(0,a.Cb)({readOnly:!0})],Y.prototype,"defaultPopupTemplate",null),(0,o._)([(0,a.Cb)({type:String,json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],Y.prototype,"definitionExpression",void 0),(0,o._)([(0,a.Cb)({type:String})],Y.prototype,"displayField",void 0),(0,o._)([(0,a.Cb)({type:Boolean})],Y.prototype,"editingEnabled",void 0),(0,o._)([(0,a.Cb)(D.PV)],Y.prototype,"elevationInfo",void 0),(0,o._)([(0,a.Cb)({type:[$.Z],json:{name:"layerDefinition.fields",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"fields"}}}})],Y.prototype,"fields",void 0),(0,o._)([(0,a.Cb)(W.fieldsIndex)],Y.prototype,"fieldsIndex",void 0),(0,o._)([(0,a.Cb)({type:u.Z,json:{name:"extent"}})],Y.prototype,"fullExtent",void 0),(0,o._)([(0,a.Cb)({type:["point","polygon","polyline","multipoint"],json:{read:{reader:g.Mk.read}}})],Y.prototype,"geometryType",void 0),(0,o._)([(0,a.Cb)({type:Boolean})],Y.prototype,"hasZ",void 0),(0,o._)([(0,a.Cb)(D.id)],Y.prototype,"id",void 0),(0,o._)([(0,a.Cb)({type:Boolean,readOnly:!0})],Y.prototype,"isTable",null),(0,o._)([(0,a.Cb)(D.iR)],Y.prototype,"labelsVisible",void 0),(0,o._)([(0,a.Cb)({type:[G.Z],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:V.r},write:!0}})],Y.prototype,"labelingInfo",void 0),(0,o._)([(0,a.Cb)(D.rn)],Y.prototype,"legendEnabled",void 0),(0,o._)([(0,a.Cb)({type:["show","hide"]})],Y.prototype,"listMode",void 0),(0,o._)([(0,a.Cb)({type:String,json:{name:"layerDefinition.objectIdField",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"objectIdField"}}}})],Y.prototype,"objectIdField",void 0),(0,o._)([(0,a.Cb)(D.Oh)],Y.prototype,"opacity",void 0),(0,o._)([(0,a.Cb)({type:["GeoJSON"]})],Y.prototype,"operationalLayerType",void 0),(0,o._)([(0,a.Cb)(W.outFields)],Y.prototype,"outFields",void 0),(0,o._)([(0,a.Cb)({readOnly:!0})],Y.prototype,"parsedUrl",null),(0,o._)([(0,a.Cb)(D.C_)],Y.prototype,"popupEnabled",void 0),(0,o._)([(0,a.Cb)({type:n.Z,json:{name:"popupInfo",write:!0}})],Y.prototype,"popupTemplate",void 0),(0,o._)([(0,a.Cb)({types:z.Av,json:{name:"layerDefinition.drawingInfo.renderer",write:!0,origins:{service:{name:"drawingInfo.renderer"},"web-scene":{types:z.o}}}})],Y.prototype,"renderer",null),(0,o._)([(0,a.Cb)(D.YI)],Y.prototype,"screenSizePerspectiveEnabled",void 0),(0,o._)([(0,a.Cb)({readOnly:!0})],Y.prototype,"source",void 0),(0,o._)([(0,a.Cb)({type:h.Z})],Y.prototype,"spatialReference",void 0),(0,o._)([(0,a.Cb)({type:[N.Z]})],Y.prototype,"templates",void 0),(0,o._)([(0,a.Cb)()],Y.prototype,"title",void 0),(0,o._)([(0,a.Cb)({json:{read:!1},readOnly:!0})],Y.prototype,"type",void 0),(0,o._)([(0,a.Cb)(D.HQ)],Y.prototype,"url",null),Y=(0,o._)([(0,p.j)("esri.layers.GeoJSONLayer")],Y);const q=Y},17749:function(e,t,i){i.d(t,{e:function(){return n},g:function(){return o}});const o={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!0,supportsCurrentUser:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsPaginationOnAggregatedQueries:!1,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!0,supportsReturnMesh:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,maxUniqueIDCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0,supportsTrueCurve:!1},n={supportsDate:!0,supportsFixedInterval:!0,supportsAutoInterval:!0,supportsFixedBoundaries:!0,supportsStackBy:!0,supportsSplitBy:!0,supportsSnapToData:!1,supportsReturnFullIntervalBin:!1,supportsFirstDayOfWeek:!1,supportsNormalization:!0,supportedStatistics:{count:!0,sum:!0,avg:!0,var:!0,stddev:!0,min:!0,max:!0,percentileContinuous:!0,percentileDiscrete:!0,envelope:!0,centroid:!0,convexHull:!0},supportedNormalizationTypes:{field:!0,log:!0,naturalLog:!0,percentOfTotal:!0,squareRoot:!0}}},73967:function(e,t,i){i.d(t,{Dm:function(){return c},Hq:function(){return u},MS:function(){return h},bU:function(){return l}});var o=i(61432),n=i(28947),s=i(17749),r=i(54914);function l(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?r.I4:"esriGeometryPolyline"===e?r.ET:r.lF}}}const a=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let d=1;function c(e,t){if((0,o.Z)("esri-csp-restrictions"))return()=>({[t]:null,...e});try{let i=`this${p(t)} = null;`;for(const t in e)i+=`this${p(t)} = ${JSON.stringify(e[t])};`;const o=new Function(`\n      return class AttributesClass$${d++} {\n        constructor() {\n          ${i};\n        }\n      }\n    `)();return()=>new o}catch(i){return()=>({[t]:null,...e})}}function p(e){return a.test(e)?`.${e}`:`["${e}"]`}function u(e={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,n.d9)(e)}}]}function h(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryBins:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:s.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryAttributeBins:s.e,editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},7150:function(e,t,i){i.d(t,{tM:function(){return v},jp:function(){return _},ey:function(){return f}});var o=i(73440),n=i(60123),s=i(17155),r=(i(61432),i(96711),i(83850),i(48023)),l=i(71840),a=i(89314),d=i(43254),c=i(63255),p=i(29884),u=i(4469),h=i(18764);const g={write:{overridePolicy:(e,t,i)=>({enabled:!i||"scale"===i.filterMode})}};let y=class extends(a.Z.ClonableMixin(c.Z)){constructor(e){super(e),this.id=(0,h.DO)(),this.maxScale=0,this.minScale=0,this.title="",this.where=null}};(0,o._)([(0,s.Cb)({type:String,json:{write:!0}})],y.prototype,"id",void 0),(0,o._)([(0,s.Cb)({type:Number,json:g})],y.prototype,"maxScale",void 0),(0,o._)([(0,s.Cb)({type:Number,json:g})],y.prototype,"minScale",void 0),(0,o._)([(0,s.Cb)({type:String,json:{write:!0}})],y.prototype,"title",void 0),(0,o._)([(0,s.Cb)({type:String,json:{write:!0}})],y.prototype,"where",void 0),y=(0,o._)([(0,r.j)("esri.layers.support.DisplayFilter")],y);var b=i(78279);let m=class extends(a.Z.ClonableMixin(c.Z)){constructor(e){super(e),this.activeFilterId=null,this.filters=new(d.Z.ofType(y)),this.mode="manual"}writeFilters(e,t,i,o){const n=e.toArray();"scale"===this.mode&&n.sort(((e,t)=>{const i=(0,u.Nf)(t.minScale,e.minScale),o=e.maxScale-t.maxScale;return 0===i?o:i})),t[i]=n.map((e=>e.toJSON(o)))}write(e,t){return super.write(e,(0,b.Ee)(this,t))}};(0,o._)([(0,s.Cb)({type:String,json:{write:{overridePolicy:(e,t,i)=>({enabled:"manual"===i.filterMode,isRequired:!0})}}})],m.prototype,"activeFilterId",void 0),(0,o._)([(0,s.Cb)({type:d.Z.ofType(y),nonNullable:!0,json:{write:!0}})],m.prototype,"filters",void 0),(0,o._)([(0,p.c)("filters")],m.prototype,"writeFilters",null),(0,o._)([(0,s.Cb)({type:["manual","scale"],nonNullable:!0,json:{name:"filterMode",write:!0}})],m.prototype,"mode",void 0),m=(0,o._)([(0,r.j)("esri.layers.support.DisplayFilterInfo")],m);const v=e=>{let t=class extends e{constructor(){super(...arguments),this.displayFilterEnabled=!0,this.displayFilterInfo=null}};return(0,o._)([(0,s.Cb)(_)],t.prototype,"displayFilterEnabled",void 0),(0,o._)([(0,s.Cb)(f)],t.prototype,"displayFilterInfo",void 0),t=(0,o._)([(0,r.j)("esri.layers.mixins.DisplayFilteredLayer")],t),t},_={type:Boolean,json:{name:"layerDefinition.disableDisplayFilter",read:{reader:e=>!e},write:{layerContainerTypes:l.C,writer(e,t,i){(0,n.RB)(i,!e,t)}},origins:{"web-scene":{write:!1,read:!1}}}},f={type:m,json:{name:"layerDefinition.displayFilterInfo",write:{enabled:!0,allowNull:!0,layerContainerTypes:l.C},origins:{"web-scene":{write:!1,read:!1}}}}},99671:function(e,t,i){i.d(t,{I:function(){return h},n:function(){return g}});var o=i(73440),n=i(17155),s=(i(61432),i(96711),i(83850),i(1194)),r=i(48023),l=i(71840),a=i(76554),d=i(83918),c=i(24009),p=i(85913),u=i(62920);const h={type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation",layerContainerTypes:l.C}}},g=e=>{let t=class extends e{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(e,t){const i=t.timeInfo.exportOptions;if(!i)return null;const o=i.timeOffset,n=c.v.fromJSON(i.timeOffsetUnits);return o&&n?new u.T({value:o,unit:n}):null}set timeInfo(e){(0,a.UF)(e,this.fieldsIndex),this._set("timeInfo",e)}};return(0,o._)([(0,n.Cb)({type:p.T,json:{write:!1}})],t.prototype,"timeExtent",void 0),(0,o._)([(0,n.Cb)({type:u.T})],t.prototype,"timeOffset",void 0),(0,o._)([(0,s.r)("service","timeOffset",["timeInfo.exportOptions"])],t.prototype,"readOffset",null),(0,o._)([(0,n.Cb)({value:null,type:d.Z,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],t.prototype,"timeInfo",null),(0,o._)([(0,n.Cb)(h)],t.prototype,"useViewTime",void 0),t=(0,o._)([(0,r.j)("esri.layers.mixins.TemporalLayer")],t),t}},30472:function(e,t,i){i.d(t,{_:function(){return f}});var o=i(73440),n=i(17155),s=(i(61432),i(96711),i(83850),i(48023)),r=i(997),l=i(89314),a=i(63255),d=i(60123),c=i(29884),p=i(76401),u=i(93295),h=i(89428),g=i(60541);let y=class extends(l.Z.ClonableMixin(a.Z)){constructor(e){super(e),this.labelingInfo=null,this.labelsVisible=!0,this.renderer=null,this.visible=!0}};(0,o._)([(0,n.Cb)({type:[h.Z],json:{write:!0}})],y.prototype,"labelingInfo",void 0),(0,o._)([(0,n.Cb)(u.iR)],y.prototype,"labelsVisible",void 0),(0,o._)([(0,n.Cb)({types:g.Av,json:{write:!0}})],y.prototype,"renderer",void 0),(0,o._)([(0,n.Cb)({type:Boolean,json:{write:!0}})],y.prototype,"visible",void 0),y=(0,o._)([(0,s.j)("esri.layers.support.TrackPartInfo")],y);var b=i(43957),m=i(9350),v=i(62920);let _=class extends(l.Z.ClonableMixin(a.Z)){constructor(e){super(e),this.enabled=!0,this.fields=[],this.latestObservations=new y({renderer:new b.Z({symbol:m.xA.clone()})}),this.maxDisplayDuration=null,this.maxDisplayObservationsPerTrack=0,this.popupEnabled=!0,this.popupTemplate=null,this.previousObservations=new y({renderer:new b.Z({symbol:m.xA.clone()})}),this.trackLines=new y({renderer:new b.Z({symbol:m.CJ.clone()})}),this.timeField="startTimeField"}writeFields(e,t,i){const o=e.filter((e=>"avg_angle"!==e.statisticType)).map((e=>e.toJSON()));(0,d.RB)(i,o,t)}};(0,o._)([(0,n.Cb)({type:Boolean,json:{write:!0}})],_.prototype,"enabled",void 0),(0,o._)([(0,n.Cb)({type:[p.Z],json:{write:!0}})],_.prototype,"fields",void 0),(0,o._)([(0,c.c)("fields")],_.prototype,"writeFields",null),(0,o._)([(0,n.Cb)({type:y,json:{write:!0}})],_.prototype,"latestObservations",void 0),(0,o._)([(0,n.Cb)({type:v.T,json:{write:!0}})],_.prototype,"maxDisplayDuration",void 0),(0,o._)([(0,n.Cb)({type:Number,json:{write:!0}})],_.prototype,"maxDisplayObservationsPerTrack",void 0),(0,o._)([(0,n.Cb)(u.C_)],_.prototype,"popupEnabled",void 0),(0,o._)([(0,n.Cb)({type:r.Z,json:{name:"popupInfo",write:!0}})],_.prototype,"popupTemplate",void 0),(0,o._)([(0,n.Cb)({type:y,json:{write:!0}})],_.prototype,"previousObservations",void 0),(0,o._)([(0,n.Cb)({type:y,json:{write:!0}})],_.prototype,"trackLines",void 0),(0,o._)([(0,n.Cb)({type:["timeReceived","startTimeField","endTimeField"],json:{read:!0,write:!0}})],_.prototype,"timeField",void 0),_=(0,o._)([(0,s.j)("esri.layers.support.TrackInfo")],_);const f=e=>{let t=class extends e{constructor(){super(...arguments),this.trackInfo=null}};return(0,o._)([(0,n.Cb)({type:_})],t.prototype,"trackInfo",void 0),t=(0,o._)([(0,s.j)("esri.layers.mixins.TrackableLayer")],t),t}},83918:function(e,t,i){i.d(t,{Z:function(){return g}});var o=i(73440),n=i(89314),s=i(63255),r=i(17155),l=(i(61432),i(96711),i(83850),i(1194)),a=i(48023),d=i(29884),c=i(85913),p=i(62920),u=i(88097);function h(e,t){return p.T.fromJSON({value:e,unit:t})}let g=class extends(n.Z.ClonableMixin(s.Z)){constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeZone=null,this.trackIdField=null,this.useTime=!0,this.stops=null}readFullTimeExtent(e,t){return t.timeExtent&&Array.isArray(t.timeExtent)&&2===t.timeExtent.length?c.T.fromArray(t.timeExtent):null}writeFullTimeExtent(e,t){null!=e?.start&&null!=e.end?t.timeExtent=e.toArray():t.timeExtent=null}readInterval(e,t){return t.timeInterval&&t.timeIntervalUnits?h(t.timeInterval,t.timeIntervalUnits):t.defaultTimeInterval&&t.defaultTimeIntervalUnits?h(t.defaultTimeInterval,t.defaultTimeIntervalUnits):null}writeInterval(e,t){t.timeInterval=e?.toJSON().value??null,t.timeIntervalUnits=e?.toJSON().unit??null}};(0,o._)([(0,r.Cb)({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],g.prototype,"cumulative",void 0),(0,o._)([(0,r.Cb)({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],g.prototype,"endField",void 0),(0,o._)([(0,r.Cb)({type:c.T,json:{write:{enabled:!0,allowNull:!0}}})],g.prototype,"fullTimeExtent",void 0),(0,o._)([(0,l.r)("fullTimeExtent",["timeExtent"])],g.prototype,"readFullTimeExtent",null),(0,o._)([(0,d.c)("fullTimeExtent")],g.prototype,"writeFullTimeExtent",null),(0,o._)([(0,r.Cb)({type:Boolean,json:{write:!0}})],g.prototype,"hasLiveData",void 0),(0,o._)([(0,r.Cb)({type:p.T,json:{write:{enabled:!0,allowNull:!0}}})],g.prototype,"interval",void 0),(0,o._)([(0,l.r)("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],g.prototype,"readInterval",null),(0,o._)([(0,d.c)("interval")],g.prototype,"writeInterval",null),(0,o._)([(0,r.Cb)({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],g.prototype,"startField",void 0),(0,o._)([(0,r.Cb)((0,u.mi)("timeReference",!0))],g.prototype,"timeZone",void 0),(0,o._)([(0,r.Cb)({type:String,json:{write:{enabled:!0,allowNull:!0}}})],g.prototype,"trackIdField",void 0),(0,o._)([(0,r.Cb)({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],g.prototype,"useTime",void 0),(0,o._)([(0,r.Cb)({type:[Date],json:{read:!1}})],g.prototype,"stops",void 0),g=(0,o._)([(0,a.j)("esri.layers.support.TimeInfo")],g)},78279:function(e,t,i){i.d(t,{Ee:function(){return s},Gr:function(){return l},UO:function(){return r}});var o=i(99574),n=i(48797);function s(e,t){return{...t,filterMode:e.mode}}function r(e,t){return a(e,t).next().value??null}function l(e,t,i){const s=function(e){if("manual"===c(e))return null;const t=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:i,maxScale:o}of e.filters)t[0]=Math.max(t[0],p(i)),t[1]=Math.min(t[1],u(o));return t}(e);if(s&&((0,o.nB)(t,s[0])||(0,o.pt)(i,s[1])))return"";const r=Array.from(a(e,t,i)),l=function(e,t,i){if(0===e.length)return!0;const n=p(e.at(0)?.minScale),s=u(e.at(-1)?.maxScale);if((0,o.pt)(n,t)||(0,o.nB)(s,i))return!0;for(let t=0;t<e.length-1;t++){const i=e[t],n=e[t+1];if((0,o.pt)(p(n.minScale),u(i.maxScale)))return!0}return!1}(r,t,i)?"1=1":r.map((e=>e.where||"1=1")).reduce(((e,t)=>(0,n.D3)(e,t)),"");return l&&"1=1"!==l?l:""}function*a(e,t,i){if("manual"===c(e)){const t=e.filters.find((t=>t.id===e.activeFilterId));t&&(yield t)}else{"object"==typeof t&&(t=t.scale);for(const o of e.filters)d(o.minScale,o.maxScale,t,i)&&(yield o)}}function d(e,t,i,n){return e=p(e),i=p(i),t=u(t),!(!(0,o.W8)(i,e)&&(n??i)>e||(0,o.aR)(t,i)||void 0!==n&&(0,o.W8)(n,e))}function c(e){return"mode"in e?e.mode:e.filterMode}function p(e){return e||Number.POSITIVE_INFINITY}function u(e){return e||0}},13545:function(e,t,i){i.d(t,{v:function(){return a}});var o=i(61432),n=i(96711),s=i(49651),r=i(299),l=i(76554);function a(){return{fields:{type:[s.Z],value:null,set:function(e){if(e&&(0,o.Z)("big-integer-warning-enabled")){const t=e.filter((e=>"big-integer"===e.type||"oid"===e.type&&(e.length||0)>=8));if(t.length){const e=t.map((e=>`'${e.name}'`)).join(", ");n.Z.getLogger(this).warn("#fields",`Layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}') references big-integer field(s): ${e}, support for which is experimental. Only integers less than ${Number.MAX_SAFE_INTEGER} (Number.MAX_SAFE_INTEGER) are supported.`)}}this._set("fields",e)}},fieldsIndex:{readOnly:!0,get(){return r.Z.fromLayer(this)}},outFields:{type:[String],json:{read:!1},set:function(e){this._userOutFields=e,this.notifyChange("outFields")},get:function(){const e=this._userOutFields;if(!e?.length)return null;if(e.includes("*"))return["*"];if(!this.fields)return e;for(const t of e){const i=this.fieldsIndex?.has(t);i||n.Z.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${t} found in outFields`,{layer:this,outFields:e})}return(0,l.Q0)(this.fieldsIndex,e)}}}}},71730:function(e,t,i){function o(e,t){return t?"xoffset"in t&&t.xoffset?Math.max(e,Math.abs(t.xoffset)):"yoffset"in t&&t.yoffset?Math.max(e,Math.abs(t.yoffset||0)):e:e}function n(e,t){return"number"==typeof e?e:e?.stops?.length?function(e){let t=0,i=0;for(let o=0;o<e.length;o++){const n=e[o].size;"number"==typeof n&&(t+=n,i++)}return t/i}(e.stops):t}function s(e,t){if(!t)return e;const i=t.filter((e=>"size"===e.type)).map((t=>{const{maxSize:i,minSize:o}=t;return(n(i,e)+n(o,e))/2}));let o=0;const s=i.length;if(0===s)return e;for(let e=0;e<s;e++)o+=i[e];const r=Math.floor(o/s);return Math.max(r,e)}function r(e){const t=e?.renderer,i=e?.pointerType,n="touch"===i?9:6;if(!t)return n;const r="visualVariables"in t?s(n,t.visualVariables):n;if("simple"===t.type)return o(r,t.symbol);if("unique-value"===t.type){let e=r;return t.uniqueValueInfos?.forEach((t=>{e=o(e,t.symbol)})),e}if("class-breaks"===t.type){let e=r;return t.classBreakInfos.forEach((t=>{e=o(e,t.symbol)})),e}return"dot-density"===t.type||t.type,r}i.d(t,{k:function(){return r}})},31066:function(e,t,i){i.d(t,{M:function(){return o}});const o={absolute:"absolute-direction",relative:"relative-direction"}},54318:function(e,t,i){i.d(t,{D:function(){return l},K:function(){return r}});var o=i(26636),n=i(71354),s=i(71730);function r(e,t,i,s=new n.Z){let r=0;if("2d"===i.type)r=t*(i.resolution??0);else if("3d"===i.type){const n=i.overlayPixelSizeInMapUnits(e),s=i.basemapSpatialReference;r=null==s||s.equals(i.spatialReference)?t*n:(0,o.c9)(s)/(0,o.c9)(i.spatialReference)}const l=e.x-r,a=e.y-r,d=e.x+r,c=e.y+r,{spatialReference:p}=i;return s.xmin=Math.min(l,d),s.ymin=Math.min(a,c),s.xmax=Math.max(l,d),s.ymax=Math.max(a,c),s.spatialReference=p,s}function l(e,t,i){const o=i.toMap(e);return null!=o&&r(o,(0,s.k)(),i,a).intersects(t)}const a=new n.Z},24858:function(e,t,i){i.d(t,{Z:function(){return Q}});var o=i(73440),n=i(96711),s=i(61100),r=i(17155),l=i(90775),a=(i(61432),i(83850),i(48023)),d=i(1803),c=i(1800),p=i(46451),u=(i(55214),i(43254)),h=i(88194),g=i(87833),y=i(90403),b=i(60508),m=i(13132),v=i(48596),_=i(68578),f=i(70880),w=i(82344);let C=class extends f.Z{constructor(e){super(e),this.format=null,this.position={coordinate:null,location:null}}get displayCoordinate(){return this.format?.getDisplayCoordinate(this.position?.coordinate)}};(0,o._)([(0,r.Cb)({readOnly:!0})],C.prototype,"displayCoordinate",null),(0,o._)([(0,r.Cb)({type:w.Z})],C.prototype,"format",void 0),(0,o._)([(0,r.Cb)()],C.prototype,"position",void 0),C=(0,o._)([(0,a.j)("esri.widgets.CoordinateConversion.support.Conversion")],C);const T=C;var S=i(1985),M=i(86225),O=i(63712),E=i(12816),P=i(74765);const x="default",I="crosshair",L=new b.Z([0,0,500]),k=["mgrs","utm","usng","dd","dms","ddm"],F="esri__coordinateConversionWidgetState",Z="conversions",D="formats",R="view",N="view-change";let $=class extends((0,O.Z)(g.Z.EventedAccessor)){constructor(e){super(e),this._conversionPromise=null,this._locationGraphic=null,this._pointerCount=0,this.conversions=new u.Z,this.formats=new u.Z,this.formatterAvailable=!1,this.messages=null,this.filteredFormats=new u.Z,this.locationSymbol=new v.Z({url:(0,c.V)("esri/images/search/search-symbol-32.png"),width:24,height:24}),this.storageEnabled=!0,this.storageType="session",this.view=null,this._saveWidgetState=this._saveWidgetState.bind(this),this._handleFormatChange=this._handleFormatChange.bind(this),this._handleConversionChange=this._handleConversionChange.bind(this),this._handleViewChange=this._handleViewChange.bind(this),this._onClick=this._onClick.bind(this),this._onPointerMove=this._onPointerMove.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerUp=this._onPointerUp.bind(this)}initialize(){const e=async()=>this.messages=await(0,E.ME)("esri/widgets/CoordinateConversion/t9n/CoordinateConversion");this.formats.addMany((0,M.CO)()),e().then((()=>{if(!this.destroyed&&((0,M.ke)(this.messages,this.formats),this.storageEnabled&&this._loadWidgetState(),this.formats.forEach((e=>{e.viewModel=this,this.addHandles((0,y.YP)((()=>e.currentPattern),this._saveWidgetState),e.name??"unnamed-format")})),this.addHandles(this.conversions.on("change",this._handleConversionChange),Z),this.addHandles(this.formats.on("change",this._handleFormatChange),D),this.addHandles((0,P.qe)((()=>{e().then((()=>{(0,M.ke)(this.messages,this.formats)}))}))),(0,m.load)().then((()=>{this.formatterAvailable=!0})).catch((e=>{n.Z.getLogger(this).error(new h.Z("coordinate-conversion:projection-load-failed","Failed to load the projection module.",{error:e})),this.formatterAvailable=!1,this._filterFormatsAndConversions()})).then((()=>this.addHandles((0,y.YP)((()=>this.view),this._handleViewChange,y.nn),N))),0===this.conversions.length)){const e=this.formats.find((e=>"xy"===e.name))||this.formats.at(0);this.conversions.add(new T({format:e}))}}))}destroy(){this.removeHandles(),this._cleanUpView(this.view),this.view=null}castConversions(e){return this._castToConversions(e)}set currentLocation(e){this._set("currentLocation",e),this._updateConversions()}get currentLocation(){return this._get("currentLocation")||null}set mode(e){switch(e){case"capture":this.currentLocation=null,this._startCaptureMode(),this._set("mode",e);break;case"live":this._startLiveMode(),this._set("mode",e)}}get mode(){return this._get("mode")||"live"}get state(){const{messages:e,view:t}=this,i=t?.ready;return e?i?"ready":t?"loading":"disabled":"disabled"}get storage(){const{storageType:e}=this;return"session"===e?sessionStorage:localStorage}get waitingForConversions(){return null!=this._conversionPromise}setLocation(e){if(this._locationGraphic&&this.view?.graphics.remove(this._locationGraphic),!e)return;const t=e.clone();t.hasZ&&(t.z=void 0),this._locationGraphic=new p.Z({geometry:t,symbol:this.locationSymbol}),this.view?.graphics.add(this._locationGraphic)}async convert(e,t){if(!(0,S.J$)(t))throw new h.Z("coordinate-conversion:invalid-point","Invalid point cannot be converted.",{point:t});return Promise.resolve().then((()=>e.convert(t)))}async goToLocation(e){const{view:t}=this;if(!t)throw new h.Z("coordinate-conversion:go-to-failed","no view");const i="3d"===t.type?t.clippingArea:null,o=t.map?.basemap?.baseLayers;if(i||(o?.length??0)>0){const t=i??o?.at(0)?.fullExtent;if(null!=t&&!t.contains(e))throw new h.Z("coordinate-conversion:go-to-failed","Point outside basemap extent.",{point:e})}return this.callGoTo({target:e})}pause(){this.currentLocation=null,this.removeHandles(R),this.view&&(this.view.cursor=x,this._locationGraphic&&this.view.graphics.remove(this._locationGraphic))}async previewConversion(e,t=this.currentLocation||L){return(await A(e,t)).displayCoordinate}resume(){"capture"===this.mode?this._startCaptureMode():this._startLiveMode()}reverseConvert(e,t){return t.reverseConvert(e)}async updateConversions(e,t){if("point"!==t?.type)throw this._clearConversions(this.conversions),new h.Z("coordinate-conversion:invalid-input-point","Point is invalid, conversions cannot be updated.",{point:t});return this._convertMany(e,t)}_castToConversions(e){const t=new u.Z;return e.forEach((e=>{let i=null;if(e instanceof T)i=e;else if("string"==typeof e){const t=this.formats.find((t=>t.name===e));t&&(i=new T({format:t}))}i&&t.add(i)})),t}_cleanUpView(e){e&&(this._locationGraphic&&e.graphics.remove(this._locationGraphic),this.removeHandles(R),e.cursor=x)}_clearConversions(e){e.forEach((e=>{e.position={location:null,coordinate:null}}))}async _convertMany(e,t){return Promise.all(e.map((e=>A(e,t))))}_handleConversionChange(e){for(const t of e.added){const{format:e}=t;e&&(e.viewModel=this,this.currentLocation&&(this._set("waitingForConversions",!0),this.convert(e,this.currentLocation).then((e=>{t.position=e,this._set("waitingForConversions",!1)}))))}this._saveWidgetState()}_handleFormatChange(e){e.added.forEach((e=>{this.addHandles((0,y.YP)((()=>e.currentPattern),this._saveWidgetState),e.name??"unnamed-format"),e.viewModel=this})),e.removed.forEach((e=>{e.viewModel=null;const t=this.conversions.filter((t=>t.format===e));this.conversions.removeMany(t),e.name&&this.removeHandles(e.name)}))}_loadWidgetState(){try{const e=JSON.parse(this.storage.getItem(F));e&&this._setWidgetState(e)}catch(e){n.Z.getLogger(this).error(new h.Z("coordinate-conversion:invalid-session-storage-json","Could not read from storage.",{error:e}))}}_startCaptureMode(){this.removeHandles(R),this.view&&(this.view.cursor=I,this.currentLocation&&this.setLocation(this.currentLocation),this.addHandles(this.view.on("click",this._onClick),R))}_startLiveMode(){this._pointerCount=0,this.removeHandles(R),this.view&&(this.view.cursor=x,this._locationGraphic&&this.view.graphics.remove(this._locationGraphic),this.addHandles([this.view.on("pointer-down",this._onPointerDown),this.view.on("pointer-up",this._onPointerUp),this.view.on("pointer-move",this._onPointerMove)],R))}_handleViewChange(e,t){t&&t!==e&&this._cleanUpView(t),e&&("capture"===this.mode?this._startCaptureMode():this._startLiveMode(),t&&this._filterFormatsAndConversions())}_onClick(e){if(0===e.button){const t=this.view?.toMap(e),i=t?.normalize();this.setLocation(i),this.currentLocation=i}}_onPointerDown(e){const{pointerType:t}=e;if(this._pointerCount++,("touch"===t||"pen"===t)&&1===this._pointerCount){const t=this.view?.toMap(e);this.currentLocation=t?.normalize()}}_onPointerMove(e){const{pointerType:t}=e;if("mouse"===t||1===this._pointerCount){const t=this.view?.toMap(e);this.currentLocation=t?.normalize()}}_onPointerUp(){this._pointerCount--}_setWidgetState(e){try{e.formats.forEach((t=>{const i=this.formats.find((e=>e.name===t.name));i&&e.locale===(0,P.Kd)()&&t.currentPattern&&(i.currentPattern=t.currentPattern),i&&t.index>=0&&this.conversions.add(new T({format:i}))}))}catch(e){n.Z.getLogger(this).warn(new h.Z("coordinate-conversion:session-storage-read-error","Could not get widget state from stored JSON.",{error:e}))}}_saveWidgetState(){if(!this.storageEnabled)return;const e=this._toJSON();try{this.storage.setItem(F,JSON.stringify({formats:e,locale:(0,P.Kd)()}))}catch(e){n.Z.getLogger(this).error(new h.Z("coordinate-conversion:local-storage-write-error","Could not write to localStorage.",{error:e}))}}async _updateConversions(){try{await this.updateConversions(this.conversions.toArray(),this.currentLocation)}catch{}}_toJSON(){return this.formats.filter((e=>{const t=e.name;return"xy"===t||"basemap"===t||(0,S.hf)(t)})).map((e=>({name:e.name,currentPattern:e.currentPattern,defaultPattern:e.defaultPattern,index:this.conversions.findIndex((t=>t.format===e))}))).sort(((e,t)=>e.index-t.index)).toArray()}_filterFormatsAndConversions(){const{formatterAvailable:e,conversions:t,formats:i}=this;e||this.addHandles((0,y.gx)((()=>this.view?.spatialReference),(e=>{const o=e.isWebMercator||e.isWGS84,n=i.filter((e=>{const{name:t}=e;return!!function(e){return k.includes(e)}(t)||"xy"===t&&!o})),s=this.filteredFormats.filter((e=>"xy"===e.name&&o&&!this.formats.includes(e))),r=t.filter((e=>n.includes(e.format)));i.removeMany(n),t.removeMany(r),this.filteredFormats.addMany(n.filter((e=>!this.filteredFormats.includes(e)))),i.addMany(s)}),{once:!0,initial:!0}),R)}};async function A(e,t){try{e.position=await(e.format?.convert(t))}catch(t){e.position=null}return e}(0,o._)([(0,r.Cb)({type:u.Z.ofType(T)})],$.prototype,"conversions",void 0),(0,o._)([(0,l.p)("conversions")],$.prototype,"castConversions",null),(0,o._)([(0,r.Cb)({type:b.Z})],$.prototype,"currentLocation",null),(0,o._)([(0,r.Cb)({type:u.Z.ofType(w.Z)})],$.prototype,"formats",void 0),(0,o._)([(0,r.Cb)()],$.prototype,"messages",void 0),(0,o._)([(0,r.Cb)()],$.prototype,"mode",null),(0,o._)([(0,r.Cb)()],$.prototype,"filteredFormats",void 0),(0,o._)([(0,r.Cb)({readOnly:!0})],$.prototype,"state",null),(0,o._)([(0,r.Cb)({types:_.jY})],$.prototype,"locationSymbol",void 0),(0,o._)([(0,r.Cb)({readOnly:!0,dependsOn:["storageType"]})],$.prototype,"storage",null),(0,o._)([(0,r.Cb)()],$.prototype,"storageEnabled",void 0),(0,o._)([(0,r.Cb)()],$.prototype,"storageType",void 0),(0,o._)([(0,r.Cb)({readOnly:!0})],$.prototype,"waitingForConversions",null),(0,o._)([(0,r.Cb)()],$.prototype,"view",void 0),$=(0,o._)([(0,a.j)("esri.widgets.CoordinateConversion.CoordinateConversionViewModel")],$);const B=$;var G=i(84644),V=i(46512),z=i(79691),j=i(34171),H=i(80079),U=i(24225),W=i(23039),Y=i(68808);const q="esri-coordinate-conversion",J={base:q,captureMode:`${q}--capture-mode`,noBasemap:`${q}--no-basemap`,popup:`${q}__popup`,clipboardPopup:`${q}__clipboard-popup`,conversionList:`${q}__conversion-list`,conversionRow:`${q}__row`,coordDisplay:`${q}__display`,expandButton:`${q}__expand-button`,expanded:`${q}__conversions-view--expanded`,expandDown:`${q}__conversions-view--expand-down`,expandUp:`${q}__conversions-view--expand-up`,conversionsView:`${q}__conversions-view`,rowSelect:`${q}__select-row`,toolDisplay:`${q}__tools`,modeToggle:`${q}__mode-toggle`,rowButton:`${q}__row-button`,coordinateInput:`${q}__input-coordinate`,inputForm:`${q}__input-form`,inputFormGroup:`${q}__input-group`,inputSelect:`${q}__input-select`,sectionHeading:`${q}__heading`,patternInput:`${q}__pattern-input`,settings:`${q}__settings`,settingsFormGroup:`${q}__settings-group`,settingsFormGroupHorizontal:`${q}__settings-group-horizontal`,previewCoordinate:`${q}__preview-coordinate`},X={settingsButton:!0,inputButton:!0,captureButton:!0,expandButton:!0};let K=class extends d.Z{constructor(e,t){super(e,t),this._popupMessage=null,this._popupTimeoutId=void 0,this._clipboardPopupTimeoutId=void 0,this._coordinateInput=null,this._badInput=!1,this._goToEnabled=!1,this._conversionFormat=null,this._settingsFormat=null,this._previewConversion=null,this._expanded=!1,this._clipboardPopupVisible=!1,this._popupVisible=!1,this._settingsVisible=!1,this._inputVisible=!1,this.headingLevel=4,this.messages=null,this.messagesCommon=null,this.orientation="auto",this.viewModel=new B,this.visibleElements={...X}}loadDependencies(){return(0,G.h)({button:()=>Promise.all([i.e(58268),i.e(55001),i.e(17345),i.e(61637)]).then(i.bind(i,61637)),checkbox:()=>Promise.all([i.e(58268),i.e(17345),i.e(69397)]).then(i.bind(i,69397)),input:()=>Promise.all([i.e(58268),i.e(17345),i.e(26041),i.e(75014),i.e(68355)]).then(i.bind(i,75014)),label:()=>Promise.all([i.e(58268),i.e(36650)]).then(i.bind(i,36650)),option:()=>i.e(26344).then(i.bind(i,26344)),select:()=>Promise.all([i.e(58268),i.e(17345),i.e(44015)]).then(i.bind(i,44015))})}get conversions(){return this.viewModel.conversions}set conversions(e){this.viewModel.conversions=e}get currentLocation(){return this.viewModel.currentLocation}set currentLocation(e){this.viewModel.currentLocation=e}get formats(){return this.viewModel.formats}set formats(e){this.viewModel.formats=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return"coordinate-system"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get mode(){return this.viewModel.mode}set mode(e){this.viewModel.mode=e}set multipleConversions(e){!1===e&&(this._expanded=!1,this.conversions.splice(1,this.conversions.length-1)),this._set("multipleConversions",e)}get multipleConversions(){const e=this._get("multipleConversions");return"boolean"!=typeof e||e}get locationSymbol(){return this.viewModel.locationSymbol}set locationSymbol(e){this.viewModel.locationSymbol=e}get storageEnabled(){return this.viewModel.storageEnabled}set storageEnabled(e){this.viewModel.storageEnabled=e}get storageType(){return this.viewModel.storageType}set storageType(e){this.viewModel.storageType=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return{...X,...e}}reverseConvert(e,t){return this.viewModel.reverseConvert(e,t)}render(){const e=this.viewModel?.state,t="disabled"===e?(0,W.u)("div",{key:"esri-coordinate__no-basemap"},this.messages?.noBasemap):null,i=!t&&this._inputVisible?this._renderInputForm():null,o=!t&&this._settingsVisible?this._renderSettings():null,n=t||i||o?null:this._renderConversionsView(),s=this._popupVisible?this._renderPopup():null,r={[J.captureMode]:"capture"===this.mode,[V.z.disabled]:"loading"===e,[J.noBasemap]:"disabled"===e};return(0,W.u)("div",{class:this.classes(J.base,V.z.widget,r)},s,t,n,o,i)}_addConversion(e){const t=e.target,i=t.selectedOption.value,o=ee(t);if(null==i||null==o)return;const n=new T({format:i});t.value="default",o>=0?(this.conversions.removeAt(o),this.conversions.add(n,o)):this.conversions.add(n)}_findSettingsFormat(){return this._settingsFormat||this.conversions.reduceRight(((e,t)=>{const i=t.format;return i?.hasDisplayProperties?i:e}),null)||this.formats.find((e=>e.hasDisplayProperties))}_hidePopup(){this._popupTimeoutId&&(clearTimeout(this._popupTimeoutId),this._popupTimeoutId=void 0),this._popupVisible=!1,this._popupMessage=null,this.scheduleRender()}_hideClipboardPopup(){this._clipboardPopupTimeoutId&&(clearTimeout(this._clipboardPopupTimeoutId),this._clipboardPopupTimeoutId=void 0),this._clipboardPopupVisible=!1,this.scheduleRender()}_onConvertComplete(){this._inputVisible=!1,this._coordinateInput.value=""}_onCopy(e){const t=function(e){return e["data-conversion"]}(e.currentTarget)?.displayCoordinate;null!=t&&(e.clipboardData?.setData("text/plain",t),this._showClipboardPopup(),e.preventDefault())}_processUserInput(e){const t=(0,s.aF)(e,"key"),i=this.viewModel;if("Enter"!==t&&t)this._badInput&&(this._badInput=!1);else{const e=this._conversionFormat||this.conversions.at(0).format;if(!e)return;const t=this._coordinateInput.value;this._reverseConvert(t,e).then((e=>{"capture"===this.mode?i.resume():this.mode="capture",this.currentLocation=e,i.setLocation(e),this._onConvertComplete()})).catch((e=>{n.Z.getLogger(this).error(e),this._showPopup(this.messages?.invalidCoordinate),this._badInput=!0}))}}async _reverseConvert(e,t){const i=this.viewModel,o=await t.reverseConvert(e);return this._goToEnabled&&o&&i.goToLocation(o).catch((e=>{n.Z.getLogger(this).warn(e),this._showPopup(this.messages?.locationOffBasemap)})),o}_setInputFormat(e){const t=e.target.selectedOption.value;null!=t&&(this._conversionFormat=t)}_setPreviewConversion(){const e=this._findSettingsFormat(),t=this.viewModel;if(e){const i=this.conversions.find((t=>t.format===e));this._previewConversion=new T({format:e,position:{location:this.currentLocation,coordinate:i?.position?.coordinate}}),this._previewConversion.position?.coordinate||t.previewConversion(this._previewConversion)}}_setSettingsFormat(e){const t=e.target.selectedOption.value;null!=t&&(this._settingsFormat=t,this._setPreviewConversion())}_showClipboardPopup(){this._clipboardPopupVisible?clearTimeout(this._clipboardPopupTimeoutId):this._clipboardPopupVisible=!0,this.scheduleRender(),this._popupTimeoutId=setTimeout((()=>{this._popupTimeoutId=void 0,this._hideClipboardPopup()}),750)}_showPopup(e,t=2500){this._popupMessage=e,this._popupVisible?clearTimeout(this._popupTimeoutId):this._popupVisible=!0,this.scheduleRender(),this._popupTimeoutId=setTimeout((()=>{this._popupTimeoutId=void 0,this._hidePopup()}),t)}_toggleGoTo(){this._goToEnabled=!this._goToEnabled}_updateCurrentPattern(e){e.stopPropagation();const t=e.target,i=this._findSettingsFormat();i&&(i.currentPattern=t.value)}_renderConversion(e,t){const{messages:i}=this;if(!i)return(0,W.u)("li",null);const{format:o}=e,n=o?.label??"",s=`${this.id}__list-item-${t}`,r=`${n} ${i.conversionOutputSuffix}`,l=0===t,a=l||this._expanded,d=l?this._renderFirstConversion(e):this._renderTools(t,e,s),c=l&&!e.displayCoordinate?i.noLocation:e.displayCoordinate,p=(0,W.u)("div",{"aria-label":c,class:J.coordDisplay,"data-conversion":e,role:"listitem",tabIndex:0,title:c??""},c),u=this._renderOptions(this.formats.filter((e=>e!==o)));return a?(0,W.u)("li",{"aria-label":r,class:J.conversionRow,id:s,key:e,role:"group",tabIndex:0,title:r},(0,W.u)("calcite-select",{"aria-controls":s,bind:this,class:J.rowSelect,"data-index":t,label:i.selectFormat,scale:"s",onCalciteSelectChange:this._addConversion},(0,W.u)("calcite-option",{label:n.toUpperCase(),selected:!0},n.toUpperCase()),u),p,d):null}_renderCopyButton(e){const t=this._clipboardPopupVisible&&this._renderClipboardPopup(),{messagesCommon:i}=this;return i?(0,W.u)("li",{"aria-label":i.copy,bind:this,class:this.classes(V.z.widgetButton,J.rowButton),"data-conversion":e,onclick:this._copyCoordinateOutput,oncopy:this._onCopy,onkeydown:this._copyCoordinateOutput,role:"button",tabIndex:0,title:i.copy},t,(0,W.u)("span",{"aria-hidden":"true",class:j.W.duplicate})):(0,W.u)("li",null)}_renderFirstConversion(e){const t=this.id,{messages:i,messagesCommon:o,multipleConversions:n,visibleElements:s}=this;if(!o||!i)return(0,W.u)("ul",null);const r="live"===this.mode?i.captureMode:i.liveMode,l=this._expanded?o.collapse:o.expand,a=e.displayCoordinate&&"capture"===this.mode?this._renderCopyButton(e):null,d=n&&s.expandButton&&this._renderIconButton({iconType:this._expanded?"chevron-down":"chevron-up",clickFunction:this._toggleExpand,classes:[J.expandButton],attributes:{"aria-controls":`${t}__${J.conversionList}`,label:l}}),c=!n&&s.captureButton&&this._renderIconButton({iconType:"live"===this.mode?"pin-tear":"pin-tear-f",clickFunction:this._toggleMode,classes:[J.modeToggle],attributes:{label:r}});return(0,W.u)("ul",{class:J.toolDisplay},a,d,c)}_renderInputForm(){const e=this._conversionFormat||this.conversions.at(0).format,t=this.formats.findIndex((t=>t.name===e?.name)),i=this.id,o=`${i}__${J.coordinateInput}`,n=`${i}__${J.coordinateInput}__header`,s=this._renderOptions(this.formats,!0,t),{messages:r,messagesCommon:l,headingLevel:a}=this;if(!l||!r)return(0,W.u)("div",null);const d=this._renderIconButton({iconType:(0,Y.dZ)(this.container)?"arrow-right":"arrow-left",clickFunction:this._toggleInputVisibility,attributes:{label:l.back}});return(0,W.u)("div",{"aria-labelledby":n,class:J.inputForm,key:"esri-coordinate-conversion__input-form",role:"search"},(0,W.u)("div",{class:J.sectionHeading},d,(0,W.u)(z.X,{class:V.z.heading,id:n,level:a},r.inputCoordTitle)),(0,W.u)("div",{class:J.inputFormGroup},(0,W.u)("calcite-select",{"aria-controls":o,bind:this,class:J.inputSelect,label:r.selectFormat,scale:"s",onCalciteSelectChange:this._setInputFormat},s),(0,W.u)("calcite-input",{afterCreate:Y.Yo,"aria-labelledby":n,bind:this,class:J.coordinateInput,"data-format":e,"data-node-ref":"_coordinateInput",id:o,onkeydown:this._processUserInput,placeholder:r.inputCoordTitle,required:!0,scale:"s",spellcheck:!1,status:this._badInput?"invalid":"idle"})),(0,W.u)("div",{class:J.inputFormGroup},(0,W.u)("calcite-label",{layout:"inline",scale:"s"},(0,W.u)("calcite-checkbox",{bind:this,checked:this._goToEnabled,onCalciteCheckboxChange:this._toggleGoTo}),r.goTo),(0,W.u)("calcite-button",{appearance:"outline",bind:this,kind:"neutral",onclick:this._processUserInput,type:"button",width:"auto"},r.convert)))}_renderConversionsView(){const{messages:e}=this;if(!e)return(0,W.u)("div",null);const t=`${this.id}__${J.conversionList}`,i=this._renderPrimaryTools(),o=this._renderOptions(this.formats),n=this.conversions.map(((e,t)=>this._renderConversion(e,t))).toArray(),s=this._expanded?(0,W.u)("div",{class:J.conversionRow},(0,W.u)("calcite-select",{"aria-controls":t,bind:this,"data-index":-1,label:e.addConversion,scale:"s",onCalciteSelectChange:this._addConversion},(0,W.u)("calcite-option",{disabled:!0,selected:!0,value:"default"},e.addConversion),o),i):null,r={[J.expanded]:this._expanded,[J.expandUp]:"expand-up"===this.orientation,[J.expandDown]:"expand-down"===this.orientation};return(0,W.u)("div",{class:this.classes(J.conversionsView,r),key:"esri-coordinate-conversion__main-view"},(0,W.u)("ul",{"aria-expanded":this._expanded?"true":"false",class:J.conversionList,id:t},n),s)}_renderOptions(e,t,i){const o=this.conversions.at(0),n=o.format?.name;return e.map(((e,s)=>{const r=!(t||!o)&&(n===e.name||this.conversions.map((e=>e.format?.name)).includes(e.name));return(0,W.u)("calcite-option",{disabled:r,key:e.name??"unnamed-format",label:e.label.toUpperCase(),selected:s===i,value:e},e.label)})).toArray()}_renderPopup(){return(0,W.u)("div",{class:J.popup,role:"alert"},this._popupMessage)}_renderClipboardPopup(){const{messages:e}=this;return e?(0,W.u)("div",{class:this.classes(J.popup,J.clipboardPopup),role:"alert"},e.copySuccessMessage):(0,W.u)("div",null)}_renderPrimaryTools(){const{messages:e,visibleElements:t}=this;if(!e)return(0,W.u)("ul",null);const i="live"===this.mode?e.captureMode:e.liveMode,o=t.inputButton&&this._renderIconButton({iconType:"pencil",clickFunction:this._toggleInputVisibility,attributes:{label:e.inputCoordTitle}}),n=t.captureButton&&this._renderIconButton({iconType:"live"===this.mode?"pin-tear":"pin-tear-f",clickFunction:this._toggleMode,classes:[J.modeToggle],attributes:{label:i}}),s=t.settingsButton&&this._renderIconButton({iconType:"gear",clickFunction:this._toggleSettingsVisibility,attributes:{label:e.settingsTitle}});return(0,W.u)("ul",{class:J.toolDisplay},o,n,s)}_renderSettings(){const e=this.id,t=`${e}__${J.patternInput}`,i=`${e}__${J.patternInput}__header`,o=`${e}__${J.previewCoordinate}`,n=this.formats.filter((e=>e.hasDisplayProperties)),s=this._findSettingsFormat(),r=s?n.indexOf(s):-1,l=this._renderOptions(n,!0,r),a=s?.currentPattern,{messages:d,messagesCommon:c,headingLevel:p}=this;if(!c||!d)return(0,W.u)("div",null);const u=this._renderIconButton({iconType:(0,Y.dZ)(this.container)?"arrow-right":"arrow-left",clickFunction:this._toggleSettingsVisibility,attributes:{label:c.back}}),h=this._renderIconButton({iconType:"reset",clickFunction:this._setDefaultPattern,attributes:{label:d.defaultPattern}});return(0,W.u)("div",{"aria-labelledby":i,class:J.settings,key:J.settings},(0,W.u)("div",{class:J.sectionHeading},u,(0,W.u)(z.X,{class:V.z.heading,id:i,level:p},d.settingsTitle)),(0,W.u)("div",{class:J.settingsFormGroup},(0,W.u)("label",{for:t},d.changeCoordinateDisplay),(0,W.u)("calcite-select",{bind:this,label:d.selectFormat,width:"full",onCalciteSelectChange:this._setSettingsFormat},l),(0,W.u)("div",{class:J.settingsFormGroupHorizontal},(0,W.u)("calcite-input",{"aria-controls":o,bind:this,class:J.patternInput,id:t,spellcheck:!1,type:"text",value:a,onCalciteInputInput:this._updateCurrentPattern}),h)),(0,W.u)("div",{class:J.settingsFormGroup},(0,W.u)("label",null,c.preview,(0,W.u)("div",{class:J.previewCoordinate,id:o,tabIndex:0},this._previewConversion?.displayCoordinate))))}_renderIconButton(e){const{iconType:t,clickFunction:i,classes:o,attributes:n}=e;return(0,W.u)("calcite-button",{appearance:"transparent",bind:this,class:this.classes(o),iconStart:t,kind:"neutral",onclick:i,onkeydown:i,...n})}_renderTools(e,t,i){const o=t.displayCoordinate&&"capture"===this.mode?this._renderCopyButton(t):null,{messages:n}=this;if(!n)return(0,W.u)("ul",null);const s=this._renderIconButton({iconType:"x",clickFunction:this._removeConversion,attributes:{"aria-controls":i,label:n.removeConversion,"data-index":e}});return(0,W.u)("ul",{class:J.toolDisplay,role:"listitem"},o,(0,W.u)("li",{class:this.classes(J.rowButton)},s))}_copyCoordinateOutput(e){const t=e.target;if(!("createTextRange"in document.body)){const e=window.getSelection(),i=document.createRange();i.selectNodeContents(t),e?.removeAllRanges(),e?.addRange(i)}document.execCommand("copy")}_removeConversion(e){const t=ee(e.currentTarget);null!=t&&this.conversions.removeAt(t)}_setDefaultPattern(e){e.stopPropagation();const t=this._findSettingsFormat();t&&(t.currentPattern=t.defaultPattern)}_toggleExpand(){this._expanded=!this._expanded}_toggleInputVisibility(){this._inputVisible=!this._inputVisible,this._popupVisible&&this._hidePopup(),this._inputVisible?this.viewModel.pause():this.viewModel.resume()}_toggleMode(){this.mode="live"===this.mode?"capture":"live"}_toggleSettingsVisibility(){this._settingsVisible=!this._settingsVisible,this._popupVisible&&this._hidePopup(),this._settingsVisible?(this._setPreviewConversion(),this.viewModel.pause()):this.viewModel.resume()}};(0,o._)([(0,r.Cb)()],K.prototype,"conversions",null),(0,o._)([(0,r.Cb)()],K.prototype,"currentLocation",null),(0,o._)([(0,r.Cb)()],K.prototype,"formats",null),(0,o._)([(0,r.Cb)()],K.prototype,"goToOverride",null),(0,o._)([(0,r.Cb)()],K.prototype,"headingLevel",void 0),(0,o._)([(0,r.Cb)()],K.prototype,"icon",null),(0,o._)([(0,r.Cb)()],K.prototype,"label",null),(0,o._)([(0,r.Cb)(),(0,U.H)("esri/widgets/CoordinateConversion/t9n/CoordinateConversion")],K.prototype,"messages",void 0),(0,o._)([(0,r.Cb)(),(0,U.H)("esri/t9n/common")],K.prototype,"messagesCommon",void 0),(0,o._)([(0,r.Cb)()],K.prototype,"mode",null),(0,o._)([(0,r.Cb)()],K.prototype,"orientation",void 0),(0,o._)([(0,r.Cb)()],K.prototype,"multipleConversions",null),(0,o._)([(0,r.Cb)()],K.prototype,"locationSymbol",null),(0,o._)([(0,r.Cb)()],K.prototype,"storageEnabled",null),(0,o._)([(0,r.Cb)()],K.prototype,"storageType",null),(0,o._)([(0,r.Cb)()],K.prototype,"view",null),(0,o._)([(0,r.Cb)({type:B})],K.prototype,"viewModel",void 0),(0,o._)([(0,r.Cb)()],K.prototype,"visibleElements",void 0),(0,o._)([(0,l.p)("visibleElements")],K.prototype,"castVisibleElements",null),(0,o._)([(0,H.h)()],K.prototype,"_copyCoordinateOutput",null),(0,o._)([(0,H.h)()],K.prototype,"_removeConversion",null),(0,o._)([(0,H.h)()],K.prototype,"_setDefaultPattern",null),(0,o._)([(0,H.h)()],K.prototype,"_toggleExpand",null),(0,o._)([(0,H.h)()],K.prototype,"_toggleInputVisibility",null),(0,o._)([(0,H.h)()],K.prototype,"_toggleMode",null),(0,o._)([(0,H.h)()],K.prototype,"_toggleSettingsVisibility",null),K=(0,o._)([(0,a.j)("esri.widgets.CoordinateConversion")],K);const Q=K;function ee(e){return e["data-index"]}},82344:function(e,t,i){i.d(t,{Z:function(){return y}});var o=i(73440),n=i(70880),s=i(88194),r=(i(61432),i(17155)),l=(i(96711),i(83850),i(48023)),a=i(17256),d=i(13132),c=i(45213),p=i(8554),u=i(97290),h=i(1985);let g=class extends n.Z{constructor(e){super(e),this.conversionInfo=null,this.coordinateSegments=null,this._currentPattern=void 0,this.defaultPattern=null,this.name=null,this.viewModel=null}get currentPattern(){return(this._currentPattern||this.defaultPattern)??""}set currentPattern(e){this._currentPattern=e}get label(){return this.name??""}set label(e){this._overrideIfSome("label",e)}get hasDisplayProperties(){return!(!this.defaultPattern||!this.coordinateSegments)}get spatialReference(){return"basemap"===this.name?this._viewSpatialReference:this.conversionInfo?.spatialReference??c.Z.WGS84}set spatialReference(e){this._overrideIfSome("spatialReference",e)}get _viewSpatialReference(){return this.viewModel?.view?.spatialReference??c.Z.WGS84}get _additionalCharactersPattern(){const e=this.coordinateSegments;if(!e)return null;const t=e.map((e=>e.alias)),i=this.currentPattern.replaceAll(new RegExp(`["nsew${t.join()}]`,"gi"),"").replaceAll(" ","");return new RegExp(`[${i}]`,"g")}get test(){}async convert(e){if(!(0,h.J$)(e))throw new s.Z("format:invalid-point","Could not convert invalid point.",{point:e});const t=this.conversionInfo?.convert;if(t)return Promise.resolve().then((()=>t(e)));const i=await this._project(e,this.spatialReference);return{location:i,coordinate:await this._getCoordinate(i)}}getConversionStrategy(){const e=this._viewSpatialReference;return this.conversionInfo?.convert||this.viewModel?.formatterAvailable||"xy"===this.name&&(e.isWebMercator||e.isWGS84)||"basemap"===this.name?"client":"server"}getDisplayCoordinate(e){if(!e)return null;if(!this.coordinateSegments||!this.currentPattern)return e;let t=this.currentPattern;const i=this._getSegmentMatches(e,!1);for(let e=this.coordinateSegments.length-1;e>=0;e--){const o=this.coordinateSegments[e];t=t.replace(o.alias,i[e])}return t}_parseUserInput(e){const{defaultPattern:t,_additionalCharactersPattern:i,coordinateSegments:o}=this;if(!t||!i)return"";let n=t.replace(i,"");e=e.replace(i,"");const s=this._getSegmentMatches(e,!0);if(o)for(let e=o.length-1;e>=0;e--){const t=o[e];n=n.replace(t.alias,s[e])}return n}_getSegmentMatches(e,t){const i=new Array,{coordinateSegments:o}=this;if(!o)return i;for(let n=0;n<o.length;n++){const s=o[n],r=e.match(s.searchPattern);if(!r){i.push("");continue}let l=r[0];if(e=e.replace(l,"").trim(),s.substitution){const e=t?s.substitution.input(l):s.substitution.output(l);e&&(l=`${e}`)}i.push(l)}return i}async reverseConvert(e){const t=this._parseUserInput(e),i=this.conversionInfo?.reverseConvert;let o;if(i)o=i(t);else if("xy"===this.name||"basemap"===this.name)o=(0,h.mv)(t,this.spatialReference);else if(this.viewModel?.formatterAvailable)switch(this.name){case"dd":case"ddm":case"dms":o=(0,a.QU)(t,this.spatialReference);break;case"mgrs":{const e="automatic";o=(0,a.BZ)(t,this.spatialReference,e);break}case"utm":{const e="latitude-band-indicators";o=(0,a.DR)(t,this.spatialReference,e);break}case"usng":o=(0,a.cZ)(t,this.spatialReference);break;default:o=null}if(!o)throw new s.Z("format:invalid-input","Could not parse input into point.",{userInput:e});return this._project(o,this._viewSpatialReference)}async _getCoordinate(e){const t=this.viewModel?.view?.scale??0;if(!(0,h.J$)(e))throw new s.Z("format:invalid-point","Could not transform invalid point into coordinate.",{point:e});if(this.viewModel?.formatterAvailable||"basemap"===this.name||"xy"===this.name)switch(this.name){case"dd":case"ddm":case"dms":{const i=(0,h.GG)(t);return(0,a.Ow)(e,this.name,i)}case"mgrs":return(0,a.$B)(e,"automatic",5,!1);case"usng":return(0,a.on)(e,5,!1);case"utm":return(0,a.$i)(e,"latitude-band-indicators",!0);default:return(0,h.zq)(e,t)}return(0,h.zq)(e,t)}async _project(e,t){if((0,p.fS)(e.spatialReference,t)||!t)return e;if(this.viewModel?.formatterAvailable&&(0,d.isLoaded)())return(0,d.project)(e,t);if(!this.viewModel?.formatterAvailable){const i=(0,u.iV)(e,t);if(null!=i)return i}return null}};(0,o._)([(0,r.Cb)()],g.prototype,"conversionInfo",void 0),(0,o._)([(0,r.Cb)()],g.prototype,"coordinateSegments",void 0),(0,o._)([(0,r.Cb)()],g.prototype,"currentPattern",null),(0,o._)([(0,r.Cb)()],g.prototype,"_currentPattern",void 0),(0,o._)([(0,r.Cb)()],g.prototype,"label",null),(0,o._)([(0,r.Cb)()],g.prototype,"defaultPattern",void 0),(0,o._)([(0,r.Cb)({readOnly:!0})],g.prototype,"hasDisplayProperties",null),(0,o._)([(0,r.Cb)()],g.prototype,"name",void 0),(0,o._)([(0,r.Cb)({type:c.Z})],g.prototype,"spatialReference",null),(0,o._)([(0,r.Cb)()],g.prototype,"viewModel",void 0),(0,o._)([(0,r.Cb)({readOnly:!0})],g.prototype,"_viewSpatialReference",null),(0,o._)([(0,r.Cb)({readOnly:!0})],g.prototype,"_additionalCharactersPattern",null),g=(0,o._)([(0,l.j)("esri.widgets.CoordinateConversion.support.Format")],g);const y=g},1985:function(e,t,i){i.d(t,{GG:function(){return r},J$:function(){return d},hf:function(){return u},mv:function(){return l},zq:function(){return c}});var o=i(60508),n=i(45213);function s(e,t){const i=r(t);return[e[0].toFixed(i),e[1].toFixed(i)]}function r(e){return e>=500?6:e<500&&e>=50?7:e<50&&e>=5?8:9}function l(e,t){const i=e.includes(",")?",":" ",[s,r,l]=e.split(i).map((e=>{const t=e.trim();return t?Number(t):null}));if(!a(s)||!a(r))return null;const d=new o.Z({x:s,y:r,spatialReference:t||n.Z.WGS84});return l&&(d.z=l,d.hasZ=!0),d}function a(e){return"number"==typeof e&&isFinite(e)}function d(e){return!!e&&a(e.x)&&a(e.y)}function c(e,t){if(e.spatialReference.isGeographic&&t){const[i,o]=s([e.x,e.y],t);return`${i}, ${o}`}return`${e.x.toFixed(3)}, ${e.y.toFixed(3)}`}const p=["dd","dms","ddm","mgrs","usng","utm"];function u(e){return p.includes(e)}},86225:function(e,t,i){i.d(t,{A4:function(){return a},CO:function(){return u},ke:function(){return p}});var o=i(87864),n=i(74765),s=i(82344);const r=(0,o.ti)().decimal,l={N:"north",S:"south",E:"east",W:"west"},a="°‎",d=new RegExp(`-?\\d+[\\.|\\${r}]?\\d*`),c=/^[\\0]+(?=\d)/;function p(e,t){const i="ar"===(0,n.Kd)(),s=e.abbreviatedDirections.north,r=e.abbreviatedDirections.south,d=e.abbreviatedDirections.east,c=e.abbreviatedDirections.west,p=(0,o.ti)().decimal,u={[s]:"N",[r]:"S",[d]:"E",[c]:"W"},y=new RegExp(`-?\\d+[\\.|\\${p}]?\\d*`),b=new RegExp(`N|S|${s}|${r}`,"i"),m=new RegExp(`E|W|${d}|${c}`,"i"),v={ddm:`Y${a} A'${e.abbreviatedDirections.north}, X${a} B'${e.abbreviatedDirections.east}`,dms:`Y${a} A' B"${e.abbreviatedDirections.north}, X${a} C' D"${e.abbreviatedDirections.east}`,dd:`Y${a}${e.abbreviatedDirections.north}, X${a}${e.abbreviatedDirections.east}`,xy:`X${a}, Y${a}`,basemap:"X, Y"},_={ddm:`${e.abbreviatedDirections.north}${a}Y 'A ,${e.abbreviatedDirections.east}${a}X 'B`,dms:`${e.abbreviatedDirections.north}${a}Y 'A "B ,${e.abbreviatedDirections.east}${a}X 'C "D`,dd:`${e.abbreviatedDirections.north}${a}Y ,${e.abbreviatedDirections.east}${a}X`,xy:`X${a} ,Y${a}`,basemap:"X ,Y"},f=new RegExp(`\\d{1,2}[\\.|\\${p}]?\\d*`,"i"),w=new RegExp(`\\d{1,3}[\\.|\\${p}]?\\d*`,"i");t.forEach((t=>{const{name:o}=t;if("dd"===o?t.coordinateSegments=[{alias:"Y",description:"degrees latitude",searchPattern:f,substitution:{input:e=>g(e),output:e=>h(e)}},{alias:e.abbreviatedDirections.north,description:"north/south indicator",searchPattern:b,substitution:{input:e=>u[e],output:t=>e.abbreviatedDirections[l[t]]}},{alias:"X",description:"degrees longitude",searchPattern:w,substitution:{input:e=>g(e),output:e=>h(e)}},{alias:e.abbreviatedDirections.east,description:"east/west indicator",searchPattern:m,substitution:{input:e=>u[e],output:t=>e.abbreviatedDirections[l[t]]}}]:"ddm"===o?t.coordinateSegments=[{alias:"Y",description:"degrees latitude",searchPattern:f,substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"A",description:"minutes latitude",searchPattern:f,substitution:{input:e=>g(e),output:e=>h(e)}},{alias:e.abbreviatedDirections.north,description:"north/south indicator",searchPattern:b,substitution:{input:e=>u[e],output:t=>e.abbreviatedDirections[l[t]]}},{alias:"X",description:"degrees longitude",searchPattern:w,substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"B",description:"minutes longitude",searchPattern:f,substitution:{input:e=>g(e),output:e=>h(e)}},{alias:e.abbreviatedDirections.east,description:"east/west indicator",searchPattern:m,substitution:{input:e=>u[e],output:t=>e.abbreviatedDirections[l[t]]}}]:"dms"===o?t.coordinateSegments=[{alias:"Y",description:"degrees latitude",searchPattern:f,substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"A",description:"minutes latitude",searchPattern:f,substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"B",description:"seconds latitude",searchPattern:f,substitution:{input:e=>g(e),output:e=>h(e)}},{alias:e.abbreviatedDirections.north,description:"north/south indicator",searchPattern:b,substitution:{input:e=>u[e],output:t=>e.abbreviatedDirections[l[t]]}},{alias:"X",description:"degrees longitude",searchPattern:w,substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"C",description:"minutes longitude",searchPattern:f,substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"D",description:"seconds longitude",searchPattern:f,substitution:{input:e=>g(e),output:e=>h(e)}},{alias:e.abbreviatedDirections.east,description:"east/west indicator",searchPattern:m,substitution:{input:e=>u[e],output:t=>e.abbreviatedDirections[l[t]]}}]:("xy"===t.name||"basemap"===t.name)&&(t.coordinateSegments=[{alias:"X",description:"easting",searchPattern:y,substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"Y",description:"northing",searchPattern:y,substitution:{input:e=>g(e),output:e=>h(e)}}]),(e=>null!=e&&Object.keys(v).includes(e))(o)){const e=i?_[o]:v[o];t.defaultPattern=e,t.currentPattern=e}}))}function u(){const e=new RegExp("N|S","i"),t=new RegExp("E|W","i");return[new s.Z({name:"basemap",coordinateSegments:[{alias:"X",description:"easting",searchPattern:d,substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"Y",description:"northing",searchPattern:d,substitution:{input:e=>g(e),output:e=>h(e)}}],defaultPattern:"X, Y",viewModel:null}),new s.Z({name:"dd",coordinateSegments:[{alias:"Y",description:"degrees latitude",searchPattern:new RegExp(`\\d{1,2}[\\.|\\${r}]?\\d*(?=\\D*?[N|S])`,"i"),substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"N",description:"north/south indicator",searchPattern:e},{alias:"X",description:"degrees longitude",searchPattern:new RegExp(`\\d{1,3}[\\.|\\${r}]?\\d*(?=\\D*?[E|W|])`,"i"),substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"E",description:"east/west indicator",searchPattern:t}],defaultPattern:`Y${a}N, X${a}E`,viewModel:null}),new s.Z({name:"ddm",coordinateSegments:[{alias:"Y",description:"degrees latitude",searchPattern:new RegExp("\\d{1,2}(?=.*?\\s+.*?[N|S])","i"),substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"A",description:"minutes latitude",searchPattern:new RegExp(`\\d{1,2}[\\.\\${r}]?\\d*(?=.*?[N|S])`,"i"),substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"N",description:"north/south indicator",searchPattern:e},{alias:"X",description:"degrees longitude",searchPattern:new RegExp("\\d{1,3}(?=\\D*?\\s+.*?[E|W])","i"),substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"B",description:"minutes longitude",searchPattern:new RegExp(`\\d{1,2}[\\.|\\|${r}]?\\d*(?=.*?[E|W])`,"i"),substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"E",description:"east/west indicator",searchPattern:t}],defaultPattern:`Y${a} A'N, X${a} B'E`,viewModel:null}),new s.Z({name:"dms",coordinateSegments:[{alias:"Y",description:"degrees latitude",searchPattern:new RegExp("\\d{1,2}(?=.*?\\s+.*?[N|S])","i"),substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"A",description:"minutes latitude",searchPattern:new RegExp("\\d{1,2}(?=.*?[N|S])","i"),substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"B",description:"seconds latitude",searchPattern:new RegExp(`\\d{1,2}[\\.|\\${r}]?\\d*(?=.*?[N|S])`,"i"),substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"N",description:"north/south indicator",searchPattern:e},{alias:"X",description:"degrees longitude",searchPattern:new RegExp("\\d{1,3}(?=.*?\\s+.*?[E|W])","i"),substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"C",description:"minutes longitude",searchPattern:new RegExp("\\d{1,2}(?=.*?[E|W])","i"),substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"D",description:"seconds longitude",searchPattern:new RegExp(`\\d{1,2}[\\.|\\${r}]?\\d*(?=.*?[E|W])`,"i"),substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"E",description:"east/west indicator",searchPattern:t}],defaultPattern:`Y${a} A' B"N, X${a} C' D"E`,viewModel:null}),new s.Z({name:"xy",coordinateSegments:[{alias:"X",description:"longitude",searchPattern:d,substitution:{input:e=>g(e),output:e=>h(e)}},{alias:"Y",description:"latitude",searchPattern:d,substitution:{input:e=>g(e),output:e=>h(e)}}],defaultPattern:`X${a}, Y${a}`,viewModel:null}),new s.Z({name:"mgrs",coordinateSegments:[{alias:"Z",description:"grid zone",searchPattern:/\d{1,2}\w|[abyz]/i},{alias:"S",description:"grid square",searchPattern:/\w{2}/},{alias:"X",description:"easting",searchPattern:/^\d{5}(?=.?\d{5}$)|^\d{4}(?=.?\d{4}$)|^\d{3}(?=.?\d{3}$)|^\d{2}(?=.?\d{2}$)|^\d(?=.?\d$)/},{alias:"Y",description:"northing",searchPattern:/^\d{1,5}/}],defaultPattern:"Z S X Y",viewModel:null}),new s.Z({name:"usng",coordinateSegments:[{alias:"Z",description:"grid zone",searchPattern:/\d{1,2}\w|[abyz]/i},{alias:"S",description:"grid square",searchPattern:/\w{2}/},{alias:"X",description:"easting",searchPattern:/^\d{5}(?=.?\d{5}$)|^\d{4}(?=.?\d{4}$)|^\d{3}(?=.?\d{3}$)|^\d{2}(?=.?\d{2}$)|^\d(?=.?\d$)/},{alias:"Y",description:"northing",searchPattern:/^\d{1,5}/}],defaultPattern:"Z S X Y",viewModel:null}),new s.Z({name:"utm",coordinateSegments:[{alias:"Z",description:"zone number",searchPattern:/\d{1,2}|[abyz]/i},{alias:"B",description:"latitude band",searchPattern:/^\D/},{alias:"X",description:"easting",searchPattern:/\d{1,7}(?=\s*\d{7}$)/},{alias:"Y",description:"northing",searchPattern:/\d{1,7}/}],defaultPattern:"ZB X Y",viewModel:null})]}function h(e){const t=e.match(c),i=t?t[0]:"",n=e.includes(".")?e.split(".")[1].length:0;return i+(0,o.WU)(Number(e),{pattern:"###0.###",places:n,round:-1})}function g(e){return(0,o.Qc)(e)}},94027:function(e,t,i){i.d(t,{Z:function(){return _}});var o=i(73440),n=i(43254),s=i(87833),r=i(90403),l=i(17155),a=(i(61432),i(96711),i(83850),i(48023));function d(e){return null!=e&&"object"==typeof e&&"2d"===e.type&&"linkchart"===e.view2dType}var c=i(48804),p=i(5221);const u="view",h="view-layers",g="map-layers",y="layer-views",b="layer-list-mode",m=n.Z.ofType(c.Z);let v=class extends s.Z.EventedAccessor{constructor(e){super(e),this.checkPublishStatusEnabled=!1,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.operationalItems=new m,this.view=null}initialize(){this.addHandles([(0,r.YP)((()=>!0===this.view?.ready),(()=>this._viewHandles()),r.nn),(0,r.YP)((()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled]),(()=>this._recompileList())),(0,r.YP)((()=>d(this.view)?this.view.inGeographicLayout:null),(()=>this._compileList()))],u)}destroy(){this._removeAllItems(),this.view=null}get state(){const{view:e}=this;return e?.ready?"ready":e?"loading":"disabled"}get totalItems(){return this.operationalItems.flatten((e=>e.children)).length}triggerAction(e,t){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:t})}moveListItem(e,t,i,o){const n=e?.layer;if(!n||"subtype-sublayer"===n.type||"sublayer"===n.type)return;const s=this.view?.map?.layers,r=t?(0,p.Hh)(t):s,l=i?(0,p.Hh)(i):s;if(!r||!l)return;const{operationalItems:a}=this,d=t?.children||a,c=i?.children||a,u=l.length-o;e.parent=i||null,d.remove(e),r.remove(n),c.includes(e)||c.add(e,u),l.includes(n)||l.add(n,u),this._compileList()}_createLayerViewHandles(e){this.removeHandles(y),this._compileList(),e&&this.addHandles(e.on("change",(()=>this._compileList())),y)}_createMapLayerHandles(e){this.removeHandles(g),this._compileList(),e&&this.addHandles(e.on("change",(()=>this._compileList())),g)}_createListItem(e){const{view:t,listItemCreatedFunction:i,checkPublishStatusEnabled:o,listModeDisabled:n}=this;return new c.Z({checkPublishStatusEnabled:o,listModeDisabled:n,layer:e,listItemCreatedFunction:i,view:t})}_removeAllItems(){this.operationalItems.destroyAll()}_getViewableLayers(e){return e?this.listModeDisabled?e:e.filter((e=>"hide"!==(0,p.aV)(e))):void 0}_watchLayersListMode(e){this.removeHandles(b),e&&!this.listModeDisabled&&this.addHandles((0,r.YP)((()=>e.filter((e=>"listMode"in e)).map((e=>e.listMode)).toArray()),(()=>this._compileList())),b)}_compileList(){const e=this.view?.map?.layers,t=d(this.view)&&!this.view.inGeographicLayout?e?.filter((({type:e})=>"link-chart"===e)):e;this._watchLayersListMode(t);const i=this._getViewableLayers(t);i?.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}_createNewItems(e){const{operationalItems:t}=this;e.forEach((e=>{t.some((t=>t.layer===e))||t.add(this._createListItem(e))}))}_removeItems(e){const{operationalItems:t}=this,i=[];t.forEach((t=>{t&&e&&e.includes(t.layer)||i.push(t)})),t.destroyMany(i)}_sortItems(e){const{operationalItems:t}=this;t.sort(((t,i)=>{const o=e.indexOf(t.layer),n=e.indexOf(i.layer);return o>n?-1:o<n?1:0}))}_recompileList(){this._removeAllItems(),this._compileList()}_viewHandles(){const{view:e}=this;this.removeHandles([g,y,h]),e?.ready?this.addHandles([(0,r.YP)((()=>this.view?.map?.allLayers),(e=>this._createMapLayerHandles(e)),r.nn),(0,r.YP)((()=>this.view?.allLayerViews),(e=>this._createLayerViewHandles(e)),r.nn)],h):this._removeAllItems()}};(0,o._)([(0,l.Cb)()],v.prototype,"checkPublishStatusEnabled",void 0),(0,o._)([(0,l.Cb)()],v.prototype,"listItemCreatedFunction",void 0),(0,o._)([(0,l.Cb)({nonNullable:!0})],v.prototype,"listModeDisabled",void 0),(0,o._)([(0,l.Cb)({type:m})],v.prototype,"operationalItems",void 0),(0,o._)([(0,l.Cb)({readOnly:!0})],v.prototype,"state",null),(0,o._)([(0,l.Cb)()],v.prototype,"totalItems",null),(0,o._)([(0,l.Cb)()],v.prototype,"view",void 0),v=(0,o._)([(0,a.j)("esri.widgets.LayerList.LayerListViewModel")],v);const _=v},48804:function(e,t,i){i.d(t,{Z:function(){return x}});var o=i(73440),n=i(70880),s=i(3480),r=i(43254),l=i(15894),a=i(90403),d=i(17155),c=i(90775),p=(i(61432),i(48023)),u=i(57947),h=i(72689),g=i(47711),y=i(60650),b=i(61100),m=(i(96711),i(83850),i(1803)),v=i(5221),_=i(60916),f=i(23039);let w=class extends(l.Z.IdentifiableMixin(m.Z)){constructor(e,t){super(e,t),this._legend=null,this.content=null,this.flowEnabled=!1,this.image=null,this.listItem=null,this.open=!1,this.visible=!0}initialize(){this.addHandles([(0,a.YP)((()=>this._canCreateLegend),(()=>this._createLegend()),a.nn),(0,a.YP)((()=>[this._legend,this._legendOptions]),(()=>this._updateLegend()),a.nn)])}destroy(){this._legend=(0,b.SC)(this._legend)}get _canCreateLegend(){const{content:e,listItem:t}=this;if(!t)return!1;const i="legend";return e===i||null!=e&&!!Array.isArray(e)&&e.includes(i)}get _legendOptions(){const{listItem:e,_legendLayerInfo:t}=this,i=e?.view;return t&&i?{view:i,layerInfos:[t]}:{}}get _legendLayerInfo(){const e=this.listItem?.layer;if(!e||"subtype-sublayer"===e.type)return null;const t=(0,v.Dz)(e)?e:null,i=e?.parent,o=null!=i&&"type"in i&&"map-image"===i.type?t?.source:null;return o&&i?{layer:i,title:"",sublayerIds:[o.mapLayerId]}:{layer:e,title:""}}get disabled(){const{listItem:e,_legend:t,content:i}=this;return!(e&&(Array.isArray(i)&&i.length>1||!t||t.activeLayerInfos?.length&&e.visibleAtCurrentScale&&e.visible))}set disabled(e){this._overrideIfSome("disabled",e)}get icon(){const{image:e}=this,t=this._getFirstWidget();return this._get("icon")??(!e&&t?t.icon:null)}set icon(e){this._overrideIfSome("icon",e)}get title(){return this._get("title")||(this._getFirstWidget()?.label??"")}set title(e){this._override("title",e)}render(){return(0,f.u)("div",{class:"esri-list-item-panel"},this._renderContents())}_renderContent(e){const{_legend:t,disabled:i,open:o}=this;return e&&!i&&o?"legend"===e&&t?(0,f.u)("div",{key:"legend-widget"},t.render()):"string"==typeof e?(0,f.u)("div",{innerHTML:e,key:e}):(0,_.Qd)(e)?(0,f.u)("div",{key:"content-widget"},e.render()):e instanceof HTMLElement?(0,f.u)("div",{afterCreate:this._attachToNode,bind:e,key:"content-element"}):null:null}_renderContents(){const{content:e,open:t}=this;return t?Array.isArray(e)?e.map((e=>this._renderContent(e))):this._renderContent(e):null}async _createLegend(){if((0,b.SC)(this._legend),this._legend=null,!this._canCreateLegend)return;const{default:e}=await Promise.all([i.e(80746),i.e(81880),i.e(6874),i.e(6923)]).then(i.bind(i,83861)),t=new e(this._legendOptions);this._legend=t}_attachToNode(e){e.appendChild(this)}_updateLegend(){const e=this._legend;e&&e.set(this._legendOptions)}_getWidget(e){return"legend"===e?this._legend:(0,_.Qd)(e)?e:null}_getFirstWidget(){const{content:e}=this;return Array.isArray(e)?e.map((e=>this._getWidget(e))).find((e=>e)):this._getWidget(e)}};(0,o._)([(0,d.Cb)()],w.prototype,"_legend",void 0),(0,o._)([(0,d.Cb)()],w.prototype,"_canCreateLegend",null),(0,o._)([(0,d.Cb)()],w.prototype,"_legendOptions",null),(0,o._)([(0,d.Cb)()],w.prototype,"_legendLayerInfo",null),(0,o._)([(0,d.Cb)()],w.prototype,"content",void 0),(0,o._)([(0,d.Cb)()],w.prototype,"disabled",null),(0,o._)([(0,d.Cb)()],w.prototype,"flowEnabled",void 0),(0,o._)([(0,d.Cb)()],w.prototype,"icon",null),(0,o._)([(0,d.Cb)()],w.prototype,"image",void 0),(0,o._)([(0,d.Cb)()],w.prototype,"listItem",void 0),(0,o._)([(0,d.Cb)()],w.prototype,"open",void 0),(0,o._)([(0,d.Cb)()],w.prototype,"title",null),(0,o._)([(0,d.Cb)()],w.prototype,"visible",void 0),w=(0,o._)([(0,p.j)("esri.widgets.LayerList.ListItemPanel")],w);const C=w;var T;const S=r.Z.ofType({key:"type",defaultKeyValue:"button",base:h.Z,typeMap:{button:g.Z,toggle:y.Z}}),M=r.Z.ofType(S),O="layer",E="child-list-mode";let P=T=class extends(l.Z.IdentifiableMixin(n.Z)){constructor(e){super(e),this.actionsSections=new M,this.actionsOpen=!1,this.checkPublishStatusEnabled=!1,this.children=new(r.Z.ofType(T)),this.childrenSortable=!0,this.hidden=!1,this.layer=null,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.open=!1,this.parent=null,this.view=null}initialize(){if(this.addHandles([(0,a.YP)((()=>[this.layer,this.layer?.listMode,this.listModeDisabled]),(()=>this._watchLayerProperties(this.layer)),a.nn),(0,a.YP)((()=>this.checkPublishStatusEnabled),(e=>this._updateChildrenPublishing(e)),a.nn),(0,a.YP)((()=>this.view),(e=>this._updateChildrenView(e)),a.nn),(0,a.YP)((()=>this.panel),(e=>this._setListItemOnPanel(e)),a.nn)]),"function"==typeof this.listItemCreatedFunction){const e={item:this};this.listItemCreatedFunction.call(null,e)}}destroy(){this.panel?.destroy(),this.children.destroyAll(),this.view=null}get connectionStatus(){const{layerView:e,publishing:t}=this;if(!t&&e&&"connectionStatus"in e)return e.connectionStatus}get error(){return this.layer?.loadError}get incompatible(){const{layerView:e}=this;return!(!e||!("spatialReferenceSupported"in e)||e.spatialReferenceSupported)}get layerView(){const{layer:e,view:t}=this;if(!e||!t||"sublayer"===e.type)return null;const i="subtype-sublayer"===e.type?e.parent:e;return t.allLayerViews.find((e=>e.layer===i))??null}set panel(e){const t=this._get("panel");e!==t&&e&&t?.destroy(),this._set("panel",e)}castPanel(e){return this.panel?.open&&!e.hasOwnProperty("open")&&(e.open=!0),e?new C(e):null}get sortable(){return"knowledge-graph-sublayer"!==this.layer?.type&&this._get("sortable")}set sortable(e){this._set("sortable",e)}get title(){const e=(0,u.U2)(this,"layer.layer");return(!e||e&&(0,u.U2)(this,"layer.layer.loaded"))&&(0,u.U2)(this,"layer.title")||(0,u.U2)(this,"layer.attributes.title")||""}set title(e){this._override("title",e)}get publishing(){const{layer:e,checkPublishStatusEnabled:t}=this;return!!(t&&e&&"publishingInfo"in e&&"publishing"===e.publishingInfo?.status)}get updating(){const{layerView:e,connectionStatus:t,layer:i,publishing:o}=this;return!o&&!t&&(e?e.updating:"loading"===i?.loadStatus||!1)}get visible(){return!!this.layer?.visible}set visible(e){const t=this.layer;t&&(t.visible=e)}get visibleAtCurrentScale(){return this.layerView?.visibleAtCurrentScale??!(0,v.zb)(this.layer,this.view?.scale)}get visibleAtCurrentTimeExtent(){return this.layerView?.visibleAtCurrentTimeExtent??!0}get visibilityMode(){return(0,v.sT)(this.layer)}clone(){return new T({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),childrenSortable:this.childrenSortable,hidden:this.hidden,layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,open:this.open,panel:this.panel,parent:this.parent,sortable:this.sortable,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(e){e&&(e.listItem=this)}_updateChildrenPublishing(e){this.children?.forEach((t=>t.checkPublishStatusEnabled=e))}_updateChildrenView(e){const t=this.children;t&&t.forEach((t=>t.view=e))}_createChildren(e){const{listModeDisabled:t,children:i}=this,o=e.filter((e=>!i.some((t=>t.layer===e))));i.addMany(this._createChildItems(o,t))}_destroyChildren(e){const{children:t}=this,i=t.filter((t=>!!t.layer&&!e.includes(t.layer)));t.destroyMany(i)}_sortChildren(e){this.children.sort(((t,i)=>e.indexOf(i.layer)-e.indexOf(t.layer)))}_destroyAllChildren(){this.removeHandles(E),this.children.destroyAll()}_watchChildLayerListMode(e){this.removeHandles(E),this.listModeDisabled||this.addHandles(e.toArray().map((t=>(0,a.YP)((()=>t.listMode),(()=>this._compileChildren(e))))),E)}_compileChildren(e){const t=this.listModeDisabled?e:e?.filter((e=>"hide"!==(0,v.aV)(e)));e?.length?(this._createChildren(t),this._destroyChildren(t),this._sortChildren(t),this._watchChildLayerListMode(e)):this._destroyAllChildren()}_watchSublayerChanges(e){e&&this.addHandles(e.on("change",(()=>this._compileChildren(e))),O)}_initializeChildLayers(e){this._compileChildren(e),this._watchSublayerChanges(e)}_createChildItems(e,t){return e.reverse().map((e=>t||(0,v.gF)(e)?new T({layer:e,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,parent:this,view:this.view}):null)).filter(s.pC)}_watchLayerProperties(e){if(this.removeHandles(O),this.removeHandles(E),!e)return;if("hide-children"===(!this.listModeDisabled&&(0,v.aV)(e)))return void this.children.destroyAll();const t=(0,v.Ff)(e);t&&this.addHandles((0,a.YP)((()=>e[t]),(i=>{e.hasOwnProperty(t)&&this._initializeChildLayers(i)}),a.nn),O)}};(0,o._)([(0,d.Cb)({type:M})],P.prototype,"actionsSections",void 0),(0,o._)([(0,d.Cb)()],P.prototype,"actionsOpen",void 0),(0,o._)([(0,d.Cb)()],P.prototype,"checkPublishStatusEnabled",void 0),(0,o._)([(0,d.Cb)({type:r.Z.ofType(P)})],P.prototype,"children",void 0),(0,o._)([(0,d.Cb)()],P.prototype,"childrenSortable",void 0),(0,o._)([(0,d.Cb)({readOnly:!0})],P.prototype,"connectionStatus",null),(0,o._)([(0,d.Cb)({readOnly:!0})],P.prototype,"error",null),(0,o._)([(0,d.Cb)()],P.prototype,"hidden",void 0),(0,o._)([(0,d.Cb)({readOnly:!0})],P.prototype,"incompatible",null),(0,o._)([(0,d.Cb)()],P.prototype,"layer",void 0),(0,o._)([(0,d.Cb)({readOnly:!0})],P.prototype,"layerView",null),(0,o._)([(0,d.Cb)()],P.prototype,"listItemCreatedFunction",void 0),(0,o._)([(0,d.Cb)({nonNullable:!0})],P.prototype,"listModeDisabled",void 0),(0,o._)([(0,d.Cb)()],P.prototype,"open",void 0),(0,o._)([(0,d.Cb)({type:C})],P.prototype,"panel",null),(0,o._)([(0,c.p)("panel")],P.prototype,"castPanel",null),(0,o._)([(0,d.Cb)()],P.prototype,"parent",void 0),(0,o._)([(0,d.Cb)({value:!0})],P.prototype,"sortable",null),(0,o._)([(0,d.Cb)()],P.prototype,"title",null),(0,o._)([(0,d.Cb)({readOnly:!0})],P.prototype,"publishing",null),(0,o._)([(0,d.Cb)({readOnly:!0})],P.prototype,"updating",null),(0,o._)([(0,d.Cb)()],P.prototype,"view",void 0),(0,o._)([(0,d.Cb)()],P.prototype,"visible",null),(0,o._)([(0,d.Cb)({readOnly:!0})],P.prototype,"visibleAtCurrentScale",null),(0,o._)([(0,d.Cb)({readOnly:!0})],P.prototype,"visibleAtCurrentTimeExtent",null),(0,o._)([(0,d.Cb)({readOnly:!0})],P.prototype,"visibilityMode",null),P=T=(0,o._)([(0,p.j)("esri.widgets.LayerList.ListItem")],P);const x=P},5221:function(e,t,i){i.d(t,{Cl:function(){return v},Dz:function(){return w},Ff:function(){return h},Gr:function(){return S},Hh:function(){return f},Kf:function(){return d},Kp:function(){return s},MZ:function(){return r},XO:function(){return a},YO:function(){return _},aV:function(){return c},bB:function(){return M},g5:function(){return O},gF:function(){return b},gX:function(){return u},gk:function(){return l},j5:function(){return g},rV:function(){return T},sT:function(){return p},xA:function(){return y},zb:function(){return m}});const o="hide",n="hide-children",s=10,r=2;function l({exclusive:e,visible:t,visibilityAppearance:i}){const o="checkbox"===i;return t?e?"circle-f":o?"check-square-f":"view-visible":e?"circle":o?"square":"view-hide"}function a({connectionStatus:e,publishing:t}){return e?"connected"===e?"beacon":"offline":t?"square":"bullet-point"}function d(e){return e?.listMode===n}function c(e){return e?.listMode??void 0}function p(e){if(!e)return"inherited";const t=function(e){const t=C(e);return null!=t&&"supportsSublayerVisibility"in t?t.supportsSublayerVisibility:void 0}(w(e)?e.layer:e);return null!=t?t?"independent":"inherited":"visibilityMode"in e&&null!=e.visibilityMode?e.visibilityMode:"independent"}function u(e){e?.removeMany(e.filter((e=>e?.destroyed)))}function h(e){if(e&&(!("type"in e)||"wmts"!==e.type))return"sublayers"in e?"sublayers":"layers"in e?"layers":void 0}function g(e,t){e&&(e.filterPredicate=t?e=>t(T(e)):void 0)}function y(e){const t=(e?.layer&&w(e.layer)?e.layer.layer:void 0)??e?.layer;return!!t&&"catalog"!==t.type&&(function(e){const t=C(e);return null!=t&&"supportsDynamicLayers"in t?t.supportsDynamicLayers:void 0}(t)??!0)}function b(e){return c(e)!==o}function m(e,t){if(!e||null==t||isNaN(t))return!1;const i=function(e){return null!=e&&"minScale"in e&&null!=e.minScale?e.minScale:void 0}(e),o=function(e){return null!=e&&"maxScale"in e&&null!=e.maxScale?e.maxScale:void 0}(e),n=null!=i&&!isNaN(i)&&i>0&&t>i,s=null!=o&&!isNaN(o)&&o>0&&t<o;return n||s}function v(e,t){e?.sort(((e,i)=>{const o="uid"in e?t.indexOf(e.uid):-1,n="uid"in i?t.indexOf(i.uid):-1;return o>n?-1:o<n?1:0}))}function _(e,t){const i=e?.layer;if(!i)return;const o=h(i);if(!o)return;let n;"layers"===o&&"layers"in i?n=i.layers:"sublayers"===o&&"sublayers"in i&&(n=i.sublayers),v(n,t)}function f(e){const t=e?.layer;return t&&"layers"in t?t.layers:null}function w(e){return null!=e&&"layer"in e&&null!=e.layer}function C(e){return e&&"capabilities"in e&&null!=e.capabilities&&"exportMap"in e.capabilities?e.capabilities.exportMap:void 0}function T(e){return e?.["data-item"]}function S(e){return e?.getAttribute("data-layer-type")}function M(e){const{children:t,error:i}=e,o="incompatible"in e&&e.incompatible;return!!t?.filter((e=>!e.hidden)).length&&!i&&!o}function O(e){for(const t of e)for(const e of t)if("button"===e.type||"toggle"===e.type)return e}},93427:function(e,t,i){i.d(t,{Z:function(){return h}});var o=i(73440),n=i(70880),s=i(93568),r=i(17155),l=(i(61432),i(96711),i(83850),i(48023));let a=class extends n.Z{get canZoomIn(){const e=this.view?.ready;if(!e)return!1;const t=this.view?.constraints?.effectiveMaxScale;return 0===t||this._scale>t}get canZoomOut(){const{view:e}=this,t=e?.ready;if(!t)return!1;const i=e.constraints?.effectiveMinScale;return 0===i||this._scale<i}get _scale(){const e=this.view?.animation?.target;return(e&&"then"in e?void 0:e?.scale)??this.view?.scale??0}};(0,o._)([(0,r.Cb)({readOnly:!0})],a.prototype,"canZoomIn",null),(0,o._)([(0,r.Cb)({readOnly:!0})],a.prototype,"canZoomOut",null),(0,o._)([(0,r.Cb)()],a.prototype,"view",void 0),(0,o._)([(0,r.Cb)()],a.prototype,"_scale",null),a=(0,o._)([(0,l.j)("esri.widgets.Zoom.ZoomConditions2D")],a);const d=a;let c=class extends n.Z{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};(0,o._)([(0,r.Cb)({readOnly:!0})],c.prototype,"canZoomIn",null),(0,o._)([(0,r.Cb)({readOnly:!0})],c.prototype,"canZoomOut",null),(0,o._)([(0,r.Cb)()],c.prototype,"view",void 0),c=(0,o._)([(0,l.j)("esri.widgets.Zoom.ZoomConditions3D")],c);const p=c;let u=class extends n.Z{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return null!=this._zoomConditions&&this._zoomConditions.canZoomIn}get canZoomOut(){return null!=this._zoomConditions&&this._zoomConditions?.canZoomOut}get state(){return this.view?.ready?"ready":"disabled"}set view(e){e?"2d"===e.type?this._zoomConditions=new d({view:e}):"3d"===e.type&&(this._zoomConditions=new p({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){const e=this.view;this.canZoomIn&&e&&("2d"===e.type?e.mapViewNavigation.zoomIn():(0,s.R8)(e.goTo({zoomFactor:2})))}zoomOut(){const e=this.view;this.canZoomOut&&e&&("2d"===e.type?e.mapViewNavigation.zoomOut():(0,s.R8)(e.goTo({zoomFactor:.5})))}};(0,o._)([(0,r.Cb)()],u.prototype,"_zoomConditions",void 0),(0,o._)([(0,r.Cb)()],u.prototype,"canZoomIn",null),(0,o._)([(0,r.Cb)()],u.prototype,"canZoomOut",null),(0,o._)([(0,r.Cb)({readOnly:!0})],u.prototype,"state",null),(0,o._)([(0,r.Cb)()],u.prototype,"view",null),u=(0,o._)([(0,l.j)("esri.widgets.Zoom.ZoomViewModel")],u);const h=u},63712:function(e,t,i){i.d(t,{Z:function(){return l}});var o=i(73440),n=i(61100),s=i(17155),r=(i(61432),i(96711),i(83850),i(48023));const l=e=>{let t=class extends e{constructor(...e){super(...e),this.goToOverride=null,this.view=null}callGoTo(e){const{view:t}=this;return(0,n.O3)(t),this.goToOverride?this.goToOverride(t,e):function(e,t,i){return e.goTo(t,i)}(t,e.target,e.options)}};return(0,o._)([(0,s.Cb)()],t.prototype,"goToOverride",void 0),(0,o._)([(0,s.Cb)()],t.prototype,"view",void 0),t=(0,o._)([(0,r.j)("esri.widgets.support.GoTo")],t),t}},88512:function(e,t,i){i.d(t,{Z:function(){return a}});var o=i(73440),n=i(70880),s=i(17155),r=(i(61432),i(96711),i(83850),i(48023));let l=class extends n.Z{constructor(e){super(e),this.colorSelection=!0,this.dynamicScaleToggle=!0,this.gridEnabledToggle=!0,this.numericInputs=!0,this.gridSnapEnabledToggle=!0,this.lineIntervalInput=!0,this.outOfScaleWarning=!0,this.placementButtons=!0,this.rotateWithMapToggle=!0}};(0,o._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"colorSelection",void 0),(0,o._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"dynamicScaleToggle",void 0),(0,o._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"gridEnabledToggle",void 0),(0,o._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"numericInputs",void 0),(0,o._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"gridSnapEnabledToggle",void 0),(0,o._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"lineIntervalInput",void 0),(0,o._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"outOfScaleWarning",void 0),(0,o._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"placementButtons",void 0),(0,o._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"rotateWithMapToggle",void 0),l=(0,o._)([(0,r.j)("esri.widgets.support.GridControls.VisibleElements")],l);const a=l},82504:function(e,t,i){i.d(t,{n:function(){return s},t:function(){return a}});var o=i(84644),n=(i(68808),i(23039));const s=()=>(0,o.h)({icon:()=>Promise.all([i.e(58268),i.e(4204)]).then(i.bind(i,4204)),label:()=>Promise.all([i.e(58268),i.e(36650)]).then(i.bind(i,36650)),switch:()=>Promise.all([i.e(58268),i.e(17345),i.e(95636)]).then(i.bind(i,95636)),tooltip:()=>Promise.all([i.e(58268),i.e(62737),i.e(70514)]).then(i.bind(i,70514))}),r="esri-labeled-switch",l={label:`${r}__label`,labelContent:`${r}__label-content`,iconInfo:`${r}__icon_info`,iconWarning:`${r}__icon_warning`,tooltip:`${r}__tooltip`};function a({checked:e,disabled:t,hint:i,key:o,label:s,onChange:r,hintIcon:a,hintKind:d}){return(0,n.u)("calcite-label",{class:l.label,disabled:t,key:o,layout:"inline-space-between",scale:"s"},i?(0,n.u)("div",{class:l.labelContent,key:"label-content"},(0,n.u)("div",null,s),(0,n.u)("calcite-icon",{class:"warning"!==d?l.iconInfo:l.iconWarning,icon:a??"information",id:o,onclick:e=>e.stopPropagation(),onpointerdown:e=>{e.preventDefault(),e.stopPropagation();const t=e.target.nextElementSibling;t.open=!t.open},scale:"s",tabIndex:0}),(0,n.u)("calcite-tooltip",{class:l.tooltip,overlayPositioning:"fixed",referenceElement:o},i)):s,(0,n.u)("calcite-switch",{checked:e,disabled:t,scale:"s",onCalciteSwitchChange:e=>r(e.currentTarget.checked)}))}},34171:function(e,t,i){i.d(t,{W:function(){return o}});const o={close:"esri-icon-close",collapse:"esri-icon-collapse",down:"esri-icon-down",downArrow:"esri-icon-down-arrow",dragHorizontal:"esri-icon-drag-horizontal",dragVertical:"esri-icon-drag-vertical",duplicate:"esri-icon-duplicate",expand:"esri-icon-expand",fontFallbackText:"esri-icon-font-fallback-text",forward:"esri-icon-forward",handleVertical:"esri-icon-handle-vertical",icon:"esri-icon",left:"esri-icon-left",locateCircled:"esri-icon-locate-circled",noticeTriangle:"esri-icon-notice-triangle",pause:"esri-icon-pause",play:"esri-icon-play",plus:"esri-icon-plus",radioChecked:"esri-icon-radio-checked",radioUnchecked:"esri-icon-radio-unchecked",refresh:"esri-icon-refresh",reverse:"esri-icon-reverse",right:"esri-icon-right",search:"esri-icon-search",swap:"esri-icon-swap",table:"esri-icon-table",trash:"esri-icon-trash",up:"esri-icon-up",upArrow:"esri-icon-up-arrow",upDownArrows:"esri-icon-up-down-arrows",urbanModel:"esri-icon-urban-model",zoomInMagnifyingGlass:"esri-icon-zoom-in-magnifying-glass",zoomToObject:"esri-icon-zoom-to-object"}},60916:function(e,t,i){i.d(t,{Qd:function(){return o},o:function(){return n}});i(80079),i(23039),i(68808);function o(e){return e&&"function"==typeof e.render}function n(e){return e&&"function"==typeof e.postMixInProperties&&"function"==typeof e.buildRendering&&"function"==typeof e.postCreate&&"function"==typeof e.startup}},92396:function(e,t,i){var o=i(64297),n=i(20803),s=i(46789),r=i(53447),l=i(73440),a=(i(55214),i(3480)),d=i(50702),c=i(96711),p=i(61100),u=i(93568),h=i(90403),g=i(17155),y=(i(61432),i(48023)),b=i(57440),m=i(1803),v=i(67947),_=i(70880),f=(i(83850),i(88512));let w=class extends _.Z{constructor(e){super(e),this.enabledToggle=!0,this.featureEnabledToggle=!0,this.gridEnabledToggle=!0,this.header=!1,this.layerList=!0,this.gridControls=!0,this.gridControlsElements=new f.Z({gridSnapEnabledToggle:!1,gridEnabledToggle:!1}),this.layerListToggleLayersButton=!0,this.selfEnabledToggle=!0}};(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],w.prototype,"enabledToggle",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],w.prototype,"featureEnabledToggle",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],w.prototype,"gridEnabledToggle",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],w.prototype,"header",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],w.prototype,"layerList",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],w.prototype,"gridControls",void 0),(0,l._)([(0,g.Cb)({type:f.Z,nonNullable:!0})],w.prototype,"gridControlsElements",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],w.prototype,"layerListToggleLayersButton",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],w.prototype,"selfEnabledToggle",void 0),w=(0,l._)([(0,y.j)("esri.widgets.support.SnappingControls.VisibleElements")],w);const C=w;let T=class extends _.Z{constructor(e){super(e),this.point=!0,this.polyline=!0,this.polygon=!0,this.rectangle=!0,this.circle=!0,this.multipoint=!0,this.mesh=!0,this.freehandPolyline=!1,this.freehandPolygon=!1}};(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],T.prototype,"point",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],T.prototype,"polyline",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],T.prototype,"polygon",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],T.prototype,"rectangle",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],T.prototype,"circle",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],T.prototype,"multipoint",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],T.prototype,"mesh",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],T.prototype,"freehandPolyline",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],T.prototype,"freehandPolygon",void 0),T=(0,l._)([(0,y.j)("esri.widgets.Sketch.VisibleElements.CreateToolVisibilityMap")],T);let S=class extends _.Z{constructor(e){super(e),this["rectangle-selection"]=!0,this["lasso-selection"]=!0,this["custom-selection"]=!0}};(0,l._)([(0,g.Cb)({nonNullable:!0})],S.prototype,"rectangle-selection",void 0),(0,l._)([(0,g.Cb)({nonNullable:!0})],S.prototype,"lasso-selection",void 0),(0,l._)([(0,g.Cb)({nonNullable:!0})],S.prototype,"custom-selection",void 0),S=(0,l._)([(0,y.j)("esri.widgets.Sketch.VisibleElements.SelectionToolVisibilityMap")],S);let M=class extends _.Z{constructor(e){super(e),this.createTools=new T,this.directionModePicker=!1,this.duplicateButton=!0,this.deleteButton=!0,this.selectionCountLabel=!0,this.labelsToggle=!0,this.selectionTools=new S,this.settingsMenu=!0,this.snappingControls=!0,this.snappingControlsElements=new C,this.tooltipsToggle=!0,this.undoRedoMenu=!0}};(0,l._)([(0,g.Cb)({type:T,nonNullable:!0})],M.prototype,"createTools",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],M.prototype,"directionModePicker",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],M.prototype,"duplicateButton",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],M.prototype,"deleteButton",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],M.prototype,"selectionCountLabel",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],M.prototype,"labelsToggle",void 0),(0,l._)([(0,g.Cb)({type:S,nonNullable:!0})],M.prototype,"selectionTools",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],M.prototype,"settingsMenu",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],M.prototype,"snappingControls",void 0),(0,l._)([(0,g.Cb)({type:C,nonNullable:!0})],M.prototype,"snappingControlsElements",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],M.prototype,"tooltipsToggle",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],M.prototype,"undoRedoMenu",void 0),M=(0,l._)([(0,y.j)("esri.widgets.Sketch.VisibleElements")],M);var O=i(57897);const E=1,P={s:32,m:48,l:64},x={horizontal:{s:16,m:16,l:24},vertical:{s:16,m:24,l:40}},I={splitButton:{horizontal:"chevron-down",vertical:"ellipsis"},overflow:"ellipsis"};function L(e,t){return e.vnodeSelector===t?[e]:e.children?.flatMap((e=>L(e,t)))??[]}const k=e=>{let t=class extends e{constructor(){super(...arguments),this.priority=0,this.scale="m",this.slot=void 0,this.lastActiveKey=null,this.layout="horizontal"}destroy(){this.measurementManager?.managedElements.remove(this),this.measurementManager=null}set measurementManager(e){const t=this._get("measurementManager");e!==t&&(t&&t.managedElements.remove(this),this._set("measurementManager",e),e?.managedElements.add(this))}set budgetedLength(e){this.budgetedLength!==e&&(this._set("budgetedLength",e),this.scheduleRender())}get actionChildren(){return this.children?.flatMap((e=>L(e,"calcite-action")))??[]}get activeChildElement(){const e=this.actionChildren.find((e=>!0===e.properties?.active));return e?(this._set("lastActiveKey",e.properties?.key),e):this.lastActiveKey?this.actionChildren.find((e=>e.properties?.key===this.lastActiveKey)):void 0}_handleClick(e){e?.dataset&&"dataset"in e&&e.dataset.actionKey&&(this.lastActiveKey=e.dataset.actionKey)}};return(0,l._)([(0,g.Cb)()],t.prototype,"priority",void 0),(0,l._)([(0,g.Cb)()],t.prototype,"measurementManager",null),(0,l._)([(0,g.Cb)()],t.prototype,"budgetedLength",null),(0,l._)([(0,g.Cb)()],t.prototype,"actionChildren",null),(0,l._)([(0,g.Cb)()],t.prototype,"activeChildElement",null),(0,l._)([(0,g.Cb)()],t.prototype,"scale",void 0),(0,l._)([(0,g.Cb)()],t.prototype,"slot",void 0),(0,l._)([(0,g.Cb)()],t.prototype,"lastActiveKey",void 0),(0,l._)([(0,g.Cb)()],t.prototype,"layout",void 0),t=(0,l._)([(0,y.j)("esri.widgets.Sketch.support.ResponsiveToolbar.ToolbarGroupBase")],t),t};var F=i(68808),Z=i(23039);const D=Symbol("on-resize-handle-key");let R=class extends(k(m.Z)){constructor(e){super(e),this._measuredWidth=0,this._measuredHeight=0,this._measuredElement=null}destroy(){this._measuredElement=null}get lengthOptions(){return["horizontal"===this.layout?this._measuredWidth:this._measuredHeight]}render(){return(0,Z.u)("div",{afterCreate:e=>{this._measuredElement=e.firstElementChild,this.addHandles((0,F.ib)(this._measuredElement,(()=>{this._measuredWidth=this._measuredElement?.clientWidth??0,this._measuredHeight=this._measuredElement?.clientHeight??0})),D)},afterRemoved:()=>this.removeHandles(D)},this.children)}};(0,l._)([(0,g.Cb)()],R.prototype,"_measuredWidth",void 0),(0,l._)([(0,g.Cb)()],R.prototype,"_measuredHeight",void 0),(0,l._)([(0,g.Cb)()],R.prototype,"lengthOptions",null),(0,l._)([(0,g.Cb)()],R.prototype,"_measuredElement",void 0),R=(0,l._)([(0,y.j)("esri.widgets.Sketch.support.ResponsiveToolbar.MeasuredContentGroup")],R);var N=i(84644),$=i(24225);let A=class extends(k(m.Z)){constructor(e){super(e),this.allowCollapse=!0,this.messagesCommon=null}loadDependencies(){return(0,N.h)({action:()=>Promise.all([i.e(58268),i.e(55001),i.e(11030)]).then(i.bind(i,11030)),"action-group":()=>Promise.all([i.e(58268),i.e(62737),i.e(55001),i.e(71823),i.e(79767),i.e(65988)]).then(i.bind(i,22655)),"action-menu":()=>Promise.all([i.e(58268),i.e(62737),i.e(55001),i.e(71823),i.e(79767),i.e(69208)]).then(i.bind(i,79767))})}static{this.vnodeSelector="calcite-action-group"}get minimumLength(){const{actionChildren:e,scale:t}=this;return e.length?this.allowCollapse?E+P[t]*Math.min(e.length,2):E+P[t]*e.length:0}get lengthOptions(){const{actionChildren:e,scale:t,minimumLength:i,allowCollapse:o,priority:n}=this,s=[i];if(e.length<=2||!o||n<1)return s;for(let o=1;o<e.length-1;o++)s.push(i+P[t]*o);return s}render(){if(!this.actionChildren.length)return(0,Z.u)(Z.D,null,void 0);const{budgetedLength:e,actionChildren:t,activeChildElement:i,layout:o,slot:n,scale:s}=this,r=Math.floor(e/P[s]),l=[],a=[];if(r>=t.length)l.push(...t);else{const e=i??l.at(0);if(l.push(...t.slice(0,r-1)),a.push(...t.slice(r-1)),e&&a.includes(e)){const[t]=a.splice(a.indexOf(e),1),i=l.pop();l.push(t),i&&a.unshift(i)}}return(0,Z.u)("calcite-action-group",{key:"overflow-button-group",layout:o,onclick:e=>this._handleClick(e.target),slot:n},l.map((e=>this._renderManagedAction(e))),a.length>0?(0,Z.u)("calcite-action-menu",{key:"split-button-dropdown",label:this.messagesCommon.more,overlayPositioning:"fixed"},(0,Z.u)("calcite-action",{icon:I.overflow,key:"split-button-dropdown-trigger",scale:s,slot:"trigger",text:this.messagesCommon.more}),a.map((e=>this._renderManagedAction(e)))):void 0)}_renderManagedAction(e){return(0,Z.u)("calcite-action",{...e?.properties,"data-action-key":e?.properties?.key,text:e?.properties?.text??""})}};(0,l._)([(0,g.Cb)()],A.prototype,"allowCollapse",void 0),(0,l._)([(0,g.Cb)()],A.prototype,"minimumLength",null),(0,l._)([(0,g.Cb)(),(0,$.H)("esri/t9n/common")],A.prototype,"messagesCommon",void 0),(0,l._)([(0,g.Cb)()],A.prototype,"lengthOptions",null),A=(0,l._)([(0,y.j)("esri.widgets.Sketch.support.ResponsiveToolbar.OverflowGroup")],A);var B=i(43254);let G=class extends _.Z{constructor(){super(...arguments),this.measuredElement=null,this.managedElements=new B.Z,this.availableLength=0,this.layout="horizontal",this._resizeObserver=new ResizeObserver((()=>{this._measure()}))}get _sortedElements(){return[...this.managedElements].sort(((e,t)=>t.priority-e.priority))}connect(e){this._resizeObserver.disconnect(),this.measuredElement=e,this._resizeObserver.observe(e),this._measure()}allocate(){const e=new Map,{availableLength:t,_sortedElements:i}=this;let o=0;for(const t of i){const i=t.lengthOptions[0];e.set(t,i),o+=i}for(const n of i)for(;o<t;){const i=e.get(n);if(!i)break;const s=n.lengthOptions.find((e=>e>i));if(!s)break;const r=o-i+s;if(r>t)break;e.set(n,s),o=r}for(const[t,i]of e)t.budgetedLength=i}_measure(){const e=this.measuredElement;this.availableLength=e?"horizontal"===this.layout?e.clientWidth??0:e.clientHeight??0:0,this.allocate()}destroy(){this._resizeObserver.disconnect()}};(0,l._)([(0,g.Cb)()],G.prototype,"measuredElement",void 0),(0,l._)([(0,g.Cb)()],G.prototype,"managedElements",void 0),(0,l._)([(0,g.Cb)()],G.prototype,"_sortedElements",null),(0,l._)([(0,g.Cb)()],G.prototype,"availableLength",void 0),(0,l._)([(0,g.Cb)()],G.prototype,"layout",void 0),G=(0,l._)([(0,y.j)("esri.widgets.Sketch.support.ResponsiveToolbar.ResponsiveToolbarManager")],G);const V="esri-split-button--split-part";let z=class extends(k(m.Z)){constructor(e){super(e),this.allowCollapse=!0,this.messagesCommon=null}loadDependencies(){return(0,N.h)({action:()=>Promise.all([i.e(58268),i.e(55001),i.e(11030)]).then(i.bind(i,11030)),"action-group":()=>Promise.all([i.e(58268),i.e(62737),i.e(55001),i.e(71823),i.e(79767),i.e(65988)]).then(i.bind(i,22655)),"action-menu":()=>Promise.all([i.e(58268),i.e(62737),i.e(55001),i.e(71823),i.e(79767),i.e(69208)]).then(i.bind(i,79767))})}static{this.vnodeSelector="calcite-action-group"}get minimumLength(){const e=this.actionChildren;return e.length?1===e.length?P[this.scale]+E:this.allowCollapse?P[this.scale]+x[this.layout][this.scale]+E:P[this.scale]*e.length+E:0}get lengthOptions(){const{actionChildren:e,minimumLength:t,layout:i,scale:o,priority:n,allowCollapse:s}=this;if(e.length<2||n<0||!s)return[t];const r=E+P[o]*e.length;return[E+P[o]+x[i][o],r]}render(){if(!this.actionChildren.length)return(0,Z.u)(Z.D,null,void 0);const{actionChildren:e,minimumLength:t,budgetedLength:i,layout:o,slot:n,allowCollapse:s}=this,r=!s||e.length<2||i>t;return(0,Z.u)("calcite-action-group",{key:"split-button-group",layout:o,onclick:e=>this._handleClick(e.target),slot:n},r?this._renderUnSplit():this._renderSplit())}_renderSplit(){const{activeChildElement:e,layout:t,actionChildren:i,scale:o,messagesCommon:n}=this,s=e??i.at(0);if(!s)return;const r=i.filter((e=>e!==s));return[this._renderManagedAction(s),(0,Z.u)("calcite-action-menu",{key:"split-button-dropdown",label:n.more,overlayPositioning:"fixed",placement:"horizontal"===t?"bottom-end":"right-end"},(0,Z.u)("calcite-action",{class:`${V}--${t}--${this.scale}`,compact:"horizontal"===t,icon:I.splitButton[t],key:"split-button-dropdown-trigger",scale:o,slot:"trigger",text:n.more}),r?.map((e=>this._renderManagedAction(e))))]}_renderUnSplit(){return this.actionChildren.map((e=>this._renderManagedAction(e)))}_renderManagedAction(e){return(0,Z.u)("calcite-action",{...e?.properties,"data-action-key":e?.properties?.key,text:e?.properties?.text??""})}};(0,l._)([(0,g.Cb)()],z.prototype,"minimumLength",null),(0,l._)([(0,g.Cb)()],z.prototype,"allowCollapse",void 0),(0,l._)([(0,g.Cb)()],z.prototype,"lengthOptions",null),(0,l._)([(0,g.Cb)(),(0,$.H)("esri/t9n/common")],z.prototype,"messagesCommon",void 0),z=(0,l._)([(0,y.j)("esri.widgets.Sketch.support.ResponsiveToolbar.SplitButton")],z);const j="esri-responsive-toolbar",H={rulerBase:`${j}__ruler`,rulerBarHorizontal:`${j}__ruler--bar`,rulerBarVertical:`${j}__ruler--bar--vertical`,rulerPadVertical:`${j}__ruler--pad--vertical`,rulerPadHorizontal:`${j}__ruler--pad--horizontal`,bar:`${j}__bar`,barHorizontal:`${j}__bar--horizontal`,barVertical:`${j}__bar--vertical`,pad:`${j}__pad`,padVertical:`${j}__pad--vertical`,padHorizontal:`${j}__pad--horizontal`};let U=class extends m.Z{constructor(e){super(e),this.scale="m",this.barStyle="floating",this._measurementManager=new G,this._managedWidgets=new Map}loadDependencies(){return(0,N.h)({"action-bar":()=>Promise.all([i.e(58268),i.e(62737),i.e(55001),i.e(71823),i.e(79767),i.e(94568)]).then(i.bind(i,4649))})}destroy(){this._measurementManager=(0,p.SC)(this._measurementManager),this._managedWidgets.forEach((e=>e.destroy())),this._managedWidgets.clear()}set layout(e){const t=this._get("layout");this._set("layout",e),this._measurementManager&&(this._measurementManager.layout=e),t!==e&&this.scheduleRender()}get _barClasses(){const e="docked"===this.barStyle,t="vertical"===this.layout;return{[H.barHorizontal]:e&&!t,[H.barVertical]:e&&t,[H.bar]:e,[H.padHorizontal]:!e&&!t,[H.padVertical]:!e&&t,[H.pad]:!e}}render(){const{layout:e,scale:t,barStyle:i}=this,o={layout:e,scale:t,expandDisabled:!0,key:"measured-toolbar"},n="docked"===i?"vertical"===e?H.rulerBarVertical:H.rulerBarHorizontal:"horizontal"===e?H.rulerPadHorizontal:H.rulerPadVertical;return(0,Z.u)("div",null,(0,Z.u)("div",{afterCreate:e=>{this._measurementManager?.connect(e)},class:this.classes(H.rulerBase,n)}),(0,Z.u)("calcite-action-bar",{...o,classes:this._barClasses,floating:"docked"!==i,overflowActionsDisabled:!0},this._renderChildren()))}_renderChildren(){if(!this.children)return;const e=this.children.filter((e=>void 0!==e.properties?.key&&"group-kind"in e.properties)),t=new Set,i=e.map((e=>{const i=e.properties,o=i.key;t.add(o);const n="docked"===this.barStyle?i.slot??void 0:void 0,s=i.priority??0,r=i["group-kind"]??"overflow-group",l=i["allow-collapse"]??!0,a=this._managedWidgets.get(o);if(a)return a.children=e.children,a.priority=s,"allowCollapse"in a&&(a.allowCollapse=l),a.slot=n,a.layout=this.layout,a.scale=this.scale,a.measurementManager=this._measurementManager,a;const d={scale:this.scale,priority:s,measurementManager:this._measurementManager,children:e.children,slot:n,layout:this.layout};switch(r){case"split-button":{const e=new z({...d,allowCollapse:l});return this._managedWidgets.set(o,e),e}case"overflow-group":{const e=new A({...d,allowCollapse:l});return this._managedWidgets.set(o,e),e}case"measured-content":{const e=new R({...d});return this._managedWidgets.set(o,e),e}}})).filter(a.pC);return Array.from(this._managedWidgets.keys()).filter((e=>!t.has(e))).forEach((e=>{this._managedWidgets.get(e)?.destroy(),this._managedWidgets.delete(e)})),this._measurementManager?.allocate(),i.map((e=>e.render()))}};(0,l._)([(0,g.Cb)()],U.prototype,"scale",void 0),(0,l._)([(0,g.Cb)({value:"horizontal"})],U.prototype,"layout",null),(0,l._)([(0,g.Cb)()],U.prototype,"barStyle",void 0),(0,l._)([(0,g.Cb)()],U.prototype,"_measurementManager",void 0),(0,l._)([(0,g.Cb)()],U.prototype,"_managedWidgets",void 0),(0,l._)([(0,g.Cb)()],U.prototype,"_barClasses",null),U=(0,l._)([(0,y.j)("esri.widgets.Sketch.support.ResponsiveToolbar.ResponsiveToolbar")],U);var W=i(85168),Y=i(46512),q=i(87833),J=i(75428),X=i(77308),K=i(27546),Q=i(29292),ee=i(96094),te=i(60508),ie=i(67764),oe=i(28931),ne=i(18753),se=i(8316),re=i(76554),le=i(71730),ae=i(54318);async function de(e){const{returnFeatureTitleFields:t,returnGeometry:i,selector:o,signal:n,sources:s,view:r}=e;if(!s?.length)return[];const{layers:l,layerViews:a,graphicsLayers:d}=function(e){const t=[],i=[],o=[];return e.forEach((e=>{(0,J.Te)(e)||(0,J.e9)(e)||(0,J.Hd)(e)?t.push(e):((0,J.Q2)(e)||(0,J.Ux)(e))&&e.layers?.length?t.push(...e.layers.toArray()):(0,J.aw)(e)&&e.sublayers?.length?o.push(...e.sublayers.toArray()):(0,J.ik)(e)?o.push(e):(0,K.Xi)(e)&&i.push(e)})),{layers:t,layerViews:i,graphicsLayers:o}}(s),c=[];return await(0,u.R8)((0,u.Hl)(Promise.all([pe({candidates:c,layers:l,returnFeatureTitleFields:t,returnGeometry:i,selector:o,signal:n,view:r}),ce({candidates:c,layerViews:a,returnGeometry:i,selector:o,signal:n,view:r}),he({candidates:c,graphicsLayers:d,selector:o})]),n)),c}async function ce(e){const{candidates:t,layerViews:i,returnGeometry:o,selector:n,signal:s,view:r}=e;"point"!==n.type?await(0,u.Hl)(Promise.allSettled(i.map((async e=>{const i=function(e,t,i,o=!0){const n=e.createQuery();return n.outFields=["*"],n.geometry=ue(t,e.layer,i),n.returnGeometry=o,n.outSpatialReference=i.spatialReference,n}(e,n,r,o),l=await e.queryFeatures(i,{signal:s});(0,a.w6)(t,l.features)}))),s):await async function({candidates:e,layerViews:t,selector:i,view:o}){const n=o.toScreen(i);if(!n)return;const s=t.map((e=>e.layer)),{results:r}=await o.hitTest(n,{include:s});r.forEach((t=>{"graphic"in t&&t.graphic&&e.push(t.graphic)}))}({candidates:t,layerViews:i,selector:n,view:r})}async function pe(e){const{candidates:t,layers:i,returnFeatureTitleFields:o,returnGeometry:n,selector:s,signal:r,view:l}=e;await(0,u.Hl)(Promise.allSettled(i.map((async e=>{if("isTable"in e&&e.isTable)return;const i=function(e,t,i,o=!1,n=!0){const s=e.createQuery();return s.outFields=function(e,t,i){const{fields:o,fieldsIndex:n}=e,s=new Set([e.objectIdField]);"globalIdField"in e&&null!=e.globalIdField&&n.has(e.globalIdField)&&s.add(n.get(e.globalIdField).name);const r="displayField"in e?e.displayField:null,l=(0,re.O5)({displayField:r,fields:o});if(null!=l&&n.has(l)&&s.add(l),"subtypeField"in e&&null!=e.subtypeField){const i=n.get(e.subtypeField)?.name;if(null!=i&&s.add(i),"utilityNetworks"in t.map&&t.map.utilityNetworks?.length){const e=n.get("assetgroup");e?.name&&s.add(e.name);const t=n.get("assettype");t?.name&&s.add(t.name)}}return(i||t.requiredFieldsOptions.featureTitleFields)&&"featureTitleFields"in e&&e.featureTitleFields&&e.featureTitleFields.forEach((e=>s.add(e))),Array.from(s.values())}(e,i,o),s.geometry=ue(t,e,i),s.returnGeometry=n,s.outSpatialReference=i.spatialReference,s}(e,s,l,o,n),d=await e.queryFeatures(i,{signal:r});(0,a.w6)(t,d.features)}))),r)}function ue(e,t,i){return"point"===e.type?(0,ae.K)(e,"renderer"in t?(0,le.k)({renderer:t.renderer}):0,i):e}async function he(e){const{candidates:t,graphicsLayers:o,selector:n}=e,s=o.flatMap((e=>e.graphics.toArray()))??[];if(!s?.length||!n)return;const r=await Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(60629)]).then(i.bind(i,98379));r.accelerateGeometry(n),s.forEach((e=>{e.geometry&&"mesh"!==e.geometry.type&&r.execute(n,e.geometry)&&t.push(e)}))}let ge=class extends q.Z.EventedAccessor{constructor(e){super(e),this._completed=!1,this._isConstraintKeyDown=!1,this._processTask=null,this.createTool="rectangle",this.mode=null,this.persistSelection=!0,this.returnFeatureTitleFields=!1,this.returnGeometry=!0,this.selection=new B.Z,this.selectionManager=null,this.selectOnComplete=!0,this.sources=null,this.toolName="",this.type="add",this._process=(0,u.Ds)((async(e,t)=>{const{callback:i,selector:o,completed:n}=e,s=(0,Q.vr)((async e=>{const{effectiveSelectionManager:t,returnFeatureTitleFields:s,returnGeometry:r,selection:l,sources:a,view:d}=this;if((a?.length||t.sources.length)&&d){if(o&&null!=a){const i=await de({returnFeatureTitleFields:s,returnGeometry:r,selector:o,signal:e,sources:a,view:d});if(l.removeAll(),l.addMany(i),n&&this.persistSelection)switch(this.effectiveType){case"remove":t.updateSelection({current:[],added:[],removed:i});break;case"replace":t.clear(),t.updateSelection({current:i,added:[],removed:[]});break;default:t.updateSelection({current:i,added:[],removed:[]})}}i&&i()}else l.removeAll()}));return(0,u.fu)(t,(()=>s.abort())),this._processTask=s,s.promise}),100),this._onOperationFinish=this._onOperationFinish.bind(this)}initialize(){this._setup()}get _defaultMode(){return"polygon"===this.createTool?"click":"hybrid"}get _selectionArea(){const e=this._tool.coordinates;if(0===e.length)return;const t=(0,ee.vW)(),i=this.view.spatialReference,o=e=>{t.x=e[0],t.y=e[1];const i=this.view.toMap(t);return[i?.x??0,i?.y??0]};if(1===e.length||e.every((([t,i])=>t===e[0][0]&&i===e[0][1]))){const[t,n]=o(e[0]);return new te.Z({x:t,y:n,spatialReference:i})}const n=e.map(o);return 0!==n.length?((0,oe.bu)(n)||n.reverse(),new ie.Z({spatialReference:i,rings:[n]})):void 0}get completed(){return this._completed}get effectiveSelectionManager(){return this.selectionManager??this.view.selectionManager}get effectiveType(){const e=this.type??"add";if(this._isConstraintKeyDown)switch(e){case"add":return"remove";case"remove":case"replace":return"add";default:return e}return e}get processingFinalSelection(){return!(!this._processTask||!this._tool?.drawOperation?.isCompleted)}cancel(){this.selection.removeAll(),this._onOperationFinish(!0)}destroy(){this._toolImportController=(0,p.IM)(this._toolImportController)}async _setup(){const{createTool:e,view:t}=this;if(await t.whenReady(),this.destroyed||this._toolImportController)return;const o=new AbortController;this._toolImportController=o;const[n,s]=await Promise.all([Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(18208),i.e(1663),i.e(65204),i.e(72997),i.e(974)]).then(i.bind(i,76473)),(0,se.U)()]);if(o.signal.aborted)return;const r=Symbol();try{this._tool=new n.DrawScreenTool({view:t,mode:this.mode??this._defaultMode,geometryType:e,cursor:"point"===e?"default":"crosshair",automaticLengthMeasurementUtils:s})}finally{this._toolImportController=null}this._tool?(this.selectOnComplete||this.addHandles(this._tool.on(["cursor-update","vertex-add","vertex-remove"],(()=>{this._syncConstraintKeyDown(),(0,u.R8)(this._process({selector:this._selectionArea}))})),r),this.addHandles([t.on("key-down",(e=>{if(!e.repeat)switch(e.key){case ne.Sn.constraint:this._tool.uniformSizeToggled=!0,e.stopPropagation();break;case ne.Sn.center:this._tool.centeredToggled=!0,e.stopPropagation()}})),t.on("key-up",(e=>{switch(e.key){case ne.Sn.constraint:this._tool.uniformSizeToggled=!1,e.stopPropagation();break;case ne.Sn.center:this._tool.centeredToggled=!1,e.stopPropagation()}})),this.selection.on("change",(({added:e,removed:t})=>this.emit("selection-change",{operationType:this.effectiveType,added:e,removed:t}))),this._tool.on("complete",(async e=>{this._syncConstraintKeyDown(),this.removeHandles(r),e.aborted?this.cancel():(this._tool.cursor="progress",await this._process({selector:this._selectionArea,callback:this._onOperationFinish,completed:!0}))}))],r),this.addHandles((0,d.kB)((()=>t.tools.remove(this._tool)))),t.addAndActivateTool(this._tool)):c.Z.getLogger(this).warn("Unable to import Draw module. SelectionOperation failed to load.")}_syncConstraintKeyDown(){const{inputManager:e}=this.view;this._isConstraintKeyDown=ne.a8.invertType.some((t=>e.isModifierKeyDown(t)))}_onOperationFinish(e=!1){this.removeAllHandles(),this._processTask?.abort(),this.emit("complete",{aborted:e,operationType:this.effectiveType,selection:this.selection.toArray(),toolName:this.toolName}),this._completed=!0}};(0,l._)([(0,g.Cb)()],ge.prototype,"_completed",void 0),(0,l._)([(0,g.Cb)()],ge.prototype,"_defaultMode",null),(0,l._)([(0,g.Cb)()],ge.prototype,"_isConstraintKeyDown",void 0),(0,l._)([(0,g.Cb)()],ge.prototype,"_processTask",void 0),(0,l._)([(0,g.Cb)()],ge.prototype,"_selectionArea",null),(0,l._)([(0,g.Cb)()],ge.prototype,"completed",null),(0,l._)([(0,g.Cb)({constructOnly:!0})],ge.prototype,"createTool",void 0),(0,l._)([(0,g.Cb)()],ge.prototype,"effectiveSelectionManager",null),(0,l._)([(0,g.Cb)()],ge.prototype,"effectiveType",null),(0,l._)([(0,g.Cb)({constructOnly:!0})],ge.prototype,"mode",void 0),(0,l._)([(0,g.Cb)()],ge.prototype,"persistSelection",void 0),(0,l._)([(0,g.Cb)()],ge.prototype,"processingFinalSelection",null),(0,l._)([(0,g.Cb)()],ge.prototype,"returnFeatureTitleFields",void 0),(0,l._)([(0,g.Cb)()],ge.prototype,"returnGeometry",void 0),(0,l._)([(0,g.Cb)({readOnly:!0})],ge.prototype,"selection",void 0),(0,l._)([(0,g.Cb)({constructOnly:!0})],ge.prototype,"selectionManager",void 0),(0,l._)([(0,g.Cb)({constructOnly:!0})],ge.prototype,"selectOnComplete",void 0),(0,l._)([(0,g.Cb)()],ge.prototype,"sources",void 0),(0,l._)([(0,g.Cb)({constructOnly:!0})],ge.prototype,"toolName",void 0),(0,l._)([(0,g.Cb)({constructOnly:!0})],ge.prototype,"type",void 0),(0,l._)([(0,g.Cb)({constructOnly:!0})],ge.prototype,"view",void 0),ge=(0,l._)([(0,y.j)("esri.widgets.support.Selector2D.SelectionOperation")],ge);const ye=ge;let be=class extends q.Z.EventedAccessor{constructor(e){super(e),this._operationHandlesGroup=null,this.activeOperation=null,this.continuousSelectionEnabled=!1,this.defaultLassoToolOptions={createTool:"polygon",mode:"hybrid",toolName:"lasso"},this.defaultOperationType="add",this.defaultPointToolOptions={createTool:"point",toolName:"point"},this.defaultRectangleToolOptions={createTool:"rectangle",toolName:"rectangle"},this.layerViewPreferenceEnabled=!0,this.persistSelection=!0,this.selectionManager=null,this.returnFeatureTitleFields=!1,this.returnGeometry=!0,this.selectOnComplete=!0,this.sources=null,this.toolConfigs=[]}initialize(){this.addHandles([(0,h.YP)((()=>this.effectiveSources),(e=>{this.activeOperation&&(this.activeOperation.sources=e)}))])}destroy(){this._operationHandlesGroup=(0,p.hw)(this._operationHandlesGroup)}get effectiveSelectionManager(){return this.selectionManager??this.view?.selectionManager}get effectiveSources(){const{layerViewPreferenceEnabled:e,sources:t,view:i}=this,o=t??this.effectiveSelectionManager?.sources;if(!o?.length)return[];const n=[];return o.forEach((t=>{if((0,K.Xi)(t))n.push(t);else if((0,J.Q2)(t)||(0,J.Ux)(t))(t.layers||[]).forEach((t=>{const o=i?(0,X.j)(i,t):void 0,s=e&&(0,K.Xi)(o)?o:t;n.push(s)}));else if(e){const e=i?(0,X.j)(i,t):void 0,o=(0,K.Xi)(e)?e:t;n.push(o)}else n.push(t)})),n}get layers(){return(0,W.Mr)(c.Z.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.sources}set layers(e){(0,W.Mr)(c.Z.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.sources=e}get state(){return this.activeOperation?"active":this.view?.ready&&this.effectiveSources.length?"ready":"disabled"}activate(e){const{state:t}=this,i=e?.view||this.view,o=e?.sources||this.effectiveSources;if("disabled"===t||!i)return void c.Z.getLogger(this).warn("Unable to start selection operation.");"active"===t&&this.cancel();const n=new CustomEvent("before-activate",{cancelable:!0,detail:{toolName:e?.toolName??null}});if(this.emit("before-activate",n),n.defaultPrevented)return;const s={type:this.defaultOperationType,persistSelection:this.persistSelection,returnFeatureTitleFields:this.returnFeatureTitleFields,returnGeometry:this.returnGeometry,selectOnComplete:this.selectOnComplete,selectionManager:this.effectiveSelectionManager,...e,sources:o,view:i},r=new ye({...s});return this._operationHandlesGroup=(0,d.AL)([r.on("selection-change",(e=>this.emit("selection-change",e))),r.once("complete",(e=>this._onOperationComplete(e,s)))]),this._set("activeOperation",r),r}activateTool(e){this.cancel();const t=this._getToolOptions(e);if(t)return this.activate(t);c.Z.getLogger(this).warn("Unable to activate tool: unable to determine options.")}cancel(){this.activeOperation?.cancel(),this._set("activeOperation",null)}toggleTool(e){const{activeOperation:t}=this;if(t){const i=t.toolName;if(this.cancel(),i===e)return}return this.activateTool(e)}_onOperationComplete(e,t){this._operationHandlesGroup=(0,p.hw)(this._operationHandlesGroup),this._set("activeOperation",null),this.emit("complete",e),this.continuousSelectionEnabled&&!e.aborted&&this.activate(t)}_getToolOptions(e){return this.toolConfigs.find((t=>t.toolName===e))||("lasso"===e?this.defaultLassoToolOptions:"point"===e?this.defaultPointToolOptions:"rectangle"===e?this.defaultRectangleToolOptions:void 0)}};(0,l._)([(0,g.Cb)({readOnly:!0})],be.prototype,"activeOperation",void 0),(0,l._)([(0,g.Cb)()],be.prototype,"continuousSelectionEnabled",void 0),(0,l._)([(0,g.Cb)()],be.prototype,"defaultLassoToolOptions",void 0),(0,l._)([(0,g.Cb)()],be.prototype,"defaultOperationType",void 0),(0,l._)([(0,g.Cb)()],be.prototype,"defaultPointToolOptions",void 0),(0,l._)([(0,g.Cb)()],be.prototype,"defaultRectangleToolOptions",void 0),(0,l._)([(0,g.Cb)()],be.prototype,"effectiveSelectionManager",null),(0,l._)([(0,g.Cb)()],be.prototype,"effectiveSources",null),(0,l._)([(0,g.Cb)()],be.prototype,"layers",null),(0,l._)([(0,g.Cb)()],be.prototype,"layerViewPreferenceEnabled",void 0),(0,l._)([(0,g.Cb)()],be.prototype,"persistSelection",void 0),(0,l._)([(0,g.Cb)()],be.prototype,"selectionManager",void 0),(0,l._)([(0,g.Cb)()],be.prototype,"returnFeatureTitleFields",void 0),(0,l._)([(0,g.Cb)()],be.prototype,"returnGeometry",void 0),(0,l._)([(0,g.Cb)()],be.prototype,"selectOnComplete",void 0),(0,l._)([(0,g.Cb)()],be.prototype,"sources",void 0),(0,l._)([(0,g.Cb)({readOnly:!0})],be.prototype,"state",null),(0,l._)([(0,g.Cb)()],be.prototype,"toolConfigs",void 0),(0,l._)([(0,g.Cb)()],be.prototype,"view",void 0),be=(0,l._)([(0,y.j)("esri.widgets.support.SelectionToolbar.SelectionToolbarViewModel")],be);const me=be;let ve=class extends _.Z{constructor(e){super(e),this.chip=!0,this.lassoTool=!0,this.pan=!0,this.pointTool=!0,this.rectangleTool=!0}};(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],ve.prototype,"chip",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],ve.prototype,"lassoTool",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],ve.prototype,"pan",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],ve.prototype,"pointTool",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],ve.prototype,"rectangleTool",void 0),ve=(0,l._)([(0,y.j)("esri.widgets.support.SelectionToolbar.VisibleElements")],ve);const _e=ve;var fe=i(40030);const we="esri-selection-toolbar",Ce={base:we,container:`${we}__container`,toolButton:`${we}__tool-button`};let Te=class extends m.Z{constructor(e,t){super(e,t),this._viewModelHandlesGroup=null,this.disabled=!1,this.layout="horizontal",this.messages=null,this.scale="s",this.viewModel=new me,this.visibleElements=new _e}initialize(){this._viewModelHandlesGroup=(0,d.AL)([(0,h.on)((()=>this.viewModel),"before-activate",(e=>this.emit("before-activate",e))),(0,h.on)((()=>this.viewModel),"complete",(e=>this.emit("complete",e))),(0,h.on)((()=>this.viewModel),"selection-change",(e=>this.emit("selection-change",e)))])}destroy(){this._viewModelHandlesGroup=(0,p.hw)(this._viewModelHandlesGroup)}loadDependencies(){return(0,N.h)({action:()=>Promise.all([i.e(58268),i.e(55001),i.e(11030)]).then(i.bind(i,11030)),"action-bar":()=>Promise.all([i.e(58268),i.e(62737),i.e(55001),i.e(71823),i.e(79767),i.e(94568)]).then(i.bind(i,4649)),chip:()=>Promise.all([i.e(58268),i.e(70316),i.e(40833)]).then(i.bind(i,70316))})}get _effectiveDisabled(){return this.disabled||"disabled"===this.state}get activeOperation(){return this.viewModel.activeOperation}get continuousSelectionEnabled(){return this.viewModel.continuousSelectionEnabled}set continuousSelectionEnabled(e){this.viewModel.continuousSelectionEnabled=e}get defaultLassoToolOptions(){return this.viewModel.defaultLassoToolOptions}set defaultLassoToolOptions(e){this.viewModel.defaultLassoToolOptions=e}get defaultOperationType(){return this.viewModel.defaultOperationType}set defaultOperationType(e){this.viewModel.defaultOperationType=e}get defaultPointToolOptions(){return this.viewModel.defaultPointToolOptions}set defaultPointToolOptions(e){this.viewModel.defaultPointToolOptions=e}get defaultRectangleToolOptions(){return this.viewModel.defaultRectangleToolOptions}set defaultRectangleToolOptions(e){this.viewModel.defaultRectangleToolOptions=e}get effectiveSelectionManager(){return this.viewModel.effectiveSelectionManager}get effectiveSources(){return this.viewModel.effectiveSources}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get layers(){return(0,W.Mr)(c.Z.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.viewModel.sources}set layers(e){(0,W.Mr)(c.Z.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.viewModel.sources=e}get layerViewPreferenceEnabled(){return this.viewModel.layerViewPreferenceEnabled}set layerViewPreferenceEnabled(e){this.viewModel.layerViewPreferenceEnabled=e}get persistSelection(){return this.viewModel.persistSelection}set persistSelection(e){this.viewModel.persistSelection=e}get returnFeatureTitleFields(){return this.viewModel.returnFeatureTitleFields}set returnFeatureTitleFields(e){this.viewModel.returnFeatureTitleFields=e}get returnGeometry(){return this.viewModel.returnGeometry}set returnGeometry(e){this.viewModel.returnGeometry=e}get selectOnComplete(){return this.viewModel.selectOnComplete}set selectOnComplete(e){this.viewModel.selectOnComplete=e}get selectionManager(){return this.viewModel.selectionManager}set selectionManager(e){this.viewModel.selectionManager=e}get state(){return this.viewModel.state}get sources(){return this.viewModel.sources}set sources(e){this.viewModel.sources=e}get toolConfigs(){return this.viewModel.toolConfigs}set toolConfigs(e){this.viewModel.toolConfigs=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visibleToolCount(){const{visibleElements:e}=this;return this.toolConfigs.length+(e.lassoTool?1:0)+(e.rectangleTool?1:0)}activate(e){if(this.cancel(),!this._effectiveDisabled)return this.viewModel.activate(e)}activateTool(e){if(!this._effectiveDisabled)return this.viewModel.activateTool(e)}cancel(){this.viewModel.cancel()}toggleTool(e){if(!this._effectiveDisabled)return this.viewModel.toggleTool(e)}render(){return(0,Z.u)("div",{"aria-label":this.label,class:this.classes(Ce.base,Y.z.widget)},(0,Z.u)("div",{class:Ce.container},(0,Z.u)("calcite-action-bar",{expandDisabled:!0,layout:"horizontal",scale:this.scale},this._renderDefaultTools(),this._renderCustomTools(),this._renderChip())))}_renderDefaultTools(){return[this._renderPanAction(),this._renderPointTool(),this._renderRectangleTool(),this._renderLassoTool()]}_renderPanAction(){if(!this.visibleElements.pan)return;const e=this.messages.pan,t=`${this.id}-tool-pan`;return this._renderAction({active:!this.activeOperation,disabled:this._effectiveDisabled,icon:"pan",id:t,key:t,onclick:()=>this.cancel(),text:e,title:e})}_renderChip(){if(!this.visibleElements.chip)return;const{effectiveSelectionManager:e}=this,t=e?.count??0,i=(0,fe.uf)(t);return(0,Z.u)("calcite-chip",{appearance:"outline",closable:t>0,closed:0===t,disabled:this._effectiveDisabled||0===t,label:i,scale:this.scale,slot:"actions-end",title:this.messages.clearSelection,onCalciteChipClose:()=>e?.clear()},i)}_renderCustomTools(){return this.toolConfigs.map((({toolName:e,icon:t})=>this._renderToolWithTooltip(e,t)))}_renderPointTool(){if(this.visibleElements.pointTool)return this._renderToolWithTooltip("point","selection-set",this.messages.selectByPoint)}_renderLassoTool(){if(this.visibleElements.lassoTool)return this._renderToolWithTooltip("lasso","lasso-select",this.messages.selectByLasso)}_renderRectangleTool(){if(this.visibleElements.rectangleTool)return this._renderToolWithTooltip("rectangle","cursor-marquee",this.messages.selectByRectangle)}_renderToolWithTooltip(e,t,i=e){const o=`${this.id}-tool-${e}`;return this._renderAction({active:this.activeOperation?.toolName===e,disabled:this._effectiveDisabled,icon:t||"selection",id:o,key:o,onclick:()=>this.toggleTool(e),text:i,title:i})}_renderAction(e){return(0,Z.u)("calcite-action",{...e,bind:this,class:Ce.toolButton,scale:this.scale})}};(0,l._)([(0,g.Cb)()],Te.prototype,"_effectiveDisabled",null),(0,l._)([(0,g.Cb)()],Te.prototype,"activeOperation",null),(0,l._)([(0,g.Cb)()],Te.prototype,"continuousSelectionEnabled",null),(0,l._)([(0,g.Cb)()],Te.prototype,"defaultLassoToolOptions",null),(0,l._)([(0,g.Cb)()],Te.prototype,"defaultOperationType",null),(0,l._)([(0,g.Cb)()],Te.prototype,"defaultPointToolOptions",null),(0,l._)([(0,g.Cb)()],Te.prototype,"defaultRectangleToolOptions",null),(0,l._)([(0,g.Cb)()],Te.prototype,"disabled",void 0),(0,l._)([(0,g.Cb)()],Te.prototype,"effectiveSelectionManager",null),(0,l._)([(0,g.Cb)()],Te.prototype,"effectiveSources",null),(0,l._)([(0,g.Cb)()],Te.prototype,"label",null),(0,l._)([(0,g.Cb)()],Te.prototype,"layers",null),(0,l._)([(0,g.Cb)()],Te.prototype,"layerViewPreferenceEnabled",null),(0,l._)([(0,g.Cb)()],Te.prototype,"layout",void 0),(0,l._)([(0,g.Cb)(),(0,$.H)("esri/widgets/support/SelectionToolbar/t9n/SelectionToolbar")],Te.prototype,"messages",void 0),(0,l._)([(0,g.Cb)()],Te.prototype,"persistSelection",null),(0,l._)([(0,g.Cb)()],Te.prototype,"returnFeatureTitleFields",null),(0,l._)([(0,g.Cb)()],Te.prototype,"returnGeometry",null),(0,l._)([(0,g.Cb)()],Te.prototype,"selectOnComplete",null),(0,l._)([(0,g.Cb)()],Te.prototype,"scale",void 0),(0,l._)([(0,g.Cb)()],Te.prototype,"selectionManager",null),(0,l._)([(0,g.Cb)()],Te.prototype,"state",null),(0,l._)([(0,g.Cb)()],Te.prototype,"sources",null),(0,l._)([(0,g.Cb)()],Te.prototype,"toolConfigs",null),(0,l._)([(0,g.Cb)()],Te.prototype,"view",null),(0,l._)([(0,g.Cb)()],Te.prototype,"viewModel",void 0),(0,l._)([(0,g.Cb)({type:_e,nonNullable:!0})],Te.prototype,"visibleElements",void 0),(0,l._)([(0,g.Cb)()],Te.prototype,"visibleToolCount",null),Te=(0,l._)([(0,y.j)("esri.widgets.support.SelectionToolbar")],Te);const Se=Te;var Me=i(41943),Oe=i(31066),Ee=i(82504);let Pe=class extends _.Z{constructor(e){super(e),this.directionModePicker=!1,this.header=!1,this.labelsToggle=!0,this.tooltipsToggle=!0}};(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],Pe.prototype,"directionModePicker",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],Pe.prototype,"header",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],Pe.prototype,"labelsToggle",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],Pe.prototype,"tooltipsToggle",void 0),Pe=(0,l._)([(0,y.j)("esri.widgets.support.SketchTooltipControls.VisibleElements")],Pe);const xe=Pe,Ie="esri-sketch-tooltip-controls",Le={base:Ie,block:`${Ie}__block`,blockContent:`${Ie}__block-content`,radioButtonLabelWrapper:`${Ie}__radio-button-label-wrapper`};let ke=class extends m.Z{constructor(e,t){super(e,t),this.viewModel=null,this.visibleElements=new xe,this.sketchOptions=new Me.Z,this.viewType=void 0,this._onTooltipsEnabledChange=e=>{this.sketchOptions.tooltips.enabled=e},this._onLabelsEnabledChange=e=>{this.sketchOptions.labels.enabled=e},this._onDirectionModeChange=e=>{this.sketchOptions.values.directionMode=e.currentTarget.selectedItem.value}}loadDependencies(){return Promise.all([(0,N.h)({block:()=>Promise.all([i.e(58268),i.e(62737),i.e(55001),i.e(71823),i.e(79767),i.e(17466)]).then(i.bind(i,79429)),label:()=>Promise.all([i.e(58268),i.e(36650)]).then(i.bind(i,36650)),icon:()=>Promise.all([i.e(58268),i.e(4204)]).then(i.bind(i,4204)),"radio-button":()=>Promise.all([i.e(58268),i.e(17345),i.e(76013)]).then(i.bind(i,76013)),"radio-button-group":()=>Promise.all([i.e(58268),i.e(27859)]).then(i.bind(i,27859))}),(0,Ee.n)()])}render(){const{label:e,visibleElements:t}=this,i=this._renderContent();return(0,Z.u)("div",{"aria-label":e,class:this.classes(Le.base,Y.z.widget)},i?(0,Z.u)("calcite-block",{class:Le.block,expanded:!0,heading:t.header?this.label:"",key:"content-block",label:this.label},(0,Z.u)("div",{class:Le.blockContent,key:"content"},i)):void 0)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}_renderContent(){const{visibleElements:e,viewType:t}=this,i=[e.tooltipsToggle?this._renderTooltipsToggle():null,e.labelsToggle&&"2d"!==t?this._renderLabelsToggle():null,e.directionModePicker?this._renderDirectionModePicker():null].filter(a.pC);return 0===i.length?null:i}_renderTooltipsToggle(){const{messages:e,sketchOptions:t}=this;return(0,Z.u)(Ee.t,{checked:t.tooltips.effectiveEnabled,hint:e.tooltipsToggleHint,key:`${this.id}__tooltips`,label:e.tooltipsToggle,onChange:this._onTooltipsEnabledChange})}_renderLabelsToggle(){const{messages:e,sketchOptions:t}=this;return(0,Z.u)(Ee.t,{checked:t.labels.enabled,hint:e.labelsToggleHint,key:`${this.id}__labels`,label:e.labelsToggle,onChange:this._onLabelsEnabledChange})}_renderDirectionModePicker(){const{messages:e,sketchOptions:t}=this,{directionMode:i}=t.values;return(0,Z.u)("calcite-label",{key:"direction-mode",layout:"default",scale:"s"},e.directionModePicker,(0,Z.u)("calcite-radio-button-group",{key:"radio-button-group",layout:"horizontal",name:this.id,scale:"s",value:i,onCalciteRadioButtonGroupChange:this._onDirectionModeChange},this._renderDirectionModeOption("relative",i,e.directionModeRelative),this._renderDirectionModeOption("absolute",i,e.directionModeAbsolute)))}_renderDirectionModeOption(e,t,i){return(0,Z.u)("calcite-label",{key:e,layout:"inline",scale:"s"},(0,Z.u)("calcite-radio-button",{checked:e===t,scale:"s",value:e}),(0,Z.u)("div",{class:Le.radioButtonLabelWrapper,key:"label-wrapper"},(0,Z.u)("calcite-icon",{icon:Oe.M[e],scale:"s"}),i))}};(0,l._)([(0,g.Cb)()],ke.prototype,"label",null),(0,l._)([(0,g.Cb)({type:xe,nonNullable:!0})],ke.prototype,"visibleElements",void 0),(0,l._)([(0,g.Cb)(),(0,$.H)("esri/widgets/support/SketchTooltipControls/t9n/SketchTooltipControls")],ke.prototype,"messages",void 0),(0,l._)([(0,g.Cb)({nonNullable:!0,type:Me.Z})],ke.prototype,"sketchOptions",void 0),(0,l._)([(0,g.Cb)({type:String})],ke.prototype,"viewType",void 0),ke=(0,l._)([(0,y.j)("esri.widgets.support.SketchTooltipControls")],ke);const Fe=ke;var Ze=i(67908),De=i(88194),Re=i(676),Ne=i(81972),$e=i(5221),Ae=i(94027);const Be=e=>Ge(e)||Ve(e),Ge=e=>{if(!("type"in e))return!1;switch(e.type){case"feature":case"geojson":case"csv":case"graphics":case"wfs":case"map-notes":case"oriented-imagery":case"scene":case"building-scene":case"subtype-sublayer":return!0;default:return!1}},Ve=e=>{const t=(0,$e.Ff)(e);if(null!=t&&e.hasOwnProperty(t)&&null!=e[t])for(const i of e[t])if(Be(i))return!0;return!1},ze=(e,t)=>null!=t&&null!=e&&(t.test(e.title)?"self":!!e.children.some((e=>!1!==ze(e,t)))&&"children");var je,He=i(48804);let Ue=je=class extends He.Z{constructor(e){super(e),this.children=new B.Z,this.parent=null}get enabled(){const{children:e}=this;if(0===e.length)return null!=this.featureSource&&this.featureSource.enabled?"enabled":"disabled";let t=!1,i=!1;for(const o of e){if("indeterminate"===o.enabled)return o.enabled;if("enabled"===o.enabled?t=!0:"disabled"===o.enabled&&(i=!0),i&&t)return"indeterminate"}return i?"disabled":"enabled"}get childLayerIds(){return this.children.toArray().flatMap((e=>[e.layer?.id,...e.childLayerIds]))}get featureSource(){const{layer:e,getFeatureSnappingSources:t}=this;return t().find((t=>t.layer===e))}_initializeChildLayers(e){if(!e)return;const t=e.filter(Be);super._initializeChildLayers(t)}_createChildItems(e){return e.map((e=>(0,$e.gF)(e)?new je({layer:e,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):null)).filter(a.pC).reverse()}};(0,l._)([(0,g.Cb)()],Ue.prototype,"enabled",null),(0,l._)([(0,g.Cb)()],Ue.prototype,"children",void 0),(0,l._)([(0,g.Cb)()],Ue.prototype,"childLayerIds",null),(0,l._)([(0,g.Cb)()],Ue.prototype,"featureSource",null),(0,l._)([(0,g.Cb)({constructOnly:!0})],Ue.prototype,"getFeatureSnappingSources",void 0),(0,l._)([(0,g.Cb)()],Ue.prototype,"parent",void 0),Ue=je=(0,l._)([(0,y.j)("esri.widgets.support.SnappingControls.SnappingListItem")],Ue);let We=class extends Ae.Z{constructor(){super(...arguments),this.featureSnappingSources=new B.Z}get operationalItemsFlat(){return this.operationalItems.flatten((e=>e.children))}get selectableItems(){return this.operationalItemsFlat.filter((e=>!e.children?.length))}_compileList(){const e=this.view?.map?.layers;if(!e)return;const t=e.filter(Be);this._watchLayersListMode(t);const i=this._getViewableLayers(t);i?.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}_createListItem(e){return new Ue({layer:e,view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})}};(0,l._)([(0,g.Cb)()],We.prototype,"featureSnappingSources",void 0),(0,l._)([(0,g.Cb)()],We.prototype,"operationalItems",void 0),(0,l._)([(0,g.Cb)()],We.prototype,"operationalItemsFlat",null),(0,l._)([(0,g.Cb)()],We.prototype,"selectableItems",null),We=(0,l._)([(0,y.j)("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],We);let Ye=class extends _.Z{constructor(e){super(e),this.layerListViewModel=new We,this.snappingOptions=new Ne.Z,this.view=null}initialize(){this.addHandles([(0,h.YP)((()=>({viewModel:this.layerListViewModel,view:this.view})),(({viewModel:e,view:t})=>{e.view=t}),h.nn),(0,h.YP)((()=>({viewModel:this.layerListViewModel,sources:this.snappingOptions?.featureSources})),(({viewModel:e,sources:t})=>{e.featureSnappingSources=t}),h.nn)])}get allLayersEnabled(){return(this.layerListViewModel?.selectableItems??[]).every((e=>"enabled"===e.enabled))}get allLayersDisabled(){return(this.layerListViewModel?.selectableItems??[]).every((e=>!e.enabled))}get layersEnabledCount(){return this.layerListViewModel?.selectableItems?.filter((e=>"enabled"===e.enabled)).length??0}get state(){return this.snappingOptions?"ready":"disabled"}toggleSnappingForLayers(e,t){e?.forEach((e=>t?this.enableSnappingForLayer(e):this.disableSnappingForLayer(e)))}toggleSnappingForAllLayers(e){this.layerListViewModel.selectableItems.forEach((({layer:t})=>{const i=t?.id;e?this.enableSnappingForLayer(i):this.disableSnappingForLayer(i)}))}enableSnappingForLayer(e){const t=this._findSnappingSourceForLayer(e)??this._makeSnappingSourceForLayer(e);t&&(t.enabled=!0)}disableSnappingForLayer(e){const t=this._findSnappingSourceForLayer(e);t&&(t.enabled=!1)}updateEnabledFeatureSources(e){for(const t of this.snappingOptions.featureSources)(0,$e.gF)(t.layer)&&(t.enabled=e.includes(t.layer.id))}_findSnappingSourceForLayer(e){return this.snappingOptions.featureSources.find((t=>t.layer.id===e))}_makeSnappingSourceForLayer(e){const t=this.layerListViewModel.operationalItemsFlat.find((t=>t.layer?.id===e))?.layer;if(!t)throw new De.Z("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${e} because no such layer was found in the view`);if("group"===t.type)return;const i=new Re.Z({layer:t});return this.snappingOptions.featureSources.add(i),i}};(0,l._)([(0,g.Cb)()],Ye.prototype,"allLayersEnabled",null),(0,l._)([(0,g.Cb)()],Ye.prototype,"allLayersDisabled",null),(0,l._)([(0,g.Cb)({constructOnly:!0})],Ye.prototype,"layerListViewModel",void 0),(0,l._)([(0,g.Cb)()],Ye.prototype,"layersEnabledCount",null),(0,l._)([(0,g.Cb)({type:Ne.Z,nonNullable:!0})],Ye.prototype,"snappingOptions",void 0),(0,l._)([(0,g.Cb)()],Ye.prototype,"state",null),(0,l._)([(0,g.Cb)()],Ye.prototype,"view",void 0),Ye=(0,l._)([(0,y.j)("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],Ye);const qe=Ye,Je="esri-snapping-controls",Xe={base:Je,container:`${Je}__container`,toggleBlock:`${Je}__toggle-block`,layerListBlock:`${Je}__layer-list-block`,layerList:`${Je}__layer-list`,layerListFilter:`${Je}__layer-list__filter`,layerListButton:`${Je}__layer-list__button`,layerListItem:`${Je}__layer-list__item`,layerListGroup:`${Je}__layer-list__group`,nestedContainer:`${Je}__nested-container`};let Ke=class extends m.Z{constructor(e,t){super(e,t),this._defaultViewModel=null,this._layerListFilter=null,this._gridLoadTask=null,this.layerListOpen=!0,this.gridOptionsOpen=!1,this.messages=null,this.messagesCommon=null,this.snappingManager=null,this.visibleElements=new C,this._enableSnappingSwitchChange=e=>{this.snappingOptions.enabled=e},this._featureEnabledSwitchChange=e=>{this.snappingOptions.featureEnabled=e},this._gridEnabledSwitchChange=e=>{this.snappingOptions.gridEnabled=e,e&&this._startLoadGrid()},this._selfEnabledSwitchChange=e=>{this.snappingOptions.selfEnabled=e},this._onToggleLayersButtonClick=e=>{this.viewModel.toggleSnappingForAllLayers(!this.viewModel.allLayersEnabled),(0,F.kW)(e.target)};const{snappingOptions:i,view:o,viewModel:n}=e;this.viewModel=n??(this._defaultViewModel=new qe({snappingOptions:i,view:o}))}normalizeCtorArgs(e){const{snappingOptions:t,view:i,viewModel:o,...n}=e;return n}destroy(){this.viewModel!==this._defaultViewModel&&(this._defaultViewModel=(0,p.SC)(this._defaultViewModel))}loadDependencies(){return Promise.all([(0,N.h)({block:()=>Promise.all([i.e(58268),i.e(62737),i.e(55001),i.e(71823),i.e(79767),i.e(17466)]).then(i.bind(i,79429)),button:()=>Promise.all([i.e(58268),i.e(55001),i.e(17345),i.e(61637)]).then(i.bind(i,61637)),input:()=>Promise.all([i.e(58268),i.e(17345),i.e(26041),i.e(75014),i.e(68355)]).then(i.bind(i,75014)),list:()=>Promise.all([i.e(58268),i.e(55001),i.e(17345),i.e(26041),i.e(75014),i.e(29749),i.e(52532)]).then(i.bind(i,29749)),"list-item":()=>Promise.all([i.e(58268),i.e(62737),i.e(55001),i.e(96326),i.e(13206)]).then(i.bind(i,96326)),checkbox:()=>Promise.all([i.e(58268),i.e(17345),i.e(69397)]).then(i.bind(i,69397)),loader:()=>i.e(55001).then(i.bind(i,55001))}),(0,Ee.n)()])}initialize(){this.addHandles((0,h.YP)((()=>"2d"===this.view?.type&&!!this.view.grid),(e=>{this.visibleElements.gridControls&&(this.snappingOptions.gridEnabled=e)})))}get _openAndReady(){return this.gridOptionsOpen&&this.snappingOptions.gridEnabled&&this.snappingOptions.enabled}get icon(){return"snap-to-point"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set viewModel(e){e!==this._get("viewModel")&&(null!=this._defaultViewModel&&this._defaultViewModel===e||(this._defaultViewModel=(0,p.SC)(this._defaultViewModel)),this._set("viewModel",e))}render(){const{label:e}=this;return(0,Z.u)("div",{"aria-label":e,class:this.classes(Xe.base,Y.z.widget)},(0,Z.u)("div",{class:Xe.container},this._renderContent()))}_renderContent(){return[this._renderToggles(),this._renderLayerList(),"2d"===this.view?.type&&this.visibleElements.gridControls?this._renderGridOptions():null]}_renderToggles(){const{visibleElements:e,view:t}=this,i=[e.selfEnabledToggle?this._renderSelfEnabledToggle():null,e.featureEnabledToggle?this._renderFeatureEnabledToggle():null,e.gridEnabledToggle&&"2d"===t?.type?this._renderGridEnabledToggle():null].filter(a.pC),o=[e.enabledToggle?this._renderEnabledToggle():null,i.length>0?(0,Z.u)("div",{class:Xe.nestedContainer},i):null].filter(a.pC);return 0===o.length?null:(0,Z.u)("calcite-block",{class:Xe.toggleBlock,expanded:!0,heading:e.header?this.label:"",key:"toggle-block",label:this.label},o)}_renderEnabledToggle(){return(0,Z.u)(Ee.t,{checked:this.viewModel.snappingOptions.enabled,disabled:this._enabledToggleDisabled,key:`${this.id}__enabled-toggle`,label:this.messages.enableSnapping,onChange:this._enableSnappingSwitchChange})}_renderSelfEnabledToggle(){return(0,Z.u)(Ee.t,{checked:this.viewModel.snappingOptions.selfEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__self-enabled-toggle`,label:this.messages.geometryGuides,onChange:this._selfEnabledSwitchChange})}_renderFeatureEnabledToggle(){return(0,Z.u)(Ee.t,{checked:this.viewModel.snappingOptions.featureEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__feature-enabled-toggle`,label:this.messages.featureToFeature,onChange:this._featureEnabledSwitchChange})}_renderGridEnabledToggle(){return(0,Z.u)(Ee.t,{checked:this.viewModel.snappingOptions.gridEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__grid-enabled-toggle`,label:this.messages.grid,onChange:this._gridEnabledSwitchChange})}_renderLayerList(){if(!this.visibleElements.layerList)return null;const{messages:e,viewModel:t}=this,i=t.layerListViewModel.operationalItems.length>9?(0,Z.u)("calcite-input",{class:Xe.layerListFilter,clearable:!0,placeholder:e?.searchLayers,onCalciteInputInput:({currentTarget:{value:e}})=>{this._layerListFilter=""===e?null:new RegExp(e,"i")}}):null,o=this._secondaryElementsDisabled,n=this.layerListOpen&&!o,s=t.layerListViewModel.operationalItems?.find((e=>!!e.children.length));return(0,Z.u)("calcite-block",{class:Xe.layerListBlock,collapsible:!0,disabled:this._secondaryElementsDisabled,expanded:n,heading:e.snappingLayers,key:"list-block",onCalciteBlockToggle:e=>this.layerListOpen=e.currentTarget.expanded},i,this._renderToggleLayersButton(),(0,Z.u)("calcite-list",{class:Xe.layerList,displayMode:s?"nested":"flat",label:e?.snappingLayers,selectionMode:"none"},this._renderLayerListItemCollection(t.layerListViewModel.operationalItems)))}_renderGridOptions(){const{view:e,visibleElements:t,snappingManager:i,snappingOptions:o,_openAndReady:n}=this,{gridEnabled:s,enabled:r}=o;(n||"2d"===e?.type&&e.grid)&&this._startLoadGrid();const l=this._gridLoadTask?.value,a=l&&"2d"===e?.type&&(0,Z.u)(l,{snappingManager:i,snappingOptions:o,view:e,visibleElements:t.gridControlsElements});return(0,Z.u)("calcite-block",{class:Xe.layerListBlock,collapsible:!0,disabled:!s||!r,expanded:n,heading:this.messages.gridOptionsHeading,key:"grid-block",onCalciteBlockClose:()=>this.gridOptionsOpen=!1,onCalciteBlockOpen:()=>this.gridOptionsOpen=!0},a??(0,Z.u)("calcite-loader",{label:this.messagesCommon.loading,scale:"s",text:this.messagesCommon.loading}))}async _startLoadGrid(){!this._gridLoadTask&&this.visibleElements.gridControls&&"2d"===this.view?.type&&(this._gridLoadTask=(0,Q.vr)((async()=>(await Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(18208),i.e(1663),i.e(52846),i.e(65204),i.e(72997),i.e(15335),i.e(28874),i.e(32100),i.e(74851)]).then(i.bind(i,74851))).default)))}_renderLayerListItemCollection(e){const t=this._layerListFilter;return e.map((e=>{switch(t?ze(e,t):null){case"children":{const i=e.children.filter((e=>!1!==ze(e,t)));return this._renderLayerListItemGroup(e,i)}case"self":case null:return this._renderLayerListItemOrGroup(e);case!1:return"self"===ze(e.parent,t)?this._renderLayerListItemOrGroup(e):null}})).toArray().filter(a.pC)}_renderToggleLayersButton(){if(!this.visibleElements.layerListToggleLayersButton)return null;const{viewModel:{allLayersEnabled:e},messages:t}=this,i=e?t.disableAllLayers:t.enableAllLayers;return(0,Z.u)("calcite-button",{appearance:"transparent",class:Xe.layerListButton,label:i,name:"layer-toggle",onclick:this._onToggleLayersButtonClick},i)}_renderLayerListItemOrGroup(e){if(e.children.length)return this._renderLayerListItemGroup(e);const{messages:{untitledLayer:t}}=this,i=e.title||t,o=()=>{this.viewModel.toggleSnappingForLayers([e.layer?.id],"enabled"!==e.enabled)};return(0,Z.u)("calcite-list-item",{class:Xe.layerListItem,key:`${this.id}-list-item-${e.uid}`,label:i,onCalciteListItemSelect:e=>{e.stopPropagation(),o()}},(0,Z.u)("calcite-checkbox",{checked:"enabled"===e.enabled,slot:"actions-start",onCalciteCheckboxChange:o}))}_renderLayerListItemGroup(e,t){const{messages:i}=this,{children:o,title:n}=e,s=n||i.untitledLayer,r=n&&""!==n?n:(0,Ze.D)(),l=!!t?.length,a=t??o,d=()=>{this.viewModel.toggleSnappingForLayers(e.childLayerIds,"enabled"!==e.enabled)},c=a?.find((e=>!!e.children.length));return(0,Z.u)("calcite-list-item",{class:Xe.layerListGroup,expanded:l,key:r,label:s,onCalciteListItemSelect:e=>{e.stopPropagation(),d()}},(0,Z.u)("calcite-checkbox",{checked:"enabled"===e.enabled,indeterminate:"indeterminate"===e.enabled,slot:"actions-start",onCalciteCheckboxChange:d}),(0,Z.u)("calcite-list",{displayMode:c?"nested":"flat",label:i?.snappingLayers,selectionMode:"none"},this._renderLayerListItemCollection(a)))}get _enabledToggleDisabled(){const e=this.snappingOptions;return e.enabledToggled||e.forceDisabled}get _secondaryElementsDisabled(){return this._enabledToggleDisabled||!this.snappingOptions.enabled}};(0,l._)([(0,g.Cb)()],Ke.prototype,"_defaultViewModel",void 0),(0,l._)([(0,g.Cb)()],Ke.prototype,"_layerListFilter",void 0),(0,l._)([(0,g.Cb)()],Ke.prototype,"_gridLoadTask",void 0),(0,l._)([(0,g.Cb)()],Ke.prototype,"_openAndReady",null),(0,l._)([(0,g.Cb)()],Ke.prototype,"label",null),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],Ke.prototype,"layerListOpen",void 0),(0,l._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],Ke.prototype,"gridOptionsOpen",void 0),(0,l._)([(0,g.Cb)(),(0,$.H)("esri/widgets/support/SnappingControls/t9n/SnappingControls")],Ke.prototype,"messages",void 0),(0,l._)([(0,g.Cb)(),(0,$.H)("esri/t9n/common")],Ke.prototype,"messagesCommon",void 0),(0,l._)([(0,g.Cb)()],Ke.prototype,"snappingOptions",null),(0,l._)([(0,g.Cb)()],Ke.prototype,"snappingManager",void 0),(0,l._)([(0,g.Cb)()],Ke.prototype,"view",null),(0,l._)([(0,g.Cb)()],Ke.prototype,"viewModel",null),(0,l._)([(0,g.Cb)({type:C,nonNullable:!0})],Ke.prototype,"visibleElements",void 0),(0,l._)([(0,g.Cb)()],Ke.prototype,"_enabledToggleDisabled",null),(0,l._)([(0,g.Cb)()],Ke.prototype,"_secondaryElementsDisabled",null),Ke=(0,l._)([(0,y.j)("esri.widgets.support.SnappingControls")],Ke);const Qe=Ke;var et=i(29629),tt=i(37964);const it="esri-sketch",ot={base:it,vertical:`${it}--vertical`,docked:`${it}-bar`,floating:`${it}-pad`,chipHorizontal:`${it}__selection-count-chip--horizontal`,chipVertical:`${it}__selection-count-chip--vertical`,chipVerticalSmall:`${it}__selection-count-chip--vertical--s`,popoverWrapper:`${it}__popover-wrapper`},nt={point:"pin",polyline:"line",polygon:"polygon",rectangle:"rectangle",circle:"circle",multipoint:"pins",mesh:"i3d-building",freehandPolygon:"freehand-area",freehandPolyline:"freehand"};let st=class extends m.Z{constructor(e,t){super(e,t),this._activeCustomToolOptions=null,this._selectionToolbar=null,this._viewModelHandlesGroup=null,this.availableCreateTools=["point","polyline","polygon","rectangle","circle"],this.customToolOptions=null,this.customActions=null,this.toolbarKind="floating",this.contextualToolLocation="separate",this.groupCollapsePriorities=null,this.groupAllowCollapseOptions=null,this.messages=null,this.messagesCommon=null,this.visibleElements=new M,this._defaultViewModel=null,this._calcitePopoverReferenceElement=null,this._relativeLocation="top",this._popoverOpen=!1,this._activateCreateTool=this._activateCreateTool.bind(this),this.viewModel=e?.viewModel||(this._defaultViewModel=new v.Z({creationMode:e?.creationMode??"continuous"}))}initialize(){const{layer:e,view:t}=this,i="2d"===t?.type,o=new Se({persistSelection:!1,visibleElements:new _e({chip:!1,pan:!1,pointTool:!1,lassoTool:i,rectangleTool:i}),view:t,sources:e?[e]:null,scale:this.scale});this.addHandles([(0,h.YP)((()=>this.viewModel),(e=>{this._viewModelHandlesGroup=(0,p.hw)(this._viewModelHandlesGroup),e&&(this._viewModelHandlesGroup=(0,d.AL)([e.on("create",(()=>this.scheduleRender())),e.on("update",(()=>this.scheduleRender())),e.on("delete",(e=>this.emit("delete",e))),e.on("undo",(()=>this.scheduleRender())),e.on("redo",(()=>this.scheduleRender())),(0,h.YP)((()=>e.layer),(e=>{this._selectionToolbar&&(this._selectionToolbar.sources=e?[e]:null)})),(0,h.YP)((()=>e.view),(e=>{this._selectionToolbar&&(this._selectionToolbar.view=e)})),(0,h.YP)((()=>e.state),(()=>this.notifyChange("state")))]))}),h.tX),(0,h.gx)((()=>o.activeOperation),(()=>this.viewModel.cancel())),o.on("complete",(e=>this._onSelectionOperationComplete(e))),(0,h.YP)((()=>{const{view:e,visibleElements:{selectionTools:t}}=this;return{lassoTool:"3d"!==e?.type&&!!t?.["lasso-selection"],rectangleTool:"3d"!==e?.type&&!!t?.["rectangle-selection"]}}),(e=>{Object.assign(o.visibleElements,e)}),h.tX)]),this._selectionToolbar=o}loadDependencies(){return(0,N.h)({action:()=>Promise.all([i.e(58268),i.e(55001),i.e(11030)]).then(i.bind(i,11030)),chip:()=>Promise.all([i.e(58268),i.e(70316),i.e(40833)]).then(i.bind(i,70316)),popover:()=>Promise.all([i.e(58268),i.e(62737),i.e(55001),i.e(71823),i.e(24006)]).then(i.bind(i,24006))})}destroy(){this._selectionToolbar?.destroy(),this._viewModelHandlesGroup=(0,p.hw)(this._viewModelHandlesGroup)}get activeTool(){const e=this._selectionToolbar?.activeOperation;if(e)switch(e.toolName){case"lasso":return"lasso-selection";case"rectangle":return"rectangle-selection";case"default":return"custom-selection"}const t=this._effectiveAvailableCreateTools,{activeTool:i,activeCreateToolDrawMode:o}=this.viewModel;return"polygon"===i&&"freehand"===o&&t?.includes("freehandPolygon")?"freehandPolygon":"polyline"===i&&"freehand"===o&&t?.includes("freehandPolyline")?"freehandPolyline":this.viewModel.activeTool}get activeTooltip(){return this.viewModel.activeTooltip}get createGraphic(){return this.viewModel.createGraphic}get creationMode(){return this.viewModel.creationMode}set creationMode(e){this.viewModel.creationMode=e}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(e){this.viewModel.defaultCreateOptions=e}get defaultUpdateOptions(){return this.viewModel.defaultUpdateOptions}set defaultUpdateOptions(e){this.viewModel.defaultUpdateOptions=e}get icon(){return"pencil"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(e){this.viewModel.labelOptions=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}set layout(e){this._set("layout",e),this._selectionToolbar&&(this._selectionToolbar.layout=e)}set scale(e){this._set("scale",e),this._selectionToolbar&&(this._selectionToolbar.scale=e)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get state(){return this._selectionToolbar?.activeOperation?"active":this.viewModel.state}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(e){this.viewModel.tooltipOptions=e}get updateGraphics(){return this.viewModel.updateGraphics}get valueOptions(){return this.viewModel.valueOptions}set valueOptions(e){this.viewModel.valueOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set viewModel(e){const t=this._get("viewModel");e!==t&&(t&&t===this._defaultViewModel&&(0,p.SC)(t),this._set("viewModel",e))}get _effectiveAvailableCreateTools(){const{availableCreateTools:e,view:t,visibleElements:i}=this,o=e?.filter((e=>!!i.createTools?.[e]));return"3d"===t?.type?o?.filter((e=>"multipoint"!==e)):o}create(e,t,i){const o=i?.createOptions??t;return this._activeCustomToolOptions=i,(0,u.R8)(this.viewModel.create(e,o))}update(e,t){return(0,u.R8)(this.viewModel.update(e,t))}complete(){this.viewModel.complete()}cancel(){this._selectionToolbar?.cancel(),this.viewModel.cancel(),this._activeCustomToolOptions=null}undo(){this.viewModel.undo(),this.view?.focus()}redo(){this.viewModel.redo(),this.view?.focus()}delete(){this.viewModel.delete()}duplicate(){return this.viewModel.duplicate()}dismissFloatingElements(){this._popoverOpen=!1}render(){const{toolbarKind:e,layout:t,scale:i}=this,o=this.customActions?.filter((e=>"selection-toolbar"===e.position));return(0,Z.u)("div",null,(0,Z.u)("div",{classes:{[ot.base]:!0,[ot.floating]:"floating"===e,[ot.docked]:"docked"===e,[ot.vertical]:"vertical"===t}},(0,Z.u)(U,{barStyle:e,layout:t,scale:i},this._renderSelectionSetItemGroupInline(),(0,Z.u)("div",{"allow-collapse":this.groupAllowCollapseOptions?.get("selectionTools")??!0,"group-kind":"split-button",key:"selection-split-button",priority:this.groupCollapsePriorities?.get("selectionTools")??O.g1.Low},this._renderDefaultSelectionButton(),this._selectionToolbar?.render(),o?.map((e=>this._renderToolbarItem(e)))),this._renderCreateToolActionGroup(),this._renderUndoRedoMenuItemGroup(),this._renderSettingsMenuItemGroup()),this._renderSelectionSetToolbar(),this._renderSettingsMenuPopover()))}_renderSettingsMenuPopover(){const{messagesCommon:e,snappingOptions:t,view:i,viewModel:o,visibleElements:n}=this;if(!this._calcitePopoverReferenceElement)return;const s={directionModePicker:n.directionModePicker,labelsToggle:n.labelsToggle,tooltipsToggle:n.tooltipsToggle},r="horizontal"===this.layout?"top"===this._relativeLocation?"bottom-end":"top-end":"right-end";return(0,Z.u)("calcite-popover",{closable:!0,focusTrapDisabled:!0,heading:e.settings,label:e.settings,open:this._popoverOpen,overlayPositioning:"fixed",placement:r,referenceElement:this._calcitePopoverReferenceElement,scale:this.scale,onCalcitePopoverBeforeClose:()=>this._popoverOpen=!1,onCalcitePopoverBeforeOpen:e=>this._remeasurePopoverSizes(e.currentTarget),onCalcitePopoverClose:()=>this._refocusOnView()},(0,Z.u)("div",{class:ot.popoverWrapper},Object.values(s).includes(!0)?(0,Z.u)(Fe,{sketchOptions:o.sketchOptions,viewType:i?.type,visibleElements:new xe(s)}):void 0,n.snappingControls&&i&&t?(0,Z.u)(Qe,{snappingManager:this.viewModel.snappingManager,snappingOptions:t,view:i,visibleElements:n.snappingControlsElements}):void 0))}_renderSelectionSetToolbar(){if("separate"!==this.contextualToolLocation)return;const e=this._renderSelectionSetItemGroup();return e?.length?(0,Z.u)(U,{barStyle:this.toolbarKind,layout:this.layout,scale:this.scale},e):void 0}_renderSelectionSetItemGroupInline(){return"separate"===this.contextualToolLocation?[]:this._renderSelectionSetItemGroup()}_renderUndoRedoMenuItemGroup(){return(0,Z.u)("div",{"allow-collapse":this.groupAllowCollapseOptions?.get("undoRedo")??!0,"group-kind":"split-button",key:"undo-redo-menu",priority:this.groupCollapsePriorities?.get("undoRedo")??O.g1.Medium,slot:"actions-end"},this._renderUndoButton(),this._renderRedoButton())}_renderSettingsMenuItemGroup(){const e=[],t=[];this.customActions?.forEach((i=>{"settings-before"===i.position?t.push(i):"settings-after"===i.position&&e.push(i)}));const i=[...t.map((e=>this._renderToolbarItem(e))),this._renderSettingsMenuButton(),...e.map((e=>this._renderToolbarItem(e)))].filter(a.pC);if(i.length)return(0,Z.u)("div",{"allow-collapse":this.groupAllowCollapseOptions?.get("settings")??!1,"group-kind":"overflow-group",key:"settings-menu",priority:this.groupCollapsePriorities?.get("settings")??O.g1.Max,slot:"actions-end"},i)}_renderSelectionSetItemGroup(){if(!this.updateGraphics.length)return[];const e="inline-end"===this.contextualToolLocation?"actions-end":void 0,t=this.customActions?.filter((e=>"before-selection-set"===e.position)),i=this.customActions?.filter((e=>"after-selection-set"===e.position)),o=this.groupCollapsePriorities?.get("selectionSet")??O.g1.High;return[(0,Z.u)("div",{"group-kind":"measured-content",key:"selection-count-chip-group",priority:o,slot:e},this._renderFeatureCountChip()),(0,Z.u)("div",{"allow-collapse":this.groupAllowCollapseOptions?.get("selectionSet")??!1,"group-kind":"overflow-group",key:"selection-set-tool-group",priority:o,slot:e},t?.map((e=>this._renderToolbarItem(e))),this._renderDuplicateButton(),this._renderDeleteButton(),i?.map((e=>this._renderToolbarItem(e))))]}_renderDefaultSelectionButton(){if(!this.viewModel.updateOnGraphicClick)return[];const{messages:e,state:t}=this;return this._renderToolbarItem({id:"pointer-select",text:e.selectFeature,icon:"cursor",onclick:this._activateDefaultSelectTool,active:"ready"===t})}_renderCreateToolActionGroup(){const e=this._effectiveAvailableCreateTools?.flatMap((e=>this._renderBuiltInCreateToolItem(e)))??[],t=this.customToolOptions?.flatMap((e=>this._renderCustomToolItem(e)))??[];return(0,Z.u)("div",{"allow-collapse":this.groupAllowCollapseOptions?.get("createTools")??!0,"group-kind":"overflow-group",key:"create-tools-group",priority:this.groupCollapsePriorities?.get("createTools")??O.g1.High},e,t)}_renderBuiltInCreateToolItem(e){return this._renderToolbarItem({id:`${e}-button`,text:this.messages.draw[e],icon:nt[e],onclick:()=>this._activateCreateTool(e),active:this.activeTool===e&&!this._activeCustomToolOptions})}_renderCustomToolItem(e){const{toolKey:t}=e;return this._renderToolbarItem({id:`custom-${e.toolKey}`,text:e.label,icon:e.icon,onclick:()=>this._activateCreateTool(e.toolName,null,e),active:this._activeCustomToolOptions?.toolKey===t})}_renderUndoButton(){return this.visibleElements.undoRedoMenu?this._renderToolbarItem({id:"undo-button",text:this.messages.undo,icon:"undo",disabled:!this.viewModel.canUndo(),onclick:this.undo,flipRTL:!0}):[]}_renderRedoButton(){return this.visibleElements.undoRedoMenu?this._renderToolbarItem({id:"redo-button",text:this.messages.redo,icon:"redo",disabled:!this.viewModel.canRedo(),onclick:this.redo,flipRTL:!0}):[]}_renderSettingsMenuButton(){return this.visibleElements.settingsMenu?this._renderToolbarItem({id:"settings-menu-action",text:this.messagesCommon.settings,icon:"gear",active:this._popoverOpen,onclick:()=>this._popoverOpen=!this._popoverOpen,afterCreate:e=>this._calcitePopoverReferenceElement=e,afterUpdate:e=>this._calcitePopoverReferenceElement=e,afterRemoved:()=>this._calcitePopoverReferenceElement=null}):[]}_renderFeatureCountChip(){if(!this.visibleElements.selectionCountLabel)return[];const{layout:e,messages:t,scale:i,id:o,updateGraphics:{length:n}}=this,s=(0,tt.n)(t.selectedCount,{count:n}),r="s"===i?99:999,l=n>r?(0,tt.n)(t.selectedCountTruncated,{truncated:r}):n,a="s"===i&&"vertical"===e,d=a?`${o}-selection-chip-small`:`${o}-selection-chip`;return[a?(0,Z.u)("span",{classes:{[ot.chipVertical]:!0,[ot.chipVerticalSmall]:"s"===this.scale},id:d,tabIndex:0,title:s},l):(0,Z.u)("calcite-chip",{appearance:"outline",class:"horizontal"===e?ot.chipHorizontal:ot.chipVertical,id:d,kind:"brand",label:s,scale:"l"===i?"m":"s",tabIndex:0,title:"vertical"===e?s:void 0},"vertical"===e?l:s)]}_renderDuplicateButton(){if(!this.visibleElements.duplicateButton)return[];const{messages:e}=this;return this._renderToolbarItem({id:"duplicate",text:this.updateGraphics.length>1?e.duplicateFeatures:e.duplicateFeature,icon:"copy",onclick:this._onDuplicateSelect})}_renderDeleteButton(){if(!this.visibleElements.deleteButton)return[];const{messages:e}=this,t=this.updateGraphics.length>1?e.deleteFeatures:e.deleteFeature;return this._renderToolbarItem({id:"delete",text:t,icon:"trash",onclick:this.delete})}_renderToolbarItem({id:e,text:t,icon:i,disabled:o,onclick:n,active:s,flipRTL:r,afterCreate:l,afterUpdate:a,afterRemoved:d}){const c=`${this.id}-${e}`;return[(0,Z.u)("calcite-action",{active:s,afterCreate:l,afterRemoved:d,afterUpdate:a,bind:this,"data-testid":e,disabled:o||"disabled"===this.state,icon:i,iconFlipRtl:r??!1,id:c,key:e,onclick:n,scale:this.scale,text:t,title:t})]}_remeasurePopoverSizes(e){try{const t=e.parentElement,i=this?.view?.container?.getBoundingClientRect(),o=t?.style;if(!(t&&i&&o&&this.view?.container?.contains(t)))return;const n=this._calcitePopoverReferenceElement;if(!n)return;const{bottom:s,top:r}=n.getBoundingClientRect();if("horizontal"===this.layout){const e=s<i.height/2;e!==("top"===this._relativeLocation)&&(this._relativeLocation=e?"top":"bottom"),e?(o?.setProperty("--sketch-view-height-offset",s-i.top+"px"),o?.setProperty("--sketch-view-margin-offset","30px")):(o?.setProperty("--sketch-view-height-offset",i.bottom-r+"px"),o?.setProperty("--sketch-view-margin-offset","15px"))}else"vertical"===this.layout&&(o.setProperty("--sketch-view-height-offset","15px"),o.setProperty("--sketch-view-margin-offset","15px"));const l=e.shadowRoot?.querySelector("div.header")?.getBoundingClientRect().height;o.setProperty("--sketch-popover-header-offset",`${l}px`)}catch(e){c.Z.getLogger(this.declaredClass).warnOnce("Sketch failed to lay out settings menu.",e)}}_activateCreateTool(e,t,i){const o=this._activeCustomToolOptions;if(i||o){if(i?.toolKey===o?.toolKey)return void this.cancel()}else if(this.activeTool===e)return void this.cancel();this._selectionToolbar?.cancel(),this.create(e,t,i)}_onDuplicateSelect(){const e=this.duplicate(),t=this.viewModel.activeTool;"transform"!==t&&"reshape"!==t||this.update(e,{tool:t})}_onSelectionOperationComplete(e){const{viewModel:{defaultUpdateOptions:t}}=this,{selection:i}=e;if(!e.aborted&&i.length){const e=t.tool,o=i.length>1&&"reshape"===e?"transform":e;this.update(i,{...t,tool:o})}this.notifyChange("state")}_activateDefaultSelectTool(){this.cancel(),this.view?.focus()}_refocusOnView(){this.activeTool&&this.view?.focus()}};(0,l._)([(0,g.Cb)()],st.prototype,"_activeCustomToolOptions",void 0),(0,l._)([(0,g.Cb)()],st.prototype,"activeTool",null),(0,l._)([(0,g.Cb)({readOnly:!0})],st.prototype,"activeTooltip",null),(0,l._)([(0,g.Cb)({cast:e=>{if(!e?.length)return null;const t=new Set(["point","polyline","polygon","rectangle","circle","multipoint","freehandPolyline","freehandPolygon","mesh"]);return e.filter((e=>t.has(e)))}})],st.prototype,"availableCreateTools",void 0),(0,l._)([(0,g.Cb)({readOnly:!0})],st.prototype,"createGraphic",null),(0,l._)([(0,g.Cb)()],st.prototype,"creationMode",null),(0,l._)([(0,g.Cb)()],st.prototype,"customToolOptions",void 0),(0,l._)([(0,g.Cb)()],st.prototype,"customActions",void 0),(0,l._)([(0,g.Cb)()],st.prototype,"defaultCreateOptions",null),(0,l._)([(0,g.Cb)()],st.prototype,"defaultUpdateOptions",null),(0,l._)([(0,g.Cb)()],st.prototype,"icon",null),(0,l._)([(0,g.Cb)()],st.prototype,"label",null),(0,l._)([(0,g.Cb)()],st.prototype,"labelOptions",null),(0,l._)([(0,g.Cb)()],st.prototype,"layer",null),(0,l._)([(0,g.Cb)({type:["horizontal","vertical"],value:"horizontal"})],st.prototype,"layout",null),(0,l._)([(0,g.Cb)({value:"m"})],st.prototype,"scale",null),(0,l._)([(0,g.Cb)()],st.prototype,"toolbarKind",void 0),(0,l._)([(0,g.Cb)()],st.prototype,"contextualToolLocation",void 0),(0,l._)([(0,g.Cb)()],st.prototype,"groupCollapsePriorities",void 0),(0,l._)([(0,g.Cb)()],st.prototype,"groupAllowCollapseOptions",void 0),(0,l._)([(0,g.Cb)(),(0,$.H)("esri/widgets/Sketch/t9n/Sketch")],st.prototype,"messages",void 0),(0,l._)([(0,g.Cb)(),(0,$.H)("esri/t9n/common")],st.prototype,"messagesCommon",void 0),(0,l._)([(0,g.Cb)()],st.prototype,"snappingOptions",null),(0,l._)([(0,g.Cb)()],st.prototype,"state",null),(0,l._)([(0,g.Cb)()],st.prototype,"tooltipOptions",null),(0,l._)([(0,g.Cb)({readOnly:!0})],st.prototype,"updateGraphics",null),(0,l._)([(0,g.Cb)({type:b.Z,nonNullable:!0})],st.prototype,"valueOptions",null),(0,l._)([(0,g.Cb)()],st.prototype,"view",null),(0,l._)([(0,g.Cb)({type:v.Z}),(0,et.s)(["create","update","undo","redo"])],st.prototype,"viewModel",null),(0,l._)([(0,g.Cb)({type:M,nonNullable:!0})],st.prototype,"visibleElements",void 0),(0,l._)([(0,g.Cb)()],st.prototype,"_effectiveAvailableCreateTools",null),(0,l._)([(0,g.Cb)()],st.prototype,"_defaultViewModel",void 0),(0,l._)([(0,g.Cb)()],st.prototype,"_calcitePopoverReferenceElement",void 0),(0,l._)([(0,g.Cb)()],st.prototype,"_relativeLocation",void 0),(0,l._)([(0,g.Cb)()],st.prototype,"_popoverOpen",void 0),st=(0,l._)([(0,y.j)("esri.widgets.Sketch")],st);const rt=st;var lt=i(54503),at=i(8403);const dt=i(49006).iv`@layer{arcgis-sketch{display:block}}`,ct=(0,at.m)(rt);class pt extends lt.oi{constructor(){super(),this.widget=ct(this),this.viewModel=this.widget.viewModel,this._defaultGraphicsLayer=null,this.activeTool=this.widget.activeTool,this.autoDestroyDisabled=!1,this.availableCreateTools=this.widget.availableCreateTools,this.createGraphic=this.widget.createGraphic,this.creationMode=this.widget.creationMode,this.defaultCreateOptions=this.widget.defaultCreateOptions,this.defaultGraphicsLayerDisabled=!1,this.defaultUpdateOptions=this.widget.defaultUpdateOptions,this.hideCreateToolsCircle=this.widget.visibleElements.createTools.circle,this.hideCreateToolsPoint=this.widget.visibleElements.createTools.point,this.hideCreateToolsPolygon=this.widget.visibleElements.createTools.polygon,this.hideCreateToolsPolyline=this.widget.visibleElements.createTools.polyline,this.hideCreateToolsRectangle=this.widget.visibleElements.createTools.rectangle,this.hideDuplicateButton=this.widget.visibleElements.duplicateButton,this.hideDeleteButton=this.widget.visibleElements.deleteButton,this.hideSelectionCountLabel=this.widget.visibleElements.selectionCountLabel,this.hideLabelsToggle=this.widget.visibleElements.labelsToggle,this.hideSelectionToolsLassoSelection=this.widget.visibleElements.selectionTools["lasso-selection"],this.hideSelectionToolsRectangleSelection=this.widget.visibleElements.selectionTools["rectangle-selection"],this.hideSettingsMenu=this.widget.visibleElements.settingsMenu,this.hideSnappingControls=this.widget.visibleElements.snappingControls,this.hideSnappingControlsElementsEnabledToggle=this.widget.visibleElements.snappingControlsElements.enabledToggle,this.hideSnappingControlsElementsFeatureEnabledToggle=this.widget.visibleElements.snappingControlsElements.featureEnabledToggle,this.hideSnappingControlsElementsLayerList=this.widget.visibleElements.snappingControlsElements.layerList,this.hideSnappingControlsElementsSelfEnabledToggle=this.widget.visibleElements.snappingControlsElements.selfEnabledToggle,this.hideTooltipsToggle=this.widget.visibleElements.tooltipsToggle,this.hideUndoRedoMenu=this.widget.visibleElements.undoRedoMenu,this.icon=this.widget.icon,this.label=this.widget.label,this.labelOptions=this.widget.labelOptions,this.layer=this.widget.layer,this.layout=this.widget.layout,this.pointSymbol=this.viewModel.pointSymbol,this.polygonSymbol=this.viewModel.polygonSymbol,this.polylineSymbol=this.viewModel.polylineSymbol,this.position="bottom-left",this.scale=this.widget.scale,this.toolbarKind=this.widget.toolbarKind,this.showSnappingControlsElementsHeader=this.widget.visibleElements.snappingControlsElements.header,this.snappingOptions=this.widget.snappingOptions,this.state=this.widget.state,this.tooltipOptions=this.widget.tooltipOptions,this.updateGraphics=this.widget.updateGraphics,this.arcgisCreate=(0,s.Wk)((()=>this.widget),"create"),this.arcgisDelete=(0,s.Wk)((()=>this.widget),"delete"),this.arcgisPropertyChange=(0,n.OR)()("state"),this.arcgisReady=(0,lt.yM)(),this.arcgisRedo=(0,s.Wk)((()=>this.widget),"redo"),this.arcgisUndo=(0,s.Wk)((()=>this.widget),"undo"),this.arcgisUpdate=(0,s.Wk)((()=>this.widget),"update"),this.listen("arcgisReady",this._arcgisReadyHandler)}static{this.properties={activeTool:3,autoDestroyDisabled:5,availableCreateTools:0,createGraphic:0,creationMode:1,defaultCreateOptions:0,defaultGraphicsLayerDisabled:5,defaultUpdateOptions:0,hideCreateToolsCircle:5,hideCreateToolsPoint:5,hideCreateToolsPolygon:5,hideCreateToolsPolyline:5,hideCreateToolsRectangle:5,hideDuplicateButton:5,hideDeleteButton:5,hideSelectionCountLabel:5,hideLabelsToggle:5,hideSelectionToolsLassoSelection:5,hideSelectionToolsRectangleSelection:5,hideSettingsMenu:5,hideSnappingControls:5,hideSnappingControlsElementsEnabledToggle:5,hideSnappingControlsElementsFeatureEnabledToggle:5,hideSnappingControlsElementsLayerList:5,hideSnappingControlsElementsSelfEnabledToggle:5,hideTooltipsToggle:5,hideUndoRedoMenu:5,icon:1,label:1,labelOptions:0,layer:0,layout:1,pointSymbol:0,polygonSymbol:0,polylineSymbol:0,position:1,referenceElement:1,scale:1,toolbarKind:1,showSnappingControlsElementsHeader:5,snappingOptions:0,state:3,tooltipOptions:0,updateGraphics:0}}static{this.shadowRootOptions=lt.hZ}static{this.styles=dt}async cancel(){this.widget?.cancel()}async complete(){this.widget?.complete()}async create(e,t){await(this.widget?.create(e,t))}async delete(){this.widget?.delete()}async destroy(){await this.manager.destroy()}async duplicate(){this.widget?.duplicate()}async redo(){this.widget?.redo()}async triggerUpdate(e,t){this.widget?.update(e,t)}async undo(){this.widget?.undo()}_arcgisReadyHandler(){this.defaultGraphicsLayerDisabled||(this._defaultGraphicsLayer=new r.Z({title:"Sketch Layer"}),this.widget.layer=this._defaultGraphicsLayer,this.el.view?.map?.add(this.widget.layer),this.manager.onLifecycle((()=>(0,h.YP)((()=>this.el.view?.map),((e,t)=>{if(this.widget.layer!==this._defaultGraphicsLayer)return;const i=this._defaultGraphicsLayer;t?.allLayers.includes(i)&&t.allLayers.remove(i),e?.add(i)})))),this.manager.onDestroy((()=>{this._defaultGraphicsLayer&&this.el.view?.map?.allLayers.includes(this._defaultGraphicsLayer)&&this.el.view?.map?.remove(this._defaultGraphicsLayer),this._defaultGraphicsLayer?.destroy(),this._defaultGraphicsLayer=null})))}}(0,o.c)("arcgis-sketch",pt)},64897:function(e,t,i){i.d(t,{Z:function(){return d}});var o=i(52859),n=i(5393),s=Number.isInteger||function(e){return e<<0===e},r=i(55753);var l=(0,n.Z)((function(e,t){var i,o,n;if(null!=t)return s(e)?(o=t,n=(i=e)<0?o.length+i:i,(0,r.Z)(o)?o.charAt(n):o[n]):t[e]})),a=i(50223),d=(0,o.Z)((function(e,t,i){return(0,a.Z)(e,l(t,i))}))}}]);