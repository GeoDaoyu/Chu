"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[26078],{53483:function(e,t,i){i.d(t,{a:function(){return u}});const r=2654435761,n=2246822519,s=3266489917,o=668265263,a=374761393;function l(e){const t=[];for(let i=0,r=e.length;i<r;i++){let r=e.charCodeAt(i);r<128?t.push(r):r<2048?t.push(192|r>>6,128|63&r):r<55296||r>=57344?t.push(224|r>>12,128|r>>6&63,128|63&r):(i++,r=65536+((1023&r)<<10|1023&e.charCodeAt(i)),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return new Uint8Array(t)}class u{constructor(e){this._seed=e,this._totallen=0,this._bufs=[],this.init()}init(){return this._bufs=[],this._totallen=0,this}updateFloatArray(e){const t=[];for(const i of e)isNaN(i)?t.push("NaN"):i===1/0?t.push("Infinity"):i===-1/0?t.push("-Infinity"):0===i?t.push("0"):t.push(i.toString(16));this.update(l(t.join("")))}updateIntArray(e){const t=Int32Array.from(e);this.update(new Uint8Array(t.buffer))}updateUint8Array(e){this.update(Uint8Array.from(e))}updateWithString(e){return this.update(l(e))}update(e){return this._bufs.push(e),this._totallen+=e.length,this}digest(){const e=new Uint8Array(this._totallen);let t=0;for(const i of this._bufs)e.set(i,t),t+=i.length;return this.init(),this._xxHash32(e,this._seed)}_xxHash32(e,t=0){const i=e;let l=t+a&4294967295,u=0;if(i.length>=16){const i=[t+r+n&4294967295,t+n&4294967295,t+0&4294967295,t-r&4294967295],s=e,o=s.length-16;let a=0;for(u=0;(4294967280&u)<=o;u+=4){const e=u,t=s[e]+(s[e+1]<<8),o=s[e+2]+(s[e+3]<<8),l=t*n+(o*n<<16);let p=i[a]+l&4294967295;p=p<<13|p>>>19;const c=65535&p,h=p>>>16;i[a]=c*r+(h*r<<16)&4294967295,a=a+1&3}l=(i[0]<<1|i[0]>>>31)+(i[1]<<7|i[1]>>>25)+(i[2]<<12|i[2]>>>20)+(i[3]<<18|i[3]>>>14)&4294967295}l=l+e.length&4294967295;const p=e.length-4;for(;u<=p;u+=4){const e=u,t=i[e]+(i[e+1]<<8),r=i[e+2]+(i[e+3]<<8);l=l+(t*s+(r*s<<16))&4294967295,l=l<<17|l>>>15,l=(65535&l)*o+((l>>>16)*o<<16)&4294967295}for(;u<i.length;++u)l+=i[u]*a,l=l<<11|l>>>21,l=(65535&l)*r+((l>>>16)*r<<16)&4294967295;return l^=l>>>15,l=((65535&l)*n&4294967295)+((l>>>16)*n<<16),l^=l>>>13,l=((65535&l)*s&4294967295)+((l>>>16)*s<<16),l^=l>>>16,l<0?l+4294967296:l}}},58174:function(e,t,i){i.d(t,{Z:function(){return g}});var r,n=i(73440),s=i(41773),o=i(63255),a=i(28947),l=i(17155),u=(i(61432),i(96711),i(48023)),p=i(98842),c=i(29191),h=i(85913);const d=new s.X({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),y=new s.X({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let f=r=class extends o.Z{constructor(e){super(e),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(e={}){const{where:t,geometry:i,spatialRelationship:r,timeExtent:n,objectIds:s,units:o,distance:l}=this;return new c.Z({geometry:(0,a.d9)(i),objectIds:(0,a.d9)(s),spatialRelationship:r,timeExtent:(0,a.d9)(n),where:t,units:o,distance:l,...e})}clone(){const{where:e,geometry:t,spatialRelationship:i,timeExtent:n,objectIds:s,units:o,distance:l}=this;return new r({geometry:(0,a.d9)(t),objectIds:(0,a.d9)(s),spatialRelationship:i,timeExtent:(0,a.d9)(n),where:e,units:o,distance:l})}};(0,n._)([(0,l.Cb)({type:String,json:{write:!0}})],f.prototype,"where",void 0),(0,n._)([(0,l.Cb)({types:p.qM,json:{write:!0}})],f.prototype,"geometry",void 0),(0,n._)([(0,l.Cb)({type:d.apiValues,json:{name:"spatialRel",read:{reader:d.read},write:{allowNull:!1,writer:d.write,overridePolicy(){return{enabled:null!=this.geometry}}}}})],f.prototype,"spatialRelationship",void 0),(0,n._)([(0,l.Cb)({type:Number,json:{write:{overridePolicy(e){return{enabled:null!=e&&null!=this.geometry}}}}})],f.prototype,"distance",void 0),(0,n._)([(0,l.Cb)({type:[Number],json:{write:!0}})],f.prototype,"objectIds",void 0),(0,n._)([(0,l.Cb)({type:y.apiValues,json:{read:y.read,write:{writer:y.write,overridePolicy(e){return{enabled:null!=e&&null!=this.geometry}}}}})],f.prototype,"units",void 0),(0,n._)([(0,l.Cb)({type:h.T,json:{write:!0}})],f.prototype,"timeExtent",void 0),f=r=(0,n._)([(0,u.j)("esri.layers.support.FeatureFilter")],f);const g=f},44695:function(e,t,i){function r(e){const t=e.layer;return"floorInfo"in t&&t.floorInfo?.floorField&&"floors"in e.view?s(e.view.floors,t.floorInfo.floorField):null}function n(e,t){return"floorInfo"in t&&t.floorInfo?.floorField?s(e,t.floorInfo.floorField):null}function s(e,t){if(!e?.length)return null;const i=e.filter((e=>""!==e)).map((e=>`'${e}'`));return i.push("''"),`${t} IN (${i.join(",")}) OR ${t} IS NULL`}i.d(t,{c:function(){return r},f:function(){return n}})},28371:function(e,t,i){i.d(t,{h:function(){return s}});i(3480),i(28947);var r=i(92161),n=i(85913);i(62052),i(72728);function s(e,t,i){if(null==e?.timeInfo)return null;const{datesInUnknownTimezone:s=!1,timeOffset:o,useViewTime:a}=e;let l=e.timeExtent;s&&(l=function(e){if(!e)return e;const{start:t,end:i}=e;return new n.T({start:null!=t?(0,r.Nm)(t,t.getTimezoneOffset(),"minutes"):t,end:null!=i?(0,r.Nm)(i,i.getTimezoneOffset(),"minutes"):i})}(l));let u=a?t&&l?t.intersection(l):t||l:l;return!u||u.isEmpty||u.isAllTime?u:(o&&(u=u.offset(-o.value,o.unit)),s&&(u=function(e){if(!e)return e;const{start:t,end:i}=e;return new n.T({start:null!=t?(0,r.Nm)(t,-t.getTimezoneOffset(),"minutes"):t,end:null!=i?(0,r.Nm)(i,-i.getTimezoneOffset(),"minutes"):i})}(u)),u.equals(i)?i:u)}},13878:function(e,t,i){i.d(t,{Z:function(){return _}});var r,n=i(73440),s=i(46451),o=i(41773),a=i(63255),l=i(28947),u=i(17155),p=(i(61432),i(96711),i(1194)),c=i(48023),h=i(29884),d=i(45213),y=i(90756),f=i(98842),g=i(49651);const m=new o.X({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let _=r=class extends a.Z{constructor(e){super(e),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(e,t){return this.readFeaturesWithClass(e,t,s.Z)}writeGeometryType(e,t,i,r){if(e)return void m.write(e,t,i,r);const{features:n}=this;if(n)for(const e of n)if(null!=e?.geometry)return void m.write(e.geometry.type,t,i,r)}readQueryGeometry(e,t){if(!e)return null;const i=!!e.spatialReference,r=(0,y.im)(e);return r&&!i&&t.spatialReference&&(r.spatialReference=d.Z.fromJSON(t.spatialReference)),r}writeSpatialReference(e,t){if(e)return void(t.spatialReference=e.toJSON());const{features:i}=this;if(i)for(const e of i)if(e&&null!=e.geometry&&e.geometry.spatialReference)return void(t.spatialReference=e.geometry.spatialReference.toJSON())}clone(){return new r(this.cloneProperties())}cloneProperties(){return(0,l.d9)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(e){const t=this.write();if(t.features&&Array.isArray(e)&&e.length>0)for(let i=0;i<t.features.length;i++){const r=t.features[i];if(r.geometry){const t=e?.[i];r.geometry=t?.toJSON()||r.geometry}}return t}quantize(e){const{scale:[t,i],translate:[r,n]}=e,s=this.features,o=this._getQuantizationFunction(this.geometryType,(e=>Math.round((e-r)/t)),(e=>Math.round((n-e)/i)));for(let e=0,t=s.length;e<t;e++)o?.(s[e].geometry)||(s.splice(e,1),e--,t--);return this.transform=e,this}unquantize(){const{geometryType:e,features:t,transform:i}=this;if(!i)return this;const{translate:[r,n],scale:[s,o]}=i;let a=null,l=null;if(this.hasZ&&null!=i?.scale?.[2]){const{translate:[,,e],scale:[,,t]}=i;a=i=>i*t+e}if(this.hasM&&null!=i?.scale?.[3]){const{translate:[,,,e],scale:[,,,t]}=i;l=i=>null==i?i:i*t+e}const u=this._getHydrationFunction(e,(e=>e*s+r),(e=>n-e*o),a,l);for(const{geometry:e}of t)null!=e&&u&&u(e);return this.transform=null,this}readFeaturesWithClass(e,t,i){const r=d.Z.fromJSON(t.spatialReference),n=[];for(let t=0;t<e.length;t++){const s=e[t],o=i.fromJSON(s),a=s.geometry?.spatialReference;null==o.geometry||a||(o.geometry.spatialReference=r);const l=s.aggregateGeometries,u=o.aggregateGeometries;if(l&&null!=u)for(const e in u){const t=u[e],i=l[e]?.spatialReference;null==t||i||(t.spatialReference=r)}n.push(o)}return n}_quantizePoints(e,t,i){let r,n;const s=[];for(let o=0,a=e.length;o<a;o++){const a=e[o];if(o>0){const e=t(a[0]),o=i(a[1]);e===r&&o===n||(s.push([e-r,o-n]),r=e,n=o)}else r=t(a[0]),n=i(a[1]),s.push([r,n])}return s.length>0?s:null}_getQuantizationFunction(e,t,i){return"point"===e?e=>(e.x=t(e.x),e.y=i(e.y),e):"polyline"===e||"polygon"===e?e=>{const r=(0,y.oU)(e)?e.rings:e.paths,n=[];for(let e=0,s=r.length;e<s;e++){const s=r[e],o=this._quantizePoints(s,t,i);o&&n.push(o)}return n.length>0?((0,y.oU)(e)?e.rings=n:e.paths=n,e):null}:"multipoint"===e?e=>{const r=this._quantizePoints(e.points,t,i);return r&&r.length>0?(e.points=r,e):null}:"extent"===e?e=>e:null}_getHydrationFunction(e,t,i,r,n){return"point"===e?e=>{e.x=t(e.x),e.y=i(e.y),r&&(e.z=r(e.z))}:"polyline"===e||"polygon"===e?e=>{const s=(0,y.oU)(e)?e.rings:e.paths;let o,a;for(let e=0,r=s.length;e<r;e++){const r=s[e];for(let e=0,n=r.length;e<n;e++){const n=r[e];e>0?(o+=n[0],a+=n[1]):(o=n[0],a=n[1]),n[0]=t(o),n[1]=i(a)}}if(r&&n)for(let e=0,t=s.length;e<t;e++){const t=s[e];for(let e=0,i=t.length;e<i;e++){const i=t[e];i[2]=r(i[2]),i[3]=n(i[3])}}else if(r)for(let e=0,t=s.length;e<t;e++){const t=s[e];for(let e=0,i=t.length;e<i;e++){const i=t[e];i[2]=r(i[2])}}else if(n)for(let e=0,t=s.length;e<t;e++){const t=s[e];for(let e=0,i=t.length;e<i;e++){const i=t[e];i[2]=n(i[2])}}}:"extent"===e?e=>{e.xmin=t(e.xmin),e.ymin=i(e.ymin),e.xmax=t(e.xmax),e.ymax=i(e.ymax),r&&null!=e.zmax&&null!=e.zmin&&(e.zmax=r(e.zmax),e.zmin=r(e.zmin)),n&&null!=e.mmax&&null!=e.mmin&&(e.mmax=n(e.mmax),e.mmin=n(e.mmin))}:"multipoint"===e?e=>{const s=e.points;let o,a;for(let e=0,r=s.length;e<r;e++){const r=s[e];e>0?(o+=r[0],a+=r[1]):(o=r[0],a=r[1]),r[0]=t(o),r[1]=i(a)}if(r&&n)for(let e=0,t=s.length;e<t;e++){const t=s[e];t[2]=r(t[2]),t[3]=n(t[3])}else if(r)for(let e=0,t=s.length;e<t;e++){const t=s[e];t[2]=r(t[2])}else if(n)for(let e=0,t=s.length;e<t;e++){const t=s[e];t[2]=n(t[2])}}:null}};(0,n._)([(0,u.Cb)({type:String,json:{write:!0}})],_.prototype,"displayFieldName",void 0),(0,n._)([(0,u.Cb)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],_.prototype,"exceededTransferLimit",void 0),(0,n._)([(0,u.Cb)({type:[s.Z],json:{write:!0}})],_.prototype,"features",void 0),(0,n._)([(0,p.r)("features")],_.prototype,"readFeatures",null),(0,n._)([(0,u.Cb)({type:[g.Z],json:{write:!0}})],_.prototype,"fields",void 0),(0,n._)([(0,u.Cb)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:m.read}}})],_.prototype,"geometryType",void 0),(0,n._)([(0,h.c)("geometryType")],_.prototype,"writeGeometryType",null),(0,n._)([(0,u.Cb)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],_.prototype,"hasM",void 0),(0,n._)([(0,u.Cb)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],_.prototype,"hasZ",void 0),(0,n._)([(0,u.Cb)({types:f.qM,json:{write:!0}})],_.prototype,"queryGeometry",void 0),(0,n._)([(0,p.r)("queryGeometry")],_.prototype,"readQueryGeometry",null),(0,n._)([(0,u.Cb)({type:d.Z,json:{write:!0}})],_.prototype,"spatialReference",void 0),(0,n._)([(0,h.c)("spatialReference")],_.prototype,"writeSpatialReference",null),(0,n._)([(0,u.Cb)({json:{write:!0}})],_.prototype,"transform",void 0),_=r=(0,n._)([(0,c.j)("esri.rest.support.FeatureSet")],_),_.prototype.toJSON.isDefaultToJSON=!0},16395:function(e,t,i){i.d(t,{c:function(){return r}});i(61432);function r(e){const{objectIdField:t,uniqueIdFields:i}=e;return i?.length?i.length>=2?{type:"unique-id-composite",fieldNames:i}:{type:"unique-id-simple",fieldName:i[0]}:{type:"object-id",fieldName:t}}},26696:function(e,t,i){i.d(t,{I:function(){return j}});var r=i(73440),n=i(46451),s=i(53483),o=i(79487),a=i(50702),l=i(61100),u=i(76329),p=i(93568),c=i(90403),h=i(17155),d=(i(96711),i(83850),i(48023)),y=i(58426),f=i(60147),g=i(97290),m=i(56216),_=i(29191),b=i(82377),C=i(94808),w=i(47451),x=i(46021),E=i(28994),v=i(5473),R=i(18234),S=i(62564),F=i(66290),O=i(36027),I=i(83533),V=i(79147),T=i(78637),N=i(94125),G=i(43295);let j=class extends u.Z{constructor(e){super(e),this.type="graphics-3d",this._updatingHandles=new f.R,this.elevationFeatureExpressionEnabled=!1,this.scaleVisibilityEnabled=!1,this.filterVisibilityEnabled=!1,this.frustumVisibilityEnabled=!1,this.elevationAlignmentEnabled=!1,this.timeExtentEnabled=!1,this.setUidToIdOnAdd=!0,this.dataExtent=null,this.drapeSourceType=C.Lw.Features,this.preferredUpdatePolicy=N.j.ASYNC,this._suspendResumeExtent=null}initialize(){const e=this.owner,t=(this.filterVisibilityEnabled||this.timeExtentEnabled)&&"multipatch"!==e.layer.geometryType,i=new E.w({owner:this,layer:this.layer,preferredUpdatePolicy:this.preferredUpdatePolicy,elevationFeatureExpressionEnabled:this.elevationFeatureExpressionEnabled,graphicSymbolSupported:!1,hasZ:e.hasZ,hasM:e.hasM,setUidToIdOnAdd:this.setUidToIdOnAdd,componentFactories:{deconflictor:t=>e.view.deconflictor.addGraphicsOwner(t),labeler:(t,i)=>e.view.labeler.addGraphicsOwner(t,i),elevationAlignment:this.elevationAlignmentEnabled?(t,i)=>new v._({graphicsCoreOwner:this,graphicsCore:t,queryGraphicUIDsInExtent:i,elevationProvider:e.view.elevationProvider}):null,scaleVisibility:this.scaleVisibilityEnabled?(t,i)=>new F.c({graphicsCoreOwner:this,layer:this.layer,queryGraphicUIDsInExtent:i,graphicsCore:t,basemapTerrain:e.view.basemapTerrain}):null,filterVisibility:t?t=>new V.n({context:{...t,configuration:e}}):null,objectStates:e=>new S.d(e)}});this._set("graphicsCore",i),this.frustumVisibilityEnabled&&this._set("frustumVisibility",new R.L({graphicsCoreOwner:this})),this.elevationAlignment&&this._updatingHandles.add((()=>this.layer.elevationInfo),((e,t)=>{(0,y.Hg)(e,t)&&this._updatingHandles.addPromise(this.graphicsCore.elevationInfoChange())})),this._updatingHandles.add((()=>this.layer.labelsVisible),(()=>this.graphicsCore.updateVisibilityInfo())),this._updatingHandles.add((()=>this.layer.labelingInfo),((e,t)=>{(0,y.Hg)(e,t)&&this.graphicsCore.updateLabelingInfo()})),this._updatingHandles.add((()=>this.preferredUpdatePolicy),(e=>this.graphicsCore.preferredUpdatePolicy=e)),this.addResolvingPromise(this._initializeAsync())}async _initializeAsync(){await(0,p.U3)(this.graphicsCore.initializePromise);const e=this.owner;this._updatingHandles.add((()=>this.renderer),(e=>this._updatingHandles.addPromise(this.graphicsCore.rendererChange(e)))),this._updatingHandles.add((()=>e.fullOpacity),(()=>this.graphicsCore.opacityChange())),this._setupSuspendResumeExtent(),this.updateClippingExtent&&(this._updatingHandles.add((()=>e.view.clippingArea),(()=>this._updateClippingExtent())),this._updateClippingExtent()),this.graphicsCore.startCreateGraphics(),this.graphicsCore.labelsEnabled&&await(0,p.U3)(this.graphicsCore.updateLabelingInfo())}destroy(){this._updatingHandles.destroy(),this._set("frustumVisibility",(0,l.SC)(this.frustumVisibility)),this._set("graphicsCore",(0,l.SC)(this.graphicsCore)),this._set("owner",null)}get layer(){return this.owner.layer}get layerViewUid(){return this.owner.layerViewUid}get dataUpdating(){return this.graphicsCore?.dataUpdating??!1}get renderer(){const{renderer:e,objectIdField:t}=this.layer;if(!e||!t||"heatmap"===e.type||!e.visualVariables)return e;const i=e.visualVariables.findIndex((e=>"rotation"===e.type&&null!=e.valueExpression&&(0,b.v)(e.valueExpression)===t&&(null==e.axis||"heading"===e.axis)&&"geographic"===e.rotationType));if(i<0)return e;const r=e.clone();return r.visualVariables?(r.visualVariables.splice(i,1),this._randomRotationRenderers??=new WeakMap,this._randomRotationRenderers.set(r,t),r):e}get scaleVisibility(){return this.graphicsCore?.scaleVisibility}get filterVisibility(){return this.graphicsCore?.filterVisibility}get elevationAlignment(){return this.graphicsCore?.elevationAlignment}get suspendResumeExtentMode(){return this.owner.suspendResumeExtentMode??"computed"}get scaleVisibilitySuspended(){return null!=this.scaleVisibility&&this.scaleVisibility.suspended}get suspended(){return this.owner.suspended}get legendEnabled(){return null==this.frustumVisibility||!this.frustumVisibility.suspended}get suspendInfo(){const e={};return this.scaleVisibilitySuspended&&(e.outsideScaleRange=!0),null!=this.frustumVisibility&&this.frustumVisibility.suspended&&(e.outsideOfView=!0),e}get updating(){return!!(this.graphicsCore?.updating||this.frustumVisibility?.updating||this._updatingHandles.updating)}get updatingRemaining(){return this.graphicsCore?.updatingRemaining??0}get featureStore(){return this.graphicsCore?.featureStore}get view(){return this.owner.view}get loadedGraphics(){return this.owner.loadedGraphics}get fullOpacity(){return this.owner?.fullOpacity}get filter(){return"filter"in this.owner?this.owner.filter:null}get slicePlaneEnabled(){return this.owner.slicePlaneEnabled}get updatePolicy(){return this.owner.updatePolicy}get featureSpatialReference(){return"featureSpatialReference"in this.owner?this.owner.featureSpatialReference:this.owner.view.spatialReference}get graphics3DGraphics(){return this.graphicsCore?.graphics3DGraphics}get graphics3DGraphicsByObjectID(){return this.graphicsCore?.graphics3DGraphicsByObjectID}get symbolUpdateType(){return this.graphicsCore?.symbolUpdateType}get displayFeatureLimit(){const e=this.view.quality,t=this.graphicsCore?.displayFeatureLimit;if(1===e)return t;const i=Math.ceil(t.maximumNumberOfFeatures*e);return new x.J(t.maximumTotalNumberOfVertices,i,t.averageSymbolComplexity)}get usedMemory(){return this.graphicsCore?.usedMemory??0}get loadedFeatures(){return this.graphicsCore?.numberOfGraphics??0}get usedMemoryPerFeature(){return this.graphicsCore?.usedMemoryPerGraphic??0}get unprocessedMemoryEstimate(){return this.graphicsCore?.unprocessedMemoryEstimate??0}get performanceInfo(){return this.graphicsCore.performanceInfo}maskOccludee(e){const t=this.graphicsCore?.objectStates;if(!t)return(0,a.kB)();const{set:i,handle:r}=t.acquireOccludeeSet(null);return t.setUid(i,e.uid),r}highlight(e,t=null,i){const r=this.graphicsCore?.objectStates;if(!r)return T.qK;if(i??=G.b,e instanceof _.Z){const{set:n,handle:s}=r.acquireHighlightSet(i,t);return this.owner.queryObjectIds(e).then((e=>r.setObjectIds(n,e))),s}let s=(0,T.OL)(e);if(0===s.length)return T.qK;if(s[0]instanceof n.Z){const e=s;if(null==(0,I.g)(this.layer.fieldsIndex,e[0].attributes,t)){const t=e.map((e=>e.uid)),{set:n,handle:s}=r.acquireHighlightSet(i,null);return r.setUids(n,t),s}s=e.map((e=>(0,I.g)(this.layer.fieldsIndex,e.attributes,t)))}if((0,T.Nl)(s[0])){const e=s,{set:n,handle:o}=r.acquireHighlightSet(i,t);return r.setObjectIds(n,e),o}return T.qK}resetObjectStates(){this.graphicsCore?.objectStates?.reset()}whenGraphicBounds(e,t){return this.graphicsCore?.whenGraphicBounds(e,t)}computeAttachmentOrigin(e,t){return this.graphicsCore?.computeAttachmentOrigin(e,t)}notifyGraphicGeometryChanged(e){this.graphicsCore.notifyGraphicGeometryChanged(e)}notifyGraphicVisibilityChanged(e){this.graphicsCore.notifyGraphicVisibilityChanged(e)}notifyContentGeometryUpdate(){this.owner.notifyContentGeometryUpdate?.()}getRenderingInfo(e,t,i){const r=(0,m.Kb)(e,{renderer:t,arcade:i});if(r?.color){const e=r.color;e[0]=e[0]/255,e[1]=e[1]/255,e[2]=e[2]/255}if(null!=r&&null!=t&&this._randomRotationRenderers?.has(t)){const i=this._randomRotationRenderers.get(t),n=e.attributes[i],o=new s.a(0);o.updateFloatArray([n]),o.updateUint8Array([173]),r.heading=8.381e-8*o.digest()}return r}getRenderingInfoAsync(e,t,i,r){return(0,m.xn)(e,{renderer:t,arcade:i,...r})}getSymbolLayerSize(e,t){return this.graphicsCore?.getSymbolLayerSize(e,t)}setObjectIdVisibility(e,t){this.graphicsCore?.setObjectIdVisibility(e,t)}refreshFilter(){null!=this.filterVisibility&&this.filterVisibility.reapply()}getGraphics3DGraphicByObjectId(e){return this.graphicsCore?.getGraphics3DGraphicByObjectId(e)}_updateClippingExtent(){const e=this.owner.view.clippingArea;this.graphicsCore.setClippingExtent(e,this.owner.view.spatialReference)&&(this.updateClippingExtent(e)||this.graphicsCore.recreateAllGraphics())}_setupSuspendResumeExtent(){(this.frustumVisibility||this.scaleVisibility)&&this.addHandles((0,c.YP)((()=>this.suspendResumeExtentMode),(()=>{switch(this.removeHandles(q),this.suspendResumeExtentMode){case"computed":this.addHandles([(0,c.YP)((()=>this.graphicsCore.computedExtent),(e=>this._updateSuspendResumeExtent(e)),c.nn),(0,c.YP)((()=>this.graphicsCore.extentPadding),(()=>this._updateSuspendResumeExtent(this.graphicsCore.computedExtent)))],q);break;case"data":this.addHandles([(0,c.gx)((()=>this.dataExtent),(e=>this._updateSuspendResumeExtent(e)),c.nn),(0,c.YP)((()=>this.graphicsCore.extentPadding),(()=>this._updateSuspendResumeExtent(this.dataExtent)))],q);break;default:(0,o.Bg)(this.suspendResumeExtentMode)}}),c.nn))}_updateSuspendResumeExtent(e){e?this._suspendResumeExtentChanged(this._extentToSuspendResumeRect(e,this._suspendResumeExtent)):this._suspendResumeExtentChanged(null)}_extentToSuspendResumeRect(e,t){const i=this.owner.view.spatialReference;if(!e.spatialReference.equals(i)){if(!(0,g.Q8)(e,i))return;e=(0,g.iV)(e,i)}return(0,O.Go)(e,t,w.PY,this.graphicsCore.extentPadding)}_suspendResumeExtentChanged(e){null!=this.frustumVisibility&&this.frustumVisibility.setExtent(e),null!=this.scaleVisibility&&this.scaleVisibility.setExtent(e)}};(0,r._)([(0,h.Cb)()],j.prototype,"type",void 0),(0,r._)([(0,h.Cb)({constructOnly:!0})],j.prototype,"owner",void 0),(0,r._)([(0,h.Cb)()],j.prototype,"layer",null),(0,r._)([(0,h.Cb)()],j.prototype,"layerViewUid",null),(0,r._)([(0,h.Cb)({readOnly:!0})],j.prototype,"dataUpdating",null),(0,r._)([(0,h.Cb)()],j.prototype,"renderer",null),(0,r._)([(0,h.Cb)({constructOnly:!0})],j.prototype,"updateClippingExtent",void 0),(0,r._)([(0,h.Cb)({constructOnly:!0})],j.prototype,"elevationFeatureExpressionEnabled",void 0),(0,r._)([(0,h.Cb)({constructOnly:!0})],j.prototype,"graphicsCore",void 0),(0,r._)([(0,h.Cb)({constructOnly:!0})],j.prototype,"scaleVisibilityEnabled",void 0),(0,r._)([(0,h.Cb)({constructOnly:!0})],j.prototype,"filterVisibilityEnabled",void 0),(0,r._)([(0,h.Cb)({constructOnly:!0})],j.prototype,"frustumVisibilityEnabled",void 0),(0,r._)([(0,h.Cb)({constructOnly:!0})],j.prototype,"elevationAlignmentEnabled",void 0),(0,r._)([(0,h.Cb)({constructOnly:!0})],j.prototype,"timeExtentEnabled",void 0),(0,r._)([(0,h.Cb)({constructOnly:!0})],j.prototype,"setUidToIdOnAdd",void 0),(0,r._)([(0,h.Cb)()],j.prototype,"scaleVisibility",null),(0,r._)([(0,h.Cb)()],j.prototype,"filterVisibility",null),(0,r._)([(0,h.Cb)()],j.prototype,"elevationAlignment",null),(0,r._)([(0,h.Cb)({constructOnly:!0})],j.prototype,"frustumVisibility",void 0),(0,r._)([(0,h.Cb)()],j.prototype,"suspendResumeExtentMode",null),(0,r._)([(0,h.Cb)()],j.prototype,"dataExtent",void 0),(0,r._)([(0,h.Cb)()],j.prototype,"scaleVisibilitySuspended",null),(0,r._)([(0,h.Cb)()],j.prototype,"suspended",null),(0,r._)([(0,h.Cb)()],j.prototype,"legendEnabled",null),(0,r._)([(0,h.Cb)()],j.prototype,"suspendInfo",null),(0,r._)([(0,h.Cb)()],j.prototype,"updating",null),(0,r._)([(0,h.Cb)()],j.prototype,"updatingRemaining",null),(0,r._)([(0,h.Cb)()],j.prototype,"featureStore",null),(0,r._)([(0,h.Cb)()],j.prototype,"view",null),(0,r._)([(0,h.Cb)()],j.prototype,"loadedGraphics",null),(0,r._)([(0,h.Cb)()],j.prototype,"fullOpacity",null),(0,r._)([(0,h.Cb)()],j.prototype,"filter",null),(0,r._)([(0,h.Cb)()],j.prototype,"slicePlaneEnabled",null),(0,r._)([(0,h.Cb)()],j.prototype,"drapeSourceType",void 0),(0,r._)([(0,h.Cb)()],j.prototype,"updatePolicy",null),(0,r._)([(0,h.Cb)()],j.prototype,"preferredUpdatePolicy",void 0),(0,r._)([(0,h.Cb)({readOnly:!0})],j.prototype,"displayFeatureLimit",null),j=(0,r._)([(0,d.j)("esri.views.3d.layers.graphics.Graphics3DFeatureProcessor")],j);const q="suspendResumeExtentMode"},89548:function(e,t,i){i.d(t,{q:function(){return _}});var r=i(73440),n=i(70880),s=i(17155),o=(i(61432),i(96711),i(83850),i(48023)),a=i(71354),l=i(98842),u=i(33235),p=i(299),c=i(13878),h=i(29191),d=i(16395),y=i(85881);class f{constructor(e){this._cache=e.newCache("QueryEngine",null,-1)}clear(){this._cache.clear()}destroy(){this._cache.destroy()}get(e){return this._cache.get(e)?.items}put(e,t){this._cache.put(e,new g(t))}get test(){}}class g{constructor(e){this.items=e}get cachedMemory(){return this.items.reduce(((e,t)=>e+t.usedMemory),y.HG+y.Mm)}}const m=u.qq;let _=class extends n.Z{constructor(e){super(e),this._dataQueryEngineInstance=null}destroy(){this.clear()}get layer(){return this.context.layer}get spatialReference(){return this.context.spatialReference}get _queryGeometryType(){switch(this.layer.geometryType){case"multipoint":case"point":case"polygon":case"polyline":return this.layer.geometryType;case"mesh":return"polygon";default:return}}get defaultQueryJSON(){return new h.Z({outSpatialReference:this.spatialReference}).toJSON()}clear(){return!!this._dataQueryEngineInstance&&(this._dataQueryEngineInstance.destroy(),this._dataQueryEngineInstance=null,!0)}async executeQueryForIdSet(e,t,i){return this._dataQueryEngine.executeQueryForIdSet(this._ensureQueryJSON(e,t),i)}async executeQueryForCount(e,t){return this._dataQueryEngine.executeQueryForCount(this._ensureQueryJSON(e),t)}async executeQueryForExtent(e,t){const{count:i,extent:r}=await this._dataQueryEngine.executeQueryForExtent(this._ensureQueryJSON(e),t);return{count:i,extent:a.Z.fromJSON(r)}}async executeQueryForIds(e,t){return this._dataQueryEngine.executeQueryForIds(this._ensureQueryJSON(e),t)}async executeQueryForLatestObservations(e,t){const i=await this._dataQueryEngine.executeQueryForLatestObservations(this._ensureQueryJSON(e),t),r=c.Z.fromJSON(i);return r.features.forEach((e=>{e.layer=this.layer,e.sourceLayer=this.layer})),r}async executeQuery(e,t){const i=await this._dataQueryEngine.executeQuery(this._ensureQueryJSON(e),t),r=c.Z.fromJSON(i);return r.features.forEach((e=>{e.layer=this.layer,e.sourceLayer=this.layer})),r}_ensureQueryJSON(e,t){let i=this.defaultQueryJSON;if(null!=e&&("outSpatialReference"in e&&!e.outSpatialReference&&(e.outSpatialReference=this.spatialReference),i=e.toJSON(),i.cacheHint=!0),null!=t){const e=t.geometries.map((e=>e.toJSON())).reduce(((e,t)=>(e.rings=e.rings.concat(t.rings),e)));i={...i,cacheHint:!0,sceneFilter:{...t,geometry:e}}}return i}get _dataQueryEngine(){if(this._dataQueryEngineInstance)return this._dataQueryEngineInstance;const{priority:e,layer:t}=this,i="timeInfo"in t&&t.timeInfo?.toJSON()||null,r=(0,d.c)(t),n=l.Mk.toJSON(this._queryGeometryType),s=t.fieldsIndex?.toJSON()||new p.Z([]),o=this.spatialReference.toJSON(),{hasZ:a,hasM:u,featureStore:c,scheduler:h,memoryController:y}=this.context,g=new f(y);return this._dataQueryEngineInstance=new m({hasZ:a,hasM:u,geometryType:n,fieldsIndex:s,timeInfo:i,spatialReference:o,featureIdInfo:r,featureStore:c,scheduler:h,cache:g,priority:e}),this._dataQueryEngineInstance}};(0,r._)([(0,s.Cb)({constructOnly:!0})],_.prototype,"context",void 0),(0,r._)([(0,s.Cb)({constructOnly:!0})],_.prototype,"priority",void 0),(0,r._)([(0,s.Cb)()],_.prototype,"layer",null),(0,r._)([(0,s.Cb)()],_.prototype,"spatialReference",null),(0,r._)([(0,s.Cb)()],_.prototype,"_queryGeometryType",null),(0,r._)([(0,s.Cb)()],_.prototype,"defaultQueryJSON",null),_=(0,r._)([(0,o.j)("esri.views.3d.layers.graphics.QueryEngine")],_)},17807:function(e,t,i){i.d(t,{s:function(){return r}});class r{constructor(e,t,i,r,n,s){this.spatialReference=e,this.layer=t,this.resourceController=i,this._getFeatureStore=r,this.hasZ=n,this.hasM=s}get scheduler(){return this.resourceController.scheduler}get memoryController(){return this.resourceController.memoryController}get featureStore(){return this._getFeatureStore()}}},79147:function(e,t,i){i.d(t,{n:function(){return _}});var r=i(73440),n=i(70880),s=i(96711),o=i(61100),a=i(93568),l=i(90403),u=i(48797),p=i(17155),c=(i(61432),i(83850),i(48023)),h=i(60147),d=i(58174),y=i(44695),f=i(89548),g=i(17807),m=i(50399);let _=class extends n.Z{constructor(e){super(e),this._frameTask=null,this._queryEngine=null,this._updateRequested=!0,this._updatingHandles=new h.R,this._abortController=new AbortController}initialize(){const e=m.T8.FILTER_VISIBILITY,{layer:t,view:i}=this._configuration,{featureStore:r}=this.context,{spatialReference:n,resourceController:s}=i,o=this._configuration.hasZ??!1,u=this._configuration.hasM??!1,p=new g.s(n,t,s,(()=>r),o,u);this._queryEngine=new f.q({context:p,priority:e}),this._frameTask=i.resourceController.scheduler.registerTask(e),this._updatingHandles.add((()=>[this._compositedFeatureFilter,this._sceneFilter]),(()=>this._updateRequested=!0),l.nn),this._updatingHandles.addWhen((()=>!this._frameTask.updating&&this._updateRequested),(()=>{this._frameTask.schedule((()=>this._updateVisibility()),this._abortController.signal).catch(a.H9),this._updateRequested=!1}),l.nn)}destroy(){this._abortController.abort(),this._updatingHandles.destroy(),this.clear(),this._frameTask=(0,o.hw)(this._frameTask),this._queryEngine=(0,o.SC)(this._queryEngine),this._set("context",null)}get updating(){return this._updateRequested||this._updatingHandles.updating||this._frameTask.updating}get defaultVisibility(){return null==this._compositedFeatureFilter&&null==this._sceneFilter}get _featureFilter(){return"filter"in this._configuration?this._configuration.filter:null}get _effectiveDisplayFilter(){return"effectiveDisplayFilter"in this._configuration?this._configuration.effectiveDisplayFilter:null}get _sceneFilter(){return"layerFilter"in this._configuration?this._configuration.layerFilter:null}get _floorFilter(){return(0,y.c)(this._configuration)}get _timeExtent(){return"timeExtent"in this._configuration?this._configuration.timeExtent:null}get _compositedFeatureFilter(){const{_featureFilter:e,_effectiveDisplayFilter:t,_timeExtent:i,_floorFilter:r}=this;let n=e?.clone();if(null!=t&&(n??=new d.Z,n.where=(0,u._$)(n.where,t.where)),null!=i&&(n??=new d.Z,n.timeExtent=n.timeExtent?.intersection(i)??i),null!=r){n??=new d.Z;const e=null==n.where||""===n.where;n.where=e?r:(0,u._$)(n.where,r)}return n}get _configuration(){return this.context.configuration}reapply(){this._updateRequested=!0}clear(){this._queryEngine.clear(),this.context.clearFeaturesVisibility()}async _updateVisibility(){const{signal:e}=this._abortController,{context:t,_frameTask:i,_sceneFilter:r,_compositedFeatureFilter:n}=this;if((0,a.k_)(e),null==n&&null==r||0===t.getFeatureCount())return await i.schedule((()=>this.clear()),e);try{const s=await this._updatingHandles.addPromise(this._queryEngine.executeQueryForIdSet(n,r,e));return(0,a.k_)(e),await i.schedule((()=>{t.updateFeatureVisibilities((e=>s.has(e)))}),e)}catch(r){return(0,a.r9)(r),s.Z.getLogger(this).warn(`FeatureFilter query failed: ${r}`,{error:r}),await i.schedule((()=>{t.setAllFeaturesVisibility(!0)}),e)}}};(0,r._)([(0,p.Cb)({constructOnly:!0})],_.prototype,"context",void 0),(0,r._)([(0,p.Cb)()],_.prototype,"updating",null),(0,r._)([(0,p.Cb)()],_.prototype,"defaultVisibility",null),(0,r._)([(0,p.Cb)()],_.prototype,"_featureFilter",null),(0,r._)([(0,p.Cb)()],_.prototype,"_effectiveDisplayFilter",null),(0,r._)([(0,p.Cb)()],_.prototype,"_sceneFilter",null),(0,r._)([(0,p.Cb)()],_.prototype,"_floorFilter",null),(0,r._)([(0,p.Cb)()],_.prototype,"_timeExtent",null),(0,r._)([(0,p.Cb)()],_.prototype,"_compositedFeatureFilter",null),(0,r._)([(0,p.Cb)()],_.prototype,"_configuration",null),(0,r._)([(0,p.Cb)()],_.prototype,"_updateRequested",void 0),_=(0,r._)([(0,c.j)("esri.views.3d.layers.support.FeatureVisibilityFilter")],_)},62052:function(e,t,i){i.d(t,{s:function(){return s}});var r=i(15322);class n extends r.G{constructor(e,t){super(e,t,"webmap")}}function s(e){return null!=e&&"object"==typeof e&&"declaredClass"in e&&"esri.WebMap"===e.declaredClass}new n(2,34)}}]);