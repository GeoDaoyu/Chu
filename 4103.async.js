"use strict";(self.webpackChunkscene_pro=self.webpackChunkscene_pro||[]).push([[4103],{53147:function(e,t,n){n.d(t,{Z:function(){return d}});var r,o,i=n(38461),a=n(99574),s=n(95226);function l(e){return(0,a.uZ)((0,s.vU)(e),0,255)}function c(e,t){const n=e.toString(16).padStart(2,"0");return t?n.slice(0,1):n}class u{static blendColors(e,t,n,r=new u){return r.r=Math.round(e.r+(t.r-e.r)*n),r.g=Math.round(e.g+(t.g-e.g)*n),r.b=Math.round(e.b+(t.b-e.b)*n),r.a=e.a+(t.a-e.a)*n,r._sanitize()}static fromRgb(e,t){const n=(0,i.xO)(e);return n?u.fromArray(n,t):null}static fromHex(e,t=new u){const n=(0,i.yE)(e);return n?u.fromArray(n,t):null}static fromArray(e,t=new u){return t._set(Number(e[0]),Number(e[1]),Number(e[2]),Number(e[3])),isNaN(t.a)&&(t.a=1),t._sanitize()}static fromString(e,t){const n=(0,i.uh)(e);return n?u.fromArray(n,t):null}static fromJSON(e){return null!=e?new u([e[0],e[1],e[2],(e[3]??255)/255]):void 0}static toUnitRGB(e){return null!=e?[e.r/255,e.g/255,e.b/255]:null}static toUnitRGBA(e){return null!=e?[e.r/255,e.g/255,e.b/255,null!=e.a?e.a:1]:null}constructor(e){this.r=255,this.g=255,this.b=255,this.a=1,e&&this.setColor(e)}get isBright(){return.299*this.r+.587*this.g+.114*this.b>=127}setColor(e){return"string"==typeof e?u.fromString(e,this):Array.isArray(e)?u.fromArray(e,this):(this._set(e.r??0,e.g??0,e.b??0,e.a??1),e instanceof u||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(e){const t=e?.capitalize??!1,n=e?.digits??6,r=3===n||4===n,o=4===n||8===n,i=`#${c(this.r,r)}${c(this.g,r)}${c(this.b,r)}${o?c(Math.round(255*this.a),r):""}`;return t?i.toUpperCase():i}toCss(e=!1){const t=this.r+", "+this.g+", "+this.b;return e?`rgba(${t}, ${this.a})`:`rgb(${t})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(e=u.AlphaMode.ALWAYS){const t=l(this.r),n=l(this.g),r=l(this.b);return e===u.AlphaMode.ALWAYS||1!==this.a?[t,n,r,l(255*this.a)]:[t,n,r]}clone(){return new u(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(e){return null!=e&&e.r===this.r&&e.g===this.g&&e.b===this.b&&e.a===this.a}_sanitize(){return this.r=(0,i.OC)(this.r),this.g=(0,i.OC)(this.g),this.b=(0,i.OC)(this.b),this.a=(0,i.I2)(this.a),this}_set(e,t,n,r){this.r=e,this.g=t,this.b=n,this.a=r}}u.prototype.declaredClass="esri.Color",r=u||(u={}),(o=r.AlphaMode||(r.AlphaMode={}))[o.ALWAYS=0]="ALWAYS",o[o.UNLESS_OPAQUE=1]="UNLESS_OPAQUE";const d=u},2875:function(e,t,n){n.d(t,{a:function(){return d},b:function(){return s},c:function(){return a},d:function(){return o},e:function(){return f},f:function(){return u},l:function(){return c},n:function(){return h},t:function(){return i}});var r=n(38461);n(61432),n(96711);function o(e,t,n){i(e.typedBuffer,t.typedBuffer,n,e.typedBufferStride,t.typedBufferStride)}function i(e,t,n,r=3,o=r){if(e.length/r!==Math.ceil(t.length/o))return e;const i=e.length/r,a=n[0],s=n[1],l=n[2],c=n[4],u=n[5],d=n[6],f=n[8],h=n[9],p=n[10],m=n[12],y=n[13],v=n[14];let g=0,b=0;for(let n=0;n<i;n++){const n=t[g],i=t[g+1],x=t[g+2];e[b]=a*n+c*i+f*x+m,e[b+1]=s*n+u*i+h*x+y,e[b+2]=l*n+d*i+p*x+v,g+=o,b+=r}return e}function a(e,t,n){s(e.typedBuffer,t.typedBuffer,n,e.typedBufferStride,t.typedBufferStride)}function s(e,t,n,r=3,o=r){if(e.length/r!==Math.ceil(t.length/o))return;const i=e.length/r,a=n[0],s=n[1],l=n[2],c=n[3],u=n[4],d=n[5],f=n[6],h=n[7],p=n[8];let m=0,y=0;for(let n=0;n<i;n++){const n=t[m],i=t[m+1],v=t[m+2];e[y]=a*n+c*i+f*v,e[y+1]=s*n+u*i+h*v,e[y+2]=l*n+d*i+p*v,m+=o,y+=r}}function l(e,t,n,r=3,o=r){const i=Math.min(e.length/r,t.length/o);let a=0,s=0;for(let l=0;l<i;l++)e[s]=n*t[a],e[s+1]=n*t[a+1],e[s+2]=n*t[a+2],a+=o,s+=r;return e}function c(e,t,n,r){u(e.typedBuffer,t.typedBuffer,n,r,e.typedBufferStride,t.typedBufferStride)}function u(e,t,n,o,i=3,a=i){const s=Math.min(e.length/i,t.length/a);let l=0,c=0;const u=1/r.jm;for(let r=0;r<s;r++)e[c]=o*(n*t[l])**u,e[c+1]=o*(n*t[l+1])**u,e[c+2]=o*(n*t[l+2])**u,l+=a,c+=i}function d(e,t,n,r=3,o=r){const i=e.length/r;if(i!==Math.ceil(t.length/o))return e;let a=0,s=0;for(let l=0;l<i;l++)e[s]=t[a]+n[0],e[s+1]=t[a+1]+n[1],e[s+2]=t[a+2]+n[2],a+=o,s+=r;return e}function f(e,t){h(e.typedBuffer,t.typedBuffer,e.typedBufferStride,t.typedBufferStride)}function h(e,t,n=3,r=n){const o=Math.min(e.length/n,t.length/r);let i=0,a=0;for(let s=0;s<o;s++){const o=t[i],s=t[i+1],l=t[i+2],c=o*o+s*s+l*l;if(c>0){const t=1/Math.sqrt(c);e[a]=t*o,e[a+1]=t*s,e[a+2]=t*l}i+=r,a+=n}}Object.freeze(Object.defineProperty({__proto__:null,linearToSRGB:u,linearToSRGBView:c,normalize:h,normalizeView:f,scale:l,scaleView:function(e,t,n){l(e.typedBuffer,t.typedBuffer,n,e.typedBufferStride,t.typedBufferStride)},shiftRight:function(e,t,n){const r=Math.min(e.count,t.count),o=e.typedBuffer,i=e.typedBufferStride,a=t.typedBuffer,s=t.typedBufferStride;let l=0,c=0;for(let e=0;e<r;e++)o[c]=a[l]>>n,o[c+1]=a[l+1]>>n,o[c+2]=a[l+2]>>n,l+=s,c+=i},transformMat3:s,transformMat3View:a,transformMat4:i,transformMat4View:o,translate:d},Symbol.toStringTag,{value:"Module"}))},64497:function(e,t,n){n.d(t,{I:function(){return o},v:function(){return i}});var r=n(99574);function o(e,t,n=0){const o=(0,r.uZ)(e,0,l);for(let e=0;e<4;e++)t[n+e]=Math.floor(256*c(o*a[e]))}function i(e,t=0){let n=0;for(let r=0;r<4;r++)n+=e[t+r]*s[r];return n}const a=[1,256,65536,16777216],s=[1/256,1/65536,1/16777216,1/4294967296],l=i(new Uint8ClampedArray([255,255,255,255]));function c(e){return e-Math.floor(e)}},37580:function(e,t,n){n.d(t,{q:function(){return l}});var r=n(3480),o=n(50702),i=n(96711),a=n(93568),s=n(82592);class l{constructor(e,t,n,r,o={}){this._mainMethod=t,this._transferLists=n,this._listeners=[],this._promise=(0,s.bA)(e,{...o,schedule:r}).then((e=>{if(void 0===this._thread){this._thread=e,this._promise=null,o.hasInitialize&&this.broadcast({},"initialize");for(const e of this._listeners)this._connectListener(e)}else e.close()})),this._promise.catch((t=>i.Z.getLogger("esri.core.workers.WorkerHandle").error(`Failed to initialize ${e} worker: ${t}`)))}on(e,t){const n={removed:!1,eventName:e,callback:t,threadHandle:null};return this._listeners.push(n),this._connectListener(n),(0,o.kB)((()=>{n.removed=!0,(0,r.Od)(this._listeners,n),this._thread&&null!=n.threadHandle&&n.threadHandle.remove()}))}destroy(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null,this._listeners.length=0,this._transferLists={}}invoke(e,t,n){return this.invokeMethod(this._mainMethod,e,t,n)}invokeMethod(e,t,n,r){if(this._thread){const o=this._transferLists[e],i=o?o(t):[];return this._thread.invoke(e,t,{transferList:i,signal:n,priority:r})}return this._promise?this._promise.then((()=>((0,a.k_)(n),this.invokeMethod(e,t,n)))):Promise.reject(null)}broadcast(e,t){return this._thread?Promise.all(this._thread.broadcast(t,e)).then((()=>{})):this._promise?this._promise.then((()=>this.broadcast(e,t))):Promise.reject()}get promise(){return this._promise}_connectListener(e){this._thread&&this._thread.on(e.eventName,e.callback).then((t=>{e.removed||(e.threadHandle=t)}))}}},25657:function(e,t,n){n.d(t,{Z:function(){return u}});var r,o=n(73440),i=n(89314),a=n(63255),s=n(17155),l=(n(61432),n(96711),n(83850),n(79775)),c=n(48023);let u=class extends(i.Z.ClonableMixin(a.Z)){static{r=this}constructor(e){super(e),this.type="georeferenced",this.origin=null}static{this.absolute=new r}};(0,o._)([(0,l.J)({georeferenced:"georeferenced"},{readOnly:!0})],u.prototype,"type",void 0),(0,o._)([(0,s.Cb)({type:[Number],nonNullable:!1,json:{write:!0}})],u.prototype,"origin",void 0),u=r=(0,o._)([(0,c.j)("esri.geometry.support.MeshGeoreferencedVertexSpace")],u)},93466:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(73440),o=n(89314),i=n(63255),a=n(17155),s=(n(61432),n(96711),n(83850),n(79775)),l=n(48023),c=n(82846);let u=class extends(o.Z.ClonableMixin(i.Z)){constructor(e){super(e),this.type="local",this.origin=(0,c.Ue)()}};(0,r._)([(0,s.J)({local:"local"},{readOnly:!0})],u.prototype,"type",void 0),(0,r._)([(0,a.Cb)({type:[Number],nonNullable:!0,json:{write:!0}})],u.prototype,"origin",void 0),u=(0,r._)([(0,l.j)("esri.geometry.support.MeshLocalVertexSpace")],u)},98842:function(e,t,n){n.d(t,{Mk:function(){return u},P$:function(){return d},qM:function(){return f}});var r=n(41773),o=n(71354),i=n(82890),a=n(82868),s=n(60508),l=n(67764),c=n(62197);const u=(0,r.w)()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),d=(0,r.w)()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"}),f={base:i.Z,key:"type",typeMap:{extent:o.Z,multipoint:a.Z,point:s.Z,polyline:c.Z,polygon:l.Z}}},41964:function(e,t,n){n.d(t,{u:function(){return l}});var r,o=n(73440),i=n(63255),a=n(17155),s=(n(61432),n(96711),n(83850),n(48023));let l=r=class extends i.Z{constructor(e){super(e),this.name=null,this.code=null}clone(){return new r({name:this.name,code:this.code})}};(0,o._)([(0,a.Cb)({type:String,json:{write:{isRequired:!0}}})],l.prototype,"name",void 0),(0,o._)([(0,a.Cb)({type:[String,Number],json:{write:{isRequired:!0}}})],l.prototype,"code",void 0),l=r=(0,o._)([(0,s.j)("esri.layers.support.CodedValue")],l)},37127:function(e,t,n){n.d(t,{Z:function(){return d}});var r,o=n(73440),i=n(28947),a=n(17155),s=(n(61432),n(96711),n(79775)),l=n(48023),c=n(41964),u=n(85853);let d=class extends u.Z{static{r=this}constructor(e){super(e),this.codedValues=null,this.type="coded-value"}getName(e){let t=null;if(this.codedValues){const n=String(e);this.codedValues.some((e=>(String(e.code)===n&&(t=e.name),!!t)))}return t}clone(){return new r({codedValues:(0,i.d9)(this.codedValues),name:this.name})}};(0,o._)([(0,a.Cb)({type:[c.u],json:{write:{isRequired:!0}}})],d.prototype,"codedValues",void 0),(0,o._)([(0,s.J)({codedValue:"coded-value"})],d.prototype,"type",void 0),d=r=(0,o._)([(0,l.j)("esri.layers.support.CodedValueDomain")],d)},85853:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(73440),o=n(41773),i=n(63255),a=n(17155),s=(n(61432),n(96711),n(83850),n(79775)),l=n(48023);const c=new o.X({inherited:"inherited",codedValue:"coded-value",range:"range"});let u=class extends i.Z{constructor(e){super(e),this.name=null,this.type=null}};(0,r._)([(0,a.Cb)({type:String,json:{write:!0}})],u.prototype,"name",void 0),(0,r._)([(0,s.J)(c),(0,a.Cb)({json:{write:{isRequired:!0}}})],u.prototype,"type",void 0),u=(0,r._)([(0,l.j)("esri.layers.support.Domain")],u)},49651:function(e,t,n){n.d(t,{Z:function(){return m}});var r,o=n(73440),i=n(41773),a=n(63255),s=n(17155),l=n(95226),c=(n(61432),n(83850),n(79775)),u=n(1194),d=n(48023),f=n(76746),h=n(72396);const p=new i.X({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let m=class extends a.Z{static{r=this}constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(e,{description:t}){let n=null;try{n=t?JSON.parse(t):null}catch(e){}return n?.value??null}readValueType(e,{description:t}){let n=null;try{n=t?JSON.parse(t):null}catch(e){}return n?p.fromJSON(n.fieldValueType):null}clone(){return new r({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain?.clone()??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};(0,o._)([(0,s.Cb)({type:String,json:{write:!0}})],m.prototype,"alias",void 0),(0,o._)([(0,s.Cb)({type:[String,Number],json:{write:{allowNull:!0}}})],m.prototype,"defaultValue",void 0),(0,o._)([(0,s.Cb)()],m.prototype,"description",void 0),(0,o._)([(0,u.r)("description")],m.prototype,"readDescription",null),(0,o._)([(0,s.Cb)({types:f.V5,json:{read:{reader:f.im},write:!0}})],m.prototype,"domain",void 0),(0,o._)([(0,s.Cb)({type:Boolean,json:{write:!0}})],m.prototype,"editable",void 0),(0,o._)([(0,s.Cb)({type:l.z8,json:{write:{overridePolicy:e=>({enabled:Number.isFinite(e)})}}})],m.prototype,"length",void 0),(0,o._)([(0,s.Cb)({type:String,json:{write:!0}})],m.prototype,"name",void 0),(0,o._)([(0,s.Cb)({type:Boolean,json:{write:!0}})],m.prototype,"nullable",void 0),(0,o._)([(0,c.J)(h.v)],m.prototype,"type",void 0),(0,o._)([(0,s.Cb)()],m.prototype,"valueType",void 0),(0,o._)([(0,u.r)("valueType",["description"])],m.prototype,"readValueType",null),(0,o._)([(0,s.Cb)({type:Boolean,json:{read:!1}})],m.prototype,"visible",void 0),m=r=(0,o._)([(0,d.j)("esri.layers.support.Field")],m)},39502:function(e,t,n){n.d(t,{Z:function(){return l}});var r,o=n(73440),i=(n(96711),n(61432),n(83850),n(88194),n(79775)),a=n(48023),s=n(85853);let l=class extends s.Z{static{r=this}constructor(e){super(e),this.type="inherited"}clone(){return new r}};(0,o._)([(0,i.J)({inherited:"inherited"})],l.prototype,"type",void 0),l=r=(0,o._)([(0,a.j)("esri.layers.support.InheritedDomain")],l)},95951:function(e,t,n){n.d(t,{Z:function(){return c}});var r,o=n(73440),i=n(17155),a=(n(61432),n(96711),n(83850),n(79775)),s=n(48023),l=n(85853);let c=class extends l.Z{static{r=this}constructor(e){super(e),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new r({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};(0,o._)([(0,i.Cb)({json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range?.[1]},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(e,t,n){t[n]=[this.minValue||0,e]},isRequired:!0}}})],c.prototype,"maxValue",void 0),(0,o._)([(0,i.Cb)({json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range?.[0]},write:{target:"range",writer(e,t,n){t[n]=[e,this.maxValue||0]},isRequired:!0}}})],c.prototype,"minValue",void 0),(0,o._)([(0,a.J)({range:"range"})],c.prototype,"type",void 0),c=r=(0,o._)([(0,s.j)("esri.layers.support.RangeDomain")],c)},76746:function(e,t,n){n.d(t,{V5:function(){return s},im:function(){return l}});n(61432);var r=n(37127),o=n(85853),i=n(39502),a=n(95951);const s={key:"type",base:o.Z,typeMap:{range:a.Z,"coded-value":r.Z,inherited:i.Z}};function l(e){if(!e?.type)return null;switch(e.type){case"range":return a.Z.fromJSON(e);case"codedValue":return r.Z.fromJSON(e);case"inherited":return i.Z.fromJSON(e)}return null}},72396:function(e,t,n){n.d(t,{v:function(){return r}});const r=new(n(41773).X)({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"})},94701:function(e,t,n){var r,o;n.d(t,{B:function(){return o},P:function(){return r}}),function(e){e[e.None=0]="None",e[e.Int16=1]="Int16",e[e.Int32=2]="Int32"}(r||(r={})),function(e){e[e.Replace=0]="Replace",e[e.Outside=1]="Outside",e[e.Inside=2]="Inside",e[e.Finished=3]="Finished"}(o||(o={}))},55656:function(e,t,n){n.d(t,{OV:function(){return f},S9:function(){return m},YQ:function(){return u},yF:function(){return d}});var r=n(96711),o=n(63974),i=n(82846),a=n(37580),s=n(13132),l=n(2051),c=n(94701);class u{constructor(e,t,n,r,o,i){this.layout=e,this.interleavedVertexData=t,this.indices=n,this.hasColors=r,this.hasModifications=o,this.positionData=i}}class d{constructor(e,t,n,r,o,i,a){this.componentOffsets=e,this.featureIds=t,this.anchorIds=n,this.anchors=r,this.transformedGeometry=o,this.globalTrafo=i,this.obb=a}}class f extends a.q{constructor(e){super("SceneLayerWorker","process",{process:e=>[e.geometryBuffer],project:e=>[e.positions.buffer],transformNormals:e=>[e.normals.buffer]},e,{hasInitialize:!0})}setModifications(e,t,n,r){const o={context:e,modifications:m(t,n,r),isGeodetic:r.isGeographic};this.broadcast(o,"setModifications")}setLegacySchema(e,t){const n=JSON.stringify(t);return this.broadcast({context:e,jsonSchema:n},"setLegacySchema")}destroyContext(e){return this.broadcast(e,"destroyContext")}project(e,t){return this.invokeMethod("project",e,t)}transformNormals(e,t){return this.invokeMethod("transformNormals",e,t)}}const h=new o.Z({deallocator:null}),p=(0,i.Ue)();function m(e,t,n){h.clear();let o=1/0,i=1/0,a=-1/0,u=-1/0,d=!1;for(const e of t){const t="clip"===e.type?c.B.Inside:"mask"===e.type?c.B.Outside:c.B.Replace,f=e.geometry;let m=e=>e;if(f.spatialReference){if(!(0,s.canProjectWithoutEngine)(f.spatialReference,n)){r.Z.getLogger("esri.views.3d.layers.I3SMeshWorkerHandle").warn("Can't project modification polygon into layer spatial reference, ignoring modification");continue}m=e=>((0,l.S)(e,f.spatialReference,p,n),p)}else f.hasZ||(p[2]=0,m=e=>(p[0]=e[0],p[1]=e[1],p));d=d||t===c.B.Outside,h.push(t),h.push(f.rings.length);for(const e of f.rings){h.push(e.length);for(const t of e){const e=m(t);h.push(e[0]),h.push(e[1]),h.push(e[2]),o=Math.min(o,e[0]),i=Math.min(i,e[1]),a=Math.max(a,e[0]),u=Math.max(u,e[1])}}}if(null!=e)if(d){const t=1e-4;h.push(c.B.Inside),h.push(2),h.push(4),h.push(o-t),h.push(i-t),h.push(0),h.push(a+t),h.push(i-t),h.push(0),h.push(a+t),h.push(u+t),h.push(0),h.push(o-t),h.push(u+t),h.push(0),h.push(4),h.push(e[0]),h.push(e[1]),h.push(0),h.push(e[2]),h.push(e[1]),h.push(0),h.push(e[2]),h.push(e[3]),h.push(0),h.push(e[0]),h.push(e[3]),h.push(0)}else h.push(c.B.Outside),h.push(1),h.push(4),h.push(e[0]),h.push(e[1]),h.push(0),h.push(e[2]),h.push(e[1]),h.push(0),h.push(e[2]),h.push(e[3]),h.push(0),h.push(e[0]),h.push(e[3]),h.push(0);h.push(c.B.Finished);const f=new Float64Array(h.length);for(let e=0;e<h.length;++e)f[e]=h.at(e);return f}},16662:function(e,t,n){n.r(t),n.d(t,{destroyContext:function(){return w},dracoDecompressPointCloudData:function(){return m},filterObbsForModifications:function(){return y},filterObbsForModificationsSync:function(){return _},initialize:function(){return F},interpretObbModificationResults:function(){return R},process:function(){return p},project:function(){return b},setLegacySchema:function(){return g},setModifications:function(){return v},setModificationsSync:function(){return S},test:function(){return N},transformNormals:function(){return x}});var r=n(99574),o=n(45213),i=n(25657),a=n(93466),s=n(2875),l=n(94701),c=n(1800);function u(e){return(0,c.V)(`esri/libs/i3s/${e}`)}let d;var f=n(55656),h=n(23996);async function p(e){M=await P();const t=[e.geometryBuffer];return{result:T(M,e,t),transferList:t}}async function m(e){M=await P();const t=[e.geometryBuffer],{geometryBuffer:n}=e,r=n.byteLength,o=M._malloc(r),i=new Uint8Array(M.HEAPU8.buffer,o,r);i.set(new Uint8Array(n));const a=M.dracoDecompressPointCloudData(o,i.byteLength);if(M._free(o),a.error.length>0)throw new Error(`i3s.wasm: ${a.error}`);const s=a.featureIds?.length>0?a.featureIds.slice():null,l=a.positions.slice();return s&&t.push(s.buffer),t.push(l.buffer),{result:{positions:l,featureIds:s},transferList:t}}async function y(e){await P(),_(e);const t={buffer:e.buffer};return{result:t,transferList:[t.buffer]}}async function v(e){await P(),S(e)}async function g(e){M=await P(),M.setLegacySchema(e.context,e.jsonSchema)}async function b(e){const{localMatrix:t,origin:r,positions:s,vertexSpace:l}=e,c=o.Z.fromJSON(e.inSpatialReference),u=o.Z.fromJSON(e.outSpatialReference);let d;const[{projectBuffer:f},{initializeProjection:h}]=await Promise.all([Promise.resolve().then(n.bind(n,30146)),Promise.resolve().then(n.bind(n,13132))]);await h(c,u);const p=[0,0,0];if(!f(r,c,0,p,u,0))throw new Error("Failed to project");if("georeferenced"===l.type&&null==l.origin){if(d=new Float64Array(s.length),!f(s,c,0,d,u,0,d.length/3))throw new Error("Failed to project")}else{const e="georeferenced"===l.type?i.Z.fromJSON(l):a.Z.fromJSON(l),{projectMeshVertexPositions:r}=await n.e(98639).then(n.bind(n,98639)),o=r({vertexAttributes:{position:s},transform:t?{localMatrix:t}:void 0,vertexSpace:e,spatialReference:c},u);if(!o)throw new Error("Failed to project");d=o}const m=d.length,[y,v,g]=p;for(let e=0;e<m;e+=3)d[e]-=y,d[e+1]-=v,d[e+2]-=g;return{result:{projected:d,original:s,projectedOrigin:p},transferList:[d.buffer,s.buffer]}}async function x({normalMatrix:e,normals:t}){const n=new Float32Array(t.length);return(0,s.b)(n,t,e),(0,r.oc)(e)&&(0,s.n)(n,n),{result:{transformed:n,original:t},transferList:[n.buffer,t.buffer]}}function w(e){O(e)}let C,M;function S(e){if(!M)return;const t=e.modifications,n=M._malloc(8*t.length),r=new Float64Array(M.HEAPU8.buffer,n,t.length);for(let e=0;e<t.length;++e)r[e]=t[e];M.setModifications(e.context,n,t.length,e.isGeodetic),M._free(n)}function T(e,t,n){const{context:r,globalTrafo:o,mbs:i,obbData:a,elevationOffset:s,geometryBuffer:c,geometryDescriptor:u,indexToVertexProjector:d,vertexToRenderProjector:h}=t,p=e._malloc(c.byteLength),m=e._malloc(33*Float64Array.BYTES_PER_ELEMENT),y=new Uint8Array(e.HEAPU8.buffer,p,c.byteLength);y.set(new Uint8Array(c));const v=new Float64Array(e.HEAPU8.buffer,m,33);A(v,[NaN,NaN,NaN]);let g=v.byteOffset+3*v.BYTES_PER_ELEMENT,b=new Float64Array(v.buffer,g);A(b,o),g+=16*v.BYTES_PER_ELEMENT,b=new Float64Array(v.buffer,g),A(b,i),g+=4*v.BYTES_PER_ELEMENT,a&&(b=new Float64Array(v.buffer,g),A(b,a));const x=u,w={isDraco:!1,isLegacy:!1,color:t.layouts.some((e=>e.some((e=>"color"===e.name)))),normal:t.needNormals&&t.layouts.some((e=>e.some((e=>"normalCompressed"===e.name)))),uv0:t.layouts.some((e=>e.some((e=>"uv0"===e.name)))),uvRegion:t.layouts.some((e=>e.some((e=>"uvRegion"===e.name)))),featureIndex:x.featureIndex},C=e.process(r,!!t.obbData,p,y.byteLength,x,w,m,s,d,h,t.normalReferenceFrame);if(e._free(m),e._free(p),C.error.length>0)throw new Error(`i3s.wasm: ${C.error}`);if(C.discarded)return null;const M=C.componentOffsets.length>0?C.componentOffsets.slice():null,S=C.featureIds.length>0?C.featureIds.slice():null,T=C.anchorIds.length>0?Array.from(C.anchorIds):null,R=C.anchors.length>0?Array.from(C.anchors):null,_=C.interleavedVertedData.slice().buffer,O=C.indicesType===l.P.Int16?new Uint16Array(C.indices.buffer,C.indices.byteOffset,C.indices.byteLength/2).slice():new Uint32Array(C.indices.buffer,C.indices.byteOffset,C.indices.byteLength/4).slice(),F=C.positions.slice(),{buffer:P,byteOffset:N,byteLength:I}=C.positionIndices,E=C.positionIndicesType===l.P.Int16?new Uint16Array(P,N,I/2).slice():new Uint32Array(P,N,I/4).slice(),L=new f.YQ(t.layouts[0],_,O,C.hasColors,C.hasModifications,{data:F,indices:E});return S&&n.push(S.buffer),M&&n.push(M.buffer),n.push(_),n.push(O.buffer),n.push(F.buffer),n.push(E.buffer),new f.yF(M,S,T,R,L,o,C.obb)}function R(e){return 0===e?h.O4.Unmodified:1===e?h.O4.PotentiallyModified:2===e?h.O4.Culled:h.O4.Unknown}function _(e){if(!M)return;const{context:t,buffer:n}=e,r=M._malloc(n.byteLength),o=n.byteLength/Float64Array.BYTES_PER_ELEMENT,i=new Float64Array(M.HEAPU8.buffer,r,o),a=new Float64Array(n);i.set(a),M.filterOBBs(t,r,o),a.set(i),M._free(r)}function O(e){M&&0===M.destroy(e)&&(M=null)}function A(e,t){for(let n=0;n<t.length;++n)e[n]=t[n]}async function F(){M||await P()}async function P(){return M||(M=await(C??=(d||(d=new Promise((e=>n.e(22048).then(n.bind(n,22048)).then((e=>e.i)).then((({default:t})=>{const n=t({locateFile:u,onRuntimeInitialized:()=>e(n)});delete n.then})))).catch((e=>{throw e}))),d))),M}const N={transform:(e,t)=>M&&T(M,e,t),destroy:O}},23996:function(e,t,n){n.d(t,{$i:function(){return h},FE:function(){return s},Hw:function(){return i},NB:function(){return p},O4:function(){return o},U_:function(){return r},oQ:function(){return m},w5:function(){return a}});var r,o,i,a,s,l,c=n(27583),u=n(69055),d=n(52695),f=n(71298);class h extends f.r{constructor(e,t){super(NaN,NaN),this.id=e,this.serviceMbsInIndexSR=t,this.serviceMbsInRenderSR=(0,u.f)(0,0,0,-1)}invalidateServiceBVsInRenderSR(){(0,d.WD)(this.serviceMbsInRenderSR),this.serviceObbInRenderSR?.invalidate()}shareServiceBVsInRenderSRWith(e){this.serviceObbInRenderSR=e.serviceObbInRenderSR,this.serviceMbsInRenderSR=e.serviceMbsInRenderSR}}(l=r||(r={}))[l.Unmodified=0]="Unmodified",l[l.Culled=1]="Culled",l[l.NotChecked=2]="NotChecked",function(e){e[e.Unmodified=0]="Unmodified",e[e.PotentiallyModified=1]="PotentiallyModified",e[e.Culled=2]="Culled",e[e.Unknown=3]="Unknown",e[e.NotChecked=4]="NotChecked"}(o||(o={}));class p extends h{constructor(e,t,n,r,a,s,l,u,d,f){super(e,n),this.index=t,this.childCount=r,this.level=a,this.resources=s,this.version=l,this.lodMetric=u,this.maxError=d,this.numFeatures=f,this.failed=!1,this.cacheState=i.Unknown,this.vertexCount=0,this.memory=0,this.childrenLoaded=0,this.hasModifications=!1,this.imModificationImpact=o.NotChecked,this.elevationAgnosticBoundingVolume=(0,c.al)(0,0,0,-1)}invalidateServiceBVsInRenderSR(){super.invalidateServiceBVsInRenderSR(),this.elevationAgnosticBoundingVolume[3]=-1}}!function(e){e[e.Unknown=0]="Unknown",e[e.Uncached=1]="Uncached",e[e.Cached=2]="Cached"}(i||(i={})),function(e){e[e.None=0]="None",e[e.MaxScreenThreshold=1]="MaxScreenThreshold",e[e.ScreenSpaceRelative=2]="ScreenSpaceRelative",e[e.RemovedFeatureDiameter=3]="RemovedFeatureDiameter",e[e.DistanceRangeFromDefaultCamera=4]="DistanceRangeFromDefaultCamera"}(a||(a={})),function(e){e[e.Hole=0]="Hole",e[e.Leaf=1]="Leaf"}(s||(s={}));class m{constructor(e,t,n,r){this.nodeHasLOD=e,this.isChosen=t,this.lodLevel=n,this.version=r}}},80300:function(e,t,n){n.d(t,{hM:function(){return c},C8:function(){return u},$s:function(){return d},eU:function(){return l}});var r=n(53147),o=(n(61432),n(96094)),i=n(27583);var a=n(57225),s=n(49466);function l(e){return e&&e.enabled&&(function(e){return"extrude"===e.type}(e)||function(e){return"fill"===e.type}(e))&&null!=e.edges}function c(e,t){return u(function(e){return e&&e.enabled&&e.edges||null}(e),t)}function u(e,t){if(null==e)return null;const n=null!=e.color?(0,i.nI)(r.Z.toUnitRGBA(e.color)):(0,i.al)(0,0,0,0),a=(0,o.F2)(e.size),l=(0,o.F2)(e.extensionLength);switch(e.type){case"solid":return d({color:n,size:a,extensionLength:l,...t});case"sketch":return c={color:n,size:a,extensionLength:l,...t},{...h,...c,type:s.Pb.Sketch};default:return}var c}function d(e){return{...f,...e,type:s.Pb.Solid}}const f={color:(0,i.al)(0,0,0,.2),size:1,extensionLength:0,opacity:1,objectTransparency:a.i.OPAQUE,hasSlicePlane:!1},h={color:(0,i.al)(0,0,0,.2),size:1,extensionLength:0,opacity:1,objectTransparency:a.i.OPAQUE,hasSlicePlane:!1}},72432:function(e,t,n){n.d(t,{F5:function(){return a},HB:function(){return s},a9:function(){return r}});var r,o,i=n(99574);function a(e){switch(e){case"multiply":default:return r.Multiply;case"ignore":return r.Ignore;case"replace":return r.Replace;case"tint":return r.Tint}}function s(e,t,n){if(null==e||t===r.Ignore)return n[0]=255,n[1]=255,n[2]=255,void(n[3]=255);const o=(0,i.uZ)(Math.round(e[3]*c),0,c),a=0===o||t===r.Tint?0:t===r.Replace?u:d;n[0]=(0,i.uZ)(Math.round(e[0]*l),0,l),n[1]=(0,i.uZ)(Math.round(e[1]*l),0,l),n[2]=(0,i.uZ)(Math.round(e[2]*l),0,l),n[3]=o+a}(o=r||(r={}))[o.Multiply=1]="Multiply",o[o.Ignore=2]="Ignore",o[o.Replace=3]="Replace",o[o.Tint=4]="Tint";const l=255,c=85,u=c,d=2*c},71298:function(e,t,n){n.d(t,{r:function(){return r}});class r{constructor(e=1/0,t=-1/0){this.elevationRangeMin=e,this.elevationRangeMax=t}get elevationRangeValid(){return!Number.isNaN(this.elevationRangeMin)}invalidateElevationRange(){this.elevationRangeMin=NaN}expandElevationRangeValues(e,t){this.elevationRangeMin=Math.min(this.elevationRangeMin,e),this.elevationRangeMax=Math.max(this.elevationRangeMax,t)}expandElevationRange(e){this.elevationRangeMin=Math.min(this.elevationRangeMin,e.elevationRangeMin),this.elevationRangeMax=Math.max(this.elevationRangeMax,e.elevationRangeMax)}setElevationRange(e){this.elevationRangeMin=e.elevationRangeMin,this.elevationRangeMax=e.elevationRangeMax}}},54998:function(e,t,n){n.d(t,{AD:function(){return x},_N:function(){return h},nO:function(){return b},Hz:function(){return g}});var r=n(79487),o=n(64497),i=n(92638),a=n(41044),s=n(45701),l=n(90285),c=n(48857),u=n(5998),d=n(92217);class f extends d.x{constructor(e,t){super(e,"int",u.P.Draw,((n,r,o)=>n.setUniform1i(e,t(r,o))))}}var h,p,m=n(29193),y=n(95285),v=n(52061);(p=h||(h={}))[p.Uniform=0]="Uniform",p[p.Varying=1]="Varying",p[p.COUNT=2]="COUNT";const g=429496.7296;function b(e,t){(0,o.I)(e/g*.5+.5,t)}function x(e,t){switch(t.componentData){case h.Varying:return function(e,t){const{vertex:n,fragment:r}=e;n.include(s.n),n.uniforms.add(new m.R("componentColorTex",(e=>e.componentParameters.texture.texture))),e.attributes.add(v.T.COMPONENTINDEX,"float"),e.varyings.add("vExternalColorMixMode","mediump float"),e.varyings.add("vExternalColor","vec4");const o=t.output===a.H_.ObjectAndLayerIdColor;o&&e.varyings.add("vObjectAndLayerIdColor","vec4"),e.include(i.A),n.constants.add("stride","float",(0,y.B)()?3:2),n.code.add(c.H`vec2 getComponentTextureCoordinates(float componentIndex, float typeOffset) {
float index = componentIndex * stride + typeOffset;
float texSize = float(textureSize(componentColorTex, 0).x);
float coordX = mod(index, texSize);
float coordY = floor(index / texSize);
return vec2(coordX, coordY) + 0.5;
}`),n.code.add(c.H`
  vec4 _readComponentColor() {
    vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 0.0);
    return texelFetch(componentColorTex, ivec2(textureCoordinates), 0);
   }

  float readElevationOffset() {
    vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 1.0);
    vec4 encodedElevation = texelFetch(componentColorTex, ivec2(textureCoordinates), 0);
    return uninterpolatedRGBAToFloat(encodedElevation) * ${c.H.float(g)};
  }

  ${o?c.H`
          void forwardObjectAndLayerIdColor() {
            vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 2.0);
            vObjectAndLayerIdColor = texelFetch(componentColorTex, ivec2(textureCoordinates), 0);
          }`:c.H`void forwardObjectAndLayerIdColor() {}`}

  vec4 forwardExternalColor(out bool castShadows) {
    vec4 componentColor = _readComponentColor() * 255.0;

    float shadowFlag = mod(componentColor.b * 255.0, 2.0);
    componentColor.b -= shadowFlag;
    castShadows = shadowFlag >= 1.0;

    int decodedColorMixMode;
    vExternalColor = decodeSymbolColor(componentColor, decodedColorMixMode) * 0.003921568627451; // = 1/255;
    vExternalColorMixMode = float(decodedColorMixMode) + 0.5; // add 0.5 to avoid interpolation artifacts

    return vExternalColor;
  }
`),r.code.add(c.H`
  void readExternalColor(out vec4 externalColor, out int externalColorMixMode) {
    externalColor = vExternalColor;
    externalColorMixMode = int(vExternalColorMixMode);
  }

  void outputObjectAndLayerIdColor() {
     ${o?c.H`fragColor = vObjectAndLayerIdColor;`:""}
  }
`)}(e,t);case h.Uniform:return function(e,t){const{vertex:n,fragment:r}=e;e.varyings.add("vExternalColor","vec4"),n.uniforms.add(new l.$("externalColor",(e=>e.componentParameters.externalColor))).code.add(c.H`float readElevationOffset() {
return 0.0;
}
void forwardObjectAndLayerIdColor() {}
vec4 forwardExternalColor(out bool castShadows) {
vExternalColor = externalColor;
castShadows = true;
return externalColor;
}`);const o=t.output===a.H_.ObjectAndLayerIdColor;r.uniforms.add(new f("externalColorMixMode",(e=>e.componentParameters.externalColorMixMode))).code.add(c.H`
    void readExternalColor(out vec4 color, out int colorMixMode) {
      color = vExternalColor;
      colorMixMode = externalColorMixMode;
    }

    void outputObjectAndLayerIdColor() {
      ${(0,c.If)(o,"fragColor = vec4(0, 0, 0, 0);")}
    }
  `)}(e,t);case h.COUNT:return;default:(0,r.Bg)(t.componentData)}}},92638:function(e,t,n){n.d(t,{A:function(){return i}});var r=n(72432),o=n(48857);function i(e){e.vertex.code.add(o.H`
    vec4 decodeSymbolColor(vec4 symbolColor, out int colorMixMode) {
      float symbolAlpha = 0.0;

      const float maxTint = 85.0;
      const float maxReplace = 170.0;
      const float scaleAlpha = 3.0;

      if (symbolColor.a > maxReplace) {
        colorMixMode = ${o.H.int(r.a9.Multiply)};
        symbolAlpha = scaleAlpha * (symbolColor.a - maxReplace);
      } else if (symbolColor.a > maxTint) {
        colorMixMode = ${o.H.int(r.a9.Replace)};
        symbolAlpha = scaleAlpha * (symbolColor.a - maxTint);
      } else if (symbolColor.a > 0.0) {
        colorMixMode = ${o.H.int(r.a9.Tint)};
        symbolAlpha = scaleAlpha * symbolColor.a;
      } else {
        colorMixMode = ${o.H.int(r.a9.Multiply)};
        symbolAlpha = 0.0;
      }

      return vec4(symbolColor.r, symbolColor.g, symbolColor.b, symbolAlpha);
    }
  `)}},41044:function(e,t,n){var r;function o(e){return e===r.Shadow||e===r.ShadowHighlight||e===r.ShadowExcludeHighlight||e===r.ViewshedShadow}function i(e){return function(e){return m(e)||g(e)}(e)||e===r.Normal}function a(e){return v(e)||e===r.Normal}function s(e){return e===r.Highlight||e===r.ObjectAndLayerIdColor}function l(e){return c(e)||s(e)}function c(e){return e===r.Color}function u(e){return c(e)||b(e)}function d(e){return c(e)||e===r.ObjectAndLayerIdColor}function f(e){return u(e)||e===r.ObjectAndLayerIdColor}function h(e){return c(e)||e===r.Highlight}function p(e){return h(e)||g(e)}function m(e){return c(e)||s(e)}function y(e){return u(e)||s(e)}function v(e){return y(e)||g(e)}function g(e){return e===r.Depth}function b(e){return e===r.ColorEmission}function x(e){switch(e){case r.Depth:case r.Shadow:case r.ShadowHighlight:case r.ShadowExcludeHighlight:case r.ViewshedShadow:return!0}return!1}n.d(t,{BX:function(){return g},CQ:function(){return d},D5:function(){return c},ED:function(){return a},Gy:function(){return s},H_:function(){return r},Jb:function(){return i},Kr:function(){return o},L_:function(){return m},Lk:function(){return f},Qo:function(){return y},Xo:function(){return p},bB:function(){return x},c1:function(){return u},f_:function(){return v},qC:function(){return b},xs:function(){return l}}),function(e){e[e.Color=0]="Color",e[e.ColorEmission=1]="ColorEmission",e[e.Depth=2]="Depth",e[e.Normal=3]="Normal",e[e.Shadow=4]="Shadow",e[e.ShadowHighlight=5]="ShadowHighlight",e[e.ShadowExcludeHighlight=6]="ShadowExcludeHighlight",e[e.ViewshedShadow=7]="ViewshedShadow",e[e.Highlight=8]="Highlight",e[e.ObjectAndLayerIdColor=9]="ObjectAndLayerIdColor",e[e.COUNT=10]="COUNT"}(r||(r={}))},57716:function(e,t,n){n.d(t,{O:function(){return l},r:function(){return r}});var r,o,i=n(79487),a=n(48857),s=n(52061);function l(e,t){switch(t.normalType){case r.Compressed:e.attributes.add(s.T.NORMALCOMPRESSED,"vec2"),e.vertex.code.add(a.H`vec3 decompressNormal(vec2 normal) {
float z = 1.0 - abs(normal.x) - abs(normal.y);
return vec3(normal + sign(normal) * min(z, 0.0), z);
}
vec3 normalModel() {
return decompressNormal(normalCompressed);
}`);break;case r.Attribute:e.attributes.add(s.T.NORMAL,"vec3"),e.vertex.code.add(a.H`vec3 normalModel() {
return normal;
}`);break;case r.ScreenDerivative:e.fragment.code.add(a.H`vec3 screenDerivativeNormal(vec3 positionView) {
return normalize(cross(dFdx(positionView), dFdy(positionView)));
}`);break;default:(0,i.Bg)(t.normalType);case r.COUNT:}}(o=r||(r={}))[o.Attribute=0]="Attribute",o[o.Compressed=1]="Compressed",o[o.ScreenDerivative=2]="ScreenDerivative",o[o.COUNT=3]="COUNT"},28984:function(e,t,n){n.d(t,{$:function(){return i}});var r=n(13663),o=n(48857);function i({code:e,uniforms:t},n){t.add(new r.z("dpDummy",(()=>1))),e.add(o.H`vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {
vec3 hiD = hiA + hiB;
vec3 loD = loA + loB;
return  dpDummy * hiD + loD;
}`)}},45701:function(e,t,n){n.d(t,{n:function(){return o}});var r=n(48857);function o(e){e.code.add(r.H`const float MAX_RGBA_FLOAT =
255.0 / 256.0 +
255.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 / 256.0;
const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);
vec4 float2rgba(const float value) {
float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);
vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);
const float toU8AsFloat = 1.0 / 255.0;
return fixedPointU8 * toU8AsFloat;
}`),e.code.add(r.H`const vec4 RGBA_TO_FLOAT_FACTORS = vec4(
255.0 / (256.0),
255.0 / (256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0 * 256.0)
);
float rgbaTofloat(vec4 rgba) {
return dot(rgba, RGBA_TO_FLOAT_FACTORS);
}`),e.code.add(r.H`const vec4 uninterpolatedRGBAToFloatFactors = vec4(
1.0 / 256.0,
1.0 / 256.0 / 256.0,
1.0 / 256.0 / 256.0 / 256.0,
1.0 / 256.0 / 256.0 / 256.0 / 256.0
);
float uninterpolatedRGBAToFloat(vec4 rgba) {
return (dot(round(rgba * 255.0), uninterpolatedRGBAToFloatFactors) - 0.5) * 2.0;
}`)}},80357:function(e,t,n){n.d(t,{B:function(){return i}});var r=n(5998),o=n(92217);class i extends o.x{constructor(e,t){super(e,"vec3",r.P.Draw,((n,r,o,i)=>n.setUniform3fv(e,t(r,o,i))))}}},9535:function(e,t,n){n.d(t,{J:function(){return i}});var r=n(5998),o=n(92217);class i extends o.x{constructor(e,t){super(e,"vec3",r.P.Pass,((n,r,o)=>n.setUniform3fv(e,t(r,o))))}}},90285:function(e,t,n){n.d(t,{$:function(){return i}});var r=n(5998),o=n(92217);class i extends o.x{constructor(e,t){super(e,"vec4",r.P.Draw,((n,r,o)=>n.setUniform4fv(e,t(r,o))))}}},13663:function(e,t,n){n.d(t,{z:function(){return i}});var r=n(5998),o=n(92217);class i extends o.x{constructor(e,t){super(e,"float",r.P.Bind,((n,r)=>n.setUniform1f(e,t(r))))}}},15727:function(e,t,n){n.d(t,{j:function(){return i}});var r=n(5998),o=n(92217);class i extends o.x{constructor(e,t){super(e,"mat3",r.P.Draw,((n,r,o)=>n.setUniformMatrix3fv(e,t(r,o))))}}},57798:function(e,t,n){n.d(t,{c:function(){return i}});var r=n(5998),o=n(92217);class i extends o.x{constructor(e,t){super(e,"mat3",r.P.Pass,((n,r,o)=>n.setUniformMatrix3fv(e,t(r,o))))}}},18489:function(e,t,n){n.d(t,{C:function(){return i}});var r=n(5998),o=n(92217);class i extends o.x{constructor(e,t){super(e,"mat4",r.P.Bind,((n,r)=>n.setUniformMatrix4fv(e,t(r))))}}},29193:function(e,t,n){n.d(t,{R:function(){return i}});var r=n(5998),o=n(92217);class i extends o.x{constructor(e,t){super(e,"sampler2D",r.P.Draw,((n,r,o)=>n.bindTexture(e,t(r,o))))}}},48857:function(e,t,n){function r(e,...t){let n="";for(let r=0;r<t.length;r++)n+=e[r]+t[r];return n+=e[e.length-1],n}function o(e,t,n=""){return e?t:n}n.d(t,{H:function(){return r},If:function(){return o}}),function(e){e.int=function(e){return Math.round(e).toString()},e.float=function(e){return e.toPrecision(8)}}(r||(r={}))},95285:function(e,t,n){n.d(t,{B:function(){return o}});var r=n(61432);function o(){return!!(0,r.Z)("enable-feature:objectAndLayerId-rendering")}},57225:function(e,t,n){var r;n.d(t,{i:function(){return r}}),function(e){e[e.TRANSPARENT=0]="TRANSPARENT",e[e.OPAQUE=1]="OPAQUE"}(r||(r={}))},49466:function(e,t,n){n.d(t,{G7:function(){return o},Pb:function(){return r},UR:function(){return g},lV:function(){return b}});var r,o,i,a=n(54998),s=n(57716),l=n(28984),c=n(45701),u=n(80357),d=n(9535),f=n(48857),h=n(15727),p=n(57798),m=n(18489),y=n(29193),v=n(52061);function g(e,t){const{vertex:n}=e;n.include(c.n),e.include(s.O,t);const{silhouette:r,legacy:o,spherical:i}=t;n.uniforms.add(new y.R("componentDataTex",(e=>e.componentDataTexture))),e.attributes.add(v.T.COMPONENTINDEX,"float");n.constants.add("lineWidthFractionFactor","float",8),n.constants.add("extensionLengthOffset","float",128),n.code.add(f.H`
    vec2 _componentTextureCoords(float componentIndex, float fieldOffset) {
      float fieldIndex = ${f.H.float(3)}  * componentIndex + fieldOffset;
      float texSize = float(textureSize(componentDataTex, 0).x);
      float colIndex = mod(fieldIndex, texSize);
      float rowIndex = floor(fieldIndex / texSize);

      return vec2(colIndex, rowIndex) + 0.5;
    }

    struct ComponentData {
      vec4 color;
      vec3 normal;
      vec3 normal2;
      float lineWidth;
      float extensionLength;
      float type;
      float verticalOffset;
    };

    ComponentData readComponentData() {
      vec2 colorIndex = _componentTextureCoords(componentIndex, ${f.H.float(0)});
      vec2 otherIndex = _componentTextureCoords(componentIndex, ${f.H.float(1)});
      vec2 verticalOffsetIndex = _componentTextureCoords(float(componentIndex), ${f.H.float(2)} );
      vec3 normal = normalModel();
      vec3 normal2 = ${r?f.H`decompressNormal(normal2Compressed)`:f.H`normal`};

      vec4 colorValue = texelFetch(componentDataTex, ivec2(colorIndex), 0);
      vec4 otherValue = texelFetch(componentDataTex, ivec2(otherIndex), 0);
      float verticalOffset = uninterpolatedRGBAToFloat(texelFetch(componentDataTex, ivec2(verticalOffsetIndex), 0)) * ${f.H.float(a.Hz)};

      return ComponentData(
        vec4(colorValue.rgb, colorValue.a * otherValue.w), // otherValue.w stores separate opacity
        normal, normal2,
        otherValue.x * (255.0 / ${f.H.float(8)} ),
        otherValue.y * 255.0 - ${f.H.float(128)},
        -(otherValue.z * 255.0) + 0.5, // SOLID (=0/255) needs to be > 0.0, SKETCHY (=1/255) needs to be <= 0;
        verticalOffset
      );
    }
  `),o?n.code.add(f.H`vec3 _modelToWorldNormal(vec3 normal) {
return (model * vec4(normal, 0.0)).xyz;
}
vec3 _modelToViewNormal(vec3 normal) {
return (localView * model * vec4(normal, 0.0)).xyz;
}`):(n.uniforms.add(new h.j("transformNormalGlobalFromModel",(e=>e.transformNormalGlobalFromModel))),n.code.add(f.H`vec3 _modelToWorldNormal(vec3 normal) {
return transformNormalGlobalFromModel * normal;
}`)),r?(e.attributes.add(v.T.NORMAL2COMPRESSED,"vec2"),n.code.add(f.H`vec3 worldNormal(ComponentData data) {
return _modelToWorldNormal(normalize(data.normal + data.normal2));
}`)):n.code.add(f.H`vec3 worldNormal(ComponentData data) {
return _modelToWorldNormal(data.normal);
}`),o?n.code.add(f.H`void worldAndViewFromModelPosition(vec3 modelPos, float verticalOffset, out vec3 worldPos, out vec3 viewPos) {
worldPos = (model * vec4(modelPos, 1.0)).xyz;
viewPos = (localView * vec4(worldPos, 1.0)).xyz;
}`):(n.include(l.$,t),n.uniforms.add(new p.c("transformViewFromCameraRelativeRS",(e=>e.transformViewFromCameraRelativeRS)),new h.j("transformWorldFromModelRS",(e=>e.transformWorldFromModelRS)),new u.B("transformWorldFromModelTL",(e=>e.transformWorldFromModelTL)),new u.B("transformWorldFromModelTH",(e=>e.transformWorldFromModelTH)),new d.J("transformWorldFromViewTL",(e=>e.transformWorldFromViewTL)),new d.J("transformWorldFromViewTH",(e=>e.transformWorldFromViewTH))),n.code.add(f.H`
      void worldAndViewFromModelPosition(vec3 modelPos, float verticalOffset, out vec3 worldPos, out vec3 viewPos) {
        vec3 rotatedModelPosition = transformWorldFromModelRS * modelPos;

        vec3 transformCameraRelativeFromModel = dpAdd(
          transformWorldFromModelTL,
          transformWorldFromModelTH,
          -transformWorldFromViewTL,
          -transformWorldFromViewTH
        );

        worldPos = transformCameraRelativeFromModel + rotatedModelPosition;

        if (verticalOffset != 0.0) {
          vec3 vUp = ${i?"normalize(transformWorldFromModelTL + rotatedModelPosition);":"vec3(0.0, 0.0, 1.0);"}
          worldPos += verticalOffset * vUp;
        }

        viewPos = transformViewFromCameraRelativeRS * worldPos;
      }
    `)),n.uniforms.add(new m.C("transformProjFromView",(e=>e.camera.projectionMatrix))).code.add(f.H`vec4 projFromViewPosition(vec3 position) {
return transformProjFromView * vec4(position, 1.0);
}`),n.code.add(f.H`float calculateExtensionLength(float extensionLength, float lineLength) {
return extensionLength / (log2(max(1.0, 256.0 / lineLength)) * 0.2 + 1.0);
}`)}function b(e){return e===r.Sketch||e===r.Mixed}(i=r||(r={}))[i.Solid=0]="Solid",i[i.Sketch=1]="Sketch",i[i.Mixed=2]="Mixed",i[i.COUNT=3]="COUNT",function(e){e[e.REGULAR=0]="REGULAR",e[e.SILHOUETTE=1]="SILHOUETTE"}(o||(o={}))},27546:function(e,t,n){n.d(t,{Av:function(){return c},Cy:function(){return u},Dc:function(){return d},GB:function(){return l},Xi:function(){return f},_1:function(){return a},lE:function(){return h},rs:function(){return s},tl:function(){return i}});var r=n(88194),o=n(61432);function i(e){return e&&"function"==typeof e.highlight}function a(e){return e&&"function"==typeof e.maskOccludee}function s(e,t,n){return null==e||e>=n&&(0===t||e<=t)}function l(e,t){if(t&&e){const{minScale:n,maxScale:r}=e;if(c(n,r))return s(t,n,r)}return!0}function c(e,t){return null!=e&&e>0||null!=t&&t>0}function u(e){return!e?.minScale||!e.maxScale||e.minScale>=e.maxScale}const d=()=>!(0,o.Z)("disable-feature:layer-based-scale-visibility");function f(e){return null!=e&&"object"==typeof e&&"createQuery"in e&&"queryFeatures"in e&&"layer"in e&&"view"in e}function h(e,t,n){return new r.Z("layerview:spatial-reference-incompatible",`The spatial reference of this ${e}${t?`(wkid:${t})`:""} is incompatible with the spatial reference of the view${n?`(wkid:${n})`:""}.`,{})}},5998:function(e,t,n){var r;n.d(t,{P:function(){return r}}),function(e){e[e.Bind=0]="Bind",e[e.Pass=1]="Pass",e[e.Draw=2]="Draw"}(r||(r={}))},92217:function(e,t,n){n.d(t,{x:function(){return o}});n(61432);var r=n(5998);class o{constructor(e,t,n,o,i=null){if(this.name=e,this.type=t,this.arraySize=i,this.bind={[r.P.Bind]:null,[r.P.Pass]:null,[r.P.Draw]:null},o)switch(n){case void 0:break;case r.P.Bind:this.bind[r.P.Bind]=o;break;case r.P.Pass:this.bind[r.P.Pass]=o;break;case r.P.Draw:this.bind[r.P.Draw]=o}}equals(e){return this.type===e.type&&this.name===e.name&&this.arraySize===e.arraySize}}}}]);