"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[29540,917],{32505:function(e,t,r){r.d(t,{a:function(){return s},f:function(){return i},n:function(){return o}});var n=r(59384);function o(e,t){s(e.typedBuffer,t.typedBuffer,e.typedBufferStride,t.typedBufferStride)}function s(e,t,r=2,o=r){const s=t.length/2;let i=0,a=0;if(!(0,n.fU)(t)||(0,n.Q7)(t)){for(let n=0;n<s;++n)e[i]=t[a],e[i+1]=t[a+1],i+=r,a+=o;return}const u=(0,n.Op)(t);if((0,n.B3)(t))for(let n=0;n<s;++n)e[i]=Math.max(t[a]/u,-1),e[i+1]=Math.max(t[a+1]/u,-1),i+=r,a+=o;else for(let n=0;n<s;++n)e[i]=t[a]/u,e[i+1]=t[a+1]/u,i+=r,a+=o}function i(e,t,r,n){const o=e.typedBuffer,s=e.typedBufferStride,i=n?.count??e.count;let a=(n?.dstIndex??0)*s;for(let e=0;e<i;++e)o[a]=t,o[a+1]=r,a+=s}Object.freeze(Object.defineProperty({__proto__:null,fill:i,normalizeIntegerBuffer:s,normalizeIntegerBufferView:o},Symbol.toStringTag,{value:"Module"}))},2875:function(e,t,r){r.d(t,{a:function(){return f},b:function(){return a},c:function(){return i},d:function(){return o},e:function(){return d},f:function(){return l},l:function(){return c},n:function(){return m},t:function(){return s}});var n=r(38461);r(61432),r(96711);function o(e,t,r){s(e.typedBuffer,t.typedBuffer,r,e.typedBufferStride,t.typedBufferStride)}function s(e,t,r,n=3,o=n){if(e.length/n!==Math.ceil(t.length/o))return e;const s=e.length/n,i=r[0],a=r[1],u=r[2],c=r[4],l=r[5],f=r[6],d=r[8],m=r[9],p=r[10],h=r[12],g=r[13],y=r[14];let x=0,w=0;for(let r=0;r<s;r++){const r=t[x],s=t[x+1],b=t[x+2];e[w]=i*r+c*s+d*b+h,e[w+1]=a*r+l*s+m*b+g,e[w+2]=u*r+f*s+p*b+y,x+=o,w+=n}return e}function i(e,t,r){a(e.typedBuffer,t.typedBuffer,r,e.typedBufferStride,t.typedBufferStride)}function a(e,t,r,n=3,o=n){if(e.length/n!==Math.ceil(t.length/o))return;const s=e.length/n,i=r[0],a=r[1],u=r[2],c=r[3],l=r[4],f=r[5],d=r[6],m=r[7],p=r[8];let h=0,g=0;for(let r=0;r<s;r++){const r=t[h],s=t[h+1],y=t[h+2];e[g]=i*r+c*s+d*y,e[g+1]=a*r+l*s+m*y,e[g+2]=u*r+f*s+p*y,h+=o,g+=n}}function u(e,t,r,n=3,o=n){const s=Math.min(e.length/n,t.length/o);let i=0,a=0;for(let u=0;u<s;u++)e[a]=r*t[i],e[a+1]=r*t[i+1],e[a+2]=r*t[i+2],i+=o,a+=n;return e}function c(e,t,r,n){l(e.typedBuffer,t.typedBuffer,r,n,e.typedBufferStride,t.typedBufferStride)}function l(e,t,r,o,s=3,i=s){const a=Math.min(e.length/s,t.length/i);let u=0,c=0;const l=1/n.jm;for(let n=0;n<a;n++)e[c]=o*(r*t[u])**l,e[c+1]=o*(r*t[u+1])**l,e[c+2]=o*(r*t[u+2])**l,u+=i,c+=s}function f(e,t,r,n=3,o=n){const s=e.length/n;if(s!==Math.ceil(t.length/o))return e;let i=0,a=0;for(let u=0;u<s;u++)e[a]=t[i]+r[0],e[a+1]=t[i+1]+r[1],e[a+2]=t[i+2]+r[2],i+=o,a+=n;return e}function d(e,t){m(e.typedBuffer,t.typedBuffer,e.typedBufferStride,t.typedBufferStride)}function m(e,t,r=3,n=r){const o=Math.min(e.length/r,t.length/n);let s=0,i=0;for(let a=0;a<o;a++){const o=t[s],a=t[s+1],u=t[s+2],c=o*o+a*a+u*u;if(c>0){const t=1/Math.sqrt(c);e[i]=t*o,e[i+1]=t*a,e[i+2]=t*u}s+=n,i+=r}}Object.freeze(Object.defineProperty({__proto__:null,linearToSRGB:l,linearToSRGBView:c,normalize:m,normalizeView:d,scale:u,scaleView:function(e,t,r){u(e.typedBuffer,t.typedBuffer,r,e.typedBufferStride,t.typedBufferStride)},shiftRight:function(e,t,r){const n=Math.min(e.count,t.count),o=e.typedBuffer,s=e.typedBufferStride,i=t.typedBuffer,a=t.typedBufferStride;let u=0,c=0;for(let e=0;e<n;e++)o[c]=i[u]>>r,o[c+1]=i[u+1]>>r,o[c+2]=i[u+2]>>r,u+=a,c+=s},transformMat3:a,transformMat3View:i,transformMat4:s,transformMat4View:o,translate:f},Symbol.toStringTag,{value:"Module"}))},91426:function(e,t,r){r.d(t,{a:function(){return s},b:function(){return l},l:function(){return c},n:function(){return a},t:function(){return i}});var n=r(38461),o=(r(61432),r(96711));function s(e,t,r){i(e.typedBuffer,t.typedBuffer,r,e.typedBufferStride,t.typedBufferStride)}function i(e,t,r,n=4,o=n){if(e.length/n!=t.length/o)return;const s=e.length/n,i=r[0],a=r[1],u=r[2],c=r[3],l=r[4],f=r[5],d=r[6],m=r[7],p=r[8];let h=0,g=0;for(let r=0;r<s;r++){const r=t[h],s=t[h+1],y=t[h+2],x=t[h+3];e[g]=i*r+c*s+d*y,e[g+1]=a*r+l*s+m*y,e[g+2]=u*r+f*s+p*y,e[g+3]=x,h+=o,g+=n}}function a(e,t){const r=Math.min(e.count,t.count),n=e.typedBuffer,o=e.typedBufferStride,s=t.typedBuffer,i=t.typedBufferStride;for(let e=0;e<r;e++){const t=e*o,r=e*i,a=s[r],u=s[r+1],c=s[r+2],l=a*a+u*u+c*c;if(l>0){const e=1/Math.sqrt(l);n[t]=e*a,n[t+1]=e*u,n[t+2]=e*c}}}function u(e,t,r,n=4){const o=Math.min(e.length/n,t.count),s=t.typedBuffer,i=t.typedBufferStride;let a=0,u=0;for(let t=0;t<o;t++)e[u]=r*s[a],e[u+1]=r*s[a+1],e[u+2]=r*s[a+2],e[u+3]=r*s[a+3],a+=i,u+=n}function c(e,t,r,n){l(e.typedBuffer,t,r,n,e.typedBufferStride)}function l(e,t,r,o,s=4){const i=Math.min(e.length/s,t.count),a=t.typedBuffer,u=t.typedBufferStride;let c=0,l=0;const f=1/n.jm;for(let t=0;t<i;t++)e[l]=o*(r*a[c])**f,e[l+1]=o*(r*a[c+1])**f,e[l+2]=o*(r*a[c+2])**f,e[l+3]=o*r*a[c+3],c+=u,l+=s}Object.freeze(Object.defineProperty({__proto__:null,linearToSRGB:l,linearToSRGBView:c,normalize:a,scale:u,scaleView:function(e,t,r){u(e.typedBuffer,t,r,e.typedBufferStride)},transformMat3:i,transformMat3View:s,transformMat4:function(e,t,r,n=4,s=n){if(e.length/n!=t.length/s)return void o.Z.getLogger("esri.views.3d.support.buffer.math").error("source and destination buffers need to have the same number of elements");const i=e.length/n,a=r[0],u=r[1],c=r[2],l=r[3],f=r[4],d=r[5],m=r[6],p=r[7],h=r[8],g=r[9],y=r[10],x=r[11],w=r[12],b=r[13],T=r[14],B=r[15];let v=0,M=0;for(let r=0;r<i;r++){const r=t[v],o=t[v+1],i=t[v+2],S=t[v+3];e[M]=a*r+f*o+h*i+w*S,e[M+1]=u*r+d*o+g*i+b*S,e[M+2]=c*r+m*o+y*i+T*S,e[M+3]=l*r+p*o+x*i+B*S,v+=s,M+=n}},transformMat4View:function(e,t,r){if(e.count!==t.count)return;const n=e.count,o=r[0],s=r[1],i=r[2],a=r[3],u=r[4],c=r[5],l=r[6],f=r[7],d=r[8],m=r[9],p=r[10],h=r[11],g=r[12],y=r[13],x=r[14],w=r[15],b=e.typedBuffer,T=e.typedBufferStride,B=t.typedBuffer,v=t.typedBufferStride;for(let e=0;e<n;e++){const t=e*T,r=e*v,n=B[r],M=B[r+1],S=B[r+2],R=B[r+3];b[t]=o*n+u*M+d*S+g*R,b[t+1]=s*n+c*M+m*S+y*R,b[t+2]=i*n+l*M+p*S+x*R,b[t+3]=a*n+f*M+h*S+w*R}}},Symbol.toStringTag,{value:"Module"}))},61544:function(e,t,r){r.d(t,{r:function(){return n}});class n{constructor(){this._outer=new Map}clear(){this._outer.clear()}get empty(){return 0===this._outer.size}get outerSize(){return this._outer.size}get(e,t){return this._outer.get(e)?.get(t)}getInner(e){return this._outer.get(e)}set(e,t,r){const n=this._outer.get(e);n?n.set(t,r):this._outer.set(e,new Map([[t,r]]))}delete(e,t){const r=this._outer.get(e);r&&(r.delete(t),0===r.size&&this._outer.delete(e))}forEach(e){this._outer.forEach(((t,r)=>e(t,r)))}forAll(e){this._outer.forEach(((t,r)=>t.forEach(((t,n)=>e(t,r,n)))))}}},10126:function(e,t,r){function n(e){return e=e||globalThis.location.hostname,c.some((t=>null!=e?.match(t)))}function o(e,t){return e?(t=t||globalThis.location.hostname)?null!=t.match(s)||null!=t.match(a)?e.replace("static.arcgis.com","staticdev.arcgis.com"):null!=t.match(i)||null!=t.match(u)?e.replace("static.arcgis.com","staticqa.arcgis.com"):e:e:null}r.d(t,{XO:function(){return n},pJ:function(){return o}});const s=/^devext\.arcgis\.com$/,i=/^qaext\.arcgis\.com$/,a=/^[\w-]*\.mapsdevext\.arcgis\.com$/,u=/^[\w-]*\.mapsqa\.arcgis\.com$/,c=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local\.esri\.com$/,s,i,/^jsapps\.esri\.com$/,a,u]},95631:function(e,t,r){r.d(t,{C:function(){return u}});var n=r(78619),o=r(29292),s=r(88194),i=r(93568),a=r(95490);class u{constructor(e){this._streamDataRequester=e}async loadJSON(e,t){return this._load("json",e,t)}async loadBinary(e,t){return(0,a.HK)(e)?((0,i.k_)(t),(0,a.AH)(e)):this._load("binary",e,t)}async loadImage(e,t){return this._load("image",e,t)}async _load(e,t,r){if(null==this._streamDataRequester)return(await(0,n.Z)(t,{responseType:c[e]})).data;const a=await(0,o.q6)(this._streamDataRequester.request(t,e,r));if(!0===a.ok)return a.value;throw(0,i.r9)(a.error),new s.Z("glt-loader-request-error",`Request for resource failed: ${a.error}`)}}const c={image:"image",binary:"array-buffer",json:"json","image+type":void 0}},80641:function(e,t,r){r.d(t,{i:function(){return i}});var n=r(30748),o=r(12414),s=r(96373);function i(e){if(null==e)return null;const t=null!=e.offset?e.offset:o.AG,r=null!=e.rotation?e.rotation:0,i=null!=e.scale?e.scale:o.hq,a=(0,n.al)(1,0,0,0,1,0,t[0],t[1],1),u=(0,n.al)(Math.cos(r),-Math.sin(r),0,Math.sin(r),Math.cos(r),0,0,0,1),c=(0,n.al)(i[0],0,0,0,i[1],0,0,0,1),l=(0,n.Ue)();return(0,s.Jp)(l,u,c),(0,s.Jp)(l,a,l),l}},42869:function(e,t,r){r.d(t,{p:function(){return i}});var n=r(59384),o=r(38766),s=r(65650);function i(e,t){switch(t){case s.MX.TRIANGLES:return function(e){return"number"==typeof e?(0,o.KF)(e):(0,n.lq)(e)?new Uint16Array(e):e}(e);case s.MX.TRIANGLE_STRIP:return function(e){const t="number"==typeof e?e:e.length;if(t<3)return[];const r=t-2,n=(0,o.$z)(3*r);if("number"==typeof e){let e=0;for(let t=0;t<r;t+=1)t%2==0?(n[e++]=t,n[e++]=t+1,n[e++]=t+2):(n[e++]=t+1,n[e++]=t,n[e++]=t+2)}else{let t=0;for(let o=0;o<r;o+=1)o%2==0?(n[t++]=e[o],n[t++]=e[o+1],n[t++]=e[o+2]):(n[t++]=e[o+1],n[t++]=e[o],n[t++]=e[o+2])}return n}(e);case s.MX.TRIANGLE_FAN:return function(e){const t="number"==typeof e?e:e.length;if(t<3)return new Uint16Array(0);const r=t-2,n=r<=65536?new Uint16Array(3*r):new Uint32Array(3*r);if("number"==typeof e){let e=0;for(let t=0;t<r;++t)n[e++]=0,n[e++]=t+1,n[e++]=t+2;return n}const o=e[0];let s=e[1],i=0;for(let t=0;t<r;++t){const r=e[t+2];n[i++]=o,n[i++]=s,n[i++]=r,s=r}return n}(e)}}},917:function(e,t,r){r.d(t,{$A:function(){return i},Ml:function(){return u},NM:function(){return s},i$:function(){return a}});var n=r(61432),o=r(32420);class s{constructor(e){this.data=e,this.type="encoded-mesh-texture",this.encoding=o.Ti.KTX2_ENCODING}}function i(e){return"encoded-mesh-texture"===e?.type}async function a(e){const t=new Blob([e]),r=await t.text();return JSON.parse(r)}async function u(e,t){if(t===o.Ti.KTX2_ENCODING)return new s(e);const r=new Blob([e],{type:t});let i=URL.createObjectURL(r);switch(t){case"image/jpeg":i+="#.jpg";break;case"image/png":i+="#.png"}const a=new Image;if((0,n.Z)("esri-iPhone"))return new Promise(((e,t)=>{const r=()=>{o(),e(a)},n=e=>{o(),t(e)},o=()=>{URL.revokeObjectURL(i),a.removeEventListener("load",r),a.removeEventListener("error",n)};a.addEventListener("load",r),a.addEventListener("error",n),a.src=i}));try{a.src=i,await a.decode()}catch(e){console.warn("Failed decoding HTMLImageElement")}return URL.revokeObjectURL(i),a}},29540:function(e,t,r){r.d(t,{fetch:function(){return q}});var n=r(38461),o=r(10126),s=r(99574),i=r(96373),a=r(30748),u=r(31865),c=r(10934),l=r(41788),f=r(24910),d=r(82846),m=r(16447),p=r(39909),h=r(81342),g=r(2875),y=r(91426),x=r(32505),w=r(95631),b=r(42869),T=r(917),B=r(80641);class v{constructor(){this.geometries=new Array,this.materials=new Array,this.textures=new Array}}class M{constructor(e,t,r){this.name=e,this.lodThreshold=t,this.pivotOffset=r,this.stageResources=new v,this.numberOfVertices=0}}var S=r(58744),R=r(57716),A=r(81749),O=r(32420),I=r(25952),_=r(28751),E=r(52061),P=r(35720),U=r(18836);async function q(e,t){const a=function(e){const t=e.match(/(.*\.(gltf|glb))(\?lod=([0-9]+))?$/);return t?{fileType:"gltf",url:t[1],specifiedLodIndex:null!=t[4]?Number(t[4]):null}:e.match(/(.*\.(json|json\.gz))$/)?{fileType:"wosr",url:e,specifiedLodIndex:null}:{fileType:"unknown",url:e,specifiedLodIndex:null}}((0,o.pJ)(e));if("wosr"===a.fileType){const e=await(t.cache?t.cache.loadWOSR(a.url,t):(0,S.zD)(a.url,t)),{engineResources:r,referenceBoundingBox:n}=(0,S.p2)(e,t);return{lods:r,referenceBoundingBox:n,isEsriSymbolResource:!1,isWosr:!0}}let v;if(t.cache)v=await t.cache.loadGLTF(a.url,t,!!t.usePBR);else{const{loadGLTF:e}=await r.e(50022).then(r.bind(r,50022));v=await e(new w.C(t.streamDataRequester),a.url,t,t.usePBR)}const q=v.model.meta?.ESRI_proxyEllipsoid,k=v.meta.isEsriSymbolResource&&null!=q&&"EsriRealisticTreesStyle"===v.meta.ESRI_webstyle;k&&!v.customMeta.esriTreeRendering&&(v.customMeta.esriTreeRendering=!0,function(e,t){for(let r=0;r<e.model.lods.length;++r){const o=e.model.lods[r];for(const s of o.parts){const o=s.attributes.normal;if(null==o)return;const i=s.attributes.position,a=i.count,l=(0,d.Ue)(),m=(0,d.Ue)(),p=(0,d.Ue)(),g=new Float32Array(4*a),y=new Float32Array(3*a),x=(0,u.U_)((0,c.Ue)(),s.transform);let w=0,b=0;for(let u=0;u<a;u++){i.getVec(u,m),o.getVec(u,l),(0,f.t)(m,m,s.transform),(0,f.d)(p,m,t.center),(0,f.D)(p,p,t.radius);const a=p[2],c=(0,f.l)(p),d=Math.min(.45+.55*c*c,1)**n.jm;(0,f.D)(p,p,t.radius),null!==x&&(0,f.t)(p,p,x),(0,f.n)(p,p),r+1!==e.model.lods.length&&e.model.lods.length>1&&(0,f.m)(p,p,l,a>-1?.2:Math.min(-4*a-3.8,1)),y[w]=p[0],y[w+1]=p[1],y[w+2]=p[2],w+=3,g[b]=d,g[b+1]=d,g[b+2]=d,g[b+3]=1,b+=4}s.attributes.normal=new h.ct(y),s.attributes.color=new h.ek(g)}}}(v,q));const J=!!t.usePBR,j=v.meta.isEsriSymbolResource?{usePBR:J,isSchematic:!1,treeRendering:k,mrrFactors:U.eP}:{usePBR:J,isSchematic:!1,treeRendering:!1,mrrFactors:U.xq},C={...t.materialParameters,treeRendering:k},{engineResources:G,referenceBoundingBox:N}=function(e,t,r,o,a,u){const c=e.model,f=new Array,d=new Map,w=new Map,v=c.lods.length,S=(0,m.cS)();return c.lods.forEach(((e,q)=>{const k=!0===o.skipHighLods&&(v>1&&0===q||v>3&&1===q)||!1===o.skipHighLods&&null!=a&&q!==a;if(k&&0!==q)return;const J=new M(e.name,e.lodThreshold,[0,0,0]);e.parts.forEach((e=>{const a=k?new P.Gp({},o):function(e,t,r,o,s,i,a,u,c){const f=e.materials.get(t.material);if(null==f)return null;const{normal:d,color:m,texCoord0:p,tangent:h}=t.attributes,g=t.material+(d?"_normal":"")+(m?"_color":"")+(p?"_texCoord0":"")+(h?"_tangent":""),y=null!=t.attributes.texCoord0,x=null!=t.attributes.normal,w=function(e){switch(e){case"BLEND":return O.JJ.Blend;case"MASK":return O.JJ.Mask;case"OPAQUE":case null:case void 0:return O.JJ.Opaque}}(f.alphaMode);if(!i.has(g)){if(y){const t=(t,r=!1,n=!1)=>{if(null!=t&&!a.has(t)){const o=e.textures.get(t);if(o){const e=o.data,s=r&&!(0,T.$A)(e)?u.compressionOptions:void 0;a.set(t,new _.x((0,T.$A)(e)?e.data:e,{...o.parameters,preMultiplyAlpha:!(0,T.$A)(e)&&n,encoding:(0,T.$A)(e)?e.encoding:void 0,compressionOptions:s}))}}},r=w!==O.JJ.Opaque&&!c;t(f.colorTexture,r,w!==O.JJ.Opaque),t(f.normalTexture),t(f.occlusionTexture,!0),t(f.emissiveTexture),t(f.metallicRoughnessTexture,!0)}const r=1/n.jm,d=f.color[0]**r,m=f.color[1]**r,p=f.color[2]**r,h=f.emissiveFactor[0]**r,b=f.emissiveFactor[1]**r,v=f.emissiveFactor[2]**r,M=null!=f.colorTexture&&y?a.get(f.colorTexture):null,S=(0,U.Ih)(f),A=null!=f.normalTextureTransform?.scale?f.normalTextureTransform?.scale:l.hq;i.set(g,new P.Gp({...o,customDepthTest:O.Gv.Lequal,textureAlphaMode:w,textureAlphaCutoff:f.alphaCutoff,diffuse:[d,m,p],ambient:[d,m,p],opacity:"OPAQUE"===f.alphaMode?1:f.opacity,doubleSided:f.doubleSided,doubleSidedType:"winding-order",cullFace:f.doubleSided?O.Vr.None:O.Vr.Back,hasVertexColors:!!t.attributes.color,hasVertexTangents:!!t.attributes.tangent,normalType:x?R.r.Attribute:R.r.ScreenDerivative,castShadows:!0,receiveShadows:f.receiveShadows,receiveAmbientOcclusion:f.receiveAmbientOcclusion,textureId:null!=M?M.id:void 0,colorMixMode:f.colorMixMode,normalTextureId:null!=f.normalTexture&&y?a.get(f.normalTexture).id:void 0,textureAlphaPremultiplied:null!=M&&!!M.parameters.preMultiplyAlpha,occlusionTextureId:null!=f.occlusionTexture&&y?a.get(f.occlusionTexture).id:void 0,emissiveTextureId:null!=f.emissiveTexture&&y?a.get(f.emissiveTexture).id:void 0,metallicRoughnessTextureId:null!=f.metallicRoughnessTexture&&y?a.get(f.metallicRoughnessTexture).id:void 0,emissiveBaseColor:[h,b,v],mrrFactors:S?U.S7:[f.metallicFactor,f.roughnessFactor,o.mrrFactors[2]],isSchematic:S,colorTextureTransformMatrix:(0,B.i)(f.colorTextureTransform),normalTextureTransformMatrix:(0,B.i)(f.normalTextureTransform),scale:[A[0],A[1]],occlusionTextureTransformMatrix:(0,B.i)(f.occlusionTextureTransform),emissiveTextureTransformMatrix:(0,B.i)(f.emissiveTextureTransform),metallicRoughnessTextureTransformMatrix:(0,B.i)(f.metallicRoughnessTextureTransform),...s},u))}const b=i.get(g);if(r.stageResources.materials.push(b),y){const e=e=>{null!=e&&r.stageResources.textures.push(a.get(e))};e(f.colorTexture),e(f.normalTexture),e(f.occlusionTexture),e(f.emissiveTexture),e(f.metallicRoughnessTexture)}return b}(c,e,J,t,r,d,w,o,u),{geometry:f,vertexCount:v}=function(e,t){const r=e.attributes.position.count,n=(0,b.p)(e.indices||r,e.primitiveType),o=(0,p.xx)(3*r),{typedBuffer:a,typedBufferStride:u}=e.attributes.position;(0,g.t)(o,a,e.transform,3,u);const c=[[E.T.POSITION,new A.a(o,n,3,!0)]];if(null!=e.attributes.normal){const t=(0,p.xx)(3*r),{typedBuffer:o,typedBufferStride:a}=e.attributes.normal;(0,i.XL)(L,e.transform),(0,g.b)(t,o,L,3,a),(0,s.oc)(L)&&(0,g.n)(t,t),c.push([E.T.NORMAL,new A.a(t,n,3,!0)])}if(null!=e.attributes.tangent){const t=(0,p.xx)(4*r),{typedBuffer:o,typedBufferStride:a}=e.attributes.tangent;(0,i.xO)(L,e.transform),(0,y.t)(t,o,L,4,a),(0,s.oc)(L)&&(0,g.n)(t,t,4),c.push([E.T.TANGENT,new A.a(t,n,4,!0)])}if(null!=e.attributes.texCoord0){const t=(0,p.xx)(2*r),{typedBuffer:o,typedBufferStride:s}=e.attributes.texCoord0;(0,x.a)(t,o,2,s),c.push([E.T.UV0,new A.a(t,n,2,!0)])}const l=e.attributes.color;if(null!=l){const t=new Uint8Array(4*r);4===l.elementCount?l instanceof h.ek?(0,y.b)(t,l,1,255):(l instanceof h.mc||l instanceof h.v6)&&(0,y.b)(t,l,1/255,255):(t.fill(255),l instanceof h.ct?(0,g.f)(t,l.typedBuffer,1,255,4,l.typedBufferStride):(e.attributes.color instanceof h.ne||e.attributes.color instanceof h.mw)&&(0,g.f)(t,l.typedBuffer,1/255,255,4,e.attributes.color.typedBufferStride)),c.push([E.T.COLOR,new A.a(t,n,4,!0)])}return{geometry:new I.Z(t,c),vertexCount:r}}(e,a??new P.Gp({},o)),M=f.boundingInfo;null!=M&&0===q&&((0,m.pp)(S,M.bbMin),(0,m.pp)(S,M.bbMax)),null!=a&&(J.stageResources.geometries.push(f),J.numberOfVertices+=v)})),k||f.push(J)})),{engineResources:f,referenceBoundingBox:S}}(v,j,C,t,a.specifiedLodIndex,k);return{lods:G,referenceBoundingBox:N,isEsriSymbolResource:v.meta.isEsriSymbolResource,isWosr:!1}}const L=(0,a.Ue)()},58744:function(e,t,r){r.d(t,{p2:function(){return A},zD:function(){return M}});var n=r(78619),o=r(29292),s=r(88194),i=r(96711),a=r(85881),u=r(61544),c=r(93568),l=r(15322),f=r(82846),d=r(16447),m=r(38766),p=r(51880),h=r(81749),g=r(32420),y=r(25952),x=r(28751),w=r(52061),b=r(35720),T=r(65650);const B=()=>i.Z.getLogger("esri.views.3d.layers.graphics.objectResourceUtils");class v{constructor(e,t,r){this.resource=e,this.textures=t,this.cachedMemory=r}}async function M(e,t){const r=await async function(e,t){const r=t?.streamDataRequester;if(r)return async function(e,t,r){const n=await(0,o.q6)(t.request(e,"json",r));if(!0===n.ok)return n.value;(0,c.r9)(n.error),S(n.error.details.url)}(e,r,t);const s=await(0,o.q6)((0,n.Z)(e,t));if(!0===s.ok)return s.value.data;(0,c.r9)(s.error),S(s.error)}(e,t),s=await async function(e,t){const r=new Array;for(const n in e){const o=e[n],s=o.images[0].data;if(!s){B().warn("Externally referenced texture data is not yet supported");continue}const i=o.encoding+";base64,"+s,a="/textureDefinitions/"+n,u="rgba"===o.channels?o.alphaChannelUsage||"transparency":"none",c={noUnpackFlip:!0,wrap:{s:T.e8.REPEAT,t:T.e8.REPEAT},preMultiplyAlpha:I(u)!==g.JJ.Opaque},l=t?.disableTextures?Promise.resolve(null):(0,p.t)(i,t);r.push(l.then((e=>({refId:a,image:e,parameters:c,alphaChannelUsage:u}))))}const n=await Promise.all(r),o={};for(const e of n)o[e.refId]=e;return o}(r.textureDefinitions??{},t);let i=0;for(const e in s)if(s.hasOwnProperty(e)){const t=s[e];i+=t?.image?t.image.width*t.image.height*4:0}return new v(r,s,i+(0,a.kk)(r))}function S(e){throw new s.Z("",`Request for object resource failed: ${e}`)}function R(e){const t=e.params,r=t.topology;let n=!0;switch(t.vertexAttributes||(B().warn("Geometry must specify vertex attributes"),n=!1),t.topology){case"PerAttributeArray":break;case"Indexed":case null:case void 0:{const e=t.faces;if(e){if(t.vertexAttributes)for(const r in t.vertexAttributes){const t=e[r];t?.values?(null!=t.valueType&&"UInt32"!==t.valueType&&(B().warn(`Unsupported indexed geometry indices type '${t.valueType}', only UInt32 is currently supported`),n=!1),null!=t.valuesPerElement&&1!==t.valuesPerElement&&(B().warn(`Unsupported indexed geometry values per element '${t.valuesPerElement}', only 1 is currently supported`),n=!1)):(B().warn(`Indexed geometry does not specify face indices for '${r}' attribute`),n=!1)}}else B().warn("Indexed geometries must specify faces"),n=!1;break}default:B().warn(`Unsupported topology '${r}'`),n=!1}e.params.material||(B().warn("Geometry requires material"),n=!1);const o=e.params.vertexAttributes;for(const e in o)o[e].values||(B().warn("Geometries with externally defined attributes are not yet supported"),n=!1);return n}function A(e,t){const r=new Array,n=new Array,o=new Array,s=new u.r,i=e.resource,a=l.G.parse(i.version||"1.0","wosr");E.validate(a);const c=i.model.name,d=i.model.geometries,p=i.materialDefinitions??{},T=e.textures;let B=0;const v=new Map;for(let e=0;e<d.length;e++){const i=d[e];if(!R(i))continue;const a=_(i),u=i.params.vertexAttributes,c=[],l=e=>{if("PerAttributeArray"===i.params.topology)return null;const t=i.params.faces;for(const r in t)if(r===e)return t[r].values;return null},M=u[w.T.POSITION],S=M.values.length/M.valuesPerElement;for(const e in u){const t=u[e],r=t.values,n=l(e)??(0,m.KF)(S);c.push([e,new h.a(r,n,t.valuesPerElement,!0)])}const A=a.texture,O=T&&T[A];if(O&&!v.has(A)){const{image:e,parameters:t}=O,r=new x.x(e,t);n.push(r),v.set(A,r)}const E=v.get(A),P=E?E.id:void 0,U=a.material;let q=s.get(U,A);if(null==q){const e=p[U.slice(U.lastIndexOf("/")+1)].params;1===e.transparency&&(e.transparency=0);const r=O?I(O.alphaChannelUsage):void 0,n={ambient:(0,f.nI)(e.diffuse),diffuse:(0,f.nI)(e.diffuse),opacity:1-(e.transparency||0),textureAlphaMode:r,textureAlphaCutoff:.33,textureId:P,doubleSided:!0,cullFace:g.Vr.None,colorMixMode:e.externalColorMixMode||"tint",textureAlphaPremultiplied:O?.parameters.preMultiplyAlpha??!1};t?.materialParameters&&Object.assign(n,t.materialParameters),q=new b.Gp(n,t),s.set(U,A,q)}o.push(q);const L=new y.Z(q,c);B+=c.find((e=>e[0]===w.T.POSITION))?.[1]?.indices.length??0,r.push(L)}return{engineResources:[{name:c,stageResources:{textures:n,materials:o,geometries:r},pivotOffset:i.model.pivotOffset,numberOfVertices:B,lodThreshold:null}],referenceBoundingBox:O(r)}}function O(e){const t=(0,d.cS)();return e.forEach((e=>{const r=e.boundingInfo;null!=r&&((0,d.pp)(t,r.bbMin),(0,d.pp)(t,r.bbMax))})),t}function I(e){switch(e){case"mask":return g.JJ.Mask;case"maskAndTransparency":return g.JJ.MaskBlend;case"none":return g.JJ.Opaque;default:return g.JJ.Blend}}function _(e){const t=e.params;return{id:1,material:t.material,texture:t.texture,region:t.texture}}const E=new l.G(1,2,"wosr")}}]);