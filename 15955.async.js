"use strict";(self.webpackChunkscene_pro=self.webpackChunkscene_pro||[]).push([[15955],{30062:function(e,t,n){function r(e){let t,n,r=[],o=!1;return function(...i){return o&&t===this&&function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(i,r)||(n=e.apply(this,i),t=this,r=i,o=!0),n}}n.d(t,{H:function(){return r}})},37204:function(e,t,n){n.d(t,{SR:function(){return f},Ui:function(){return u}});var r=n(69306),o=n(47566),i=n(62951),s=n(28931),a=n(90756),c=n(76264),l=n(8554);function u(e){return h(e,!0)}function f(e){return h(e,!1)}function h(e,t){if(null==e)return null;const n=e.spatialReference,o=(0,l.C5)(n),s=(0,r.A)(e)?e.toJSON():e;if(!o)return s;const u=(0,l.sS)(n)?102100:4326,f=c.UZ[u].maxX,h=c.UZ[u].minX;if((0,a.wp)(s))return d(s,f,h);if((0,a.aW)(s))return s.points=s.points.map((e=>d(e,f,h))),s;if((0,a.YX)(s))return p(s,o);if((0,a.oU)(s)||(0,a.l9)(s)){const e=(0,i.$P)(M,s),n={xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3]},r=(0,c.XZ)(n.xmin,h)*(2*f),o=0===r?s:(0,c.Sy)(s,r);return n.xmin+=r,n.xmax+=r,n.xmax>f?C(o,f,t):n.xmin<h?C(o,h,t):o}return s}function p(e,t){if(!t)return e;const n=function(e,t){const n=[],{ymin:r,ymax:o,xmin:i,xmax:s}=e,a=e.xmax-e.xmin,[c,l]=t.valid,{x:u,frameId:f}=m(e.xmin,t),{x:h,frameId:p}=m(e.xmax,t),d=u===h&&a>0;if(a>2*l){const e={xmin:i<s?u:h,ymin:r,xmax:l,ymax:o},t={xmin:c,ymin:r,xmax:i<s?h:u,ymax:o},a={xmin:0,ymin:r,xmax:l,ymax:o},d={xmin:c,ymin:r,xmax:0,ymax:o},m=[],g=[];y(e,a)&&m.push(f),y(e,d)&&g.push(f),y(t,a)&&m.push(p),y(t,d)&&g.push(p);for(let e=f+1;e<p;e++)m.push(e),g.push(e);n.push(new b(e,[f]),new b(t,[p]),new b(a,m),new b(d,g))}else u>h||d?n.push(new b({xmin:u,ymin:r,xmax:l,ymax:o},[f]),new b({xmin:c,ymin:r,xmax:h,ymax:o},[p])):n.push(new b({xmin:u,ymin:r,xmax:h,ymax:o},[f]));return n}(e,t).map((e=>e.extent));return n.length<2?n[0]||e:n.length>2?(e.xmin=t.valid[0],e.xmax=t.valid[1],e):{rings:n.map((e=>[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]))}}function d(e,t,n){if(Array.isArray(e)){const r=e[0];if(r>t){const n=(0,c.XZ)(r,t);e[0]=r+n*(-2*t)}else if(r<n){const t=(0,c.XZ)(r,n);e[0]=r+t*(-2*n)}}else{const r=e.x;if(r>t){const n=(0,c.XZ)(r,t);e.x+=n*(-2*t)}else if(r<n){const t=(0,c.XZ)(r,n);e.x+=t*(-2*n)}}return e}function m(e,t){const[n,r]=t.valid,o=2*r;let i,s=0;return e>r?(i=Math.ceil(Math.abs(e-r)/o),e-=i*o,s=i):e<n&&(i=Math.ceil(Math.abs(e-n)/o),e+=i*o,s=-i),{x:e,frameId:s}}function y(e,t){const{xmin:n,ymin:r,xmax:o,ymax:i}=t;return g(e,n,r)&&g(e,n,i)&&g(e,o,i)&&g(e,o,r)}function g(e,t,n){return t>=e.xmin&&t<=e.xmax&&n>=e.ymin&&n<=e.ymax}function C(e,t,n=!0){const r=!(0,a.l9)(e);if(r&&(0,s.Zy)(e),n)return(new x).cut(e,t);const o=r?e.rings:e.paths,i=r?4:2,c=o.length,l=-2*t;for(let e=0;e<c;e++){const t=o[e];if(t&&t.length>=i){const e=[];for(const n of t)e.push([n[0]+l,n[1]]);o.push(e)}}return r?e.rings=o:e.paths=o,e}class b{constructor(e,t){this.extent=e,this.frameIds=t}}const M=(0,o.Ue)();class x{constructor(){this._linesIn=[],this._linesOut=[]}cut(e,t){let n;if(this._xCut=t,e.rings)this._closed=!0,n=e.rings,this._minPts=4;else{if(!e.paths)return null;this._closed=!1,n=e.paths,this._minPts=2}for(const e of n){if(!e||e.length<this._minPts)continue;let t=!0;for(const n of e)t?(this.moveTo(n),t=!1):this.lineTo(n);this._closed&&this.close()}this._pushLineIn(),this._pushLineOut(),n=[];for(const e of this._linesIn)e&&e.length>=this._minPts&&n.push(e);const r=-2*this._xCut;for(const e of this._linesOut)if(e&&e.length>=this._minPts){for(const t of e)t[0]+=r;n.push(e)}return this._closed?e.rings=n:e.paths=n,e}moveTo(e){this._pushLineIn(),this._pushLineOut(),this._prevSide=this._side(e[0]),this._moveTo(e[0],e[1],this._prevSide),this._prevPt=e,this._firstPt=e}lineTo(e){const t=this._side(e[0]);if(t*this._prevSide==-1){const n=this._intersect(this._prevPt,e);this._lineTo(this._xCut,n,0),this._prevSide=0,this._lineTo(e[0],e[1],t)}else this._lineTo(e[0],e[1],t);this._prevSide=t,this._prevPt=e}close(){const e=this._firstPt,t=this._prevPt;e[0]===t[0]&&e[1]===t[1]||this.lineTo(e),this._checkClosingPt(this._lineIn),this._checkClosingPt(this._lineOut)}_moveTo(e,t,n){this._closed?(this._lineIn.push([n<=0?e:this._xCut,t]),this._lineOut.push([n>=0?e:this._xCut,t])):(n<=0&&this._lineIn.push([e,t]),n>=0&&this._lineOut.push([e,t]))}_lineTo(e,t,n){this._closed?(_(this._lineIn,n<=0?e:this._xCut,t),_(this._lineOut,n>=0?e:this._xCut,t)):n<0?(0===this._prevSide&&this._pushLineOut(),this._lineIn.push([e,t])):n>0?(0===this._prevSide&&this._pushLineIn(),this._lineOut.push([e,t])):this._prevSide<0?(this._lineIn.push([e,t]),this._lineOut.push([e,t])):this._prevSide>0&&(this._lineOut.push([e,t]),this._lineIn.push([e,t]))}_checkClosingPt(e){const t=e.length;t>3&&e[0][0]===this._xCut&&e[t-2][0]===this._xCut&&e[1][0]===this._xCut&&(e[0][1]=e[t-2][1],e.pop())}_side(e){return e<this._xCut?-1:e>this._xCut?1:0}_intersect(e,t){const n=(this._xCut-e[0])/(t[0]-e[0]);return e[1]+n*(t[1]-e[1])}_pushLineIn(){this._lineIn&&this._lineIn.length>=this._minPts&&this._linesIn.push(this._lineIn),this._lineIn=[]}_pushLineOut(){this._lineOut&&this._lineOut.length>=this._minPts&&this._linesOut.push(this._lineOut),this._lineOut=[]}}function _(e,t,n){const r=e.length;r>1&&e[r-1][0]===t&&e[r-2][0]===t?e[r-1][1]=n:e.push([t,n])}},615:function(e,t,n){n.d(t,{cW:function(){return c},ij:function(){return a},rM:function(){return l}});var r=n(88194),o=n(60123),i=n(13928),s=n(8971);function a(e,t,n){try{return function(e){if(!e||0===e.length)return null;if(function(e){const t=e[0];return!!t&&"scale"in t}(e)){const t=[];for(const n of e)t.push({scale:n.scale,value:l(n.value)});return t}return l(e)}(e)}catch(e){n?.messages?.push(e)}return null}function c(e,t,n,r){try{const r=function(e){const t=(0,i.Q)(e);return t?(0,s.Cb)(t)?t.map((e=>e.toJSON())):t.map((({scale:e,effects:t})=>({scale:e,value:t.map((e=>e.toJSON()))}))):null}(e);(0,o.RB)(n,r,t)}catch(e){r.messages&&r.messages.push(e)}}function l(e){if(!e?.length)return"";const t=[];for(const n of e){let e=[];switch(n.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":e=[u(n,"amount")];break;case"blur":e=[u(n,"radius","pt")];break;case"hue-rotate":e=[u(n,"angle","deg")];break;case"drop-shadow":e=[u(n,"xoffset","pt"),u(n,"yoffset","pt"),u(n,"blurRadius","pt"),f(n,"color")];break;case"bloom":e=[u(n,"strength"),u(n,"radius","pt"),u(n,"threshold")]}const r=`${n.type}(${e.filter(Boolean).join(" ")})`;(0,i.Q)(r),t.push(r)}return t.join(" ")}function u(e,t,n){if(null==e[t])throw new r.Z("effect:missing-parameter",`Missing parameter '${t}' in ${e.type} effect`,{effect:e});return n?e[t]+n:""+e[t]}function f(e,t){if(null==e[t])throw new r.Z("effect:missing-parameter",`Missing parameter '${t}' in ${e.type} effect`,{effect:e});const n=e[t];return`rgba(${n[0]||0}, ${n[1]||0}, ${n[2]||0}, ${n[3]/255||0})`}},13928:function(e,t,n){n.d(t,{Q:function(){return l}});var r=n(38461),o=n(88194),i=n(71480),s=n(8971);class a extends SyntaxError{constructor(e,t,n,r){super(e),this.expected=t,this.found=n,this.location=r,this.name="SyntaxError"}format(e){let t="Error: "+this.message;if(this.location){let n=null;const r=e.find((e=>e.source===this.location.source));r&&(n=r.text.split(/\r\n|\n|\r/g));const o=this.location.start,i=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(o):o,s=this.location.source+":"+i.line+":"+i.column;if(n){const e=this.location.end,r="".padEnd(i.line.toString().length," "),a=n[o.line-1],c=(o.line===e.line?e.column:a.length+1)-o.column||1;t+="\n --\x3e "+s+"\n"+r+" |\n"+i.line+" | "+a+"\n"+r+" | "+"".padEnd(o.column-1," ")+"".padEnd(c,"^")}else t+="\n at "+s}return t}static buildMessage(e,t){function n(e){return e.codePointAt(0).toString(16).toUpperCase()}const r=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function o(e){return r?e.replace(r,(e=>"\\u{"+n(e)+"}")):e}function i(e){return o(e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(e=>"\\x0"+n(e))).replace(/[\x10-\x1F\x7F-\x9F]/g,(e=>"\\x"+n(e))))}function s(e){return o(e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(e=>"\\x0"+n(e))).replace(/[\x10-\x1F\x7F-\x9F]/g,(e=>"\\x"+n(e))))}const a={literal:e=>'"'+i(e.text)+'"',class(e){const t=e.parts.map((e=>Array.isArray(e)?s(e[0])+"-"+s(e[1]):s(e)));return"["+(e.inverted?"^":"")+t.join("")+"]"+(e.unicode?"u":"")},any:()=>"any character",end:()=>"end of input",other:e=>e.description};function c(e){return a[e.type](e)}return"Expected "+function(e){const t=e.map(c);if(t.sort(),t.length>0){let e=1;for(let n=1;n<t.length;n++)t[n-1]!==t[n]&&(t[e]=t[n],e++);t.length=e}switch(t.length){case 1:return t[0];case 2:return t[0]+" or "+t[1];default:return t.slice(0,-1).join(", ")+", or "+t[t.length-1]}}(e)+" but "+function(e){return e?'"'+i(e)+'"':"end of input"}(t)+" found."}}function c(e,t){const n={},r=(t=void 0!==t?t:{}).grammarSource,o={start:ce};let i=ce;const s="none",c=",",l="grad",u="turn",f=/^[ \t\n\r]/,h=/^[a-z\-]/,p=/^[0-9a-fA-F]/,d=/^[+\-]/,m=/^[0-9]/,y=oe("none"),g=ne("none",!1),C=ne(")",!1),b=ne(",",!1),M=re([" ","\t","\n","\r"],!1,!1,!1),x=oe("function"),_=ne("(",!1),I=oe("identifier"),w=re([["a","z"],"-"],!1,!1,!1),k=oe("percentage"),v=ne("%",!1),S=oe("length"),P=ne("px",!1),A=ne("cm",!1),E=ne("mm",!1),L=ne("in",!1),z=ne("pt",!1),R=ne("pc",!1),O=oe("angle"),F=ne("deg",!1),G=ne("rad",!1),T=ne("grad",!1),Z=ne("turn",!1),$=oe("number"),j=oe("color"),H=ne("#",!1),W=re([["0","9"],["a","f"],["A","F"]],!1,!1,!1),X=re(["+","-"],!1,!1,!1),N=re([["0","9"]],!1,!1,!1),V=ne(".",!1),Y=ne("e",!1);function q(e,t){return t.length>0?function(e,t,n){return[e].concat(function(e,t){return e.map((function(e){return e[t]}))}(t,n))}(e,t,3):[e]}let U=0|t.peg$currPos,D=U;const J=[{line:1,column:1}];let B,Q=U,K=t.peg$maxFailExpected||[],ee=0|t.peg$silentFails;if(t.startRule){if(!(t.startRule in o))throw new Error("Can't start parsing from rule \""+t.startRule+'".');i=o[t.startRule]}function te(){return e.substring(D,U)}function ne(e,t){return{type:"literal",text:e,ignoreCase:t}}function re(e,t,n,r){return{type:"class",parts:e,inverted:t,ignoreCase:n,unicode:r}}function oe(e){return{type:"other",description:e}}function ie(t){let n,r=J[t];if(r)return r;if(t>=J.length)n=J.length-1;else for(n=t;!J[--n];);for(r=J[n],r={line:r.line,column:r.column};n<t;)10===e.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return J[t]=r,r}function se(e,t,n){const o=ie(e),i=ie(t);return{source:r,start:{offset:e,line:o.line,column:o.column},end:{offset:t,line:i.line,column:i.column}}}function ae(e){U<Q||(U>Q&&(Q=U,K=[]),K.push(e))}function ce(){let e;return e=le(),e===n&&(e=function(){let e,t;if(e=[],t=ue(),t!==n)for(;t!==n;)e.push(t),t=ue();else e=n;return e}()),e}function le(){let t,r;return ee++,t=U,he(),e.substr(U,4)===s?(r=s,U+=4):(r=n,0===ee&&ae(g)),r!==n?(he(),D=t,t=[]):(U=t,t=n),ee--,t===n&&0===ee&&ae(y),t}function ue(){let t,r,o,i;return t=U,he(),r=function(){let t,r,o;return ee++,t=U,r=pe(),r!==n?(40===e.charCodeAt(U)?(o="(",U++):(o=n,0===ee&&ae(_)),o!==n?(D=t,t=r):(U=t,t=n)):(U=t,t=n),ee--,t===n&&(r=n,0===ee&&ae(x)),t}(),r!==n?(he(),o=function(){let t,r,o,i,s,a,l,u;if(t=U,r=fe(),r!==n){for(o=[],i=U,s=he(),44===e.charCodeAt(U)?(a=c,U++):(a=n,0===ee&&ae(b)),a===n&&(a=null),l=he(),u=fe(),u!==n?(s=[s,a,l,u],i=s):(U=i,i=n);i!==n;)o.push(i),i=U,s=he(),44===e.charCodeAt(U)?(a=c,U++):(a=n,0===ee&&ae(b)),a===n&&(a=null),l=he(),u=fe(),u!==n?(s=[s,a,l,u],i=s):(U=i,i=n);D=t,t=q(r,o)}else U=t,t=n;return t}(),o===n&&(o=null),he(),41===e.charCodeAt(U)?(i=")",U++):(i=n,0===ee&&ae(C)),i!==n?(he(),D=t,t=function(e,t){return{type:"function",name:e,parameters:t||[]}}(r,o)):(U=t,t=n)):(U=t,t=n),t}function fe(){let e,t;return e=U,t=de(),t===n&&(t=me(),t===n&&(t=ye(),t===n&&(t=function(){let e,t;return ee++,e=U,he(),t=Ce(),t!==n?(D=e,e=function(e){return{value:e,unit:null}}(t)):(U=e,e=n),ee--,e===n&&0===ee&&ae($),e}()))),t!==n&&(D=e,t=function(e){return{type:"quantity",value:e.value,unit:e.unit}}(t)),e=t,e===n&&(e=U,t=ge(),t!==n&&(D=e,t=function(e){return{type:"color",colorType:e.type,value:e.value}}(t)),e=t),e}function he(){let t,r;for(ee++,t=[],r=e.charAt(U),f.test(r)?U++:(r=n,0===ee&&ae(M));r!==n;)t.push(r),r=e.charAt(U),f.test(r)?U++:(r=n,0===ee&&ae(M));return ee--,t}function pe(){let t,r,o;if(ee++,t=U,r=[],o=e.charAt(U),h.test(o)?U++:(o=n,0===ee&&ae(w)),o!==n)for(;o!==n;)r.push(o),o=e.charAt(U),h.test(o)?U++:(o=n,0===ee&&ae(w));else r=n;return r!==n&&(D=t,r=te()),t=r,ee--,t===n&&(r=n,0===ee&&ae(I)),t}function de(){let t,r,o;return ee++,t=U,he(),r=Ce(),r!==n?(37===e.charCodeAt(U)?(o="%",U++):(o=n,0===ee&&ae(v)),o!==n?(D=t,t=function(e){return{value:e,unit:"%"}}(r)):(U=t,t=n)):(U=t,t=n),ee--,t===n&&0===ee&&ae(k),t}function me(){let t,r,o;return ee++,t=U,he(),r=Ce(),r!==n?("px"===e.substr(U,2)?(o="px",U+=2):(o=n,0===ee&&ae(P)),o!==n?(D=t,t=function(e){return{value:e,unit:"px"}}(r)):(U=t,t=n)):(U=t,t=n),t===n&&(t=U,he(),r=Ce(),r!==n?("cm"===e.substr(U,2)?(o="cm",U+=2):(o=n,0===ee&&ae(A)),o!==n?(D=t,t=function(e){return{value:e,unit:"cm"}}(r)):(U=t,t=n)):(U=t,t=n),t===n&&(t=U,he(),r=Ce(),r!==n?("mm"===e.substr(U,2)?(o="mm",U+=2):(o=n,0===ee&&ae(E)),o!==n?(D=t,t=function(e){return{value:e,unit:"mm"}}(r)):(U=t,t=n)):(U=t,t=n),t===n&&(t=U,he(),r=Ce(),r!==n?("in"===e.substr(U,2)?(o="in",U+=2):(o=n,0===ee&&ae(L)),o!==n?(D=t,t=function(e){return{value:e,unit:"in"}}(r)):(U=t,t=n)):(U=t,t=n),t===n&&(t=U,he(),r=Ce(),r!==n?("pt"===e.substr(U,2)?(o="pt",U+=2):(o=n,0===ee&&ae(z)),o!==n?(D=t,t=function(e){return{value:e,unit:"pt"}}(r)):(U=t,t=n)):(U=t,t=n),t===n&&(t=U,he(),r=Ce(),r!==n?("pc"===e.substr(U,2)?(o="pc",U+=2):(o=n,0===ee&&ae(R)),o!==n?(D=t,t=function(e){return{value:e,unit:"pc"}}(r)):(U=t,t=n)):(U=t,t=n)))))),ee--,t===n&&0===ee&&ae(S),t}function ye(){let t,r,o;return ee++,t=U,r=Ce(),r!==n?("deg"===e.substr(U,3)?(o="deg",U+=3):(o=n,0===ee&&ae(F)),o!==n?(D=t,t=function(e){return{value:e,unit:"deg"}}(r)):(U=t,t=n)):(U=t,t=n),t===n&&(t=U,r=Ce(),r!==n?("rad"===e.substr(U,3)?(o="rad",U+=3):(o=n,0===ee&&ae(G)),o!==n?(D=t,t=function(e){return{value:e,unit:"rad"}}(r)):(U=t,t=n)):(U=t,t=n),t===n&&(t=U,r=Ce(),r!==n?(e.substr(U,4)===l?(o=l,U+=4):(o=n,0===ee&&ae(T)),o!==n?(D=t,t=function(e){return{value:e,unit:"grad"}}(r)):(U=t,t=n)):(U=t,t=n),t===n&&(t=U,r=Ce(),r!==n?(e.substr(U,4)===u?(o=u,U+=4):(o=n,0===ee&&ae(Z)),o!==n?(D=t,t=function(e){return{value:e,unit:"turn"}}(r)):(U=t,t=n)):(U=t,t=n)))),ee--,t===n&&(r=n,0===ee&&ae(O)),t}function ge(){let t,r,o,i;if(ee++,t=U,35===e.charCodeAt(U)?(r="#",U++):(r=n,0===ee&&ae(H)),r!==n){if(o=[],i=e.charAt(U),p.test(i)?U++:(i=n,0===ee&&ae(W)),i!==n)for(;i!==n;)o.push(i),i=e.charAt(U),p.test(i)?U++:(i=n,0===ee&&ae(W));else o=n;o!==n?(D=t,t={type:"hex",value:te()}):(U=t,t=n)}else U=t,t=n;return t===n&&(t=U,r=ue(),r!==n&&(D=t,r=function(e){return{type:"function",value:e}}(r)),t=r,t===n&&(t=U,r=pe(),r!==n&&(D=t,r={type:"named",value:te()}),t=r)),ee--,t===n&&(r=n,0===ee&&ae(j)),t}function Ce(){let t,r,o,i,s,a,c,l;for(t=U,r=e.charAt(U),d.test(r)?U++:(r=n,0===ee&&ae(X)),r===n&&(r=null),o=U,i=[],s=e.charAt(U),m.test(s)?U++:(s=n,0===ee&&ae(N));s!==n;)i.push(s),s=e.charAt(U),m.test(s)?U++:(s=n,0===ee&&ae(N));if(46===e.charCodeAt(U)?(s=".",U++):(s=n,0===ee&&ae(V)),s!==n){if(a=[],c=e.charAt(U),m.test(c)?U++:(c=n,0===ee&&ae(N)),c!==n)for(;c!==n;)a.push(c),c=e.charAt(U),m.test(c)?U++:(c=n,0===ee&&ae(N));else a=n;a!==n?(i=[i,s,a],o=i):(U=o,o=n)}else U=o,o=n;if(o===n)if(o=[],i=e.charAt(U),m.test(i)?U++:(i=n,0===ee&&ae(N)),i!==n)for(;i!==n;)o.push(i),i=e.charAt(U),m.test(i)?U++:(i=n,0===ee&&ae(N));else o=n;if(o!==n){if(i=U,101===e.charCodeAt(U)?(s="e",U++):(s=n,0===ee&&ae(Y)),s!==n){if(a=e.charAt(U),d.test(a)?U++:(a=n,0===ee&&ae(X)),a===n&&(a=null),c=[],l=e.charAt(U),m.test(l)?U++:(l=n,0===ee&&ae(N)),l!==n)for(;l!==n;)c.push(l),l=e.charAt(U),m.test(l)?U++:(l=n,0===ee&&ae(N));else c=n;c!==n?(s=[s,a,c],i=s):(U=i,i=n)}else U=i,i=n;i===n&&(i=null),D=t,t=parseFloat(te())}else U=t,t=n;return t}B=i();const be=B!==n&&U===e.length;function Me(){throw B!==n&&U<e.length&&ae({type:"end"}),function(e,t,n){return new a(a.buildMessage(e,t),e,t,n)}(K,Q<e.length?function(t=U){const n=e.codePointAt(t);return void 0===n?"":String.fromCodePoint(n)}(Q):null,Q<e.length?se(Q,Q+1):se(Q,Q))}return t.peg$library?{peg$result:B,peg$currPos:U,peg$FAILED:n,peg$maxFailExpected:K,peg$maxFailPos:Q,peg$success:be,peg$throw:be?void 0:Me}:be?B:void Me()}function l(e){if(!e||0===e.length)return null;if("string"==typeof e){const t=u(e);return t&&0!==t.length?t:null}const t=e.map((e=>{if(!Number.isFinite(e.scale)||e.scale<=0)throw new o.Z("effect:invalid-scale","scale must be finite and greater than 0",{stop:e});return{scale:e.scale,effects:u(e.value)}}));t.sort(((e,t)=>t.effects.length-e.effects.length));for(let e=0;e<t.length-1;e++){if(!(0,s.AS)(t[e].effects,t[e+1].effects))throw new o.Z("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:t[e].effects,b:t[e+1].effects});(0,s.uF)(t[e].effects,t[e+1].effects)}return t.sort(((e,t)=>t.scale-e.scale)),t}function u(e){let t;if(!e)return[];try{t=c(e)}catch(t){throw new o.Z("effect:invalid-syntax","Invalid effect syntax",{value:e,error:t})}return t.map((e=>function(e){try{switch(e.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return function(e){let t=1;return f(e.parameters,1),1===e.parameters.length&&(t=y(e.parameters[0])),new i.GI(e.name,t)}(e);case"opacity":return function(e){let t=1;return f(e.parameters,1),1===e.parameters.length&&(t=y(e.parameters[0])),new i.Zx(t)}(e);case"hue-rotate":return function(e){let t=0;return f(e.parameters,1),1===e.parameters.length&&(t=function(e){return function(e){if("quantity"!==e.type||!(0===e.value&&null===e.unit||e.unit&&null!=d[e.unit]))throw new o.Z("effect:type-error",`Expected <angle>, Actual: ${h(e)}`,{term:e})}(e),e.value*d[e.unit]||0}(e.parameters[0])),new i.Tq(t)}(e);case"blur":return function(e){let t=0;return f(e.parameters,1),1===e.parameters.length&&(t=C(e.parameters[0]),p(t,e.parameters[0])),new i.Tj(t)}(e);case"drop-shadow":return function(e){const t=[];let n=null;for(const r of e.parameters)if("color"===r.type){if(t.length&&Object.freeze(t),n)throw new o.Z("effect:type-error","Accepts only one color",{});n=b(r)}else{const e=C(r);if(Object.isFrozen(t))throw new o.Z("effect:type-error","<length> parameters not consecutive",{lengths:t});t.push(e),3===t.length&&p(e,r)}if(t.length<2||t.length>3)throw new o.Z("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${t.length}}`,{lengths:t});return new i.CE(t[0],t[1],t[2]||0,n||M("black"))}(e);case"bloom":return function(e){let t=1,n=0,r=0;return f(e.parameters,3),e.parameters[0]&&(t=y(e.parameters[0])),e.parameters[1]&&(n=C(e.parameters[1]),p(n,e.parameters[1])),e.parameters[2]&&(r=y(e.parameters[2])),new i.rk(t,n,r)}(e)}}catch(t){throw t.details.filter=e,t}throw new o.Z("effect:unknown-effect",`Effect '${e.name}' is not supported`,{effect:e})}(e)))}function f(e,t){if(e.length>t)throw new o.Z("effect:type-error",`Function supports up to ${t} parameters, Actual: ${e.length}`,{parameters:e})}function h(e){if("color"===e.type)return"<color>";if(e.unit){if(e.unit in m)return"<length>";if(e.unit in d)return"<angle>";if("%"===e.unit)return"<percentage>"}return"<double>"}function p(e,t){if(e<0)throw new o.Z("effect:type-error",`Negative values are not allowed, Actual: ${e}`,{term:t})}const d={deg:1,grad:.9,rad:180/Math.PI,turn:360};const m={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function y(e){!function(e){if("quantity"!==e.type||null!==e.unit&&"%"!==e.unit)throw new o.Z("effect:type-error",`Expected <double> or <percentage>, Actual: ${h(e)}`,{term:e})}(e);const t=e.value;return p(t,e),"%"===e.unit?.01*t:t}function g(e){return function(e){if("quantity"!==e.type||null!==e.unit)throw new o.Z("effect:type-error",`Expected <double>, Actual: ${h(e)}`,{term:e})}(e),p(e.value,e),e.value}function C(e){return function(e){if("quantity"!==e.type||!(0===e.value&&null===e.unit||e.unit&&null!=m[e.unit]))throw new o.Z("effect:type-error",`Expected <length>, Actual: ${h(e)}`,{term:e})}(e),e.value*m[e.unit]||0}function b(e){switch(e.colorType){case"hex":return(0,r.a7)(e.value);case"named":return M(e.value);case"function":return function(e){if(f(e.parameters,4),x.test(e.name))return[y(e.parameters[0]),y(e.parameters[1]),y(e.parameters[2]),e.parameters[3]?y(e.parameters[3]):1];if(_.test(e.name))return(0,r.Y6)(g(e.parameters[0]),y(e.parameters[1]),y(e.parameters[2]),e.parameters[3]?y(e.parameters[3]):1);throw new o.Z("effect:syntax-error",`Invalid color function '${e.name}'`,{colorFunction:e})}(e.value)}}function M(e){if(!(0,r.St)(e))throw new o.Z("effect:unknown-color",`color '${e}' isn't valid`,{namedColor:e});return(0,r.VL)(e)}const x=/^rgba?/i,_=/^hsla?/i},6298:function(e,t,n){n.d(t,{E:function(){return o}});var r=n(44252);const o={CIMVectorMarker:{scalesymbolsproportionally:!1,respectframe:!0,anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMPictureMarker:{scalex:1,texturefilter:"Draft",anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMTextSymbol:{angle:0,anglex:0,angley:0,halosize:1,height:10,horizontalalignment:"Left",kerning:!0,letterspacing:0,letterwidth:100,ligatures:!0,linegap:0,offsetx:0,offsety:0,strikethrough:!1,textcase:"Normal",textstring:"",underline:!1,verticalalignment:"Bottom",enable:!0,colorlocked:!1},CIMSolidStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMPictureStroke:{texturefilter:"Draft",capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMGradientStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1,gradientMethod:"AcrossLine",gradientSize:75,gradientSizeUnits:r.IH.Relative,gradientType:"Discrete",interval:5},CIMSolidFill:{enable:!0,colorlocked:!1},CIMPictureFill:{offsetx:0,offsety:0,rotation:0,scalex:1,height:10,texturefilter:"Draft",enable:!0,colorlocked:!1},CIMHatchFill:{offsetx:0,offsety:0,rotation:0,separation:4,enable:!0,colorlocked:!1},CIMGradientFill:{enable:!0,angle:90,gradientMethod:"Linear",gradientSize:75,gradientSizeUnits:r.IH.Relative,gradientType:"Discrete",interval:5},CIMGeometricEffectAddControlPoints:{angletolerance:120},CIMGeometricEffectArrow:{arrowtype:"OpenEnded",width:5},CIMGeometricEffectBuffer:{size:1},CIMGeometricEffectCut:{begincut:1,endcut:1,middlecut:0,invert:!1},CIMGeometricEffectDashes:{customendingoffset:0,linedashending:"NoConstraint",offsetalongline:0},CIMGeometricEffectDonut:{method:"Mitered",option:"Accurate",width:2},CIMGeometricEffectJog:{angle:225,length:20,position:50},CIMGeometricEffectControlMeasureLine:{rule:"FullGeometry"},CIMGeometricEffectMove:{offsetx:1,offsety:-1},CIMGeometricEffectOffset:{method:"Square",offset:1,option:"Fast"},CIMGeometricEffectRadial:{angle:0,length:5},CIMGeometricEffectRotate:{angle:15},CIMGeometricEffectScale:{xscalefactor:1.15,yscalefactor:1.15},CIMGeometricEffectWave:{amplitude:2,period:3,seed:1,waveform:"Sinus"},CIMMarkerPlacementAlongLine:{customendingoffset:0,endings:"WithHalfGap",offsetalongline:0,placeperpart:!0,angletoline:!0,offset:0},CIMMarkerPlacementAtExtremities:{extremityplacement:"Both",offsetalongline:0,angletoline:!0,offset:0},CIMMarkerPlacementAtRatioPositions:{beginposition:0,endposition:0,flipfirst:!0,angletoline:!0,offset:0},CIMMarkerPlacementInsidePolygon:{gridangle:0,gridtype:"Fixed",offsetx:0,offsety:0,randomness:100,seed:0,shiftoddrows:!1,stepx:16,stepy:16,clipping:"ClipAtBoundary"},CIMMarkerPlacementOnLine:{relativeto:"LineMiddle",startpointoffset:0,angletoline:!0,offset:0},CIMMarkerPlacementOnVertices:{placeperpart:!0,placeoncontrolpoints:!0,placeonendpoints:!0,placeonregularvertices:!0,angletoline:!0,offset:0},CIMMarkerPlacementPolygonCenter:{method:"OnPolygon",offsetx:0,offsety:0,clipatboundary:!1},CIMAnimatedSymbolProperties:{playanimation:!1,reverseanimation:!1,randomizestarttime:!1,randomizestartseed:0,starttimeoffset:0,duration:3,endingduration:3,useendingduration:!1,repeattype:r.of.Loop,repeatdelay:0,easing:r.IB.Linear},CIMSymbolAnimationSize:{tosize:10},CIMSymbolAnimationScale:{scalefactor:1},CIMSymbolAnimationColor:{tocolor:[255,255,255,1]},CIMSymbolAnimationTransparency:{totransparency:0},CIMSymbolAnimationRotation:{torotation:0,rotateclockwise:!1},CIMSymbolAnimationOffset:{offsetx:0,offsety:0},CIMSymbolAnimationMoveAlongLine:{speed:30,distanceAlong:100}}},61421:function(e,t,n){n.d(t,{$Z:function(){return I},BX:function(){return x},Cc:function(){return y},E_:function(){return a},F:function(){return w},FG:function(){return v},H1:function(){return i},J0:function(){return m},JW:function(){return A},Lb:function(){return H},Le:function(){return E},Ml:function(){return T},On:function(){return b},Qf:function(){return S},RI:function(){return g},TB:function(){return P},Ul:function(){return G},W7:function(){return _},X_:function(){return k},be:function(){return u},e0:function(){return O},gJ:function(){return d},hU:function(){return R},hf:function(){return r},k5:function(){return p},oY:function(){return l},pJ:function(){return C},qQ:function(){return s},wi:function(){return M},yL:function(){return h},yl:function(){return L},zL:function(){return f}});n(6298);function r(e,t,n,r){return function(e){return"function"==typeof e}(e)?e(t,n,r):e}function o(e){let t=e.length;for(;t--;)if(!" /-,\n".includes(e.charAt(t)))return!1;return!0}function i(e,t){const n=[];let r=0,i=-1;do{if(i=e.indexOf("[",r),i>=r){if(i>r){const t=e.slice(r,i);n.push([t,null,o(t)])}if(r=i+1,i=e.indexOf("]",r),i>=r){if(i>r){const o=t[e.slice(r,i)];o&&n.push([null,o,!1])}r=i+1}}}while(-1!==i);if(r<e.length){const t=e.slice(r);n.push([t,null,o(t)])}return n}function s(e,t,n){let r="",o=null;for(const n of t){const[t,i,s]=n;if(null!=t&&""!==t)s?o=t:(null!=o&&(r+=o,o=null),r+=t);else{const t=e.readAttribute(i);null!=t&&""!==t&&(null!==o&&(r+=o,o=null),r+=t)}}return c(r,n)}function a(e,t,n,r){let o="",i=null;for(const r of t){const[t,s,a]=r;if(null!=t&&""!==t)a?i=t:(null!=i&&(o+=i,i=null),o+=t);else{let t=s;null!=n&&(t=F(s,n));const r=e.attributes[t];null!=r&&""!==r&&(null!=i&&(o+=i,i=null),o+=r)}}return c(o,r)}function c(e,t){switch("string"!=typeof e&&(e=String(e)),t){case"LowerCase":return e.toLowerCase();case"Allcaps":return e.toUpperCase();default:return e}}function l(e){return e?[e[0],e[1],e[2],e[3]/255]:[0,0,0,0]}function u(e){return e.data?.symbol??null}function f(e){return"CIMVectorMarker"===e.type||"CIMPictureMarker"===e.type||"CIMBarChartMarker"===e.type||"CIMCharacterMarker"===e.type||"CIMPieChartMarker"===e.type||"CIMStackedBarChartMarker"===e.type}function h(e){return"CIMGradientStroke"===e.type||"CIMPictureStroke"===e.type||"CIMSolidStroke"===e.type}function p(e){return null!=e&&("CIMGradientFill"===e.type||"CIMHatchFill"===e.type||"CIMPictureFill"===e.type||"CIMSolidFill"===e.type||"CIMWaterFill"===e.type)}function d(e){return null!=e&&("CIMMarkerPlacementAlongLineRandomSize"===e.type||"CIMMarkerPlacementAlongLineSameSize"===e.type||"CIMMarkerPlacementAlongLineVariableSize"===e.type||"CIMMarkerPlacementAtExtremities"===e.type||"CIMMarkerPlacementAtMeasuredUnits"===e.type||"CIMMarkerPlacementAtRatioPositions"===e.type||"CIMMarkerPlacementOnLine"===e.type||"CIMMarkerPlacementOnVertices"===e.type)}const m=(e,t=0)=>null==e||isNaN(e)?t:e,y=e=>{if(!e)return!1;for(const t of e)switch(t.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectDonut":case"CIMGeometricEffectOffset":case"CIMGeometricEffectTaperedPolygon":case"CIMGeometricEffectEnclosingPolygon":return!0}return!1};function g(){return Promise.all([n.e(27093),n.e(13323)]).then(n.bind(n,69339))}function C(e){if(!e)return"normal";switch(e.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function b(e){if(!e)return"normal";switch(e.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function M(e){let t="normal",n="normal";if(e){const r=e.toLowerCase();r.includes("italic")?t="italic":r.includes("oblique")&&(t="oblique"),r.includes("bold")?n="bold":r.includes("light")&&(n="lighter")}return{style:t,weight:n}}function x(e){return e.underline?"underline":e.strikethrough?"line-through":"none"}function _(e){if(!e)return null;switch(e.type){case"CIMPolygonSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const e=_(t);if(null!=e)return e}break;case"CIMTextSymbol":return _(e.symbol);case"CIMSolidFill":return e.color}return null}function I(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const t=e.symbolLayers;if(t)for(const e of t){const t=I(e);if(null!=t)return t}break}case"CIMTextSymbol":return I(e.symbol);case"CIMSolidStroke":return e.color}}function w(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const e=w(t);if(void 0!==e)return e}break;case"CIMTextSymbol":return w(e.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return e.width}}function k(e){switch(e){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function v(e){switch(e){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function S(e){return(e?Object.keys(e):[]).map((t=>({name:t,alias:t,type:"string"==typeof e[t]?"esriFieldTypeString":"esriFieldTypeDouble"})))}const P=e=>e.includes("data:image/svg+xml");function A(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function E(e){return e?e.charAt(0).toLowerCase()+e.slice(1):e}function L(e,t,n,r,o,i,s=!0){const{infos:a}=i;let c=1,l=0,u=0,f=0,h=1;for(const{absoluteAnchorPoint:e,offsetX:t,offsetY:n,rotation:r,size:o,frameHeight:i,rotateClockWise:p,scaleSymbolsProportionally:d}of a)h=e?1:c,u=$(t,n,l,h,u),f=Z(t,n,l,h,f),i&&(d||s)&&(c*=o/i),l=j(r,p,l);const p=$(r,o,l,h,u),d=Z(r,o,l,h,f);return{size:e*c,rotation:j(t,n,l),offsetX:p,offsetY:d}}function z(e){return"string"==typeof e?function(e){return e.split(" ").map((e=>Number(e)))}(e):e}function R(e){return e?.dashTemplate&&(e.dashTemplate=z(e.dashTemplate)),e}function O(e){if(null==e)return"Normal";switch(e.type){case"CIMTextSymbol":return e.textCase??"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const t=e.symbolLayers;if(!t)return"Normal";for(const e of t)if("CIMVectorMarker"===e.type)return O(e)}break;case"CIMVectorMarker":{const t=e.markerGraphics;if(!t)return"Normal";for(const e of t)if(e.symbol)return O(e.symbol)}}return"Normal"}function F(e,t){if(null!==t){const n=t.get(e);return n?n.name:e}return e}function G(e){return e.map((e=>({...e,propertyName:E(e.propertyName)})))}function T(e){const t={};for(const n in e){const r=e[n];t[E(n)]=r}return t}function Z(e,t,n,r,o){const i=n*Math.PI/180;if(i){const n=Math.cos(i);return(Math.sin(i)*e+n*t)*r+o}return t*r+o}function $(e,t,n,r,o){const i=n*Math.PI/180;return i?(Math.cos(i)*e-Math.sin(i)*t)*r+o:e*r+o}function j(e,t,n){return t?n-e:n+e}function H(e,t){return Math.max(Math.min((e??t)/100,1),0)}},27737:function(e,t,n){n.d(t,{YV:function(){return i},ZB:function(){return p},iW:function(){return c}});var r=n(53147),o=n(61421);function i(e,t,n,r){if(e)if("CIMTextSymbol"!==e.type){if(n&&e.effects)for(const n of e.effects)a(n,t);if(e.symbolLayers)for(const n of e.symbolLayers){switch(n.type){case"CIMPictureMarker":case"CIMVectorMarker":s(n,t,r);break;case"CIMPictureStroke":case"CIMSolidStroke":case"CIMGradientStroke":!r?.preserveOutlineWidth&&n.width&&(n.width*=t);break;case"CIMPictureFill":n.height&&(n.height*=t),n.offsetX&&(n.offsetX*=t),n.offsetY&&(n.offsetY*=t);break;case"CIMHatchFill":i(n.lineSymbol,t,!0,{...r,preserveOutlineWidth:!1}),n.offsetX&&(n.offsetX*=t),n.offsetY&&(n.offsetY*=t),n.separation&&(n.separation*=t)}if(n.effects)for(const e of n.effects)a(e,t)}}else null!=e.height&&(e.height*=t)}function s(e,t,n){if(e&&(e.markerPlacement&&function(e,t){switch((0,o.gJ)(e)&&e.offset&&(e.offset*=t),e.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(e.customEndingOffset&&(e.customEndingOffset*=t),e.offsetAlongLine&&(e.offsetAlongLine*=t),e.placementTemplate&&e.placementTemplate.length){const n=e.placementTemplate.map((e=>e*t));e.placementTemplate=n}break;case"CIMMarkerPlacementAlongLineVariableSize":if(e.maxRandomOffset&&(e.maxRandomOffset*=t),e.placementTemplate&&e.placementTemplate.length){const n=e.placementTemplate.map((e=>e*t));e.placementTemplate=n}break;case"CIMMarkerPlacementOnLine":e.startPointOffset&&(e.startPointOffset*=t);break;case"CIMMarkerPlacementAtExtremities":e.offsetAlongLine&&(e.offsetAlongLine*=t);break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":e.beginPosition&&(e.beginPosition*=t),e.endPosition&&(e.endPosition*=t);break;case"CIMMarkerPlacementPolygonCenter":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t);break;case"CIMMarkerPlacementInsidePolygon":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t),e.stepX&&(e.stepX*=t),e.stepY&&(e.stepY*=t)}}(e.markerPlacement,t),e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t),e.anchorPoint&&"Absolute"===e.anchorPointUnits&&(e.anchorPoint={x:e.anchorPoint.x*t,y:e.anchorPoint.y*t}),e.size=null!=e.size?e.size*t:0,"CIMVectorMarker"===e.type&&e.markerGraphics))for(const r of e.markerGraphics)e.scaleSymbolsProportionally||i(r.symbol,t,!0,n)}function a(e,t){switch(e.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":e.width&&(e.width*=t);break;case"CIMGeometricEffectBuffer":e.size&&(e.size*=t);break;case"CIMGeometricEffectCut":e.beginCut&&(e.beginCut*=t),e.endCut&&(e.endCut*=t),e.middleCut&&(e.middleCut*=t);break;case"CIMGeometricEffectDashes":if(e.customEndingOffset&&(e.customEndingOffset*=t),e.offsetAlongLine&&(e.offsetAlongLine*=t),e.dashTemplate&&e.dashTemplate.length){const n=e.dashTemplate.map((e=>e*t));e.dashTemplate=n}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":e.length&&(e.length*=t);break;case"CIMGeometricEffectMove":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t);break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":e.offset&&(e.offset*=t);break;case"CIMGeometricEffectRegularPolygon":e.radius&&(e.radius*=t);break;case"CIMGeometricEffectTaperedPolygon":e.fromWidth&&(e.fromWidth*=t),e.length&&(e.length*=t),e.toWidth&&(e.toWidth*=t);break;case"CIMGeometricEffectWave":e.amplitude&&(e.amplitude*=t),e.period&&(e.period*=t)}}function c(e){const t=[];return l((0,o.be)(e),t),t.length?new r.Z((0,o.oY)(t[0])):null}function l(e,t){if(!e)return;let n;n="CIMTextSymbol"===e.type?e.symbol:e;const r="CIMPolygonSymbol"===e.type;if(n?.symbolLayers)for(const e of n.symbolLayers)if(!(e.colorLocked||r&&((0,o.yL)(e)||(0,o.zL)(e)&&e.markerPlacement&&(0,o.gJ)(e.markerPlacement))))switch(e.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":e.tintColor&&u(t,e.tintColor);break;case"CIMVectorMarker":e.markerGraphics?.forEach((e=>{l(e.symbol,t)}));break;case"CIMSolidStroke":case"CIMSolidFill":u(t,e.color);break;case"CIMGradientFill":f(t,e);break;case"CIMHatchFill":l(e.lineSymbol,t)}}function u(e,t){for(const n of e)if(n.join(".")===t.join("."))return;e.push(t)}function f(e,t){const n=t.colorRamp?.type;switch(n){case"CIMMultipartColorRamp":t.colorRamp.colorRamps?.forEach((t=>{"CIMLinearContinuousColorRamp"===t.type&&h(e,t)}));break;case"CIMLinearContinuousColorRamp":case"CIMPolarContinuousColorRamp":h(e,t.colorRamp)}}function h(e,t){t&&(t.fromColor&&u(e,t.fromColor),t.toColor&&u(e,t.toColor))}function p(e,t,n){t instanceof r.Z||(t=new r.Z(t));const i=(0,o.be)(e);i&&d(i,t,n)}function d(e,t,n){if(!e)return;let r;r="CIMTextSymbol"===e.type?e.symbol:e;const i="CIMPolygonSymbol"===r?.type;if(r?.symbolLayers)for(const e of r.symbolLayers){if(e.colorLocked)continue;if(i)if(n){const{layersToColor:t}=n;if(((0,o.yL)(e)||(0,o.zL)(e)&&e.markerPlacement&&(0,o.gJ)(e.markerPlacement))&&"fill"===t||(0,o.k5)(e)&&"outline"===t)continue}else if((0,o.yL)(e)||(0,o.zL)(e)&&e.markerPlacement&&(0,o.gJ)(e.markerPlacement))continue;const r=t.toArray();switch(e.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":e.tintColor=r;break;case"CIMVectorMarker":e.markerGraphics?.forEach((e=>{d(e.symbol,t,n)}));break;case"CIMSolidStroke":case"CIMSolidFill":e.color=r;break;case"CIMGradientFill":m(e,t);break;case"CIMHatchFill":d(e.lineSymbol,t,n)}}}function m(e,t){const n=e.colorRamp?.type;switch(n){case"CIMMultipartColorRamp":e.colorRamp.colorRamps?.forEach((e=>{"CIMLinearContinuousColorRamp"===e.type&&y(e,t)}));break;case"CIMLinearContinuousColorRamp":case"CIMPolarContinuousColorRamp":y(e.colorRamp,t)}}function y(e,t){if(e&&(e.fromColor&&(e.fromColor=t.toArray()),e.toColor)){const n=t.clone();n.a=0,e.toColor=n.toArray()}}},48922:function(e,t,n){n.d(t,{Ne:function(){return b},Od:function(){return m},Sp:function(){return C},_M:function(){return d},iI:function(){return g},mx:function(){return y}});var r=n(1800),o=n(53147),i=n(78619),s=n(12853),a=n(96094),c=n(27737);const l="picture-fill",u="simple-fill",f="simple-marker",h=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),p=new s.z(1e3);function d(e){const t=e.style;let n=null;if(e)switch(e.type){case f:"cross"!==t&&"x"!==t&&(n=e.color);break;case u:t&&"solid"!==t?"none"!==t&&(n={type:"pattern",x:0,y:0,src:(0,r.V)(`esri/symbols/patterns/${t}.png`),width:5,height:5}):n=e.color;break;case l:n={type:"pattern",src:e.url,width:(0,a.F2)(e.width)*e.xscale,height:(0,a.F2)(e.height)*e.yscale,x:(0,a.F2)(e.xoffset),y:(0,a.F2)(e.yoffset)};break;case"text":n=e.color;break;case"cim":n=(0,c.iW)(e)}return n}function m(e,t){const n=e+"-"+t;return void 0!==p.get(n)?Promise.resolve(p.get(n)):(0,i.Z)(e,{responseType:"image"}).then((e=>{const r=e.data,o=r.naturalWidth,i=r.naturalHeight,s=document.createElement("canvas");s.width=o,s.height=i;const a=s.getContext("2d");a.fillStyle=t,a.fillRect(0,0,o,i),a.globalCompositeOperation="destination-in",a.drawImage(r,0,0);const c=s.toDataURL();return p.put(n,c),c}))}function y(e){if(!e)return null;let t=null;switch(e.type){case u:case l:case f:t=y(e.outline);break;case"simple-line":{const n=(0,a.F2)(e.width);null!=e.style&&"none"!==e.style&&0!==n&&(t={color:e.color,style:C(e.style),width:n,cap:e.cap,join:"miter"===e.join?(0,a.F2)(e.miterLimit):e.join},t.dashArray=g(t).join(",")||"none");break}default:t=null}return t}function g(e){if(!e?.style)return[];const{dashArray:t,style:n,width:r}=e;if("string"==typeof t&&"none"!==t)return t.split(",").map((e=>Number(e)));const o=r??0,i=h.has(n)?h.get(n).map((e=>e*o)):[];if("butt"!==e.cap)for(const[e,t]of i.entries())i[e]=e%2==1?t+o:Math.max(t-o,1);return i}const C=(()=>{const e={};return t=>{if(e[t])return e[t];const n=t.replaceAll("-","");return e[t]=n,n}})(),b=new o.Z([128,128,128])},30903:function(e,t,n){n.d(t,{BR:function(){return w},QL:function(){return v},Y6:function(){return p},YW:function(){return d},_h:function(){return y},e3:function(){return I},nf:function(){return m},tb:function(){return C},wJ:function(){return k}});var r=n(53147),o=n(29292),i=(n(61432),n(96094)),s=n(82846),a=n(615),c=n(27737),l=n(48922),u=n(75485),f=n(68578);const h=new r.Z("white");function p(e){if(!e)return 0;if((0,f.dU)(e)){const t=function(e){const t=e.symbolLayers?.at(-1);if(t&&"outline"in t)return t?.outline?.size}(e);return null!=t?t:0}return(0,i.Wz)((0,l.mx)(e)?.width)}function d(e){if(null==e||!("symbolLayers"in e)||null==e.symbolLayers)return!1;switch(e.type){case"point-3d":return e.symbolLayers.some((e=>"object"===e.type));case"line-3d":return e.symbolLayers.some((e=>"path"===e.type));case"polygon-3d":return e.symbolLayers.some((e=>"object"===e.type||"extrude"===e.type));default:return!1}}function m(e){return e.resource?.href??""}function y(e,t){if(!e)return null;let n=null;return(0,f.dU)(e)?n=function(e){const t=e.symbolLayers;if(!t)return null;let n=null;return t.forEach((e=>{"object"===e.type&&e.resource?.href||(n="water"===e.type?e.color:e.material?e.material.color:null)})),n?new r.Z(n):null}(e):(0,f.cT)(e)&&(n="cim"===e.type?(0,c.iW)(e):e.color?new r.Z(e.color):null),n?g(n,t):null}function g(e,t){if(null==t||null==e)return e;const n=e.toRgba();return n[3]=n[3]*t,new r.Z(n)}function C(e,t,n){e&&(t||null!=n)&&(t&&(t=new r.Z(t)),(0,f.dU)(e)?function(e,t,n){const r=e.symbolLayers;if(!r)return;const o=e=>g(t??e??(null!=n?h:null),n);r.forEach((e=>{if("object"!==e.type||!e.resource?.href||t)if("water"===e.type)e.color=o(e.color);else{const t=null!=e.material?e.material.color:null,r=o(t);if(null==e.material?e.material=new u.b({color:r}):e.material.color=r,null!=n&&"outline"in e&&null!=e.outline?.color&&(e.outline.color=g(e.outline.color,n)),"marker"in e&&null!=e.marker){const t=o(e.marker.color);e.marker.color=t}}}))}(e,t,n):(0,f.cT)(e)&&function(e,t,n){(t=t??e.color)&&(e.color=g(t,n)),null!=n&&"outline"in e&&e.outline?.color&&(e.outline.color=g(e.outline.color,n))}(e,t,n))}async function b(e,t){const r=e.symbolLayers;r&&await(0,o.Ed)(r,(async e=>async function(e,t){switch(e.type){case"extrude":!function(e,t){const n=t[2];"number"==typeof n&&(e.size=n)}(e,t);break;case"icon":case"line":case"text":!function(e,t){const n=M(t);null!=n&&(e.size=n)}(e,t);break;case"path":!function(e,t){const n=x(t,s.hq,[e.width,void 0,e.height]);null!=n&&(e.width=_(t[0],e.width,1,n),e.height=_(t[2],e.height,1,n))}(e,t);break;case"object":await async function(e,t){const{resourceSize:r,symbolSize:o}=await async function(e){const{computeObjectLayerResourceSize:t}=await n.e(99795).then(n.bind(n,99795)),r=await t(e,10),{width:o,height:i,depth:s}=e,a=[o,s,i];let c=1;for(let e=0;e<3;e++){const t=a[e];if(null!=t){c=t/r[e];break}}for(let e=0;e<3;e++)null==a[e]&&(a[e]=r[e]*c);return{resourceSize:r,symbolSize:a}}(e),i=x(t,r,o);null!=i&&(e.width=_(t[0],o[0],r[0],i),e.depth=_(t[1],o[1],r[1],i),e.height=_(t[2],o[2],r[2],i))}(e,t)}}(e,t)))}function M(e){for(const t of e)if("number"==typeof t)return t;return null}function x(e,t,n){for(let r=0;r<3;r++){const o=e[r];switch(o){case"symbol-value":{const e=n[r];return null!=e?e/t[r]:1}case"proportional":break;default:if(o&&t[r])return o/t[r]}}return null}function _(e,t,n,r){switch(e){case"proportional":return n*r;case"symbol-value":return null!=t?t:n;default:return e}}async function I(e,t){if(e&&t)return(0,f.dU)(e)?b(e,t):void((0,f.cT)(e)&&function(e,t){const n=M(t);if(null!=n)switch(e.type){case"simple-marker":e.size=n;break;case"picture-marker":{const t=e.width/e.height;t>1?(e.width=n,e.height=n*t):(e.width=n*t,e.height=n);break}case"simple-line":e.width=n;break;case"text":e.font.size=n}}(e,t))}function w(e,t,n){if(e&&null!=t)if((0,f.dU)(e)){const r=e.symbolLayers;r&&r.forEach((e=>{if("object"===e.type)switch(n){case"tilt":e.tilt=(e.tilt??0)+t;break;case"roll":e.roll=(e.roll??0)+t;break;default:e.heading=(e.heading??0)+t}"icon"===e.type&&(e.angle+=t)}))}else(0,f.cT)(e)&&("simple-marker"!==e.type&&"picture-marker"!==e.type&&"text"!==e.type||(e.angle+=t))}function k(e){if(!e)return null;const t=e.effects.filter((e=>"bloom"!==e.type)).map((e=>e.toJSON()));return(0,a.rM)(t)}function v(e){return null!=e&&"polygon-3d"===e.type&&e.symbolLayers.some((e=>"extrude"===e.type))}},51429:function(e,t,n){n.d(t,{x:function(){return s}});var r=n(88190),o=n(42022),i=n(60162);class s extends o.a{constructor(e){super({...e,constraint:new r.Hk(e.targetPoint)})}get hints(){return[new i.n(this.targetPoint,this.isDraped,this.domain)]}}},15955:function(e,t,n){n.r(t),n.d(t,{GraphicsSnappingSource:function(){return z}});var r=n(73440),o=n(70880),i=n(3480),s=n(29292),a=n(30062),c=n(93568),l=n(90403),u=n(17155),f=(n(61432),n(96711),n(48023)),h=n(60147),p=n(67764),d=n(13132),m=n(37204),y=n(98842),g=n(64246),C=n(24564),b=n(57536),M=n(95014),x=n(33235),_=n(299),I=n(51870),w=n(30903),k=n(29668),v=n(23989),S=n(18012),P=n(6733),A=n(46264),E=n(50399);const L="graphics-collections";let z=class extends o.Z{get updating(){return this._updatingHandles.updating}get _hasZ(){const e=this.view;return null!=e&&"3d"===e.type&&"map-notes"!==this.layerSource.layer.type}get _snappingElevationAligner(){const{view:e}=this,{layer:t}=this.layerSource,n=null!=e&&"3d"===e.type;if(!n||"map-notes"===t.type)return(0,S.p)();return(0,S.p)(n,{elevationInfo:t.elevationInfo,alignPointsInFeatures:async(n,r)=>(await(0,c.Hl)(e.whenLayerView(t),r)).elevationAlignPointsInFeatures(n,r)})}get _snappingElevationFilter(){const{view:e}=this,t=null!=e&&"3d"===e.type&&"map-notes"!==this.layerSource.layer.type;return(0,P.c)(t)}get _symbologySnappingFetcher(){const{view:e}=this,{layer:t}=this.layerSource,n=null!=e&&"3d"===e.type,r=this._extrudedPolygonSymbolsCount>0;return n&&"map-notes"!==t.type&&r?(0,A.k)(r,(async(n,r)=>{const o=await e.whenLayerView(t);return(0,c.k_)(r),o.queryForSymbologySnapping({candidates:n,spatialReference:e.spatialReference},r)})):(0,A.k)()}constructor(e){super(e),this.availability=1,this._sources={multipoint:null,point:null,polygon:null,polyline:null},this._loadedWkids=new Set,this._loadedWkts=new Set,this._pendingAdds=[],this._extrudedPolygonSymbolsCount=0,this._updatingHandles=new h.R,this._memoizedMakeGetGroundElevation=(0,a.H)(v.g)}destroy(){for(const e of this._pendingAdds)e.task.abort();this._pendingAdds.length=0,this._mapSources((e=>this._destroySource(e))),this._updatingHandles.destroy()}initialize(){this._updatingHandles.add((()=>this.getGraphicsLayers()),(e=>{this._updatingHandles.removeHandles(L);for(const t of e)this._addMany(t.graphics.toArray()),this.addHandles([t.on("graphic-update",(e=>this._onGraphicUpdate(e))),this._updatingHandles.addOnCollectionChange((()=>t.graphics),(e=>this._onGraphicsChanged(e)))],L)}),l.nn);const{view:e}=this,{layer:t}=this.layerSource;null!=e&&"3d"===e.type&&"map-notes"!==t.type&&e.elevationProvider&&this.addHandles([e.elevationProvider.on("elevation-change",(({context:e})=>{(0,I.W_)(e,t.elevationInfo)&&this._snappingElevationAligner.notifyElevationSourceChange()})),(0,l.YP)((()=>t.elevationInfo),(()=>this._snappingElevationAligner.notifyElevationSourceChange()),l.nn),(0,l.on)((()=>t),["edits","apply-edits","graphic-update"],(()=>this._symbologySnappingFetcher.notifySymbologyChange()))])}async fetchCandidates(e,t){const{point:n,coordinateHelper:{spatialReference:r}}=e,o=await(0,c.OT)(this._mapSources((n=>this._fetchCandidatesForSource(n,e,t))));(0,c.k_)(t);const i=this._memoizedMakeGetGroundElevation(this.view,r),s=o.flat().map((e=>(0,v.X)(e,i)));return(0,k.lQ)(n,s),s}async _fetchCandidatesForSource(e,t,n){const r=(0,k.rh)({parameters:t,mode:this.view?.type??"2d"}),o=await(0,b.T)(e.queryEngine,r,n);(0,c.k_)(n);const i=await this._snappingElevationAligner.alignCandidates(o.candidates,t.coordinateHelper.spatialReference,n);(0,c.k_)(n);const s=await this._symbologySnappingFetcher.fetch(i,n);(0,c.k_)(n);const a=0===s.length?i:[...i,...s];return this._snappingElevationFilter.filter(r,a)}refresh(){}_onGraphicUpdate(e){if(this.getGraphicsLayers().some((t=>t.graphics.includes(e.graphic))))switch(e.property){case"geometry":case"visible":this._remove(e.graphic),this._addMany([e.graphic])}}_onGraphicsChanged(e){for(const t of e.removed)this._remove(t);this._addMany(e.added)}_addMany(e){const t=[],n=new Map;for(const r of e)null!=r.geometry&&(this._needsInitializeProjection(r.geometry.spatialReference)?(t.push(r.geometry.spatialReference),n.set(r.uid,r)):this._add(r));this._createPendingAdd(t,n)}_createPendingAdd(e,t){if(!e.length)return;const n=(0,s.vr)((async n=>{await(0,d.initializeProjection)(e.map((e=>({source:e,dest:this.spatialReference}))),{signal:n}),this._markLoadedSpatialReferences(e);for(const e of t.values())this._add(e)}));this._updatingHandles.addPromise(n.promise);const r={task:n,graphics:t},o=()=>(0,i.e$)(this._pendingAdds,r);n.promise.then(o,o),this._pendingAdds.push(r)}_markLoadedSpatialReferences(e){for(const t of e){null!=t.wkid&&this._loadedWkids.add(t.wkid);const e=t.wkt2||t.wkt;e&&this._loadedWkts.add(e)}}_add(e){if(null==e.geometry||!e.visible)return;let t=e.geometry;if("mesh"===t.type)return;"extent"===t.type&&(t=p.Z.fromExtent(t));const n=this._ensureSource(t.type);if(null==n)return;const r=this._createOptimizedFeature(e.uid,t);null!=r&&(n.featureStore.add(r),(0,w.QL)(e.symbol)&&this._extrudedPolygonSymbolsCount++)}_needsInitializeProjection(e){if(null!=e.wkid&&this._loadedWkids.has(e.wkid))return!1;const t=e.wkt2||e.wkt;return!(t&&this._loadedWkts.has(t)||(0,d.canProjectWithoutEngine)(e,this.spatialReference))}_createOptimizedFeature(e,t){const n=(0,d.project)((0,m.SR)(t),this.spatialReference);if(!n)return null;const r=this._ensureGeometryHasZ(n),o=(0,g.GH)(r,this._hasZ,!1);return new C.u_(o,{[R]:e},null,e)}_ensureGeometryHasZ(e){if(!this._hasZ)return e;const t=e=>{for(;e.length<3;)e.push(0)},n=e.clone();switch(n.hasZ=!0,n.type){case"point":n.z=n.z??0;break;case"multipoint":n.points.forEach(t);break;case"polyline":n.paths.forEach((e=>e.forEach(t)));break;case"polygon":n.rings.forEach((e=>e.forEach(t)))}return n}_ensureSource(e){const t=this._sources[e];if(null!=t)return t;const n=this._createSource(e);return this._sources[e]=n,n}_createSource(e){const t=y.Mk.toJSON(e),n=this._hasZ,r=new M.Z({geometryType:t,hasZ:n,hasM:!1});return{featureStore:r,queryEngine:new x.qq({featureStore:r,fieldsIndex:_.Z.fromLayerJSON({fields:[{name:R,type:"esriFieldTypeOID",alias:R}]}),geometryType:t,hasM:!1,hasZ:n,featureIdInfo:{type:"object-id",fieldName:R},spatialReference:this.spatialReference,priority:E.T8.SNAPPING,scheduler:null!=this.view&&"3d"===this.view.type?this.view.resourceController.scheduler:null}),type:e}}_remove(e){this._mapSources((t=>this._removeFromSource(t,e)));for(const t of this._pendingAdds)t.graphics.delete(e.uid),0===t.graphics.size&&t.task.abort()}_removeFromSource(e,t){const n=t.uid;e.featureStore.has(n)&&(e.featureStore.removeById(t.uid),(0,w.QL)(t.symbol)&&this._extrudedPolygonSymbolsCount--)}_destroySource(e){e.queryEngine.destroy(),this._sources[e.type]=null}_mapSources(e){const{point:t,polygon:n,polyline:r,multipoint:o}=this._sources,i=[];return null!=t&&i.push(e(t)),null!=n&&i.push(e(n)),null!=r&&i.push(e(r)),null!=o&&i.push(e(o)),i}};(0,r._)([(0,u.Cb)()],z.prototype,"getGraphicsLayers",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],z.prototype,"layerSource",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],z.prototype,"spatialReference",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],z.prototype,"view",void 0),(0,r._)([(0,u.Cb)({readOnly:!0})],z.prototype,"updating",null),(0,r._)([(0,u.Cb)({readOnly:!0})],z.prototype,"availability",void 0),(0,r._)([(0,u.Cb)()],z.prototype,"_hasZ",null),(0,r._)([(0,u.Cb)()],z.prototype,"_snappingElevationAligner",null),(0,r._)([(0,u.Cb)()],z.prototype,"_snappingElevationFilter",null),(0,r._)([(0,u.Cb)()],z.prototype,"_symbologySnappingFetcher",null),(0,r._)([(0,u.Cb)()],z.prototype,"_extrudedPolygonSymbolsCount",void 0),z=(0,r._)([(0,f.j)("esri.views.interactive.snapping.featureSources.GraphicsSnappingSource")],z);const R="OBJECTID"},23989:function(e,t,n){n.d(t,{X:function(){return c},g:function(){return l}});var r=n(17609),o=n(24218),i=n(45712),s=n(51429);function a({x:e,y:t,z:n}){return(0,r.al)(e,t,n??0)}function c(e,t){switch(e.type){case"edge":return e.draped?new o.k({edgeStart:a(e.start),edgeEnd:a(e.end),targetPoint:(0,r.s)(a(e.target)),objectId:e.objectId,getGroundElevation:t}):new i.L({edgeStart:a(e.start),edgeEnd:a(e.end),targetPoint:(0,r.s)(a(e.target)),objectId:e.objectId,isDraped:!1});case"vertex":return new s.x({targetPoint:(0,r.s)(a(e.target)),objectId:e.objectId,isDraped:!1})}}function l(e,t){return null!=e&&"3d"===e.type?(n,r)=>e.elevationProvider.getElevation(n,r,0,t,"ground"):()=>null}},18012:function(e,t,n){n.d(t,{p:function(){return c}});n(61432);var r=n(12853),o=n(79577),i=n(93568),s=n(26636),a=n(46368);function c(e=!1,t){if(e){const{elevationInfo:e,alignPointsInFeatures:n}=t;return new u(e,n)}return new l}class l{async alignCandidates(e,t,n){return e}notifyElevationSourceChange(){}}class u{constructor(e,t){this._elevationInfo=e,this._alignPointsInFeatures=t,this._alignmentsCache=new r.z(1024),this._cacheVersion=0}async alignCandidates(e,t,n){const r=this._elevationInfo;return null==r||"absolute-height"!==r.mode||r.featureExpressionInfo?this._alignComputedElevationCandidates(e,t,n):(function(e,t,n){const{offset:r,unit:o}=n;if(null==r)return;const i=(0,s._R)(t),c=r*((0,a.Z7)(o??"meters")/i);for(const t of e)switch(t.type){case"edge":t.start.z+=c,t.end.z+=c;continue;case"vertex":t.target.z+=c;continue}}(e,t,r),e)}notifyElevationSourceChange(){this._alignmentsCache.clear(),this._cacheVersion++}async _alignComputedElevationCandidates(e,t,n){const r=new Map;for(const t of e)(0,o.s1)(r,t.objectId,p).push(t);const[s,a,c]=this._prepareQuery(r,t),l=await this._alignPointsInFeatures(s,n);if((0,i.k_)(n),c!==this._cacheVersion)return this._alignComputedElevationCandidates(e,t,n);this._applyCacheAndResponse(s,l,a);const{drapedObjectIds:u,failedObjectIds:f}=l,h=[];for(const t of e){const{objectId:e}=t;u.has(e)&&"edge"===t.type&&(t.draped=!0),f.has(e)||h.push(t)}return h}_prepareQuery(e,t){const n=[],r=[];for(const[t,o]of e){const e=[];for(const n of o)this._addToQueriesOrCachedResult(t,n.target,e,r),"edge"===n.type&&(this._addToQueriesOrCachedResult(t,n.start,e,r),this._addToQueriesOrCachedResult(t,n.end,e,r));0!==e.length&&n.push({objectId:t,points:e})}return[{spatialReference:t.toJSON(),pointsInFeatures:n},r,this._cacheVersion]}_addToQueriesOrCachedResult(e,t,n,r){const o=h(e,t),i=this._alignmentsCache.get(o);null==i?n.push(t):r.push(new f(t,i))}_applyCacheAndResponse(e,{elevations:t,drapedObjectIds:n,failedObjectIds:r},o){for(const e of o)e.apply();let i=0;const s=this._alignmentsCache;for(const{objectId:o,points:a}of e.pointsInFeatures){if(r.has(o)){i+=a.length;continue}const e=!n.has(o);for(const n of a){const r=h(o,n),a=t[i++];n.z=a,e&&s.put(r,a,1)}}}}class f{constructor(e,t){this.point=e,this.z=t}apply(){this.point.z=this.z}}function h(e,{x:t,y:n,z:r,spatialReference:o}){return`${e}-${t}-${n}-${r??0}}-wkid:${o?.wkid}`}function p(){return[]}},6733:function(e,t,n){n.d(t,{c:function(){return s}});n(61432);class r{filter(e,t){return t}notifyElevationSourceChange(){}}class o{filter(e,t){const{point:n,distance:r}=e,{z:o}=n;if(null==o)return t;if(0===t.length)return t;const s=function(e){return"number"==typeof e?{x:e,y:e,z:e}:e}(r),a=this._updateCandidatesTo3D(t,n,s).filter(i);return a.sort(l),a}_updateCandidatesTo3D(e,t,n){for(const r of e)switch(r.type){case"edge":a(r,t,n);continue;case"vertex":c(r,t,n);continue}return e}}function i(e){return e.distance<=1}function s(e=!1){return e?new o:new r}function a(e,t,{x:n,y:r,z:o}){const{start:i,end:s,target:a}=e;e.draped||function(e,t,n,r){const o=r.x-n.x,i=r.y-n.y,s=r.z-n.z,a=o*o+i*i+s*s,c=(t.x-n.x)*o+(t.y-n.y)*i+s*(t.z-n.z),l=Math.min(1,Math.max(0,c/a)),u=n.x+o*l,f=n.y+i*l,h=n.z+s*l;e.x=u,e.y=f,e.z=h}(a,t,i,s);const c=(t.x-a.x)/n,l=(t.y-a.y)/r,u=(t.z-a.z)/o;e.distance=Math.sqrt(c*c+l*l+u*u)}function c(e,t,{x:n,y:r,z:o}){const{target:i}=e,s=(t.x-i.x)/n,a=(t.y-i.y)/r,c=(t.z-i.z)/o,l=Math.sqrt(s*s+a*a+c*c);e.distance=l}function l(e,t){return e.distance-t.distance}},46264:function(e,t,n){n.d(t,{k:function(){return a}});n(61432);var r=n(28947),o=n(12853),i=n(93568),s=n(29138);function a(e=!1,t){return e?new l(t):new c}class c{async fetch(){return[]}notifySymbologyChange(){}}class l{constructor(e){this._getSymbologyCandidates=e,this._candidatesCache=new o.z(1024),this._cacheVersion=0}async fetch(e,t){if(0===e.length)return[];const n=[],o=[],s=this._candidatesCache;for(const t of e){const e=u(t),i=s.get(e);if(i)for(const e of i)o.push((0,r.d9)(e));else n.push(t),s.put(e,[],1)}if(0===n.length)return o;const a=this._cacheVersion,{candidates:c,sourceCandidateIndices:l}=await this._getSymbologyCandidates(n,t);if((0,i.k_)(t),a!==this._cacheVersion)return this.fetch(e,t);const f=[],{length:h}=c;for(let e=0;e<h;++e){const t=c[e],o=u(n[l[e]]),i=s.get(o);i.push(t),s.put(o,i,i.length),f.push((0,r.d9)(t))}return o.concat(f)}notifySymbologyChange(){this._candidatesCache.clear(),this._cacheVersion++}}function u(e){switch(e.type){case"vertex":{const{objectId:t,target:n}=e,r=`${t}-vertex-${n.x}-${n.y}-${n.z??0}`;return(0,s.hP)(r).toString()}case"edge":{const{objectId:t,start:n,end:r}=e,o=`${t}-edge-${n.x}-${n.y}-${n.z??0}-to-${r.x}-${r.y}-${r.z??0}`;return(0,s.hP)(o).toString()}default:return""}}},60162:function(e,t,n){n.d(t,{n:function(){return i}});var r=n(24910),o=n(10690);class i extends o.r{constructor(e,t,n){super(t,n),this.point=e}equals(e){return e instanceof i&&(0,r.q)(this.point,e.point)}}}}]);