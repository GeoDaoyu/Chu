"use strict";(self.webpackChunkscene_pro=self.webpackChunkscene_pro||[]).push([[43370],{65562:function(e,t,r){r.d(t,{C:function(){return p},a:function(){return _},b:function(){return f}});var n=r(17904),s=r(20638),i=r(45701),o=r(37124),a=r(85119),l=r(48857),c=r(34709),h=r(38419),u=r(74826),d=r(15150);class p extends u.K{constructor(){super(...arguments),this.opacity=1}}function f(e){const t=new d.kG;t.include(n.k),t.fragment.uniforms.add(new c.A("tex",(e=>e.texture))),e.hasOpacityFactor&&t.fragment.uniforms.add(new a.p("opacity",(e=>e.opacity)));const r=e.blitMode===h.J.Depth;return r&&(t.fragment.uniforms.add(new o.$("nearFar",(e=>e.camera.nearFar))),t.fragment.include(s.K),t.fragment.include(i.n)),t.fragment.main.add(l.H`
    ${r?l.H`
          float normalizedLinearDepth = (-linearDepthFromTexture(tex, uv) - nearFar[0]) / (nearFar[1] - nearFar[0]);
          fragColor = float2rgba(normalizedLinearDepth);`:l.H`
          fragColor = texture(tex, uv) ${e.hasOpacityFactor?"* opacity":""};`}`),t}const _=Object.freeze(Object.defineProperty({__proto__:null,CompositingPassParameters:p,build:f},Symbol.toStringTag,{value:"Module"}))},92643:function(e,t,r){r.d(t,{Ch:function(){return z},EX:function(){return A},G:function(){return S},H0:function(){return k},Ht:function(){return W},K6:function(){return x},O:function(){return j},WC:function(){return Z},Y3:function(){return R},_Y:function(){return C},_j:function(){return G},c9:function(){return F},gp:function(){return L},jQ:function(){return c},mj:function(){return E},nR:function(){return U},sJ:function(){return D},vG:function(){return T},xr:function(){return O}});var n=r(53147),s=r(3480),i=r(28947),o=r(99574),a=r(73749),l=r(27583);function c(e){return"r"in e&&"g"in e&&"b"in e}function h(e){return"h"in e&&"s"in e&&"v"in e}function u(e){return"l"in e&&"a"in e&&"b"in e}function d(e){return"l"in e&&"c"in e&&"h"in e}const p=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],f=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function _(e,t){const r=[];let n,s;if(e[0].length!==t.length)throw new Error("dimensions do not match");const i=e.length,o=e[0].length;let a=0;for(n=0;n<i;n++){for(a=0,s=0;s<o;s++)a+=e[n][s]*t[s];r.push(a)}return r}function g(e){const t=[e.r/255,e.g/255,e.b/255].map((e=>e<=.04045?e/12.92:((e+.055)/1.055)**2.4)),r=_(p,t);return{x:100*r[0],y:100*r[1],z:100*r[2]}}function y(e){const t=_(f,[e.x/100,e.y/100,e.z/100]).map((e=>{const t=e<=.0031308?12.92*e:1.055*e**(1/2.4)-.055;return Math.min(1,Math.max(t,0))}));return{r:Math.round(255*t[0]),g:Math.round(255*t[1]),b:Math.round(255*t[2])}}function m(e){const t=[e.x/95.047,e.y/100,e.z/108.883].map((e=>e>(6/29)**3?e**(1/3):1/3*(29/6)**2*e+4/29));return{l:116*t[1]-16,a:500*(t[0]-t[1]),b:200*(t[1]-t[2])}}function b(e){const t=e.l,r=[(t+16)/116+e.a/500,(t+16)/116,(t+16)/116-e.b/200].map((e=>e>6/29?e**3:3*(6/29)**2*(e-4/29)));return{x:95.047*r[0],y:100*r[1],z:108.883*r[2]}}function w(e){return function(e){const t=e.l,r=e.a,n=e.b,s=Math.sqrt(r*r+n*n);let i=Math.atan2(n,r);return i=i>0?i:i+2*Math.PI,{l:t,c:s,h:i}}(m(g(e)))}function v(e){return y(b(function(e){const t=e.l,r=e.c,n=e.h;return{l:t,a:r*Math.cos(n),b:r*Math.sin(n)}}(e)))}function O(e){return c(e)?e:d(e)?v(e):u(e)?function(e){return y(b(e))}(e):function(e){return"x"in e&&"y"in e&&"z"in e}(e)?y(e):h(e)?function(e){const t=(e.h+360)%360/60,r=e.s/100,n=e.v/100*255,s=n*r,i=s*(1-Math.abs(t%2-1));let o;switch(Math.floor(t)){case 0:o={r:s,g:i,b:0};break;case 1:o={r:i,g:s,b:0};break;case 2:o={r:0,g:s,b:i};break;case 3:o={r:0,g:i,b:s};break;case 4:o={r:i,g:0,b:s};break;case 5:case 6:o={r:s,g:0,b:i};break;default:o={r:0,g:0,b:0}}return o.r=Math.round(o.r+n-s),o.g=Math.round(o.g+n-s),o.b=Math.round(o.b+n-s),o}(e):e}function C(e){return h(e)?e:function(e){const t=e.r,r=e.g,n=e.b,s=Math.max(t,r,n),i=s-Math.min(t,r,n);let o=s,a=0===i?0:s===t?(r-n)/i%6:s===r?(n-t)/i+2:(t-r)/i+4,l=0===i?0:i/o;return a<0&&(a+=6),a*=60,l*=100,o*=100/255,{h:a,s:l,v:o}}(O(e))}function R(e){return u(e)?e:function(e){return m(g(e))}(O(e))}function D(e){return d(e)?e:w(O(e))}function M(e){let{r:t,g:r,b:s,a:i}=e;return i<1&&(t=Math.round(i*t+255*(1-i)),r=Math.round(i*r+255*(1-i)),s=Math.round(i*s+255*(1-i))),new n.Z({r:t,g:r,b:s})}function A(e,t){const{r:r,g:n,b:s}=t?.ignoreAlpha?e:M(e);return.2126*r+.7152*n+.0722*s}var x,P;function E(e,t=x.High){return A(e,{ignoreAlpha:!0})>t?new n.Z([0,0,0,e.a]):new n.Z([255,255,255,e.a])}function G(e,t){const r=R(e);r.l*=1-t;const n=O(r),s=e.clone();return s.setColor(n),s.a=e.a,s}function S(e,t){const r=e.clone();return r.a*=t,r}function T(e,t){const r=C(e);r.s*=t;const n=O(r),s=e.clone();return s.setColor(n),s.a=e.a,s}function j(e){return n.Z.toUnitRGBA(e)}function Z(e,t){return e===t||null!=e&&e.equals(t)}function W(e,t){return e===t||null!=e&&null!=t&&(0,a.e)(e,t)}function L(e){return(0,l.al)(e[0],e[1],e[2],e.length>3?e[3]:1)}function F(e){return e[0]??=0,e[1]??=0,e[2]??=0,e}function U(e){return e.length=4,F(e),e[3]??=1,(0,o.uZ)(e[3],0,1),e}function z(e,t){const r=n.Z.toUnitRGBA(e);return r[3]*=t,r}function k(e,t,r={}){if(0===e.length||t<=0)return[];if(1===(e=e.map((e=>"string"==typeof e?new n.Z(e):e))).length||1===t){const r=[],n=e[0];for(let e=0;e<t;e++)r.push(n.clone());return r}if(r.shuffle&&(e=(0,s.TV)((0,i.d9)(e),r.seed)),e.length>=t){const r=[],n=(e.length-1)/(t-1);for(let s=0;s<t;s++){const t=Math.round(s*n);r.push(e[t].clone())}return r}return function(e,t,r={}){const n=[],i=e.length-1,o=Math.ceil((t-e.length)/i);e:for(let s=0;s<i;s++){const i=e[s],a=e[s+1];for(let s=1;s<=o;s++){const l=s/(o+1);if(n.push(I(i,a,l,r)),n.length+e.length===t)break e}}return[...e.map((e=>e.clone())),...(0,s.TV)(n,r.seed??1)]}(e,t,r)}(P=x||(x={}))[P.Low=160]="Low",P[P.High=225]="High";const H=(e,t)=>{const r=Math.floor(10*t())-5;return Math.min(255,Math.max(0,e+r))};function I(e,t,r,i={}){const o=e.r,a=e.g,l=e.b,c=t.r,h=t.g,u=t.b,d=Math.round(o+(c-o)*r),p=Math.round(a+(h-a)*r),f=Math.round(l+(u-l)*r);if(!i.offset)return new n.Z([d,p,f]);const _=(0,s.FS)(i.seed);return new n.Z([H(d,_),H(p,_),H(f,_)])}},83695:function(e,t,r){function n(){return[1,0,0,1,0,0]}function s(e){return[e[0],e[1],e[2],e[3],e[4],e[5]]}r.d(t,{Ue:function(){return n},Wd:function(){return i},d9:function(){return s}});const i=[1,0,0,1,0,0];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:i,clone:s,create:n,fromValues:function(e,t,r,n,s,i){return[e,t,r,n,s,i]}},Symbol.toStringTag,{value:"Module"}))},50639:function(e,t,r){r.d(t,{Iu:function(){return c},Jp:function(){return o},U1:function(){return a},U_:function(){return i},Us:function(){return h},bA:function(){return l},vc:function(){return d},xJ:function(){return u},yR:function(){return s}});var n=r(66130);function s(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function i(e,t){const r=t[0],n=t[1],s=t[2],i=t[3],o=t[4],a=t[5];let l=r*i-n*s;return l?(l=1/l,e[0]=i*l,e[1]=-n*l,e[2]=-s*l,e[3]=r*l,e[4]=(s*a-i*o)*l,e[5]=(n*o-r*a)*l,e):null}function o(e,t,r){const n=t[0],s=t[1],i=t[2],o=t[3],a=t[4],l=t[5],c=r[0],h=r[1],u=r[2],d=r[3],p=r[4],f=r[5];return e[0]=n*c+i*h,e[1]=s*c+o*h,e[2]=n*u+i*d,e[3]=s*u+o*d,e[4]=n*p+i*f+a,e[5]=s*p+o*f+l,e}function a(e,t,r){const n=t[0],s=t[1],i=t[2],o=t[3],a=t[4],l=t[5],c=Math.sin(r),h=Math.cos(r);return e[0]=n*h+i*c,e[1]=s*h+o*c,e[2]=n*-c+i*h,e[3]=s*-c+o*h,e[4]=a,e[5]=l,e}function l(e,t,r){const n=t[0],s=t[1],i=t[2],o=t[3],a=t[4],l=t[5],c=r[0],h=r[1];return e[0]=n*c,e[1]=s*c,e[2]=i*h,e[3]=o*h,e[4]=a,e[5]=l,e}function c(e,t,r){const n=t[0],s=t[1],i=t[2],o=t[3],a=t[4],l=t[5],c=r[0],h=r[1];return e[0]=n,e[1]=s,e[2]=i,e[3]=o,e[4]=n*c+i*h+a,e[5]=s*c+o*h+l,e}function h(e,t){const r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e[4]=0,e[5]=0,e}function u(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function d(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e}function p(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e}const f=o,_=p;Object.freeze(Object.defineProperty({__proto__:null,add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},determinant:function(e){return e[0]*e[3]-e[1]*e[2]},equals:function(e,t){const r=e[0],s=e[1],i=e[2],o=e[3],a=e[4],l=e[5],c=t[0],h=t[1],u=t[2],d=t[3],p=t[4],f=t[5],_=(0,n.bn)();return Math.abs(r-c)<=_*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(s-h)<=_*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(i-u)<=_*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-d)<=_*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-p)<=_*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(l-f)<=_*Math.max(1,Math.abs(l),Math.abs(f))},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},frob:function(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+1)},fromRotation:h,fromScaling:u,fromTranslation:d,identity:s,invert:i,mul:f,multiply:o,multiplyScalar:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e},multiplyScalarAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e},rotate:a,scale:l,set:function(e,t,r,n,s,i,o){return e[0]=t,e[1]=r,e[2]=n,e[3]=s,e[4]=i,e[5]=o,e},str:function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},sub:_,subtract:p,translate:c},Symbol.toStringTag,{value:"Module"}))},85881:function(e,t,r){r.d(t,{F$:function(){return o},G7:function(){return c},HG:function(){return d},Mm:function(){return u},Qi:function(){return p},YL:function(){return s},YN:function(){return h},du:function(){return i},kk:function(){return a}});var n=r(59384);function s(e){return 32+e.length}const i=16;function o(e){if(!e)return 0;let t=u;for(const r in e)e.hasOwnProperty(r)&&(t+=l(e[r],!1));return t}function a(e){if(!e)return 0;if("number"==typeof e[0])return c(e);if(Array.isArray(e))return function(e){const t=e.length;if(0===t||"number"==typeof e[0])return h(e,8);let r=d;for(let n=0;n<t;n++)r+=l(e[n]);return r}(e);let t=u;for(const r in e)e.hasOwnProperty(r)&&(t+=l(e[r]));return t}function l(e,t=!0){switch(typeof e){case"object":return t?a(e):u;case"string":return s(e);case"number":return i;case"boolean":return 4;default:return 8}}function c(...e){return e.reduce(((e,t)=>e+(t?(0,n.fU)(t)?t.byteLength+p:Array.isArray(t)?h(t,i):0:0)),0)}function h(e,t){return d+e.length*t}const u=32,d=16,p=145},66040:function(e,t,r){r.d(t,{d:function(){return i}});var n=r(99574),s=r(38766);function i(e,t,r){const i=Array.isArray(e),h=i?e.length/t:e.byteLength/(4*t),u=i?e:new Uint32Array(e,0,h*t),d=r?.minReduction??0,p=r?.originalIndices||null,f=p?p.length:0,_=r?.componentOffsets||null;let g=0;if(_)for(let e=0;e<_.length-1;e++){const t=_[e+1]-_[e];t>g&&(g=t)}else g=h;const y=Math.floor(1.1*g)+1;(null==c||c.length<2*y)&&(c=new Uint32Array((0,n.Sf)(2*y)));for(let e=0;e<2*y;e++)c[e]=0;let m=0;const b=!!_&&!!p,w=b?f:h;let v=(0,s.$z)(h);const O=new Uint32Array(f),C=1.96;let R=0!==d?Math.ceil(4*C*C/(d*d)*d*(1-d)):w,D=1,M=_?_[1]:w;for(let e=0;e<w;e++){if(e===R){const t=1-m/e;if(t+C*Math.sqrt(t*(1-t)/e)<d)return null;R*=2}if(e===M){for(let e=0;e<2*y;e++)c[e]=0;if(p)for(let e=_[D-1];e<_[D];e++)O[e]=v[p[e]];M=_[++D]}const r=b?p[e]:e,n=r*t,s=l(u,n,t);let i=s%y,a=m;for(;0!==c[2*i+1];){if(c[2*i]===s){const e=c[2*i+1]-1;if(o(u,n,e*t,t)){a=v[e];break}}i++,i>=y&&(i-=y)}a===m&&(c[2*i]=s,c[2*i+1]=r+1,m++),v[r]=a}if(0!==d&&1-m/h<d)return null;if(b){for(let e=_[D-1];e<O.length;e++)O[e]=v[p[e]];v=(0,s.UB)(O)}const A=i?new Array(m):new Uint32Array(m*t);m=0;for(let e=0;e<w;e++)v[e]===m&&(a(u,(b?p[e]:e)*t,A,m*t,t),m++);if(p&&!b){const e=new Uint32Array(f);for(let t=0;t<e.length;t++)e[t]=v[p[t]];v=(0,s.UB)(e)}return{buffer:Array.isArray(A)?A:A.buffer,indices:v,uniqueCount:m}}function o(e,t,r,n){for(let s=0;s<n;s++)if(e[t+s]!==e[r+s])return!1;return!0}function a(e,t,r,n,s){for(let i=0;i<s;i++)r[n+i]=e[t+i]}function l(e,t,r){let n=0;for(let s=0;s<r;s++)n=e[t+s]+n|0,n=n+(n<<11)+(n>>>2)|0;return n>>>0}let c=null},18344:function(e,t,r){r.d(t,{i:function(){return l}});var n=r(99574),s=r(26636),i=r(24910),o=r(93070),a=r(77773);function l(e,t,r){const l=function(e,t,r,n){const o=(e=>!Array.isArray(e[0]))(t)?(e,r)=>t[3*e+r]:(e,r)=>t[e][r],l=n?(0,s.c9)(n)/(0,s._R)(n):1;return(0,a.zu)(e,((e,t)=>(0,i.i)(e,o(t,0)*l,o(t,1)*l,o(t,2))),r)}(c,e,t,r)?(0,a.st)(c):[0,0,1];return Math.abs(l[2])>Math.cos((0,n.Vl)(80))?o.R.Z:Math.abs(l[1])>Math.abs(l[0])?o.R.Y:o.R.X}const c=(0,a.Ue)()},53328:function(e,t,r){r.d(t,{Ni:function(){return p},ZI:function(){return n},bT:function(){return d}});var n,s,i=r(38874),o=r(93070),a=r(28931),l=r(60199),c=r(38766),h=r(18344),u=r(66040);function d(e){const t=p(e.rings,e.hasZ,n.CCW_IS_HOLE,e.spatialReference),r=new Array;let s=0,o=0;for(const e of t.polygons){const n=e.count,a=e.index,h=(0,l.Rq)(t.position,3*a,3*n),u=e.holeIndices.map((e=>e-a)),d=(0,c.UB)((0,i.e)(h,u,3));r.push({position:h,faces:d}),s+=h.length,o+=d.length}const a=function(e,t,r){if(1===e.length)return e[0];const n=(0,l.bg)(t),s=new Array(r);let i=0,o=0,a=0;for(const t of e){for(let e=0;e<t.position.length;e++)n[i++]=t.position[e];for(const e of t.faces)s[o++]=e+a;a=i/3}return{position:n,faces:(0,c.UB)(s)}}(r,s,o),h=Array.isArray(a.position)?(0,u.d)(a.position,3,{originalIndices:a.faces}):(0,u.d)(a.position.buffer,6,{originalIndices:a.faces});return a.position=(0,l.QZ)(new Float64Array(h.buffer)),a.faces=h.indices,a}function p(e,t,r,s){const i=e.length,o=new Array(i),a=new Array(i),c=new Array(i);let h=0;for(let t=0;t<i;++t)h+=e[t].length;let u=0,d=0,p=0;const g=(0,l.bg)(3*h);let y=0;for(let l=i-1;l>=0;l--){const h=e[l],m=r===n.CCW_IS_HOLE&&_(h,t,s);if(m&&1!==i)o[u++]=h;else{let e=h.length;for(let t=0;t<u;++t)e+=o[t].length;const r={index:y,pathLengths:new Array(u+1),count:e,holeIndices:new Array(u)};r.pathLengths[0]=h.length,h.length>0&&(c[p++]={index:y,count:h.length}),y=m?f(h,h.length-1,-1,g,y,h.length,t):f(h,0,1,g,y,h.length,t);for(let e=0;e<u;++e){const n=o[e];r.holeIndices[e]=y,r.pathLengths[e+1]=n.length,n.length>0&&(c[p++]={index:y,count:n.length}),y=f(n,0,1,g,y,n.length,t)}u=0,r.count>0&&(a[d++]=r)}}for(let e=0;e<u;++e){const r=o[e];r.length>0&&(c[p++]={index:y,count:r.length}),y=f(r,0,1,g,y,r.length,t)}return a.length=d,c.length=p,{position:g,polygons:a,outlines:c}}function f(e,t,r,n,s,i,o){s*=3;for(let a=0;a<i;++a){const i=e[t];n[s++]=i[0],n[s++]=i[1],n[s++]=o&&i[2]?i[2]:0,t+=r}return s/3}function _(e,t,r){if(!t)return!(0,a.bu)(e);const n=e.length-1;switch((0,h.i)(e,n,r)){case o.R.X:return!(0,a.bu)(e,o.R.Y,o.R.Z);case o.R.Y:return!(0,a.bu)(e,o.R.X,o.R.Z);case o.R.Z:return!(0,a.bu)(e,o.R.X,o.R.Y)}}(s=n||(n={}))[s.NONE=0]="NONE",s[s.CCW_IS_HOLE=1]="CCW_IS_HOLE"},74774:function(e,t,r){r.d(t,{D:function(){return y},Ou:function(){return c},WG:function(){return g},kB:function(){return d},mW:function(){return u}});var n=r(46451),s=(r(61432),r(28947)),i=r(59384),o=r(45213),a=r(90756),l=r(60856);function c(e){return"declaredClass"in e}function h(e){return"declaredClass"in e}function u(e,t){return e?"declaredClass"in e?e:new n.Z({layer:t,sourceLayer:t,visible:e.visible,symbol:(0,s.d9)(e.symbol),attributes:(0,s.d9)(e.attributes),geometry:d(e.geometry)}):null}function d(e){return null==e?null:c(e)?e:(0,a.im)(function(e){const{wkid:t,wkt:r,wkt2:n,latestWkid:s}=e.spatialReference,i={wkid:t,wkt:r,wkt2:n,latestWkid:s};switch(e.type){case"point":{const{x:t,y:r,z:n,m:s}=e;return{x:t,y:r,z:n,m:s,spatialReference:i}}case"polygon":{const{rings:t,hasZ:r,hasM:n}=e;return{rings:p(t),hasZ:r,hasM:n,spatialReference:i}}case"polyline":{const{paths:t,hasZ:r,hasM:n}=e;return{paths:p(t),hasZ:r,hasM:n,spatialReference:i}}case"extent":{const{xmin:t,xmax:r,ymin:n,ymax:s,zmin:o,zmax:a,mmin:l,mmax:c,hasZ:h,hasM:u}=e;return{xmin:t,xmax:r,ymin:n,ymax:s,zmin:o,zmax:a,mmin:l,mmax:c,hasZ:h,hasM:u,spatialReference:i}}case"multipoint":{const{points:t,hasZ:r,hasM:n}=e;return{points:_(t)?f(t):t,hasZ:r,hasM:n,spatialReference:i}}default:return}}(e))}function p(e){return function(e){for(const t of e)if(0!==t.length)return _(t);return!1}(e)?e.map((e=>f(e))):e}function f(e){return e.map((e=>Array.from(e)))}function _(e){return e.length>0&&((0,i.xZ)(e[0])||(0,i.fS)(e[0]))}function g(e,t){if(!e)return null;let r;if(h(e)){if(null==t)return e.clone();if(h(t))return t.copy(e)}return null!=t?(r=t,r.x=e.x,r.y=e.y,r.spatialReference=e.spatialReference,e.hasZ?(r.z=e.z,r.hasZ=e.hasZ):(r.z=void 0,r.hasZ=!1),e.hasM?(r.m=e.m,r.hasM=!0):(r.m=void 0,r.hasM=!1)):(r=(0,l.T)(e.x,e.y,e.z,e.spatialReference),e.hasM&&(r.m=e.m,r.hasM=!0)),r}function y(e){const{wkid:t,wkt:r,wkt2:n,latestWkid:s}=e,i={wkid:t,wkt:r,wkt2:n,latestWkid:s};return o.Z.fromJSON(i)}},42930:function(e,t,r){r.d(t,{Z:function(){return D}});var n=r(73440),s=r(53147),i=r(70880),o=r(92643),a=r(17155),l=(r(61432),r(96711),r(83850),r(48023)),c=r(38078),h=r(19596),u=r(85590);const d=.3;function p(e,t){t&&Object.assign(e,t)}class f{constructor(e){this.height=90,this.coneHeight=40,this.coneWidth=23,this.width=3,this.renderOccluded=h.yD.Opaque,this.color=e.accent}}class _{constructor({colors:e,...t}){this.size=11,this.outlineSize=1,this.collisionPadding=9,this.color=e.accent,this.outlineColor=e.outline,this.renderOccluded=h.yD.Opaque,this.hoverOutlineColor=e.selectedOutline,p(this,t)}applyColor(e){this._apply(this.color,e)}applyOutline(e){this._apply(this.outlineColor,e)}applyHoverOutline(e){this._apply(this.hoverOutlineColor,e)}_apply(e,t){t.setParameters({color:(0,o.O)(e),renderOccluded:this.renderOccluded})}}class g{constructor({colors:e,...t}){this.size=40,this.height=.2,this.offset=.25,this.collisionPadding=2,this.renderOccluded=h.yD.Transparent,this.minSquaredEdgeLength=900,this.color=(0,o.G)(e.accent,.5),this.hoverColor=e.accent,p(this,t)}applyColor(e){this._apply(this.color,e)}applyHover(e){this._apply(this.hoverColor,e)}_apply(e,t){t.setParameters({color:(0,o.O)(e),renderOccluded:this.renderOccluded})}}class y{constructor(e){this.vertex=new _({colors:e,color:e.accent,outlineColor:e.outline}),this.edge=new _({colors:e,color:(0,o.vG)((0,o.G)(e.accent,2/3),.5),outlineColor:(0,o.G)(e.outline,.5),size:8,collisionPadding:8}),this.selected=new _({colors:e,color:e.selected,outlineColor:e.outline}),this.edgeOffset=new g({colors:e})}}class m{constructor({colors:e,...t}){this.width=1.5,this.stipplePattern=(0,u.z5)(3.3),this.falloff=0,this.innerWidth=1.5,this.renderOccluded=h.yD.OccludeAndTransparent,this.color=e.selected,this.stippleOffColor=e.outline,this.innerColor=e.selected,p(this,t)}apply(e){e.color=(0,o.O)(this.color),e.width=this.width,e.stipplePattern=this.stipplePattern,e.stippleOffColor=(0,o.O)(this.stippleOffColor),e.falloff=this.falloff,e.innerWidth=this.innerWidth,e.innerColor=(0,o.O)(this.innerColor),e.renderOccluded=this.renderOccluded}}class b{constructor({colors:e,...t}){this.size=4,this.outlineSize=1,this.shape="square",this.color=e.selected,this.outlineColor=e.outline,p(this,t)}apply(e){e.color=(0,o.O)(this.color),e.size=this.size,e.outlineSize=this.outlineSize,e.outlineColor=(0,o.O)(this.outlineColor),e.primitive=this.shape}}class w{constructor({colors:e,...t}){this.innerWidth=1,this.glowWidth=8,this.glowFalloff=8,this.globalAlpha=d,this.globalAlphaContrastBoost=1.5,this.radius=3,this.innerColor=e.selected,this.glowColor=e.accent,this.heightFillColor=e.accent,p(this,t)}apply(e,t=1){const r={glowColor:s.Z.toUnitRGB(this.glowColor),glowFalloff:this.glowFalloff,glowWidth:this.glowWidth,innerColor:s.Z.toUnitRGB(this.innerColor),innerWidth:this.innerWidth,globalAlpha:this.globalAlpha*t*this.glowColor.a,globalAlphaContrastBoost:this.globalAlphaContrastBoost,intersectsLineRadius:this.radius};"style"in e?e.style=r:e.laserlineStyle=r}}class v{constructor(e){this.outline=new m({colors:e,color:e.stippleOff,renderOccluded:h.yD.OccludeAndTransparentStencil,stippleOffColor:e.stippleOn,innerWidth:0}),this.staged=new m({colors:e,color:e.stippleOn,renderOccluded:h.yD.OccludeAndTransparentStencil,innerColor:e.stagedSolid,stippleOffColor:e.stippleOff}),this.shadowStyle=new w({colors:e,globalAlpha:d,glowColor:e.accent,glowFalloff:8,glowWidth:8,innerColor:e.selected,innerWidth:1})}}class O{constructor(e){this.outline=new b({colors:e,color:e.selected,outlineColor:e.outline,outlineSize:1,shape:"circle",size:4}),this.shadowStyle=new w({colors:e,globalAlpha:d,glowColor:e.accent,glowFalloff:1.5,glowWidth:6,innerColor:e.selected,innerWidth:1,radius:2})}}class C extends m{constructor({colors:e,...t}){super({colors:e}),this.extensionType=c.n.GROUND_RAY,p(this,t)}}class R{constructor(e){this.laserlineAlphaMultiplier=1.5,this.heightPlaneAngleCutoff=20,this.lineObjects=new v(e),this.pointObjects=new O(e),this.heightPlane=new w({colors:e,globalAlpha:d,glowColor:e.accent,glowFalloff:8,glowWidth:8,innerColor:e.selected,innerWidth:1}),this.heightBox=new w({colors:e,globalAlpha:d,glowColor:e.accent,glowFalloff:8,glowWidth:8,innerColor:e.selected,innerWidth:0,heightFillColor:e.accent}),this.zVerticalLine=new C({colors:e,color:(0,o.G)(e.accent,.5),falloff:2,innerColor:(0,o.G)(e.selected,0),renderOccluded:h.yD.OccludeAndTransparent,stipplePattern:null,width:5,extensionType:c.n.GROUND_RAY})}}let D=class extends i.Z{constructor(e){super(e)}get colors(){const e=this.getTheme().accentColor,t=e.a;return{accent:e,contrast:(0,o.mj)(e),selected:s.Z.fromArray([255,255,255,t]),selectedOutline:s.Z.fromArray([255,255,255,t]),staged:s.Z.fromArray([12,207,255,t]),stagedSolid:s.Z.fromArray([12,207,255,1]),outline:s.Z.fromArray([0,0,0,.5*t]),stippleOn:s.Z.fromArray([255,255,255,1]),stippleOff:s.Z.fromArray([0,0,0,.5])}}get visualElements(){return new R(this.colors)}get manipulators(){return new y(this.colors)}get zManipulator(){return new f(this.colors)}};(0,n._)([(0,a.Cb)()],D.prototype,"colors",null),(0,n._)([(0,a.Cb)()],D.prototype,"visualElements",null),(0,n._)([(0,a.Cb)()],D.prototype,"manipulators",null),(0,n._)([(0,a.Cb)()],D.prototype,"zManipulator",null),(0,n._)([(0,a.Cb)()],D.prototype,"getTheme",void 0),D=(0,n._)([(0,l.j)("esri.views.3d.interactive.editingTools.settings")],D)},34105:function(e,t,r){r.d(t,{i:function(){return m}});var n=r(73440),s=r(70880),i=r(15894),o=r(17155),a=(r(61432),r(96711),r(83850),r(48023)),l=r(94808),c=r(89341),h=r(94125);class u{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=l.eZ.Outline}destroy(){this._destroyResources()}get resources(){return this._resources?.external}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(e){this._renderGroup=e;const t=this._resources?.layerView;t&&(t.renderGroup=e)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}forEachMaterial(e){this._resources&&this._resourceFactory.forEachMaterial(this._resources.external,e)}_createOrDestroyResources(){this._attached?null==this._resources&&this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory.createResources(),t=new d({view:this._resourceFactory.view,renderGroup:this._renderGroup}),r=this._resourceFactory.view.basemapTerrain?.overlayManager;this._resources={layerView:t,external:e,geometriesAdded:!1},r&&(this._resources.drapeSourceRenderer=r.registerGeometryDrapeSource(t)),this._syncGeometriesToRenderer()}_destroyResources(){if(null==this._resources)return;this._ensureRenderGeometriesRemoved();const e=this._resourceFactory.view.basemapTerrain?.overlayManager;e&&e.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){null!=this._resources?.drapeSourceRenderer&&this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,c.T.UPDATE),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){null!=this._resources?.drapeSourceRenderer&&(this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,c.T.UPDATE),this._resources.geometriesAdded=!0))}}let d=class extends(i.Z.IdentifiableMixin(s.Z)){constructor(e){super(e),this.drapeSourceType=l.Lw.Features,this.updatePolicy=h.j.SYNC,this.renderGroup=l.eZ.Outline}};(0,n._)([(0,o.Cb)({constructOnly:!0})],d.prototype,"view",void 0),(0,n._)([(0,o.Cb)({readOnly:!0})],d.prototype,"drapeSourceType",void 0),(0,n._)([(0,o.Cb)()],d.prototype,"renderGroup",void 0),d=(0,n._)([(0,a.j)("esri.views.3d.interactive.visualElements.DrapedVisualElementResources")],d);var p=r(56960),f=r(90403),_=r(26475),g=r(65759);class y{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1}destroy(){this._destroyResources()}get object(){return null!=this._resources?this._resources.object:null}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncVisible())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){if(!this._resourceFactory.recreateGeometry)return void this.recreate();const e=this._resourceFactory.view.stage;if(null==this._resources||!e)return;const t=this._resources.object;t.removeAllGeometries(),this._resourceFactory.recreateGeometry(this._resources.external,t,this._resources.layer)}forEachMaterial(e){this._resources&&this._resourceFactory.forEachMaterial(this._resources.external,e)}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory,t=e.view,r=t.stage;if(!r)return;const n=new g.F(r,{pickable:!1,updatePolicy:h.j.SYNC}),s=new _.T({castShadow:!1}),i=e.createResources(s,n);n.add(s);const o=e.cameraChanged,a=o?(0,f.YP)((()=>t.state.camera),(e=>o(e)),f.nn):null;this._resources={layer:n,object:s,external:i,cameraHandle:a},this._syncVisible()}_destroyResources(){null!=this._resources&&(this._resources.layer.destroy(),this._resources.object.dispose(),this._resources.cameraHandle?.remove(),this._resourceFactory.destroyResources(this._resources.external),this._resources=null)}_syncVisible(){null!=this._resources&&(this._resources.object.visible=this._visible)}}class m extends p.l{constructor(e){super(e),this._isDraped=!1,this.object3dResources=new y(this.createObject3DResourceFactory(e.view)),this.drapedResources=new u(this.createDrapedResourceFactory(e.view)),this.isDraped=e.isDraped??!1}get isDraped(){return this._isDraped}set isDraped(e){e!==this._isDraped&&(this._isDraped=e,this.object3dResources.attached=this.attached&&!e,this.drapedResources.attached=this.attached&&e)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(e){this.drapedResources.renderGroup=e}createResources(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate(),this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy(),this.drapedResources.destroy(),super.destroy()}updateVisibility(e){this.object3dResources.visible=e,this.drapedResources.visible=e}forEachMaterial(e){this.object3dResources?.forEachMaterial(e),this.drapedResources?.forEachMaterial(e)}}},38078:function(e,t,r){r.d(t,{V:function(){return b},n:function(){return D}});r(61432);var n=r(24910),s=r(82846),i=r(73749),o=r(27583),a=r(41207),l=r(33869),c=r(88970),h=r(12659),u=r(34105),d=r(82845),p=r(61471),f=r(86026),_=r(19596),g=r(14357),y=r(52061),m=r(19843);class b extends u.i{constructor(e){super(e),this._ray=(0,h.Ue)(),this._isWorldDown=!1,this._start=(0,s.Ue)(),this._end=(0,s.al)(1,0,0),this._width=1,this._color=(0,o.al)(1,0,1,1),this._polygonOffset=!1,this._writeDepthEnabled=!0,this._innerWidth=0,this._innerColor=(0,o.al)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._stipplePreferContinuous=!0,this._falloff=0,this._extensionType=D.LINE,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=_.yD.OccludeAndTransparent,this._fadedExtensions=x,this._laserline=new d.W({view:this.view,isDecoration:e.isDecoration}),this.applyProperties(e)}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:w,recreateGeometry:(e,t)=>this._recreateObject3DGeometry(e,t),cameraChanged:()=>this._updateGeometry(),forEachMaterial:(e,t)=>t(e.material)}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:w,recreateGeometry:e=>this._recreateDrapedGeometry(e),forEachMaterial:(e,t)=>t(e.material)}}updateVisibility(e){super.updateVisibility(e),this._laserline.visible=e}onAttachedChange(){this._laserline.attached=this._laserlineAttached}setStartEndFromWorldDownAtLocation(e){this._isWorldDown=!0,(0,n.c)(this._start,e),this.view.renderCoordsHelper.worldUpAtPosition(e,this._end),(0,n.d)(this._end,e,this._end),(0,h.zk)(this._start,this._end,this._ray),this._updateGeometry()}get start(){return this._start}set start(e){this._isWorldDown=!1,(0,n.q)(this._start,e)||((0,n.c)(this._start,e),(0,h.zk)(this._start,this._end,this._ray),this._updateGeometry())}get end(){return this._end}set end(e){this._isWorldDown=!1,(0,n.q)(this._end,e)||((0,n.c)(this._end,e),(0,h.zk)(this._start,this._end,this._ray),this._updateGeometry())}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){(0,i.a)(e,this._color)||((0,i.c)(this._color,e),this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){(0,i.a)(e,this._innerColor)||((0,i.c)(this._innerColor,e),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const t=null!=e!=(null!=this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){null!=e&&null!=this._stippleOffColor&&(0,i.a)(e,this._stippleOffColor)||(this._stippleOffColor=null!=e?(0,o.d9)(e):null,this._updateMaterial())}get stipplePreferContinuous(){return this._stipplePreferContinuous}set stipplePreferContinuous(e){e!==this._stipplePreferContinuous&&(this._stipplePreferContinuous=e,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get extensionType(){return this._extensionType}set extensionType(e){e!==this._extensionType&&(this._extensionType=e,this.recreateGeometry())}get _laserlineAttached(){return this._laserlineEnabled&&null!=this._laserlineStyle&&this.attached&&!this.isDraped}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,null!=e&&(this._laserline.style=e)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===_.yD.OccludeAndTransparentStencil?_.yD.OccludeAndTransparent:this._renderOccluded}get fadedExtensions(){return this._fadedExtensions}set fadedExtensions(e){this._fadedExtensions=e??x,this.recreateGeometry()}_updateMaterial(){const{materialParameters:e}=this;this.object3dResources.resources?.material.setParameters(e),this.drapedResources.resources?.material.setParameters(e)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,innerWidth:this._innerWidth,innerColor:this._innerColor,falloff:this._falloff,hasPolygonOffset:this._polygonOffset,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration,writeDepth:this._writeDepthEnabled}}_createObject3DResources(e){const t=new m.U(this.materialParameters),r=new Array;return this._createObject3DGeometry(t,e,r),{material:t,geometries:r}}_recreateObject3DGeometry(e,t){e.geometries.length=0,this._createObject3DGeometry(e.material,t,e.geometries)}_createObject3DGeometry(e,t,r){const n=this._createGeometry(e);r.push(n),t.addGeometry(n),this._updateVerticesObject3D(t)}_createDrapedResources(){const e=new m.U(this.materialParameters);return{material:e,geometries:[this._createDrapedGeometry(e)]}}_recreateDrapedGeometry(e){e.geometries=[this._createDrapedGeometry(e.material)]}_createDrapedGeometry(e){const t=this._createGeometry(e);return this._updateVerticesDraped(t),new g.z(t)}_createGeometry(e){const t=this.extensionType===D.FADED,r=t?[(0,s.Ue)(),(0,s.Ue)(),(0,s.Ue)(),(0,s.Ue)()]:[(0,s.Ue)(),(0,s.Ue)()];return(0,f.rh)(e,r,null,t?[1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0]:null)}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const e=this.object3dResources.object;e&&this._updateVerticesObject3D(e)}}_updateVerticesObject3D(e){const t=this._lineSegment;this._updateVertexAttributesObject3D(e,t),this._laserline.intersectsLine=t}_updateVerticesDraped(e){this._updateVertexAttributesDraped(e,this._lineSegment)}get _lineSegment(){return this._extensionType===D.FADED?this._updateLineSegmentFinite(R):this._updateLineSegmentInfinite(this._extensionType,R)}_updateLineSegmentFinite(e){return(0,c.zk)(this._start,this._end,e)}_updateLineSegmentInfinite(e,t){const r=this.view.state.camera;switch((0,a.iL)(this._ray,v),e){case D.LINE:v.c0=-Number.MAX_VALUE;break;case D.RAY:case D.GROUND_RAY:{const e=this._ray.origin,t=this.view.elevationProvider.getElevation(e[0],e[1],e[2],this.view.renderCoordsHelper.spatialReference,"ground")??0,r=this.view.renderCoordsHelper.getAltitude(e);this._isWorldDown&&r<t&&(0,n.u)(v.ray.direction,v.ray.direction),this._extensionType===D.GROUND_RAY&&null!=t&&(v.c1=Math.abs(r-t));break}}if(!(0,l.zq)(r.frustum,v))return this._updateLineSegmentFinite(t);const s=(0,a.Ws)(v,O),i=(0,a.S$)(v,C);return(0,c.zk)(s,i,t)}_updateVertexAttributesObject3D(e,t){const r=e.geometries[0].getMutableAttribute(y.T.POSITION)?.data;if(!r)return;let n=0;for(const e of this._lineVertices(t))r[n++]=e[0],r[n++]=e[1],r[n++]=e[2];e.geometryVertexAttributeUpdated(e.geometries[0],y.T.POSITION)}_updateVertexAttributesDraped(e,t){const r=e.getMutableAttribute(y.T.POSITION)?.data;if(!r)return;let n=0;for(const e of this._lineVertices(t))r[n++]=e[0],r[n++]=e[1],r[n++]=p.gi;e.invalidateBoundingInfo()}*_lineVertices(e){this.extensionType===D.FADED?(yield(0,c.KU)(e,-this.fadedExtensions.start,O),yield(0,c.KU)(e,0,O),yield(0,c.KU)(e,1,O),yield(0,c.KU)(e,1+this.fadedExtensions.end,O)):(yield(0,c.KU)(e,0,O),yield(0,c.KU)(e,1,O))}}function w(e){e.geometries=[]}const v=(0,a.Ue)(),O=(0,s.Ue)(),C=(0,s.Ue)(),R=(0,c.Ue)();var D,M;(M=D||(D={}))[M.LINE=0]="LINE",M[M.RAY=1]="RAY",M[M.GROUND_RAY=2]="GROUND_RAY",M[M.FADED=3]="FADED";const A=1/3,x={start:A,end:A}},51619:function(e,t,r){r.d(t,{k:function(){return C}});var n=r(87833),s=r(24910),i=r(82846),o=r(73749),a=r(27583),l=r(30146),c=r(16447),h=r(60199),u=r(60856),d=r(51870),p=r(13689),f=r(34105),_=r(82845),g=r(94290),y=r(55277),m=r(61324),b=r(19596),w=r(14357),v=r(52061),O=r(19843);class C extends f.i{constructor(e){super(e),this._attachmentOrigin=(0,u.T)(0,0,0,null),this._attachmentOriginDirty=!0,this.events=new n.Z,this._geometry=null,this._width=1,this._color=(0,a.al)(1,0,1,1),this._innerWidth=0,this._innerColor=(0,a.al)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._falloff=0,this._elevationInfo=null,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=b.yD.OccludeAndTransparentStencil,this._attachmentOrigin.spatialReference=e.view.spatialReference,this._laserline=new _.W({view:e.view,isDecoration:e.isDecoration}),this.applyProperties(e),this.attached=e.attached??!0}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:R,recreateGeometry:(e,t)=>{e.geometries.length=0,this._recreateGeometry(t,e.material,e.geometries)},forEachMaterial:(e,t)=>t(e.material)}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:R,recreateGeometry:e=>{e.geometries=this._createRenderGeometriesDraped(e.material),this._attachmentOriginChanged()},forEachMaterial:(e,t)=>t(e.material)}}get _laserlineAttached(){return this.attached&&this.visible&&null!=this._laserlineStyle&&!this.isDraped&&this.laserlineEnabled}onAttachedChange(e){this._laserline.attached=this._laserlineAttached,e&&this._attachmentOriginChanged()}get isDecoration(){return this._isDecoration}set isDecoration(e){this._isDecoration=e,this._updateMaterial()}get geometry(){return this._geometry}set geometry(e){const t=this._isClosed;this._geometry=e,this.recreateGeometry(),t!==this._isClosed&&this._updateMaterial()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){(0,o.a)(e,this._color)||((0,o.c)(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){(0,o.a)(e,this._innerColor)||((0,o.c)(this._innerColor,e),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const t=null!=e!=(null!=this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){e&&this._stippleOffColor&&(0,o.a)(e,this._stippleOffColor)||(this._stippleOffColor=e?(0,a.d9)(e):null,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.recreateGeometry()}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,null!=e&&(this._laserline.style=e)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get attachmentOrigin(){if(!this._attachmentOriginDirty)return this._attachmentOrigin;const e=this.object3dResources.resources?.geometries;if(!e||0===e.length)return null;(0,s.i)(M,0,0,0);let t=0;for(const r of e)r.computeAttachmentOrigin(D)&&((0,s.f)(M,M,D),t++);return 0===t?null:((0,s.g)(M,M,1/t),this.view.renderCoordsHelper.fromRenderCoords(M,this._attachmentOrigin),this._attachmentOriginDirty=!1,this._attachmentOrigin)}_updateMaterial(){this.object3dResources.resources?.material.setParameters(this._materialParameters),this.drapedResources.resources?.material.setParameters(this._materialParameters)}get _isClosed(){return null!=this.geometry&&"polygon"===this.geometry.type}get _materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:!1,isClosed:this._isClosed,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,join:"round",hasPolygonOffset:!0,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration}}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===b.yD.OccludeAndTransparentStencil?b.yD.OccludeAndTransparent:this._renderOccluded}_recreateGeometry(e,t,r){this._createRenderGeometries(t,r);for(const t of r)e.addGeometry(t);this._attachmentOriginChanged()}_attachmentOriginChanged(){this._attachmentOriginDirty=!0,this.events.emit("attachment-origin-changed")}_createObject3DResources(e){const t=new O.U(this._materialParameters),r=new Array;return this._recreateGeometry(e,t,r),{material:t,geometries:r}}_createDrapedResources(){const e=new O.U(this._materialParameters);return{material:e,geometries:this._createRenderGeometriesDraped(e)}}_createRenderGeometriesDraped(e){const{geometry:t,view:r}=this,n=r.basemapTerrain.spatialReference;return null==t||null==n?[]:(0,m.r)(t,n).lines.map((({position:t})=>{const s={overlayInfo:{spatialReference:n,renderCoordsHelper:r.renderCoordsHelper},attributeData:{position:t},removeDuplicateStartEnd:this._isClosed};return new w.z((0,y.Y)(e,s))}))}calculateMapBounds(e){if(null==this.object3dResources.resources)return!1;const t=this.view.renderCoordsHelper;for(const r of this.object3dResources.resources.geometries){const n=r.attributes.get(v.T.POSITION),s=(0,h.bg)(n.data.length);(0,l.projectBuffer)(n.data,t.spatialReference,0,s,this.view.spatialReference,0),(0,c.G1)(e,s)}return!0}_createRenderGeometries(e,t){const r=this.geometry;if(null==r)return;const n=(0,m.V)(r,this.view.elevationProvider,this.view.renderCoordsHelper,g.o.fromElevationInfo(this.elevationInfo??new p.Z({mode:(0,d.VW)(r,null)}))),s=new Array;for(const{position:r,mapPositions:i}of n.lines){const n={mapPositions:i,attributeData:{position:r},removeDuplicateStartEnd:this._isClosed};t.push((0,y.Y)(e,n)),s.push(r)}this._laserline.pathVerticalPlane=s}}function R(e){e.geometries=[]}const D=(0,i.Ue)(),M=(0,i.Ue)()},69417:function(e,t,r){r.d(t,{F:function(){return a}});var n=r(73440),s=r(87833),i=r(17155),o=(r(61432),r(96711),r(83850),r(48023));let a=class extends s.Z.EventedAccessor{constructor(e){super(e),this.tracking=!1,this.displaying=!1,this.error=null,this.isDraped=!1}};(0,n._)([(0,i.Cb)({constructOnly:!0})],a.prototype,"graphic",void 0),(0,n._)([(0,i.Cb)()],a.prototype,"tracking",void 0),(0,n._)([(0,i.Cb)()],a.prototype,"displaying",void 0),(0,n._)([(0,i.Cb)()],a.prototype,"error",void 0),(0,n._)([(0,i.Cb)()],a.prototype,"isDraped",void 0),a=(0,n._)([(0,o.j)("esri.views.3d.layers.graphics.GraphicState")],a)},61324:function(e,t,r){r.d(t,{V:function(){return l},r:function(){return c}});var n=r(30146),s=r(60199),i=r(53328),o=r(90210),a=r(61471);function l(e,t,r,n){const a="polygon"===e.type?i.ZI.CCW_IS_HOLE:i.ZI.NONE,l="polygon"===e.type?e.rings:e.paths,{position:c,outlines:u}=(0,i.Ni)(l,!!e.hasZ,a,e.spatialReference),d=(0,s.bg)(c.length),p=(0,o.rR)(c,e.spatialReference,0,d,0,c,0,c.length/3,t,r,n),f=null!=p;return{lines:f?h(u,c,d):[],projectionSuccess:f,sampledElevation:p}}function c(e,t){const r="polygon"===e.type?i.ZI.CCW_IS_HOLE:i.ZI.NONE,s="polygon"===e.type?e.rings:e.paths,{position:o,outlines:l}=(0,i.Ni)(s,!1,r),c=(0,n.projectBuffer)(o,e.spatialReference,0,o,t,0);for(let e=2;e<o.length;e+=3)o[e]=a.gi;return{lines:c?h(l,o):[],projectionSuccess:c}}function h(e,t,r=null){const n=new Array;for(const{index:i,count:o}of e){if(o<=1)continue;const e=3*i,a=3*o;n.push({position:(0,s.Rq)(t,3*i,3*o),mapPositions:null!=r?(0,s.Rq)(r,e,a):void 0})}return n}},34630:function(e,t,r){function n(e){e.code.add("\n  vec4 blendColorsPremultiplied(vec4 source, vec4 dest) {\n    float oneMinusSourceAlpha = 1.0 - source.a;\n    return source + dest * oneMinusSourceAlpha;\n  }\n  ")}function s(e,t){return e[0]=t[0]*t[3],e[1]=t[1]*t[3],e[2]=t[2]*t[3],e[3]=t[3],e}r.d(t,{m:function(){return n},p:function(){return s}})},25631:function(e,t,r){r.d(t,{N:function(){return a}});var n=r(65562),s=r(25906),i=r(38419),o=r(65650);class a{constructor(e,t=i.J.None){this._techniques=e,this._parameters=new n.C,this._configuration=new i.Z,this._configuration.blitMode=t,e.precompile(s.l,this._configuration)}blit(e,t,r,n){e.bindFramebuffer(r.fbo),e.setClearColor(0,0,0,1),e.clear(o.Hf.COLOR),this._parameters.texture=t.getTexture();const i=this._techniques.get(s.l,this._configuration);e.bindTechnique(i,n,this._parameters),e.screen.draw()}blend(e,t,r,n,i=1){this._configuration.hasOpacityFactor=i<1;const o=this._techniques.get(s.l,this._configuration);return!!o.compiled&&(e.bindFramebuffer(r.fbo),this._parameters.texture=t.getTexture(),this._parameters.opacity=i,e.bindTechnique(o,n,this._parameters),e.screen.draw(),!0)}}},85590:function(e,t,r){r.d(t,{Dp:function(){return o},z5:function(){return i}});const n={dash:[4,3],dot:[1,3],"long-dash":[8,3],"short-dash":[4,1],"short-dot":[1,1]},s={dash:n.dash,"dash-dot":[...n.dash,...n.dot],dot:n.dot,"long-dash":n["long-dash"],"long-dash-dot":[...n["long-dash"],...n.dot],"long-dash-dot-dot":[...n["long-dash"],...n.dot,...n.dot],none:null,"short-dash":n["short-dash"],"short-dash-dot":[...n["short-dash"],...n["short-dot"]],"short-dash-dot-dot":[...n["short-dash"],...n["short-dot"],...n["short-dot"]],"short-dot":n["short-dot"],solid:null};function i(e){return{pattern:[e,e],pixelRatio:2}}function o(e){return"style"===e?.type?function(e){return null!=e?function(e,t){return null==e?e:{pattern:e.slice(),pixelRatio:t}}(s[e],8):null}(e.style):null}},25906:function(e,t,r){r.d(t,{l:function(){return c}});var n=r(79487),s=r(58257),i=r(29107),o=r(65562),a=r(38419),l=r(51135);class c extends i.A{constructor(e,t){super(e,t,new s.J(o.a,(()=>r.e(39568).then(r.bind(r,39568)))))}initializePipeline(e){switch(e.blitMode){case a.J.None:case a.J.Depth:return(0,l.sm)({colorWrite:l.gf});case a.J.Alpha:return(0,l.sm)({blending:l.vf,colorWrite:l.gf});default:(0,n.Bg)(e.blitMode);case a.J.PremultipliedAlpha:case a.J.COUNT:return(0,l.sm)({blending:l.Zo,colorWrite:l.gf})}}}},38419:function(e,t,r){r.d(t,{J:function(){return n},Z:function(){return a}});var n,s,i=r(73440),o=r(83046);(s=n||(n={}))[s.None=0]="None",s[s.Alpha=1]="Alpha",s[s.PremultipliedAlpha=2]="PremultipliedAlpha",s[s.Depth=3]="Depth",s[s.COUNT=4]="COUNT";class a extends o.m{constructor(){super(...arguments),this.blitMode=n.None,this.hasOpacityFactor=!1}}(0,i._)([(0,o.o)({count:n.COUNT})],a.prototype,"blitMode",void 0),(0,i._)([(0,o.o)()],a.prototype,"hasOpacityFactor",void 0)},2453:function(e,t,r){r.r(t),r.d(t,{ElevationProfileView3D:function(){return x}});var n=r(12818),s=r(61100),i=r(90403),o=r(63216),a=r(74011),l=r(29292),c=r(50702),h=r(93568),u=r(51870),d=r(42930),p=r(51619),f=r(69417),_=r(19596),g=r(27546);class y{constructor(e){this._params=e,this._highlightTask=null,this._highlightHandle=null,this._visualElementHandle=null,this._settings=new d.Z({getTheme:()=>this._params.view.effectiveTheme})}destroy(){this.remove()}remove(){this._highlightTask=(0,s.IM)(this._highlightTask),this._highlightHandle=(0,s.hw)(this._highlightHandle),this._visualElementHandle=(0,s.hw)(this._visualElementHandle)}showHighlight(e){if(this.remove(),null==e||!m(e))return;const t=e.layer;this._highlightTask=(0,l.vr)((async r=>{const n=await this._params.view.whenLayerView(t);(0,h.k_)(r),(0,g.tl)(n)&&(this._highlightHandle=n.highlight(e))}))}showReshaping(e){if(this.remove(),null==e)return;const t=this._params.view,r=new p.k({view:t,geometry:m(e)?e.geometry:null,attached:!1,elevationInfo:(0,u.RL)(e),renderOccluded:_.yD.OccludeAndTransparentStencil,isDecoration:!0}),n=new f.F({graphic:e}),s=[(0,i.YP)((()=>n.isDraped),(e=>{r.isDraped=e})),n.on("changed",(()=>{r.geometry=m(e)?e.geometry:null})),t.trackGraphicState(n),t.maskOccludee(e),(0,c.ed)(r)];this._settings.visualElements.lineObjects.outline.apply(r),r.attached=!0,this._visualElementHandle=(0,c.AL)(s)}}function m(e){return null!=e.geometry&&"polyline"===e.geometry.type}var b=r(73440),w=r(53147),v=r(70880),O=r(12506),C=r(17155),R=(r(61432),r(96711),r(83850),r(48023)),D=r(27583),M=r(70388);let A=class extends v.Z{constructor(e){super(e),this._chartData=null,this._visualElements=[],this._update=e=>{const{chartData:t}=e;if(null==t)return this.remove();if(!t.refined)return;const r=this._visualElements,n=t.lines.filter((e=>e.viewVisualizationEnabled)),s=n.length;for(;r.length>s;)r.pop().destroy();const i=(0,o.iE)().profileLinesStyle3D;for(;r.length<s;){const e=new p.k({view:this.view,elevationInfo:{mode:"absolute-height",offset:0},innerWidth:i.innerWidth,innerColor:i.innerColor,width:i.width,falloff:i.falloff,renderOccluded:i.renderOccluded,isDecoration:!0});r.push(e)}const a=e.spatialReference;for(let e=0;e<s;++e){const t=r[e],i=n[s-1-e];t.geometry=(0,M.L)(i,a),t.color=(0,D.nI)(w.Z.toUnitRGBA(i.color))}}}initialize(){const e=(0,o.iE)().profileLinesUpdateThrottleMillis;let t=this._update;if(e>0){const r=(0,O.P)(this._update,e);this.addHandles(r),t=r}this.addHandles([(0,i.YP)((()=>({spatialReference:this.view.spatialReference,chartData:this._chartData})),t,i.tX)])}destroy(){this._destroyVisualElements()}remove(){this._destroyVisualElements()}update(e){this._chartData=e}_destroyVisualElements(){this._visualElements.forEach((e=>e.destroy())),this._visualElements.length=0}};(0,b._)([(0,C.Cb)()],A.prototype,"view",void 0),(0,b._)([(0,C.Cb)()],A.prototype,"_chartData",void 0),A=(0,b._)([(0,R.j)("esri.widgets.ElevationProfile.support.ProfileLines3D")],A);class x{constructor(e,t){this._handles=new n.Z,this._inputRepresentation=new y({view:e}),this._hoveredPoints=new a.l({view:e}),this._profileLines=new A({view:e}),this._handles.add([(0,i.YP)((()=>t.viewModel.hoveredPoints),(e=>this._hoveredPoints.update(e)),i.tX),(0,i.YP)((()=>{const{state:e,editable:r,highlightEnabled:n,viewModel:s}=t,i=s.input;return i&&(i.commitProperty("geometry"),i.commitProperty("layer")),{input:i,state:e,editable:r,highlightEnabled:n}}),(e=>this._updateInputRepresentation(e)),i.tX),(0,i.YP)((()=>t.viewModel.chartData),(e=>this._profileLines.update(e)),i.tX),(0,i.YP)((()=>t.viewModel.input?.geometry),(()=>{this._profileLines.remove()}),i.tX)])}destroy(){this._handles=(0,s.SC)(this._handles),this._inputRepresentation=(0,s.SC)(this._inputRepresentation),this._hoveredPoints=(0,s.SC)(this._hoveredPoints),this._profileLines=(0,s.SC)(this._profileLines)}_updateInputRepresentation({input:e,state:t,editable:r,highlightEnabled:n}){const s=this._inputRepresentation;if(!n)return s.remove();t===o.dd.Selected?s.showHighlight(e):t!==o.dd.Created||r?s.remove():s.showReshaping(e)}}},74011:function(e,t,r){r.d(t,{l:function(){return u}});var n=r(73440),s=r(70880),i=r(43254),o=r(90403),a=r(17155),l=(r(61432),r(96711),r(83850),r(48023)),c=r(63216),h=r(64397);let u=class extends s.Z{constructor(e){super(e),this._hoveredPoints=new i.Z}initialize(){this.addHandles((0,o.YP)((()=>this._hoveredPoints.toArray().map((({anchor:e,element:t})=>({screenLocation:e.screenLocation,element:t})))),(e=>{for(const{screenLocation:t,element:r}of e)t&&(r.style.transform=`translate(${t.x}px, ${t.y}px)`)}),o.tX))}destroy(){this._hoveredPoints.drain((e=>this._destroyHoveredPoint(e)))}update(e){const t=this.view,r=this._hoveredPoints,n=e.length;for(;this._hoveredPoints.length>n;)this._destroyHoveredPoint(this._hoveredPoints.pop());for(;this._hoveredPoints.length<n;){const e=this._makeHoveredPoint();r.push(e),t.surface?.appendChild(e.element)}for(let t=0;t<n;++t){const s=r.at(n-1-t),i=e[t];this._updateHoveredPoint(s,i)}}_makeHoveredPoint(){const{size:e,borderStyle:t,borderColor:r,borderWidth:n,boxShadow:s}=(0,c.iE)().hoveredPointsStyle,i=this.view,o=new h.Z({view:i,screenLocationEnabled:!0}),a=document.createElement("div"),l=a.style;return l.position="absolute",l.top="0",l.left="0",l.contain="strict",l.boxSizing="border-box",l.width=`${e}px`,l.height=`${e}px`,l.marginTop=`-${e/2}px`,l.marginLeft=`-${e/2}px`,l.border=`${t} ${n}px ${r}`,l.borderRadius=`${e}px`,l.boxShadow=s,{anchor:o,element:a}}_updateHoveredPoint({anchor:e,element:t},r){e.screenLocationEnabled=!0,e.location=r.hoveredPoint;const n=t.style;n.display="block",n.background=r.color.toCss()}_destroyHoveredPoint({anchor:e,element:t}){e.destroy(),this.view.surface?.removeChild(t)}};(0,n._)([(0,a.Cb)()],u.prototype,"view",void 0),(0,n._)([(0,a.Cb)()],u.prototype,"_hoveredPoints",void 0),u=(0,n._)([(0,l.j)("esri.widgets.ElevationProfile.support.HoveredPoints")],u)},70388:function(e,t,r){r.d(t,{L:function(){return s}});var n=r(1663);function s(e,t){const r=e.samples??[],s=r.length-1,i=[];let o=[];for(let e=0;e<=s;e++){const{x:t,y:n,z:a}=r[e];null!=a&&o.push([t,n,a]),e!==s&&null!=a||!o.length||(i.push(o),o=[])}return(0,n.DF)(i,t,!0)}},64397:function(e,t,r){r.d(t,{Z:function(){return c}});var n=r(73440),s=r(87833),i=r(90403),o=r(17155),a=(r(61432),r(96711),r(83850),r(48023)),l=r(13132);let c=class extends s.Z.EventedAccessor{constructor(e){super(e),this.location=null,this.screenLocationEnabled=!1,this.view=null,this.addHandles([(0,i.gx)((()=>{const e=this.screenLocationEnabled?this.view:null;return e?[e.size,"3d"===e.type?e.camera:e.viewpoint]:null}),(()=>this.notifyChange("screenLocation"))),(0,i.YP)((()=>this.screenLocation),((e,t)=>{null!=e&&null!=t&&this.emit("view-change")}))])}destroy(){this.view=null}get screenLocation(){const{location:e,view:t,screenLocationEnabled:r}=this,n=t?.spatialReference,s=n?(0,l.projectOrLoad)(e,n).geometry:null;return r&&s&&t?.ready?t.toScreen(s):null}};(0,n._)([(0,o.Cb)()],c.prototype,"location",void 0),(0,n._)([(0,o.Cb)()],c.prototype,"screenLocation",null),(0,n._)([(0,o.Cb)()],c.prototype,"screenLocationEnabled",void 0),(0,n._)([(0,o.Cb)()],c.prototype,"view",void 0),c=(0,n._)([(0,a.j)("esri.widgets.support.AnchorElementViewModel")],c)}}]);