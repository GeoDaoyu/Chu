"use strict";(self.webpackChunkscene_pro=self.webpackChunkscene_pro||[]).push([[64815],{58426:function(e,t,i){i.d(t,{$c:function(){return d},Hg:function(){return y},jW:function(){return h},xb:function(){return f}});var r=i(70880),n=i(43254),s=i(22018);const o=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function l(e){return e instanceof r.Z}function a(e){return e instanceof n.Z?Object.keys(e.items):l(e)?(0,s.vw)(e).keys():e?Object.keys(e):[]}function c(e,t){return e instanceof n.Z?e.items[t]:e[t]}function u(e){return e?e.declaredClass:null}function p(e,t){const i=e.diff;if(i&&"function"==typeof i)return i(e,t);const r=a(e),n=a(t);if(0===r.length&&0===n.length)return;if(!r.length||!n.length||function(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}(e,t))return{type:"complete",oldValue:e,newValue:t};const s=n.filter((e=>!r.includes(e))),h=r.filter((e=>!n.includes(e))),d=r.filter((i=>n.includes(i)&&c(e,i)!==c(t,i))).concat(s,h).sort(),y=u(e);if(y&&o.has(y)&&d.length)return{type:"complete",oldValue:e,newValue:t};let f;const g=l(e)&&l(t);for(const r of d){const n=c(e,r),s=c(t,r);let o;if((g||"function"!=typeof n&&"function"!=typeof s)&&n!==s&&(null!=n||null!=s)){if(i&&i[r]&&"function"==typeof i[r])o=i[r]?.(n,s);else if(n instanceof Date&&s instanceof Date){if(n.getTime()===s.getTime())continue;o={type:"complete",oldValue:n,newValue:s}}else o="object"==typeof n&&"object"==typeof s&&u(n)===u(s)?p(n,s):{type:"complete",oldValue:n,newValue:s};null!=o&&(null!=f?f.diff[r]=o:f={type:"partial",diff:{[r]:o}})}}return f}function h(e,t){return function(e,t){if(null==e)return!1;const i=t.split(".");let r=e;for(const e of i){if("complete"===r.type)return!0;if("partial"!==r.type)return!1;{const t=r.diff[e];if(!t)return!1;r=t}}return!0}(e,t)}function d(e,t){if(!e)return!1;if("partial"===e.type){const i=Object.keys(e.diff);return 1===i.length&&i[0]===t}return!1}function y(e,t){if("function"!=typeof e&&"function"!=typeof t&&(null!=e||null!=t))return null==e||null==t||"object"==typeof e&&"object"==typeof t&&u(e)!==u(t)?{type:"complete",oldValue:e,newValue:t}:p(e,t)}function f(e){if(null==e)return!0;switch(e.type){case"complete":return!1;case"collection":{const t=e;for(const e of t.added)if(!f(e))return!1;for(const e of t.removed)if(!f(e))return!1;for(const e of t.changed)if(!f(e))return!1;return!0}case"partial":for(const t in e.diff)if(!f(e.diff[t]))return!1;return!0}}},9350:function(e,t,i){i.d(t,{CJ:function(){return c},Rz:function(){return p},js:function(){return h},xA:function(){return a},z3:function(){return u}});i(61432);var r=i(89636),n=i(38096),s=i(19886),o=i(45433),l=i(54914);const a=s.Z.fromJSON(l.I4),c=n.Z.fromJSON(l.ET),u=r.Z.fromJSON(l.lF),p=o.Z.fromJSON(l.qP);function h(e){if(null==e)return null;switch(e.type){case"mesh":return null;case"point":case"multipoint":return a;case"polyline":return c;case"polygon":case"extent":return u}return null}s.Z.fromJSON(l.eG),n.Z.fromJSON(l.wW),r.Z.fromJSON(l.lj)},54914:function(e,t,i){i.d(t,{ET:function(){return o},I4:function(){return s},SQ:function(){return r},X1:function(){return n},eG:function(){return c},lF:function(){return l},lj:function(){return p},qP:function(){return a},wW:function(){return u}});const r=[252,146,31,255],n=[153,153,153,255],s={type:"esriSMS",style:"esriSMSCircle",size:6,color:r,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},o={type:"esriSLS",style:"esriSLSSolid",width:.75,color:r},l={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},a={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},c={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},u={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},p={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},39088:function(e,t,i){i.r(t),i.d(t,{default:function(){return S}});var r=i(73440),n=i(88194),s=i(61100),o=i(90403),l=i(17155),a=(i(61432),i(96711),i(83850),i(48023)),c=i(24381),u=i(21143),p=i(98185),h=i(51335),d=i(15165),y=i(94125),f=i(5527),g=i(43295),b=i(27546),m=i(92105);let C=class extends((0,c.A)(f.Z)){constructor(){super(...arguments),this.type="graphics-3d",this.symbologySnappingSupported=!0,this._slicePlaneEnabled=!1,this.fullExtentInLocalViewSpatialReference=null,this.ignoresMemoryFactor=!0}get highlightOptions(){return null}initialize(){this._set("processor",new p.D({owner:this,scaleVisibilityEnabled:!0,frustumVisibilityEnabled:!0})),this.addResolvingPromise(this.processor.initializePromise),this.addHandles(this.layer.on("graphic-update",(e=>this.processor.graphicsCore.graphicUpdateHandler(e)))),this.layer.internal?this.notifyChange("updating"):("local"===this.view.viewingMode&&this.addResolvingPromise((async()=>this.fullExtentInLocalViewSpatialReference=await(0,m.i)(this.layer.fullExtent,this.view.spatialReference))()),this.addHandles((0,o.gx)((()=>this.view?.basemapTerrain?.ready),(()=>()=>this.notifyChange("updating")),{once:!0})))}destroy(){this._updatingHandles.removeAll(),this._set("processor",(0,s.SC)(this.processor))}get loadedGraphics(){return this.layer.graphics}get legendEnabled(){return this.canResume()&&!this.processor?.frustumVisibilitySuspended}get visibleAtCurrentScale(){return(0,b.Dc)()?(0,b.GB)(this.layer.effectiveScaleRange,this.view.scale):!this.processor?.scaleVisibilitySuspended}get slicePlaneEnabled(){const e=this.layer.internal;return this._slicePlaneEnabled&&!e}set slicePlaneEnabled(e){this._slicePlaneEnabled=e}getSuspendInfo(){const e=super.getSuspendInfo();return e.outsideOfView=this.processor?.frustumVisibilitySuspended??!1,e}getHit(e){return this.processor.getHit(e)}whenGraphicBounds(e,t){return this.processor.whenGraphicBounds(e,t)}computeAttachmentOrigin(e,t){return this.processor?.computeAttachmentOrigin(e,t)}getSymbolLayerSize(e,t){return this.processor.getSymbolLayerSize(e,t)}queryGraphics(){return Promise.resolve(this.loadedGraphics)}maskOccludee(e){return this.processor.maskOccludee(e)}highlight(e,t){return this.processor.highlight(e,t?.name??g.b)}notifyContentGeometryUpdate(){this.emit("visible-geometry-changed")}async elevationAlignPointsInFeatures(e,t){const{processor:i}=this;if(null==i?.graphics3DGraphics)throw new n.Z("graphicslayerview3d:missing-processor","A Graphics3D processor is needed to resolve graphics elevation.");const{graphics3DGraphics:r}=i;return(0,u.W)(this.view,this.layer,(e=>"number"==typeof e?r.get(e):void 0),e,t)}async queryForSymbologySnapping(e,t){return(0,h.c)(this.processor,e,t)}get updatePolicy(){return this.processor?.graphicsCore.effectiveUpdatePolicy||y.j.SYNC}isUpdating(){return this.view&&this.layer&&!(!this.processor?.updating&&(this.layer.internal||this.view.basemapTerrain?.ready))}get performanceInfo(){return new d.W(this.usedMemory,this.loadedGraphics.length,-1,-1)}get usedMemory(){return this.processor?.graphicsCore?.usedMemory??0}get unloadedMemory(){return this.processor?.graphicsCore?.unprocessedMemoryEstimate}get test(){return{graphics3DProcessor:this.processor,loadedGraphics:this.loadedGraphics}}};(0,r._)([(0,l.Cb)()],C.prototype,"highlightOptions",null),(0,r._)([(0,l.Cb)()],C.prototype,"loadedGraphics",null),(0,r._)([(0,l.Cb)({readOnly:!0})],C.prototype,"legendEnabled",null),(0,r._)([(0,l.Cb)()],C.prototype,"layer",void 0),(0,r._)([(0,l.Cb)({readOnly:!0})],C.prototype,"processor",void 0),(0,r._)([(0,l.Cb)({readOnly:!0})],C.prototype,"visibleAtCurrentScale",null),(0,r._)([(0,l.Cb)()],C.prototype,"_slicePlaneEnabled",void 0),(0,r._)([(0,l.Cb)({type:Boolean})],C.prototype,"slicePlaneEnabled",null),C=(0,r._)([(0,a.j)("esri.views.3d.layers.GraphicsLayerView3D")],C);const S=C},98185:function(e,t,i){i.d(t,{D:function(){return x}});var r=i(73440),n=i(46451),s=i(70880),o=i(50702),l=i(61100),a=i(93568),c=i(90403),u=i(17155),p=(i(61432),i(96711),i(83850),i(48023)),h=i(58426),d=i(60147),y=i(38209),f=i(74774),g=i(56216),b=i(29191),m=i(94808),C=i(47451),S=i(28994),w=i(5473),_=i(18234),v=i(62564),V=i(66290),O=i(36027),P=i(78637),E=i(94125),G=i(27546);let x=class extends s.Z{constructor(e){super(e),this.drapeSourcePriorityOffset=0,this.type="graphics-3d",this.graphicsCore=null,this.drapeSourceType=m.Lw.Features,this.scaleVisibilityEnabled=!1,this.frustumVisibilityEnabled=!1,this._suspendResumeExtent=null,this._updatingHandles=new d.R}initialize(){const{layer:e}=this,t="effectiveScaleRange"in e?e:null,i=!(0,G.Dc)()&&this.scaleVisibilityEnabled&&null!=t,r=new S.w({owner:this,layer:this.owner.layer,preferredUpdatePolicy:E.j.SYNC,graphicSymbolSupported:!0,componentFactories:{elevationAlignment:(e,t)=>new w._({graphicsCoreOwner:this,graphicsCore:e,queryGraphicUIDsInExtent:t,elevationProvider:this.view.elevationProvider}),scaleVisibility:i?(e,i)=>new V.c({graphicsCoreOwner:this,layer:t,queryGraphicUIDsInExtent:i,graphicsCore:e,basemapTerrain:this.owner.view.basemapTerrain}):null,objectStates:e=>new v.d(e)}});if(this._set("graphicsCore",r),this.frustumVisibilityEnabled&&this._set("frustumVisibility",new _.L({graphicsCoreOwner:this})),"fullOpacity"in this.owner){const e=this.owner;this._updatingHandles.add((()=>e.fullOpacity),(()=>this.graphicsCore.opacityChange()))}if("elevationInfo"in e){const t=e;this._updatingHandles.add((()=>t.elevationInfo),((e,t)=>{(0,h.Hg)(e,t)&&this._updatingHandles.addPromise(this.graphicsCore.elevationInfoChange())}))}this._set("initializePromise",this._initializeAsync()),this._updatingHandles.addPromise(this.initializePromise)}async _initializeAsync(){try{await this.graphicsCore.initializePromise}catch(e){if((0,a.D_)(e))return;throw e}this.destroyed||(this.addHandles((0,c.YP)((()=>this.view.clippingArea),(()=>this._updateClippingExtent()),c.Z_)),this._updateClippingExtent(),this._setupSuspendResumeExtent(),this.graphicsCore.startCreateGraphics())}destroy(){this._updatingHandles.destroy(),this._set("frustumVisibility",(0,l.SC)(this.frustumVisibility)),this._set("graphicsCore",(0,l.SC)(this.graphicsCore))}get layer(){return this.owner.layer}get layerViewUid(){return this.owner.uid}get view(){return this.owner.view}get scaleVisibility(){return this.graphicsCore?.scaleVisibility}get elevationAlignment(){return this.graphicsCore?.elevationAlignment}get scaleVisibilitySuspended(){return!(null==this.scaleVisibility||!this.scaleVisibility.suspended)}get frustumVisibilitySuspended(){return null!=this.frustumVisibility&&this.frustumVisibility.suspended}get suspended(){return this.owner.suspended??!1}get updating(){return!!(this.graphicsCore?.updating||null!=this.scaleVisibility&&this.scaleVisibility.updating||null!=this.frustumVisibility&&this.frustumVisibility.updating||this._updatingHandles.updating)}get graphics3DGraphics(){return this.graphicsCore?.graphics3DGraphics}get graphics3DGraphicsByObjectID(){return this.graphicsCore?.graphics3DGraphicsByObjectID}get loadedGraphics(){return this.owner.loadedGraphics}get fullOpacity(){return this.owner.fullOpacity??1}get slicePlaneEnabled(){return this.owner.slicePlaneEnabled}get updatePolicy(){return this.owner.updatePolicy}notifyGraphicGeometryChanged(e){this.graphicsCore.notifyGraphicGeometryChanged(e)}notifyGraphicVisibilityChanged(e){this.graphicsCore.notifyGraphicVisibilityChanged(e)}notifyContentGeometryUpdate(){this.owner.notifyContentGeometryUpdate?.()}getRenderingInfo(e,t,i){const r=(0,g.Kb)(e,{renderer:t,arcade:i});if(r?.color){const e=r.color;e[0]=e[0]/255,e[1]=e[1]/255,e[2]=e[2]/255}return r}getRenderingInfoAsync(e,t,i,r){return(0,g.xn)(e,{renderer:t,arcade:i,...r})}getHit(e){if(this.owner.loadedGraphics){const t=this.owner.loadedGraphics.find((t=>t.uid===e));if(t){const e=this.layer instanceof y.Z?this.layer:null,i=(0,f.mW)(t,e);return{type:"graphic",graphic:i,layer:i.layer}}}return null}whenGraphicBounds(e,t){return this.graphicsCore?this.graphicsCore.whenGraphicBounds(e,t):Promise.reject()}computeAttachmentOrigin(e,t){return this.graphicsCore?this.graphicsCore.computeAttachmentOrigin(e,t):null}getSymbolLayerSize(e,t){return this.graphicsCore?this.graphicsCore.getSymbolLayerSize(e,t):null}maskOccludee(e){const t=this.graphicsCore?.objectStates;if(!t)return(0,o.kB)();const{set:i,handle:r}=t.acquireOccludeeSet(null);return t.setUid(i,e.uid),r}highlight(e,t){const i=this.graphicsCore?.objectStates;if(!i)return A;if(e instanceof b.Z)return A;const r=(0,P.OL)(e);if(0===r.length)return A;if(r[0]instanceof n.Z){const e=r.map((e=>e.uid)),{set:n,handle:s}=i.acquireHighlightSet(t,null);return i.setUids(n,e),s}if("number"==typeof r[0]){const e=r,{set:n,handle:s}=i.acquireHighlightSet(t,null);return i.setObjectIds(n,e),s}return A}_setupSuspendResumeExtent(){const{scaleVisibility:e,frustumVisibility:t}=this;if(null==e&&null==t)return;const i=({computedExtent:i,extentPadding:r})=>{this._suspendResumeExtent=(0,O.Go)(i,this._suspendResumeExtent,C.PY,r),null!=e&&e.setExtent(this._suspendResumeExtent),null!=t&&t.setExtent(this._suspendResumeExtent)};this.addHandles((0,c.YP)((()=>({computedExtent:this.graphicsCore?.computedExtent,extentPadding:this.graphicsCore?.extentPadding})),(e=>i(e)),c.tX))}_updateClippingExtent(){const e=this.view.clippingArea;this.graphicsCore.setClippingExtent(e,this.view.spatialReference)&&this.graphicsCore.recreateAllGraphics()}};(0,r._)([(0,u.Cb)()],x.prototype,"drapeSourcePriorityOffset",void 0),(0,r._)([(0,u.Cb)()],x.prototype,"type",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],x.prototype,"owner",void 0),(0,r._)([(0,u.Cb)()],x.prototype,"layer",null),(0,r._)([(0,u.Cb)()],x.prototype,"layerViewUid",null),(0,r._)([(0,u.Cb)()],x.prototype,"view",null),(0,r._)([(0,u.Cb)({constructOnly:!0})],x.prototype,"graphicsCore",void 0),(0,r._)([(0,u.Cb)()],x.prototype,"scaleVisibility",null),(0,r._)([(0,u.Cb)({constructOnly:!0})],x.prototype,"frustumVisibility",void 0),(0,r._)([(0,u.Cb)()],x.prototype,"elevationAlignment",null),(0,r._)([(0,u.Cb)()],x.prototype,"scaleVisibilitySuspended",null),(0,r._)([(0,u.Cb)({readOnly:!0})],x.prototype,"frustumVisibilitySuspended",null),(0,r._)([(0,u.Cb)()],x.prototype,"suspended",null),(0,r._)([(0,u.Cb)({readOnly:!0})],x.prototype,"updating",null),(0,r._)([(0,u.Cb)()],x.prototype,"loadedGraphics",null),(0,r._)([(0,u.Cb)()],x.prototype,"fullOpacity",null),(0,r._)([(0,u.Cb)()],x.prototype,"slicePlaneEnabled",null),(0,r._)([(0,u.Cb)()],x.prototype,"drapeSourceType",void 0),(0,r._)([(0,u.Cb)()],x.prototype,"updatePolicy",null),(0,r._)([(0,u.Cb)({constructOnly:!0})],x.prototype,"scaleVisibilityEnabled",void 0),(0,r._)([(0,u.Cb)({constructOnly:!0})],x.prototype,"frustumVisibilityEnabled",void 0),(0,r._)([(0,u.Cb)()],x.prototype,"initializePromise",void 0),x=(0,r._)([(0,p.j)("esri.views.3d.layers.graphics.GraphicsProcessor")],x);const A=(0,o.kB)()}}]);