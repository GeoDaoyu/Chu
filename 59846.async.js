"use strict";(self.webpackChunkscene_pro=self.webpackChunkscene_pro||[]).push([[59846],{62920:function(e,t,i){i.d(t,{T:function(){return d}});var s=i(73440),r=i(89314),n=i(63255),o=i(92161),a=i(17155),l=(i(61432),i(96711),i(83850),i(79775)),u=i(48023),c=i(24009);let d=class extends(r.Z.ClonableMixin(n.Z)){constructor(e){super(e),this.unit="milliseconds",this.value=0}toMilliseconds(){return(0,o.rJ)(this.value,this.unit,"milliseconds")}};(0,s._)([(0,l.J)(c.v,{nonNullable:!0})],d.prototype,"unit",void 0),(0,s._)([(0,a.Cb)({type:Number,json:{write:!0},nonNullable:!0})],d.prototype,"value",void 0),d=(0,s._)([(0,u.j)("esri.time.TimeInterval")],d)},29328:function(e,t,i){i.d(t,{F:function(){return f},M:function(){return s}});const s={Base64:0,Hex:1,String:2,Raw:3};function r(e,t){const i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}function n(e){const t=[];for(let i=0,s=8*e.length;i<s;i+=8)t[i>>5]|=(255&e.charCodeAt(i/8))<<i%32;return t}function o(e){const t=[];for(let i=0,s=32*e.length;i<s;i+=8)t.push(String.fromCharCode(e[i>>5]>>>i%32&255));return t.join("")}function a(e,t,i,s,n,o){return r(function(e,t){return e<<t|e>>>32-t}(r(r(t,e),r(s,o)),n),i)}function l(e,t,i,s,r,n,o){return a(t&i|~t&s,e,t,r,n,o)}function u(e,t,i,s,r,n,o){return a(t&s|i&~s,e,t,r,n,o)}function c(e,t,i,s,r,n,o){return a(t^i^s,e,t,r,n,o)}function d(e,t,i,s,r,n,o){return a(i^(t|~s),e,t,r,n,o)}function h(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;let i=1732584193,s=-271733879,n=-1732584194,o=271733878;for(let t=0;t<e.length;t+=16){const a=i,h=s,f=n,p=o;i=l(i,s,n,o,e[t],7,-680876936),o=l(o,i,s,n,e[t+1],12,-389564586),n=l(n,o,i,s,e[t+2],17,606105819),s=l(s,n,o,i,e[t+3],22,-1044525330),i=l(i,s,n,o,e[t+4],7,-176418897),o=l(o,i,s,n,e[t+5],12,1200080426),n=l(n,o,i,s,e[t+6],17,-1473231341),s=l(s,n,o,i,e[t+7],22,-45705983),i=l(i,s,n,o,e[t+8],7,1770035416),o=l(o,i,s,n,e[t+9],12,-1958414417),n=l(n,o,i,s,e[t+10],17,-42063),s=l(s,n,o,i,e[t+11],22,-1990404162),i=l(i,s,n,o,e[t+12],7,1804603682),o=l(o,i,s,n,e[t+13],12,-40341101),n=l(n,o,i,s,e[t+14],17,-1502002290),s=l(s,n,o,i,e[t+15],22,1236535329),i=u(i,s,n,o,e[t+1],5,-165796510),o=u(o,i,s,n,e[t+6],9,-1069501632),n=u(n,o,i,s,e[t+11],14,643717713),s=u(s,n,o,i,e[t],20,-373897302),i=u(i,s,n,o,e[t+5],5,-701558691),o=u(o,i,s,n,e[t+10],9,38016083),n=u(n,o,i,s,e[t+15],14,-660478335),s=u(s,n,o,i,e[t+4],20,-405537848),i=u(i,s,n,o,e[t+9],5,568446438),o=u(o,i,s,n,e[t+14],9,-1019803690),n=u(n,o,i,s,e[t+3],14,-187363961),s=u(s,n,o,i,e[t+8],20,1163531501),i=u(i,s,n,o,e[t+13],5,-1444681467),o=u(o,i,s,n,e[t+2],9,-51403784),n=u(n,o,i,s,e[t+7],14,1735328473),s=u(s,n,o,i,e[t+12],20,-1926607734),i=c(i,s,n,o,e[t+5],4,-378558),o=c(o,i,s,n,e[t+8],11,-2022574463),n=c(n,o,i,s,e[t+11],16,1839030562),s=c(s,n,o,i,e[t+14],23,-35309556),i=c(i,s,n,o,e[t+1],4,-1530992060),o=c(o,i,s,n,e[t+4],11,1272893353),n=c(n,o,i,s,e[t+7],16,-155497632),s=c(s,n,o,i,e[t+10],23,-1094730640),i=c(i,s,n,o,e[t+13],4,681279174),o=c(o,i,s,n,e[t],11,-358537222),n=c(n,o,i,s,e[t+3],16,-722521979),s=c(s,n,o,i,e[t+6],23,76029189),i=c(i,s,n,o,e[t+9],4,-640364487),o=c(o,i,s,n,e[t+12],11,-421815835),n=c(n,o,i,s,e[t+15],16,530742520),s=c(s,n,o,i,e[t+2],23,-995338651),i=d(i,s,n,o,e[t],6,-198630844),o=d(o,i,s,n,e[t+7],10,1126891415),n=d(n,o,i,s,e[t+14],15,-1416354905),s=d(s,n,o,i,e[t+5],21,-57434055),i=d(i,s,n,o,e[t+12],6,1700485571),o=d(o,i,s,n,e[t+3],10,-1894986606),n=d(n,o,i,s,e[t+10],15,-1051523),s=d(s,n,o,i,e[t+1],21,-2054922799),i=d(i,s,n,o,e[t+8],6,1873313359),o=d(o,i,s,n,e[t+15],10,-30611744),n=d(n,o,i,s,e[t+6],15,-1560198380),s=d(s,n,o,i,e[t+13],21,1309151649),i=d(i,s,n,o,e[t+4],6,-145523070),o=d(o,i,s,n,e[t+11],10,-1120210379),n=d(n,o,i,s,e[t+2],15,718787259),s=d(s,n,o,i,e[t+9],21,-343485551),i=r(i,a),s=r(s,h),n=r(n,f),o=r(o,p)}return[i,s,n,o]}function f(e,t=s.Hex){const i=t||s.Base64,r=h(n(e),8*e.length);switch(i){case s.Raw:return r;case s.Hex:return function(e){const t="0123456789abcdef",i=[];for(let s=0,r=4*e.length;s<r;s++)i.push(t.charAt(e[s>>2]>>s%4*8+4&15)+t.charAt(e[s>>2]>>s%4*8&15));return i.join("")}(r);case s.String:return o(r);case s.Base64:return function(e){const t=[];for(let i=0,s=4*e.length;i<s;i+=3){const s=(e[i>>2]>>i%4*8&255)<<16|(e[i+1>>2]>>(i+1)%4*8&255)<<8|e[i+2>>2]>>(i+2)%4*8&255;for(let r=0;r<4;r++)8*i+6*r>32*e.length?t.push("="):t.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(s>>6*(3-r)&63))}return t.join("")}(r)}}},86640:function(e,t,i){i.d(t,{Z:function(){return y}});var s,r=i(73440),n=i(3480),o=i(41773),a=i(63255),l=i(26636),u=i(8914),c=i(17155),d=(i(61432),i(96711),i(1194)),h=i(48023),f=i(29884);const p=(0,o.w)()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),g=p.jsonValues.slice();(0,n.e$)(g,"orthometric");const m=(0,o.w)()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let y=s=class extends a.Z{constructor(e){super(e),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(e,t,i){return p.write(e,t,i)}readHeightModel(e,t,i){return p.read(e)||(i?.messages&&i.messages.push(function(e,t){return new u.Z("height-model:unsupported",`Height model of value '${e}' is not supported`,t)}(e,{context:i})),null)}readHeightUnit(e,t,i){return m.read(e)||(i?.messages&&i.messages.push(b(e,{context:i})),null)}readHeightUnitService(e,t,i){return(0,l.$C)(e)||m.read(e)||(i?.messages&&i.messages.push(b(e,{context:i})),null)}readVertCRS(e,t){return t.vertCRS||t.ellipsoid||t.geoid}clone(){return new s({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(e){return!!e&&(this===e||this.heightModel===e.heightModel&&this.heightUnit===e.heightUnit&&this.vertCRS===e.vertCRS)}static deriveUnitFromSR(e,t){const i=(0,l.cM)(t);return new s({heightModel:e.heightModel,heightUnit:i??void 0,vertCRS:e.vertCRS})}write(e,t){return t={origin:"web-scene",...t},super.write(e,t)}static fromJSON(e){if(!e)return null;const t=new s;return t.read(e,{origin:"web-scene"}),t}};function b(e,t){return new u.Z("height-unit:unsupported",`Height unit of value '${e}' is not supported`,t)}(0,r._)([(0,c.Cb)({type:p.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:g,default:"ellipsoidal",write:{isRequired:!0}}}}})],y.prototype,"heightModel",void 0),(0,r._)([(0,f.c)("web-scene","heightModel")],y.prototype,"writeHeightModel",null),(0,r._)([(0,d.r)(["web-scene","service"],"heightModel")],y.prototype,"readHeightModel",null),(0,r._)([(0,c.Cb)({type:m.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:m.jsonValues,write:{writer:m.write,isRequired:!0}}}}})],y.prototype,"heightUnit",void 0),(0,r._)([(0,d.r)("web-scene","heightUnit")],y.prototype,"readHeightUnit",null),(0,r._)([(0,d.r)("service","heightUnit")],y.prototype,"readHeightUnitService",null),(0,r._)([(0,c.Cb)({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],y.prototype,"vertCRS",void 0),(0,r._)([(0,d.r)("service","vertCRS",["vertCRS","ellipsoid","geoid"])],y.prototype,"readVertCRS",null),y=s=(0,r._)([(0,h.j)("esri.geometry.HeightModelInfo")],y)},4469:function(e,t,i){i.d(t,{DE:function(){return a},Nf:function(){return u},dp:function(){return o},o2:function(){return l},yZ:function(){return n}});var s=i(99574),r=i(26636);function n(e,t){const i=t||e.extent,s=e.width,n=(0,r.c9)(i?.spatialReference);return i&&s?i.width/s*n*r.hd*96:0}function o(e,t){return e/((0,r.c9)(t)*r.hd*96)}function a(e){return e/(96*r.hd)}function l(e,t,i){return function(e,t){return 0===t||(0,s.W8)(e,t)||e<t}(e,t)&&function(e,t){return 0===t||(0,s.W8)(e,t)||e>t}(e,i)}function u(e,t){return(0,s.W8)(e,t)?0:(e||Number.POSITIVE_INFINITY)>(t||Number.POSITIVE_INFINITY)?1:-1}},56346:function(e,t,i){i.d(t,{Z:function(){return h}});var s=i(73440),r=i(70880),n=i(3480),o=i(29292),a=i(43254),l=i(17155),u=(i(61432),i(96711),i(48023)),c=i(76554),d=i(3411);let h=class extends r.Z{constructor(e){super(e),this._featureUtils=null,this.effectivePopupTemplate=null}get _arcadeTask(){return this.expressionsUsedInTitle.length>0?this._get("_arcadeTask")||(0,o.vr)((()=>(0,d.L)())):null}get featureUtilsPromise(){return this._get("featureUtilsPromise")??i.e(11407).then(i.bind(i,11407)).then((e=>this._featureUtils=e))}get calculatedExpressions(){const e=new a.Z;if(!this.expressionsUsedInTitle.length)return e;if(!this._arcadeTask?.value){for(const t of this.expressionsUsedInTitle??[])e.push({name:t.name,invalid:!0});return e}for(const t of this.expressionsUsedInTitle)try{const i=this._arcadeTask.value.arcade.parseScript(t.expression,["$layer","$map","$datastore"]);if(i.isAsync){e.push({name:t.name,invalid:!0});break}e.push({name:t.name,syntax:i,invalid:!1,func:this._arcadeTask.value.arcade.compileScript(i,{vars:{$feature:"any"}})})}catch{e.push({name:t.name,invalid:!0});break}return e}get expressionsUsedInTitle(){let e=this.effectivePopupTemplate?.title??"";return"string"!=typeof e?[]:(e=e.toLowerCase(),this.effectivePopupTemplate?.expressionInfos?.filter((t=>e.includes(`{expression/${t.name.toLowerCase()}}`)))??[])}get fieldInfoMap(){return this._featureUtils?this._createFieldInfoMap(this._featureUtils.getAllFieldInfos(this.effectivePopupTemplate)):null}get hasBadExpressions(){return this.calculatedExpressions.some((e=>!0===e.invalid))}get requiredFields(){const e=new Set;if(this._arcadeTask?.value&&!this.hasBadExpressions)for(const t of this.calculatedExpressions?.toArray()??[])try{const i=this._arcadeTask.value.arcade.extractFieldLiterals(t.syntax);for(const t of i){const i=t.split("."),s=this.fieldsIndex.get(i.at(-1)??"");s&&e.add(s.name)}}catch{}const t=this._extractFieldNames(this.workingTitle);for(const i of t){const t=this.fieldsIndex.get(i);t&&e.add(t.name)}return null!=this.objectIdField&&e.add(this.objectIdField),e}get titleFromDisplayField(){let e="";return this.displayField&&(e=this.fieldsIndex.get(this.displayField)?.name??""),e||(e=this.fieldsIndex.get(this.objectIdField)?.name??""),e?`{${e}}`:""}get workingTitle(){const e=this.effectivePopupTemplate?this.effectivePopupTemplate.title:"";return""===e||null==e||this.hasBadExpressions||"string"!=typeof e?this.titleFromDisplayField:e}async getTitle(e,t,i){const s=t.getObjectId()??t.attributes[e.objectIdField];return(await this.getTitles(e,[t],i)).get(s)??""}async getTitles(e,t,i){const s=new Map,r=i?.timeZone??"system";try{const[{substituteFieldsInLinksAndAttributes:n}]=await Promise.all([this.featureUtilsPromise,this._arcadeTask?.promise]);i?.fetchMissingFields&&(t=await this._checkAndReQueryGraphics(e,t));const{fieldInfoMap:o,workingTitle:a}=this,l=a&&o;t.forEach((t=>{const i=t.getObjectId()??t.attributes[e.objectIdField],u=l?n({attributes:t.attributes,expressionAttributes:null,fieldInfoMap:o,globalAttributes:this._createFormattedAttributes(e,t,r).global,layer:e,text:a}):"";s.set(i,u)}))}catch{}return s}async _checkAndReQueryGraphics(e,t){const i=t.map((t=>t.getObjectId()??t.attributes[e.objectIdField])).filter(n.pC);if(i.length!==t.length)return t;if(t.some((e=>!(0,c.R9)(e,this.requiredFields)))){const s=e.createQuery();s.where="1=1",s.outFields=[...this.requiredFields],s.objectIds=i;const r=await e.queryFeatures(s);if(r?.features.length===t.length)return r.features}return t}_createFieldInfoMap(e){const t=new Map;if(!e)return t;for(const i of e){if(!i.fieldName)continue;const e=this.fieldsIndex.get(i.fieldName)?.name??i.fieldName;i.fieldName=e,t.set(e.toLowerCase(),i)}return t}_createFormattedAttributes(e,t,i="system"){const s=this.effectivePopupTemplate?.fieldInfos??[],r={};if(!this._featureUtils)return{};if(!this.hasBadExpressions&&this.calculatedExpressions.length>0&&this._arcadeTask?.value){const i=this._arcadeTask.value.Feature.createFromGraphicLikeObject(t.geometry,t.attributes,e,null);for(const e of this.calculatedExpressions)try{r[`expression/${e.name}`]=e.func({vars:{$feature:i}})}catch{}}const n={...t.attributes,...r};return{global:this._featureUtils.formatAttributes({fieldInfos:s,attributes:n,graphic:t,timeZone:i,layer:e,fieldInfoMap:this.fieldInfoMap}),content:[]}}_extractFieldNames(e){return(0,c.ld)(e).filter((e=>!(0===e.indexOf("relationships/")||0===e.indexOf("expression/"))))}};(0,s._)([(0,l.Cb)({readOnly:!0})],h.prototype,"_arcadeTask",null),(0,s._)([(0,l.Cb)()],h.prototype,"_featureUtils",void 0),(0,s._)([(0,l.Cb)({readOnly:!0})],h.prototype,"featureUtilsPromise",null),(0,s._)([(0,l.Cb)({readOnly:!0})],h.prototype,"calculatedExpressions",null),(0,s._)([(0,l.Cb)()],h.prototype,"displayField",void 0),(0,s._)([(0,l.Cb)()],h.prototype,"effectivePopupTemplate",void 0),(0,s._)([(0,l.Cb)()],h.prototype,"expressionsUsedInTitle",null),(0,s._)([(0,l.Cb)()],h.prototype,"fieldsIndex",void 0),(0,s._)([(0,l.Cb)()],h.prototype,"fieldInfoMap",null),(0,s._)([(0,l.Cb)()],h.prototype,"fields",void 0),(0,s._)([(0,l.Cb)()],h.prototype,"objectIdField",void 0),(0,s._)([(0,l.Cb)()],h.prototype,"requiredFields",null),h=(0,s._)([(0,u.j)("esri.layers.support.TitleCreator")],h)},24009:function(e,t,i){i.d(t,{v:function(){return s}});const s=(0,i(41773).w)()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0})},3651:function(e,t,i){var s;i.d(t,{x:function(){return s}}),function(e){e[e.SAVE=0]="SAVE",e[e.SAVE_AS=1]="SAVE_AS"}(s||(s={}))}}]);