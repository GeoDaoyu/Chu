"use strict";(self.webpackChunkscene_pro=self.webpackChunkscene_pro||[]).push([[974],{83695:function(t,e,n){function r(){return[1,0,0,1,0,0]}function o(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}n.d(e,{Ue:function(){return r},Wd:function(){return i},d9:function(){return o}});const i=[1,0,0,1,0,0];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:i,clone:o,create:r,fromValues:function(t,e,n,r,o,i){return[t,e,n,r,o,i]}},Symbol.toStringTag,{value:"Module"}))},50639:function(t,e,n){n.d(e,{Iu:function(){return u},Jp:function(){return a},U1:function(){return s},U_:function(){return i},Us:function(){return c},bA:function(){return l},vc:function(){return d},xJ:function(){return h},yR:function(){return o}});var r=n(66130);function o(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function i(t,e){const n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],s=e[5];let l=n*i-r*o;return l?(l=1/l,t[0]=i*l,t[1]=-r*l,t[2]=-o*l,t[3]=n*l,t[4]=(o*s-i*a)*l,t[5]=(r*a-n*s)*l,t):null}function a(t,e,n){const r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],l=e[5],u=n[0],c=n[1],h=n[2],d=n[3],p=n[4],f=n[5];return t[0]=r*u+i*c,t[1]=o*u+a*c,t[2]=r*h+i*d,t[3]=o*h+a*d,t[4]=r*p+i*f+s,t[5]=o*p+a*f+l,t}function s(t,e,n){const r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],l=e[5],u=Math.sin(n),c=Math.cos(n);return t[0]=r*c+i*u,t[1]=o*c+a*u,t[2]=r*-u+i*c,t[3]=o*-u+a*c,t[4]=s,t[5]=l,t}function l(t,e,n){const r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],l=e[5],u=n[0],c=n[1];return t[0]=r*u,t[1]=o*u,t[2]=i*c,t[3]=a*c,t[4]=s,t[5]=l,t}function u(t,e,n){const r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],l=e[5],u=n[0],c=n[1];return t[0]=r,t[1]=o,t[2]=i,t[3]=a,t[4]=r*u+i*c+s,t[5]=o*u+a*c+l,t}function c(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t}function h(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function d(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function p(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}const f=a,m=p;Object.freeze(Object.defineProperty({__proto__:null,add:function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},determinant:function(t){return t[0]*t[3]-t[1]*t[2]},equals:function(t,e){const n=t[0],o=t[1],i=t[2],a=t[3],s=t[4],l=t[5],u=e[0],c=e[1],h=e[2],d=e[3],p=e[4],f=e[5],m=(0,r.bn)();return Math.abs(n-u)<=m*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(o-c)<=m*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(i-h)<=m*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(a-d)<=m*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(s-p)<=m*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(l-f)<=m*Math.max(1,Math.abs(l),Math.abs(f))},exactEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},frob:function(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)},fromRotation:c,fromScaling:h,fromTranslation:d,identity:o,invert:i,mul:f,multiply:a,multiplyScalar:function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},multiplyScalarAndAdd:function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t},rotate:s,scale:l,set:function(t,e,n,r,o,i,a){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t[4]=i,t[5]=a,t},str:function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},sub:m,subtract:p,translate:u},Symbol.toStringTag,{value:"Module"}))},18156:function(t,e,n){n.d(e,{Bh:function(){return c},I6:function(){return k},Jp:function(){return h},Kx:function(){return f},Su:function(){return y},U_:function(){return p},b0:function(){return P},t8:function(){return v},yY:function(){return u}});var r=n(30748),o=n(21117),i=n(82846),a=n(66130),s=n(24910),l=n(73749);function u(t,e,n){n*=.5;const r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function c(t,e){const n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>(0,a.bn)()?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function h(t,e,n){const r=e[0],o=e[1],i=e[2],a=e[3],s=n[0],l=n[1],u=n[2],c=n[3];return t[0]=r*c+a*s+o*u-i*l,t[1]=o*c+a*l+i*s-r*u,t[2]=i*c+a*u+r*l-o*s,t[3]=a*c-r*s-o*l-i*u,t}function d(t,e,n,r){const o=e[0],i=e[1],s=e[2],l=e[3];let u,c,h,d,p,f=n[0],m=n[1],y=n[2],g=n[3];return c=o*f+i*m+s*y+l*g,c<0&&(c=-c,f=-f,m=-m,y=-y,g=-g),1-c>(0,a.bn)()?(u=Math.acos(c),h=Math.sin(u),d=Math.sin((1-r)*u)/h,p=Math.sin(r*u)/h):(d=1-r,p=r),t[0]=d*o+p*f,t[1]=d*i+p*m,t[2]=d*s+p*y,t[3]=d*l+p*g,t}function p(t,e){const n=e[0],r=e[1],o=e[2],i=e[3],a=n*n+r*r+o*o+i*i,s=a?1/a:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-o*s,t[3]=i*s,t}function f(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function m(t,e){const n=e[0]+e[4]+e[8];let r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{let n=0;e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);const o=(n+1)%3,i=(n+2)%3;r=Math.sqrt(e[3*n+n]-e[3*o+o]-e[3*i+i]+1),t[n]=.5*r,r=.5/r,t[3]=(e[3*o+i]-e[3*i+o])*r,t[o]=(e[3*o+n]+e[3*n+o])*r,t[i]=(e[3*i+n]+e[3*n+i])*r}return t}function y(t,e,n,r){const o=.5*Math.PI/180;e*=o,n*=o,r*=o;const i=Math.sin(e),a=Math.cos(e),s=Math.sin(n),l=Math.cos(n),u=Math.sin(r),c=Math.cos(r);return t[0]=i*l*c-a*s*u,t[1]=a*s*c+i*l*u,t[2]=a*l*u-i*s*c,t[3]=a*l*c+i*s*u,t}const g=l.c,v=l.s,b=l.g,_=h,M=l.d,w=l.h,E=l.l,S=l.j,x=S,C=l.b,O=C,T=l.n,k=l.a,I=l.e;function P(t,e,n){const r=(0,s.e)(e,n);return r<-.999999?((0,s.h)(z,A,e),(0,s.H)(z)<1e-6&&(0,s.h)(z,D,e),(0,s.n)(z,z),u(t,z,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):((0,s.h)(z,e,n),t[0]=z[0],t[1]=z[1],t[2]=z[2],t[3]=1+r,T(t,t))}const z=(0,i.Ue)(),A=(0,i.al)(1,0,0),D=(0,i.al)(0,1,0);const R=(0,o.Ue)(),H=(0,o.Ue)();const G=(0,r.Ue)();Object.freeze(Object.defineProperty({__proto__:null,add:b,calculateW:function(t,e){const n=e[0],r=e[1],o=e[2];return t[0]=n,t[1]=r,t[2]=o,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-o*o)),t},conjugate:f,copy:g,dot:w,equals:I,exactEquals:k,fromEuler:y,fromMat3:m,getAxisAngle:c,identity:function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},invert:p,len:x,length:S,lerp:E,mul:_,multiply:h,normalize:T,random:function(t){const e=a.FD,n=e(),r=e(),o=e(),i=Math.sqrt(1-n),s=Math.sqrt(n);return t[0]=i*Math.sin(2*Math.PI*r),t[1]=i*Math.cos(2*Math.PI*r),t[2]=s*Math.sin(2*Math.PI*o),t[3]=s*Math.cos(2*Math.PI*o),t},rotateX:function(t,e,n){n*=.5;const r=e[0],o=e[1],i=e[2],a=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=r*l+a*s,t[1]=o*l+i*s,t[2]=i*l-o*s,t[3]=a*l-r*s,t},rotateY:function(t,e,n){n*=.5;const r=e[0],o=e[1],i=e[2],a=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=r*l-i*s,t[1]=o*l+a*s,t[2]=i*l+r*s,t[3]=a*l-o*s,t},rotateZ:function(t,e,n){n*=.5;const r=e[0],o=e[1],i=e[2],a=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=r*l+o*s,t[1]=o*l-r*s,t[2]=i*l+a*s,t[3]=a*l-i*s,t},rotationTo:P,scale:M,set:v,setAxes:function(t,e,n,r){const o=G;return o[0]=n[0],o[3]=n[1],o[6]=n[2],o[1]=r[0],o[4]=r[1],o[7]=r[2],o[2]=-e[0],o[5]=-e[1],o[8]=-e[2],T(t,m(t,o))},setAxisAngle:u,slerp:d,sqlerp:function(t,e,n,r,o,i){return d(R,e,o,i),d(H,n,r,i),d(t,R,H,2*i*(1-i)),t},sqrLen:O,squaredLength:C,str:function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}},Symbol.toStringTag,{value:"Module"}))},30062:function(t,e,n){function r(t){let e,n,r=[],o=!1;return function(...i){return o&&e===this&&function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}(i,r)||(n=t.apply(this,i),e=this,r=i,o=!0),n}}n.d(e,{H:function(){return r}})},56172:function(t,e,n){var r;function o(t){return"global"===t?r.Global:r.Local}function i(t){return t===r.Global?"global":"local"}n.d(e,{JY:function(){return r},M7:function(){return i},wg:function(){return o}}),function(t){t[t.Global=1]="Global",t[t.Local=2]="Local"}(r||(r={}))},76473:function(t,e,n){n.r(e),n.d(e,{DrawScreenTool:function(){return b},geometryTypeToDrawOperationGeometryType:function(){return _}});var r=n(73440),o=n(87833),i=n(50702),a=n(61100),s=n(17155),l=(n(61432),n(96711),n(83850),n(48023)),u=n(83695),c=n(43166),h=n(77655),d=n(1663),p=n(49609),f=n(56128),m=n(70880),y=n(47566),g=(n(68808),n(23039));let v=class extends m.Z{constructor(t){super(t),this.coordinates=void 0,this.strokeDash=[],this.strokeWidth=1,this.strokeColor=[0,0,0,1],this.strokeDashColor=[255,255,255,1],this.fillColor=[0,0,0,0],this.visible=!0,this.isDecoration=!0}get _strokeStyle(){const t=this.strokeColor;return`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`}get _strokeBackgroundStyle(){const t=this.strokeDashColor;return`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`}get _fillStyle(){const t=this.fillColor;return`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`}get _renderCoordinates(){const t=[];if(!this.coordinates)return{coordinates:t,rect:y.G_};const e=(0,y.vk)((0,y.Wi)((0,y.Ue)(y.G_),this.coordinates),2*this.strokeWidth);e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]+.5),e[3]=Math.ceil(e[3]+.5);for(const n of this.coordinates)t.push([Math.floor(n[0]-e[0])+.5,Math.floor(n[1]-e[1])+.5]);return t.reverse(),{coordinates:t,rect:e}}render(){const{coordinates:t,rect:e}=this._renderCoordinates,n=(0,y.d_)(e),r=(0,y.Cb)(e);return(0,g.u)("div",{classes:{"esri-outline-overlay-item":!0},styles:{left:e[0]+"px",top:e[1]+"px",width:n+"px",height:r+"px",visibility:this.visible?"visible":"hidden"}},(0,g.u)("svg",{height:r,styles:{display:"block"},width:n},(0,g.u)("polygon",{fill:this._fillStyle,points:t.map((([t,e])=>`${t},${e}`)).join(" "),stroke:this._strokeBackgroundStyle,"stroke-width":this.strokeWidth}),(0,g.u)("polygon",{fill:"transparent",points:t.map((([t,e])=>`${t},${e}`)).join(" "),stroke:this._strokeStyle,"stroke-dasharray":this.strokeDash.length?this.strokeDash.join(" "):void 0,"stroke-width":this.strokeWidth})))}renderCanvas(){}};(0,r._)([(0,s.Cb)()],v.prototype,"coordinates",void 0),(0,r._)([(0,s.Cb)()],v.prototype,"strokeDash",void 0),(0,r._)([(0,s.Cb)()],v.prototype,"strokeWidth",void 0),(0,r._)([(0,s.Cb)()],v.prototype,"strokeColor",void 0),(0,r._)([(0,s.Cb)()],v.prototype,"strokeDashColor",void 0),(0,r._)([(0,s.Cb)()],v.prototype,"fillColor",void 0),(0,r._)([(0,s.Cb)()],v.prototype,"visible",void 0),(0,r._)([(0,s.Cb)()],v.prototype,"isDecoration",void 0),(0,r._)([(0,s.Cb)({readOnly:!0})],v.prototype,"_strokeStyle",null),(0,r._)([(0,s.Cb)({readOnly:!0})],v.prototype,"_strokeBackgroundStyle",null),(0,r._)([(0,s.Cb)({readOnly:!0})],v.prototype,"_fillStyle",null),(0,r._)([(0,s.Cb)({readOnly:!0})],v.prototype,"_renderCoordinates",null),v=(0,r._)([(0,l.j)("esri.views.overlay.OutlineOverlayItem")],v);let b=class extends(o.Z.EventedMixin(f.m)){constructor(t){super(t),this.drawOperation=null,this._overlayItem=void 0,this.geometryType=null,this.mode=null,this.type="draw-screen"}initialize(){this.drawOperation=this._makeDrawOperation();const t=t=>this.drawOperation?.on(t,(e=>{this._updateVisuals(),this.emit(t,e)}))??(0,i.kB)();this.addHandles([t("vertex-add"),t("vertex-remove"),t("vertex-update"),t("cursor-update"),t("complete")]),this.finishToolCreation()}destroy(){this.drawOperation=(0,a.SC)(this.drawOperation),this._set("view",null)}get canRedo(){return!!this.drawOperation?.canRedo}get canUndo(){return!!this.drawOperation?.canUndo}set centeredToggled(t){this._set("centeredToggled",t),this._updateVisuals()}set enabled(t){const{drawOperation:e}=this;e&&(e.interactive=t),this._set("enabled",t)}set uniformSizeToggled(t){this._set("uniformSizeToggled",t),this._updateVisuals()}get updating(){return this.drawOperation?.updating??!1}get cursor(){return this._get("cursor")??"crosshair"}set cursor(t){this._set("cursor",t);const{drawOperation:e}=this;e&&(e.cursor=t)}completeCreateOperation(){this.drawOperation?.complete()}onInputEvent(t){this.destroyed||this.drawOperation?.onInputEvent(t)}redo(){this.drawOperation?.redo()}undo(){this.drawOperation?.undo()}reset(){}_makeDrawOperation(){const{view:t}=this;return new c.wW({view:t,manipulators:this.manipulators,geometryType:_(this.geometryType),drawingMode:this.mode,hasZ:!1,defaultZ:0,snapToSceneEnabled:!1,drawSurface:new h.$c,hasM:!1,snappingManager:null,snappingVisualizer:null,graphic:null,cursor:this.cursor,automaticLengthMeasurementUtils:this.automaticLengthMeasurementUtils})}get coordinates(){const{drawOperation:t}=this;if(!t?.geometryIncludingUncommittedVertices.length)return[];const{coordinateHelper:e}=t,n=t.committableVertex,r=t.committedVertices.slice();null!=n&&r.push(e.pointToArray(n));const o=r.length;switch(this.geometryType){case"point":return r.slice(0,1);case"circle":case"rectangle":{const e=new p.kq(u.Wd,h.$c.spatialReference),n="circle"===this.geometryType?d.y:d.yL,i="circle"===this.geometryType?d.n_:d.MC;if(1===o&&t.isCompleted){const t=r[0];return n([t,e.makeMapPoint(t[0]+M,t[1])],e,!0)?.geometry.rings[0]??[]}if(2===o){const t="rectangle"!==this.geometryType,o=this.centeredToggled!==t,a="rectangle"!==this.geometryType;return(this.uniformSizeToggled!==a?n(r,e,o)?.geometry.rings[0]:i(r,e,o)?.geometry.rings[0])??[]}return[]}}return r}_updateVisuals(){if(!this._overlayItem){const t=new v({strokeDash:[5],strokeDashColor:[255,255,255,255]});this.view.overlay?.addItem(t),this.addHandles((0,i.kB)((()=>{this.view.overlay?.removeItem(t),t?.destroy(),this._overlayItem=void 0}))),this._overlayItem=t}this._overlayItem.coordinates=this.coordinates}onDeactivate(){this.drawOperation?.isCompleted||this.drawOperation?.cancel()}};function _(t){switch(t){case"polygon":case"point":return t;case"circle":case"rectangle":return"segment"}}(0,r._)([(0,s.Cb)({value:!1})],b.prototype,"centeredToggled",null),(0,r._)([(0,s.Cb)()],b.prototype,"drawOperation",void 0),(0,r._)([(0,s.Cb)({value:!0})],b.prototype,"enabled",null),(0,r._)([(0,s.Cb)({value:!1})],b.prototype,"uniformSizeToggled",null),(0,r._)([(0,s.Cb)({constructOnly:!0})],b.prototype,"geometryType",void 0),(0,r._)([(0,s.Cb)({constructOnly:!0})],b.prototype,"mode",void 0),(0,r._)([(0,s.Cb)({readOnly:!0})],b.prototype,"type",void 0),(0,r._)([(0,s.Cb)({readOnly:!0})],b.prototype,"updating",null),(0,r._)([(0,s.Cb)({constructOnly:!0,nonNullable:!0})],b.prototype,"view",void 0),(0,r._)([(0,s.Cb)({constructOnly:!0})],b.prototype,"automaticLengthMeasurementUtils",void 0),(0,r._)([(0,s.Cb)()],b.prototype,"cursor",null),b=(0,r._)([(0,l.j)("esri.views.draw.DrawScreenTool")],b);const M=48},56128:function(t,e,n){n.d(e,{m:function(){return c}});var r=n(73440),o=n(87833),i=(n(61432),n(96711),n(93568)),a=n(17155),s=(n(83850),n(48023)),l=n(55541),u=n(17188);let c=class extends o.Z.EventedAccessor{constructor(t){super(t),this.manipulators=new u.D,this.automaticManipulatorSelection=!0,this.hasGrabbedManipulators=!1,this.hasHoveredManipulators=!1,this.firstGrabbedManipulator=null,this.created=!1,this.removeIncompleteOnCancel=!0,this._editableFlags=new Map([[l.bH.MANAGER,!0],[l.bH.USER,!0]]),this._creationFinishedResolver=(0,i.hh)()}get active(){return null!=this.view&&this.view.activeTool===this}set visible(t){this._get("visible")!==t&&(this._set("visible",t),this._syncVisible())}get editable(){return this.getEditableFlag(l.bH.USER)}set editable(t){this.setEditableFlag(l.bH.USER,t)}get updating(){return!1}get cursor(){return null}get hasFocusedManipulators(){return this.hasGrabbedManipulators||this.hasHoveredManipulators}destroy(){this.manipulators.destroy(),this._set("view",null)}onAdd(){this._syncVisible()}activate(){null!=this.view&&(this.view.focus(),this.onActivate())}deactivate(){this.onDeactivate()}cancel(){this.emit("cancel")}handleInputEvent(t){this.onInputEvent(t)}handleInputEventAfter(t){this.onInputEventAfter(t)}setEditableFlag(t,e){this._editableFlags.set(t,e),this.manipulators.isToolEditable=this.internallyEditable,this._updateManipulatorAttachment(),t===l.bH.USER&&this.notifyChange("editable"),this.onEditableChange(),this.onManipulatorSelectionChanged()}getEditableFlag(t){return this._editableFlags.get(t)??!1}endDrag(){const t=this.view.inputManager.latestPointerLocation;if(!t)return;let e=!1;this.manipulators.forEach((({manipulator:n})=>{n.dragging&&(e=!0,n.events.emit("drag",{action:"end",start:t,screenPoint:t}))})),e&&(this.view.toolViewManager.activeTool=null)}whenCreated(){return this._creationFinishedResolver.promise}onManipulatorSelectionChanged(){}onActivate(){}onDeactivate(){}onShow(){}onHide(){}onEditableChange(){}onInputEvent(t){}onInputEventAfter(t){}get internallyEditable(){return this.getEditableFlag(l.bH.USER)&&this.getEditableFlag(l.bH.MANAGER)}finishToolCreation(){this.created||this._creationFinishedResolver.resolve(this),this._set("created",!0)}_syncVisible(){if(this.initialized)if(this.visible)this._show();else if(this._hide(),this.active)return void(this.view.activeTool=null)}_show(){this._updateManipulatorAttachment(),this.onShow()}_hide(){this._updateManipulatorAttachment(),this.onHide()}_updateManipulatorAttachment(){this.visible?this.manipulators.attach():this.manipulators.detach()}};(0,r._)([(0,a.Cb)({constructOnly:!0})],c.prototype,"view",void 0),(0,r._)([(0,a.Cb)({readOnly:!0})],c.prototype,"active",null),(0,r._)([(0,a.Cb)({value:!0})],c.prototype,"visible",null),(0,r._)([(0,a.Cb)({value:!0})],c.prototype,"editable",null),(0,r._)([(0,a.Cb)({readOnly:!0})],c.prototype,"manipulators",void 0),(0,r._)([(0,a.Cb)({readOnly:!0})],c.prototype,"updating",null),(0,r._)([(0,a.Cb)()],c.prototype,"cursor",null),(0,r._)([(0,a.Cb)({readOnly:!0})],c.prototype,"automaticManipulatorSelection",void 0),(0,r._)([(0,a.Cb)()],c.prototype,"hasFocusedManipulators",null),(0,r._)([(0,a.Cb)()],c.prototype,"hasGrabbedManipulators",void 0),(0,r._)([(0,a.Cb)()],c.prototype,"hasHoveredManipulators",void 0),(0,r._)([(0,a.Cb)()],c.prototype,"firstGrabbedManipulator",void 0),(0,r._)([(0,a.Cb)({readOnly:!0})],c.prototype,"created",void 0),(0,r._)([(0,a.Cb)({readOnly:!0})],c.prototype,"removeIncompleteOnCancel",void 0),c=(0,r._)([(0,s.j)("esri.views.interactive.InteractiveToolBase")],c)},17188:function(t,e,n){n.d(e,{D:function(){return a}});var r,o,i=n(43254);(o=r||(r={}))[o.WhenToolEditable=0]="WhenToolEditable",o[o.WhenToolNotEditable=1]="WhenToolNotEditable",o[o.Always=2]="Always";class a{constructor(){this._isToolEditable=!0,this._manipulators=new i.Z,this._resourceContexts={manipulator3D:{}},this._attached=!1}set isToolEditable(t){this._isToolEditable=t}get length(){return this._manipulators.length}add(t,e=r.WhenToolEditable){this.addMany([t],e)}addMany(t,e=r.WhenToolEditable){for(const n of t){const t={manipulator:n,visibilityPredicate:e,attached:!1};this._manipulators.add(t),this._attached&&this._updateManipulatorAttachment(t)}}remove(t){for(let e=0;e<this._manipulators.length;e++)if(this._manipulators.at(e).manipulator===t){const t=this._manipulators.splice(e,1)[0];this._detachManipulator(t);break}}removeAll(){this._manipulators.forEach((t=>{this._detachManipulator(t)})),this._manipulators.removeAll()}attach(){this._manipulators.forEach((t=>{this._updateManipulatorAttachment(t)})),this._attached=!0}detach(){this._manipulators.forEach((t=>{this._detachManipulator(t)})),this._attached=!1}destroy(){this.detach(),this._manipulators.forEach((({manipulator:t})=>t.destroy())),this._manipulators.destroy(),this._resourceContexts=null}on(t,e){return this._manipulators.on(t,(t=>{e(t)}))}forEach(t){for(const e of this._manipulators.items)t(e)}some(t){return this._manipulators.items.some(t)}toArray(){const t=[];return this.forEach((e=>t.push(e.manipulator))),t}intersect(t,e){let n=null,r=Number.MAX_VALUE;return this._manipulators.forEach((({manipulator:o,attached:i})=>{if(!i||!o.interactive)return;const a=o.intersectionDistance(t,e);null!=a&&a<r&&(r=a,n=o)})),n}_updateManipulatorAttachment(t){this._isManipulatorItemVisible(t)?this._attachManipulator(t):this._detachManipulator(t)}_attachManipulator(t){t.attached||(t.manipulator.attach&&t.manipulator.attach(this._resourceContexts),t.attached=!0)}_detachManipulator(t){if(!t.attached)return;const e=t.manipulator;e.grabbing=!1,e.dragging=!1,e.hovering=!1,e.selected=!1,e.detach&&e.detach(this._resourceContexts),t.attached=!1}_isManipulatorItemVisible(t){return t.visibilityPredicate===r.Always||(this._isToolEditable?t.visibilityPredicate===r.WhenToolEditable:t.visibilityPredicate===r.WhenToolNotEditable)}}},69880:function(t,e,n){n.d(e,{$Q:function(){return f},AN:function(){return w},BS:function(){return O},Cf:function(){return g},M2:function(){return p},Mz:function(){return k},Xd:function(){return d},dJ:function(){return M},di:function(){return b},fW:function(){return v},hM:function(){return C},kY:function(){return S},uI:function(){return _},zh:function(){return E}});var r=n(3480),o=(n(61432),n(28947)),i=n(99574),a=n(96094),s=n(13132),l=n(52861),u=n(74774),c=n(51870),h=n(18208);function d(t,e){return t.events.on("drag",function(t,e){let n=null,r=null;return o=>{if("cancel"===o.action)return void(null!=r&&(r.execute({action:"cancel"}),n=null,r=null));const i={action:o.action,screenStart:o.start,screenEnd:o.screenPoint};"start"===o.action&&null==n&&(n=new C,r=new C,e(t,n,r,o.pointerType,i)),null!=n&&n.execute(i),"end"===o.action&&null!=n&&(n=null,r=null)}}(t,e))}function p(t,e){const n=[t.x,t.y,t.z??0],r=e,o=[Math.cos(r),Math.sin(r)],i=Math.sqrt(o[0]*o[0]+o[1]*o[1]);if(0===i)return null;o[0]/=i,o[1]/=i;const a=t=>{const e=(t.x-n[0])*o[0]+(t.y-n[1])*o[1];t.x=n[0]+e*o[0],t.y=n[1]+e*o[1]};return t=>(a(t.mapStart),a(t.mapEnd),{...t,axis:o})}function f(t){let e=null;return n=>{if("start"===n.action&&(e=function(t,e){const n=t.operations;if(!n)return null;const r=n.data.geometry,o=(0,u.D)(e);if(r.spatialReference.equals(o))return y(t,n,(()=>{}));if("mesh"!==r.type){const e=m(r,o);if(null==e)return null;const i=r.spatialReference;return y(t,h.c.fromGeometry(e,n.viewingMode),(()=>{const t=(0,s.project)(r,i);n.trySetGeometry(t)}))}if((0,l.QK)(r)){const e=m(r.origin,o);if(!e)return null;const i=r.spatialReference,a=h.c.fromGeometry(e,n.viewingMode);return y(t,n,(()=>{const t=(0,s.project)(a.data.geometry,i),e=t.x-r.origin.x,o=t.y-r.origin.y,l=(t.z??0)-(r.origin.z??0);n.move(e,o,l)}))}return null}(t,n.mapStart.spatialReference)),null==e)return null;const r=n.mapEnd.x-n.mapStart.x,o=n.mapEnd.y-n.mapStart.y,i=(n.mapEnd.z??0)-(n.mapStart.z??0);return e.move(r,o,i,n.action),{...n,translationX:r,translationY:o,translationZ:i}}}function m(t,e){return null==t?null:t.spatialReference.equals(e)?t.clone():(0,s.project)(t,e)}function y(t,e,n){let r=0,o=0,i=0;return{move:(a,s,l,u)=>{"start"===u&&(r=0,o=0,i=0);const c=a-r,h=s-o,d=l-i;e.move(c,h,d),r+=c,o+=h,i+=d,n(),"end"===u&&t.endInteraction?.()}}}function g(t,e=null,n){let r=null;const o=null==e||t.spatialReference?.equals(e)?t=>t:t=>null!=t?(0,s.project)(t,e):t,i={exclude:[],...n};return e=>{if("start"===e.action&&(r=o(t.toMap(e.screenStart,i))),null==r)return null;const n=o(t.toMap(e.screenEnd,i));return null!=n?{...e,mapStart:r,mapEnd:n}:null}}function v(t){const e=t.map((t=>f(t))).filter(r.pC);return t=>{const n=t.mapEnd.x-t.mapStart.x,r=t.mapEnd.y-t.mapStart.y,o=t.mapEnd.z-t.mapStart.z;return e.forEach((e=>e(t))),{...t,translationX:n,translationY:r,translationZ:o}}}function b(t,e){const n=new Map;for(const r of e)n.set(r,(0,o.d9)(t[r]));return e=>(n.forEach(((e,n)=>{t[n]=e})),e)}function _(t){const e=t.operations?.createResetState();return t=>(e?.remove(),t)}function M(t){const e=t.map((t=>_(t))).filter((t=>null!=t));return t=>(e.forEach((e=>e(t))),t)}function w(){let t=0,e=0,n=0;return r=>{"start"===r.action&&(t=r.mapStart.x,e=r.mapStart.y,n=r.mapStart.z);const o=r.mapEnd.x-t,i=r.mapEnd.y-e,a=r.mapEnd.z-n;return t=r.mapEnd.x,e=r.mapEnd.y,n=r.mapEnd.z,{...r,mapDeltaX:o,mapDeltaY:i,mapDeltaZ:a,mapDeltaSpatialReference:r.mapStart.spatialReference}}}function E(){let t=0,e=0;return n=>{"start"===n.action&&(t=n.screenStart.x,e=n.screenStart.y);const r=n.screenEnd.x-t,o=n.screenEnd.y-e;return t=n.screenEnd.x,e=n.screenEnd.y,{...n,screenDeltaX:r,screenDeltaY:o}}}function S(t,e){let n=null,r=0,o=0;return s=>{if("start"===s.action&&(n=t.toScreen?.(e),null!=n&&(n.x<0||n.x>t.width||n.y<0||n.y>t.height?n=null:(r=s.screenStart.x-n.x,o=s.screenStart.y-n.y))),null==n)return null;const l=(0,i.uZ)(s.screenEnd.x-r,0,t.width),u=(0,i.uZ)(s.screenEnd.y-o,0,t.height),c=(0,a.vW)(l,u);return s.screenStart=n,s.screenEnd=c,s}}const x=()=>{};class C{constructor(){this.execute=x}next(t,e=new C){return null!=t&&(this.execute=n=>{const r=t(n);null!=r&&e.execute(r)}),e}}function O(t,e,n=[]){if("2d"===t.type)return t=>t;let r=null;return o=>{"start"===o.action&&(r=t.toMap(o.screenStart,{exclude:n}),null!=r&&(r.z=(0,c.Ou)(r,t,e)));const i=t.toMap(o.screenEnd,{exclude:n});null!=i&&(i.z=(0,c.Ou)(i,t,e));const a=null!=r&&null!=i?{sceneStart:r,sceneEnd:i}:null;return{...o,scenePoints:a}}}function T(t,e,n){const r=e.elevationProvider.getElevation(t.x,t.y,t.z??0,t.spatialReference,"scene")??0,o=(0,u.WG)(t);return o.z=r,o.hasZ=!0,o.z=(0,c.Ou)(o,e,n),o}function k(t,e){if("2d"===t.type)return t=>t;let n=null;return r=>{"start"===r.action&&(n=T(r.mapStart,t,e));const o=T(r.mapEnd,t,e),i=null!=n&&null!=o?{sceneStart:n,sceneEnd:o}:null;return{...r,scenePoints:i}}}},39018:function(t,e,n){n.d(e,{N:function(){return r}});class r{constructor(t){this.vertexHandle=null,this.excludeFeature=null,this.visualizer=null,this.selfSnappingZ=null,this.drawConstraints=null,this.editGeometryOperations=t.editGeometryOperations,this.elevationInfo=t.elevationInfo,this.pointer=t.pointer,this.vertexHandle=t.vertexHandle,this.excludeFeature=t.excludeFeature,this.feature=t.feature,this.visualizer=t.visualizer,this.selfSnappingZ=t.selfSnappingZ,this.drawConstraints=t.drawConstraints}get coordinateHelper(){return this.editGeometryOperations.data.coordinateHelper}get spatialReference(){return this.coordinateHelper.spatialReference}}},23111:function(t,e,n){n.d(e,{W:function(){return d}});var r=n(61100),o=n(93568),i=n(90403),a=n(61418),s=n(74774),l=n(51870),u=n(69880),c=n(39018),h=n(50399);function d({predicate:t=(()=>!0),snappingManager:e,snappingContext:n,updatingHandles:s,useZ:d=!0}){const g=new u.hM;if(null==e)return{snappingStep:[y,g],cancelSnapping:y};let v,b=null,_=null,M=null;const w=()=>{b=(0,r.IM)(b),e.doneSnapping(),_?.frameTask.remove(),_=null,v=(0,r.hw)(v),M=null},E=(S=e,x=d,C=g,(0,o.Ds)((async({frameTask:t,point:e,scenePoint:n,context:r,event:o,delta:i,getLastState:s},l)=>{const u=await t.schedule((()=>S.snap({point:e,scenePoint:n,context:r,signal:l})),l);if(u.valid){let n=await t.schedule((()=>u.apply()),l);const c=s();null!=c.point&&e!==c.point&&(n=S.update({point:c.point,scenePoint:c.scenePoint,context:r})),null!=c.updatePoint&&(0,a.kg)(n,c.updatePoint)||(m(o.mapEnd,n,i,x),C.execute(o))}})));var S,x,C;let O=null,T=null,k=null;return{snappingStep:[r=>{if(!t(r))return r;const{action:a}=r;if("start"===a){const{info:t}=r,o=function(t){return"3d"===t.type?t.resourceController.scheduler.registerTask(h.T8.SNAPPING):h.sq}(e.view);if(_=function(t,e,n){return{context:new c.N({editGeometryOperations:t.editGeometryOperations,elevationInfo:t.elevationInfo,pointer:t.pointer,vertexHandle:null!=e.info?e.info.handle:null,excludeFeature:t.excludeFeature,feature:t.feature,visualizer:t.visualizer}),originalPos:null!=e.snapOrigin?t.coordinateHelper.vectorToDehydratedPoint(e.snapOrigin):e.mapStart,originalScenePos:null!=e.scenePoints?e.scenePoints.sceneStart:null,frameTask:n}}(n,r,o),_.context.selfSnappingZ=null,!d&&null!=t){const e=function(t,e){if(!t.hasZ())return null;const n=e.vertices;let r=null;for(const e of n){const n=t.getZ(e.pos);if(null!=r&&null!=n&&Math.abs(n-r)>1e-6)return null;null==r&&(r=n)}return r}(n.coordinateHelper,t.handle.component);null!=e&&(_.context.selfSnappingZ={value:e,elevationInfo:n.elevationInfo??l.jG})}}if(null!=_){const{context:t,originalScenePos:n,originalPos:l}=_,{mapEnd:u,mapStart:c,scenePoints:h}=r,y=p(l,f(u,c)),g=f(c,l),w={...r,action:"update"},S=_.context,x=function(t,e){return null==t||null==e?null:p(t,f(e.sceneEnd,e.sceneStart))}(n,h),C=e.update({point:y,scenePoint:x,context:t});if(k=C,m(u,C,g,d),O=y,T=x,"end"!==a){const{frameTask:t}=_;null==b&&(b=new AbortController),M=e=>{s.addPromise((0,o.R8)(E({frameTask:t,event:w,context:S,point:y,scenePoint:x,delta:g,getLastState:()=>({point:O,scenePoint:T,updatePoint:e.forceUpdate?null:k})},b.signal)))},M({forceUpdate:!1}),null==v&&(v=(0,i.YP)((()=>e.options.effectiveEnabled),(()=>M?.({forceUpdate:!0}))))}}return"end"===a&&w(),r},g],cancelSnapping:t=>(w(),t)}}function p(t,[e,n,r]){const o=(0,s.WG)(t);return o.x+=e,o.y+=n,o.hasZ&&(o.z+=r),o}function f(t,e){const n=t.hasZ&&e.hasZ?t.z-e.z:0;return[t.x-e.x,t.y-e.y,n]}function m(t,e,[n,r,o],i){t.x=e.x+n,t.y=e.y+r,i&&t.hasZ&&e.hasZ&&(t.z=e.z+o)}function y(t){return t}}}]);