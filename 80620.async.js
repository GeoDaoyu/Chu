"use strict";(self.webpackChunkscene_pro=self.webpackChunkscene_pro||[]).push([[80620,17623,66882],{92643:function(e,n,t){t.d(n,{Ch:function(){return H},EX:function(){return P},G:function(){return L},H0:function(){return V},Ht:function(){return E},K6:function(){return S},O:function(){return A},WC:function(){return T},Y3:function(){return I},_Y:function(){return w},_j:function(){return N},c9:function(){return z},gp:function(){return R},jQ:function(){return u},mj:function(){return Z},nR:function(){return F},sJ:function(){return k},vG:function(){return G},xr:function(){return C}});var r=t(53147),o=t(3480),i=t(28947),s=t(99574),c=t(73749),a=t(27583);function u(e){return"r"in e&&"g"in e&&"b"in e}function l(e){return"h"in e&&"s"in e&&"v"in e}function f(e){return"l"in e&&"a"in e&&"b"in e}function p(e){return"l"in e&&"c"in e&&"h"in e}const h=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],m=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function g(e,n){const t=[];let r,o;if(e[0].length!==n.length)throw new Error("dimensions do not match");const i=e.length,s=e[0].length;let c=0;for(r=0;r<i;r++){for(c=0,o=0;o<s;o++)c+=e[r][o]*n[o];t.push(c)}return t}function d(e){const n=[e.r/255,e.g/255,e.b/255].map((e=>e<=.04045?e/12.92:((e+.055)/1.055)**2.4)),t=g(h,n);return{x:100*t[0],y:100*t[1],z:100*t[2]}}function y(e){const n=g(m,[e.x/100,e.y/100,e.z/100]).map((e=>{const n=e<=.0031308?12.92*e:1.055*e**(1/2.4)-.055;return Math.min(1,Math.max(n,0))}));return{r:Math.round(255*n[0]),g:Math.round(255*n[1]),b:Math.round(255*n[2])}}function M(e){const n=[e.x/95.047,e.y/100,e.z/108.883].map((e=>e>(6/29)**3?e**(1/3):1/3*(29/6)**2*e+4/29));return{l:116*n[1]-16,a:500*(n[0]-n[1]),b:200*(n[1]-n[2])}}function b(e){const n=e.l,t=[(n+16)/116+e.a/500,(n+16)/116,(n+16)/116-e.b/200].map((e=>e>6/29?e**3:3*(6/29)**2*(e-4/29)));return{x:95.047*t[0],y:100*t[1],z:108.883*t[2]}}function v(e){return function(e){const n=e.l,t=e.a,r=e.b,o=Math.sqrt(t*t+r*r);let i=Math.atan2(r,t);return i=i>0?i:i+2*Math.PI,{l:n,c:o,h:i}}(M(d(e)))}function x(e){return y(b(function(e){const n=e.l,t=e.c,r=e.h;return{l:n,a:t*Math.cos(r),b:t*Math.sin(r)}}(e)))}function C(e){return u(e)?e:p(e)?x(e):f(e)?function(e){return y(b(e))}(e):function(e){return"x"in e&&"y"in e&&"z"in e}(e)?y(e):l(e)?function(e){const n=(e.h+360)%360/60,t=e.s/100,r=e.v/100*255,o=r*t,i=o*(1-Math.abs(n%2-1));let s;switch(Math.floor(n)){case 0:s={r:o,g:i,b:0};break;case 1:s={r:i,g:o,b:0};break;case 2:s={r:0,g:o,b:i};break;case 3:s={r:0,g:i,b:o};break;case 4:s={r:i,g:0,b:o};break;case 5:case 6:s={r:o,g:0,b:i};break;default:s={r:0,g:0,b:0}}return s.r=Math.round(s.r+r-o),s.g=Math.round(s.g+r-o),s.b=Math.round(s.b+r-o),s}(e):e}function w(e){return l(e)?e:function(e){const n=e.r,t=e.g,r=e.b,o=Math.max(n,t,r),i=o-Math.min(n,t,r);let s=o,c=0===i?0:o===n?(t-r)/i%6:o===t?(r-n)/i+2:(n-t)/i+4,a=0===i?0:i/s;return c<0&&(c+=6),c*=60,a*=100,s*=100/255,{h:c,s:a,v:s}}(C(e))}function I(e){return f(e)?e:function(e){return M(d(e))}(C(e))}function k(e){return p(e)?e:v(C(e))}function O(e){let{r:n,g:t,b:o,a:i}=e;return i<1&&(n=Math.round(i*n+255*(1-i)),t=Math.round(i*t+255*(1-i)),o=Math.round(i*o+255*(1-i))),new r.Z({r:n,g:t,b:o})}function P(e,n){const{r:t,g:r,b:o}=n?.ignoreAlpha?e:O(e);return.2126*t+.7152*r+.0722*o}var S;function Z(e,n=S.High){return P(e,{ignoreAlpha:!0})>n?new r.Z([0,0,0,e.a]):new r.Z([255,255,255,e.a])}function N(e,n){const t=I(e);t.l*=1-n;const r=C(t),o=e.clone();return o.setColor(r),o.a=e.a,o}function L(e,n){const t=e.clone();return t.a*=n,t}function G(e,n){const t=w(e);t.s*=n;const r=C(t),o=e.clone();return o.setColor(r),o.a=e.a,o}function A(e){return r.Z.toUnitRGBA(e)}function T(e,n){return e===n||null!=e&&e.equals(n)}function E(e,n){return e===n||null!=e&&null!=n&&(0,c.e)(e,n)}function R(e){return(0,a.al)(e[0],e[1],e[2],e.length>3?e[3]:1)}function z(e){return e[0]??=0,e[1]??=0,e[2]??=0,e}function F(e){return e.length=4,z(e),e[3]??=1,(0,s.uZ)(e[3],0,1),e}function H(e,n){const t=r.Z.toUnitRGBA(e);return t[3]*=n,t}function V(e,n,t={}){if(0===e.length||n<=0)return[];if(1===(e=e.map((e=>"string"==typeof e?new r.Z(e):e))).length||1===n){const t=[],r=e[0];for(let e=0;e<n;e++)t.push(r.clone());return t}if(t.shuffle&&(e=(0,o.TV)((0,i.d9)(e),t.seed)),e.length>=n){const t=[],r=(e.length-1)/(n-1);for(let o=0;o<n;o++){const n=Math.round(o*r);t.push(e[n].clone())}return t}return function(e,n,t={}){const r=[],i=e.length-1,s=Math.ceil((n-e.length)/i);e:for(let o=0;o<i;o++){const i=e[o],c=e[o+1];for(let o=1;o<=s;o++){const a=o/(s+1);if(r.push(D(i,c,a,t)),r.length+e.length===n)break e}}return[...e.map((e=>e.clone())),...(0,o.TV)(r,t.seed??1)]}(e,n,t)}!function(e){e[e.Low=160]="Low",e[e.High=225]="High"}(S||(S={}));const _=(e,n)=>{const t=Math.floor(10*n())-5;return Math.min(255,Math.max(0,e+t))};function D(e,n,t,i={}){const s=e.r,c=e.g,a=e.b,u=n.r,l=n.g,f=n.b,p=Math.round(s+(u-s)*t),h=Math.round(c+(l-c)*t),m=Math.round(a+(f-a)*t);if(!i.offset)return new r.Z([p,h,m]);const g=(0,o.FS)(i.seed);return new r.Z([_(p,g),_(h,g),_(m,g)])}},96610:function(e,n,t){t.d(n,{G6:function(){return N},IN:function(){return s},Ie:function(){return Z},J9:function(){return P},Jd:function(){return i},Kq:function(){return k},RF:function(){return I},U1:function(){return S},oh:function(){return o},s9:function(){return O},vY:function(){return r}});t(90756);function r(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance,1,1]:[1,1,1,1],translate:null!=e.extent?[e.extent.xmin,e.extent.ymax,e.extent.zmin??0,e.extent.mmin??0]:[0,0,0,0]}:null}function o(e){if(function(e){return"lowerLeft"===e.originPosition&&4===e.scale.length&&4===e.translate.length}(e))return e;const{originPosition:n,scale:t,translate:r}=e,o=t[0]??1,i=t[1]??1;return{originPosition:"lowerLeft",scale:[o,"lowerLeft"===n?i:-i,t[2]??1,t[3]??1],translate:[r[0]??0,r[1]??0,r[2]??0,r[3]??0]}}function i({scale:e,translate:n},t){return Math.round((t-n[0])/e[0])}function s({scale:e,translate:n},t){return Math.round((t-n[1])/e[1])}function c({scale:e,translate:n},t){return Math.round(((t??0)-n[2])/e[2])}function a({scale:e,translate:n},t){return t?Math.round((t-n[3])/e[3]):0}function u(e,n){return e&&n?h:e&&!n?f:!e&&n?p:l}const l=(e,n)=>{const t=[];if(!n.length)return null;const r=n[0];let o=i(e,r[0]),c=s(e,r[1]);t.push([o,c]);for(let r=1;r<n.length;r++){const[a,u]=n[r],l=i(e,a),f=s(e,u);l===o&&f===c||t.push([l-o,f-c]),o=l,c=f}return t},f=(e,n)=>{const t=[];if(!n.length)return null;const r=n[0];let o=i(e,r[0]),a=s(e,r[1]),u=c(e,r[2]);t.push([o,a,u]);for(let r=1;r<n.length;r++){const[l,f,p]=n[r],h=i(e,l),m=s(e,f),g=c(e,p);h===o&&m===a&&g===u||t.push([h-o,m-a,g]),o=h,a=m,u=g}return t},p=(e,n)=>{const t=[];if(!n.length)return null;const r=n[0];let o=i(e,r[0]),c=s(e,r[1]),u=a(e,r[2]);t.push([o,c,u]);for(let r=1;r<n.length;r++){const[l,f,p]=n[r],h=i(e,l),m=s(e,f),g=a(e,p);h===o&&m===c&&g===u||t.push([h-o,m-c,g]),o=h,c=m,u=g}return t},h=(e,n)=>{const t=[];if(!n.length)return null;const r=n[0];let o=i(e,r[0]),u=s(e,r[1]),l=c(e,r[2]),f=a(e,r[3]);t.push([o,u,l,f]);for(let r=1;r<n.length;r++){const[p,h,m,g]=n[r],d=i(e,p),y=s(e,h),M=c(e,m),b=a(e,g);d===o&&y===u&&M===l&&b===f||t.push([d-o,y-u,M,b]),o=d,u=y,l=M,f=b}return t};function m({scale:e,translate:n},t){return t*e[0]+n[0]}function g({scale:e,translate:n},t){return t*e[1]+n[1]}function d({scale:e,translate:n},t){return(t??0)*e[2]+n[2]}function y({scale:e,translate:n},t){return t?t*e[3]+n[3]:0}function M(e,n){return e&&n?C:e&&!n?v:!e&&n?x:b}const b=(e,n)=>{const t=new Array(n.length);if(!n.length)return t;const r=n[0];let o=m(e,r[0]),i=g(e,r[1]);t[0]=[o,i];const{scale:s,originPosition:c}=e,a=s[0],u="lowerLeft"===c?s[1]:-s[1];for(let e=1;e<n.length;e++){const[r,s]=n[e];o+=a*r,i+=u*s,t[e]=[o,i]}return t},v=(e,n)=>{const t=new Array(n.length);if(!n.length)return t;const r=n[0];let o=m(e,r[0]),i=g(e,r[1]);t[0]=[o,i,d(e,r[2])];const{scale:s,originPosition:c}=e,a=s[0],u="lowerLeft"===c?s[1]:-s[1];for(let r=1;r<n.length;r++){const[s,c,l]=n[r];o+=a*s,i+=u*c,t[r]=[o,i,d(e,l)]}return t},x=(e,n)=>{const t=new Array(n.length);if(!n.length)return t;const r=n[0];let o=m(e,r[0]),i=g(e,r[1]);t[0]=[o,i,y(e,r[2])];const{scale:s,originPosition:c}=e,a=s[0],u="lowerLeft"===c?s[1]:-s[1];for(let r=1;r<n.length;r++){const[s,c,l]=n[r];o+=a*s,i+=u*c,t[r]=[o,i,y(e,l)]}return t},C=(e,n)=>{const t=new Array(n.length);if(!n.length)return t;const r=n[0];let o=m(e,r[0]),i=g(e,r[1]);t[0]=[o,i,d(e,r[2]),y(e,r[3])];const{scale:s,originPosition:c}=e,a=s[0],u="lowerLeft"===c?s[1]:-s[1];for(let r=1;r<n.length;r++){const[s,c,l,f]=n[r];o+=a*s,i+=u*c,t[r]=[o,i,d(e,l),y(e,f)]}return t};function w(e,n,t){const r=new Array(t.length);for(let o=0;o<t.length;o++)r[o]=n(e,t[o]);return r}function I(e,n,t){const r=o(e);return n.x=i(r,t.x),n.y=s(r,t.y),null!=t.z&&(n.z=c(r,t.z)),null!=t.m&&(n.m=a(r,t.m)),n}function k(e,n,t){const r=function(e,n,t,r){const o=[],i=u(t,r);for(let t=0;t<n.length;t++){const r=i(e,n[t]);r&&r.length>=3&&o.push(r)}return o.length?o:null}(o(e),t.rings,t.hasZ,t.hasM);return r?(n.rings=r,n.hasZ=t.hasZ??!1,n.hasM=t.hasM??!1,n):null}function O(e,n,t){const r=function(e,n,t,r){const o=[],i=u(t,r);for(let t=0;t<n.length;t++){const r=i(e,n[t]);r&&r.length>=2&&o.push(r)}return o.length?o:null}(o(e),t.paths,t.hasZ,t.hasM);return r?(n.paths=r,n.hasZ=t.hasZ??!1,n.hasM=t.hasM??!1,n):null}function P(e,n,t,r=t?.hasZ??!1,i=t?.hasM??!1){if(null!=t){const s=o(e);n.points=M(r,i)(s,t.points),n.hasZ=r,n.hasM=i}return n}function S(e,n,t,r=null!=t?.z,i=null!=t?.m){if(null==t)return n;const s=o(e);return n.x=m(s,t.x),n.y=g(s,t.y),r&&(n.z=d(s,t.z)),i&&(n.m=y(s,t.m)),n}function Z(e,n,t,r=t?.hasZ??!1,i=t?.hasM??!1){if(null!=t){const s=o(e);n.rings=w(s,M(r,i),t.rings),n.hasZ=r,n.hasM=i}return n}function N(e,n,t,r=t?.hasZ??!1,i=t?.hasM??!1){if(null!=t){const s=o(e);n.paths=w(s,M(r,i),t.paths),n.hasZ=r,n.hasM=i}return n}},17623:function(e,n,t){t.d(n,{OverrideHelper:function(){return f}});var r=t(53147),o=t(92643),i=t(28947),s=t(299),c=t(15065),a=t(61421),u=t(66882);const l=e=>{if(!e)return[0,0,0,0];const{r:n,g:t,b:r,a:o}=e;return[n,t,r,255*o]};class f{static findApplicableOverrides(e,n,t){if(e&&n){if(e.primitiveName){let r=!1;for(const n of t)if(n.primitiveName===e.primitiveName){r=!0;break}if(!r)for(const r of n)r.primitiveName===e.primitiveName&&t.push(r)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const r of e.effects)f.findApplicableOverrides(r,n,t);if(e.symbolLayers)for(const r of e.symbolLayers)f.findApplicableOverrides(r,n,t);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(e.effects)for(const r of e.effects)f.findApplicableOverrides(r,n,t);if(e.markerPlacement&&f.findApplicableOverrides(e.markerPlacement,n,t),"CIMVectorMarker"===e.type){if(e.markerGraphics)for(const r of e.markerGraphics)f.findApplicableOverrides(r,n,t),f.findApplicableOverrides(r.symbol,n,t)}else"CIMCharacterMarker"===e.type?f.findApplicableOverrides(e.symbol,n,t):"CIMHatchFill"===e.type?f.findApplicableOverrides(e.lineSymbol,n,t):"CIMPictureMarker"===e.type&&f.findApplicableOverrides(e.animatedSymbolProperties,n,t)}}}static findEffectOverrides(e,n){if(!e)return null;if("CIMGeometricEffectDashes"===e.type&&(0,a.hU)(e),!n||!e.primitiveName)return{type:"cim-effect-param",effect:e,overrides:[]};const t=(0,a.Ml)(e),r=e.primitiveName,o=[];for(const e of n)e.primitiveName===r&&o.push((0,a.Ml)(e));return{type:"cim-effect-param",effect:t,overrides:(0,a.Ul)(o)}}static async resolveSymbolOverrides(e,n,t,r,o,c,u){if(!e?.symbol)return null;let{symbol:l,primitiveOverrides:p}=e;const h=!!p;if(!h&&!r)return l;l=(0,i.d9)(l),p=(0,i.d9)(p);let m=!0;if(n||(n={attributes:{}},m=!1),h){if(m||(p=p.filter((e=>!e.valueExpressionInfo?.expression.includes("$feature")))),u||(p=p.filter((e=>!e.valueExpressionInfo?.expression.includes("$view")))),p.length>0){const e=(0,a.Qf)(n.attributes),r={spatialReference:t,fields:e,geometryType:o};await f.createRenderExpressions(p,r),f.evaluateOverrides(p,n,o??"esriGeometryPoint",c,u,new s.Z(e))}f.applyOverrides(l,p)}return r&&f.applyDictionaryTextOverrides(l,n,r,null),l}static{this._expressionToRenderExpression=new Map}static async createRenderExpressions(e,n){const t=[];for(const r of e){const e=r.valueExpressionInfo;if(!e||f._expressionToRenderExpression.has(e.expression))continue;const o=(0,c.Yi)(e.expression,n.spatialReference);t.push(o),o.then((n=>f._expressionToRenderExpression.set(e.expression,n)))}t.length>0&&await Promise.all(t)}static evaluateOverrides(e,n,t,r,i,s){const c={$view:{scale:i?.scale}};for(const i of e){i.value&&"object"==typeof i.value&&(0,o.jQ)(i.value)&&("Color"===i.propertyName||"StrokeColor"===i.propertyName)&&(i.value=l(i.value));const e=i.valueExpressionInfo;if(!e)continue;const a=f._expressionToRenderExpression.get(e.expression);a&&(i.value=(0,u.default)(a,n,c,t,s,r))}}static applyDictionaryTextOverrides(e,n,t,r,o="Normal"){if(e?.type)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const i=e.symbolLayers;if(!i)return;for(const s of i)s&&"CIMVectorMarker"===s.type&&f.applyDictionaryTextOverrides(s,n,t,r,"CIMTextSymbol"===e.type?e.textCase:o)}break;case"CIMVectorMarker":{const o=e.markerGraphics;if(!o)return;for(const e of o)e&&f.applyDictionaryTextOverrides(e,n,t,r)}break;case"CIMMarkerGraphic":{const i=e.textString;if(i&&i.includes("[")){const s=(0,a.H1)(i,t);e.textString=(0,a.E_)(n,s,r,o)}}}}static applyOverrides(e,n,t,r){if(e.primitiveName)for(const o of n)if(o.primitiveName===e.primitiveName){const n=(0,a.Le)(o.propertyName);if(r&&r.push({cim:e,nocapPropertyName:n,value:e[n]}),t){let n=!1;for(const r of t)r.primitiveName===e.primitiveName&&(n=!0);n||t.push(o)}null!=o.value&&(e[n]=o.value)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const o of e.effects)f.applyOverrides(o,n,t,r);if(e.symbolLayers)for(const o of e.symbolLayers)f.applyOverrides(o,n,t,r);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(e.effects)for(const o of e.effects)f.applyOverrides(o,n,t,r);if("CIMVectorMarker"===e.type&&e.markerGraphics)for(const o of e.markerGraphics)f.applyOverrides(o,n,t,r),f.applyOverrides(o.symbol,n,t,r)}}static restoreOverrides(e){for(const n of e)n.cim[n.nocapPropertyName]=n.value}static buildOverrideKey(e){let n="";for(const t of e)void 0!==t.value&&(n+=`${t.primitiveName}${t.propertyName}${JSON.stringify(t.value)}`);return n}static toValue(e,n){if("DashTemplate"===e)return n.split(" ").map((e=>Number(e)));if("Color"===e){const e=new r.Z(n).toRgba();return e[3]*=255,e}return n}}},66882:function(e,n,t){t.d(n,{default:function(){return s}});var r=t(88194),o=t(96711),i=t(96610);function s(e,n,t,r,i,s){if(null==e)return null;const c=e.references("geometry")&&s?a(n,r,s):n,u=e.repurposeFeature(c,i);try{return e.evaluate(u,t)}catch(e){return o.Z.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",e),null}}const c=new Map;function a(e,n,t){const{transform:s,hasZ:a,hasM:u}=t;c.has(n)||c.set(n,function(e){const n={};switch(e){case"esriGeometryPoint":return(e,t,r,o)=>(0,i.U1)(t,n,e,r,o);case"esriGeometryPolygon":return(e,t,r,o)=>(0,i.Ie)(t,n,e,r,o);case"esriGeometryPolyline":return(e,t,r,o)=>(0,i.G6)(t,n,e,r,o);case"esriGeometryMultipoint":return(e,t,r,o)=>(0,i.J9)(t,n,e,r,o);default:return o.Z.getLogger("esri.views.2d.support.arcadeOnDemand").error(new r.Z("mapview-arcade",`Unable to handle geometryType: ${e}`)),e=>e}}(n));const l=c.get(n)(e.geometry,s,a,u);return{...e,geometry:l}}}}]);