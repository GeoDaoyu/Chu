"use strict";(self.webpackChunkscene_pro=self.webpackChunkscene_pro||[]).push([[5431,61637,26344,22679,38308,58086,75014,50857,6915],{78958:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(95051),r=i(44194),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"border",theme:"outlined"},o=i(43638),a=function(e,t){return r.createElement(o.Z,(0,n.Z)({},e,{ref:t,icon:s}))};var l=r.forwardRef(a)},98601:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(95051),r=i(44194),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 476H152c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0-166h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 498h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0-664h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 498h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM650 216h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm56 592h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm-332 0h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm-56-592h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-166 0h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm332 0h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zM208 808h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm332 0h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM152 382h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm332 0h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zM208 642h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm332 0h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"border-verticle",theme:"outlined"},o=i(43638),a=function(e,t){return r.createElement(o.Z,(0,n.Z)({},e,{ref:t,icon:s}))};var l=r.forwardRef(a)},45703:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(95051),r=i(44194),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"},o=i(43638),a=function(e,t){return r.createElement(o.Z,(0,n.Z)({},e,{ref:t,icon:s}))};var l=r.forwardRef(a)},214:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(95051),r=i(44194),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 476H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"line",theme:"outlined"},o=i(43638),a=function(e,t){return r.createElement(o.Z,(0,n.Z)({},e,{ref:t,icon:s}))};var l=r.forwardRef(a)},39493:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(95051),r=i(44194),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M952 792H72c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h880c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0-632H72c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h880c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM608 660c8.8 0 16-7.2 16-16V380c0-8.8-7.2-16-16-16H96c-8.8 0-16 7.2-16 16v264c0 8.8 7.2 16 16 16h512zM152 436h400v152H152V436zm552 210c0 4.4 3.6 8 8 8h224c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H712c-4.4 0-8 3.6-8 8v56zm8-204h224c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H712c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8z"}}]},name:"pic-left",theme:"outlined"},o=i(43638),a=function(e,t){return r.createElement(o.Z,(0,n.Z)({},e,{ref:t,icon:s}))};var l=r.forwardRef(a)},56529:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(95051),r=i(44194),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"},o=i(43638),a=function(e,t){return r.createElement(o.Z,(0,n.Z)({},e,{ref:t,icon:s}))};var l=r.forwardRef(a)},13522:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(95051),r=i(44194),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 747H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM165.7 621.8l39.7 39.5c3.1 3.1 8.2 3.1 11.3 0l234.7-233.9 97.6 97.3a32.11 32.11 0 0045.2 0l264.2-263.2c3.1-3.1 3.1-8.2 0-11.3l-39.7-39.6a8.03 8.03 0 00-11.3 0l-235.7 235-97.7-97.3a32.11 32.11 0 00-45.2 0L165.7 610.5a7.94 7.94 0 000 11.3z"}}]},name:"stock",theme:"outlined"},o=i(43638),a=function(e,t){return r.createElement(o.Z,(0,n.Z)({},e,{ref:t,icon:s}))};var l=r.forwardRef(a)},93532:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(95051),r=i(44194),s={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M548 818v126a16 16 0 01-16 16h-40a16 16 0 01-16-16V818c15.85 1.64 27.84 2.46 36 2.46 8.15 0 20.16-.82 36-2.46m205.25-115.66l89.1 89.1a16 16 0 010 22.62l-28.29 28.29a16 16 0 01-22.62 0l-89.1-89.1c12.37-10.04 21.43-17.95 27.2-23.71 5.76-5.77 13.67-14.84 23.71-27.2m-482.5 0c10.04 12.36 17.95 21.43 23.71 27.2 5.77 5.76 14.84 13.67 27.2 23.71l-89.1 89.1a16 16 0 01-22.62 0l-28.29-28.29a16 16 0 010-22.63zM512 278c129.24 0 234 104.77 234 234S641.24 746 512 746 278 641.24 278 512s104.77-234 234-234m0 72c-89.47 0-162 72.53-162 162s72.53 162 162 162 162-72.53 162-162-72.53-162-162-162M206 476c-1.64 15.85-2.46 27.84-2.46 36 0 8.15.82 20.16 2.46 36H80a16 16 0 01-16-16v-40a16 16 0 0116-16zm738 0a16 16 0 0116 16v40a16 16 0 01-16 16H818c1.64-15.85 2.46-27.84 2.46-36 0-8.15-.82-20.16-2.46-36zM814.06 180.65l28.29 28.29a16 16 0 010 22.63l-89.1 89.09c-10.04-12.37-17.95-21.43-23.71-27.2-5.77-5.76-14.84-13.67-27.2-23.71l89.1-89.1a16 16 0 0122.62 0m-581.5 0l89.1 89.1c-12.37 10.04-21.43 17.95-27.2 23.71-5.76 5.77-13.67 14.84-23.71 27.2l-89.1-89.1a16 16 0 010-22.62l28.29-28.29a16 16 0 0122.62 0M532 64a16 16 0 0116 16v126c-15.85-1.64-27.84-2.46-36-2.46-8.15 0-20.16.82-36 2.46V80a16 16 0 0116-16z"}}]},name:"sun",theme:"outlined"},o=i(43638),a=function(e,t){return r.createElement(o.Z,(0,n.Z)({},e,{ref:t,icon:s}))};var l=r.forwardRef(a)},65475:function(e,t,i){i.d(t,{Z:function(){return p}});var n=i(73440),r=i(89314),s=i(17155),o=(i(61432),i(96711),i(83850),i(48023));let a=class extends r.Z{constructor(e){super(e),this.type="web-scene"}equals(e){return this.type===e.type}};(0,n._)([(0,s.Cb)()],a.prototype,"type",void 0),a=(0,n._)([(0,o.j)("esri.analysis.support.AnalysisOriginWebScene")],a);const l=a;var c=i(70880),u=i(15894),d=i(63255);let h=0,p=class extends(d.Z.JSONSupportMixin(r.Z.ClonableMixin(u.Z.IdentifiableMixin(c.Z)))){constructor(e){super(e),this.id=`${Date.now().toString(16)}-analysis-${h++}`,this.origin=null}get parent(){return this._get("parent")}set parent(e){const t=this.parent;if(null!=t)switch(t.type){case"line-of-sight":case"dimension":case"viewshed":t.releaseAnalysis(this);break;case"2d":case"3d":t.analyses.includes(this)&&t.analyses.remove(this)}this._set("parent",e)}equals(e){return!0}};(0,n._)([(0,s.Cb)({type:String,constructOnly:!0,clonable:!1})],p.prototype,"id",void 0),(0,n._)([(0,s.Cb)({clonable:!1,value:null})],p.prototype,"parent",null),(0,n._)([(0,s.Cb)({types:{key:"type",base:null,typeMap:{"web-scene":l}}})],p.prototype,"origin",void 0),p=(0,n._)([(0,o.j)("esri.analysis.Analysis")],p)},51741:function(e,t,i){i.d(t,{Z:function(){return y}});var n=i(73440),r=i(65475),s=i(49052),o=i(99965),a=i(3480),l=i(43254),c=i(41145),u=i(61100),d=i(90403),h=i(17155),p=(i(61432),i(96711),i(48023)),m=i(13132),f=i(16447),v=i(51870);const g=l.Z.ofType(o.Z);let y=class extends r.Z{constructor(e){super(e),this.type="line-of-sight",this.observer=null,this.extent=null}initialize(){this.addHandles((0,d.YP)((()=>this._computeExtent()),(e=>{null==e?.pending&&this._set("extent",null!=e?e.extent:null)}),d.tX))}get targets(){return this._get("targets")||new g}set targets(e){this._set("targets",(0,c.Z)(e,this.targets,g))}get spatialReference(){return null!=this.observer?.position?this.observer.position.spatialReference:null}get valid(){return null!=this.observer?.position}async waitComputeExtent(){const e=this._computeExtent();return null!=e?e.pending:Promise.resolve()}_computeExtent(){const e=this.spatialReference;if(null==this.observer?.position||null==e)return null;const t=e=>"absolute-height"===(0,v.VW)(e.position,e.elevationInfo),i=this.observer.position,n=(0,f.al)(i.x,i.y,i.z,i.x,i.y,i.z);for(const t of this.targets)if(null!=t.position){const i=(0,m.projectOrLoad)(t.position,e);if(null!=i.pending)return{pending:i.pending,extent:null};if(null!=i.geometry){const{x:e,y:t,z:r}=i.geometry;(0,f.pp)(n,[e,t,r])}}const r=(0,f.HH)(n,e);return t(this.observer)&&this.targets.every(t)||(r.zmin=void 0,r.zmax=void 0),{pending:null,extent:r}}clear(){this.observer=null,this.targets.removeAll()}equals(e){return this===e||super.equals(e)&&(0,u._W)(this.observer,e.observer)&&(0,a.fS)(this.targets.toArray(),e.targets.toArray(),((e,t)=>e.equals(t)))}};(0,n._)([(0,h.Cb)({type:["line-of-sight"]})],y.prototype,"type",void 0),(0,n._)([(0,h.Cb)({type:s.Z,json:{read:!0,write:!0}})],y.prototype,"observer",void 0),(0,n._)([(0,h.Cb)({cast:c.R,type:g,nonNullable:!0,json:{read:!0,write:!0}})],y.prototype,"targets",null),(0,n._)([(0,h.Cb)({value:null,readOnly:!0})],y.prototype,"extent",void 0),(0,n._)([(0,h.Cb)()],y.prototype,"spatialReference",null),(0,n._)([(0,h.Cb)({readOnly:!0})],y.prototype,"valid",null),y=(0,n._)([(0,p.j)("esri.analysis.LineOfSightAnalysis")],y)},49052:function(e,t,i){i.d(t,{Z:function(){return f}});var n=i(73440),r=i(37877),s=i(70880),o=i(89314),a=i(63255),l=i(61100),c=i(17155),u=(i(61432),i(96711),i(83850),i(48023)),d=i(75432),h=i(60508),p=i(13689);let m=class extends(a.Z.JSONSupportMixin(o.Z.ClonableMixin(s.Z))){constructor(e){super(e),this.position=null,this.elevationInfo=null,this.feature=null}equals(e){return(0,l._W)(this.position,e.position)&&(0,l._W)(this.elevationInfo,e.elevationInfo)&&(0,r.kk)(this.feature,e.feature)}};(0,n._)([(0,c.Cb)({type:h.Z,json:{write:{isRequired:!0}}})],m.prototype,"position",void 0),(0,n._)([(0,c.Cb)({type:p.Z}),(0,d.B)()],m.prototype,"elevationInfo",void 0),(0,n._)([(0,c.Cb)(r.rX)],m.prototype,"feature",void 0),m=(0,n._)([(0,u.j)("esri.analysis.LineOfSightAnalysisObserver")],m);const f=m},99965:function(e,t,i){i.d(t,{Z:function(){return p}});var n=i(73440),r=i(37877),s=i(89314),o=i(63255),a=i(61100),l=i(17155),c=(i(61432),i(96711),i(83850),i(48023)),u=i(75432),d=i(60508),h=i(13689);let p=class extends(o.Z.JSONSupportMixin(s.Z)){constructor(e){super(e),this.position=null,this.elevationInfo=null,this.feature=null}equals(e){return(0,a._W)(this.position,e.position)&&(0,a._W)(this.elevationInfo,e.elevationInfo)&&(0,r.kk)(this.feature,e.feature)}};(0,n._)([(0,l.Cb)({type:d.Z,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}}),(0,u.B)()],p.prototype,"position",void 0),(0,n._)([(0,l.Cb)({type:h.Z}),(0,u.B)()],p.prototype,"elevationInfo",void 0),(0,n._)([(0,l.Cb)(r.rX)],p.prototype,"feature",void 0),p=(0,n._)([(0,c.j)("esri.analysis.LineOfSightAnalysisTarget")],p)},68651:function(e,t,i){i.d(t,{Z:function(){return m}});var n=i(73440),r=i(89314),s=i(95437),o=i(63255),a=i(61100),l=i(17155),c=i(90775),u=(i(61432),i(83850),i(48023)),d=i(95226),h=i(60508);let p=class extends(r.Z.ClonableMixin(o.Z)){constructor(e){super(e),this.type="plane",this.position=null,this.heading=0,this.tilt=0,this.width=10,this.height=10}equals(e){return this.heading===e.heading&&this.tilt===e.tilt&&this.width===e.width&&this.height===e.height&&(0,a._W)(this.position,e.position)}};(0,n._)([(0,l.Cb)({type:["plane"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],p.prototype,"type",void 0),(0,n._)([(0,l.Cb)({type:h.Z,json:{write:{isRequired:!0}}})],p.prototype,"position",void 0),(0,n._)([(0,l.Cb)({type:Number,nonNullable:!0,range:{min:0,max:360},json:{write:{isRequired:!0}}}),(0,c.p)((e=>s.BV.normalize((0,d.q9)(e),0,!0)))],p.prototype,"heading",void 0),(0,n._)([(0,l.Cb)({type:Number,nonNullable:!0,range:{min:0,max:360},json:{write:{isRequired:!0}}}),(0,c.p)((e=>s.BV.normalize((0,d.q9)(e),0,!0)))],p.prototype,"tilt",void 0),(0,n._)([(0,l.Cb)({type:Number,nonNullable:!0,range:{min:0},json:{write:{isRequired:!0}}})],p.prototype,"width",void 0),(0,n._)([(0,l.Cb)({type:Number,nonNullable:!0,range:{min:0},json:{write:{isRequired:!0}}})],p.prototype,"height",void 0),p=(0,n._)([(0,u.j)("esri.analysis.SlicePlane")],p);const m=p},34753:function(e,t,i){i.d(t,{Z:function(){return m}});var n=i(73440),r=i(37877),s=i(89314),o=i(95437),a=i(63255),l=i(61100),c=i(17155),u=i(90775),d=(i(61432),i(83850),i(48023)),h=i(95226),p=i(60508);let m=class extends(a.Z.JSONSupportMixin(s.Z)){constructor(e){super(e),this.observer=null,this.farDistance=1e3,this.heading=0,this.tilt=90,this.horizontalFieldOfView=45,this.verticalFieldOfView=45,this.feature=null}get valid(){return null!=this.observer&&this.farDistance>0}equals(e){return(0,l._W)(this.observer,e.observer)&&this.farDistance===e.farDistance&&this.heading===e.heading&&this.tilt===e.tilt&&this.horizontalFieldOfView===e.horizontalFieldOfView&&this.verticalFieldOfView===e.verticalFieldOfView&&(0,r.kk)(this.feature,e.feature)}};(0,n._)([(0,c.Cb)({type:p.Z,json:{write:{isRequired:!0}}})],m.prototype,"observer",void 0),(0,n._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0},json:{write:{isRequired:!0}}})],m.prototype,"farDistance",void 0),(0,n._)([(0,c.Cb)({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),(0,u.p)((e=>o.BV.normalize((0,h.q9)(e),void 0,!0)))],m.prototype,"heading",void 0),(0,n._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:180},json:{write:{isRequired:!0}}})],m.prototype,"tilt",void 0),(0,n._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:360},json:{write:{isRequired:!0}}})],m.prototype,"horizontalFieldOfView",void 0),(0,n._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:180},json:{write:{isRequired:!0}}})],m.prototype,"verticalFieldOfView",void 0),(0,n._)([(0,c.Cb)(r.rX)],m.prototype,"feature",void 0),(0,n._)([(0,c.Cb)({readOnly:!0,json:{read:!1}})],m.prototype,"valid",null),m=(0,n._)([(0,d.j)("esri.analysis.Viewshed")],m)},38003:function(e,t,i){i.d(t,{Z:function(){return g}});var n=i(73440),r=i(65475),s=i(34753),o=i(3480),a=i(43254),l=i(41145),c=i(95437),u=i(99574),d=i(90403),h=i(17155),p=(i(61432),i(96711),i(48023)),m=i(71354),f=i(13132);const v=a.Z.ofType(s.Z);let g=class extends r.Z{constructor(e){super(e),this.type="viewshed",this._extent=null}initialize(){this.addHandles((0,d.YP)((()=>this._computeExtent()),(e=>{null==e.pending&&(this._extent=e.extent)}),d.tX))}get viewsheds(){return this._get("viewsheds")||new v}set viewsheds(e){this._set("viewsheds",(0,l.Z)(e,this.viewsheds,v))}get spatialReference(){for(const e of this.viewsheds)if(null!=e.observer)return e.observer.spatialReference;return null}get extent(){return this._extent}get valid(){return this.viewsheds.every((e=>e.valid))}async waitComputeExtent(){const e=this._computeExtent();null!=e.pending&&await e.pending}_computeExtent(){const{spatialReference:e}=this;if(null==e)return{pending:null,extent:null};const t=this.viewsheds.filter((e=>null!=e.observer)),i=t.map((e=>e.observer)).toArray(),n=(0,f.projectOrLoadMany)(i,e);return null!=n.pending?{pending:n.pending,extent:null}:{pending:null,extent:n.geometries.map(((e,i)=>{const n=t.at(i);return null!=e&&null!=n?this._computeViewshedExtent(this.viewsheds.at(i),e):null})).filter((e=>null!=e)).reduce(((e,t)=>function(e,t){return null==e?t:null==t?e:e.union(t)}(e,t)),null)}}_computeViewshedExtent(e,t){const{farDistance:i,heading:n,tilt:r,horizontalFieldOfView:s,verticalFieldOfView:o}=e,{spatialReference:a}=t,l=s/2,d=o/2,h=i/a.metersPerUnit,p=[c.BV.normalize(n-l),n,c.BV.normalize(n+l)],f=m.Z.fromPoint(t),v=e=>{const t=p.map((t=>c.BV.normalize(t-e)));if(t[0]>t[2]||360===s)return h;const i=t.map((e=>Math.abs(e>180?360-e:e))).reduce(((e,t)=>e>t?t:e));return i>90?0:h*Math.cos((0,u.Vl)(i))};f.xmax+=v(90),f.xmin-=v(-90),f.ymax+=v(0),f.ymin-=v(180);const g=t.z;if(null!=g){let e=g,t=g;const n=r-90,s=(0,u.uZ)(n+d,-90,90),o=(0,u.uZ)(n-d,-90,90),c=a?.isGeographic?i:h;e+=c*b(s),t+=c*b(o);const p=y(d)*c,m=b(n)*p*(1-y(l));r<90&&(e-=m),r>90&&(t-=m),f.zmax=Math.max(e,g),f.zmin=Math.min(t,g)}return f}equals(e){return this===e||super.equals(e)&&(0,o.fS)(this.viewsheds.toArray(),e.viewsheds.toArray(),((e,t)=>e.equals(t)))}clear(){this.viewsheds.removeAll()}};function y(e){return Math.cos((0,u.Vl)(e))}function b(e){return Math.sin((0,u.Vl)(e))}(0,n._)([(0,h.Cb)({type:["viewshed"]})],g.prototype,"type",void 0),(0,n._)([(0,h.Cb)({cast:l.R,type:v,nonNullable:!0})],g.prototype,"viewsheds",null),(0,n._)([(0,h.Cb)({readOnly:!0})],g.prototype,"spatialReference",null),(0,n._)([(0,h.Cb)()],g.prototype,"_extent",void 0),(0,n._)([(0,h.Cb)()],g.prototype,"extent",null),(0,n._)([(0,h.Cb)({readOnly:!0})],g.prototype,"valid",null),g=(0,n._)([(0,p.j)("esri.analysis.ViewshedAnalysis")],g)},37877:function(e,t,i){i.d(t,{NS:function(){return d},kk:function(){return l},pD:function(){return c},rX:function(){return u}});var n=i(24910),r=i(82846),s=i(12659),o=i(61442),a=i(90189);function l(e,t){return c(e)===c(t)}function c(e){if(null==e)return null;const t=null!=e.layer?e.layer.id:"";let i=null;return i=null!=e.objectId?e.objectId:null!=e.layer&&"objectIdField"in e.layer&&null!=e.layer.objectIdField&&null!=e.attributes?e.attributes[e.layer.objectIdField]:e.uid,null==i?null:`o-${t}-${i}`}const u={json:{write:{writer:function(e,t){null!=e?.layer?.objectIdField&&null!=e.attributes&&(t.feature={layerId:e.layer.id,objectId:e.attributes[e.layer.objectIdField]})},target:{"feature.layerId":{type:[Number,String],isRequired:!0},"feature.objectId":{type:[Number,String],isRequired:!0}}},origins:{"web-scene":{read:function(e){if(null!=e.layerId&&null!=e.objectId)return{uid:null,layer:{id:e.layerId,objectIdField:"ObjectId"},attributes:{ObjectId:e.objectId}}}}}}};function d(e,t,i,l){const{sceneIntersectionHelper:u}=e,{observer:d,observerFeatureId:p,targetFeatureId:v,target:g}=i;if(null==p&&null==v)return;l||(l=e=>e),(0,n.a)(f,d,g);const y=(0,n.l)(f);(0,n.b)(f,d,f,1/y);const b=(0,s.zk)(f,g,m);t.options.store=o.e.ALL,u.intersectToolIntersectorRay(b,t);let _=null,w=null,C=null,x=null;for(const i of t.results.all){const t=(0,a.tB)(i,e);if(null==t||null==i.distanceInRenderSpace)continue;const n=c(t);null!=n&&(null!=p&&n===p&&(_??=l(h(i,e,y)),i.distanceInRenderSpace-1<_&&(C=i)),null!=v&&n===v&&(w??=l(h(i,e,y)),null==x&&i.distanceInRenderSpace-1<y&&y-i.distanceInRenderSpace+1<w&&(x=i)))}const{observerAdjusted:E,targetAdjusted:S}=i;C?.getIntersectionPoint(E)?i.observerSurfaceNormal=C.getTransformedNormal((0,r.Ue)()):i.observerSurfaceNormal=null,x?.getIntersectionPoint(S)?i.targetSurfaceNormal=x.getTransformedNormal((0,r.Ue)()):i.targetSurfaceNormal=null}function h(e,t,i){if((0,a._s)(e)){const n=(0,a.VB)(e,t);if(null!=n)return Math.min(n*p,i)}return 1e-5*i}const p=.05,m=(0,s.Ue)(),f=(0,r.Ue)()},6496:function(e,t,i){i.d(t,{En:function(){return s},mR:function(){return a},xo:function(){return o}});var n=i(1925),r=i(10618);function s(e){return e.forceInteractive()}function o(e){return(0,n.nn)(e,"meters").value>r.Yo}function a(e){return 0===e.viewData.intersectingSegments.size}},26961:function(e,t,i){i.d(t,{R:function(){return r}});var n=i(5826);function r(e){return(0,n.R)(e)}},69069:function(e,t,i){i.d(t,{S:function(){return k}});var n=Math.PI,r=Math.sin,s=Math.cos,o=Math.tan,a=Math.asin,l=Math.atan2,c=Math.acos,u=n/180,d=864e5,h=2440588,p=2451545,m={dec:0,ra:0};function f(e){return new Date((e+.5-h)*d)}function v(e){return function(e){return e.valueOf()/d-.5+h}(e)-p}var g=23.4397*u;function y(e,t){return l(r(e)*s(g)-o(t)*r(g),s(e))}function b(e,t){return a(r(t)*s(g)+s(t)*r(g)*r(e))}function _(e,t,i){return l(r(e),s(e)*r(t)-o(i)*s(t))}function w(e,t,i){return a(r(t)*r(i)+s(t)*s(i)*s(e))}function C(e,t){return u*(280.16+360.9856235*e)-t}function x(e){return u*(357.5291+.98560028*e)}function E(e){return u*(1.9148*r(e)+.02*r(2*e)+3e-4*r(3*e))}function S(e,t){return e+t+102.9372*u+n}function T(e,t){var i=x(e),n=S(i,E(i));return t||(t={dec:0,ra:0}),t.dec=b(n,0),t.ra=y(n,0),t}var k={PolarException:{NORMAL:0,MIDNIGHT_SUN:1,POLAR_NIGHT:2},getPosition:function(e,t,i,n){var r=u*-i,s=u*t,o=v(e),a=T(o,m),l=C(o,r)-a.ra;return n||(n={azimuth:0,altitude:0}),n.azimuth=_(l,s,a.dec),n.altitude=w(l,s,a.dec),n}},I=[[-.83,"sunrise","sunset"]];k.addTime=function(e,t,i){I.push([e,t,i])};var P=9e-4;function O(e,t){return Math.round(e-P-t/(2*n))}function L(e,t,i){return P+(e+t)/(2*n)+i}function M(e,t,i){return p+e+.0053*r(t)-.0069*r(2*i)}function R(e,t,i){return c((r(e)-r(t)*r(i))/(s(t)*s(i)))}function A(e){var t=u*(134.963+13.064993*e),i=u*(93.272+13.22935*e),n=u*(218.316+13.176396*e)+6.289*u*r(t),o=5.128*u*r(i),a=385001-20905*s(t);return{ra:y(n,o),dec:b(n,o),dist:a}}k.getTimes=function(e,t,i){var n=u*-i,o=u*t,a=O(v(e),n),l=L(0,n,a),c=x(l),d=E(c),h=S(c,d),p=b(h,0),m=M(l,c,h);function g(e){return M(L(R(e,o,p),n,a),c,h)}var y,_,w,C,T,P={solarNoon:f(m),nadir:f(m-.5),polarException:k.PolarException.NORMAL};for(y=0,_=I.length;y<_;y+=1)T=m-((C=g((w=I[y])[0]*u))-m),P[w[1]]=f(T),P[w[2]]=f(C);return P.polarException=function(e){var t=(r(e)-r(o)*r(p))/(s(o)*s(p));return t<-1?k.PolarException.MIDNIGHT_SUN:t>1?k.PolarException.POLAR_NIGHT:k.PolarException.NORMAL}(I[0][0]*u),P},k.getMoonPosition=function(e,t,i){var n=u*-i,r=u*t,s=v(e),a=A(s),l=C(s,n)-a.ra,c=w(l,r,a.dec);return c+=.017*u/o(c+10.26*u/(c+5.1*u)),{azimuth:_(l,r,a.dec),altitude:c,distance:a.dist}},k.getMoonFraction=function(e){var t=v(e),i=T(t),n=A(t),o=149598e3,a=c(r(i.dec)*r(n.dec)+s(i.dec)*s(n.dec)*s(i.ra-n.ra)),u=l(o*r(a),n.dist-o*s(a));return(1+s(u))/2}},46965:function(e,t,i){var n;i.d(t,{Y:function(){return n}}),function(e){e[e.KILOBYTES=1024]="KILOBYTES",e[e.MEGABYTES=1048576]="MEGABYTES",e[e.GIGABYTES=1073741824]="GIGABYTES"}(n||(n={}))},63727:function(e,t,i){i.d(t,{Z:function(){return c}});var n=i(73440),r=i(43254),s=i(90403),o=i(17155),a=i(48023),l=i(21260);let c=class extends r.Z{constructor(e){super(e),this.getCollections=null}initialize(){this.addHandles((0,l.EH)((()=>this._refresh()),s.Z_))}destroy(){this.getCollections=null}_refresh(){const e=null!=this.getCollections?this.getCollections():null;if(null==e)return void this.removeAll();let t=0;for(const i of e)null!=i&&(t=this._processCollection(t,i));this.splice(t)}_createNewInstance(e){return new r.Z(e)}_processCollection(e,t){if(!t)return e;const i=this.itemFilterFunction??(e=>!!e);for(const n of t)if(n){if(i(n)){const t=this.indexOf(n,e);t>=0?t!==e&&this.reorder(n,e):this.add(n,e),++e}if(this.getChildrenFunction){const t=this.getChildrenFunction(n);if(Array.isArray(t))for(const i of t)e=this._processCollection(e,i);else e=this._processCollection(e,t)}}return e}};(0,n._)([(0,o.Cb)()],c.prototype,"getCollections",void 0),(0,n._)([(0,o.Cb)()],c.prototype,"getChildrenFunction",void 0),(0,n._)([(0,o.Cb)()],c.prototype,"itemFilterFunction",void 0),c=(0,n._)([(0,a.j)("esri.core.CollectionFlattener")],c)},87422:function(e,t,i){i.d(t,{Z:function(){return s}});var n=i(53227),r=i(18002);class s{constructor(e){this._observable=new r.s,this._map=new Map(e)}get size(){return(0,n.it)(this._observable),this._map.size}clear(){this._map.size>0&&(this._map.clear(),this._observable.notify())}delete(e){const t=this._map.delete(e);return t&&this._observable.notify(),t}entries(){return(0,n.it)(this._observable),this._map.entries()}forEach(e,t){(0,n.it)(this._observable),this._map.forEach(((i,n)=>e.call(t,i,n,this)),t)}get(e){return(0,n.it)(this._observable),this._map.get(e)}has(e){return(0,n.it)(this._observable),this._map.has(e)}keys(){return(0,n.it)(this._observable),this._map.keys()}set(e,t){return this._map.set(e,t),this._observable.notify(),this}values(){return(0,n.it)(this._observable),this._map.values()}[Symbol.iterator](){return(0,n.it)(this._observable),this._map[Symbol.iterator]()}[Symbol.dispose](){this._observable.destroy()}get[Symbol.toStringTag](){return this._map[Symbol.toStringTag]}}},75432:function(e,t,i){i.d(t,{B:function(){return p}});var n=i(88194),r=i(29328),s=i(9713),o=i(95490),a=i(18764),l=i(15853),c=i(66951),u=i(17155),d=i(84753),h=i(28938);function p(e){const t=e?.origins??[void 0];return(i,n)=>{const r=function(e,t,i){if("resource"===e?.type)return function(e,t,i){const n=(0,l.Oe)(t,i);return{type:String,read:(e,t,i)=>{const r=(0,h.r)(e,t,i);return n.type===String?r:"function"==typeof n.type?new n.type({url:r}):void 0},write:{isRequired:n.json?.write?.isRequired,writer(t,r,a,l){if(!l?.resources)return"string"==typeof t?void(r[a]=(0,h.t)(t,l)):void(r[a]=t.write({},l));const u=function(e){return null==e?null:"string"==typeof e?e:e.url}(t),p=(0,h.t)(u,{...l,verifyItemRelativeUrls:l?.verifyItemRelativeUrls?{writtenUrls:l.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},h.M.NO),g=n.type!==String&&(!(0,s.l)(this)||l?.origin&&this.originIdOf(i)>(0,c.M9)(l.origin)),y={object:this,propertyName:i,value:t,targetUrl:p,dest:r,targetPropertyName:a,context:l,params:e};l?.portalItem&&p&&!(0,o.YP)(p)?g&&e?.contentAddressed?m(y):g?function(e){const{context:t,targetUrl:i,params:n,value:r,dest:s,targetPropertyName:a}=e;if(!t.portalItem)return;const l=t.portalItem.resourceFromPath(i),c=v(r,i,t),u=(0,d.B)(c),h=(0,o.Ml)(l.path),p=n?.compress??!1;u===h?(t.resources&&f({...e,resource:l,content:c,compress:p,updates:t.resources.toUpdate}),s[a]=i):m(e)}(y):function({context:e,targetUrl:t,dest:i,targetPropertyName:n}){e.portalItem&&e.resources&&(e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(t),compress:!1}),i[n]=t)}(y):l?.portalItem&&(null==p||null!=(0,h.i)(p)||(0,o.jc)(p)||g)?m(y):r[a]=p}}}}(e,t,i);switch(e?.type??"other"){case"other":return{read:!0,write:!0};case"url":{const{read:e,write:t}=h.b;return{read:e,write:t}}}}(e,i,n);for(const e of t){const t=(0,u.CJ)(i,e,n);for(const e in r)t[e]=r[e]}}}function m(e){const{targetUrl:t,params:i,value:s,context:l,dest:c,targetPropertyName:u}=e;if(!l.portalItem)return;const p=(0,h.p)(t),m=v(s,t,l);if(i?.contentAddressed&&"json"!==m.type)return void l.messages?.push(new n.Z("persistable:contentAddressingUnsupported",`Property "${u}" is trying to serializing a resource with content of type ${m.type} with content addressing. Content addressing is only supported for json resources.`,{content:m}));const g=i?.contentAddressed&&"json"===m.type?(0,r.F)(m.jsonString):p?.filename??(0,a.DO)(),y=(0,o.v_)(i?.prefix??p?.prefix,g),b=`${y}.${(0,d.B)(m)}`;if(i?.contentAddressed&&l.resources&&"json"===m.type){const e=l.resources.toKeep.find((({resource:e})=>e.path===b))??l.resources.toAdd.find((({resource:e})=>e.path===b));if(e)return void(c[u]=e.resource.itemRelativeUrl)}const _=l.portalItem.resourceFromPath(b);(0,o.jc)(t)&&l.resources&&l.resources.pendingOperations.push((0,o.gi)(t).then((e=>{_.path=`${y}.${(0,d.B)({type:"blob",blob:e})}`,c[u]=_.itemRelativeUrl})).catch((()=>{})));const w=i?.compress??!1;l.resources&&f({...e,resource:_,content:m,compress:w,updates:l.resources.toAdd}),c[u]=_.itemRelativeUrl}function f({object:e,propertyName:t,updates:i,resource:n,content:r,compress:s}){i.push({resource:n,content:r,compress:s,finish:i=>{!function(e,t,i){"string"==typeof e[t]?e[t]=i.url:e[t].url=i.url}(e,t,i)}})}function v(e,t,i){return"string"==typeof e?{type:"url",url:t}:{type:"json",jsonString:JSON.stringify(e.toJSON(i))}}},34058:function(e,t,i){i.d(t,{D:function(){return r}});var n=i(9713);function r(e){e?.writtenProperties&&e.writtenProperties.forEach((({target:e,propName:t,newOrigin:i})=>{(0,n.l)(e)&&i&&e.originOf(t)!==i&&e.updateOrigin(t,i)}))}},87286:function(e,t,i){function n(e){return"string"==typeof e?document.getElementById(e):e??null}function r(e,t){for(;;){const i=e.firstChild;if(!i)break;t.appendChild(i)}}i.d(t,{L:function(){return n},Y:function(){return r}})},64497:function(e,t,i){i.d(t,{I:function(){return r},v:function(){return s}});var n=i(99574);function r(e,t,i=0){const r=(0,n.uZ)(e,0,l);for(let e=0;e<4;e++)t[i+e]=Math.floor(256*c(r*o[e]))}function s(e,t=0){let i=0;for(let n=0;n<4;n++)i+=e[t+n]*a[n];return i}const o=[1,256,65536,16777216],a=[1/256,1/65536,1/16777216,1/4294967296],l=s(new Uint8ClampedArray([255,255,255,255]));function c(e){return e-Math.floor(e)}},332:function(e,t,i){i.d(t,{G:function(){return o},w:function(){return a}});var n=i(29292),r=i(43254),s=i(97006);async function o(e,t){return await e.load(),a(e,t)}async function a(e,t){const i=[],o=(...e)=>{for(const t of e)null!=t&&(Array.isArray(t)?o(...t):r.Z.isCollection(t)?t.forEach((e=>o(e))):s.Z.isLoadable(t)&&i.push(t))};t(o);let a=null;if(await(0,n.UI)(i,(async e=>{const t=await(0,n.q6)(function(e){return"loadAll"in e&&"function"==typeof e.loadAll}(e)?e.loadAll():e.load());!1!==t.ok||a||(a=t)})),a)throw a.error;return e}},30062:function(e,t,i){function n(e){let t,i,n=[],r=!1;return function(...s){return r&&t===this&&function(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}(s,n)||(i=e.apply(this,s),t=this,n=s,r=!0),i}}i.d(t,{H:function(){return n}})},9713:function(e,t,i){function n(e){return e&&"getAtOrigin"in e&&"originOf"in e}i.d(t,{l:function(){return n}})},55430:function(e,t,i){i.d(t,{N9:function(){return p},Pr:function(){return v},Rd:function(){return l},Se:function(){return g},Ud:function(){return u},VG:function(){return o},Wv:function(){return c},Zv:function(){return d},cy:function(){return h},i_:function(){return m},ym:function(){return f}});var n=i(95437),r=i(1925),s=i(51067);function o(e,t,i,n=2,o="abbr"){return(0,s.VG)(e,(0,r.nn)(t,i).value,i,n,o)}function a(e,t,i,n=2,o="abbr"){return(0,s.LO)(e,(0,r.nn)(t,i).value,i,n,o)}function l(e,t,i=2,n="abbr"){return(0,s.Rd)(e,t.value,t.unit,i,n)}function c(e,t,i=2,n="abbr"){return(0,s.Wv)(e,t.value,t.unit,i,n)}function u(e,t,i=2,n="abbr"){return(0,s.Ud)(e,t.value,t.unit,i,n)}function d(e,t,i=2,n="abbr"){return(0,s.Zv)(e,t.value,t.unit,i,n)}function h(e,t,i,r=n.BV,o=!0){return(0,s.L4)(e.value,e.unit,e.rotationType,t,i,r,o)}function p(e,t,i,n,r="abbr"){switch(n=n??2,i){case"imperial":return u(e,t,n,r);case"metric":return l(e,t,n,r);default:return o(e,t,i,n,r)}}function m(e,t,i,n=2,r="abbr"){switch(i){case"imperial":return function(e,t,i=2,n="abbr"){return(0,s.q6)(e,t.value,t.unit,i,n)}(e,t,n,r);case"metric":return function(e,t,i=2,n="abbr"){return(0,s.mg)(e,t.value,t.unit,i,n)}(e,t,n,r);default:return a(e,t,i,n,r)}}function f(e,t,i,n=2,r="abbr"){switch(i){case"imperial":return d(e,t,n,r);case"metric":return c(e,t,n,r);default:return o(e,t,i,n,r)}}function v(e,t,i,n=2,r="abbr"){switch(i){case"imperial":return function(e,t,i=2,n="abbr"){return(0,s.aC)(e,t.value,t.unit,i,n)}(e,t,n,r);case"metric":return function(e,t,i=2,n="abbr"){return(0,s.h9)(e,t.value,t.unit,i,n)}(e,t,n,r);default:return a(e,t,i,n,r)}}function g(e,t,i,n=2,r="abbr"){switch(i){case"imperial":return function(e,t,i=2,n="abbr"){return(0,s.yc)(e,t.value,t.unit,i,n)}(e,t,n,r);case"metric":return function(e,t,i=2,n="abbr"){return(0,s.ld)(e,t.value,t.unit,i,n)}(e,t,n,r);default:return o(e,t,i,n,r)}}},12506:function(e,t,i){function n(e,t,i,n){let r=null,s=1e3;"number"==typeof t?(s=t,n=i):(r=t??null,s=i);let o,a=0;const l=()=>{a=0,e.apply(n,o)},c=(...e)=>{r&&r.apply(n,e),o=e,s?a||(a=setTimeout(l,s)):l()};return c.remove=()=>{a&&(clearTimeout(a),a=0)},c.forceUpdate=()=>{a&&(clearTimeout(a),l())},c.hasPendingUpdates=()=>!!a,c}i.d(t,{P:function(){return n}})},51067:function(e,t,i){i.d(t,{L4:function(){return x},LO:function(){return h},Qv:function(){return u},Rd:function(){return p},Ud:function(){return g},VG:function(){return d},Wv:function(){return f},Zv:function(){return b},aC:function(){return _},h9:function(){return v},ld:function(){return w},mg:function(){return m},q6:function(){return y},sS:function(){return k},yc:function(){return C}});var n=i(46965),r=i(95437),s=i(99574),o=i(1925),a=i(29138),l=i(26636),c=i(40030);function u(e,t,i){return e.units[t][i]}function d(e,t,i,n=2,r="abbr"){return`${(0,c.uf)(t,{minimumFractionDigits:n,maximumFractionDigits:n,signDisplay:t>0?"never":"exceptZero"})} ${u(e,i,r)}`}function h(e,t,i,n=2,r="abbr"){return`${(0,c.uf)(t,{minimumFractionDigits:n,maximumFractionDigits:n,signDisplay:"exceptZero"})} ${u(e,i,r)}`}function p(e,t,i,n=2,r="abbr"){const s=(0,l.Y8)(t,i);return d(e,(0,l.En)(t,i,s),s,n,r)}function m(e,t,i,n=2,r="abbr"){const s=(0,l.Y8)(t,i);return h(e,(0,l.En)(t,i,s),s,n,r)}function f(e,t,i,n=2,r="abbr"){const s=(0,l.Dw)(t,i);return d(e,(0,l.En)(t,i,s),s,n,r)}function v(e,t,i,n=2,r="abbr"){const s=(0,l.Dw)(t,i);return h(e,(0,l.En)(t,i,s),s,n,r)}function g(e,t,i,n=2,r="abbr"){const s=(0,l.Q7)(t,i);return d(e,(0,l.En)(t,i,s),s,n,r)}function y(e,t,i,n=2,r="abbr"){const s=(0,l.Q7)(t,i);return h(e,(0,l.En)(t,i,s),s,n,r)}function b(e,t,i,n=2,r="abbr"){const s=(0,l.jl)(t,i);return d(e,(0,l.En)(t,i,s),s,n,r)}function _(e,t,i,n=2,r="abbr"){const s=(0,l.jl)(t,i);return h(e,(0,l.En)(t,i,s),s,n,r)}function w(e,t,i,n=2,r="abbr"){const s=(0,l.ZI)(t,i);return d(e,(0,l.En)(t,i,s),s,n,r)}function C(e,t,i,n=2,r="abbr"){const s=(0,l.LV)(t,i);return d(e,(0,l.En)(t,i,s),s,n,r)}function x(e,t,i,n,s,a=r.BV,u=!0){let d=a.normalize((0,o.hw)((0,l.En)(e,t,"degrees"),i,n),0,u);const h=((e,t)=>({style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:t,minimumFractionDigits:t,signDisplay:e>0?"never":"exceptZero"}))(d,s??2);return d=S(d,h),(0,c.uf)(d,h)}const E=new Map;function S(e,t){const i=JSON.stringify(t);let n=E.get(i);return n||(n=new Intl.NumberFormat("en-US",t),E.set(i,n)),/^[-+]?360\.?0*Â°?$/.test(n.format(e))?0:e}const T=["B","kB","MB","GB","TB"];function k(e,t){let i=0===(t=Math.round(t))?0:Math.floor(Math.log(t)/Math.log(n.Y.KILOBYTES));i=(0,s.uZ)(i,0,T.length-1);const r=(0,c.uf)(t/n.Y.KILOBYTES**i,{maximumFractionDigits:2});return(0,a.gx)(e.units.bytes[T[i]],{fileSize:r})}},86640:function(e,t,i){i.d(t,{Z:function(){return g}});var n,r=i(73440),s=i(3480),o=i(41773),a=i(63255),l=i(26636),c=i(8914),u=i(17155),d=(i(61432),i(96711),i(1194)),h=i(48023),p=i(29884);const m=(0,o.w)()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),f=m.jsonValues.slice();(0,s.e$)(f,"orthometric");const v=(0,o.w)()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let g=n=class extends a.Z{constructor(e){super(e),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(e,t,i){return m.write(e,t,i)}readHeightModel(e,t,i){return m.read(e)||(i?.messages&&i.messages.push(function(e,t){return new c.Z("height-model:unsupported",`Height model of value '${e}' is not supported`,t)}(e,{context:i})),null)}readHeightUnit(e,t,i){return v.read(e)||(i?.messages&&i.messages.push(y(e,{context:i})),null)}readHeightUnitService(e,t,i){return(0,l.$C)(e)||v.read(e)||(i?.messages&&i.messages.push(y(e,{context:i})),null)}readVertCRS(e,t){return t.vertCRS||t.ellipsoid||t.geoid}clone(){return new n({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(e){return!!e&&(this===e||this.heightModel===e.heightModel&&this.heightUnit===e.heightUnit&&this.vertCRS===e.vertCRS)}static deriveUnitFromSR(e,t){const i=(0,l.cM)(t);return new n({heightModel:e.heightModel,heightUnit:i??void 0,vertCRS:e.vertCRS})}write(e,t){return t={origin:"web-scene",...t},super.write(e,t)}static fromJSON(e){if(!e)return null;const t=new n;return t.read(e,{origin:"web-scene"}),t}};function y(e,t){return new c.Z("height-unit:unsupported",`Height unit of value '${e}' is not supported`,t)}(0,r._)([(0,u.Cb)({type:m.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:f,default:"ellipsoidal",write:{isRequired:!0}}}}})],g.prototype,"heightModel",void 0),(0,r._)([(0,p.c)("web-scene","heightModel")],g.prototype,"writeHeightModel",null),(0,r._)([(0,d.r)(["web-scene","service"],"heightModel")],g.prototype,"readHeightModel",null),(0,r._)([(0,u.Cb)({type:v.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:v.jsonValues,write:{writer:v.write,isRequired:!0}}}}})],g.prototype,"heightUnit",void 0),(0,r._)([(0,d.r)("web-scene","heightUnit")],g.prototype,"readHeightUnit",null),(0,r._)([(0,d.r)("service","heightUnit")],g.prototype,"readHeightUnitService",null),(0,r._)([(0,u.Cb)({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],g.prototype,"vertCRS",void 0),(0,r._)([(0,d.r)("service","vertCRS",["vertCRS","ellipsoid","geoid"])],g.prototype,"readVertCRS",null),g=n=(0,r._)([(0,h.j)("esri.geometry.HeightModelInfo")],g)},41207:function(e,t,i){i.d(t,{S$:function(){return u},Ue:function(){return o},Ws:function(){return c},_k:function(){return l},iL:function(){return a}});var n=i(38949),r=i(24910),s=i(12659);function o(e){return e?{ray:(0,s.Ue)(e.ray),c0:e.c0,c1:e.c1}:{ray:(0,s.Ue)(),c0:0,c1:Number.MAX_VALUE}}function a(e,t=o()){return(0,s.JG)(e,t.ray),t.c0=0,t.c1=Number.MAX_VALUE,t}function l(e,t,i=o()){const n=(0,r.l)(e.vector);return(0,s.al)(e.origin,t,i.ray),i.c0=0,i.c1=n,i}function c(e,t){return d(e,e.c0,t)}function u(e,t){return d(e,e.c1,t)}function d(e,t,i){return(0,r.f)(i,e.ray.origin,(0,r.g)(i,e.ray.direction,t))}new n.x((()=>o()))},33869:function(e,t,i){i.d(t,{Hf:function(){return v},JG:function(){return g},Jp:function(){return b},N9:function(){return k},NQ:function(){return r},Nu:function(){return n},Ue:function(){return f},Zr:function(){return w},g8:function(){return E},hr:function(){return _},q_:function(){return y},rN:function(){return x},xu:function(){return T},zq:function(){return C}});var n,r,s,o=i(38949),a=i(31865),l=i(24910),c=i(82846),u=i(73749),d=i(27583),h=i(41207),p=i(77773),m=i(69811);function f(e){return e?[(0,p.Ue)(e[0]),(0,p.Ue)(e[1]),(0,p.Ue)(e[2]),(0,p.Ue)(e[3]),(0,p.Ue)(e[4]),(0,p.Ue)(e[5])]:[(0,p.Ue)(),(0,p.Ue)(),(0,p.Ue)(),(0,p.Ue)(),(0,p.Ue)(),(0,p.Ue)()]}function v(){return[(0,c.Ue)(),(0,c.Ue)(),(0,c.Ue)(),(0,c.Ue)(),(0,c.Ue)(),(0,c.Ue)(),(0,c.Ue)(),(0,c.Ue)()]}function g(e,t){for(let i=0;i<k;i++)(0,p.JG)(e[i],t[i]);return e}function y(e,t,i,n=L){const r=(0,a.Jp)(m.MP.get(),t,e);(0,a.U_)(r,r);for(let e=0;e<I;++e){const t=(0,u.t)(m.o6.get(),P[e],r);(0,l.i)(n[e],t[0]/t[3],t[1]/t[3],t[2]/t[3])}b(i,n)}function b(e,t){(0,p.zk)(t[r.FAR_BOTTOM_LEFT],t[r.NEAR_BOTTOM_LEFT],t[r.NEAR_TOP_LEFT],e[n.LEFT]),(0,p.zk)(t[r.NEAR_BOTTOM_RIGHT],t[r.FAR_BOTTOM_RIGHT],t[r.FAR_TOP_RIGHT],e[n.RIGHT]),(0,p.zk)(t[r.FAR_BOTTOM_LEFT],t[r.FAR_BOTTOM_RIGHT],t[r.NEAR_BOTTOM_RIGHT],e[n.BOTTOM]),(0,p.zk)(t[r.NEAR_TOP_LEFT],t[r.NEAR_TOP_RIGHT],t[r.FAR_TOP_RIGHT],e[n.TOP]),(0,p.zk)(t[r.NEAR_BOTTOM_LEFT],t[r.NEAR_BOTTOM_RIGHT],t[r.NEAR_TOP_RIGHT],e[n.NEAR]),(0,p.zk)(t[r.FAR_BOTTOM_RIGHT],t[r.FAR_BOTTOM_LEFT],t[r.FAR_TOP_LEFT],e[n.FAR])}function _(e,t){for(let i=0;i<k;i++){const n=e[i];if(n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]>=t[3])return!1}return!0}function w(e,t){return S(e,(0,h.iL)(t,O.get()))}function C(e,t){for(let i=0;i<k;i++){const n=e[i];if(!(0,p.Er)(n,t))return!1}return!0}function x(e,t,i){return S(e,(0,h._k)(t,i,O.get()))}function E(e,t){for(let i=0;i<k;i++)if((0,p.jH)(e[i],t)>0)return!1;return!0}function S(e,t){for(let i=0;i<k;i++)if(!(0,p.oq)(e[i],t))return!1;return!0}(s=n||(n={}))[s.LEFT=0]="LEFT",s[s.RIGHT=1]="RIGHT",s[s.BOTTOM=2]="BOTTOM",s[s.TOP=3]="TOP",s[s.NEAR=4]="NEAR",s[s.FAR=5]="FAR",function(e){e[e.NEAR_BOTTOM_LEFT=0]="NEAR_BOTTOM_LEFT",e[e.NEAR_BOTTOM_RIGHT=1]="NEAR_BOTTOM_RIGHT",e[e.NEAR_TOP_RIGHT=2]="NEAR_TOP_RIGHT",e[e.NEAR_TOP_LEFT=3]="NEAR_TOP_LEFT",e[e.FAR_BOTTOM_LEFT=4]="FAR_BOTTOM_LEFT",e[e.FAR_BOTTOM_RIGHT=5]="FAR_BOTTOM_RIGHT",e[e.FAR_TOP_RIGHT=6]="FAR_TOP_RIGHT",e[e.FAR_TOP_LEFT=7]="FAR_TOP_LEFT"}(r||(r={}));const T={bottom:[r.FAR_BOTTOM_RIGHT,r.NEAR_BOTTOM_RIGHT,r.NEAR_BOTTOM_LEFT,r.FAR_BOTTOM_LEFT],near:[r.NEAR_BOTTOM_LEFT,r.NEAR_BOTTOM_RIGHT,r.NEAR_TOP_RIGHT,r.NEAR_TOP_LEFT],far:[r.FAR_BOTTOM_RIGHT,r.FAR_BOTTOM_LEFT,r.FAR_TOP_LEFT,r.FAR_TOP_RIGHT],right:[r.NEAR_BOTTOM_RIGHT,r.FAR_BOTTOM_RIGHT,r.FAR_TOP_RIGHT,r.NEAR_TOP_RIGHT],left:[r.FAR_BOTTOM_LEFT,r.NEAR_BOTTOM_LEFT,r.NEAR_TOP_LEFT,r.FAR_TOP_LEFT],top:[r.FAR_TOP_LEFT,r.NEAR_TOP_LEFT,r.NEAR_TOP_RIGHT,r.FAR_TOP_RIGHT]},k=6,I=8,P=[(0,d.al)(-1,-1,-1,1),(0,d.al)(1,-1,-1,1),(0,d.al)(1,1,-1,1),(0,d.al)(-1,1,-1,1),(0,d.al)(-1,-1,1,1),(0,d.al)(1,-1,1,1),(0,d.al)(1,1,1,1),(0,d.al)(-1,1,1,1)],O=new o.x(h.Ue),L=v()},63909:function(e,t,i){i.r(t),i.d(t,{default:function(){return H}});var n=i(73440),r=i(43254),s=i(63727),o=i(88194),a=i(50702),l=i(28947),c=i(332),u=i(96711),d=i(84060),h=i(93568),p=i(90403),m=i(95490),f=i(17155),v=(i(61432),i(1194)),g=i(48023),y=i(45213),b=i(38209),_=i(51389),w=i(84201),C=i(38448),x=i(58560),E=i(55591),S=i(85330),T=i(27202),k=i(3752),I=i(95060),P=i(76889),O=i(7961),L=i(78619),M=i(63255),R=i(97006),A=i(76329);i(83850);let D=class extends M.Z{constructor(){super(...arguments),this.fieldName=null,this.modelName=null,this.label=null,this.min=null,this.max=null,this.mostFrequentValues=null,this.subLayerIds=null}};(0,n._)([(0,f.Cb)({type:String})],D.prototype,"fieldName",void 0),(0,n._)([(0,f.Cb)({type:String})],D.prototype,"modelName",void 0),(0,n._)([(0,f.Cb)({type:String})],D.prototype,"label",void 0),(0,n._)([(0,f.Cb)({type:Number})],D.prototype,"min",void 0),(0,n._)([(0,f.Cb)({type:Number})],D.prototype,"max",void 0),(0,n._)([(0,f.Cb)({json:{read:e=>Array.isArray(e)&&(e.every((e=>"string"==typeof e))||e.every((e=>"number"==typeof e)))?e.slice():null}})],D.prototype,"mostFrequentValues",void 0),(0,n._)([(0,f.Cb)({type:[Number]})],D.prototype,"subLayerIds",void 0),D=(0,n._)([(0,g.j)("esri.layers.support.BuildingSummaryStatistics.BuildingFieldStatistics")],D);let F=class extends(R.Z.LoadableMixin(A.Z.EsriPromiseMixin(M.Z))){constructor(e){super(e),this.url=null,this.customParameters=null}get fields(){return this.loaded||"loading"===this.loadStatus?this._get("fields"):(u.Z.getLogger(this).error("building summary statistics are not loaded"),null)}load(e){const t=null!=e?e.signal:null;return this.addResolvingPromise(this._fetchService(t)),Promise.resolve(this)}async _fetchService(e){const t=(await(0,L.Z)(this.url,{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:e})).data;this.read(t,{origin:"service"})}};(0,n._)([(0,f.Cb)({constructOnly:!0,type:String})],F.prototype,"url",void 0),(0,n._)([(0,f.Cb)({constructOnly:!0})],F.prototype,"customParameters",void 0),(0,n._)([(0,f.Cb)({constructOnly:!0})],F.prototype,"apiKey",void 0),(0,n._)([(0,f.Cb)({readOnly:!0,type:[D],json:{read:{source:"summary"}}})],F.prototype,"fields",null),F=(0,n._)([(0,g.j)("esri.layers.support.BuildingSummaryStatistics")],F);var N=i(93295),V=i(51870);const z=r.Z.ofType(O.Z),U=(0,l.d9)(w.Z.sublayersProperty),$=U.json?.origins;$&&($["web-scene"]={type:[_.Z],write:{enabled:!0,overridePolicy:()=>({enabled:!1})}},$["portal-item"]={type:[_.Z],write:{enabled:!0,overridePolicy:()=>({enabled:!1})}});let B=class extends((0,I.Vt)((0,x.Y)((0,S.q)((0,T.I)((0,k.M)((0,d.R)((0,E.N)((0,C.V)(b.Z))))))))){constructor(e){super(e),this.operationalLayerType="BuildingSceneLayer",this.allSublayers=new s.Z({getCollections:()=>[this.sublayers],getChildrenFunction:e=>"building-group"===e.type?e.sublayers:null}),this.sublayers=null,this._allSublayerOverrides=null,this.filters=new z,this.activeFilterId=null,this.summaryStatistics=null,this.outFields=null,this.legendEnabled=!0,this.type="building-scene"}normalizeCtorArgs(e){return"string"==typeof e?{url:e}:e??{}}destroy(){this.allSublayers.destroy()}readSublayers(e,t,i){const n=w.Z.readSublayers(e,t,i);return w.Z.forEachSublayer(n,(e=>e.layer=this)),this._allSublayerOverrides&&(function(e,t){t.forEach((t=>j(e,t)))}(n,this._allSublayerOverrides),this._allSublayerOverrides=null),n}write(e,t){return e=super.write(e,t),!t||"web-scene"!==t.origin&&"portal-item"!==t.origin||(this.sublayers?function(e,t,i){const n=[];w.Z.forEachSublayer(e,(e=>{const t=e.write({},i);Object.keys(t).length>1&&n.push(t)})),n.length>0&&(t.sublayers=n)}(this.sublayers,e,t):this._allSublayerOverrides&&function(e,t,i){const n=i?.origin&&e.get(i.origin);n&&(t.sublayers=[],n.overrides.forEach((e=>{t.sublayers.push((0,l.d9)(e))})))}(this._allSublayerOverrides,e,t)),e}read(e,t){if(super.read(e,t),("web-scene"===t?.origin||"portal-item"===t?.origin)&&Array.isArray(e?.sublayers)){const i=function(e,t){const i=new Map;for(const n of e)null!=n&&"object"==typeof n&&"number"==typeof n.id?i.set(n.id,n):t.messages?.push(new o.Z("building-scene-layer:invalid-sublayer-override","Invalid value for sublayer override. Not an object or no id specified.",{value:n}));return{overrides:i,context:t}}(e.sublayers,t);this.sublayers?j(this.sublayers,i):(this._allSublayerOverrides??=new Map,this._allSublayerOverrides.set(t.origin,i))}}readSummaryStatistics(e,t){if("string"==typeof t.statisticsHRef&&this.parsedUrl){const e=(0,m.v_)(this.parsedUrl.path,t.statisticsHRef);return new F({url:e,apiKey:this.apiKey,customParameters:this.customParameters})}return null}set elevationInfo(e){null!=e&&"absolute-height"!==e.mode||this._set("elevationInfo",e),this._validateElevationInfo(e)}load(e){const t=null!=e?e.signal:null,i=this.loadFromPortal({supportedTypes:["Scene Service"]},e).catch(h.r9).then((()=>this._fetchService(t))).then((()=>this._fetchAssociatedFeatureService(t)));return this.addResolvingPromise(i),Promise.resolve(this)}loadAll(){return(0,c.G)(this,(e=>{w.Z.forEachSublayer(this.sublayers,(t=>{"building-group"!==t.type&&e(t)})),this.summaryStatistics&&e(this.summaryStatistics)}))}async saveAs(e,t){return this._debouncedSaveOperations(I.xp.SAVE_AS,{...t,getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"building-scene"},e)}async save(){const e={getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"building-scene"};return this._debouncedSaveOperations(I.xp.SAVE,e)}validateLayer(e){if(!e.layerType||"Building"!==e.layerType)throw new o.Z("buildingscenelayer:layer-type-not-supported","BuildingSceneLayer does not support this layer type",{layerType:e.layerType})}_getTypeKeywords(){return["Building"]}async _fetchAssociatedFeatureService(e){try{const{portalItem:t}=await(0,P.w)(`${this.url}/layers/${this.layerId}`,{sceneLayerItem:this.portalItem,customParameters:this.customParameters,apiKey:this.apiKey,signal:e});this.associatedFeatureServiceItem=t}catch(e){(0,h.R8)(this._logWarningOnPopupEnabled())}}async _logWarningOnPopupEnabled(){const e=new AbortController;this.addHandles((0,a.F2)(e)),await(0,p.N1)((()=>this.allSublayers.filter((e=>"building-component"===e.type)).some((e=>e.popupEnabled&&null!=e.popupTemplate))),e.signal);const t=this.allSublayers.filter((e=>"building-component"===e.type)).filter((e=>e.popupEnabled&&null!=e.popupTemplate)),i=[],n=[];for(const e of t){const t=e.title??`untitled ${e.id}`;e.attributeStorageInfo?i.push(t):n.push(t)}const r="\n  ",s=i.length>0?`\nThe following sublayers will fall back to binary attributes for Popups:${r}${i.join(r)}`:"",o=n.length>0?`\nThe following sublayers have no binary attributes and will not work with Popups:${r}${n.join(r)}`:"";u.Z.getLogger(this).warn(`Associated FeatureLayer could not be loaded for this BuildingSceneLayer: ${this.title}.`,s,o)}_validateElevationInfo(e){const t="Building scene layers";(0,V.LR)(u.Z.getLogger(this),(0,V.Uy)(t,"absolute-height",e)),(0,V.LR)(u.Z.getLogger(this),(0,V.kf)(t,e))}};function j(e,t){const{overrides:i,context:n}=t;w.Z.forEachSublayer(e,(e=>e.read(i.get(e.id),n)))}(0,n._)([(0,f.Cb)({type:["BuildingSceneLayer"]})],B.prototype,"operationalLayerType",void 0),(0,n._)([(0,f.Cb)({readOnly:!0})],B.prototype,"allSublayers",void 0),(0,n._)([(0,f.Cb)(U)],B.prototype,"sublayers",void 0),(0,n._)([(0,v.r)("service","sublayers")],B.prototype,"readSublayers",null),(0,n._)([(0,f.Cb)({type:z,nonNullable:!0,json:{write:!0}})],B.prototype,"filters",void 0),(0,n._)([(0,f.Cb)({type:String,json:{write:!0}})],B.prototype,"activeFilterId",void 0),(0,n._)([(0,f.Cb)({readOnly:!0,type:F})],B.prototype,"summaryStatistics",void 0),(0,n._)([(0,v.r)("summaryStatistics",["statisticsHRef"])],B.prototype,"readSummaryStatistics",null),(0,n._)([(0,f.Cb)({type:[String],json:{read:!1}})],B.prototype,"outFields",void 0),(0,n._)([(0,f.Cb)(N.vg)],B.prototype,"fullExtent",void 0),(0,n._)([(0,f.Cb)(N.rn)],B.prototype,"legendEnabled",void 0),(0,n._)([(0,f.Cb)({type:["show","hide","hide-children"]})],B.prototype,"listMode",void 0),(0,n._)([(0,f.Cb)((0,N.Lx)(y.Z))],B.prototype,"spatialReference",void 0),(0,n._)([(0,f.Cb)(N.PV)],B.prototype,"elevationInfo",null),(0,n._)([(0,f.Cb)({json:{read:!1},readOnly:!0})],B.prototype,"type",void 0),(0,n._)([(0,f.Cb)()],B.prototype,"associatedFeatureServiceItem",void 0),B=(0,n._)([(0,g.j)("esri.layers.BuildingSceneLayer")],B);const H=B},78646:function(e,t,i){i.d(t,{d:function(){return n}});const n="OBJECTID"},51389:function(e,t,i){i.d(t,{Z:function(){return N}});var n=i(73440),r=i(46451),s=i(997),o=i(78619),a=i(88194),l=i(41773),c=i(97006),u=i(96711),d=i(76329),h=i(17155),p=(i(61432),i(83850),i(79775)),m=i(1194),f=i(48023),v=i(71354),g=i(45213),y=i(59876),b=i(28693),_=i(20905),w=i(93295),C=i(88792),x=i(13545),E=i(299),S=i(76554),T=i(57085),k=i(50048),I=i(60541),P=i(29191),O=i(43462),L=i(99382),M=i(13689),R=i(52695),A=i(85754);const D=(0,x.v)();let F=class extends(c.Z.LoadableMixin(d.Z.EsriPromiseMixin(b.Z))){constructor(e){super(e),this.type="building-component",this.nodePages=null,this.materialDefinitions=[],this.textureSetDefinitions=[],this.geometryDefinitions=[],this.indexInfo=null,this.serviceUpdateTimeStamp=null,this.store=null,this.attributeStorageInfo=[],this.fields=[],this.associatedLayer=null,this.outFields=null,this.listMode="show",this.renderer=null,this.definitionExpression=null,this.popupEnabled=!0,this.popupTemplate=null,this.layerType="3d-object"}get parsedUrl(){return this.layer?{path:`${this.layer.parsedUrl?.path}/sublayers/${this.id}`,query:this.layer.parsedUrl?.query}:{path:""}}get fieldsIndex(){return new E.Z(this.fields)}readAssociatedLayer(e,t){const i=this.layer.associatedFeatureServiceItem,n=t.associatedLayerID;return null!=i&&"number"==typeof n?new y.default({portalItem:i,customParameters:this.customParameters,layerId:n}):null}get objectIdField(){if(null!=this.fields)for(const e of this.fields)if("oid"===e.type)return e.name;return""}get globalIdField(){if(null!=this.fields)for(const e of this.fields)if("global-id"===e.type)return e.name;return""}get displayField(){return null!=this.associatedLayer?this.associatedLayer.displayField:void 0}get apiKey(){return this.layer.apiKey}get customParameters(){return this.layer.customParameters}get fullExtent(){return this.layer.fullExtent}get spatialReference(){return this.layer.spatialReference}get version(){return this.layer.version}get elevationInfo(){return this.layer.elevationInfo}get minScale(){return this.layer.minScale}get maxScale(){return this.layer.maxScale}get effectiveScaleRange(){return this.layer.effectiveScaleRange}get defaultPopupTemplate(){return this.createPopupTemplate()}load(e){const t=null!=e?e.signal:null,i=this._fetchService(t).then((()=>{this.indexInfo=(0,T.T)(this.parsedUrl.path,this.rootNode,this.nodePages,this.customParameters,this.apiKey,u.Z.getLogger(this),t)}));return this.addResolvingPromise(i),Promise.resolve(this)}createPopupTemplate(e){return(0,L.eZ)(this,e)}async _fetchService(e){const t=(await(0,o.Z)(this.parsedUrl.path,{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:e})).data;this.read(t,{origin:"service",url:this.parsedUrl})}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,t){const i=this.getField(e)?.domain??null;return this.associatedLayer?(0,C.cy)(this.associatedLayer,e,t,i):i}getFeatureType(e){return e&&null!=this.associatedLayer?this.associatedLayer.getFeatureType(e):null}get types(){return null!=this.associatedLayer?this.associatedLayer.types??[]:[]}get typeIdField(){return null!=this.associatedLayer?this.associatedLayer.typeIdField:null}get geometryType(){return"3d-object"===this.layerType?"mesh":"point"}get profile(){return"3d-object"===this.layerType?"mesh-pyramids":"points"}get capabilities(){const e=null!=this.associatedLayer&&this.associatedLayer.capabilities?this.associatedLayer.capabilities:_.C,{query:t,operations:{supportsQuery:i},data:{supportsZ:n,supportsM:r,isVersioned:s}}=e;return{query:t,operations:{supportsQuery:i},data:{supportsZ:n,supportsM:r,isVersioned:s}}}createQuery(){const e=new P.Z;return"mesh"!==this.geometryType&&(e.returnGeometry=!0,e.returnZ=!0),e.where=this.definitionExpression||"1=1",e.sqlFormat="standard",e}queryExtent(e,t){return this._getAssociatedLayerForQuery().then((i=>i.queryExtent(e||this.createQuery(),t)))}queryFeatureCount(e,t){return this._getAssociatedLayerForQuery().then((i=>i.queryFeatureCount(e||this.createQuery(),t)))}queryFeatures(e,t){return this._getAssociatedLayerForQuery().then((i=>i.queryFeatures(e||this.createQuery(),t))).then((e=>{if(e?.features)for(const t of e.features)t.layer=this.layer,t.sourceLayer=this;return e}))}async queryObjectIds(e,t){const i=await this._getAssociatedLayerForQuery();return(await i.queryObjectIds(e||this.createQuery(),t)).filter(O.hj)}async queryCachedAttributes(e,t){const i=(0,S.Lk)(this.fieldsIndex,await(0,A.e7)(this,(0,A.V5)(this)));return(0,R.xe)(this.parsedUrl.path,this.attributeStorageInfo,e,t,i,this.apiKey,this.customParameters)}async queryCachedFeature(e,t){const i=await this.queryCachedAttributes(e,[t]);if(!i||0===i.length)throw new a.Z("scenelayer:feature-not-in-cached-data","Feature not found in cached data");return new r.Z({attributes:i[0],layer:this,sourceLayer:this})}getFieldUsageInfo(e){return this.fieldsIndex.has(e)?{supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1}:{supportsLabelingInfo:!1,supportsRenderer:!0,supportsPopupTemplate:!0,supportsLayerQuery:null!=this.associatedLayer}}_getAssociatedLayerForQuery(){const e=this.associatedLayer;return null!=e&&e.loaded?Promise.resolve(e):this._loadAssociatedLayerForQuery()}async _loadAssociatedLayerForQuery(){if(await this.load(),null==this.associatedLayer)throw new a.Z("buildingscenelayer:query-not-available","BuildingSceneLayer component layer queries are not available without an associated feature layer",{layer:this});try{await this.associatedLayer.load()}catch(e){throw new a.Z("buildingscenelayer:query-not-available","BuildingSceneLayer associated feature layer could not be loaded",{layer:this,error:e})}return this.associatedLayer}};(0,n._)([(0,h.Cb)({readOnly:!0})],F.prototype,"parsedUrl",null),(0,n._)([(0,h.Cb)({type:k.U4,readOnly:!0})],F.prototype,"nodePages",void 0),(0,n._)([(0,h.Cb)({type:[k.QI],readOnly:!0})],F.prototype,"materialDefinitions",void 0),(0,n._)([(0,h.Cb)({type:[k.Yh],readOnly:!0})],F.prototype,"textureSetDefinitions",void 0),(0,n._)([(0,h.Cb)({type:[k.H3],readOnly:!0})],F.prototype,"geometryDefinitions",void 0),(0,n._)([(0,h.Cb)({readOnly:!0})],F.prototype,"serviceUpdateTimeStamp",void 0),(0,n._)([(0,h.Cb)({readOnly:!0})],F.prototype,"store",void 0),(0,n._)([(0,h.Cb)({type:String,readOnly:!0,json:{read:{source:"store.rootNode"}}})],F.prototype,"rootNode",void 0),(0,n._)([(0,h.Cb)({readOnly:!0})],F.prototype,"attributeStorageInfo",void 0),(0,n._)([(0,h.Cb)(D.fields)],F.prototype,"fields",void 0),(0,n._)([(0,h.Cb)({readOnly:!0})],F.prototype,"fieldsIndex",null),(0,n._)([(0,h.Cb)({readOnly:!0,type:y.default})],F.prototype,"associatedLayer",void 0),(0,n._)([(0,m.r)("service","associatedLayer",["associatedLayerID"])],F.prototype,"readAssociatedLayer",null),(0,n._)([(0,h.Cb)(D.outFields)],F.prototype,"outFields",void 0),(0,n._)([(0,h.Cb)({type:String,readOnly:!0})],F.prototype,"objectIdField",null),(0,n._)([(0,h.Cb)({type:String,readOnly:!0})],F.prototype,"globalIdField",null),(0,n._)([(0,h.Cb)({readOnly:!0,type:String,json:{read:!1}})],F.prototype,"displayField",null),(0,n._)([(0,h.Cb)({readOnly:!0,type:String})],F.prototype,"apiKey",null),(0,n._)([(0,h.Cb)({readOnly:!0,type:String})],F.prototype,"customParameters",null),(0,n._)([(0,h.Cb)({readOnly:!0,type:v.Z})],F.prototype,"fullExtent",null),(0,n._)([(0,h.Cb)({readOnly:!0,type:g.Z})],F.prototype,"spatialReference",null),(0,n._)([(0,h.Cb)({readOnly:!0})],F.prototype,"version",null),(0,n._)([(0,h.Cb)({readOnly:!0,type:M.Z})],F.prototype,"elevationInfo",null),(0,n._)([(0,h.Cb)({readOnly:!0,type:Number})],F.prototype,"minScale",null),(0,n._)([(0,h.Cb)({readOnly:!0,type:Number})],F.prototype,"maxScale",null),(0,n._)([(0,h.Cb)({readOnly:!0,type:Number})],F.prototype,"effectiveScaleRange",null),(0,n._)([(0,h.Cb)({type:["hide","show"],json:{write:!0}})],F.prototype,"listMode",void 0),(0,n._)([(0,h.Cb)({types:I.o,json:{origins:{service:{read:{source:"drawingInfo.renderer"}}},name:"layerDefinition.drawingInfo.renderer",write:!0},value:null})],F.prototype,"renderer",void 0),(0,n._)([(0,h.Cb)({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],F.prototype,"definitionExpression",void 0),(0,n._)([(0,h.Cb)(w.C_)],F.prototype,"popupEnabled",void 0),(0,n._)([(0,h.Cb)({type:s.Z,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],F.prototype,"popupTemplate",void 0),(0,n._)([(0,h.Cb)({readOnly:!0,type:String,json:{origins:{service:{read:{source:"store.normalReferenceFrame"}}},read:!1}})],F.prototype,"normalReferenceFrame",void 0),(0,n._)([(0,h.Cb)({readOnly:!0,json:{read:!1}})],F.prototype,"defaultPopupTemplate",null),(0,n._)([(0,h.Cb)()],F.prototype,"types",null),(0,n._)([(0,h.Cb)()],F.prototype,"typeIdField",null),(0,n._)([(0,h.Cb)({json:{write:!1}}),(0,p.J)(new l.X({"3DObject":"3d-object",Point:"point"}))],F.prototype,"layerType",void 0),(0,n._)([(0,h.Cb)()],F.prototype,"geometryType",null),(0,n._)([(0,h.Cb)()],F.prototype,"profile",null),(0,n._)([(0,h.Cb)({readOnly:!0,json:{read:!1}})],F.prototype,"capabilities",null),(0,n._)([(0,h.Cb)({readOnly:!0})],F.prototype,"statisticsInfo",void 0),F=(0,n._)([(0,f.j)("esri.layers.buildingSublayers.BuildingComponentSublayer")],F);const N=F},84201:function(e,t,i){i.d(t,{Z:function(){return m}});var n,r=i(73440),s=i(43254),o=i(332),a=i(8914),l=i(17155),c=(i(61432),i(96711),i(83850),i(48023)),u=i(51389),d=i(28693);const h={type:s.Z,readOnly:!0,json:{origins:{service:{read:{source:"sublayers",reader:p}}},read:!1}};function p(e,t,i){if(e&&Array.isArray(e))return new s.Z(e.map((e=>{const t=function(e){return"group"===e.layerType?m:u.Z}(e);if(t){const n=new t;return n.read(e,i),n}return i?.messages&&e&&i.messages.push(new a.Z("building-scene-layer:unsupported-sublayer-type","Building scene sublayer of type '"+(e.type||"unknown")+"' are not supported",{definition:e,context:i})),null})))}let m=n=class extends d.Z{constructor(e){super(e),this.type="building-group",this.listMode="show",this.sublayers=null}loadAll(){return(0,o.w)(this,(e=>n.forEachSublayer(this.sublayers,(t=>{"building-group"!==t.type&&e(t)}))))}};(0,r._)([(0,l.Cb)({type:["hide","show","hide-children"],json:{write:!0}})],m.prototype,"listMode",void 0),(0,r._)([(0,l.Cb)(h)],m.prototype,"sublayers",void 0),m=n=(0,r._)([(0,c.j)("esri.layers.buildingSublayers.BuildingGroupSublayer")],m),function(e){e.sublayersProperty=h,e.readSublayers=p,e.forEachSublayer=function e(t,i){t.forEach((t=>{i(t),"building-group"===t.type&&e(t.sublayers,i)}))}}(m||(m={}))},28693:function(e,t,i){i.d(t,{Z:function(){return d}});var n=i(73440),r=i(15894),s=i(84060),o=i(17155),a=i(95226),l=(i(61432),i(83850),i(1194)),c=i(48023),u=i(93295);let d=class extends(r.Z.IdentifiableMixin(s.w)){constructor(e){super(e),this.title="",this.id=-1,this.modelName=null,this.isEmpty=null,this.legendEnabled=!0,this.visible=!0,this.opacity=1}readTitle(e,t){return"string"==typeof t.alias?t.alias:"string"==typeof t.name?t.name:""}readIdOnlyOnce(e){return-1!==this.id?this.id:"number"==typeof e?e:-1}};(0,n._)([(0,o.Cb)({type:String,json:{origins:{"web-scene":{write:!0},"portal-item":{write:!0}}}})],d.prototype,"title",void 0),(0,n._)([(0,l.r)("service","title",["alias","name"])],d.prototype,"readTitle",null),(0,n._)([(0,o.Cb)()],d.prototype,"layer",void 0),(0,n._)([(0,o.Cb)({type:a.z8,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,isRequired:!0}}})],d.prototype,"id",void 0),(0,n._)([(0,l.r)("service","id")],d.prototype,"readIdOnlyOnce",null),(0,n._)([(0,o.Cb)((0,u.Lx)(String))],d.prototype,"modelName",void 0),(0,n._)([(0,o.Cb)((0,u.Lx)(Boolean))],d.prototype,"isEmpty",void 0),(0,n._)([(0,o.Cb)({type:Boolean,nonNullable:!0})],d.prototype,"legendEnabled",void 0),(0,n._)([(0,o.Cb)({type:Boolean,json:{name:"visibility",write:!0}})],d.prototype,"visible",void 0),(0,n._)([(0,o.Cb)({type:Number,json:{write:!0}})],d.prototype,"opacity",void 0),d=(0,n._)([(0,c.j)("esri.layers.buildingSublayers.BuildingSublayer")],d)},27936:function(e,t,i){function n(e){return"point"===e.type}i.d(t,{f:function(){return n}})},38448:function(e,t,i){i.d(t,{V:function(){return o}});var n=i(73440),r=i(17155),s=(i(61432),i(96711),i(83850),i(48023));const o=e=>{let t=class extends e{get apiKey(){return this._isOverridden("apiKey")?this._get("apiKey"):"portalItem"in this?this.portalItem?.apiKey:null}set apiKey(e){null!=e?this._override("apiKey",e):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return(0,n._)([(0,r.Cb)({type:String})],t.prototype,"apiKey",null),t=(0,n._)([(0,s.j)("esri.layers.mixins.APIKeyMixin")],t),t}},58560:function(e,t,i){i.d(t,{Y:function(){return l}});var n=i(73440),r=i(96711),s=i(17155),o=(i(61432),i(83850),i(48023)),a=i(66619);const l=e=>{let t=class extends e{get title(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){const e=(0,a.Qc)(this.url);if(e?.title)return e.title}return this._get("title")||""}set title(e){this._set("title",e)}set url(e){this._set("url",(0,a.Nm)(e,r.Z.getLogger(this)))}};return(0,n._)([(0,s.Cb)()],t.prototype,"title",null),(0,n._)([(0,s.Cb)({type:String})],t.prototype,"url",null),t=(0,n._)([(0,o.j)("esri.layers.mixins.ArcGISService")],t),t}},95060:function(e,t,i){i.d(t,{xp:function(){return D},Vt:function(){return k}});var n=i(73440),r=i(78619),s=i(88194),o=i(96711),a=i(93568),l=i(95490),c=i(17155),u=(i(61432),i(83850),i(1194)),d=i(48023),h=i(29884),p=i(34058),m=i(71354),f=i(86640),v=i(45213),g=i(66619),y=i(93295),b=i(57085);let _=null;function w(){return _}var C=i(77601),x=i(96193),E=i(39438),S=i(79922),T=i(68875);const k=e=>{let t=class extends e{constructor(){super(...arguments),this.spatialReference=null,this.fullExtent=null,this.heightModelInfo=null,this.minScale=0,this.maxScale=0,this.version={major:Number.NaN,minor:Number.NaN,versionString:""},this.copyright=null,this.sublayerTitleMode="item-title",this.title=null,this.layerId=null,this.indexInfo=null,this._debouncedSaveOperations=(0,a.Ds)((async(e,t,i)=>{switch(e){case D.SAVE:return this._save(t);case D.SAVE_AS:return this._saveAs(i,t)}}))}readSpatialReference(e,t){return P(t)}readFullExtent(e,t,i){if(null!=e&&"object"==typeof e){const n=null==e.spatialReference?{...e,spatialReference:P(t)}:e;return m.Z.fromJSON(n,i)}const n=t.store,r=P(t);return null==r||null==n?.extent||!Array.isArray(n.extent)||n.extent.some((e=>e<I))?null:new m.Z({xmin:n.extent[0],ymin:n.extent[1],xmax:n.extent[2],ymax:n.extent[3],spatialReference:r})}parseVersionString(e){const t={major:Number.NaN,minor:Number.NaN,versionString:e},i=e.split(".");return i.length>=2&&(t.major=parseInt(i[0],10),t.minor=parseInt(i[1],10)),t}readVersion(e,t){const i=t.store,n=null!=i.version?i.version.toString():"";return this.parseVersionString(n)}readTitlePortalItem(e){return"item-title"!==this.sublayerTitleMode?void 0:e}readTitleService(e,t){const i=this.portalItem?.title;if("item-title"===this.sublayerTitleMode)return this.url?(0,g.a7)(this.url,t.name):t.name;let n=t.name;if(!n&&this.url){const e=(0,g.Qc)(this.url);null!=e&&(n=e.title)}return"item-title-and-service-name"===this.sublayerTitleMode&&i&&(n=i+" - "+n),(0,g.ld)(n)}set url(e){if(null==e)return void this._set("url",e);const t=(0,g.XG)({layer:this,url:e,nonStandardUrlAllowed:!1,logger:o.Z.getLogger(this)});this._set("url",t.url),null!=t.layerId&&this._set("layerId",t.layerId)}writeUrl(e,t,i,n){(0,g.wH)(this,e,"layers",t,n)}get parsedUrl(){const e=this._get("url"),t=(0,l.mN)(e);return t&&null!=this.layerId&&(t.path=`${t.path}/layers/${this.layerId}`),t}async _fetchIndexAndUpdateExtent(e,t){this.indexInfo=(0,b.T)(this.parsedUrl?.path??"",this.rootNode,e,this.customParameters,this.apiKey,o.Z.getLogger(this),t),null==this.fullExtent||this.fullExtent.hasZ||this._updateExtent(await this.indexInfo)}_updateExtent(e){if("page"===e?.type){const t=e.rootIndex%e.pageSize,i=e.rootPage?.nodes?.[t];if(null==i?.obb?.center||null==i.obb.halfSize)throw new s.Z("sceneservice:invalid-node-page","Invalid node page.");if(i.obb.center[0]<I||null==this.fullExtent||this.fullExtent.hasZ)return;const n=i.obb.halfSize,r=i.obb.center[2],o=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);this.fullExtent.zmin=r-o,this.fullExtent.zmax=r+o}else if("node"===e?.type){const t=e.rootNode?.mbs;if(!Array.isArray(t)||4!==t.length||t[0]<I)return;const i=t[2],n=t[3],{fullExtent:r}=this;r&&(r.zmin=i-n,r.zmax=i+n)}}async _fetchService(e){if(null==this.url)throw new s.Z("sceneservice:url-not-set","Scene service can not be loaded without valid portal item or url");if(null==this.layerId&&/SceneServer\/*$/i.test(this.url)){const t=await this._fetchFirstLayerId(e);null!=t&&(this.layerId=t)}return this._fetchServiceLayer(e)}async _fetchFirstLayerId(e){const t=await(0,r.Z)(this.url??"",{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:e});if(t.data&&Array.isArray(t.data.layers)&&t.data.layers.length>0)return t.data.layers[0].id}async _fetchServiceLayer(e){const t=await(0,r.Z)(this.parsedUrl?.path??"",{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:e});t.ssl&&this.url&&(this.url=this.url.replace(/^http:/i,"https:"));let i=!1;if(t.data.layerType&&"Voxel"===t.data.layerType&&(i=!0),i)return this._fetchVoxelServiceLayer();const n=t.data;this.read(n,this._getServiceContext()),this.validateLayer(n)}async _fetchVoxelServiceLayer(e){const t=(await(0,r.Z)(this.parsedUrl?.path+"/layer",{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:e})).data;this.read(t,this._getServiceContext()),this.validateLayer(t)}_getServiceContext(){return{origin:"service",portalItem:this.portalItem,portal:this.portalItem?.portal,url:this.parsedUrl}}async _ensureLoadBeforeSave(){await this.load(),"beforeSave"in this&&"function"==typeof this.beforeSave&&await this.beforeSave()}validateLayer(e){}async _saveAs(e,t){const i={...A,...t};let n=x.default.from(e);if(!n)throw new s.Z("sceneservice:portal-item-required","_saveAs() requires a portal item to save to");n.id&&(n=n.clone(),n.id=null);const r=n.portal||C.Z.getDefault();await this._ensureLoadBeforeSave(),n.type=R,n.portal=r;const o=(0,E.Y)(n,"portal-item",!0),a={layers:[this.write({},o)]};return await Promise.all(o.resources.pendingOperations??[]),await this._validateAgainstJSONSchema(a,o,i),this.url&&(n.url=this.url),n.title||(n.title=this.title),O(n,i,L.newItem),await r.signIn(),await r.user.addItem({item:n,folder:i?.folder,data:a}),await(0,S.H)(this.resourceReferences,o),this.portalItem=n,(0,p.D)(o),o.portalItem=n,n}async _save(e){const t={...A,...e};if(!this.portalItem)throw new s.Z("sceneservice:portal-item-not-set","Portal item to save to has not been set on this SceneService");if(this.portalItem.type!==R)throw new s.Z("sceneservice:portal-item-wrong-type",`Portal item needs to have type "${R}"`);await this._ensureLoadBeforeSave();const i=(0,E.Y)(this.portalItem,"portal-item",!0),n={layers:[this.write({},i)]};return await Promise.all(i.resources.pendingOperations??[]),await this._validateAgainstJSONSchema(n,i,t),this.url&&(this.portalItem.url=this.url),this.portalItem.title||(this.portalItem.title=this.title),O(this.portalItem,t,L.existingItem),await(0,S.b)(this.portalItem,n,this.resourceReferences,i),(0,p.D)(i),this.portalItem}async _validateAgainstJSONSchema(e,t,i){const n=i?.validationOptions;(0,T.zC)(t,{errorName:"sceneservice:save"},{ignoreUnsupported:n?.ignoreUnsupported,supplementalUnsupportedErrors:["scenemodification:unsupported"]});const r=n?.enabled,a=w();if(r&&a){const t=(await a()).validate(e,i.portalItemLayerType);if(!t.length)return;const r=`Layer item did not validate:\n${t.join("\n")}`;if(o.Z.getLogger(this).error(`_validateAgainstJSONSchema(): ${r}`),"throw"===n.failPolicy){const e=t.map((e=>new s.Z("sceneservice:schema-validation",e)));throw new s.Z("sceneservice-validate:error","Failed to save layer item due to schema validation, see `details.errors`.",{validationErrors:e})}}}};return(0,n._)([(0,c.Cb)(y.id)],t.prototype,"id",void 0),(0,n._)([(0,c.Cb)({type:v.Z})],t.prototype,"spatialReference",void 0),(0,n._)([(0,u.r)("spatialReference",["spatialReference","store.indexCRS","store.geographicCRS"])],t.prototype,"readSpatialReference",null),(0,n._)([(0,c.Cb)({type:m.Z})],t.prototype,"fullExtent",void 0),(0,n._)([(0,u.r)("fullExtent",["fullExtent","store.extent","spatialReference","store.indexCRS","store.geographicCRS"])],t.prototype,"readFullExtent",null),(0,n._)([(0,c.Cb)({readOnly:!0,type:f.Z})],t.prototype,"heightModelInfo",void 0),(0,n._)([(0,c.Cb)({type:Number,json:{name:"layerDefinition.minScale",write:!0,origins:{service:{read:{source:"minScale"},write:!1}}}})],t.prototype,"minScale",void 0),(0,n._)([(0,c.Cb)({type:Number,json:{name:"layerDefinition.maxScale",write:!0,origins:{service:{read:{source:"maxScale"},write:!1}}}})],t.prototype,"maxScale",void 0),(0,n._)([(0,c.Cb)({readOnly:!0})],t.prototype,"version",void 0),(0,n._)([(0,u.r)("version",["store.version"])],t.prototype,"readVersion",null),(0,n._)([(0,c.Cb)({type:String,json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),(0,n._)([(0,c.Cb)({type:String,json:{read:!1}})],t.prototype,"sublayerTitleMode",void 0),(0,n._)([(0,c.Cb)({type:String})],t.prototype,"title",void 0),(0,n._)([(0,u.r)("portal-item","title")],t.prototype,"readTitlePortalItem",null),(0,n._)([(0,u.r)("service","title",["name"])],t.prototype,"readTitleService",null),(0,n._)([(0,c.Cb)({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{write:{target:"id",isRequired:!0,ignoreOrigin:!0},read:!1}}}})],t.prototype,"layerId",void 0),(0,n._)([(0,c.Cb)(y.HQ)],t.prototype,"url",null),(0,n._)([(0,h.c)("url")],t.prototype,"writeUrl",null),(0,n._)([(0,c.Cb)()],t.prototype,"parsedUrl",null),(0,n._)([(0,c.Cb)({readOnly:!0})],t.prototype,"store",void 0),(0,n._)([(0,c.Cb)({type:String,readOnly:!0,json:{read:{source:"store.rootNode"}}})],t.prototype,"rootNode",void 0),t=(0,n._)([(0,d.j)("esri.layers.mixins.SceneService")],t),t},I=-1e38;function P(e){if(null!=e.spatialReference)return v.Z.fromJSON(e.spatialReference);const t=e.store,i=t.indexCRS||t.geographicCRS,n=i&&parseInt(i.slice(i.lastIndexOf("/")+1),10);return null!=n?new v.Z(n):null}function O(e,t,i){e.typeKeywords||(e.typeKeywords=[]);const n=t.getTypeKeywords();for(const t of n)e.typeKeywords.push(t);e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter(((e,t,i)=>i.indexOf(e)===t)),i===L.newItem&&(e.typeKeywords=e.typeKeywords.filter((e=>"Hosted Service"!==e))))}var L,M;(M=L||(L={}))[M.existingItem=0]="existingItem",M[M.newItem=1]="newItem";const R="Scene Service",A={getTypeKeywords:()=>[],portalItemLayerType:"unknown",validationOptions:{enabled:!0,ignoreUnsupported:!1,failPolicy:"throw"}};var D;!function(e){e[e.SAVE=0]="SAVE",e[e.SAVE_AS=1]="SAVE_AS"}(D||(D={}))},7961:function(e,t,i){i.d(t,{Z:function(){return T}});var n=i(73440),r=i(43254),s=i(63255),o=i(28947),a=i(18764),l=i(17155),c=(i(61432),i(96711),i(48023));i(83850);let u=class extends s.Z{constructor(){super(...arguments),this.type=null}};(0,n._)([(0,l.Cb)({type:String,readOnly:!0,json:{write:{isRequired:!0}}})],u.prototype,"type",void 0),u=(0,n._)([(0,c.j)("esri.layers.support.BuildingFilterAuthoringInfo")],u);const d=u;var h;let p=h=class extends s.Z{constructor(){super(...arguments),this.filterType=null,this.filterValues=null}clone(){return new h({filterType:this.filterType,filterValues:(0,o.d9)(this.filterValues)})}};(0,n._)([(0,l.Cb)({type:String,json:{write:{isRequired:!0}}})],p.prototype,"filterType",void 0),(0,n._)([(0,l.Cb)({type:[String],json:{write:{isRequired:!0}}})],p.prototype,"filterValues",void 0),p=h=(0,n._)([(0,c.j)("esri.layers.support.BuildingFilterAuthoringInfoType")],p);const m=p;var f;const v=r.Z.ofType(m);let g=f=class extends s.Z{clone(){return new f({filterTypes:(0,o.d9)(this.filterTypes)})}};(0,n._)([(0,l.Cb)({type:v,json:{write:{isRequired:!0}}})],g.prototype,"filterTypes",void 0),g=f=(0,n._)([(0,c.j)("esri.layers.support.BuildingFilterAuthoringInfoBlock")],g);const y=g;var b;const _=r.Z.ofType(y);let w=b=class extends d{constructor(){super(...arguments),this.type="checkbox"}clone(){return new b({filterBlocks:(0,o.d9)(this.filterBlocks)})}};(0,n._)([(0,l.Cb)({type:["checkbox"]})],w.prototype,"type",void 0),(0,n._)([(0,l.Cb)({type:_,json:{write:{isRequired:!0}}})],w.prototype,"filterBlocks",void 0),w=b=(0,n._)([(0,c.j)("esri.layers.support.BuildingFilterAuthoringInfoCheckbox")],w);const C=w;var x,E=i(52031);const S=r.Z.ofType(E.Z);let T=x=class extends s.Z{constructor(){super(...arguments),this.description=null,this.filterBlocks=null,this.id=(0,a.DO)(),this.name=null}clone(){return new x({description:this.description,filterBlocks:(0,o.d9)(this.filterBlocks),id:this.id,name:this.name,filterAuthoringInfo:(0,o.d9)(this.filterAuthoringInfo)})}};(0,n._)([(0,l.Cb)({type:String,json:{write:!0}})],T.prototype,"description",void 0),(0,n._)([(0,l.Cb)({type:S,json:{write:{enabled:!0,isRequired:!0}}})],T.prototype,"filterBlocks",void 0),(0,n._)([(0,l.Cb)({types:{key:"type",base:d,typeMap:{checkbox:C}},json:{read:e=>"checkbox"===e?.type?C.fromJSON(e):null,write:!0}})],T.prototype,"filterAuthoringInfo",void 0),(0,n._)([(0,l.Cb)({type:String,constructOnly:!0,json:{write:{enabled:!0,isRequired:!0}}})],T.prototype,"id",void 0),(0,n._)([(0,l.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],T.prototype,"name",void 0),T=x=(0,n._)([(0,c.j)("esri.layers.support.BuildingFilter")],T)},52031:function(e,t,i){i.d(t,{Z:function(){return b}});var n,r=i(73440),s=i(63255),o=i(28947),a=i(17155),l=(i(61432),i(96711),i(48023)),c=i(2615),u=i(5030),d=i(79775),h=i(34440);let p=n=class extends c.Z{constructor(){super(...arguments),this.type="wire-frame",this.edges=null}clone(){return new n({edges:(0,o.d9)(this.edges)})}};(0,r._)([(0,d.J)({wireFrame:"wire-frame"})],p.prototype,"type",void 0),(0,r._)([(0,a.Cb)(h.Z)],p.prototype,"edges",void 0),p=n=(0,r._)([(0,l.j)("esri.layers.support.BuildingFilterModeWireFrame")],p);const m=p;var f,v=i(69801);const g={nonNullable:!0,types:{key:"type",base:c.Z,typeMap:{solid:u.Z,"wire-frame":m,"x-ray":v.Z}},json:{read:e=>{switch(e?.type){case"solid":return u.Z.fromJSON(e);case"wireFrame":return m.fromJSON(e);case"x-ray":return v.Z.fromJSON(e);default:return}},write:{enabled:!0,isRequired:!0}}};let y=f=class extends s.Z{constructor(){super(...arguments),this.filterExpression=null,this.filterMode=new u.Z,this.title=""}clone(){return new f({filterExpression:this.filterExpression,filterMode:(0,o.d9)(this.filterMode),title:this.title})}};(0,r._)([(0,a.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],y.prototype,"filterExpression",void 0),(0,r._)([(0,a.Cb)(g)],y.prototype,"filterMode",void 0),(0,r._)([(0,a.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],y.prototype,"title",void 0),y=f=(0,r._)([(0,l.j)("esri.layers.support.BuildingFilterBlock")],y);const b=y},2615:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(73440),r=i(63255),s=i(17155),o=(i(61432),i(96711),i(83850),i(48023));let a=class extends r.Z{};(0,n._)([(0,s.Cb)({readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],a.prototype,"type",void 0),a=(0,n._)([(0,o.j)("esri.layers.support.BuildingFilterMode")],a);const l=a},5030:function(e,t,i){i.d(t,{Z:function(){return c}});var n,r=i(73440),s=i(17155),o=(i(61432),i(96711),i(83850),i(48023)),a=i(2615);let l=n=class extends a.Z{constructor(){super(...arguments),this.type="solid"}clone(){return new n}};(0,r._)([(0,s.Cb)({type:["solid"],readOnly:!0,json:{write:{isRequired:!0}}})],l.prototype,"type",void 0),l=n=(0,r._)([(0,o.j)("esri.layers.support.BuildingFilterModeSolid")],l);const c=l},69801:function(e,t,i){i.d(t,{Z:function(){return c}});var n,r=i(73440),s=i(17155),o=(i(61432),i(96711),i(83850),i(48023)),a=i(2615);let l=n=class extends a.Z{constructor(){super(...arguments),this.type="x-ray"}clone(){return new n}};(0,r._)([(0,s.Cb)({type:["x-ray"],readOnly:!0,json:{write:{isRequired:!0}}})],l.prototype,"type",void 0),l=n=(0,r._)([(0,o.j)("esri.layers.support.BuildingFilterModeXRay")],l);const c=l},58086:function(e,t,i){i.d(t,{ElevationQuery:function(){return y},e:function(){return b}});var n=i(29292),r=i(88194),s=i(61100),o=i(93568),a=i(26636),l=i(82868),c=i(60508),u=i(62197),d=i(13132),h=i(47566),p=i(62535),m=i(5135);class f{constructor(e,t=null){if(this.tile=e,null!=t&&null!=e){const i=e.extent;this._samplerData=new m.K(t,i)}}get zmin(){return null!=this._samplerData?this._samplerData.data.minValue:0}get zmax(){return null!=this._samplerData?this._samplerData.data.maxValue:0}get hasNoDataValues(){return!!this._samplerData?.data.hasNoDataValues}sample(e,t){if(null==this._samplerData)return;const{safeWidth:i,data:n,dx:r,dy:s,y1:o,x0:a}=this._samplerData,{width:l,values:c,noDataValue:u}=n,d=v(s*(o-t),0,i),h=v(r*(e-a),0,i),p=Math.floor(d),m=Math.floor(h),f=p*l+m,g=f+l,y=c[f],b=c[g],_=c[f+1],w=c[g+1];if(y!==u&&b!==u&&_!==u&&w!==u){const e=h-m,t=y+(_-y)*e;return t+(b+(w-b)*e-t)*(d-p)}}}function v(e,t,i){return e<t?t:e>i?i:e}var g=i(31743);class y{async queryAll(e,t,i){if(!(e=i?.ignoreInvisibleLayers?e.filter((e=>e.visible)):e.slice()).length)throw new r.Z("elevation-query:invalid-layer","Elevation queries require at least one elevation layer to fetch tiles from");const n=b.fromGeometry(t);let s=!1;i?.returnSampleInfo||(s=!0);const o={...S,...i,returnSampleInfo:!0},a=await this.query(e[e.length-1],n,o),l=await this._queryAllContinue(e,a,o);return l.geometry=l.geometry.export(),s&&delete l.sampleInfo,l}async query(e,t,i){if(!e)throw new r.Z("elevation-query:invalid-layer","Elevation queries require an elevation layer to fetch tiles from");if(!t||!(t instanceof b)&&"point"!==t.type&&"multipoint"!==t.type&&"polyline"!==t.type)throw new r.Z("elevation-query:invalid-geometry","Only point, polyline and multipoint geometries can be used to query elevation");const n={...S,...i},o=new C(e,t.spatialReference,n),l=n.signal;return await e.load({signal:l}),await async function(e,t,i){let n;const s=e.layer.tileInfo.spatialReference;if(t instanceof b?n=await t.project(s,i):(await(0,d.initializeProjection)([{source:t.spatialReference,dest:s}],{signal:i}),n=(0,d.project)(t,s)),!n)throw new r.Z("elevation-query:spatial-reference-mismatch",`Cannot query elevation in '${t.spatialReference.wkid}' on an elevation service in '${s.wkid}'`);e.geometry=b.fromGeometry(n)}(o,t,l),await this._selectTiles(o,l),await k(o,l),function(e){e.geometry.coordinates.forEach((t=>{const i=t.elevationTile;let n=e.options.noDataValue;if(i){const e=i.sample(t.x,t.y);null!=e?n=e:t.elevationTile=null}t.z=n}))}(o),async function(e,t){const i=await e.geometry.project(e.outSpatialReference,t);(0,s.O3)(i);const n={geometry:i.export(),noDataValue:e.options.noDataValue};return e.options.returnSampleInfo&&(n.sampleInfo=function(e){const t=e.layer.tileInfo,i=(0,a.c9)(t.spatialReference);return e.geometry.coordinates.map((n=>{let r=-1;return n.elevationTile&&n.elevationTile!==e.outsideExtentTile&&(r=t.lodAt(n.elevationTile.tile.level).resolution*i),{demResolution:r}}))}(e)),e.geometry.coordinates.forEach((e=>{e.tile=null,e.elevationTile=null})),n}(o,l)}async createSampler(e,t,i){if(!e)throw new r.Z("elevation-query:invalid-layer","Elevation queries require an elevation layer to fetch tiles from");if(!t||"extent"!==t.type)throw new r.Z("elevation-query:invalid-extent","Invalid or undefined extent");const n={...S,...i};return this._createSampler(e,t,n)}async createSamplerAll(e,t,i){if(!(e=i?.ignoreInvisibleLayers?e.filter((e=>e.visible)):e.slice()).length)throw new r.Z("elevation-query:invalid-layer","Elevation queries require at least one elevation layer to fetch tiles from");if(!t||"extent"!==t.type)throw new r.Z("elevation-query:invalid-extent","Invalid or undefined extent");const n={...S,...i,returnSampleInfo:!0},s=await this._createSampler(e[e.length-1],t,n);return this._createSamplerAllContinue(e,t,s,n)}async _createSampler(e,t,i,n){const r=i.signal;await e.load({signal:r});const s=t.spatialReference,o=e.tileInfo.spatialReference;s.equals(o)||(await(0,d.initializeProjection)([{source:s,dest:o}],{signal:r}),t=(0,d.project)(t,o));const a=new x(e,t,i,n);return await this._selectTiles(a,r),await k(a,r),new p.Tl(a.elevationTiles,a.layer.tileInfo,a.options.noDataValue)}async _createSamplerAllContinue(e,t,i,n){if(e.pop(),!e.length)return i;const r=i.samplers.filter((e=>!e.tile.hasNoDataValues)).map((e=>(0,h.oJ)(e.extent))),s=await this._createSampler(e[e.length-1],t,n,r);if(0===s.samplers.length)return i;const o=i.samplers.concat(s.samplers),a=new p.Tl(o,n.noDataValue);return this._createSamplerAllContinue(e,t,a,n)}async _queryAllContinue(e,t,i){const n=e.pop(),r=t.geometry.coordinates,o=t.sampleInfo;(0,s.O3)(o);const a=[],l=[];for(let t=0;t<r.length;t++){const i=o[t];i.demResolution>=0?i.source||(i.source=n):e.length&&(a.push(r[t]),l.push(t))}if(!e.length||0===a.length)return t;const c=t.geometry.clone(a),u=await this.query(e[e.length-1],c,i),d=u.sampleInfo;if(!d)throw new Error("no sampleInfo");return l.forEach(((e,t)=>{r[e].z=u.geometry.coordinates[t].z,o[e].demResolution=d[t].demResolution})),this._queryAllContinue(e,t,i)}async _selectTiles(e,t){"geometry"===e.type&&function(e){if(null==e.layer.fullExtent)return;const t=new f(null);t.sample=()=>e.options.noDataValue,e.outsideExtentTile=t;const i=e.layer.fullExtent;e.geometry.coordinates.forEach((e=>{const n=e.x,r=e.y;(n<i.xmin||n>i.xmax||r<i.ymin||r>i.ymax)&&(e.elevationTile=t)}))}(e);const i=e.options.demResolution;if("number"==typeof i)!function(e,t){const i=function(e,t){const{tileInfo:i,tilemapCache:n}=e.layer,r=t/(0,a.c9)(i.spatialReference),s=T(i,n);let o=s[0],l=0;for(let e=1;e<s.length;e++){const t=s[e];Math.abs(t.resolution-r)<Math.abs(o.resolution-r)&&(o=t,l=e)}return l}(e,t);e.selectTilesAtLOD(i)}(e,i);else if("finest-contiguous"===i)await this._selectTilesFinestContiguous(e,t);else{if("auto"!==i)throw new r.Z("elevation-query:invalid-dem-resolution",`Invalid dem resolution value '${i}', expected a number, "finest-contiguous" or "auto"`);await this._selectTilesAuto(e,t)}}async _selectTilesFinestContiguous(e,t){const{tileInfo:i,tilemapCache:n}=e.layer,r=E(i,n,e.options.minDemResolution);await this._selectTilesFinestContiguousAt(e,r,t)}async _selectTilesFinestContiguousAt(e,t,i){const n=e.layer;if(e.selectTilesAtLOD(t),t<0)return;const s=n.tilemapCache,a=e.getTilesToFetch();try{if(s&&!P(s))await(0,o.Hl)(Promise.all(a.map((e=>s.fetchAvailability(e.level,e.row,e.col,{signal:i})))),i);else if(await k(e,i),!e.allElevationTilesFetched())throw e.clearElevationTiles(),new r.Z("elevation-query:has-unavailable-tiles","Some elevation tiles are unavailable")}catch(n){(0,o.r9)(n),await this._selectTilesFinestContiguousAt(e,t-1,i)}}async _selectTilesAuto(e,t){(function(e){const{tileInfo:t,tilemapCache:i}=e.layer,n=E(t,i,e.options.minDemResolution);e.selectTilesAtLOD(n,e.options.maximumAutoTileRequests)})(e),function(e){const t=e.layer.tileInfo;let i=0;const n={},r=e=>{null!=e.id&&(e.id in n?n[e.id]++:(n[e.id]=1,i++))},s=e=>{if(null==e.id)return;const t=n[e.id];1===t?(delete n[e.id],i--):n[e.id]=t-1};e.forEachTileToFetch(r,s);let o=!0;for(;o&&(o=!1,e.forEachTileToFetch((n=>{i<=e.options.maximumAutoTileRequests||(s(n),t.upsampleTile(n)&&(o=!0),r(n))}),s),o););}(e);const i=e.layer.tilemapCache;if(!i||P(i))return this._selectTilesAutoPrefetchUpsample(e,t);const r=e.getTilesToFetch(),s={},a=r.map((async e=>{const r=new g.f(null,0,0,0,(0,h.Ue)()),a=await(0,n.q6)(i.fetchAvailabilityUpsample(e.level,e.row,e.col,r,{signal:t}));!1!==a.ok?null!=e.id&&(s[e.id]=r):(0,o.r9)(a.error)}));await(0,o.Hl)(Promise.all(a),t),e.remapTiles(s)}async _selectTilesAutoPrefetchUpsample(e,t){const i=e.layer.tileInfo;await k(e,t);let n=!1;e.forEachTileToFetch(((e,t)=>{i.upsampleTile(e)?n=!0:t()})),n&&await this._selectTilesAutoPrefetchUpsample(e,t)}}class b{export(){return this._exporter(this.coordinates,this.spatialReference)}clone(e){const t=new b;return t.geometry=this.geometry,t.spatialReference=this.spatialReference,t.coordinates=e||this.coordinates.map((e=>e.clone())),t._exporter=this._exporter,t}async project(e,t){if(this.spatialReference.equals(e))return this.clone();await(0,d.initializeProjection)([{source:this.spatialReference,dest:e}],{signal:t});const i=new l.Z({spatialReference:this.spatialReference,points:this.coordinates.map((e=>[e.x,e.y]))}),n=(0,d.project)(i,e);if(!n)return null;const r=this.coordinates.map(((e,t)=>{const i=e.clone(),r=n.points[t];return i.x=r[0],i.y=r[1],i})),s=this.clone(r);return s.spatialReference=e,s}static fromGeometry(e){const t=new b;if(t.geometry=e,t.spatialReference=e.spatialReference,e instanceof b)t.coordinates=e.coordinates.map((e=>e.clone())),t._exporter=(t,i)=>{const n=e.clone(t);return n.spatialReference=i,n};else switch(e.type){case"point":{const i=e,{hasZ:n,hasM:r}=i;t.coordinates=n&&r?[new _(i.x,i.y,i.z,i.m)]:n?[new _(i.x,i.y,i.z)]:r?[new _(i.x,i.y,null,i.m)]:[new _(i.x,i.y)],t._exporter=(t,i)=>e.hasM?new c.Z(t[0].x,t[0].y,t[0].z,t[0].m,i):new c.Z(t[0].x,t[0].y,t[0].z,i);break}case"multipoint":{const i=e,{hasZ:n,hasM:r}=i;t.coordinates=n&&r?i.points.map((e=>new _(e[0],e[1],e[2],e[3]))):n?i.points.map((e=>new _(e[0],e[1],e[2]))):r?i.points.map((e=>new _(e[0],e[1],null,e[2]))):i.points.map((e=>new _(e[0],e[1]))),t._exporter=(t,i)=>e.hasM?new l.Z({points:t.map((e=>[e.x,e.y,e.z,e.m])),hasZ:!0,hasM:!0,spatialReference:i}):new l.Z(t.map((e=>[e.x,e.y,e.z])),i);break}case"polyline":{const i=e,n=[],r=[],{hasZ:s,hasM:o}=e;let a=0;for(const e of i.paths)if(r.push([a,a+e.length]),a+=e.length,s&&o)for(const t of e)n.push(new _(t[0],t[1],t[2],t[3]));else if(s)for(const t of e)n.push(new _(t[0],t[1],t[2]));else if(o)for(const t of e)n.push(new _(t[0],t[1],null,t[2]));else for(const t of e)n.push(new _(t[0],t[1]));t.coordinates=n,t._exporter=(t,i)=>{const n=e.hasM?t.map((e=>[e.x,e.y,e.z??0,e.m??0])):t.map((e=>[e.x,e.y,e.z??0])),s=r.map((e=>n.slice(e[0],e[1])));return new u.Z({paths:s,hasM:e.hasM,hasZ:!0,spatialReference:i})};break}}return t}}class _{constructor(e,t,i=null,n=null,r=null,s=null){this.x=e,this.y=t,this.z=i,this.m=n,this.tile=r,this.elevationTile=s}clone(){return new _(this.x,this.y,this.z,this.m)}}class w{constructor(e,t){this.layer=e,this.options=t}}class C extends w{constructor(e,t,i){super(e,i),this.outSpatialReference=t,this.type="geometry"}selectTilesAtLOD(e){if(e<0)this.geometry.coordinates.forEach((e=>e.tile=null));else{const{tileInfo:t,tilemapCache:i}=this.layer,n=T(t,i)[e].level;this.geometry.coordinates.forEach((e=>e.tile=t.tileAt(n,e.x,e.y)))}}allElevationTilesFetched(){return!this.geometry.coordinates.some((e=>!e.elevationTile))}clearElevationTiles(){for(const e of this.geometry.coordinates)e.elevationTile!==this.outsideExtentTile&&(e.elevationTile=null)}populateElevationTiles(e){for(const t of this.geometry.coordinates)!t.elevationTile&&t.tile?.id&&(t.elevationTile=e[t.tile.id])}remapTiles(e){for(const t of this.geometry.coordinates){const i=t.tile?.id;t.tile=i?e[i]:null}}getTilesToFetch(){const e={},t=[];for(const i of this.geometry.coordinates){const n=i.tile;if(!n)continue;const r=i.tile?.id;i.elevationTile||!r||e[r]||(e[r]=n,t.push(n))}return t}forEachTileToFetch(e){for(const t of this.geometry.coordinates)t.tile&&!t.elevationTile&&e(t.tile,(()=>{t.tile=null}))}}class x extends w{constructor(e,t,i,n){super(e,i),this.type="extent",this.elevationTiles=[],this._candidateTiles=[],this._fetchedCandidates=new Set,this.extent=t.clone().intersection(e.fullExtent),this.maskExtents=n}selectTilesAtLOD(e,t){const i=this._maximumLodForRequests(t),n=Math.min(i,e);n<0?this._candidateTiles.length=0:this._selectCandidateTilesCoveringExtentAt(n)}_maximumLodForRequests(e){const{tileInfo:t,tilemapCache:i}=this.layer,n=T(t,i);if(!e)return n.length-1;const r=this.extent;if(null==r)return-1;for(let i=n.length-1;i>=0;i--){const s=n[i],o=s.resolution*t.size[0],a=s.resolution*t.size[1];if(Math.ceil(r.width/o)*Math.ceil(r.height/a)<=e)return i}return-1}allElevationTilesFetched(){return this._candidateTiles.length===this.elevationTiles.length}clearElevationTiles(){this.elevationTiles.length=0,this._fetchedCandidates.clear()}populateElevationTiles(e){for(const t of this._candidateTiles){const i=t.id&&e[t.id];i&&(this._fetchedCandidates.add(t),this.elevationTiles.push(i))}}remapTiles(e){this._candidateTiles=I(this._candidateTiles.map((t=>e[t.id])))}getTilesToFetch(){return this._candidateTiles}forEachTileToFetch(e,t){const i=this._candidateTiles;this._candidateTiles=[],i.forEach((i=>{if(this._fetchedCandidates.has(i))return void(t&&t(i));let n=!1;e(i,(()=>n=!0)),n?t&&t(i):this._candidateTiles.push(i)})),this._candidateTiles=I(this._candidateTiles,t)}_selectCandidateTilesCoveringExtentAt(e){this._candidateTiles.length=0;const t=this.extent;if(null==t)return;const{tileInfo:i,tilemapCache:n}=this.layer,r=T(i,n)[e],s=i.tileAt(r.level,t.xmin,t.ymin),o=s.extent;if(null==o)return;const a=r.resolution*i.size[0],l=r.resolution*i.size[1],c=Math.ceil((t.xmax-o[0])/a),u=Math.ceil((t.ymax-o[1])/l);for(let e=0;e<u;e++)for(let t=0;t<c;t++){const n=new g.f(null,s.level,s.row-e,s.col+t);i.updateTileInfo(n),this._tileIsMasked(n)||this._candidateTiles.push(n)}}_tileIsMasked(e){return!!this.maskExtents&&this.maskExtents.some((t=>e.extent&&(0,h.r3)(t,e.extent)))}}function E(e,t,i=0){const n=T(e,t);let r=n.length-1;if(i>0){const t=i/(0,a.c9)(e.spatialReference),s=n.findIndex((e=>e.resolution<t));0===s?r=0:s>0&&(r=s-1)}return r}const S={maximumAutoTileRequests:20,noDataValue:0,returnSampleInfo:!1,demResolution:"auto",minDemResolution:0};function T(e,t){const i=e.lods;if(P(t)){const{effectiveMinLOD:e,effectiveMaxLOD:n}=t;return i.filter((t=>t.level>=e&&t.level<=n))}return i}async function k(e,t){const i=e.getTilesToFetch(),n={},r=e.options.cache,s=e.options.noDataValue,a=i.map((async i=>{if(null==i.id)return;const o=`${e.layer.uid}:${i.id}:${s}`,a=null!=r?r.get(o):null,l=null!=a?a:await e.layer.fetchTile(i.level,i.row,i.col,{noDataValue:s,signal:t});null!=r&&r.put(o,l),n[i.id]=new f(i,l)}));await(0,o.Hl)(Promise.allSettled(a),t),e.populateElevationTiles(n)}function I(e,t){const i={},n=[];for(const r of e){const e=r.id;e&&!i[e]?(i[e]=r,n.push(r)):t&&t(r)}const r=n.sort(((e,t)=>e.level-t.level));return r.filter(((e,i)=>{for(let n=0;n<i;n++){const i=r[n].extent;if(i&&e.extent&&(0,h.r3)(i,e.extent))return t&&t(e),!1}return!0}))}function P(e){return null!=e?.tileInfo}},42810:function(e,t,i){i.d(t,{b:function(){return n}});class n{constructor(e){this._store=e}destroy(){this._store.destroy()}get(e){return this._store.get(e)}put(e,t){this._store.put(e,t)}}},62535:function(e,t,i){i.d(t,{G$:function(){return p},Tl:function(){return h}});i(61432);var n=i(50702),r=i(96711),s=i(26636),o=i(60508),a=i(47566),l=i(97290);const c=()=>r.Z.getLogger("esri.layers.support.ElevationSampler");class u{queryElevation(e){return p(e.clone(),this)}on(){return(0,n.kB)()}projectIfRequired(e,t){return m(e,t)}}class d extends u{get spatialReference(){return this.extent.spatialReference}constructor(e,t,i){super(),this.tile=e,this.noDataValue=i;const n=e.tile.extent;this.extent=(0,a.HH)(n,t.spatialReference),this.extent.zmin=e.zmin,this.extent.zmax=e.zmax,this._aaExtent=n;const r=(0,s.c9)(t.spatialReference),o=t.lodAt(e.tile.level).resolution*r;this.demResolution={min:o,max:o}}contains(e){const t=this.projectIfRequired(e,this.spatialReference);return null!=t&&this.containsAt(t.x,t.y)}containsAt(e,t){return(0,a.jE)(this._aaExtent,e,t)}elevationAt(e,t){if(!this.containsAt(e,t)){const i=this.extent,n=`${i.xmin}, ${i.ymin}, ${i.xmax}, ${i.ymax}`;return c().warn("#elevationAt()",`Point used to sample elevation (${e}, ${t}) is outside of the sampler extent (${n})`),this.noDataValue}return this.tile.sample(e,t)??this.noDataValue}}class h extends u{get spatialReference(){return this.extent.spatialReference}constructor(e,t,i){let n;super(),"number"==typeof t?(this.noDataValue=t,n=null):(n=t,this.noDataValue=i),this.samplers=n?e.map((e=>new d(e,n,this.noDataValue))):e;const r=this.samplers[0];if(r){this.extent=r.extent.clone();const{min:e,max:t}=r.demResolution;this.demResolution={min:e,max:t};for(let e=1;e<this.samplers.length;e++){const t=this.samplers[e];this.extent.union(t.extent),this.demResolution.min=Math.min(this.demResolution.min,t.demResolution.min),this.demResolution.max=Math.max(this.demResolution.max,t.demResolution.max)}}else this.extent=(0,a.HH)((0,a.Ue)(),n.spatialReference),this.demResolution={min:0,max:0}}elevationAt(e,t){let i,n=!1;for(const r of this.samplers)if(r.containsAt(e,t)&&(n=!0,i=r.elevationAt(e,t),i!==r.noDataValue))return i;return null!=i?i:(n||c().warn("#elevationAt()",`Point used to sample elevation (${e}, ${t}) is outside of the sampler`),this.noDataValue)}}function p(e,t){const i=m(e,t.spatialReference);if(!i)return null;switch(e.type){case"point":!function(e,t,i){e.z=i.elevationAt(t.x,t.y)}(e,i,t);break;case"polyline":!function(e,t,i){f.spatialReference=t.spatialReference;const n=e.hasM&&!e.hasZ;for(let r=0;r<e.paths.length;r++){const s=e.paths[r],o=t.paths[r];for(let e=0;e<s.length;e++){const t=s[e],r=o[e];f.x=r[0],f.y=r[1],n&&(t[3]=t[2]),t[2]=i.elevationAt(f.x,f.y)}}e.hasZ=!0}(e,i,t);break;case"multipoint":!function(e,t,i){f.spatialReference=t.spatialReference;const n=e.hasM&&!e.hasZ;for(let r=0;r<e.points.length;r++){const s=e.points[r],o=t.points[r];f.x=o[0],f.y=o[1],n&&(s[3]=s[2]),s[2]=i.elevationAt(f.x,f.y)}e.hasZ=!0}(e,i,t)}return e}function m(e,t){if(null==e)return null;const i=e.spatialReference;if(i.equals(t))return e;const n=(0,l.iV)(e,t);return n||c().error(`Cannot project geometry spatial reference (wkid:${i.wkid}) to elevation sampler spatial reference (wkid:${t.wkid})`),n}const f=new o.Z},5135:function(e,t,i){i.d(t,{K:function(){return n}});class n{constructor(e,t){this.data=e,this.safeWidth=.99999999*(e.width-1),this.dx=(e.width-1)/(t[2]-t[0]),this.dy=(e.width-1)/(t[3]-t[1]),this.x0=t[0],this.y1=t[3]}}},35130:function(e,t,i){i.d(t,{Z:function(){return h}});var n=i(73440),r=i(89314),s=i(63255),o=i(17155),a=(i(61432),i(96711),i(83850),i(1194)),l=i(48023),c=i(29884),u=i(76746),d=i(11755);let h=class extends(r.Z.ClonableMixin(s.Z)){constructor(e){super(e),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(e){const t={};for(const i of Object.keys(e))t[i]=(0,u.im)(e[i]);return t}writeDomains(e,t){const i={};for(const t of Object.keys(e))e[t]&&(i[t]=e[t]?.toJSON());t.domains=i}};(0,n._)([(0,o.Cb)({json:{write:!0}})],h.prototype,"id",void 0),(0,n._)([(0,o.Cb)({json:{write:!0}})],h.prototype,"name",void 0),(0,n._)([(0,o.Cb)({json:{write:!0}})],h.prototype,"domains",void 0),(0,n._)([(0,a.r)("domains")],h.prototype,"readDomains",null),(0,n._)([(0,c.c)("domains")],h.prototype,"writeDomains",null),(0,n._)([(0,o.Cb)({type:[d.Z],json:{write:!0}})],h.prototype,"templates",void 0),h=(0,n._)([(0,l.j)("esri.layers.support.FeatureType")],h)},57085:function(e,t,i){i.d(t,{T:function(){return s}});var n=i(78619),r=i(88194);async function s(e,t,i,s,o,a,l){let c=null;if(null!=i){const t=`${e}/nodepages/`,r=t+Math.floor(i.rootIndex/i.nodesPerPage);try{return{type:"page",rootPage:(await(0,n.Z)(r,{query:{f:"json",...s,token:o},responseType:"json",signal:l})).data,rootIndex:i.rootIndex,pageSize:i.nodesPerPage,lodMetric:i.lodSelectionMetricType,urlPrefix:t}}catch(e){null!=a&&a.warn("#fetchIndexInfo()","Failed to load root node page. Falling back to node documents.",r,e),c=e}}if(!t)return null;const u=t?.split("/").pop(),d=`${e}/nodes/`,h=d+u;try{return{type:"node",rootNode:(await(0,n.Z)(h,{query:{f:"json",...s,token:o},responseType:"json",signal:l})).data,urlPrefix:d}}catch(e){throw new r.Z("sceneservice:root-node-missing","Root node missing.",{pageError:c,nodeError:e,url:h})}}},50048:function(e,t,i){i.d(t,{H3:function(){return g},QI:function(){return d},U4:function(){return l},Yh:function(){return p}});var n=i(73440),r=i(63255),s=i(17155),o=(i(61432),i(96711),i(83850),i(79775)),a=i(48023);let l=class extends r.Z{constructor(){super(...arguments),this.nodesPerPage=null,this.rootIndex=0,this.lodSelectionMetricType=null}};(0,n._)([(0,s.Cb)({type:Number})],l.prototype,"nodesPerPage",void 0),(0,n._)([(0,s.Cb)({type:Number})],l.prototype,"rootIndex",void 0),(0,n._)([(0,s.Cb)({type:String})],l.prototype,"lodSelectionMetricType",void 0),l=(0,n._)([(0,a.j)("esri.layers.support.I3SLayerDefinitions.I3SNodePageDefinition")],l);let c=class extends r.Z{constructor(){super(...arguments),this.factor=1}};(0,n._)([(0,s.Cb)({type:Number,json:{read:{source:"textureSetDefinitionId"}}})],c.prototype,"id",void 0),(0,n._)([(0,s.Cb)({type:Number})],c.prototype,"factor",void 0),c=(0,n._)([(0,a.j)("esri.layers.support.I3SLayerDefinitions.I3SMaterialTexture")],c);let u=class extends r.Z{constructor(){super(...arguments),this.baseColorFactor=[1,1,1,1],this.baseColorTexture=null,this.metallicRoughnessTexture=null,this.metallicFactor=1,this.roughnessFactor=1}};(0,n._)([(0,s.Cb)({type:[Number]})],u.prototype,"baseColorFactor",void 0),(0,n._)([(0,s.Cb)({type:c})],u.prototype,"baseColorTexture",void 0),(0,n._)([(0,s.Cb)({type:c})],u.prototype,"metallicRoughnessTexture",void 0),(0,n._)([(0,s.Cb)({type:Number})],u.prototype,"metallicFactor",void 0),(0,n._)([(0,s.Cb)({type:Number})],u.prototype,"roughnessFactor",void 0),u=(0,n._)([(0,a.j)("esri.layers.support.I3SLayerDefinitions.I3SMaterialPBRMetallicRoughness")],u);let d=class extends r.Z{constructor(){super(...arguments),this.alphaMode="opaque",this.alphaCutoff=.25,this.doubleSided=!1,this.cullFace="none",this.normalTexture=null,this.occlusionTexture=null,this.emissiveTexture=null,this.emissiveFactor=null,this.pbrMetallicRoughness=null}};(0,n._)([(0,o.J)({opaque:"opaque",mask:"mask",blend:"blend"})],d.prototype,"alphaMode",void 0),(0,n._)([(0,s.Cb)({type:Number})],d.prototype,"alphaCutoff",void 0),(0,n._)([(0,s.Cb)({type:Boolean})],d.prototype,"doubleSided",void 0),(0,n._)([(0,o.J)({none:"none",back:"back",front:"front"})],d.prototype,"cullFace",void 0),(0,n._)([(0,s.Cb)({type:c})],d.prototype,"normalTexture",void 0),(0,n._)([(0,s.Cb)({type:c})],d.prototype,"occlusionTexture",void 0),(0,n._)([(0,s.Cb)({type:c})],d.prototype,"emissiveTexture",void 0),(0,n._)([(0,s.Cb)({type:[Number]})],d.prototype,"emissiveFactor",void 0),(0,n._)([(0,s.Cb)({type:u})],d.prototype,"pbrMetallicRoughness",void 0),d=(0,n._)([(0,a.j)("esri.layers.support.I3SLayerDefinitions.I3SMaterialDefinition")],d);let h=class extends r.Z{};(0,n._)([(0,s.Cb)({type:String,json:{read:{source:["name","index"],reader:(e,t)=>null!=e?e:`${t.index}`}}})],h.prototype,"name",void 0),(0,n._)([(0,o.J)({jpg:"jpg",png:"png",dds:"dds","ktx-etc2":"ktx-etc2",ktx2:"ktx2",basis:"basis"})],h.prototype,"format",void 0),h=(0,n._)([(0,a.j)("esri.layers.support.I3SLayerDefinitions.I3STextureFormat")],h);let p=class extends r.Z{constructor(){super(...arguments),this.atlas=!1}};(0,n._)([(0,s.Cb)({type:[h]})],p.prototype,"formats",void 0),(0,n._)([(0,s.Cb)({type:Boolean})],p.prototype,"atlas",void 0),p=(0,n._)([(0,a.j)("esri.layers.support.I3SLayerDefinitions.I3STextureSetDefinition")],p);let m=class extends r.Z{};(0,n._)([(0,o.J)({Float32:"Float32",UInt64:"UInt64",UInt32:"UInt32",UInt16:"UInt16",UInt8:"UInt8"})],m.prototype,"type",void 0),(0,n._)([(0,s.Cb)({type:Number})],m.prototype,"component",void 0),m=(0,n._)([(0,a.j)("esri.layers.support.I3SLayerDefinitions.I3SGeometryAttribute")],m);let f=class extends r.Z{};(0,n._)([(0,o.J)({draco:"draco"})],f.prototype,"encoding",void 0),(0,n._)([(0,s.Cb)({type:[String]})],f.prototype,"attributes",void 0),f=(0,n._)([(0,a.j)("esri.layers.support.I3SLayerDefinitions.I3SGeometryCompressedAttributes")],f);let v=class extends r.Z{constructor(){super(...arguments),this.offset=0}};(0,n._)([(0,s.Cb)({type:Number})],v.prototype,"offset",void 0),(0,n._)([(0,s.Cb)({type:m})],v.prototype,"position",void 0),(0,n._)([(0,s.Cb)({type:m})],v.prototype,"normal",void 0),(0,n._)([(0,s.Cb)({type:m})],v.prototype,"uv0",void 0),(0,n._)([(0,s.Cb)({type:m})],v.prototype,"color",void 0),(0,n._)([(0,s.Cb)({type:m})],v.prototype,"uvRegion",void 0),(0,n._)([(0,s.Cb)({type:m})],v.prototype,"featureId",void 0),(0,n._)([(0,s.Cb)({type:m})],v.prototype,"faceRange",void 0),(0,n._)([(0,s.Cb)({type:f})],v.prototype,"compressedAttributes",void 0),v=(0,n._)([(0,a.j)("esri.layers.support.I3SLayerDefinitions.I3SGeometryBuffer")],v);let g=class extends r.Z{};(0,n._)([(0,o.J)({triangle:"triangle"})],g.prototype,"topology",void 0),(0,n._)([(0,s.Cb)()],g.prototype,"geometryBuffers",void 0),g=(0,n._)([(0,a.j)("esri.layers.support.I3SLayerDefinitions.I3SGeometryDefinition")],g)},68738:function(e,t,i){i.d(t,{Z:function(){return c}});var n,r=i(73440),s=i(43254),o=i(63255),a=i(17155),l=(i(61432),i(96711),i(83850),i(48023));let c=n=class extends o.Z{constructor(e){super(e),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new s.Z}clone(){return new n({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};(0,r._)([(0,a.Cb)({type:String,json:{write:{isRequired:!0}}})],c.prototype,"floorField",void 0),(0,r._)([(0,a.Cb)({json:{read:!1,write:!1}})],c.prototype,"viewAllMode",void 0),(0,r._)([(0,a.Cb)({json:{read:!1,write:!1}})],c.prototype,"viewAllLevelIds",void 0),c=n=(0,r._)([(0,l.j)("esri.layers.support.LayerFloorInfo")],c)},47641:function(e,t,i){i.d(t,{b:function(){return o}});var n=i(93568),r=i(39355),s=i(78891);class o{constructor(){this._tasks=new Array,this._numPendingTasks=(0,r.t)(0),this._running=(0,r.t)(!1)}get length(){return this._tasks.length}get updating(){return this._numPendingTasks.value>0}get running(){return this._running.value}_updateRunning(){this._running.value=this._tasks.length>0}destroy(){this.cancelAll()}runTask(e){if(0===this.length)return s.J;for(;!e.done&&this._process(e);)e.madeProgress()}push(e,t,i){return new Promise(((n,r)=>{this._tasks.push(new a(n,r,e,t,i)),++this._numPendingTasks.value,this._updateRunning()})).finally((()=>--this._numPendingTasks.value))}unshift(e,t,i){return new Promise(((n,r)=>{this._tasks.unshift(new a(n,r,e,t,i)),++this._numPendingTasks.value,this._updateRunning()})).finally((()=>--this._numPendingTasks.value))}_process(e){if(0===this._tasks.length)return!1;const t=this._tasks.shift();this._updateRunning();try{const i=(0,n.Hc)(t.signal);if(i&&!t.abortCallback)t.reject((0,n.zE)());else{const r=i?t.abortCallback?.((0,n.zE)()):t.callback(e);(0,n.y8)(r)?r.then(t.resolve,t.reject):t.resolve(r)}}catch(e){t.reject(e)}return!0}cancelAll(){const e=(0,n.zE)();for(const t of this._tasks)if(t.abortCallback){const i=t.abortCallback(e);t.resolve(i)}else t.reject(e);this._tasks.length=0,this._updateRunning()}}class a{constructor(e,t,i,n,r){this.resolve=e,this.reject=t,this.callback=i,this.signal=n,this.abortCallback=r}}},73388:function(e,t,i){i.d(t,{Z:function(){return d}});var n=i(73440),r=i(89314),s=i(41773),o=i(63255),a=i(17155),l=(i(61432),i(96711),i(83850),i(48023));const c=new s.X({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),u=new s.X({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"});let d=class extends(r.Z.ClonableMixin(o.Z)){constructor(e){super(e),this.cardinality=null,this.catalogId=null,this.composite=null,this.id=null,this.keyField=null,this.keyFieldInRelationshipTable=null,this.name=null,this.relatedTableId=null,this.relationshipTableId=null,this.role=null}};(0,n._)([(0,a.Cb)({json:{read:c.read,write:c.write}})],d.prototype,"cardinality",void 0),(0,n._)([(0,a.Cb)({json:{name:"catalogID"}})],d.prototype,"catalogId",void 0),(0,n._)([(0,a.Cb)({json:{read:!0,write:!0}})],d.prototype,"composite",void 0),(0,n._)([(0,a.Cb)({json:{read:!0,write:!0}})],d.prototype,"id",void 0),(0,n._)([(0,a.Cb)({json:{read:!0,write:!0}})],d.prototype,"keyField",void 0),(0,n._)([(0,a.Cb)({json:{read:!0,write:!0}})],d.prototype,"keyFieldInRelationshipTable",void 0),(0,n._)([(0,a.Cb)({json:{read:!0,write:!0}})],d.prototype,"name",void 0),(0,n._)([(0,a.Cb)({json:{read:!0,write:!0}})],d.prototype,"relatedTableId",void 0),(0,n._)([(0,a.Cb)({json:{read:!0,write:!0}})],d.prototype,"relationshipTableId",void 0),(0,n._)([(0,a.Cb)({json:{read:u.read,write:u.write}})],d.prototype,"role",void 0),d=(0,n._)([(0,l.j)("esri.layers.support.Relationship")],d)},31743:function(e,t,i){i.d(t,{f:function(){return n}});class n{constructor(e,t,i,n,r){this.id=e,this.level=t,this.row=i,this.col=n,this.extent=r}}},56346:function(e,t,i){i.d(t,{Z:function(){return h}});var n=i(73440),r=i(70880),s=i(3480),o=i(29292),a=i(43254),l=i(17155),c=(i(61432),i(96711),i(48023)),u=i(76554),d=i(3411);let h=class extends r.Z{constructor(e){super(e),this._featureUtils=null,this.effectivePopupTemplate=null}get _arcadeTask(){return this.expressionsUsedInTitle.length>0?this._get("_arcadeTask")||(0,o.vr)((()=>(0,d.L)())):null}get featureUtilsPromise(){return this._get("featureUtilsPromise")??i.e(11407).then(i.bind(i,11407)).then((e=>this._featureUtils=e))}get calculatedExpressions(){const e=new a.Z;if(!this.expressionsUsedInTitle.length)return e;if(!this._arcadeTask?.value){for(const t of this.expressionsUsedInTitle??[])e.push({name:t.name,invalid:!0});return e}for(const t of this.expressionsUsedInTitle)try{const i=this._arcadeTask.value.arcade.parseScript(t.expression,["$layer","$map","$datastore"]);if(i.isAsync){e.push({name:t.name,invalid:!0});break}e.push({name:t.name,syntax:i,invalid:!1,func:this._arcadeTask.value.arcade.compileScript(i,{vars:{$feature:"any"}})})}catch{e.push({name:t.name,invalid:!0});break}return e}get expressionsUsedInTitle(){let e=this.effectivePopupTemplate?.title??"";return"string"!=typeof e?[]:(e=e.toLowerCase(),this.effectivePopupTemplate?.expressionInfos?.filter((t=>e.includes(`{expression/${t.name.toLowerCase()}}`)))??[])}get fieldInfoMap(){return this._featureUtils?this._createFieldInfoMap(this._featureUtils.getAllFieldInfos(this.effectivePopupTemplate)):null}get hasBadExpressions(){return this.calculatedExpressions.some((e=>!0===e.invalid))}get requiredFields(){const e=new Set;if(this._arcadeTask?.value&&!this.hasBadExpressions)for(const t of this.calculatedExpressions?.toArray()??[])try{const i=this._arcadeTask.value.arcade.extractFieldLiterals(t.syntax);for(const t of i){const i=t.split("."),n=this.fieldsIndex.get(i.at(-1)??"");n&&e.add(n.name)}}catch{}const t=this._extractFieldNames(this.workingTitle);for(const i of t){const t=this.fieldsIndex.get(i);t&&e.add(t.name)}return null!=this.objectIdField&&e.add(this.objectIdField),e}get titleFromDisplayField(){let e="";return this.displayField&&(e=this.fieldsIndex.get(this.displayField)?.name??""),e||(e=this.fieldsIndex.get(this.objectIdField)?.name??""),e?`{${e}}`:""}get workingTitle(){const e=this.effectivePopupTemplate?this.effectivePopupTemplate.title:"";return""===e||null==e||this.hasBadExpressions||"string"!=typeof e?this.titleFromDisplayField:e}async getTitle(e,t,i){const n=t.getObjectId()??t.attributes[e.objectIdField];return(await this.getTitles(e,[t],i)).get(n)??""}async getTitles(e,t,i){const n=new Map,r=i?.timeZone??"system";try{const[{substituteFieldsInLinksAndAttributes:s}]=await Promise.all([this.featureUtilsPromise,this._arcadeTask?.promise]);i?.fetchMissingFields&&(t=await this._checkAndReQueryGraphics(e,t));const{fieldInfoMap:o,workingTitle:a}=this,l=a&&o;t.forEach((t=>{const i=t.getObjectId()??t.attributes[e.objectIdField],c=l?s({attributes:t.attributes,expressionAttributes:null,fieldInfoMap:o,globalAttributes:this._createFormattedAttributes(e,t,r).global,layer:e,text:a}):"";n.set(i,c)}))}catch{}return n}async _checkAndReQueryGraphics(e,t){const i=t.map((t=>t.getObjectId()??t.attributes[e.objectIdField])).filter(s.pC);if(i.length!==t.length)return t;if(t.some((e=>!(0,u.R9)(e,this.requiredFields)))){const n=e.createQuery();n.where="1=1",n.outFields=[...this.requiredFields],n.objectIds=i;const r=await e.queryFeatures(n);if(r?.features.length===t.length)return r.features}return t}_createFieldInfoMap(e){const t=new Map;if(!e)return t;for(const i of e){if(!i.fieldName)continue;const e=this.fieldsIndex.get(i.fieldName)?.name??i.fieldName;i.fieldName=e,t.set(e.toLowerCase(),i)}return t}_createFormattedAttributes(e,t,i="system"){const n=this.effectivePopupTemplate?.fieldInfos??[],r={};if(!this._featureUtils)return{};if(!this.hasBadExpressions&&this.calculatedExpressions.length>0&&this._arcadeTask?.value){const i=this._arcadeTask.value.Feature.createFromGraphicLikeObject(t.geometry,t.attributes,e,null);for(const e of this.calculatedExpressions)try{r[`expression/${e.name}`]=e.func({vars:{$feature:i}})}catch{}}const s={...t.attributes,...r};return{global:this._featureUtils.formatAttributes({fieldInfos:n,attributes:s,graphic:t,timeZone:i,layer:e,fieldInfoMap:this.fieldInfoMap}),content:[]}}_extractFieldNames(e){return(0,u.ld)(e).filter((e=>!(0===e.indexOf("relationships/")||0===e.indexOf("expression/"))))}};(0,n._)([(0,l.Cb)({readOnly:!0})],h.prototype,"_arcadeTask",null),(0,n._)([(0,l.Cb)()],h.prototype,"_featureUtils",void 0),(0,n._)([(0,l.Cb)({readOnly:!0})],h.prototype,"featureUtilsPromise",null),(0,n._)([(0,l.Cb)({readOnly:!0})],h.prototype,"calculatedExpressions",null),(0,n._)([(0,l.Cb)()],h.prototype,"displayField",void 0),(0,n._)([(0,l.Cb)()],h.prototype,"effectivePopupTemplate",void 0),(0,n._)([(0,l.Cb)()],h.prototype,"expressionsUsedInTitle",null),(0,n._)([(0,l.Cb)()],h.prototype,"fieldsIndex",void 0),(0,n._)([(0,l.Cb)()],h.prototype,"fieldInfoMap",null),(0,n._)([(0,l.Cb)()],h.prototype,"fields",void 0),(0,n._)([(0,l.Cb)()],h.prototype,"objectIdField",void 0),(0,n._)([(0,l.Cb)()],h.prototype,"requiredFields",null),h=(0,n._)([(0,c.j)("esri.layers.support.TitleCreator")],h)},76889:function(e,t,i){i.d(t,{w:function(){return u}});var n=i(10218),r=i(78619),s=i(88194),o=i(93568),a=i(66619),l=i(77601),c=i(96193);async function u(e,t){const i=(0,a.Qc)(e);if(!i)throw new s.Z("invalid-url","Invalid scene service url");const u={...t,sceneServerUrl:i.url.path,layerId:i.sublayer??void 0};if(u.sceneLayerItem??=await async function(e){const t=(await d(e)).serviceItemId;if(!t)return null;const i=new c.default({id:t,apiKey:e.apiKey}),s=await async function(e){const t=n.id?.findServerInfo(e.sceneServerUrl);if(t?.owningSystemUrl)return t.owningSystemUrl;const i=e.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const t=(await(0,r.Z)(i,{query:{f:"json"},responseType:"json",signal:e.signal})).data.owningSystemUrl;if(t)return t}catch(e){(0,o.r9)(e)}return null}(e);null!=s&&(i.portal=new l.Z({url:s}));try{return await i.load({signal:e.signal})}catch(e){return(0,o.r9)(e),null}}(u),null==u.sceneLayerItem)return h(u.sceneServerUrl.replace("/SceneServer","/FeatureServer"),u);const p=await async function({sceneLayerItem:e,signal:t}){if(!e)return null;try{const i=(await e.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:t})).find((e=>"Feature Service"===e.type))||null;if(!i)return null;const n=new c.default({portal:i.portal,id:i.id});return await n.load(),n}catch(e){return(0,o.r9)(e),null}}(u);if(!p?.url)throw new s.Z("related-service-not-found","Could not find feature service through portal item relationship");u.featureServiceItem=p;const m=await h(p.url,u);return m.portalItem=p,m}async function d(e){if(e.rootDocument)return e.rootDocument;const t={query:{f:"json",...e.customParameters,token:e.apiKey},responseType:"json",signal:e.signal};try{const i=await(0,r.Z)(e.sceneServerUrl,t);e.rootDocument=i.data}catch{e.rootDocument={}}return e.rootDocument}async function h(e,t){const i=(0,a.Qc)(e);if(!i)throw new s.Z("invalid-feature-service-url","Invalid feature service url");const n=i.url.path,o=t.layerId;if(null==o)return{serverUrl:n};const l=d(t),c=t.featureServiceItem?await t.featureServiceItem.fetchData("json"):null,u=(c?.layers?.[0]||c?.tables?.[0])?.customParameters,h=e=>{const i={query:{f:"json",...u},responseType:"json",authMode:e,signal:t.signal};return(0,r.Z)(n,i)},p=h("anonymous").catch((()=>h("no-prompt"))),[m,f]=await Promise.all([p,l]),v=f?.layers,g=m.data&&m.data.layers;if(!Array.isArray(g))throw new Error("expected layers array");if(Array.isArray(v)){for(let e=0;e<Math.min(v.length,g.length);e++)if(v[e].id===o)return{serverUrl:n,layerId:g[e].id}}else if(null!=o&&o<g.length)return{serverUrl:n,layerId:g[o].id};throw new Error("could not find matching associated sublayer")}},20905:function(e,t,i){i.d(t,{C:function(){return r},s:function(){return n}});const n={supportsDate:!1,supportsFixedInterval:!1,supportsAutoInterval:!1,supportsFixedBoundaries:!1,supportsStackBy:!1,supportsSplitBy:!1,supportsSnapToData:!1,supportsReturnFullIntervalBin:!1,supportsFirstDayOfWeek:!1,supportsNormalization:!1,supportedStatistics:void 0,supportedNormalizationTypes:void 0},r={analytics:{supportsCacheHint:!1},attachment:{supportsContentType:!1,supportsExifInfo:!1,supportsKeywords:!1,supportsName:!1,supportsSize:!1,supportsCacheHint:!1,supportsOrderByFields:!1,supportsResize:!1},data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsAsyncApplyEdits:!1,zDefault:void 0},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryBins:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1,supportsAsyncConvert3D:!1},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryAttributeBins:n,query:{maxRecordCount:0,maxRecordCountFactor:0,maxUniqueIDCount:0,standardMaxRecordCount:0,supportsCacheHint:!1,supportsCentroid:!1,supportsCompactGeometry:!1,supportsCurrentUser:!1,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPaginationOnAggregatedQueries:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByAnonymous:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsReturnMesh:!1,supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsTrueCurve:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsStatistics:!1,tileMaxRecordCount:0}}},60419:function(e,t,i){i.d(t,{$6:function(){return C},$z:function(){return s},F7:function(){return r},S0:function(){return o},Si:function(){return m},Wr:function(){return v},X4:function(){return d},Zq:function(){return h},d1:function(){return l},dm:function(){return c},eP:function(){return u},fe:function(){return p},sg:function(){return f}});const n=[["binary","application/octet-stream","bin",""]];function r(e,t){return null!=y(t.name,e?.supportedFormats??[])}function s(e,t){if(!e)return!1;const i=c(t,e.supportedFormats??[]);return null!=i&&e.editFormats.includes(i)}function o(e,t){return b(function(e,t){const i=e.toLowerCase();return g(t).find((e=>_(e)===i))}(e,t))}function a(e,t){return b(y(e,t))}function l(e,t){return _(function(e,t){return g(t).find((t=>b(t)===e))}(e,t))}function c(e,t){return a(e.name,t)??o(e.type,t)}function u(e,t,i){return o(e,i)??a(t,i)}function d({supportedFormats:e}){return u("model/gltf-binary","glb",e)}function h(e){const t=d(e);return null!=t&&e.editFormats.includes(t)}function p({supportedFormats:e}){return u("model/gltf+json","gltf",e)}function m(e){if(!e)return null;const t=d(e),i=p(e);let n=null;for(const r of e.queryFormats){if(r===t)return r;r===i&&(n=r)}return n}function f({supportedFormats:e}){return u("application/esri3do-SR_world","wld",e)}function v({supportedFormats:e}){return u("application/esri3do-SR_prj","prj",e)}function g(e){return[...n,...e]}function y(e,t){const i=e.toLowerCase();return g(t).find((e=>w(e).some((e=>i.endsWith(e)))))}function b(e){return e?.[0]}function _(e){return e?.[1].toLowerCase()}function w(e){return e?.[2].split(",").map((e=>e.toLowerCase()))??[]}function C(e){return e.tables?.find((e=>"assetMaps"===e.role))}},25835:function(e,t,i){i.d(t,{h:function(){return m},j:function(){return S}});var n=i(61432),r=i(66619),s=i(60419);function o(e,t,i){return!!l(e,t,i)}function a(e,t,i){return l(e,t,i)}function l(e,t,i){return e&&e.hasOwnProperty(t)?e[t]:i}const c={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function u(e){const t=e?.supportedSpatialAggregationStatistics?.map((e=>e.toLowerCase()));return{envelope:!!t?.includes("envelopeaggregate"),centroid:!!t?.includes("centroidaggregate"),convexHull:!!t?.includes("convexhullaggregate")}}function d(e,t){const i=e?.supportedOperationsWithCacheHint?.map((e=>e.toLowerCase()));return!!i?.includes(t.toLowerCase())}function h(e){const t=e?.supportedStatisticTypes?.map((e=>e.toLowerCase()));return{count:!!t?.includes("count"),sum:!!t?.includes("sum"),min:!!t?.includes("min"),max:!!t?.includes("max"),avg:!!t?.includes("avg"),var:!!t?.includes("var"),stddev:!!t?.includes("stddev"),percentileContinuous:!!t?.includes("percentile_cont"),percentileDiscrete:!!t?.includes("percentile_disc"),envelope:!!t?.includes("envelopeaggregate"),centroid:!!t?.includes("centroidaggregate"),convexHull:!!t?.includes("convexhullaggregate")}}function p(e){const t=e?.supportedNormalizationTypes?.map((e=>e.toLowerCase()));return{field:!!t?.includes("field"),log:!!t?.includes("log"),naturalLog:!!t?.includes("naturallog"),percentOfTotal:!!t?.includes("percentoftotal"),squareRoot:!!t?.includes("squareroot")}}function m(e,t){return{analytics:f(e),attachment:v(e),data:g(e),metadata:y(e),operations:b(e.capabilities,e,t),query:_(e,t),queryAttributeBins:x(e),queryRelated:w(e),queryTopFeatures:C(e),editing:E(e)}}function f(e){return{supportsCacheHint:d(e.advancedQueryCapabilities,"queryAnalytics")}}function v(e){const t=e.attachmentProperties,i={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:d(e.advancedQueryCapabilities,"queryAttachments"),supportsOrderByFields:o(e.advancedQueryCapabilities,"supportsQueryAttachmentOrderByFields",!1),supportsResize:o(e,"supportsAttachmentsResizing",!1)};return t&&Array.isArray(t)&&t.forEach((e=>{const t=c[e.name];t&&(i[t]=!!e.isEnabled)})),i}function g(e){return{isVersioned:o(e,"isDataVersioned",!1),isBranchVersioned:o(e,"isDataBranchVersioned",!1),supportsAttachment:o(e,"hasAttachments",!1),supportsM:o(e,"hasM",!1),supportsZ:o(e,"hasZ",!1)}}function y(e){return{supportsAdvancedFieldProperties:o(e,"supportsFieldDescriptionProperty",!1)}}function b(e,t,i){const n=e?.toLowerCase().split(",").map((e=>e.trim()))??[],s=i?(0,r.Qc)(i):null,a=n.includes("MapServer"===s?.serverType?"data":"query"),l=n.includes("editing")&&!t.datesInUnknownTimezone&&!(!0===t.uniqueIdInfo?.OIDFieldContainsHashValue);let c=l&&n.includes("create"),u=l&&n.includes("delete"),d=l&&n.includes("update");const h=n.includes("changetracking"),p=t.advancedQueryCapabilities;return l&&!(c||u||d)&&(c=u=d=!0),{supportsCalculate:o(t,"supportsCalculate",!1),supportsTruncate:o(t,"supportsTruncate",!1),supportsValidateSql:o(t,"supportsValidateSql",!1),supportsAdd:c,supportsDelete:u,supportsEditing:l,supportsChangeTracking:h,supportsQuery:a,supportsQueryAnalytics:o(p,"supportsQueryAnalytic",!1),supportsQueryAttachments:o(p,"supportsQueryAttachments",!1),supportsQueryBins:o(p,"supportsQueryBins",!1)||!!t.queryBinsCapabilities,supportsQueryTopFeatures:o(p,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:o(t,"supportsAttachmentsResizing",!1),supportsSync:n.includes("sync"),supportsUpdate:d,supportsExceedsLimitStatistics:o(t,"supportsExceedsLimitStatistics",!1),supportsAsyncConvert3D:o(t,"supportsAsyncConvert3D",!1)}}function _(e,t){const i=e.advancedQueryCapabilities,l=e.ownershipBasedAccessControlForFeatures,c=e.archivingInfo,h=e.currentVersion,p=t?.includes("MapServer"),m=!p||h>=(0,n.Z)("mapserver-pbf-version-support"),f=(0,r.M8)(t),v=new Set((e.supportedQueryFormats??"").split(",").map((e=>e.toLowerCase().trim())));return{maxRecordCount:a(e,"maxRecordCount",void 0),maxRecordCountFactor:a(e,"maxRecordCountFactor",void 0),maxUniqueIDCount:a(e,"maxUniqueIDCount",void 0),standardMaxRecordCount:a(e,"standardMaxRecordCount",void 0),supportedSpatialAggregationStatistics:u(i),supportsCacheHint:o(i,"supportsQueryWithCacheHint",!1)||d(i,"query"),supportsCentroid:o(i,"supportsReturningGeometryCentroid",!1),supportsCompactGeometry:f,supportsCurrentUser:o(i,"supportsCurrentUserQueries",!1),supportsDefaultSpatialReference:o(i,"supportsDefaultSR",!1),supportsDisjointSpatialRelationship:o(i,"supportsDisjointSpatialRel",!1),supportsDistance:o(i,"supportsQueryWithDistance",!1),supportsDistinct:o(i,"supportsDistinct",e.supportsAdvancedQueries),supportsExtent:o(i,"supportsReturningQueryExtent",!1),supportsFormatPBF:m&&v.has("pbf"),supportsFullTextSearch:o(i,"supportsFullTextSearch",!1),supportsGeometryProperties:o(i,"supportsReturningGeometryProperties",!1),supportsHavingClause:o(i,"supportsHavingClause",!1),supportsHistoricMoment:o(c,"supportsQueryWithHistoricMoment",!1),supportsMaxRecordCountFactor:o(i,"supportsMaxRecordCountFactor",!1),supportsOrderBy:o(i,"supportsOrderBy",e.supportsAdvancedQueries),supportsPagination:o(i,"supportsPagination",!1),supportsPaginationOnAggregatedQueries:o(i,"supportsPaginationOnAggregatedQueries",!1),supportsPercentileStatistics:o(i,"supportsPercentileStatistics",!1),supportsQuantization:o(e,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:o(e,"supportsQuantizationEditMode",!1),supportsQueryByAnonymous:o(l,"allowAnonymousToQuery",!0),supportsQueryByOthers:o(l,"allowOthersToQuery",!0),supportsQueryGeometry:o(e,"supportsReturningQueryGeometry",!1),supportsResultType:o(i,"supportsQueryWithResultType",!1),supportsReturnMesh:!!(0,s.Si)(e.infoFor3D),supportsSpatialAggregationStatistics:o(i,"supportsSpatialAggregationStatistics",!1),supportsSqlExpression:o(i,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:o(e,"useStandardizedQueries",!1),supportsStatistics:o(i,"supportsStatistics",e.supportsStatistics),supportsTopFeaturesQuery:o(i,"supportsTopFeaturesQuery",!1),supportsTrueCurve:o(i,"supportsTrueCurve",!1),tileMaxRecordCount:a(e,"tileMaxRecordCount",void 0)}}function w(e){const t=e.advancedQueryCapabilities,i=o(t,"supportsAdvancedQueryRelated",!1);return{supportsPagination:o(t,"supportsQueryRelatedPagination",!1),supportsCount:i,supportsOrderBy:i,supportsCacheHint:d(t,"queryRelated")}}function C(e){return{supportsCacheHint:d(e.advancedQueryCapabilities,"queryTopFilter")}}function x(e){const t=e?e.queryBinsCapabilities:void 0;return{supportsDate:o(t,"supportsDateBin",!1),supportsFixedInterval:o(t,"supportsFixedIntervalBin",!1),supportsAutoInterval:o(t,"supportsAutoIntervalBin",!1),supportsFixedBoundaries:o(t,"supportsFixedBoundariesBin",!1),supportsStackBy:o(t,"supportsStackBy",!1),supportsSplitBy:o(t,"supportsSplitBy",!1),supportsSnapToData:o(t,"supportsSnapToData",!1),supportsReturnFullIntervalBin:o(t,"supportsReturnFullIntervalBin",!1),supportsFirstDayOfWeek:o(t,"supportsFirstDayOfWeek",!1),supportsNormalization:o(t,"supportsNormalization",!1),supportedStatistics:h(t),supportedNormalizationTypes:p(t)}}function E(e){const t=e.ownershipBasedAccessControlForFeatures,i=e?e.advancedEditingCapabilities:void 0;return{supportsGeometryUpdate:o(e,"allowGeometryUpdates",!0),supportsGlobalId:o(e,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:o(e,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:o(e,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:o(e,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:o(e,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:o(t,"allowAnonymousToDelete",!0),supportsDeleteByOthers:o(t,"allowOthersToDelete",!0),supportsUpdateByAnonymous:o(t,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:o(t,"allowOthersToUpdate",!0),supportsAsyncApplyEdits:o(i,"supportsAsyncApplyEdits",!1),zDefault:a(e,"zDefault",void 0)}}function S(e){return{operations:{supportsAppend:o(e,"supportsAppend",!1),supportsCoverageQuery:e?.playbackInfo?.klv["0601"]??!1,supportsExportClip:o(e,"supportsExportClip",!1),supportsExportFrameset:o(e,"supportsExportFrameset",!1),supportsMensuration:o(e,"supportsMensuration",!1),supportsPreviews:o(e,"supportsPreviews",!1),supportsUpdate:o(e,"supportsUpdate",!1)}}}},81663:function(e,t,i){i.d(t,{W:function(){return s},v:function(){return o}});var n=i(45357);const r={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(e,t,i)=>{"-"===t.charAt(0)?e.style.setProperty(t,i):e.style[t]=i}};let s=e=>(0,n.l7)(r,e),o={create:(e,t)=>(t=s(t),(0,n.WV)(e,document.createElement("div"),void 0,t),(0,n.UQ)(e,t)),append:(e,t,i)=>(i=s(i),(0,n.WV)(t,e,void 0,i),(0,n.UQ)(t,i)),insertBefore:(e,t,i)=>(i=s(i),(0,n.WV)(t,e.parentNode,e,i),(0,n.UQ)(t,i)),merge:(e,t,i)=>(i=s(i),t.domNode=e,(0,n.Yj)(e,t,i),(0,n.UQ)(t,i)),replace:(e,t,i)=>(i=s(i),(0,n.WV)(t,e.parentNode,e,i),e.parentNode.removeChild(e),(0,n.UQ)(t,i))}},45357:function(e,t,i){i.d(t,{UQ:function(){return I},WV:function(){return E},Yj:function(){return x},l7:function(){return l}});var n=i(59925);const r="http://www.w3.org/",s=`${r}2000/svg`,o=`${r}1999/xlink`;let a=[],l=(e,t)=>{let i={};return Object.keys(e).forEach((t=>{i[t]=e[t]})),t&&Object.keys(t).forEach((e=>{i[e]=t[e]})),i},c=(e,t)=>e.vnodeSelector===t.vnodeSelector&&(e.properties&&t.properties?e.properties.key===t.properties.key&&e.properties.bind===t.properties.bind:!e.properties&&!t.properties),u=e=>{if("string"!=typeof e)throw new Error("Style values must be strings")},d=(e,t,i)=>{if(""!==t.vnodeSelector)for(let n=i;n<e.length;n++)if(c(e[n],t))return n;return-1},h=(e,t,i,n)=>{let r=e[t];if(""===r.vnodeSelector)return;let s=r.properties;if(!(s?void 0===s.key?s.bind:s.key:void 0))for(let s=0;s<e.length;s++)if(s!==t){let t=e[s];if(c(t,r))throw new Error(`${i.vnodeSelector} had a ${r.vnodeSelector} child ${"added"===n?n:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}},p=e=>{if(e.properties){let t=e.properties.enterAnimation;t&&t(e.domNode,e.properties)}},m=[],f=!1,v=e=>{(e.children||[]).forEach(v),e.properties&&e.properties.afterRemoved&&e.properties.afterRemoved.apply(e.properties.bind||e.properties,[e.domNode])},g=()=>{f=!1,m.forEach(v),m.length=0},y=e=>{m.push(e),f||(f=!0,"undefined"!=typeof window&&"requestIdleCallback"in window?window.requestIdleCallback(g,{timeout:16}):setTimeout(g,16))},b=e=>{let t=e.domNode;if(e.properties){let i=e.properties.exitAnimation;if(i){t.style.pointerEvents="none";let n=()=>{t.parentNode&&(t.parentNode.removeChild(t),y(e))};return void i(t,n,e.properties)}}t.parentNode&&(t.parentNode.removeChild(t),y(e))},_=(e,t,i)=>{if(!t)return;let r=i.eventHandlerInterceptor,a=Object.keys(t),l=a.length;for(let c=0;c<l;c++){let l=a[c],d=t[l];if("className"===l)throw new Error('Property "className" is not supported, use "class".');if("class"===l)S(e,d,!0);else if("classes"===l){let t=Object.keys(d),i=t.length;for(let n=0;n<i;n++){let i=t[n];d[i]&&e.classList.add(i)}}else if("styles"===l){let t=Object.keys(d),n=t.length;for(let r=0;r<n;r++){let n=t[r],s=d[n];s&&(u(s),i.styleApplyer(e,n,s))}}else if("key"!==l&&null!=d){let a=typeof d;"function"===a?(0===l.lastIndexOf("on",0)&&(r&&(d=r(l,d,e,t)),"oninput"===l&&function(){let e=d;d=function(t){e.apply(this,[t]),t.target["oninput-value"]=t.target.value}}()),e[l]=d):i.namespace===s?"href"===l?e.setAttributeNS(o,l,d):e.setAttribute(l,d):"string"===a&&"value"!==l?"innerHTML"===l?e[l]=n.w3.sanitize(d):w(e)&&l in e?e[l]=d:e.setAttribute(l,d):e[l]=d}}};function w(e){if(!(e instanceof Element&&e.tagName.includes("-")))return!1;const t=window.customElements.get(e.tagName.toLowerCase());return!!t&&e instanceof t}let C,x=(e,t,i)=>{((e,t,i)=>{if(t)for(let n of t)E(n,e,void 0,i)})(e,t.children,i),t.text&&(e.textContent=t.text),_(e,t.properties,i),t.properties&&t.properties.afterCreate&&t.properties.afterCreate.apply(t.properties.bind||t.properties,[e,i,t.vnodeSelector,t.properties,t.children])},E=(e,t,i,n)=>{let r,o=0,a=e.vnodeSelector,c=t.ownerDocument;if(""===a)r=e.domNode=c.createTextNode(e.text),void 0!==i?t.insertBefore(r,i):t.appendChild(r);else{for(let u=0;u<=a.length;++u){let d=a.charAt(u);if(u===a.length||"."===d||"#"===d){let d=a.charAt(o-1),h=a.slice(o,u);"."===d?r.classList.add(h):"#"===d?r.id=h:("svg"===h&&(n=l(n,{namespace:s})),void 0!==n.namespace?r=e.domNode=c.createElementNS(n.namespace,h):(r=e.domNode=e.domNode||c.createElement(h),"input"===h&&e.properties&&void 0!==e.properties.type&&r.setAttribute("type",e.properties.type)),void 0!==i?t.insertBefore(r,i):r.parentNode!==t&&t.appendChild(r)),o=u+1}}x(r,e,n)}},S=(e,t,i)=>{t&&t.split(" ").forEach((t=>{t&&e.classList.toggle(t,i)}))},T=(e,t,i,r)=>{if(!i)return;let a=!1,l=Object.keys(i),c=l.length;for(let d=0;d<c;d++){let c=l[d],h=i[c],p=t[c];if("class"===c)p!==h&&(S(e,p,!1),S(e,h,!0));else if("classes"===c){let t=e.classList,i=Object.keys(h),n=i.length;for(let e=0;e<n;e++){let n=i[e],r=!!h[n];r!==!!p[n]&&(a=!0,r?t.add(n):t.remove(n))}}else if("styles"===c){let t=Object.keys(h),i=t.length;for(let n=0;n<i;n++){let i=t[n],s=h[i];s!==p[i]&&(a=!0,s?(u(s),r.styleApplyer(e,i,s)):r.styleApplyer(e,i,""))}}else if(h||"string"!=typeof p||(h=""),"value"!==c||w(e)){if(h!==p){let t=typeof h;"function"===t&&r.eventHandlerInterceptor||(r.namespace===s?"href"===c?e.setAttributeNS(o,c,h):e.setAttribute(c,h):"string"===t?"innerHTML"===c?e[c]=n.w3.sanitize(h):"role"===c&&""===h?e.removeAttribute(c):w(e)&&c in e?e[c]=h:e.setAttribute(c,h):e[c]!==h&&(e[c]=h),a=!0)}}else{let t=e[c];t!==h&&(e["oninput-value"]?t===e["oninput-value"]:h!==p)&&(e[c]=h,e["oninput-value"]=void 0),h!==p&&(a=!0)}}return a},k=(e,t,i,n,r)=>{if(i===n)return!1;n=n||a;let s,o=(i=i||a).length,l=n.length,u=0,m=0,f=!1;for(;m<l;){let a=u<o?i[u]:void 0,l=n[m];if(void 0!==a&&c(a,l))f=C(a,l,r)||f,u++;else{let a=d(i,l,u+1);if(a>=0){for(s=u;s<a;s++)b(i[s]),h(i,s,e,"removed");f=C(i[a],l,r)||f,u=a+1}else E(l,t,u<o?i[u].domNode:void 0,r),p(l),h(n,m,e,"added")}m++}if(o>u)for(s=u;s<o;s++)b(i[s]),h(i,s,e,"removed");return f};C=(e,t,i)=>{let n=e.domNode,r=!1;if(e===t)return!1;let o=!1;if(""===t.vnodeSelector){if(t.text!==e.text){let e=n.ownerDocument.createTextNode(t.text);return n.parentNode.replaceChild(e,n),t.domNode=e,r=!0,r}t.domNode=n}else 0===t.vnodeSelector.lastIndexOf("svg",0)&&(i=l(i,{namespace:s})),e.text!==t.text&&(o=!0,void 0===t.text?n.removeChild(n.firstChild):n.textContent=t.text),t.domNode=n,o=k(t,n,e.children,t.children,i)||o,o=T(n,e.properties,t.properties,i)||o,t.properties&&t.properties.afterUpdate&&t.properties.afterUpdate.apply(t.properties.bind||t.properties,[n,i,t.vnodeSelector,t.properties,t.children]);return o&&t.properties&&t.properties.updateAnimation&&t.properties.updateAnimation(n,t.properties,e.properties),r};let I=(e,t)=>({getLastRender:()=>e,update:i=>{if(e.vnodeSelector!==i.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let n=e;e=i,C(n,i,t)},domNode:e.domNode})},59143:function(e,t,i){i.d(t,{E:function(){return l}});var n=i(81663);let r,s=(e,t)=>{let i=[];for(;e&&e!==t;)i.push(e),e=e.parentNode;return i};r=Array.prototype.find?(e,t)=>e.find(t):(e,t)=>e.filter(t)[0];let o=(e,t)=>{let i=e;return t.forEach((e=>{i=i&&i.children?r(i.children,(t=>t.domNode===e)):void 0})),i},a=(e,t,i)=>{let n=function(n){i("domEvent",n);let r=t(),a=s(n.currentTarget,r.domNode);a.reverse();let l,c=o(r.getLastRender(),a);return e.scheduleRender(),c&&(l=c.properties[`on${n.type}`].apply(c.properties.bind||this,arguments)),i("domEventProcessed",n),l};return(e,t,i,r)=>n},l=e=>{let t,i,r=(0,n.W)(e),s=r.performanceLogger,o=!0,l=!1,c=[],u=[],d=(e,i,n)=>{let o;r.eventHandlerInterceptor=a(t,(()=>o),s),o=e(i,n(),r),c.push(o),u.push(n)},h=()=>{if(i=void 0,o){o=!1,s("renderStart",void 0);for(let e=0;e<c.length;e++){let t=u[e]();s("rendered",void 0),c[e].update(t),s("patched",void 0)}s("renderDone",void 0),o=!0}};return t={renderNow:h,scheduleRender:()=>{i||l||(i=requestAnimationFrame(h))},stop:()=>{i&&(cancelAnimationFrame(i),i=void 0),l=!0},resume:()=>{l=!1,o=!0,t.scheduleRender()},append:(e,t)=>{d(n.v.append,e,t)},insertBefore:(e,t)=>{d(n.v.insertBefore,e,t)},merge:(e,t)=>{d(n.v.merge,e,t)},replace:(e,t)=>{d(n.v.replace,e,t)},detach:e=>{for(let t=0;t<u.length;t++)if(u[t]===e)return u.splice(t,1),c.splice(t,1)[0];throw new Error("renderFunction was not found")}},t}},39438:function(e,t,i){i.d(t,{Y:function(){return o},h:function(){return s}});var n=i(95490),r=i(77601);function s(e,t){return{...a(e,t),readResourcePaths:[]}}function o(e,t,i){const r=(0,n.mN)(e.itemUrl);return{...a(e,t),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:r?{rootPath:r.path,writtenUrls:[]}:null,resources:i?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function a(e,t){return{origin:t,url:(0,n.mN)(e.itemUrl),portal:e.portal||r.Z.getDefault(),portalItem:e}}},22679:function(e,t,i){i.d(t,{FO:function(){return h},W7:function(){return p},addOrUpdateResources:function(){return a},fetchResources:function(){return o},removeAllResources:function(){return c},removeResource:function(){return l}});var n=i(78619),r=i(88194),s=i(95490);async function o(e,t={},i){await e.load(i);const n=(0,s.v_)(e.itemUrl,"resources"),{start:r=1,num:o=10,sortOrder:a="asc",sortField:l="resource"}=t,c={query:{start:r,num:o,sortOrder:a,sortField:l,token:e.apiKey},signal:i?.signal},u=await e.portal.request(n,c);return{total:u.total,nextStart:u.nextStart,resources:u.resources.map((({created:t,size:i,resource:n})=>({created:new Date(t),size:i,resource:e.resourceFromPath(n)})))}}async function a(e,t,i,n){const o=new Map;for(const{resource:e,content:n,compress:s,access:a}of t){if(!e.hasPath())throw new r.Z(`portal-item-resource-${i}:invalid-path`,"Resource does not have a valid path");const[t,l]=u(e.path),c=`${t}/${s??""}/${a??""}`;o.has(c)||o.set(c,{prefix:t,compress:s,access:a,files:[]}),o.get(c).files.push({fileName:l,content:n})}await e.load(n);const a=(0,s.v_)(e.userItemUrl,"add"===i?"addResources":"updateResources");for(const{prefix:t,compress:i,access:r,files:s}of o.values()){const o=25;for(let l=0;l<s.length;l+=o){const c=s.slice(l,l+o),u=new FormData;t&&"."!==t&&u.append("resourcesPrefix",t),i&&u.append("compress","true"),r&&u.append("access",r);let d=0;for(const{fileName:e,content:t}of c)u.append("file"+ ++d,t,e);u.append("f","json"),await e.portal.request(a,{method:"post",body:u,signal:n?.signal})}}}async function l(e,t,i){if(!t.hasPath())throw new r.Z("portal-item-resources-remove:invalid-path","Resource does not have a valid path");await e.load(i);const n=(0,s.v_)(e.userItemUrl,"removeResources");await e.portal.request(n,{method:"post",query:{resource:t.path},signal:i?.signal}),t.portalItem=null}async function c(e,t){await e.load(t);const i=(0,s.v_)(e.userItemUrl,"removeResources");return e.portal.request(i,{method:"post",query:{deleteAll:!0},signal:t?.signal})}function u(e){const t=e.lastIndexOf("/");return-1===t?[".",e]:[e.slice(0,t),e.slice(t+1)]}function d(e){const[t,i]=function(e){const t=(0,s.Ml)(e);return null==t?[e,""]:[e.slice(0,e.length-t.length-1),`.${t}`]}(e),[n,r]=u(t);return[n,r,i]}async function h(e){return"blob"===e.type?e.blob:"json"===e.type?new Blob([e.jsonString],{type:"application/json"}):(await(0,n.Z)(e.url,{responseType:"blob"})).data}function p(e,t){if(!e.hasPath())return null;const[i,,n]=d(e.path);return e.portalItem.resourceFromPath((0,s.v_)(i,t+n))}},34615:function(e,t,i){i.d(t,{Y:function(){return r}});var n=i(5826);const r={readOnly:!0,get(){return(0,n.R)(this.view)}}},41921:function(e,t,i){i.d(t,{p:function(){return r}});var n=i(35675);function r(e,t,i){if(!i?.features||!i.hasZ)return;const r=(0,n.k)(i.geometryType,t,e.outSpatialReference);if(null!=r)for(const e of i.features)r(e.geometry)}},51870:function(e,t,i){i.d(t,{AA:function(){return m},Jn:function(){return c},LR:function(){return k},Lt:function(){return h},O3:function(){return w},Ou:function(){return y},RL:function(){return d},Uy:function(){return E},VW:function(){return l},W_:function(){return x},Wb:function(){return S},XH:function(){return f},Zz:function(){return o},ap:function(){return g},fl:function(){return p},fm:function(){return I},jG:function(){return P},kf:function(){return T},mF:function(){return a},tR:function(){return O},tq:function(){return C},vQ:function(){return b},vu:function(){return u},zx:function(){return _}});var n=i(26636),r=i(46368);function s(e){return e?P:O}function o(e,t){return t?.mode?t.mode:s(e).mode}function a(e,t){return null!=t?t:s(e)}function l(e,t){return o(null==e||(e.hasZ??!1),t)}function c(e,t){return a(null==e||(e.hasZ??!1),t)}function u(e){const t=v(e);return l(e.geometry,t)}function d(e){const t=v(e),i=l(e.geometry,t),n=null!=t&&"on-the-ground"!==i?I(t):0,r=t?.featureExpressionInfo;return{mode:i,offset:n,featureExpressionInfo:r}}function h(e){return f(d(e))}function p(e){return f(e)||m(e)}function m(e){return"0"===e?.featureExpressionInfo?.expression}function f(e){if(!e)return!1;if("on-the-ground"===e.mode)return!1;const t=e?.featureExpressionInfo?e.featureExpressionInfo.expression:null;return!(!t||"0"===t)}function v(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function g(e,t){if(!e?.offset)return 0;const{offset:i,unit:r}=e;if("decimal-degrees"===r)return 0;const s="unknown"!==r&&r?r:"meters",o=(0,n.y)(t);return o?(0,n.En)(i,s,o):0}function y(e,t,i){if(!i?.mode)return;const n=e.hasZ?e.z:0,r=g(i,e.spatialReference);switch(i.mode){case"absolute-height":return n-r;case"on-the-ground":return 0;case"relative-to-ground":return n-((t.elevationProvider.getElevation(e.x,e.y,n,e.spatialReference,"ground")??0)+r);case"relative-to-scene":return n-((t.elevationProvider.getElevation(e.x,e.y,n,e.spatialReference,"scene")??0)+r)}}function b(e,t,i,n=null){return w(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,i,n)}function _(e,t,i,n,r=null){return w(e,t[0],t[1],t.length>2?t[2]:0,i,n,r)}function w(e,t,i,n,r,s,o=null){if(null==s)return;const a=null!=o?o.mode:"absolute-height";if("on-the-ground"===a)return 0;const{absoluteZ:l}=C(t,i,n,r,e,s);return function(e,t,i,n,r,s,o,a){const l=g(o,r);switch(a){case"absolute-height":return e-l;case"relative-to-ground":return e-((s.elevationProvider.getElevation(t,i,n,r,"ground")??0)+l);case"relative-to-scene":return e-((s.elevationProvider.getElevation(t,i,n,r,"scene")??0)+l)}}(l,t,i,n,r,e,o,a)}function C(e,t,i,n,r,s){const o=g(s,n);switch(s.mode){case"absolute-height":return{absoluteZ:i+o,elevation:0};case"on-the-ground":{const i=r.elevationProvider.getElevation(e,t,0,n,"ground")??0;return{absoluteZ:i,elevation:i}}case"relative-to-ground":{const s=r.elevationProvider.getElevation(e,t,i,n,"ground")??0;return{absoluteZ:i+s+o,elevation:s}}case"relative-to-scene":{const s=r.elevationProvider.getElevation(e,t,i,n,"scene")??0;return{absoluteZ:i+s+o,elevation:s}}}}function x(e,t){if(null==t)return!1;const{mode:i}=t;return null!=i&&("scene"===e&&"relative-to-scene"===i||"ground"===e&&"absolute-height"!==i)}function E(e,t,i){return i&&i.mode!==t?`${e} only support ${t} elevation mode`:null}function S(e,t,i){return i?.mode===t?`${e} do not support ${t} elevation mode`:null}function T(e,t){return null!=t?.featureExpressionInfo&&"0"!==t.featureExpressionInfo.expression?`${e} do not support featureExpressionInfo`:null}function k(e,t){t&&e.warn(".elevationInfo=",t)}function I(e){return(e?.offset??0)*(0,r.Z7)(e?.unit)}const P={mode:"absolute-height",offset:0},O={mode:"on-the-ground",offset:null}},5826:function(e,t,i){i.d(t,{R:function(){return s}});var n=i(26636),r=i(77601);function s(e){const t="metric";if(null==e)return t;const i=e.map,s=(i&&"portalItem"in i?i.portalItem?.portal:null)??r.Z.getDefault();switch(s.user?.units??s.units){case t:return t;case"english":return"imperial"}return(0,n.yT)(e.spatialReference)??t}},3048:function(e,t,i){i.d(t,{K:function(){return r},_:function(){return n}});const n=Symbol("GroundInstance");function r(e){return null!=e&&"object"==typeof e&&n in e}},74558:function(e,t,i){i.d(t,{Z:function(){return d}});var n,r=i(73440),s=i(87833),o=i(17155),a=(i(61432),i(96711),i(83850),i(48023)),l=i(17733);let c=n=class extends(s.Z.EventedMixin(l.Z)){constructor(e){super(e),this.cameraTrackingEnabled=!0,this.positionTimezoneInfo={hours:0,minutes:0,seconds:0,autoUpdated:!0};const t=(new Date).getFullYear(),i=new Date("March 15, "+t+" 12:00:00 UTC");this._set("defaultDate",i),this._set("date",i)}get defaultDate(){return new Date(this._get("defaultDate").getTime())}static fromWebsceneLighting(e){return new n(e.cloneConstructProperties())}set defaultDate(e){const t=this._get("date")===this._get("defaultDate");e=new Date(e.getTime()),this._set("defaultDate",e),t&&this._set("date",e)}set date(e){null!=e&&(this.positionTimezoneInfo.autoUpdated=!1,this._set("date",new Date(e.getTime())))}autoUpdate(e,t){const i=n.calculateTimezoneOffset(this.positionTimezoneInfo);this.positionTimezoneInfo.hours=t.hours,this.positionTimezoneInfo.minutes=t.minutes,this.positionTimezoneInfo.seconds=t.seconds;let r=null;null!=e&&(this.positionTimezoneInfo.autoUpdated=!0,isNaN(e.getTime())?(r=this.defaultDate.getTime(),this._set("date",this.defaultDate)):(r=this.date&&this.date.getTime(),this._set("date",new Date(e.getTime()))));const s=n.calculateTimezoneOffset(this.positionTimezoneInfo);if(i!==s&&(u.target=this,u.timezoneOffset=s,this.emit("timezone-will-change",u),u.target=null),null!=e)return isNaN(e.getTime())||r!==e.getTime()}clone(){const e=this._get("date")===this._get("defaultDate"),t=new n({...this.cloneConstructProperties(),defaultDate:this.defaultDate,cameraTrackingEnabled:this.cameraTrackingEnabled});return e&&t._set("date",t._get("defaultDate")),t.positionTimezoneInfo.autoUpdated=this.positionTimezoneInfo.autoUpdated,t.positionTimezoneInfo.hours=this.positionTimezoneInfo.hours,t.positionTimezoneInfo.minutes=this.positionTimezoneInfo.minutes,t.positionTimezoneInfo.seconds=this.positionTimezoneInfo.seconds,t}cloneWithWebsceneLighting(e){const t=this.clone();return null!=e.date&&(t.date=e.date),t.directShadowsEnabled=e.directShadowsEnabled,t.displayUTCOffset=e.displayUTCOffset,t}cloneNonPersistentConstructProperties(){return{cameraTrackingEnabled:this.cameraTrackingEnabled}}};(0,r._)([(0,o.Cb)({type:Boolean})],c.prototype,"cameraTrackingEnabled",void 0),(0,r._)([(0,o.Cb)({type:Date})],c.prototype,"defaultDate",null),(0,r._)([(0,o.Cb)({type:Date})],c.prototype,"date",null),c=n=(0,r._)([(0,a.j)("esri.views.3d.environment.SunLighting")],c),(c||(c={})).calculateTimezoneOffset=function({hours:e,minutes:t,seconds:i}){return Math.round(e+t/60+i/3600)};const u={target:null,timezoneOffset:0},d=c},24127:function(e,t,i){i.d(t,{Z:function(){return u}});var n,r=i(73440),s=i(87833),o=i(17155),a=(i(61432),i(96711),i(83850),i(48023)),l=i(83946);let c=n=class extends(s.Z.EventedMixin(l.Z)){constructor(e){super(e),this.cameraTrackingEnabled=!0}clone(){return new n({...this.cloneConstructProperties(),cameraTrackingEnabled:this.cameraTrackingEnabled})}static fromWebsceneLighting(e){return new n(e.cloneConstructProperties())}cloneWithWebsceneLighting(e){const t=this.clone();return t.directShadowsEnabled=e.directShadowsEnabled,t}cloneNonPersistentConstructProperties(){return{cameraTrackingEnabled:this.cameraTrackingEnabled}}};(0,r._)([(0,o.Cb)({type:Boolean})],c.prototype,"cameraTrackingEnabled",void 0),c=n=(0,r._)([(0,a.j)("esri.views.3d.environment.VirtualLighting")],c);const u=c},94744:function(e,t,i){i.d(t,{A8:function(){return h},AK:function(){return o},BF:function(){return p},DI:function(){return c},GS:function(){return d},a8:function(){return a},f9:function(){return l},lt:function(){return u}});var n=i(32033),r=i(31856),s=i(19821);class o extends r.D{constructor(e,t,i,n){super(t,i),this.point=e,this.createGraphic=n}}function a(e){return(0,n.n)(e)&&e.intersector===s.q.PCL&&!!e.target}class l extends r.Z{constructor(e,t,i,n,r){super(e),this.layerViewUid=e,this.sublayerId=t,this.nodeIndex=i,this.componentIndex=n,this.triangleNr=r}}class c extends r.D{constructor(e,t,i){super(t,null),this.point=e,this.createVoxelGraphic=i}}class u extends r.D{constructor(e,t){super(e,null),this.createTiles3DGraphic=t}}function d(e){return(0,n.n)(e)&&e.intersector===s.q.I3S&&!!e.target}function h(e){return(0,n.n)(e)&&e.intersector===s.q.VOXEL&&!!e.target}function p(e){return(0,n.n)(e)&&e.intersector===s.q.TILES3D&&!!e.target}},80300:function(e,t,i){i.d(t,{hM:function(){return c},C8:function(){return u},$s:function(){return d},eU:function(){return l}});var n=i(53147),r=(i(61432),i(96094)),s=i(27583);var o=i(57225),a=i(49466);function l(e){return e&&e.enabled&&(function(e){return"extrude"===e.type}(e)||function(e){return"fill"===e.type}(e))&&null!=e.edges}function c(e,t){return u(function(e){return e&&e.enabled&&e.edges||null}(e),t)}function u(e,t){if(null==e)return null;const i=null!=e.color?(0,s.nI)(n.Z.toUnitRGBA(e.color)):(0,s.al)(0,0,0,0),o=(0,r.F2)(e.size),l=(0,r.F2)(e.extensionLength);switch(e.type){case"solid":return d({color:i,size:o,extensionLength:l,...t});case"sketch":return c={color:i,size:o,extensionLength:l,...t},{...p,...c,type:a.Pb.Sketch};default:return}var c}function d(e){return{...h,...e,type:a.Pb.Solid}}const h={color:(0,s.al)(0,0,0,.2),size:1,extensionLength:0,opacity:1,objectTransparency:o.i.OPAQUE,hasSlicePlane:!1},p={color:(0,s.al)(0,0,0,.2),size:1,extensionLength:0,opacity:1,objectTransparency:o.i.OPAQUE,hasSlicePlane:!1}},72432:function(e,t,i){i.d(t,{F5:function(){return o},HB:function(){return a},a9:function(){return n}});var n,r,s=i(99574);function o(e){switch(e){case"multiply":default:return n.Multiply;case"ignore":return n.Ignore;case"replace":return n.Replace;case"tint":return n.Tint}}function a(e,t,i){if(null==e||t===n.Ignore)return i[0]=255,i[1]=255,i[2]=255,void(i[3]=255);const r=(0,s.uZ)(Math.round(e[3]*c),0,c),o=0===r||t===n.Tint?0:t===n.Replace?u:d;i[0]=(0,s.uZ)(Math.round(e[0]*l),0,l),i[1]=(0,s.uZ)(Math.round(e[1]*l),0,l),i[2]=(0,s.uZ)(Math.round(e[2]*l),0,l),i[3]=r+o}(r=n||(n={}))[r.Multiply=1]="Multiply",r[r.Ignore=2]="Ignore",r[r.Replace=3]="Replace",r[r.Tint=4]="Tint";const l=255,c=85,u=c,d=2*c},90494:function(e,t,i){i.d(t,{Fb:function(){return s},KO:function(){return o},sb:function(){return r}});var n=i(27936);class r{constructor(e,t=null,i=0){this.array=e,this.spatialReference=t,this.offset=i}}function s(e){return"array"in e}function o(e,t,i="ground"){if((0,n.f)(t))return e.getElevation(t.x,t.y,t.z||0,t.spatialReference,i);if(s(t)){let n=t.offset;return e.getElevation(t.array[n++],t.array[n++],t.array[n]||0,t.spatialReference??e.spatialReference,i)}return e.getElevation(t[0],t[1],t[2]||0,e.spatialReference,i)}},32185:function(e,t,i){i.d(t,{Be:function(){return l},Nf:function(){return a},dF:function(){return c}});var n=i(99574),r=i(47925),s=i(60508);function o(e,t,i){if(null==t.longitude||null==t.latitude||null==i.longitude||null==i.latitude)throw new Error("Invalid points: no lon/lat");return function(e,t,i,r,s){const o=(0,n.Vl)(i),a=(0,n.Vl)(s),l=o-a,c=(0,n.Vl)(t)-(0,n.Vl)(r),u=Math.sin(l/2),d=Math.sin(c/2),h=2*(0,n.Kt)(Math.sqrt(u*u+Math.cos(o)*Math.cos(a)*d*d))*e;return Math.round(1e4*h)/1e4}(e,t.longitude,t.latitude,i.longitude,i.latitude)}function a(e,t,i){const n=t.spatialReference,a=(0,r.Iu)(n),l=new s.Z(t.x,e.y,n),c=new s.Z(i.x,e.y,n),u=new s.Z(e.x,t.y,n),d=new s.Z(e.x,i.y,n);return{lon:o(a.radius,l,c),lat:o(a.radius,u,d)}}function l(e,t,i){const r=t/i,s=(0,n.Vl)(e),o=Math.sin(r/2),a=Math.cos(s),l=2*(0,n.Kt)(Math.sqrt(o*o/(a*a)));return(0,n.BV)(l)}function c(e,t){const i=e?.[0];if(null==i)return null;t||(t={hours:0,minutes:0,seconds:0}),t.hours=function(e,t){let i=e/15;return t||(i=Math.round(i)),i}(i,!0);const n=t.hours%1;t.hours-=n,t.minutes=60*n;const r=t.minutes%1;return t.minutes-=r,t.seconds=Math.round(60*r),t}},43759:function(e,t,i){i.d(t,{K0:function(){return T},qL:function(){return w},us:function(){return k},wX:function(){return _}});var n=i(46451),r=i(96302),s=i(96094),o=i(82846),a=i(60508),l=i(45213),c=i(2051),u=i(78646),d=i(75428),h=i(27762),p=i(90494),m=i(92490),f=i(61442),v=i(32033),g=i(19821),y=i(90189),b=i(43925);async function _(e,t,i,n){const r=i?k(e,i):n,o=(0,s.s1)(t.x,t.y);r.requiresGroundFeedback=!0,r.enableDraped=!0;const a=new m.r(e.state.viewingMode);a.options.selectionMode=!0,a.options.store=f.e.ALL,e.sceneIntersectionHelper.intersectIntersectorScreen(o,a,r);const l=await async function(e,t,i){const n=new Array;let r,s=null;const o={defer(e){r=e()}};for(let a=0;a<t.length;a++){const l=t[a],c=(0,y.J4)(l,e);if(null!=c&&(c===e.map.ground||"type"in c&&(0,d.nx)(c.type)))break;const u=(0,y.bK)(l,e,o)??await r;if(r=null,null==u)continue;if("graphic"===u.type){if(null==s&&a!==t.length-1&&(s=new Set),null!=s){const e=x(u.graphic);if(s.has(e))continue;s.add(e)}if(!E(i,u.graphic))continue}const h=C(e,l),p=l.distanceInRenderSpace;if("media"===u.type){const e=u.element.toSource(h);n.push({...u,mapPoint:h,distance:p,sourcePoint:e})}else n.push({...u,mapPoint:h,distance:p})}return n}(e,a.results.all,r.graphics),c=a.results.ground,u=(0,y.J4)(c,e),p=null!=u&&"type"in u&&(0,d.nx)(u.type)?u:null,g={screenPoint:t,results:l,ground:{mapPoint:C(e,c),distance:(0,v.n)(c)?c.distanceInRenderSpace:0,layer:p}};return h.h.SCENEVIEW_HITTEST_RETURN_INTERSECTOR&&(g.intersector=a),g}function w(e,t,i,n){const r=i?k(e,i):n,o=!(!r.graphics?.include&&!r.graphics?.exclude),a=!(!r.mediaElements?.include&&!r.mediaElements?.exclude),l=(0,s.md)(t);r.enableDraped=r.include&&!r.include.has(b.xX)||r.exclude?.has(b.xX);const c=e.sceneIntersectionHelper,u=new m.r(e.state.viewingMode);if(u.options.selectionMode=!0,u.options.store=o||a?f.e.ALL:f.e.MIN,u.options.excludeLabels=i?.excludeLabels??!1,c.intersectIntersectorScreen(l,u,r),o||a){for(const t of u.results.all){const i=(0,y.bK)(t,e);if(null==i)return C(e,t);if(o&&("graphic"!==i.type||E(r.graphics,i.graphic)))return C(e,t);if(a&&("media"!==i.type||S(r.mediaElements,i.element)))return C(e,t)}return null}return C(e,u.results.min)}function C(e,t,i){return t.getIntersectionPoint(L)?(i=T(e,L,i),t.intersector===g.q.TERRAIN&&e.basemapTerrain&&(i.z=(0,p.KO)(e.basemapTerrain,i)??0),i):null}function x(e){const t=e.sourceLayer,i=e.layer,n=t&&"objectIdField"in t?t:i&&"objectIdField"in i?i:t;if(n){const t=n.objectIdField??u.d,i=e.attributes?.[t];if(i)return`o-${n.id}-${i}`}return`u-${e.uid}`}function E(e,t){return S(e,x(t))}function S(e,t){return null==e||(null==e.include||e.include.has(t))&&(null==e.exclude||!e.exclude.has(t))}function T(e,t,i){let n=e.spatialReference||l.Z.WGS84;return(0,c.S)(t,e.renderSpatialReference,L,n)?t=L:(n=l.Z.WGS84,(0,c.S)(t,e.renderSpatialReference,L,n)&&(t=L)),i?(i.x=t[0],i.y=t[1],i.z=t[2],i.spatialReference=n):i=new a.Z(t,n),i}function k(e,t){const i=I(e,t.include,M.INCLUDE),n=I(e,t.exclude,M.EXCLUDE);return{include:i.layerViewUids,exclude:n.layerViewUids,graphics:{include:i.graphicUids,exclude:n.graphicUids},mediaElements:{include:i.mediaElements,exclude:n.mediaElements}}}function I(e,t,i,s={layerViewUids:void 0,graphicUids:void 0,mediaElements:void 0}){if(!t)return s;if(t instanceof n.Z)o=s,a=x(t),o.graphicUids||(o.graphicUids=new Set),o.graphicUids.add(a),i===M.INCLUDE&&(null!=e.graphicsView&&t.layer===e?O(s,e.graphicsView.uid):t.layer&&P(s,e,t.layer.uid));else if("layer"in t&&"element"in t)(function(e,t){e.mediaElements||(e.mediaElements=new Set),e.mediaElements.add(t)})(s,t.element),i===M.INCLUDE&&P(s,e,t.layer.uid);else if((0,r.TW)(t))for(const n of t)n===e.graphics&&null!=e.graphicsView?O(s,e.graphicsView.uid):n===e.map.ground?O(s,b.xX):I(e,n,i,s);else"uid"in t&&P(s,e,t.uid);var o,a;return s}function P(e,t,i){const n=t.allLayerViews.find((e=>e.layer.uid===i));n&&O(e,n.uid)}function O(e,t){e.layerViewUids||(e.layerViewUids=new Set),e.layerViewUids.add(t)}const L=(0,o.Ue)();var M,R;(R=M||(M={}))[R.INCLUDE=0]="INCLUDE",R[R.EXCLUDE=1]="EXCLUDE"},38142:function(e,t,i){i.d(t,{T6:function(){return a},TX:function(){return o},j9:function(){return l}});var n=i(32033),r=i(31856),s=i(19821);function o(e){return(0,n.n)(e)&&e.intersector===s.q.TERRAIN&&!!e.target}class a extends r.D{constructor(e,t,i){super(e,t),this.triangleNr=i}}function l(e){return(0,n.n)(e)&&e.intersector===s.q.OVERLAY&&!!e.target}},54998:function(e,t,i){i.d(t,{AD:function(){return b},_N:function(){return p},nO:function(){return y},Hz:function(){return g}});var n=i(79487),r=i(64497),s=i(92638),o=i(41044),a=i(45701),l=i(90285),c=i(48857),u=i(5998),d=i(92217);class h extends d.x{constructor(e,t){super(e,"int",u.P.Draw,((i,n,r)=>i.setUniform1i(e,t(n,r))))}}var p,m=i(29193),f=i(95285),v=i(52061);!function(e){e[e.Uniform=0]="Uniform",e[e.Varying=1]="Varying",e[e.COUNT=2]="COUNT"}(p||(p={}));const g=429496.7296;function y(e,t){(0,r.I)(e/g*.5+.5,t)}function b(e,t){switch(t.componentData){case p.Varying:return function(e,t){const{vertex:i,fragment:n}=e;i.include(a.n),i.uniforms.add(new m.R("componentColorTex",(e=>e.componentParameters.texture.texture))),e.attributes.add(v.T.COMPONENTINDEX,"float"),e.varyings.add("vExternalColorMixMode","mediump float"),e.varyings.add("vExternalColor","vec4");const r=t.output===o.H_.ObjectAndLayerIdColor;r&&e.varyings.add("vObjectAndLayerIdColor","vec4"),e.include(s.A),i.constants.add("stride","float",(0,f.B)()?3:2),i.code.add(c.H`vec2 getComponentTextureCoordinates(float componentIndex, float typeOffset) {
float index = componentIndex * stride + typeOffset;
float texSize = float(textureSize(componentColorTex, 0).x);
float coordX = mod(index, texSize);
float coordY = floor(index / texSize);
return vec2(coordX, coordY) + 0.5;
}`),i.code.add(c.H`
  vec4 _readComponentColor() {
    vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 0.0);
    return texelFetch(componentColorTex, ivec2(textureCoordinates), 0);
   }

  float readElevationOffset() {
    vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 1.0);
    vec4 encodedElevation = texelFetch(componentColorTex, ivec2(textureCoordinates), 0);
    return uninterpolatedRGBAToFloat(encodedElevation) * ${c.H.float(g)};
  }

  ${r?c.H`
          void forwardObjectAndLayerIdColor() {
            vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 2.0);
            vObjectAndLayerIdColor = texelFetch(componentColorTex, ivec2(textureCoordinates), 0);
          }`:c.H`void forwardObjectAndLayerIdColor() {}`}

  vec4 forwardExternalColor(out bool castShadows) {
    vec4 componentColor = _readComponentColor() * 255.0;

    float shadowFlag = mod(componentColor.b * 255.0, 2.0);
    componentColor.b -= shadowFlag;
    castShadows = shadowFlag >= 1.0;

    int decodedColorMixMode;
    vExternalColor = decodeSymbolColor(componentColor, decodedColorMixMode) * 0.003921568627451; // = 1/255;
    vExternalColorMixMode = float(decodedColorMixMode) + 0.5; // add 0.5 to avoid interpolation artifacts

    return vExternalColor;
  }
`),n.code.add(c.H`
  void readExternalColor(out vec4 externalColor, out int externalColorMixMode) {
    externalColor = vExternalColor;
    externalColorMixMode = int(vExternalColorMixMode);
  }

  void outputObjectAndLayerIdColor() {
     ${r?c.H`fragColor = vObjectAndLayerIdColor;`:""}
  }
`)}(e,t);case p.Uniform:return function(e,t){const{vertex:i,fragment:n}=e;e.varyings.add("vExternalColor","vec4"),i.uniforms.add(new l.$("externalColor",(e=>e.componentParameters.externalColor))).code.add(c.H`float readElevationOffset() {
return 0.0;
}
void forwardObjectAndLayerIdColor() {}
vec4 forwardExternalColor(out bool castShadows) {
vExternalColor = externalColor;
castShadows = true;
return externalColor;
}`);const r=t.output===o.H_.ObjectAndLayerIdColor;n.uniforms.add(new h("externalColorMixMode",(e=>e.componentParameters.externalColorMixMode))).code.add(c.H`
    void readExternalColor(out vec4 color, out int colorMixMode) {
      color = vExternalColor;
      colorMixMode = externalColorMixMode;
    }

    void outputObjectAndLayerIdColor() {
      ${(0,c.If)(r,"fragColor = vec4(0, 0, 0, 0);")}
    }
  `)}(e,t);case p.COUNT:return;default:(0,n.Bg)(t.componentData)}}},92638:function(e,t,i){i.d(t,{A:function(){return s}});var n=i(72432),r=i(48857);function s(e){e.vertex.code.add(r.H`
    vec4 decodeSymbolColor(vec4 symbolColor, out int colorMixMode) {
      float symbolAlpha = 0.0;

      const float maxTint = 85.0;
      const float maxReplace = 170.0;
      const float scaleAlpha = 3.0;

      if (symbolColor.a > maxReplace) {
        colorMixMode = ${r.H.int(n.a9.Multiply)};
        symbolAlpha = scaleAlpha * (symbolColor.a - maxReplace);
      } else if (symbolColor.a > maxTint) {
        colorMixMode = ${r.H.int(n.a9.Replace)};
        symbolAlpha = scaleAlpha * (symbolColor.a - maxTint);
      } else if (symbolColor.a > 0.0) {
        colorMixMode = ${r.H.int(n.a9.Tint)};
        symbolAlpha = scaleAlpha * symbolColor.a;
      } else {
        colorMixMode = ${r.H.int(n.a9.Multiply)};
        symbolAlpha = 0.0;
      }

      return vec4(symbolColor.r, symbolColor.g, symbolColor.b, symbolAlpha);
    }
  `)}},57716:function(e,t,i){i.d(t,{O:function(){return l},r:function(){return n}});var n,r,s=i(79487),o=i(48857),a=i(52061);function l(e,t){switch(t.normalType){case n.Compressed:e.attributes.add(a.T.NORMALCOMPRESSED,"vec2"),e.vertex.code.add(o.H`vec3 decompressNormal(vec2 normal) {
float z = 1.0 - abs(normal.x) - abs(normal.y);
return vec3(normal + sign(normal) * min(z, 0.0), z);
}
vec3 normalModel() {
return decompressNormal(normalCompressed);
}`);break;case n.Attribute:e.attributes.add(a.T.NORMAL,"vec3"),e.vertex.code.add(o.H`vec3 normalModel() {
return normal;
}`);break;case n.ScreenDerivative:e.fragment.code.add(o.H`vec3 screenDerivativeNormal(vec3 positionView) {
return normalize(cross(dFdx(positionView), dFdy(positionView)));
}`);break;default:(0,s.Bg)(t.normalType);case n.COUNT:}}(r=n||(n={}))[r.Attribute=0]="Attribute",r[r.Compressed=1]="Compressed",r[r.ScreenDerivative=2]="ScreenDerivative",r[r.COUNT=3]="COUNT"},45701:function(e,t,i){i.d(t,{n:function(){return r}});var n=i(48857);function r(e){e.code.add(n.H`const float MAX_RGBA_FLOAT =
255.0 / 256.0 +
255.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 / 256.0;
const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);
vec4 float2rgba(const float value) {
float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);
vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);
const float toU8AsFloat = 1.0 / 255.0;
return fixedPointU8 * toU8AsFloat;
}`),e.code.add(n.H`const vec4 RGBA_TO_FLOAT_FACTORS = vec4(
255.0 / (256.0),
255.0 / (256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0 * 256.0)
);
float rgbaTofloat(vec4 rgba) {
return dot(rgba, RGBA_TO_FLOAT_FACTORS);
}`),e.code.add(n.H`const vec4 uninterpolatedRGBAToFloatFactors = vec4(
1.0 / 256.0,
1.0 / 256.0 / 256.0,
1.0 / 256.0 / 256.0 / 256.0,
1.0 / 256.0 / 256.0 / 256.0 / 256.0
);
float uninterpolatedRGBAToFloat(vec4 rgba) {
return (dot(round(rgba * 255.0), uninterpolatedRGBAToFloatFactors) - 0.5) * 2.0;
}`)}},90285:function(e,t,i){i.d(t,{$:function(){return s}});var n=i(5998),r=i(92217);class s extends r.x{constructor(e,t){super(e,"vec4",n.P.Draw,((i,n,r)=>i.setUniform4fv(e,t(n,r))))}}},82915:function(e,t,i){i.d(t,{as:function(){return r},t9:function(){return o}});var n=i(63974);class r{constructor(){this.adds=new n.Z,this.removes=new n.Z,this.updates=new n.Z({allocator:e=>e||new s,deallocator:e=>(e.renderGeometry=null,e)})}clear(){this.adds.clear(),this.removes.clear(),this.updates.clear()}prune(){this.adds.prune(),this.removes.prune(),this.updates.prune()}get empty(){return 0===this.adds.length&&0===this.removes.length&&0===this.updates.length}}class s{}class o{constructor(e){this.pending=e,this.adds=new Array,this.removes=new Array,this.updates=new Array}clearAddsAndRemoves(){this.adds.forEach((e=>this.pending.adds.removeUnordered(e))),this.removes.forEach((e=>this.pending.removes.removeUnordered(e))),this.adds.length=0,this.removes.length=0}clearUpdates(){this.updates.forEach((e=>this.pending.updates.removeUnordered(e))),this.updates.length=0}clear(){this.clearUpdates(),this.clearAddsAndRemoves()}}},92181:function(e,t,i){i.d(t,{i_:function(){return a},w0:function(){return l},Wd:function(){return c}});var n=i(82846),r=i(32033),s=i(19821);class o{constructor(e,t,i){this.object=e,this.geometryId=t,this.primitiveIndex=i}}class a extends r.x{constructor(){super(...arguments),this.intersector=s.q.HUD}}class l extends o{constructor(e,t){super(e.object,e.geometryId,e.primitiveIndex),this.center=(0,n.d9)(t)}}function c(e){return(0,r.n)(e)&&e.intersector===s.q.HUD&&!!e.target&&"center"in e.target}},92490:function(e,t,i){i.d(t,{j:function(){return p},r:function(){return m}});var n=i(24910),r=i(82846),s=i(12659),o=i(56172),a=i(48636),l=i(92181),c=i(61442),u=i(32033),d=i(19821),h=i(43925);const p=1e-5;class m{constructor(e){this.options=new c.o,this._results=new v,this.transform=new h.yn,this.camera=new a.Z,this.tolerance=p,this.verticalOffset=null,this._ray=(0,s.Ue)(),this._rayEnd=(0,r.Ue)(),this._rayBeginTransformed=(0,r.Ue)(),this._rayEndTransformed=(0,r.Ue)(),this.viewingMode=e??o.JY.Global}get results(){return this._results}get ray(){return this._ray}get rayBegin(){return this._ray.origin}get rayEnd(){return this._rayEnd}reset(e,t,i){this.resetWithRay((0,s.zk)(e,t,this._ray),i)}resetWithRay(e,t){this.camera=t,e!==this._ray&&(0,s.JG)(e,this._ray),0!==this.options.verticalOffset?this.viewingMode===o.JY.Local?this._ray.origin[2]-=this.options.verticalOffset:this.verticalOffset=this.options.verticalOffset:this.verticalOffset=null,(0,n.f)(this._rayEnd,this._ray.origin,this._ray.direction),this._results.init(this._ray)}intersect(e=null,t,i,n,r){this.point=t,this.filterPredicate=n,this.tolerance=i??p;const s=(0,h.W9)(this.verticalOffset);if(e&&e.length>0){const t=r?e=>{r(e)&&this.intersectObject(e)}:e=>{this.intersectObject(e)};for(const i of e){const e=i.getSpatialQueryAccelerator?.();null!=e?(null!=s?e.forEachAlongRayWithVerticalOffset(this._ray.origin,this._ray.direction,t,s):e.forEachAlongRay(this._ray.origin,this._ray.direction,t),this.options.selectionMode&&this.options.hud&&e.forEachDegenerateObject(t)):i.objects.forEach((e=>t(e)))}}this.sortResults()}intersectObject(e){const t=e.geometries;if(!t)return;const i=e.effectiveTransformation,r=(0,h.W9)(this.verticalOffset);for(const s of t){if(!s.visible)continue;const{material:t,id:o}=s;if(!t.visible)continue;this.transform.setAndInvalidateLazyTransforms(i,s.transformation),(0,n.t)(this._rayBeginTransformed,this.rayBegin,this.transform.inverse),(0,n.t)(this._rayEndTransformed,this.rayEnd,this.transform.inverse);const a=this.transform.transform;null!=r&&(r.objectTransform=this.transform),t.intersect(s,this.transform.transform,this,this._rayBeginTransformed,this._rayEndTransformed,((t,i,n,r)=>this.handleObjectIntersection({object:e,geometryId:o,primitiveIndex:n},t,i,a,r)))}}handleObjectIntersection(e,t,i,n,r){if(t<0||null!=this.filterPredicate&&!this.filterPredicate(this._ray.origin,this._rayEnd,t))return;const s=r?this._results.hud:this._results;e=r?new l.w0(e,r):e;const o=r?n=>n.set(d.q.HUD,e,t,i):r=>r.set(d.q.OBJECT,e,t,i,n);if((null==s.min.distance||t<s.min.distance)&&o(s.min),this.options.store!==c.e.MIN&&(null==s.max.distance||t>s.max.distance)&&o(s.max),this.options.store===c.e.ALL)if(r){const e=new l.i_(this._ray);o(e),this._results.hud.all.push(e)}else{const e=new u.x(this._ray);o(e),this._results.all.push(e)}}sortResults(e=this._results.all){e.sort(((e,t)=>e.distance!==t.distance?(e.distance??0)-(t.distance??0):e.drapedLayerOrder!==t.drapedLayerOrder?f(e.drapedLayerOrder,t.drapedLayerOrder):f(e.renderPriority,t.renderPriority)))}}function f(e,t){return(t??-Number.MAX_VALUE)-(e??-Number.MAX_VALUE)}class v{constructor(){this.min=new u.x((0,s.Ue)()),this.max=new u.x((0,s.Ue)()),this.hud={min:new l.i_((0,s.Ue)()),max:new l.i_((0,s.Ue)()),all:new Array},this.ground=new u.x((0,s.Ue)()),this.all=[]}init(e){this.min.init(e),this.max.init(e),this.ground.init(e),this.all.length=0,this.hud.min.init(e),this.hud.max.init(e),this.hud.all.length=0}}},61442:function(e,t,i){i.d(t,{e:function(){return r},o:function(){return n}});class n{constructor(){this.verticalOffset=0,this.selectionMode=!1,this.hud=!0,this.selectOpaqueTerrainOnly=!0,this.invisibleTerrain=!1,this.backfacesTerrain=!0,this.isFiltered=!1,this.filteredLayerViewUids=[],this.store=r.ALL,this.normalRequired=!0,this.excludeLabels=!1}}var r;!function(e){e[e.MIN=0]="MIN",e[e.MINMAX=1]="MINMAX",e[e.ALL=2]="ALL"}(r||(r={}))},32033:function(e,t,i){i.d(t,{n:function(){return h},x:function(){return d}});var n=i(31865),r=i(10934),s=i(24910),o=i(82846),a=i(73749),l=i(27583),c=i(12659),u=i(19821);class d{get ray(){return this._ray}get distanceInRenderSpace(){return null==this.distance?null:((0,s.g)(p,this.ray.direction,this.distance),(0,s.l)(p))}withinDistance(e){return!!h(this)&&this.distanceInRenderSpace<=e}getIntersectionPoint(e){return!!h(this)&&((0,s.g)(p,this.ray.direction,this.distance),(0,s.f)(e,this.ray.origin,p),!0)}getTransformedNormal(e){return(0,s.c)(m,this.normal),m[3]=0,(0,a.t)(m,m,this.transformation),(0,s.c)(e,m),(0,s.n)(e,e)}constructor(e){this.intersector=u.q.OBJECT,this.normal=(0,o.Ue)(),this.transformation=(0,r.Ue)(),this._ray=(0,c.Ue)(),this.init(e)}init(e){this.distance=this.target=this.drapedLayerOrder=this.renderPriority=null,this.intersector=u.q.OBJECT,(0,c.JG)(e,this._ray)}set(e,t,i,a,l,c,u){this.intersector=e,this.distance=i,(0,s.c)(this.normal,a??o.eG),(0,n.JG)(this.transformation,l??r.Wd),this.target=t,this.drapedLayerOrder=c,this.renderPriority=u}copy(e){(0,c.JG)(e.ray,this._ray),this.intersector=e.intersector,this.distance=e.distance,this.target=e.target,this.drapedLayerOrder=e.drapedLayerOrder,this.renderPriority=e.renderPriority,(0,s.c)(this.normal,e.normal),(0,n.JG)(this.transformation,e.transformation)}}function h(e){return null!=e?.distance}const p=(0,o.Ue)(),m=(0,l.Ue)()},31856:function(e,t,i){i.d(t,{D:function(){return r},Z:function(){return n}});class n{constructor(e){this.layerViewUid=e}}class r extends n{constructor(e,t){super(e),this.graphicUid=t}}},19821:function(e,t,i){var n;i.d(t,{q:function(){return n}}),function(e){e[e.OBJECT=0]="OBJECT",e[e.HUD=1]="HUD",e[e.TERRAIN=2]="TERRAIN",e[e.OVERLAY=3]="OVERLAY",e[e.I3S=4]="I3S",e[e.PCL=5]="PCL",e[e.LOD=6]="LOD",e[e.VOXEL=7]="VOXEL",e[e.TILES3D=8]="TILES3D"}(n||(n={}))},57225:function(e,t,i){var n;i.d(t,{i:function(){return n}}),function(e){e[e.TRANSPARENT=0]="TRANSPARENT",e[e.OPAQUE=1]="OPAQUE"}(n||(n={}))},90189:function(e,t,i){i.d(t,{VB:function(){return _},_s:function(){return w},tB:function(){return f},bK:function(){return v},J4:function(){return m}});var n=i(31865),r=i(82846),s=i(16447),o=i(69055),a=i(94744),l=i(38142),c=i(92181),u=i(32033),d=i(19821);function h(e){return(0,u.n)(e)&&e.intersector===d.q.OBJECT&&!!e.target}var p=i(32176);function m(e,t){return h(e)||(0,c.Wd)(e)?b(e.target?.object,t):(0,l.TX)(e)?t.map?.ground:(0,a.a8)(e)||(0,a.GS)(e)||(0,l.j9)(e)||(0,a.A8)(e)?b(e.target,t):null}function f(e,t){const i=v(e,t);return"graphic"===i?.type?i.graphic:null}function v(e,t,i={}){if(null==e)return null;if(h(e)||(0,c.Wd)(e))return g(e.target?.object,t,i);if((0,a.a8)(e)){const t=e.target.createGraphic();return{type:"graphic",graphic:t,layer:t.layer}}if((0,a.A8)(e)){const t=e.target.createVoxelGraphic();return{type:"graphic",graphic:t,layer:t.layer}}if((0,a.BF)(e)){const t=e.target.createTiles3DGraphic();return{type:"graphic",graphic:t,layer:t.layer}}return(0,l.j9)(e)||(0,p.w)(e)?g(e.target,t,i):(0,a.GS)(e)?function(e,t,i){const n=b(e,t);if(null==n)return null;const r=t.allLayerViews.find((e=>e.layer===n));if(!r||r.suspended||!("getGraphicFromIntersectorTarget"in r))return null;const s=i.defer;return y(r.getGraphicFromIntersectorTarget(e,{defer:s?async e=>s((async()=>y(await e()))):void 0}))}(e.target,t,i):null}function g(e,t,i){if(null==e?.graphicUid)return null;const n=b(e,t);if(null==n)return null;if(n===t.graphics)return null==t.graphicsView||"number"!=typeof e.graphicUid?null:t.graphicsView.getHit(e.graphicUid,i);const r=t.allLayerViews.find((e=>e.layer===n));return!r||r.suspended||null==e.graphicUid?null:"getHit"in r?r.getHit(e.graphicUid,i):null}function y(e){return null!=e?{type:"graphic",graphic:e,layer:e.layer}:null}function b(e,t){return null==e?.layerViewUid?null:null!=t.graphicsView&&e.layerViewUid===t.graphicsView.uid?t.graphics:t.allLayerViews.find((t=>t.uid===e.layerViewUid))?.layer}function _(e,t){if(h(e)||(0,c.Wd)(e))return(0,o.g)(e.target.object.boundingVolumeWorldSpace.bounds);if((0,p.w)(e)){(0,n.yZ)(C,e.transformation);const t=Math.max(C[0],C[1],C[2]);return e.target.baseBoundingSphere.radius*t}if((0,a.GS)(e)){const i=function(e,t){const i=b(e,t);if(null==i)return null;const n=t.allLayerViews.find((e=>e.layer===i));return n&&!n.suspended&&"getAABBFromIntersectorTarget"in n?n.getAABBFromIntersectorTarget(e):null}(e.target,t);return i?.5*(0,s.wz)(i):null}return null}function w(e){return!h(e)&&!(0,c.Wd)(e)&&((0,p.w)(e)?e.target.numLodLevels>1:!!(0,a.GS)(e))}const C=(0,r.Ue)()},32176:function(e,t,i){i.d(t,{w:function(){return a},x:function(){return o}});var n=i(32033),r=i(31856),s=i(19821);class o extends r.D{constructor(e,t,i,n,r){super(e,t),this.layerViewUid=e,this.graphicUid=t,this.triangleNr=i,this.baseBoundingSphere=n,this.numLodLevels=r}}function a(e){return(0,n.n)(e)&&e.intersector===s.q.LOD&&!!e.target}},10517:function(e,t,i){i.d(t,{Np:function(){return r},YE:function(){return n},q9:function(){return a}});var n,r,s,o=i(82915);function a(e){const t=new Map,i=i=>{let n=t.get(i);return n||(n=new o.t9(e),t.set(i,n)),n};return e.removes.forAll((e=>{l(e)&&i(e.material).removes.push(e)})),e.adds.forAll((e=>{l(e)&&i(e.material).adds.push(e)})),e.updates.forAll((e=>{l(e.renderGeometry)&&i(e.renderGeometry.material).updates.push(e)})),t}function l(e){return e.geometry.indexCount>=1}(s=n||(n={}))[s.Default=0]="Default",s[s.Screenshot=1]="Screenshot",s[s.ObjectAndLayerID=2]="ObjectAndLayerID",function(e){e[e.TOP=0]="TOP",e[e.RIGHT=1]="RIGHT",e[e.BOTTOM=2]="BOTTOM",e[e.LEFT=3]="LEFT"}(r||(r={}))},49466:function(e,t,i){i.d(t,{G7:function(){return r},Pb:function(){return n},UR:function(){return g},lV:function(){return y}});var n,r,s=i(54998),o=i(57716),a=i(28984),l=i(45701),c=i(80357),u=i(9535),d=i(48857),h=i(15727),p=i(57798),m=i(18489),f=i(29193),v=i(52061);function g(e,t){const{vertex:i}=e;i.include(l.n),e.include(o.O,t);const{silhouette:n,legacy:r,spherical:g}=t;i.uniforms.add(new f.R("componentDataTex",(e=>e.componentDataTexture))),e.attributes.add(v.T.COMPONENTINDEX,"float");i.constants.add("lineWidthFractionFactor","float",8),i.constants.add("extensionLengthOffset","float",128),i.code.add(d.H`
    vec2 _componentTextureCoords(float componentIndex, float fieldOffset) {
      float fieldIndex = ${d.H.float(3)}  * componentIndex + fieldOffset;
      float texSize = float(textureSize(componentDataTex, 0).x);
      float colIndex = mod(fieldIndex, texSize);
      float rowIndex = floor(fieldIndex / texSize);

      return vec2(colIndex, rowIndex) + 0.5;
    }

    struct ComponentData {
      vec4 color;
      vec3 normal;
      vec3 normal2;
      float lineWidth;
      float extensionLength;
      float type;
      float verticalOffset;
    };

    ComponentData readComponentData() {
      vec2 colorIndex = _componentTextureCoords(componentIndex, ${d.H.float(0)});
      vec2 otherIndex = _componentTextureCoords(componentIndex, ${d.H.float(1)});
      vec2 verticalOffsetIndex = _componentTextureCoords(float(componentIndex), ${d.H.float(2)} );
      vec3 normal = normalModel();
      vec3 normal2 = ${n?d.H`decompressNormal(normal2Compressed)`:d.H`normal`};

      vec4 colorValue = texelFetch(componentDataTex, ivec2(colorIndex), 0);
      vec4 otherValue = texelFetch(componentDataTex, ivec2(otherIndex), 0);
      float verticalOffset = uninterpolatedRGBAToFloat(texelFetch(componentDataTex, ivec2(verticalOffsetIndex), 0)) * ${d.H.float(s.Hz)};

      return ComponentData(
        vec4(colorValue.rgb, colorValue.a * otherValue.w), // otherValue.w stores separate opacity
        normal, normal2,
        otherValue.x * (255.0 / ${d.H.float(8)} ),
        otherValue.y * 255.0 - ${d.H.float(128)},
        -(otherValue.z * 255.0) + 0.5, // SOLID (=0/255) needs to be > 0.0, SKETCHY (=1/255) needs to be <= 0;
        verticalOffset
      );
    }
  `),r?i.code.add(d.H`vec3 _modelToWorldNormal(vec3 normal) {
return (model * vec4(normal, 0.0)).xyz;
}
vec3 _modelToViewNormal(vec3 normal) {
return (localView * model * vec4(normal, 0.0)).xyz;
}`):(i.uniforms.add(new h.j("transformNormalGlobalFromModel",(e=>e.transformNormalGlobalFromModel))),i.code.add(d.H`vec3 _modelToWorldNormal(vec3 normal) {
return transformNormalGlobalFromModel * normal;
}`)),n?(e.attributes.add(v.T.NORMAL2COMPRESSED,"vec2"),i.code.add(d.H`vec3 worldNormal(ComponentData data) {
return _modelToWorldNormal(normalize(data.normal + data.normal2));
}`)):i.code.add(d.H`vec3 worldNormal(ComponentData data) {
return _modelToWorldNormal(data.normal);
}`),r?i.code.add(d.H`void worldAndViewFromModelPosition(vec3 modelPos, float verticalOffset, out vec3 worldPos, out vec3 viewPos) {
worldPos = (model * vec4(modelPos, 1.0)).xyz;
viewPos = (localView * vec4(worldPos, 1.0)).xyz;
}`):(i.include(a.$,t),i.uniforms.add(new p.c("transformViewFromCameraRelativeRS",(e=>e.transformViewFromCameraRelativeRS)),new h.j("transformWorldFromModelRS",(e=>e.transformWorldFromModelRS)),new c.B("transformWorldFromModelTL",(e=>e.transformWorldFromModelTL)),new c.B("transformWorldFromModelTH",(e=>e.transformWorldFromModelTH)),new u.J("transformWorldFromViewTL",(e=>e.transformWorldFromViewTL)),new u.J("transformWorldFromViewTH",(e=>e.transformWorldFromViewTH))),i.code.add(d.H`
      void worldAndViewFromModelPosition(vec3 modelPos, float verticalOffset, out vec3 worldPos, out vec3 viewPos) {
        vec3 rotatedModelPosition = transformWorldFromModelRS * modelPos;

        vec3 transformCameraRelativeFromModel = dpAdd(
          transformWorldFromModelTL,
          transformWorldFromModelTH,
          -transformWorldFromViewTL,
          -transformWorldFromViewTH
        );

        worldPos = transformCameraRelativeFromModel + rotatedModelPosition;

        if (verticalOffset != 0.0) {
          vec3 vUp = ${g?"normalize(transformWorldFromModelTL + rotatedModelPosition);":"vec3(0.0, 0.0, 1.0);"}
          worldPos += verticalOffset * vUp;
        }

        viewPos = transformViewFromCameraRelativeRS * worldPos;
      }
    `)),i.uniforms.add(new m.C("transformProjFromView",(e=>e.camera.projectionMatrix))).code.add(d.H`vec4 projFromViewPosition(vec3 position) {
return transformProjFromView * vec4(position, 1.0);
}`),i.code.add(d.H`float calculateExtensionLength(float extensionLength, float lineLength) {
return extensionLength / (log2(max(1.0, 256.0 / lineLength)) * 0.2 + 1.0);
}`)}function y(e){return e===n.Sketch||e===n.Mixed}!function(e){e[e.Solid=0]="Solid",e[e.Sketch=1]="Sketch",e[e.Mixed=2]="Mixed",e[e.COUNT=3]="COUNT"}(n||(n={})),function(e){e[e.REGULAR=0]="REGULAR",e[e.SILHOUETTE=1]="SILHOUETTE"}(r||(r={}))},48636:function(e,t,i){i.d(t,{Z:function(){return S}});var n=i(73440),r=i(70880),s=i(96711),o=i(99574),a=i(96094),l=i(17155),c=(i(61432),i(83850),i(48023)),u=i(31865),d=i(10934),h=i(26821),p=i(41788),m=i(24910),f=i(82846),v=i(73749),g=i(27583),y=i(33869),b=i(12659),_=i(63271),w=i(56172);var C,x=i(10517);let E=C=class extends r.Z{constructor(e){super(e),this._ray=(0,b.Ue)(),this._viewport=(0,g.al)(0,0,1,1),this._padding=(0,g.al)(0,0,0,0),this._fov=55/180*Math.PI,this._nearFar=(0,p.al)(1,1e3),this._viewDirty=!0,this._viewMatrix=(0,d.Ue)(),this._viewProjectionDirty=!0,this._viewProjectionMatrix=(0,d.Ue)(),this._viewInverseTransposeMatrixDirty=!0,this._viewInverseTransposeMatrix=(0,d.Ue)(),this._frustumDirty=!0,this._frustum=(0,y.Ue)(),this._fullViewport=(0,g.Ue)(),this._pixelRatio=1,this.row=0,this.column=0,this._rows=1,this._columns=1,this._center=(0,f.Ue)(),this._up=(0,f.Ue)(),this.relativeElevation=0}get pixelRatio(){return this._pixelRatio}set pixelRatio(e){this._pixelRatio=e>0?e:1}get rows(){return this._rows}set rows(e){this._rows=Math.max(1,e)}get columns(){return this._columns}set columns(e){this._columns=Math.max(1,e)}get eye(){return this._ray.origin}set eye(e){this._compareAndSetView(e,this._ray.origin)}get center(){return this._center}set center(e){this._compareAndSetView(e,this._center,"_center")}get ray(){return(0,m.d)(this._ray.direction,this.center,this.eye),this._ray}get up(){return this._up}set up(e){this._compareAndSetView(e,this._up,"_up")}get viewMatrix(){return this._ensureViewClean(),this._viewMatrix}set viewMatrix(e){(0,u.JG)(this._viewMatrix,e),this.notifyChange("_viewMatrix"),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get viewForward(){return this._ensureViewClean(),(0,m.i)((0,f.Ue)(),-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10])}get viewUp(){return this._ensureViewClean(),(0,m.i)((0,f.Ue)(),this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9])}get viewRight(){return this._ensureViewClean(),(0,m.i)((0,f.Ue)(),this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8])}get nearFar(){return this._nearFar}get near(){return this._nearFar[0]}set near(e){this._nearFar[0]!==e&&(this._nearFar[0]=e,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_nearFar"))}get far(){return this._nearFar[1]}set far(e){this._nearFar[1]!==e&&(this._nearFar[1]=e,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_nearFar"))}get viewport(){return this._viewport}set viewport(e){this.x=e[0],this.y=e[1],this.width=e[2],this.height=e[3]}get screenViewport(){if(1===this.pixelRatio)return this._viewport;const e=(0,v.d)((0,g.Ue)(),this._viewport,1/this.pixelRatio),t=this._get("screenViewport");return t&&(0,v.e)(e,t)?t:e}get screenPadding(){if(1===this.pixelRatio)return this._padding;const e=(0,v.d)((0,g.Ue)(),this._padding,1/this.pixelRatio),t=this._get("screenPadding");return t&&(0,v.e)(e,t)?t:e}get x(){return this._viewport[0]}set x(e){e+=this._padding[x.Np.LEFT],this._viewport[0]!==e&&(this._viewport[0]=e,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_viewport"))}get y(){return this._viewport[1]}set y(e){e+=this._padding[x.Np.BOTTOM],this._viewport[1]!==e&&(this._viewport[1]=e,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_viewport"))}get width(){return this._viewport[2]}set width(e){this._viewport[2]!==e&&(this._viewport[2]=e,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_viewport"))}get height(){return this._viewport[3]}set height(e){this._viewport[3]!==e&&(this._viewport[3]=e,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_viewport"))}get fullWidth(){return this._viewport[2]+this._padding[x.Np.RIGHT]+this._padding[x.Np.LEFT]}set fullWidth(e){this.width=e-(this._padding[x.Np.RIGHT]+this._padding[x.Np.LEFT])}get fullHeight(){return this._viewport[3]+this._padding[x.Np.TOP]+this._padding[x.Np.BOTTOM]}set fullHeight(e){this.height=e-(this._padding[x.Np.TOP]+this._padding[x.Np.BOTTOM])}get fullViewport(){return this._fullViewport[0]=this._viewport[0]-this._padding[x.Np.LEFT],this._fullViewport[1]=this._viewport[1]-this._padding[x.Np.BOTTOM],this._fullViewport[2]=this.fullWidth,this._fullViewport[3]=this.fullHeight,this._fullViewport}get _aspect(){return this.width/this.height}get padding(){return this._padding}set padding(e){(0,v.a)(this._padding,e)||(this._viewport[0]+=e[x.Np.LEFT]-this._padding[x.Np.LEFT],this._viewport[1]+=e[x.Np.BOTTOM]-this._padding[x.Np.BOTTOM],this._viewport[2]-=e[x.Np.RIGHT]+e[x.Np.LEFT]-(this._padding[x.Np.RIGHT]+this._padding[x.Np.LEFT]),this._viewport[3]-=e[x.Np.TOP]+e[x.Np.BOTTOM]-(this._padding[x.Np.TOP]+this._padding[x.Np.BOTTOM]),(0,v.c)(this._padding,e),this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_padding"),this.notifyChange("_viewport"))}get viewProjectionMatrix(){return this._viewProjectionDirty&&((0,u.Jp)(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionDirty=!1),this._viewProjectionMatrix}get projectionMatrix(){return this._projectionMatrixInternal}get inverseProjectionMatrix(){return(0,u.U_)((0,d.Ue)(),this.projectionMatrix)||this._get("inverseProjectionMatrix")||(0,d.Ue)()}get fov(){return this._fov}set fov(e){this._fov=e,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovX(){return function(e,t,i){return 2*Math.atan(t*Math.tan(.5*e)/Math.sqrt(t*t+i*i))}(this._fov,this.width,this.height)}set fovX(e){this._fov=function(e,t,i){return 2*Math.atan(Math.sqrt(t*t+i*i)*Math.tan(.5*e)/t)}(e,this.width,this.height),this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovY(){return function(e,t,i){return 2*Math.atan(i*Math.tan(.5*e)/Math.sqrt(t*t+i*i))}(this._fov,this.width,this.height)}set fovY(e){this._fov=function(e,t,i){return 2*Math.atan(Math.sqrt(t*t+i*i)*Math.tan(.5*e)/i)}(e,this.width,this.height),this._viewProjectionDirty=!0,this._frustumDirty=!0}get distance(){return(0,m.j)(this.center,this.eye)}get frustum(){return this._recomputeFrustum(),this._frustum}get viewInverseTransposeMatrix(){return(this._viewInverseTransposeMatrixDirty||this._viewDirty)&&((0,u.U_)(this._viewInverseTransposeMatrix,this.viewMatrix),(0,u.p4)(this._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),this._viewInverseTransposeMatrix}depthNDCToWorld(e){const{near:t,far:i}=this;return 2*t*i/(i+t-e*(i-t))}get perRenderPixelRatio(){return Math.tan(this.fovX/2)/(this.width/2)}get perScreenPixelRatio(){return this.perRenderPixelRatio*this.pixelRatio}get aboveGround(){return null!=this.relativeElevation&&this.relativeElevation>=0}get _projectionMatrixInternal(){const e=this.width,t=this.height,i=this.near*Math.tan(this.fovY/2)*2,n=i*this._aspect,r=i/this.rows,s=n/this.columns,o=-n/2+this.column*s,a=o+s,l=-i/2+this.row*r,c=l+r,h=(0,u.oy)((0,d.Ue)(),o*(1+2*this._padding[x.Np.LEFT]/e),a*(1+2*this._padding[x.Np.RIGHT]/e),l*(1+2*this._padding[x.Np.BOTTOM]/t),c*(1+2*this._padding[x.Np.TOP]/t),this.near,this.far),p=this._get("projectionMatrix");return p&&(0,u.fS)(p,h)?p:h}copyFrom(e){(0,m.c)(this._ray.origin,e.eye),this.center=e.center,this.up=e.up,(0,v.c)(this._viewport,e.viewport),this.notifyChange("_viewport"),(0,v.c)(this._padding,e.padding),this.notifyChange("_padding"),(0,h.JG)(this._nearFar,e.nearFar),this.notifyChange("_nearFar"),this._fov=e.fov,this.row=e.row,this.column=e.column,this.rows=e.rows,this.columns=e.columns,this.relativeElevation=e.relativeElevation;const t=e;return this._viewDirty=t._viewDirty,this._viewDirty||((0,u.JG)(this._viewMatrix,e.viewMatrix),this.notifyChange("_viewMatrix")),this._viewProjectionDirty=!0,this._frustumDirty=t._frustumDirty,this._frustumDirty||((0,y.JG)(this._frustum,e.frustum),this._frustumDirty=!1),t._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:((0,u.JG)(this._viewInverseTransposeMatrix,e.viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),(0,v.c)(this._fullViewport,e.fullViewport),this.pixelRatio=e.pixelRatio,this}copyViewFrom(e){this.eye=e.eye,this.center=e.center,this.up=e.up,this.fov=e.fov}clone(){return(new C).copyFrom(this)}equals(e){return(0,m.q)(this.eye,e.eye)&&(0,m.q)(this.center,e.center)&&(0,m.q)(this.up,e.up)&&(0,v.a)(this._viewport,e.viewport)&&(0,v.a)(this._padding,e.padding)&&(0,h.I6)(this.nearFar,e.nearFar)&&this._fov===e.fov&&this.pixelRatio===e.pixelRatio&&this.relativeElevation===e.relativeElevation&&this.row===e.row&&this.column===e.column&&this.rows===e.rows&&this.columns===e.columns}almostEquals(e){const t=Math.max(1,1/this.pixelRatio,1/e.pixelRatio);if(Math.abs(e.fov-this._fov)>=.001||(0,v.f)(e.screenPadding,this.screenPadding)>=t||(0,v.f)(this.screenViewport,e.screenViewport)>=t||this.row!==e.row||this.column!==e.column||this.rows!==e.rows||this.columns!==e.columns)return!1;(0,m.a)(I,e.eye,e.center),(0,m.a)(P,this.eye,this.center);const i=(0,m.e)(I,P),n=(0,m.y)(I),r=(0,m.y)(P),s=5e-4;return i*i>=(1-1e-10)*n*r&&(0,m.x)(e.eye,this.eye)<Math.max(n,r)*s*s}computeRenderPixelSizeAt(e){return this.computeRenderPixelSizeAtDist(this._viewDirectionDistance(e))}computeRenderPixelSizeAtDist(e){return e*this.perRenderPixelRatio}computeScreenPixelSizeAt(e){return this.computeScreenPixelSizeAtDist(this._viewDirectionDistance(e))}_viewDirectionDistance(e){return Math.abs((0,_.SR)(this.viewForward,(0,m.d)(I,e,this.eye)))}computeScreenPixelSizeAtDist(e){return e*this.perScreenPixelRatio}computeDistanceFromRadius(e,t){return e/Math.tan(Math.min(this.fovX,this.fovY)/(2*(t||1)))}getScreenCenter(e=(0,a.s1)()){return e[0]=(this.padding[x.Np.LEFT]+this.width/2)/this.pixelRatio,e[1]=(this.padding[x.Np.TOP]+this.height/2)/this.pixelRatio,e}getRenderCenter(e,t=.5,i=.5){return e[0]=this.padding[x.Np.LEFT]+this.width*t,e[1]=this.padding[x.Np.BOTTOM]+this.height*i,e[2]=.5,e}setGLViewport(e){const t=this.viewport,i=this.padding;e.setViewport(t[0]-i[3],t[1]-i[2],t[2]+i[1]+i[3],t[3]+i[0]+i[2])}applyProjection(e,t){e!==T&&(0,m.c)(T,e),T[3]=1,(0,v.t)(T,T,this.projectionMatrix);const i=Math.abs(T[3]);(0,m.g)(T,T,1/i);const n=this.fullViewport;t[0]=(0,o.t7)(0,n[0]+n[2],.5+.5*T[0]),t[1]=(0,o.t7)(0,n[1]+n[3],.5+.5*T[1]),t[2]=.5*(T[2]+1),t[3]=i}unapplyProjection(e,t){const i=this.fullViewport;T[0]=(e[0]/(i[0]+i[2])*2-1)*e[3],T[1]=(e[1]/(i[1]+i[3])*2-1)*e[3],T[2]=(2*e[2]-1)*e[3],T[3]=e[3],null!=this.inverseProjectionMatrix&&((0,v.t)(T,T,this.inverseProjectionMatrix),t[0]=T[0],t[1]=T[1],t[2]=T[2])}projectToScreen(e,t){return this.projectToRenderScreen(e,O),this.renderToScreen(O,t),t}projectToRenderScreen(e,t){if(T[0]=e[0],T[1]=e[1],T[2]=e[2],T[3]=1,(0,v.t)(T,T,this.viewProjectionMatrix),0===T[3])return null;const i=T;(0,m.g)(i,i,1/Math.abs(T[3]));const n=this.fullViewport,r=(0,o.t7)(0,n[0]+n[2],.5+.5*i[0]),s=(0,o.t7)(0,n[1]+n[3],.5+.5*i[1]);return"x"in t?(t.x=r,t.y=s):(t[0]=r,t[1]=s,t.length>2&&(t[2]=.5*(i[2]+1))),t}unprojectFromScreen(e,t){return this.unprojectFromRenderScreen(this.screenToRender(e,O),t)}unprojectFromRenderScreen(e,t){if((0,u.Jp)(k,this.projectionMatrix,this.viewMatrix),!(0,u.U_)(k,k))return null;const i=this.fullViewport;return T[0]=2*(e[0]-i[0])/i[2]-1,T[1]=2*(e[1]-i[1])/i[3]-1,T[2]=2*e[2]-1,T[3]=1,(0,v.t)(T,T,k),0===T[3]?null:(t[0]=T[0]/T[3],t[1]=T[1]/T[3],t[2]=T[2]/T[3],t)}constrainWindowSize(e,t,i,n){const r=e*this.pixelRatio,s=t*this.pixelRatio,o=Math.max(r-i/2,0),a=Math.max(this.fullHeight-s-n/2,0),l=-Math.min(r-i/2,0),c=-Math.min(this.fullHeight-s-n/2,0),u=i-l- -Math.min(this.fullWidth-r-i/2,0),d=n-c- -Math.min(s-n/2,0);return[Math.round(o),Math.round(a),Math.round(u),Math.round(d)]}computeUp(e){e===w.JY.Global?this._computeUpGlobal():this._computeUpLocal()}screenToRender(e,t){const i=e[0]*this.pixelRatio,n=this.fullHeight-e[1]*this.pixelRatio;return t[0]=i,t[1]=n,t}renderToScreen(e,t){const i=e[0]/this.pixelRatio,n=(this.fullHeight-e[1])/this.pixelRatio;t[0]=i,t[1]=n}_computeUpGlobal(){(0,m.d)(I,this.center,this.eye);const e=(0,m.l)(this.center);e<1?((0,m.i)(this._up,0,0,1),this._markViewDirty(),this.notifyChange("_up")):Math.abs((0,m.e)(I,this.center))>.9999*(0,m.l)(I)*e||((0,m.h)(this._up,I,this.center),(0,m.h)(this._up,this._up,I),(0,m.n)(this._up,this._up),this.notifyChange("_up"),this._markViewDirty())}_computeUpLocal(){(0,m.E)(I,this.eye,this.center),Math.abs(I[2])<=.9999&&((0,m.g)(I,I,I[2]),(0,m.i)(this._up,-I[0],-I[1],1-I[2]),(0,m.n)(this._up,this._up),this.notifyChange("_up"),this._markViewDirty())}_compareAndSetView(e,t,i=""){"number"==typeof e[0]&&isFinite(e[0])&&"number"==typeof e[1]&&isFinite(e[1])&&"number"==typeof e[2]&&isFinite(e[2])?(0,m.q)(e,t)||((0,m.c)(t,e),this._markViewDirty(),i.length&&this.notifyChange(i)):s.Z.getLogger("esri.views.3d.webgl-engine.lib.RenderCamera").warn("RenderCamera vector contains invalid number, ignoring value")}_markViewDirty(){this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0}_recomputeFrustum(){this._frustumDirty&&((0,y.q_)(this.viewMatrix,this.projectionMatrix,this._frustum),this._frustumDirty=!1)}_ensureViewClean(){this._viewDirty&&((0,u.zB)(this._viewMatrix,this.eye,this.center,this.up),this.notifyChange("_viewMatrix"),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)}};(0,n._)([(0,l.Cb)()],E.prototype,"_viewport",void 0),(0,n._)([(0,l.Cb)()],E.prototype,"_padding",void 0),(0,n._)([(0,l.Cb)()],E.prototype,"_fov",void 0),(0,n._)([(0,l.Cb)()],E.prototype,"_nearFar",void 0),(0,n._)([(0,l.Cb)()],E.prototype,"_viewDirty",void 0),(0,n._)([(0,l.Cb)()],E.prototype,"_viewMatrix",void 0),(0,n._)([(0,l.Cb)()],E.prototype,"_pixelRatio",void 0),(0,n._)([(0,l.Cb)()],E.prototype,"pixelRatio",null),(0,n._)([(0,l.Cb)()],E.prototype,"row",void 0),(0,n._)([(0,l.Cb)()],E.prototype,"column",void 0),(0,n._)([(0,l.Cb)()],E.prototype,"_rows",void 0),(0,n._)([(0,l.Cb)()],E.prototype,"rows",null),(0,n._)([(0,l.Cb)()],E.prototype,"_columns",void 0),(0,n._)([(0,l.Cb)()],E.prototype,"columns",null),(0,n._)([(0,l.Cb)()],E.prototype,"eye",null),(0,n._)([(0,l.Cb)()],E.prototype,"center",null),(0,n._)([(0,l.Cb)()],E.prototype,"_center",void 0),(0,n._)([(0,l.Cb)()],E.prototype,"up",null),(0,n._)([(0,l.Cb)()],E.prototype,"_up",void 0),(0,n._)([(0,l.Cb)()],E.prototype,"viewMatrix",null),(0,n._)([(0,l.Cb)({readOnly:!0})],E.prototype,"viewForward",null),(0,n._)([(0,l.Cb)({readOnly:!0})],E.prototype,"viewUp",null),(0,n._)([(0,l.Cb)({readOnly:!0})],E.prototype,"viewRight",null),(0,n._)([(0,l.Cb)({readOnly:!0})],E.prototype,"nearFar",null),(0,n._)([(0,l.Cb)()],E.prototype,"near",null),(0,n._)([(0,l.Cb)()],E.prototype,"far",null),(0,n._)([(0,l.Cb)()],E.prototype,"viewport",null),(0,n._)([(0,l.Cb)({readOnly:!0})],E.prototype,"screenViewport",null),(0,n._)([(0,l.Cb)({readOnly:!0})],E.prototype,"screenPadding",null),(0,n._)([(0,l.Cb)()],E.prototype,"x",null),(0,n._)([(0,l.Cb)()],E.prototype,"y",null),(0,n._)([(0,l.Cb)()],E.prototype,"width",null),(0,n._)([(0,l.Cb)()],E.prototype,"height",null),(0,n._)([(0,l.Cb)()],E.prototype,"fullWidth",null),(0,n._)([(0,l.Cb)()],E.prototype,"fullHeight",null),(0,n._)([(0,l.Cb)({readOnly:!0})],E.prototype,"_aspect",null),(0,n._)([(0,l.Cb)()],E.prototype,"padding",null),(0,n._)([(0,l.Cb)({readOnly:!0})],E.prototype,"projectionMatrix",null),(0,n._)([(0,l.Cb)({readOnly:!0})],E.prototype,"inverseProjectionMatrix",null),(0,n._)([(0,l.Cb)()],E.prototype,"fov",null),(0,n._)([(0,l.Cb)()],E.prototype,"fovX",null),(0,n._)([(0,l.Cb)()],E.prototype,"fovY",null),(0,n._)([(0,l.Cb)()],E.prototype,"viewInverseTransposeMatrix",null),(0,n._)([(0,l.Cb)({readOnly:!0})],E.prototype,"_projectionMatrixInternal",null),(0,n._)([(0,l.Cb)()],E.prototype,"relativeElevation",void 0),E=C=(0,n._)([(0,c.j)("esri.views.3d.webgl.RenderCamera")],E);const S=E,T=(0,g.Ue)(),k=(0,d.Ue)(),I=(0,f.Ue)(),P=(0,f.Ue)(),O=(0,a.J$)()},85754:function(e,t,i){i.d(t,{V5:function(){return s},e7:function(){return r},zc:function(){return o}});var n=i(76554);async function r(e,t=e.popupTemplate){if(null==t)return[];const i=await t.getRequiredFields(e.fieldsIndex),{lastEditInfoEnabled:r}=t,{objectIdField:s,typeIdField:o,globalIdField:a,relationships:l}=e;if(i.includes("*"))return["*"];const c=r?(0,n.CH)(e):[],u=(0,n.Q0)(e.fieldsIndex,[...i,...c]);return o&&u.push(o),u&&s&&e.fieldsIndex?.has(s)&&!u.includes(s)&&u.push(s),u&&a&&e.fieldsIndex?.has(a)&&!u.includes(a)&&u.push(a),l&&l.forEach((t=>{const{keyField:i}=t;u&&i&&e.fieldsIndex?.has(i)&&!u.includes(i)&&u.push(i)})),u}function s(e,t){return e.popupTemplate?e.popupTemplate:null!=t&&t.defaultPopupTemplateEnabled&&null!=e.defaultPopupTemplate?e.defaultPopupTemplate:null}function o(e,t){return null!=s(e,{defaultPopupTemplateEnabled:t})}},99734:function(e,t,i){var n;i.d(t,{n:function(){return n}}),function(e){e[e.ANIMATING=0]="ANIMATING",e[e.INTERACTING=1]="INTERACTING",e[e.IDLE=2]="IDLE"}(n||(n={}))},75015:function(e,t,i){i.d(t,{c:function(){return u}});i(61432);var n=i(61100),r=i(93568),s=i(92462),o=i(87422),a=i(99153),l=i(39355);class c{constructor(e,t){this.item=e,this.controller=t,this.promise=null}}class u{constructor(e){this._schedule=null,this._task=null,this._deferreds=new o.Z,this._controllers=new o.Z,this._processingItems=new o.Z,this._pausedSignal=(0,l.t)(!1),this.concurrency=1,e.concurrency&&(this.concurrency=e.concurrency),this._queue=new s.Z(e.peeker),this.process=e.process;const t=e.scheduler;e.priority&&t&&(this._task=t.registerTask(e.priority,this))}destroy(){this.clear(),this._schedule=(0,n.hw)(this._schedule),this._task=(0,n.hw)(this._task)}get updating(){return!!this._task?.updating||this.running}get length(){return this._processingItems.size+this._queue.length}abort(e){const t=this._controllers.get(e);t&&t.abort()}clear(){this._queue.clear();const e=[];this._controllers.forEach((t=>e.push(t))),this._controllers.clear(),e.forEach((e=>e.abort())),this._processingItems.clear(),this._cancelNext()}forEach(e){this._deferreds.forEach(((t,i)=>e(i)))}get(e){const t=this._deferreds.get(e);return t?t.promise:void 0}isOngoing(e){return this._processingItems.has(e)}has(e){return this._deferreds.has(e)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(e,t){const i=this.get(e);if(i)return i;const n=new AbortController;let s=null;t&&(s=(0,r.fu)(t,(()=>n.abort())));const o=()=>{a.remove(),null!=s&&s.remove(),this._removeItem(e),this._queue.remove(e),this._scheduleNext()},a=(0,r.$F)(n.signal,(()=>{const t=this._processingItems.get(e);t&&t.controller.abort(),o(),l.reject((0,r.zE)())})),l=(0,r.hh)();return this._deferreds.set(e,l),this._controllers.set(e,n),l.promise.then(o,o),this._queue.push(e),this._scheduleNext(),l.promise}last(){return this._queue.last()}lastPromise(){const e=this.last();return e?this.get(e):null}peek(){return this._queue.peek()}popLast(){const e=this._queue.popLast();return e&&(this._deferreds.get(e)?.reject((0,r.zE)()),this._removeItem(e)),e}reset(){const e=Array.from(this._processingItems.values());this._processingItems.clear();for(const t of e)this._queue.push(t.item),t.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const e=[];for(;this._queue.length;)e.push(this._queue.pop());return this.clear(),e}get running(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(e){for(;!e.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),e.madeProgress()}_removeItem(e){this._deferreds.delete(e),this._controllers.delete(e),this._processingItems.delete(e)}_scheduleNext(){this._task||this._pausedSignal.value||this._schedule||(this._schedule=(0,a.Os)((()=>{this._schedule=null,this._next()})))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(e,t){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).resolve(t))}_processError(e,t){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).reject(t))}_canProcessFulfillment(e){return!!this._deferreds.get(e.item)&&this._processingItems.get(e.item)===e}_process(e){if(null==e)return;let t;const i=new AbortController,n=new c(e,i);this._processingItems.set(e,n);try{t=this.process(e,i.signal)}catch(e){this._processError(n,e)}(0,r.y8)(t)?(n.promise=t,t.then((e=>this._processResult(n,e)),(e=>this._processError(n,e)))):this._processResult(n,t)}get test(){}}},50399:function(e,t,i){i.d(t,{G5:function(){return I},S0:function(){return P},T8:function(){return n},sq:function(){return O},z4:function(){return y}});var n,r,s=i(12818),o=(i(61432),i(96711)),a=i(61100),l=i(24498),c=i(63974),u=i(93568),d=i(90403),h=i(39355),p=i(32555),m=i(47641),f=i(97332),v=i(99734),g=i(78891);function y(){return new T.Scheduler}(r=n||(n={})).RESOURCE_CONTROLLER_IMMEDIATE="immediate",r.RESOURCE_CONTROLLER="schedule",r.SLIDE="slide",r.STREAM_DATA_LOADER="stream loader",r.ELEVATION_QUERY="elevation query",r.TERRAIN_SURFACE="terrain",r.SURFACE_GEOMETRY_UPDATES="surface geometry updates",r.LOD_RENDERER="LoD renderer",r.GRAPHICS_CORE="Graphics3D",r.I3S_CONTROLLER="I3S",r.POINT_CLOUD_LAYER="point cloud",r.FEATURE_TILE_FETCHER="feature fetcher",r.OVERLAY="overlay",r.OVERLAY_RENDERER="overlay renderer",r.STAGE="stage",r.GRAPHICS_DECONFLICTOR="graphics deconflictor",r.FILTER_VISIBILITY="Graphics3D filter visibility",r.SCALE_VISIBILITY="Graphics3D scale visibility",r.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",r.POINT_OF_INTEREST_FREQUENT="POI frequent",r.POINT_OF_INTEREST_INFREQUENT="POI infrequent",r.LABELER="labeler",r.FEATURE_QUERY_ENGINE="feature query",r.FEATURE_TILE_TREE="feature tile tree",r.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",r.ELEVATION_ALIGNMENT="elevation alignment",r.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene",r.TEXT_TEXTURE_ATLAS="text texture atlas",r.TEXTURE_UNLOAD="texture unload",r.LINE_OF_SIGHT_TOOL="line of sight tool",r.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",r.ELEVATION_PROFILE="elevation profile",r.SNAPPING="snapping",r.SHADOW_ACCUMULATOR="shadow accumulator",r.CLOUDS_GENERATOR="clouds generator",r.MAPVIEW_FETCH_QUEUE="mapview fetch queue",r.MAPVIEW_LAYERVIEW_UPDATE="mapview layerview update",r.MAPVIEW_VECTOR_TILE_PARSING_QUEUE="mapview vector tile parsing queue",r[r.NONE=0]="NONE",r[r.TEST_PRIO=1]="TEST_PRIO";const b=new Map([[n.RESOURCE_CONTROLLER_IMMEDIATE,0],[n.RESOURCE_CONTROLLER,4],[n.SLIDE,0],[n.STREAM_DATA_LOADER,0],[n.ELEVATION_QUERY,0],[n.TERRAIN_SURFACE,1],[n.SURFACE_GEOMETRY_UPDATES,1],[n.LOD_RENDERER,2],[n.GRAPHICS_CORE,2],[n.I3S_CONTROLLER,2],[n.POINT_CLOUD_LAYER,2],[n.FEATURE_TILE_FETCHER,2],[n.CLOUDS_GENERATOR,2],[n.OVERLAY,4],[n.OVERLAY_RENDERER,4],[n.STAGE,4],[n.GRAPHICS_DECONFLICTOR,4],[n.FILTER_VISIBILITY,4],[n.SCALE_VISIBILITY,4],[n.FRUSTUM_VISIBILITY,4],[n.POINT_OF_INTEREST_FREQUENT,6],[n.POINT_OF_INTEREST_INFREQUENT,30],[n.LABELER,8],[n.FEATURE_QUERY_ENGINE,8],[n.FEATURE_TILE_TREE,16],[n.FEATURE_TILE_TREE_ACTIVE,0],[n.ELEVATION_ALIGNMENT,12],[n.ELEVATION_ALIGNMENT_SCENE,14],[n.TEXT_TEXTURE_ATLAS,12],[n.TEXTURE_UNLOAD,12],[n.LINE_OF_SIGHT_TOOL,16],[n.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[n.SNAPPING,0],[n.SHADOW_ACCUMULATOR,30],[n.MAPVIEW_FETCH_QUEUE,0],[n.MAPVIEW_LAYERVIEW_UPDATE,2],[n.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,0]]);function _(e){return b.has(e)?b.get(e):"number"==typeof e?e:1}const w=(0,p.HA)(6.5),C=(0,p.HA)(1),x=(0,p.HA)(30),E=(0,p.HA)(1e3/30),S=(0,p.HA)(100);var T,k;!function(e){e.Scheduler=class{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some((e=>e.needsUpdate))}constructor(){this._updating=(0,h.t)(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new l.Z("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new i,this._state=v.n.INTERACTING,this._tasks=new c.Z,this._runQueue=new c.Z,this._load=0,this._idleStateCallbacks=new c.Z,this._idleUpdatesStartFired=!1,this._forceTask=!1,this._debug=!1,this._debugHandle=(0,d.YP)((()=>f.Z.SCHEDULER_LOG_SLOW_TASKS),(e=>this._debug=e),d.nn);for(const e of Object.keys(n))this.performanceInfo.tasks.set(n[e],new l.Z(n[e]))}destroy(){this._tasks.toArray().forEach((e=>e.remove())),this._tasks.clear(),(0,a.hw)(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(e){this._updatingChanged(),e&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask((()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this._runFrame())})))}registerTask(e,i){const n=new t(this,e,i);return this._tasks.push(n),this._updatingChanged(),this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(e,new l.Z(e)),n}registerIdleStateCallbacks(e,t){const i={idleBegin:e,idleEnd:t};this._idleStateCallbacks.push(i),this.state===v.n.IDLE&&this._idleUpdatesStartFired&&i.idleBegin();const n=this;return{remove:()=>this._removeIdleStateCallbacks(i),set idleBegin(e){n._idleUpdatesStartFired&&(i.idleEnd(),n._state===v.n.IDLE&&e()),i.idleBegin=e},set idleEnd(e){i.idleEnd=e}}}get load(){return this._load}set state(e){this._state!==e&&(this._state=e,this.state!==v.n.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((e=>e.idleEnd()))))}get state(){return this._state}frame(e){this._startFrameTaskTimes();const t=this._updateBudget(e);if(t){const e=this._budget.now();this._runFrame(),this._recordFrameTaskTimes(this._budget.now()-e)}else this._recordFrameTaskTimes(0);return t}_updateBudget(e){this._test&&(this._test.usedBudget=0),++this._frameNumber;let t=w,i=e.frameDuration,n=C;switch(this.state){case v.n.IDLE:t=(0,p.HA)(0),i=(0,p.HA)(Math.max(S,e.frameDuration)),n=x;break;case v.n.INTERACTING:i=(0,p.HA)(Math.max(E,e.frameDuration));case v.n.ANIMATING:}return i=(0,p.HA)(i-e.elapsedFrameTime-t),this.state!==v.n.IDLE&&i<C&&!this._forceTask?(this._forceTask=!0,!1):(i=(0,p.HA)(Math.max(i,n)),this._budget.reset(i),this._updateLoad(),this._schedule())}_runFrame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case v.n.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((e=>e.idleBegin()))),this._runIdle();break;case v.n.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset((0,p.HA)(0)),this._budget.madeProgress()}_removeIdleStateCallbacks(e){this._idleUpdatesStartFired&&e.idleEnd(),this._idleStateCallbacks.removeUnordered(e)}removeTask(e){this._tasks.removeUnordered(e),this._runQueue.removeUnordered(e),this._updatingChanged()}_updateTask(e){this._tasks.forAll((t=>{t.name===e&&t.setPriority(e)}))}_getState(e){if(this._runQueue.some((t=>t.name===e)))return k.SCHEDULED;let t=k.IDLE;return this._tasks.forAll((i=>{i.name===e&&i.needsUpdate&&(i.schedulePriority<=1?t=k.READY:t!==k.READY&&(t=k.WAITING))})),t}_getRuntime(e){let t=0;return this._tasks.forAll((i=>{i.name===e&&(t+=i.runtime)})),t}_resetRuntimes(){this._tasks.forAll((e=>e.runtime=0))}_getRunning(){const e=new Map;if(this._tasks.forAll((t=>{t.needsUpdate&&e.set(t.name,(e.get(t.name)||0)+1)})),0===e.size)return null;let t="";return e.forEach(((e,i)=>{t+=e>1?` ${e}x ${i}`:` ${i}`})),t}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const e=this._tasks.reduce(((e,t)=>t.needsUpdate?++e:e),0);this._load=.9*this._load+e*(1-.9)}_schedule(){for(this._runQueue.filterInPlace((e=>!!e.needsUpdate||(e.schedulePriority=e.basePriority,!1))),this._tasks.forAll((e=>{0===e.basePriority&&e.needsUpdate&&!this._runQueue.includes(e)&&e.blockFrame!==this._frameNumber&&this._runQueue.unshift(e)}));0===this._runQueue.length;){let e=!1,t=0;if(this._tasks.forAll((i=>{i.needsUpdate&&0!==i.schedulePriority&&0!==i.basePriority&&i.blockFrame!==this._frameNumber&&(e=!0,t=Math.max(t,i.basePriority),1===i.schedulePriority?(i.schedulePriority=0,this._runQueue.push(i)):--i.schedulePriority)})),!e)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){do{for(;this._runQueue.length>0;){const e=this._budget.now(),t=this._runQueue.pop();this._budget.resetProgress();try{t.task.runTask(this._budget)===g.J&&(t.blockFrame=this._frameNumber)}catch(e){o.Z.getLogger("esri.views.support.Scheduler").error(`Exception in task "${t.name}"`,e),t.blockFrame=this._frameNumber}!this._budget.hasProgressed&&t.blockFrame!==this._frameNumber&&t.needsUpdate&&(t.name,n.I3S_CONTROLLER,t.blockFrame=this._frameNumber),t.schedulePriority=t.basePriority;const i=this._budget.now()-e;if(t.runtime+=i,this._frameTaskTimes.set(t.priority,this._frameTaskTimes.get(t.priority)+i),this._budget.remaining<=0)return void this._updatingChanged()}}while(this._schedule());this._updatingChanged()}_startFrameTaskTimes(){for(const e of Object.keys(n))this._frameTaskTimes.set(n[e],0)}_recordFrameTaskTimes(e){this._frameTaskTimes.forEach(((e,t)=>this.performanceInfo.tasks.get(t).push(e))),this.performanceInfo.total.push(e)}get test(){return this._test}};class t{get task(){return this._task.value}get updating(){return this._queue.running}constructor(e,t,i){this._scheduler=e,this.name=t,this.blockFrame=0,this.runtime=0,this._queue=new m.b,this._handles=new s.Z,this._basePriority=_(t),this.schedulePriority=this._basePriority,this._task=(0,h.t)(null!=i?i:this._queue),this._handles.add((0,d.gx)((()=>this.task.running),(t=>e.taskRunningChanged(t))))}remove(){this.processQueue(I),this._scheduler.removeTask(this),this.schedule=O.schedule,this.reschedule=O.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(e){if(this.name===e)return;this.name=e;const t=_(e);0!==this._basePriority&&0===this.schedulePriority||(this.schedulePriority=t),this._basePriority=t}get priority(){return this.name}set priority(e){this.setPriority(e)}get needsUpdate(){return this.updating||this.task.running}schedule(e,t,i){return this._queue.push(e,t,i)}reschedule(e,t,i){return this._queue.unshift(e,t,i)}processQueue(e){return this._queue.runTask(e)}}class i{constructor(){this._begin=performance?.now()??0,this._budget=0,this._done=!1,this._progressed=!1,this._enabled=!0}run(e){return!this.done&&(!0===e()&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get enabled(){return this._enabled}set enabled(e){this._enabled=e}reset(e){this._begin=this.now(),this._budget=e,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}}e.Budget=i}(T||(T={})),function(e){e.SCHEDULED="s",e.READY="r",e.WAITING="w",e.IDLE="i"}(k||(k={}));const I=new T.Budget;function P(e){const t=new T.Budget;return t.reset(e),t}I.enabled=!1;const O=new class{remove(){}processQueue(){}schedule(e,t,i){try{if((0,u.Hc)(t)){const e=(0,u.zE)();return i?Promise.resolve(i(e)):Promise.reject(e)}return(0,u.gx)(e(I))}catch(e){return Promise.reject(e)}}reschedule(e,t,i){return this.schedule(e,t,i)}}},78891:function(e,t,i){i.d(t,{J:function(){return n}});const n=Symbol("Yield")},97332:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(73440),r=i(70880),s=i(17155),o=(i(61432),i(96711),i(83850),i(48023));let a=class extends r.Z{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};(0,n._)([(0,s.Cb)()],a.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),(0,n._)([(0,s.Cb)()],a.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),a=(0,n._)([(0,o.j)("esri.views.support.debugFlags")],a);const l=new a},79922:function(e,t,i){i.d(t,{H:function(){return a},b:function(){return l}});var n=i(88194),r=i(93568),s=i(18764),o=i(22679);async function a(e,t,i){const n=await c(e,t,i);await u(n,t,i)}async function l(e,t,i,n,r){const s=await c(i,n,r);await e.update({data:t}),await u(s,n,r)}async function c(e,t,a){if(!t?.resources)return;const l=t.portalItem===e.portalItem?new Set(e.paths):new Set;e.paths.length=0,e.portalItem=t.portalItem;const c=new Set(t.resources.toKeep.map((e=>e.resource.path))),u=new Set,d=[];c.forEach((t=>{l.delete(t),e.paths.push(t)}));const h=[],p=[],m=[];for(const i of t.resources.toUpdate)if(l.delete(i.resource.path),c.has(i.resource.path)||u.has(i.resource.path)){const{resource:t,content:n,finish:r}=i,a=(0,o.W7)(t,(0,s.DO)());e.paths.push(a.path),h.push({resource:a,content:await(0,o.FO)(n),compress:i.compress}),r&&m.push((()=>r(a)))}else{e.paths.push(i.resource.path),p.push({resource:i.resource,content:await(0,o.FO)(i.content),compress:i.compress});const t=i.finish;t&&m.push((()=>t(i.resource))),u.add(i.resource.path)}for(const i of t.resources.toAdd)if(e.paths.push(i.resource.path),l.has(i.resource.path))l.delete(i.resource.path);else{h.push({resource:i.resource,content:await(0,o.FO)(i.content),compress:i.compress});const e=i.finish;e&&m.push((()=>e(i.resource)))}if(h.length||p.length){const{addOrUpdateResources:e}=await Promise.resolve().then(i.bind(i,22679));await e(t.portalItem,h,"add",a),await e(t.portalItem,p,"update",a)}if(m.forEach((e=>e())),0===d.length)return l;const f=await(0,r.UO)(d);if((0,r.k_)(a),f.length>0)throw new n.Z("save:resources","Failed to save one or more resources",{errors:f});return l}async function u(e,t,i){if(!e||!t.portalItem)return;const n=[];for(const r of e){const e=t.portalItem.resourceFromPath(r);n.push(e.portalItem.removeResource(e,i))}await(0,r.as)(n)}},68875:function(e,t,i){i.d(t,{Pl:function(){return r},zC:function(){return o}});var n=i(88194);i(75428);async function r(e){const t=[];for(const i of e.allLayers)if("beforeSave"in i&&"function"==typeof i.beforeSave){const e=i.beforeSave();e&&t.push(e)}await Promise.allSettled(t)}const s=new Set(["layer:unsupported","property:unsupported","symbol:unsupported","symbol-layer:unsupported","url:unsupported"]);function o(e,t,i){let r=(e.messages??[]).filter((({type:e})=>"error"===e)).map((({name:e,message:t,details:i})=>new n.Z(e,t,i)));if(e.blockedRelativeUrls&&(r=r.concat(e.blockedRelativeUrls.map((e=>new n.Z("url:unsupported",`Relative url '${e}' is not supported`))))),i){const{ignoreUnsupported:e,supplementalUnsupportedErrors:t=[],requiredPropertyChecksDisabled:n}=i;e&&(r=r.filter((({name:e})=>!(s.has(e)||t.includes(e))))),n&&(r=r.filter((e=>"web-document-write:property-required"!==e.name)))}if(r.length>0)throw new n.Z(t.errorName,"Failed to save due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:r})}},17733:function(e,t,i){i.d(t,{Z:function(){return d}});var n,r=i(73440),s=i(63255),o=i(17155),a=(i(61432),i(96711),i(83850),i(1194)),l=i(48023),c=i(29884);let u=class extends s.Z{static{n=this}constructor(e){super(e),this.type="sun",this.date=null,this.directShadowsEnabled=!1,this.displayUTCOffset=null}readDate(e,t){return null!=t.datetime&&new Date(t.datetime)||null}writeDate(e,t,i){t[i]=e.getTime()}readDirectShadowsEnabled(e,t){return!!t.directShadows}writedirectShadowsEnabled(e,t,i){e&&(t[i]=e)}writeDisplayUTCOffset(e,t){null!=e&&(t.displayUTCOffset=e)}clone(){return new n(this.cloneConstructProperties())}cloneConstructProperties(){const e={directShadowsEnabled:this.directShadowsEnabled,displayUTCOffset:null!=this.displayUTCOffset?this.displayUTCOffset:null};return null!=this.date&&(e.date=new Date(this.date.getTime())),e}};(0,r._)([(0,o.Cb)({readOnly:!0,type:["sun"],json:{write:!0}})],u.prototype,"type",void 0),(0,r._)([(0,o.Cb)({type:Date,json:{type:Number,write:{target:"datetime"}}})],u.prototype,"date",void 0),(0,r._)([(0,a.r)("date",["datetime"])],u.prototype,"readDate",null),(0,r._)([(0,c.c)("date")],u.prototype,"writeDate",null),(0,r._)([(0,o.Cb)({type:Boolean,json:{default:!1,write:{target:"directShadows"}}})],u.prototype,"directShadowsEnabled",void 0),(0,r._)([(0,a.r)("directShadowsEnabled",["directShadows"])],u.prototype,"readDirectShadowsEnabled",null),(0,r._)([(0,c.c)("directShadowsEnabled")],u.prototype,"writedirectShadowsEnabled",null),(0,r._)([(0,o.Cb)({type:Number,json:{write:!0}})],u.prototype,"displayUTCOffset",void 0),(0,r._)([(0,c.c)("displayUTCOffset")],u.prototype,"writeDisplayUTCOffset",null),u=n=(0,r._)([(0,l.j)("esri.webscene.SunLighting")],u);const d=u},83946:function(e,t,i){i.d(t,{Z:function(){return c}});var n,r=i(73440),s=i(63255),o=i(17155),a=(i(61432),i(96711),i(83850),i(48023));let l=class extends s.Z{static{n=this}constructor(e){super(e),this.type="virtual",this.directShadowsEnabled=!1}clone(){return new n(this.cloneConstructProperties())}cloneConstructProperties(){return{directShadowsEnabled:this.directShadowsEnabled}}};(0,r._)([(0,o.Cb)({readOnly:!0,type:["virtual"],json:{write:{isRequired:!0}}})],l.prototype,"type",void 0),(0,r._)([(0,o.Cb)({type:Boolean,json:{default:!1,name:"directShadows",write:!0}})],l.prototype,"directShadowsEnabled",void 0),l=n=(0,r._)([(0,a.j)("esri.webscene.VirtualLighting")],l);const c=l},41266:function(e,t,i){i.d(t,{_v:function(){return s},eq:function(){return o},k2:function(){return r}});const n="ProfileGenerationError";var r;!function(e){e.TooComplex="too-complex",e.InvalidGeometry="invalid-geometry",e.InvalidElevationInfo="invalid-elevation-info",e.ElevationQueryError="elevation-query-error"}(r||(r={}));class s extends Error{constructor(e){super("profile could not be generated",{cause:e}),this.type=n}}function o(e){return e.type===n}},63216:function(e,t,i){i.d(t,{J8:function(){return r},TH:function(){return h},dd:function(){return n},h8:function(){return d},iE:function(){return u}});var n,r,s,o=i(26636),a=i(27583),l=i(19596);(s=n||(n={})).Disabled="disabled",s.Ready="ready",s.Creating="creating",s.Created="created",s.Selecting="selecting",s.Selected="selected",function(e){e.NoValidInput="no-valid-input",e.NoVisibleProfiles="no-visible-profiles",e.InvalidGeometry="invalid-geometry",e.TooComplex="too-complex",e.InvalidElevationInfo="invalid-elevation-info",e.UnknownError="unknown-error",e.RefinedButNoChartData="refined-but-no-chart-data",e.None="none"}(r||(r={}));let c={noDataValue:-5e5,defaultQueryOptions:()=>({noDataValue:c.noDataValue,demResolution:"auto",maximumAutoTileRequests:150,ignoreInvisibleLayers:!0}),updateThrottleMillis:100,delayAfterPreviewMillis:500,defaultDemResolution:(0,o.En)(10,"centimeters","meters"),densificationMaxSamples:3e3,largeChartSamples:1e4,maxTotalSamples:1e5,maxChartRatio:300,minSlopeSampleDistance:10,formatPrecision:1,profileLinesStyle3D:{width:3,falloff:0,innerWidth:0,innerColor:(0,a.al)(0,0,0,0),renderOccluded:l.yD.Opaque},profileLinesUpdateThrottleMillis:100,hoveredPointsStyle:{size:14,borderStyle:"solid",borderWidth:3,borderColor:"#ffffff",boxShadow:"0px 0px 0px 5px rgba(255,255,255,0.2)"}};function u(){return c}const d=" â ",h={progress:1,hasZ:!1,samples:[],statistics:null,spatialReference:null}},11583:function(e,t,i){i.d(t,{G9:function(){return b},OH:function(){return m},WC:function(){return I},l9:function(){return _}});var n=i(99574),r=i(93568),s=i(26636),o=i(26821),a=i(24910),l=i(62197),c=i(13132),u=i(45213),d=i(95872),h=i(51870),p=i(41266);async function m(e,t,n,o,a,l,h){let m,g,y;const b=e.spatialReference,_=b.isGeographic||b.isWebMercator;let I=0;if(!_){const{execute:t}=await Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(63923)]).then(i.bind(i,59751));(0,r.k_)(h),I=t(e,{unit:"meters"}),(0,r.k_)(h)}const O=1/(0,s.c9)(o);if(_){await(0,c.initializeProjection)([{source:b,dest:o},{source:b,dest:u.Z.WGS84}],h);const i=function(e){return(0,d.Gb)(e.spatialReference)?e:(0,c.project)(e,u.Z.WGS84)}(e);m=(0,d.Jf)([i],"meters")[0];const r=f(m,a);if(P(e,m,r)>l)throw new p._v(p.k2.TooComplex);const s=v(i,t,n);({densifiedPath:g,distances:y}=function(e,t,i){const{hasZ:n}=e;return w(e,t,i,C,n?S:E)}(s,r,O)),g=(0,c.project)(g,o)}else{await(0,c.initializeProjection)([{source:b,dest:o}],h),m=I;const i=f(m,a);if(P(e,m,i)>l)throw new p._v(p.k2.TooComplex);const s=v(e,t,n);({densifiedPath:g,distances:y}=function(e,t,i){const{hasZ:n}=e;return w(e,t,i,x,n?k:T)}(s,i,O)),(0,r.k_)(h),g=(0,c.project)(g,o)}return{densifiedPath:g,pathLength:m*O,distances:y}}function f(e,t){const i=e/t.densificationMaxSamples;return Math.max(t.samplingDistance,i)}function v(e,t,i){if(null==t)return g(e);const n=e.spatialReference,r=t.mode,s=(0,h.ap)(t,n);let o=null;switch(i.type){case"2d":o=function({hasZ:e},t,i){return"absolute-height"===t?e?([e,t,n])=>[e,t,n+i]:([e,t])=>[e,t,i]:null}(e,r,s);break;case"3d":o=function({spatialReference:e,hasZ:t},i,n,{elevationProvider:r}){const s=(t,i,n,s)=>r?.getElevation(t,i,n,e,s)??0;switch(i){case"on-the-ground":return([e,t])=>[e,t,s(e,t,0,"ground")];case"absolute-height":return t?([e,t,i])=>[e,t,i+n]:([e,t])=>[e,t,n];case"relative-to-ground":return t?([e,t,i])=>[e,t,i+s(e,t,i,"ground")+n]:([e,t])=>[e,t,s(e,t,0,"ground")+n];case"relative-to-scene":return t?([e,t,i])=>[e,t,i+s(e,t,i,"scene")+n]:([e,t])=>[e,t,s(e,t,0,"scene")+n];default:return null}}(e,r,s,i)}return null==o?g(e):new l.Z({hasZ:!0,hasM:!1,spatialReference:n,paths:y(e.paths,o)})}function g(e){return e.hasZ?new l.Z({hasZ:!1,hasM:!1,spatialReference:e.spatialReference,paths:y(e.paths,(([e,t])=>[e,t]))}):e}function y(e,t){const i=e.length,n=new Array(i);for(let r=0;r<i;++r){const i=e[r],s=i.length,o=new Array(i.length);n[r]=o;for(let e=0;e<s;++e)o[e]=t(i[e])}return n}function b(e){return _(e)&&e.paths.length>0&&e.paths.every((e=>e.length>=2))}function _(e){return null!=e&&"polyline"===e.type}function w(e,t,i,r,o){const{spatialReference:a,hasZ:c}=e,u={from:null,to:null,distance:0,azimuth:0,reverseAzimuth:0,spatialReference:a,metersPerSR:(0,s.c9)(a)},d=[],h=[];let p=0;for(let s=0;s<e.paths.length;++s){const a=e.paths[s],l=new Array,c=new Array;let m=0;for(let e=1;e<a.length;++e){const s=a[e-1],d=a[e],h=r(u,s,d);let f;for(f=m;f<h.distance&&!(0,n.Po)(f,h.distance);f+=t)l.push(o(h,f)),c.push((p+f)*i);m=f-h.distance,p+=h.distance,l.push(d),c.push(p*i)}d[s]=l,h[s]=c}return{densifiedPath:new l.Z({spatialReference:a,hasZ:c,paths:d}),distances:h}}function C(e,t,i){return e.distance=0,(0,d.cA)(e,t,i,e.spatialReference),e.from=t,e.to=i,e}function x(e,t,i){return e.from=t,e.to=i,e.distance=(0,o.TE)(i,t)*e.metersPerSR,e}function E({from:e,azimuth:t,spatialReference:i},n){return(0,d.TB)([0,0],e,t,n,i)}function S({from:e,to:t,azimuth:i,distance:r,spatialReference:s},o){const a=o/r,l=[0,0,(0,n.t7)(e[2],t[2],a)];return(0,d.TB)(l,e,i,o,s),l}function T({from:e,to:t,distance:i},n){return(0,o.t7)([0,0],e,t,n/i)}function k({from:e,to:t,distance:i},n){return(0,a.m)([0,0,0],e,t,n/i)}function I(e){return e.paths.reduce(((e,t)=>e+t.length),0)}function P(e,t,i){return I(e)+Math.floor(t/i)+Math.max(0,e.paths.reduce((e=>1+e),0)-1)}},8221:function(e,t,i){function n(e,{profiles:t}){const i=e.title;if(null!=i)return i;switch(e.type){case"ground":return t.ground;case"input":return t.input;case"query":return t.query;case"view":return t.view;default:return""}}i.d(t,{f:function(){return n}})},16363:function(e,t,i){i.d(t,{hG:function(){return T},Qr:function(){return _},m7:function(){return g}});var n=i(3480),r=i(99574),s=i(93568),o=i(82868),a=i(28931),l=i(8554),c=i(75015),u=i(50399),d=i(63216),h=i(11583),p=i(41266),m=i(36091);function f(e,t,i=[]){if(e>=t)return i;if(i.push(e),t-e<2)return i;const n=t-1;i.push(n);const r=v(e+1,n);for(;;){const e=r.next();if(e.done)break;i.push(e.value)}return i}function*v(e,t){if(e>=t)return;const i=e+Math.floor((t-e)/2);yield i;const n=v(e,i),r=v(i+1,t);for(;;){const e=n.next(),t=r.next();if(e.done&&t.done)break;e.done||(yield e.value),t.done||(yield t.value)}}async function*g(e,t){const{view:i,geometry:n,elevationInfo:r,providers:o,options:a}=e,l=i.spatialReference;if(!l||null==n||!(0,h.G9)(n))throw new p._v(p.k2.InvalidGeometry);const c=o.length;if(0===c)return null;const u=Math.round(a.maxTotalSamples/c);if((0,h.WC)(n)>u)throw new p._v(p.k2.TooComplex);const m=await(0,h.OH)(n,r,i,l,a,u,t);let f=0;const v=new Array(c),g=new Array(c);for(let i=0;i<c;i++){const n=C(m);v[i]=n,f+=n.samples.length;const r={...e,provider:o[i],result:n,densificationResult:m};g[i]=y(r,t)[Symbol.iterator]()}if(f>a.maxTotalSamples)throw new p._v(p.k2.TooComplex);const b=await Promise.all(g.map((e=>{const t=e.next();return!0===t.done?Promise.resolve(null):t.value})));(0,s.k_)(t);for(let e=0;e<c;e++)v[e]=b[e];yield v,await(0,s.e4)(e.delayAfterPreview??(0,d.iE)().delayAfterPreviewMillis,null,t.signal);const _=[];try{let e;do{e=!1;for(let t=0;t<c;t++){const i=g[t].next();!1===i.done&&(_.push({resultPromise:i.value,index:t}),e=!0)}}while(e)}finally{g.forEach((e=>e.return?.()))}for(const{resultPromise:e,index:i}of _)v[i]=await e,(0,s.k_)(t),yield v;for(const e of v)null!=e&&(e.progress=1);yield v}function*y(e,t){const{densificationResult:i}=e,r={...e,abortOptions:t,densificationResult:i},s=f(0,r.result.samples.length),o=s.slice(0,r.provider.numSamplesForPreview);yield b(r,o,!0);const a=(0,n.vr)(s,r.provider.numSamplesPerChunk);for(const e of a)yield b(r,e,!1)}async function b({densificationResult:e,result:t,provider:i,queue:n,abortOptions:r,cache:a},l,c){const{densifiedPath:u,pathLength:h}=e,p=t.spatialReference,{samples:m}=t,f=[];for(let e=0;e<l.length;e++){const t=m[l[e]];f[e]=t.coordinate}try{return await n.push({geometry:new o.Z({spatialReference:p,points:f,hasZ:u.hasZ}),provider:i,indices:l,preview:c,result:t,queryOptions:{...(0,d.iE)().defaultQueryOptions(),minDemResolution:c?Math.round(h/i.numSamplesForPreview):Math.round(h/m.length),cache:a}},r),{...t}}catch(e){return(0,s.D_)(e)?null:d.TH}}function _(e){return new c.c({priority:u.T8.ELEVATION_PROFILE,concurrency:1,scheduler:e,process:async e=>{(0,s.k_)(e.queryOptions);try{await async function({geometry:e,provider:t,indices:i,preview:n,result:r,queryOptions:s}){if(0===i.length)return;const o=(await async function(e,t,i){try{return await e.queryElevation(t,i)}catch(e){throw new p._v(p.k2.ElevationQueryError)}}(t,e,s)).geometry,{hasZ:a,points:l}=o,c=s.noDataValue,{samples:u}=r;for(let e=0;e<i.length;e++){const t=u[i[e]];if(t.isHole)continue;const n=a?l[e][2]:null;null===n||n===c?t.sampledZ=null:(r.hasZ=!0,t.sampledZ=n),t.sampled=!0}(function(e){const t=e.length-1;let i=0;for(let n=1;n<=t;n++)(e[n].sampled||n===t)&&(w(e,i,n),i=n)})(u),r.progress=n?0:r.progress+i.length/u.length,r.statistics=(0,m.aC)(r.samples,r.spatialReference)}(e)}catch(e){(0,s.H9)(e)}}})}function w(e,t,i){if(i-t==1)return;const n=e[t],s=n.sampledZ,o=e[i],a=o.sampledZ;if(null==s||null==a){for(let n=t+1;n<i;n++)e[n].sampledZ=null;return}const l=n.distance,c=o.distance-l;for(let n=t+1;n<i;n++){const t=e[n],i=(t.distance-l)/c;t.sampledZ=(0,r.t7)(s,a,i)}}function C({densifiedPath:e,distances:t}){const i=e.spatialReference,n=(0,l.C5)(i),r=e.paths,s=r.length,o=[];let c=null,u=0;for(let e=0;e<s;e++){const i=r[e],s=i.length,l=t[e];for(let e=0;e<s;e++){const t=i[e],r=l[e];n&&(t[0]=(0,a.gQ)(t[0],n.valid[0],n.valid[1])),c&&0===e&&x(o,c,t,u,r),o.push(E(t,r)),c=t,u=r}}return{progress:0,samples:o,hasZ:!1,statistics:null,spatialReference:i}}function x(e,t,i,n,r){e.push(S(t,n)),e.push(S(i,r))}function E(e,t){return{coordinate:e,distance:t,sampledZ:null,sampled:!1,isHole:!1}}function S(e,t){return{coordinate:e,distance:t,sampledZ:null,sampled:!0,isHole:!0}}function T(e,t,i){if(!e||0===e.length)return;const n=e.length-1,r=e[0];if(t<=i(r))return r;const s=e[n];if(t>=i(s))return s;let o=0,a=0,l=n;for(;o<l;){a=o+Math.floor((l-o)/2);const r=e[a],s=i(r);if(s===t)return r;if(t<s){if(a>0){const n=e[a-1],o=i(n);if(t>o)return t-o>=s-t?r:n}l=a}else{if(a<n){const n=e[a+1],o=i(n);if(t<o)return t-s>=o-t?n:r}o=a+1}}return e[a]}},36091:function(e,t,i){i.d(t,{Ds:function(){return a},aC:function(){return o},lg:function(){return l}});var n=i(3480),r=i(26636),s=i(63216);function o(e,t){const i=e.length;if(0===i)return null;const n=e[0],o=n.sampledZ;let a=o,l=o,d=0,p=0,m=null,f=null,v=null!=o?o:0,g=0,y=0,b=null!=o?1:0,_=0,w=0;const C=(0,r.c9)(t),x=(0,r._R)(t),E=(0,s.iE)().minSlopeSampleDistance/C,S=2*E,T=new h,k=new h,I=()=>{O(),T.copy(k),k.reset()},P=(e,t)=>{I(),e>0&&e-T.start<=S&&(e=T.start+E),k.restart(e,t)},O=()=>{if(T.isHole||k.isHole)return;const e=k.avgElevation-T.avgElevation,t=k.start-T.start,i=e*x,n=t*C,s=(0,r.En)(Math.atan2(i,n),"radians","degrees");s>0?(g+=s,m=u(m,s),_++):s<0&&(y-=s,f=u(f,-s),w++)};null!=n.sampledZ&&P(n.distance,n.sampledZ);for(let t=1;t<i;++t){const i=e[t-1],n=e[t],r=n.sampledZ;if(null==r){k.isHole||I();continue}b++,v+=r,a=c(a,r),l=u(l,r),k.isHole||n.distance-k.start>=E?P(n.distance,r):k.insert(r);const s=i.sampledZ;if(null!=s){const e=r-s;e>0?d+=e:e<0&&(p-=e)}}return I(),0===b?null:{maxDistance:e[i-1].distance,minElevation:a,maxElevation:l,avgElevation:0===b?null:v/b,elevationGain:d,elevationLoss:p,maxPositiveSlope:m,maxNegativeSlope:f,avgPositiveSlope:0===_?null:g/_,avgNegativeSlope:0===w?null:y/w}}function a(e){const t=e.filter(n.pC),i=t.length;if(0===i)return null;const r=t[0];if(1===i)return r;let s=r.maxDistance,o=r.minElevation,a=r.maxElevation,l=r.maxPositiveSlope,d=r.maxNegativeSlope;for(let e=1;e<t.length;++e){const i=t[e];s=u(s,i.maxDistance),o=c(o,i.minElevation),a=u(a,i.maxElevation),l=u(l,i.maxPositiveSlope),d=u(d,i.maxNegativeSlope)}return{maxDistance:s,minElevation:o,maxElevation:a,avgElevation:null,elevationGain:null,elevationLoss:null,maxPositiveSlope:l,maxNegativeSlope:d,avgPositiveSlope:null,avgNegativeSlope:null}}function l(e){let t=null,i=null,n=null;for(const s of e){if(null==s)continue;const{statistics:e,spatialReference:o}=s;if(null==e)continue;const a=(0,r.c9)(o);t=u(t,d(e.maxDistance,a));const l=(0,r._R)(o);n=c(n,d(e.minElevation,l)),i=u(i,d(e.maxElevation,l))}return{minDistance:0,maxDistance:t??0,minElevation:n??0,maxElevation:i??0}}function c(e,t){return null==t?e:null!=e?Math.min(e,t):t}function u(e,t){return null==t?e:null!=e?Math.max(e,t):t}function d(e,t){return null!=e&&null!=t?e*t:null}class h{constructor(){this._start=0,this._totalElevation=0,this._sampleCount=0}get avgElevation(){return this._totalElevation/this._sampleCount}get isHole(){return 0===this._sampleCount}get start(){return this._start}copy(e){this._start=e._start,this._sampleCount=e._sampleCount,this._totalElevation=e._totalElevation}reset(){this._start=0,this._sampleCount=0,this._totalElevation=0}restart(e,t){this._start=e,this._sampleCount=1,this._totalElevation=t}insert(e){++this._sampleCount,this._totalElevation+=e}}},1803:function(e,t,i){i.d(t,{Z:function(){return z}});var n=i(73440),r=(i(55214),i(87286)),s=i(87833),o=i(10729),a=(i(61432),i(28947)),l=i(96711),c=i(61100),u=i(76329),d=i(93568),h=i(90403),p=i(18764),m=i(17155),f=i(90775),v=i(48023),g=i(53227),y=i(20785),b=i(81663);i(59143);const _={handleInterceptedEvent:(e,t,i,n)=>(e.scheduleRender(),t.properties[`on${n.type}`].apply(t.properties.bind||i,[n]))},w={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(e,t,i)=>{"-"===t.charAt(0)?e.style.setProperty(t,i):e.style[t]=i}},C=(e,t,i=!1)=>{let n=e;return t.forEach(((e,r)=>{const s=n?.children?((e,t)=>e.find(t))(n.children,(t=>t.domNode===e)):void 0;i&&!s&&r!==t.length-1||(n=s)})),n};var x=i(84644),E=i(42739),S=i(18534),T=i(50702);const k=new Set;function I(e){k.add(e),e.finally((()=>k.delete(e)))}new Map;var P,O=i(63034),L=i(68808),M=i(12816),R=i(74765);let A=0;function D(e,t){const i=Object.prototype.hasOwnProperty;for(const n in t)i.call(t,n)&&i.call(e,n)&&(null!=e[n]&&null!=t[n]&&"object"==typeof e[n]&&"object"==typeof t[n]?D(e[n],t[n]):e[n]=t[n]);return e}const F=(e=>{let t;const i={..._,...e},n=(e=>({...w,...e}))(i),r=n.performanceLogger;let s,o=!0,a=!1;const l=[],c=[],u=(e,s,o)=>{let a;n.eventHandlerInterceptor=(e,n,s,o)=>function(e){let n;r("domEvent",e);const s=((e,t)=>{const i=[];for(;e&&e!==t;)i.push(e),e=e.parentNode;return i})(e.currentTarget,a.domNode),o=s.some((e=>customElements.get(e?.tagName?.toLowerCase())));if(e.eventPhase!==Event.CAPTURING_PHASE&&o){const t=e.composedPath(),i=t.slice(t.indexOf(e.currentTarget),t.indexOf(a.domNode)).reverse();n=C(a.getLastRender(),i,!0)}else s.reverse(),n=C(a.getLastRender(),s);let l;return n&&(l=i.handleInterceptedEvent(t,n,this,e)),r("domEventProcessed",e),l},i.postProcessProjectionOptions?.(n);const u=o();a=e(s,u,n),n.eventHandlerInterceptor=void 0,l.push(a),c.push(o),i.afterFirstVNodeRendered&&i.afterFirstVNodeRendered(a,u)};let d=()=>{if(s=void 0,o){o=!1,r("renderStart",void 0);for(let e=0;e<l.length;e++){const t=c[e]();r("rendered",void 0);try{l[e].update(t)}catch(e){console.error(e)}r("patched",void 0)}r("renderDone",void 0),o=!0}};return i.modifyDoRenderImplementation&&(d=i.modifyDoRenderImplementation(d,l,c)),t={renderNow:d,scheduleRender:()=>{s||a||(s=requestAnimationFrame(d))},stop:()=>{s&&(cancelAnimationFrame(s),s=void 0),a=!0},resume:()=>{a=!1,o=!0,t.scheduleRender()},append:(e,t)=>{u(b.v.append,e,t)},insertBefore:(e,t)=>{u(b.v.insertBefore,e,t)},merge:(e,t)=>{u(b.v.merge,e,t)},replace:(e,t)=>{u(b.v.replace,e,t)},detach:e=>{for(let t=0;t<c.length;t++)if(c[t]===e)return c.splice(t,1),l.splice(t,1)[0];throw new Error("renderFunction was not found")}},t})({postProcessProjectionOptions(e){const t=e.eventHandlerInterceptor,i=/capture$/i;e.eventHandlerInterceptor=(e,n,r,s)=>{const o=t?.(e,n,r,s),a=i.test(e);if(!((e=e.replace(i,"")).toLowerCase()in r)||a){const t=e[2].toLowerCase()+e.slice(3),i=e=>o?.call(r,e);r.addEventListener(t,i,a);const n=()=>r.removeEventListener(t,i,a),l=s.afterRemoved;s.afterRemoved=e=>{l?.(e),n()}}return o}},handleInterceptedEvent(e,t,i,n){const{eventPhase:r,type:s}=n,o=r===Event.CAPTURING_PHASE;let a=`on${s}${o?"capture":""}`;const l=t.properties;(l&&a in l||(a=`on${s[0].toUpperCase()}${s.slice(1)}${o?"Capture":""}`,l&&a in l))&&((0,O.Uy)(),e.scheduleRender(),l[a].call(l.bind||i,n))}});let N=!1,V=class extends(u.Z.EsriPromiseMixin(s.Z.EventedAccessor)){static{this[P]=!0}constructor(e,t){super(e,t),this._attached=!1,this._projector=F,this._readyForTrueRender=!1,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=(0,d.Ds)((async()=>{if(this._messageBundleProps?.length){const e=await Promise.allSettled(this._messageBundleProps.map((async({bundlePath:e,propertyName:t})=>{if(this.destroyed)return;let i=await(0,M.ME)(e);this.uiStrings&&Object.keys(this.uiStrings)&&(i=D((0,a.d9)(i),this.uiStrings)),this[t]=i})));if(this.destroyed)return;for(const t of e)"rejected"===t.status&&l.Z.getLogger(this).error("widget-intl:locale-error",this.declaredClass,t.reason)}await this.loadLocale()})),this.addHandles((0,T.kB)()),(0,x.B)();const i="esri-widget-uid-"+(0,p.DO)(),n=this.render.bind(this);this._trackingTarget=new y.M((()=>{this.autoRenderingEnabled&&this.scheduleRender()}));const r=()=>({vnodeSelector:"div",properties:{key:`${i}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}),s=()=>{if(!this._readyForTrueRender||this.destroyed)return null;const e=n()??r(),t=e.properties??={};if(t.key??=i,(0,E.Z)(e.vnodeSelector)){if(!this.visible)return r()}else this.visible?t.styles||(t.styles={}):(t.class="",t.styles={display:"none"}),t.styles.display??="";let s=0;return e.children?.forEach((e=>{(0,E.Z)(e.vnodeSelector)||(e.properties??={},e.properties.key??=`${this.id}--${s++}`)})),(0,E.d)(this,e)};this.render=()=>{if(N)return s();let e=(0,O.O9)(this)??null;if(e)return e;this._trackingTarget.clear(),N=!0;try{e=(0,g.LJ)(this._trackingTarget,s)}catch(e){throw l.Z.getLogger(this).error(e),e}finally{N=!1}return e&&(0,O.KF)(this,e),e};const o=this.beforeFirstRender();o?this._resourcesFetch=o.then((()=>{this._readyForTrueRender=!0,this._postInitialize()})):(this._resourcesFetch=Promise.resolve().then((()=>{this._postInitialize()})),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),I(this._resourcesFetch)}normalizeCtorArgs(e,t){const i={...e};return t&&(i.container=t),i}postInitialize(){}beforeFirstRender(){const e=this.loadDependencies();return this._messageBundleProps?.length||e?Promise.all([e,this._loadLocale()]).then((()=>{})).catch(d.H9):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||((0,c.SC)(this._trackingTarget),(0,c.SC)(this.viewModel),this._detach(this.container),this._set("container",null),this._emitter.clear(),this.render=()=>null,this._projector=null,(0,O.w7)(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return(0,r.L)(e)}get domNode(){return this.container}set domNode(e){this.container=e}get icon(){return null}set icon(e){this._overrideIfSome("icon",e)}get id(){return this._get("id")||this.container?.id||Date.now().toString(16)+"-widget-"+A++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get[(P=S.R,S.T)](){return{projector:this._projector}}static{this.vnodeSelector="div"}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||((0,O.w7)(this),this._projector.scheduleRender())}classes(...e){return L.Sh.apply(this,e)}renderNow(){(0,O.w7)(this),this._projector.renderNow()}_postInitialize(){if(this.destroyed)return;this.scheduleRender(),this._delegatedEventNames?.length&&this.addHandles((0,h.YP)((()=>this.viewModel),((e,t)=>{t&&this.removeHandles("delegated-events"),e&&(0,o.OP)(e)&&this.addHandles(this._delegatedEventNames.map((t=>(0,o.on)(e,t,(e=>{this.emit(t,e)})))),"delegated-events")}),h.tX)),this.postInitialize();const e=async()=>{await this._loadLocale().catch(d.H9),this.scheduleRender()};this.addHandles([(0,R.qe)(e),(0,h.YP)((()=>this.uiStrings),e)]),this.addHandles((0,h.gx)((()=>this.container),(e=>{this.destroyed||this._attach(e)}),{initial:!0,once:!0}))}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){this._attached&&(this._projector.detach(this.render),this._attached=!1),e?.parentNode?.removeChild(e)}};(0,n._)([(0,m.Cb)()],V.prototype,"_readyForTrueRender",void 0),(0,n._)([(0,m.Cb)({value:null})],V.prototype,"container",null),(0,n._)([(0,f.p)("container")],V.prototype,"castContainer",null),(0,n._)([(0,m.Cb)()],V.prototype,"icon",null),(0,n._)([(0,m.Cb)()],V.prototype,"id",null),(0,n._)([(0,m.Cb)()],V.prototype,"label",null),(0,n._)([(0,m.Cb)()],V.prototype,"renderable",null),(0,n._)([(0,m.Cb)()],V.prototype,"uiStrings",void 0),(0,n._)([(0,m.Cb)()],V.prototype,"viewModel",void 0),(0,n._)([(0,m.Cb)({value:!0})],V.prototype,"visible",null),(0,n._)([(0,m.Cb)()],V.prototype,"key",void 0),(0,n._)([(0,m.Cb)()],V.prototype,"children",void 0),(0,n._)([(0,m.Cb)()],V.prototype,"afterCreate",void 0),(0,n._)([(0,m.Cb)()],V.prototype,"afterUpdate",void 0),(0,n._)([(0,m.Cb)()],V.prototype,"afterRemoved",void 0),V=(0,n._)([(0,v.j)("esri.widgets.Widget")],V);const z=V},84644:function(e,t,i){i.d(t,{B:function(){return l},h:function(){return c}});var n=i(43625);let r=!1;var s=i(1800),o=(i(61432),i(95490));let a;function l(){var e;r||(e=(0,o.hF)((0,s.V)(a)),r=!0,(0,n.s)(e))}function c(e){const t=[];for(const i of Object.keys(e))customElements.get(`calcite-${i}`)||t.push(e[i]?.());return t.length>0?Promise.all(t):null}a="components/assets"},24225:function(e,t,i){function n(e){return(t,i)=>{t.hasOwnProperty("_messageBundleProps")||(t._messageBundleProps=t._messageBundleProps?t._messageBundleProps.slice():[]),t._messageBundleProps.push({bundlePath:e,propertyName:i})}}i.d(t,{H:function(){return n}})},46512:function(e,t,i){i.d(t,{z:function(){return n}});const n={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",primaryTickLabelKeepAll:"primary-tick__label--keep-all",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"}},23039:function(e,t,i){i.d(t,{D:function(){return l},u:function(){return a}});var n=i(42739),r=function(e){return{vnodeSelector:"",properties:void 0,children:void 0,text:e.toString(),domNode:null}},s=function(e,t){for(var i=0,n=e.length;i<n;i++){var o=e[i];Array.isArray(o)?s(o,t):null!=o&&!1!==o&&(o.hasOwnProperty("vnodeSelector")||(o=r(o)),t.push(o))}},o=function(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];if(1===i.length&&"string"==typeof i[0])return{vnodeSelector:e,properties:t||void 0,children:void 0,text:i[0],domNode:null};var r=[];return s(i,r),{vnodeSelector:e,properties:t||void 0,children:r,text:void 0,domNode:null}};function a(e,t,...i){return"function"!=typeof e||(0,n.Z)(e)?o(e,t??null,...i):e(t,...i)}function l(...e){return e}},42739:function(e,t,i){i.d(t,{Z:function(){return h},d:function(){return l}});var n=i(50702),r=i(18534);const s=[],o={},a=new WeakMap;function l(e,t){let i=t.children;if(i?.length)for(let t=0;t<i.length;++t)i[t]=l(e,i[t]);else i=s;const n=t.vnodeSelector;if(h(n)){const r=t.properties||o,s=r.key||n,a={key:s,afterCreate:c,afterUpdate:u,afterRemoved:d,parentWidget:e,widgetConstructor:n,widgetProperties:{...r,key:s,children:i}};return{vnodeSelector:n.vnodeSelector,properties:a,children:void 0,text:void 0,domNode:null}}return t}function c(e,t,i,{parentWidget:s,widgetConstructor:o,widgetProperties:l}){const c=new o(l);c.container=e,a.set(e,c),c.afterCreate?.(c,e),s.addHandles((0,n.kB)((()=>d(e)))),queueMicrotask((()=>{c[r.T].projector.renderNow()}))}function u(e,t,i,{widgetProperties:n}){const r=a.get(e);r&&(r.set(n),r.afterUpdate?.(r,e))}function d(e){const t=a.get(e);t&&(t.afterRemoved?.(t,e),t.destroy(),a.delete(e))}function h(e){return"function"==typeof e&&e[r.R]}},18534:function(e,t,i){i.d(t,{R:function(){return n},T:function(){return r}});const n=Symbol("widget"),r=Symbol("widget-test-data")},63034:function(e,t,i){i.d(t,{KF:function(){return o},O9:function(){return s},Uy:function(){return r},w7:function(){return a}});const n=new Map;function r(){n.clear()}function s(e){return n.get(e)}function o(e,t){n.set(e,t)}function a(e){n.delete(e)}},68808:function(e,t,i){i.d(t,{Sh:function(){return c},Yo:function(){return p},dZ:function(){return d},ib:function(){return u},kW:function(){return f},pV:function(){return h},pf:function(){return m}});var n=i(82703),r=i(50702),s=(i(61432),i(96711),i(93568)),o=i(90403),a=i(99153),l=i(63034);function c(...e){const t=n.Z.acquire();for(let i=0;i<e.length;i++){const n=e[i],r=typeof n;if("string"===r)t.push(n);else if(Array.isArray(n))t.push.apply(t,n);else if("object"===r)for(const e in n)n[e]&&t.push(e)}const i=t.join(" ");return n.Z.release(t),i}const u=(()=>{const e=new Map,t=new ResizeObserver((t=>{(0,l.Uy)();for(const i of t)e.get(i.target)?.(i)})),i=(i,n,s)=>(e.set(i,n),t.observe(i,s),(0,r.kB)((()=>{t.unobserve(i),e.delete(i)})));return(e,t,n)=>{let s=null;return(0,r.AL)([(0,o.YP)((()=>"function"==typeof e?e():e),(e=>{s?.remove(),e&&(s=i(e,t,n))}),o.tX),(0,r.kB)((()=>s?.remove()))])}})();function d(e){const t=e?.closest("[dir]");return null!==t&&t instanceof HTMLElement&&"rtl"===t.dir||"rtl"===document.dir}function h(e){this[e.getAttribute("data-node-ref")]=null}function p(e){this[e.getAttribute("data-node-ref")]=e}function m(e){return"Enter"===e||" "===e}async function f(e,t){await(0,a.JM)((0,s.$h)(t));const i="function"==typeof e?e():e;i&&("setFocus"in i&&"function"==typeof i.setFocus?await i.setFocus():i instanceof HTMLElement&&i.focus())}},60629:function(e,t,i){i.d(t,{A:function(){return C}});var n=i(6496),r=i(70880),s=i(49898),o=i(93568),a=i(90403),l=i(88194);function c(e){e?.abort()}function u(e){e?.remove()}var d=Object.defineProperty,h=Object.getOwnPropertyDescriptor,p=(e,t,i,n)=>{for(var r,s=n>1?void 0:n?h(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(s=(n?r(t,i,s):r(s))||s);return n&&s&&d(t,i,s),s};function m(e,t="Aborted"){if(v(e))throw function(e="Aborted"){return new l.Z("AbortError",e)}(t)}function f(e){return e instanceof AbortSignal?e:e?.signal??void 0}function v(e){return f(e)?.aborted??!1}function g(e,t){return new y(e,t)}let y=class extends r.Z{constructor(e,t){super({}),this._abortHandle=null,this.abort=()=>{this._abortController=c(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:i}=this._abortController;this.promise=e(i),this.promise.then((e=>{this._result=function(e){return{ok:!0,value:e}}(e),this._cleanup()}),(e=>{this._result=function(e){return{ok:!1,error:e}}(e),this._cleanup()})),this._abortHandle=function(e,t){const i=f(e);if(null==i)return;if(i.aborted)return void t();const n=()=>t();return i.addEventListener("abort",n,{once:!0}),{remove:()=>i.removeEventListener("abort",n)}}(t,this.abort)}get value(){return function(e){return e?.ok?e.value:null}(this._result)}get error(){return function(e){return null==e||e.ok?null:e.error}(this._result)}get finished(){return null!=this._result}destroy(){this.abort()}_cleanup(){this._abortHandle=u(this._abortHandle),this._abortController=null}[Symbol.dispose](){this._cleanup()}};p([(0,s.Cb)()],y.prototype,"value",1),p([(0,s.Cb)()],y.prototype,"error",1),p([(0,s.Cb)()],y.prototype,"finished",1),p([(0,s.Cb)()],y.prototype,"promise",2),p([(0,s.Cb)()],y.prototype,"_result",2),y=p([(0,s.jY)("esri.components.asyncUtils.ReactiveTask")],y);var b=Object.defineProperty,_=Object.getOwnPropertyDescriptor,w=(e,t,i,n)=>{for(var r,s=n>1?void 0:n?_(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(s=(n?r(t,i,s):r(s))||s);return n&&s&&b(t,i,s),s};let C=class extends r.Z{constructor(){super({}),this._ownsAnalysis=!1,this._operationState="inactive",this._loggedUnsupportedErrorMessage=!1,this._changeFromReconnect=!1,this._startUserOperation=null}initialize(){this._set("analysis",this.constructAnalysis()),this._ownsAnalysis=!0;const e=()=>{!this._changeFromReconnect&&!this._viewHasAnalysis&&(this._ownsAnalysis=!1);const e=!this._changeFromReconnect;this._changeFromReconnect=!1,e&&this._scheduleViewReconnect()};this.addHandles([(0,a.gx)((()=>null!=this.view&&this.view.ready&&!this.supported),(()=>{this._loggedUnsupportedErrorMessage||console.error(this.unsupportedErrorMessage)}),{sync:!0,initial:!0}),(0,a.YP)((()=>[this.analysis,this._viewHasAnalysis]),e,{sync:!0}),(0,a.on)((()=>this.view),"analysis-view-destroy",(t=>{t.analysis===this.analysis&&e()})),(0,a.YP)((()=>({view:this.view,ready:!!this.view?.ready,supported:this.supported})),(({view:e},t)=>{const i=t?.view;e!==i&&(this._startUserOperation=c(this._startUserOperation),this._disconnectFromView(i)),this._scheduleViewReconnect()}),{sync:!0,initial:!0})])}destroy(){this._reconnectViewTask=c(this._reconnectViewTask),this._startUserOperation=c(this._startUserOperation),null!=this._analysisView&&(this._analysisView.visible=void 0),this._disconnectFromView(this.view),this._set("view",null),this._ownsAnalysis&&this.analysis?.destroy()}get supported(){return null==this.view||this.view.type===this.supportedViewType}set visible(e){this._set("visible",e),null!=this._analysisView&&(this._analysisView.visible=e)}get active(){return 2===this._startUserOperation?.state}get disabled(){return null==this.view||!this.view.ready||!this.supported}set analysis(e){e!==this._get("analysis")&&(this._startUserOperation=c(this._startUserOperation),this._disconnectFromView(this.view),this._setExternalAnalysis(e),this._scheduleViewReconnect())}get analysisView(){return this._analysisView}get ready(){return null!=this._analysisView&&!this.connectingToView}get connectingToView(){return null!=this._reconnectViewTask}get _viewHasAnalysis(){const{view:e}=this;return!0===e?.analyses.includes(this.analysis)}get operationState(){return this._operationState}clear(){this.clearAnalysis(),this._startUserOperation=c(this._startUserOperation)}async start(e){if(!this.visible)return void console.warn("Cannot start analysis when not visible");const t={task:null,abort:null,state:0},i=g((async i=>{if(t.state=1,await(0,a.N1)((()=>this.ready),i),t.state=2,null==this._analysisView||null==this.view)return;this._operationState="active";const n=e?.({signal:i})??this.place({signal:i});await(0,o.R8)(n)}));return i.promise.finally((()=>{(this._startUserOperation===t||null==this._startUserOperation)&&(this._operationState="inactive")})),t.task=i,t.abort=()=>i.abort(),this._startUserOperation=t,await i.promise}async startNewAnalysis(){this.clear(),await this.start()}async continue(){await this.start()}stop(){this._startUserOperation=c(this._startUserOperation)}onConnectToAnalysisView(e){}onDisconnectFromAnalysisView(){}_scheduleViewReconnect(){this._reconnectViewTask=c(this._reconnectViewTask);const e=g((async t=>{try{await this._reconnectView(t)}catch(e){if(m(t),!function(e){return"AbortError"===e?.name}(e))return void console.warn("Failed to use analysis in view model",e);throw e}finally{e===this._reconnectViewTask&&(this._reconnectViewTask=void 0)}}));this._reconnectViewTask=e}async _reconnectView(e){const{view:t}=this,i=null!=t&&t.ready&&this.supported,r=this.analysis;if(this._startUserOperation=x(this._startUserOperation),this._disconnectFromView(t),!i||null==t||null==r)return;this._ownsAnalysis&&(this._changeFromReconnect=!0,t.analyses.add(r));const s=await t.whenAnalysisView(r);this._analysisView=s,v(e)?this._startUserOperation=x(this._startUserOperation):(s.visible=this.visible,this._forceInteractiveHandle=(0,n.En)(s),this.addHandles(this._forceInteractiveHandle),this.onConnectToAnalysisView(s))}_disconnectFromView(e){null!=e&&this._ownsAnalysis&&e.analyses.includes(this.analysis)&&(this._changeFromReconnect=!0,this.analysis.clear(),e.analyses.remove(this.analysis)),this.onDisconnectFromAnalysisView(),this._forceInteractiveHandle=u(this._forceInteractiveHandle),this._analysisView=void 0}_setExternalAnalysis(e){null!=this._analysisView&&!this._ownsAnalysis&&(this._analysisView.visible=void 0,this._forceInteractiveHandle=u(this._forceInteractiveHandle)),this._analysisView=void 0,this._ownsAnalysis=!1,this._set("analysis",e),this._changeFromReconnect=!1}};function x(e){return null!=e&&e.state>=2?(e.abort(),null):e}w([(0,s.Cb)()],C.prototype,"supported",1),w([(0,s.Cb)()],C.prototype,"view",2),w([(0,s.Cb)({type:Boolean,value:!0})],C.prototype,"visible",1),w([(0,s.Cb)()],C.prototype,"active",1),w([(0,s.Cb)()],C.prototype,"disabled",1),w([(0,s.Cb)()],C.prototype,"analysis",1),w([(0,s.Cb)()],C.prototype,"_analysisView",2),w([(0,s.Cb)()],C.prototype,"analysisView",1),w([(0,s.Cb)()],C.prototype,"ready",1),w([(0,s.Cb)()],C.prototype,"connectingToView",1),w([(0,s.Cb)()],C.prototype,"_ownsAnalysis",2),w([(0,s.Cb)()],C.prototype,"_viewHasAnalysis",1),w([(0,s.Cb)()],C.prototype,"_reconnectViewTask",2),w([(0,s.Cb)()],C.prototype,"_forceInteractiveHandle",2),w([(0,s.Cb)()],C.prototype,"_operationState",2),w([(0,s.Cb)()],C.prototype,"operationState",1),C=w([(0,s.jY)("esri.components.support.AnalysisViewModel")],C)},99978:function(e,t,i){i.d(t,{a:function(){return r},f:function(){return a},g:function(){return o},m:function(){return s}});const n=["metric","imperial"],r=[...n,"square-inches","square-feet","square-yards","square-miles","square-nautical-miles","square-us-feet","square-millimeters","square-centimeters","square-decimeters","square-meters","square-kilometers","acres","ares","hectares"],s=[...n,"inches","feet","yards","miles","nautical-miles","us-feet","millimeters","centimeters","decimeters","meters","kilometers"];function o(e,t=!0){return t?null==e?{state:"unavailable"}:{state:"available",value:e}:{state:"invalid"}}function a(e,t){switch(t.type){case"length":return e.formatLength(t);case"area":return e.formatArea(t);default:return""}}},12132:function(e,t,i){i(64062),i(17394),i(61637);var n=i(64297),r=i(15294),s=i(54503),o=i(20803),a=i(41203),l=i(97237),c=i(29359),u=i(49006),d=i(73440),h=i(65475),p=i(3480),m=i(96711),f=i(61100),v=i(26636),g=i(17155),y=(i(61432),i(48023)),b=i(67764);let _=class extends h.Z{constructor(e){super(e),this.type="area-measurement",this.unit=null}set geometry(e){null!=e?(e.rings.length>1&&m.Z.getLogger(this).warn("Measuring polygons with multiple rings is not supported."),this._set("geometry",e.clone())):this._set("geometry",null)}get valid(){const{geometry:e}=this;if(null!=e&&e.rings.length>0){const t=e.rings[0];if(t.length>3&&(0,p.fS)(t.at(0),t.at(-1)))return!0}return!1}clear(){this.geometry=null}equals(e){return this===e||super.equals(e)&&this.unit===e.unit&&(0,f._W)(this.geometry,e.geometry)}};(0,d._)([(0,g.Cb)({type:["area-measurement"]})],_.prototype,"type",void 0),(0,d._)([(0,g.Cb)({value:null,type:b.Z})],_.prototype,"geometry",null),(0,d._)([(0,g.Cb)({type:v.fN,value:null})],_.prototype,"unit",void 0),(0,d._)([(0,g.Cb)({readOnly:!0})],_.prototype,"valid",null),_=(0,d._)([(0,y.j)("esri.analysis.AreaMeasurementAnalysis")],_);const w=_;var C=i(26961),x=i(49898),E=i(90403),S=i(60629),T=i(99978),k=i(6496);const I=u.iv`@layer{arcgis-area-measurement-3d{display:block}.arcgis-area-measurement-3d{position:relative;padding:var(--esri-widget-padding);overflow-y:auto}}`;var P=Object.defineProperty,O=Object.getOwnPropertyDescriptor,L=(e,t,i,n)=>{for(var r,s=n>1?void 0:n?O(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(s=(n?r(t,i,s):r(s))||s);return n&&s&&P(t,i,s),s};let M=class extends S.A{constructor(){super(...arguments),this.supportedViewType="3d",this.unsupportedErrorMessage="The Area Measurement 3D component is only supported in 3D views."}initialize(){this.addHandles((0,E.YP)((()=>({analysis:this.analysis,unit:this.unit})),(({analysis:e,unit:t})=>{null!=e&&(e.unit=t)}),{sync:!0,initial:!0}))}get state(){return this.disabled||!this.ready?"disabled":"inactive"===this.operationState?this.analysis.valid?"measured":"ready":"measuring"}get displayState(){if(!this.supported)return"unsupported";switch(this.state){case"disabled":case"ready":return"ready";case"measuring":return null==this.analysis.geometry?"measuring":"measured";case"measured":return"measured"}}get measurement(){const{analysisView:e}=this,t=e?.result,i=t?.mode??"euclidean",n=null!=e&&(0,k.mR)(e);return{mode:i,area:(0,T.g)(t?.area,n),perimeter:(0,T.g)(t?.perimeter,n)}}get unitOptions(){const e=this._userUnitOptions?.filter((e=>T.a.includes(e)));return e&&e.length>0?e:T.a.slice()}set unitOptions(e){this._userUnitOptions=e}get unit(){const e=this._userUnit,t=this.unitOptions;if(e&&t.includes(e))return e;const i=this.defaultUnit;return i&&t.includes(i)?i:t[0]}set unit(e){this._userUnit=e}get defaultUnit(){return this.view?(0,C.R)(this.view):void 0}async place(e){await(this.analysisView?.place(e))}clearAnalysis(){this.analysis.geometry=null}constructAnalysis(){return new w}};L([(0,x.Cb)({readOnly:!0})],M.prototype,"state",1),L([(0,x.Cb)({readOnly:!0})],M.prototype,"displayState",1),L([(0,x.Cb)({readOnly:!0})],M.prototype,"measurement",1),L([(0,x.Cb)()],M.prototype,"unitOptions",1),L([(0,x.Cb)()],M.prototype,"_userUnitOptions",2),L([(0,x.Cb)()],M.prototype,"unit",1),L([(0,x.Cb)()],M.prototype,"_userUnit",2),L([(0,x.Cb)({readOnly:!0})],M.prototype,"defaultUnit",1),M=L([(0,x.jY)("components.area-measurement-3d.AreaMeasurement3dViewModel")],M);const R="arcgis-area-measurement-3d",A=(0,l.m)(M);class D extends s.oi{constructor(){super(...arguments),this.viewModel=A(this),this.messages=(0,a.u)({blocking:!0}),this.analysis=this.viewModel.analysis,this.autoDestroyDisabled=!1,this.icon="measure-area",this.position="bottom-left",this.state=this.viewModel.state,this.unit=this.viewModel.unit,this.unitOptions=this.viewModel.unitOptions,this.arcgisPropertyChange=(0,o.OR)()("analysis","state"),this.arcgisReady=(0,s.yM)()}static{this.properties={analysis:0,autoDestroyDisabled:5,icon:3,label:1,position:1,referenceElement:1,state:35,unit:1,unitOptions:0}}static{this.shadowRootOptions=s.hZ}static{this.styles=I}async clear(){this.viewModel.clear()}async destroy(){await this.manager.destroy()}async start(){this.viewModel.start()}render(){const{messages:e,unit:t,unitOptions:i,viewModel:n}=this,{measurement:o,state:a}=n;return r.dy`<div aria-label=${e.componentLabel??s.Ld} class=${(0,s.Vp)({[R]:!0,[c.g.widget]:!0,[c.g.panel]:!0})} role=presentation><arcgis-measurement-content .state=${n.displayState} .hintLabel=${e.hint} .unsupportedLabel=${e.unsupported} .items=${[{title:e.area,measurement:o.area},{title:e.perimeterLength,measurement:o.perimeter}]}><arcgis-unit-select slot=settings .options=${i} .selectLabel=${e.unit} .value=${t} @arcgisUnitSelectChange=${e=>{this.unit=e.detail}}></arcgis-unit-select><calcite-button slot=actions .disabled=${"disabled"===a} @click=${()=>{this.viewModel.clear(),this.viewModel.start()}}>${e.newMeasurement}</calcite-button></arcgis-measurement-content></div>`}}(0,n.c)("arcgis-area-measurement-3d",D)},6457:function(e,t,i){var n=i(64297),r=i(20803),s=i(73440),o=i(17155),a=i(90775),l=(i(61432),i(83850),i(48023)),c=i(1803),u=i(70880),d=i(43254),h=i(41145),p=i(96711),m=i(93568),f=i(90403),v=i(63909),g=i(7961);const y=e=>t=>{const i=e.toLowerCase();return t.sublayers.find((e=>e.modelName?.toLowerCase()===i))??null},b=y("fullmodel"),_=y("overview");function w(e){const t=b(e);null!=t&&(t.visible=!0);const i=_(e);null!=i&&(i.visible=!1)}function C(e,t){const i=function(e,t){const i=e.summaryStatistics?.fields??[],n=t.toLowerCase();return i.find((e=>e.modelName?.toLowerCase()===n))??null}(e,t);if(null==i)return null;const n=i.fieldName;if(null==n||!n)return null;const r=function(e,t){for(const i of e.allSublayers.items){const e="building-component"===i.type?i.getFieldDomain?.(t):null;if(e&&"coded-value"===e.type)return e}return null}(e,n),s=new Map;for(const e of i.mostFrequentValues??[])"number"==typeof e&&s.set(e,null!=r?r.getName(e):String(e));return{fieldName:n,fieldValueMap:s}}let x=class extends u.Z{constructor(e){super(e),this.id="root",this.parent=null,this.children=new d.Z,this.layers=new d.Z,this.level=0,this._childIds=new Set,this._layerUniqueIds=new Set}initialize(){this.addHandles([this.layers.on("before-add",(e=>{this._layerUniqueIds.has(e.item.uid)?e.preventDefault():this._layerUniqueIds.add(e.item.uid)})),this.layers.on("after-add",(({item:e})=>{this.addHandles([(0,f.YP)((()=>e.visible),(()=>this.notifyChange("visible")),f.nn),(0,f.YP)((()=>e.title),(()=>this.notifyChange("title")),f.nn)],e.uid)})),this.layers.on("before-remove",(({item:e})=>{this.removeHandles(e.uid),this.notifyChange("title"),this.notifyChange("visible")})),this.children.on("before-add",(e=>{this._childIds.has(e.item.id)?e.preventDefault():(e.item._set("parent",this),this._childIds.add(e.item.id))}))])}destroy(){this.children.forEach((e=>e.destroy()))}get hasChildren(){return this.children.length>0}get isDiscipline(){return 1===this.level}get visible(){return E(this.layers,(e=>e.visible))}get title(){return E(this.layers,(e=>e.title))||this.layers.items.map((e=>e.title)).join(", ")||null}toggleVisibility(e){const t=void 0===e?!this.visible:e;this.layers.forEach((e=>{e.visible=t})),t&&null!=this.parent&&this.parent.toggleVisibility(!0)}toggleAllSiblingsVisibility(e){const t=void 0===e?!this.visible:e;this.toggleVisibility(t),null!=this.parent&&(this.parent.toggleVisibility(t),this.parent.children.forEach((e=>e.toggleVisibility(t))))}};function E(e,t){let i=null;for(const n of e.items){const e=t(n);if(null!=i&&i!==e)return null;i=e}return i}function S(){let e=new AbortController;return async t=>{e.abort(),e=new AbortController;const i={signal:e.signal},n=t.toArray().map((e=>async function(e,t){await e.load(t),await e.loadAll(),(0,m.k_)(t),e.summaryStatistics&&await e.summaryStatistics.load(t)}(e,i)));await Promise.all(n),(0,m.k_)(i)}}(0,s._)([(0,o.Cb)({nonNullable:!0})],x.prototype,"id",void 0),(0,s._)([(0,o.Cb)()],x.prototype,"parent",void 0),(0,s._)([(0,o.Cb)({nonNullable:!0,readOnly:!0})],x.prototype,"children",void 0),(0,s._)([(0,o.Cb)({nonNullable:!0,readOnly:!0})],x.prototype,"layers",void 0),(0,s._)([(0,o.Cb)({nonNullable:!0})],x.prototype,"level",void 0),(0,s._)([(0,o.Cb)({readOnly:!0})],x.prototype,"hasChildren",null),(0,s._)([(0,o.Cb)({readOnly:!0})],x.prototype,"isDiscipline",null),(0,s._)([(0,o.Cb)({readOnly:!0})],x.prototype,"visible",null),(0,s._)([(0,o.Cb)({readOnly:!0})],x.prototype,"title",null),x=(0,s._)([(0,l.j)("esri.widgets.BuildingExplorer.support.LayerTreeNode")],x);let T=class extends u.Z{constructor(e){super(e),this.root=new x,this.state="disabled",this._loadLayers=S(),this.layers=new d.Z}initialize(){this.addHandles(this.layers.on("change",(()=>this._onLayersChange()))),this._onLayersChange()}destroy(){this._set("state","disabled"),this.root.destroy()}set layers(e){const t=this._get("layers");this._set("layers",(0,h.Z)(e,t))}_updateLayerTree(){this.root.destroy(),this._set("root",new x);const e=new Map,t=this.layers.length>1?"modelName":"id";return this.layers.forEach((i=>{const n=b(i);this._addNodesForSublayers(n??i,this.root,e,t)})),this}_addNodeForLayer(e,t,i,n){const r=String(e[n]).toLowerCase();if(null==r||e.isEmpty)return;const s=`${t.id}/${r}`;let o=i.get(s);o||(o=new x({id:r,level:t.level+1}),i.set(s,o)),o.layers.push(e),t.children.push(o),this._addNodesForSublayers(e,o,i,n)}_addNodesForSublayers(e,t,i,n){("building-scene"===e.type||"building-group"===e.type&&!e.isEmpty)&&e.sublayers.forEach((e=>this._addNodeForLayer(e,t,i,n)))}async _onLayersChange(){if(this._set("state","loading"),0!==this.layers.length)try{await this._loadLayers(this.layers),this._updateLayerTree(),this._set("state","ready")}catch(e){(0,m.D_)(e)||this._set("state","failed")}}};(0,s._)([(0,o.Cb)({readOnly:!0})],T.prototype,"root",void 0),(0,s._)([(0,o.Cb)({type:d.Z,nonNullable:!0})],T.prototype,"layers",null),(0,s._)([(0,o.Cb)({readOnly:!0,nonNullable:!0})],T.prototype,"state",void 0),T=(0,s._)([(0,l.j)("esri.widgets.BuildingExplorer.BuildingDisciplinesViewModel")],T);const k=T;var I=i(3480);function P(e){const t={fieldValueMap:new Map,allowedValues:[]};for(const i of e){const e=i.fieldValueMap,n=t.fieldValueMap;e.forEach(((e,i)=>{n.has(i)||(n.set(i,e),t.allowedValues.push(i))}))}return t.allowedValues.sort(((e,t)=>e-t)),t}function O(e,t){return t.allowedValues.length>0?function(e,t){if(0===t.length)return e;if(e===1/0)return t[t.length-1];if(e===-1/0)return t[0];let i=t[0],n=Math.abs(i-e);for(const r of t){const t=Math.abs(r-e);t<n&&(i=r,n=t)}return i}(e,t.allowedValues):null}let L=class extends u.Z{constructor(e){super(e),this.state="disabled",this._valueBeforeReady=null,this._domainInfo=P([]),this._loadLayers=S(),this.layers=new d.Z}initialize(){this.addHandles(this.layers.on("change",(()=>this._onLayersChange()))),this._onLayersChange()}destroy(){this._set("state","disabled")}get enabled(){return this.allowedValues.length>0&&this._get("enabled")}set enabled(e){e!==this.enabled&&this.allowedValues.length>0&&this._set("enabled",e)}get value(){return("ready"===this.state?this._get("value"):this._valueBeforeReady)??0}set value(e){if("ready"!==this.state)return void(this._valueBeforeReady=e);if(e===this.value)return;const t=O(e,this);null!=t&&this._set("value",t)}get min(){return function(e){let t=null;for(const i of e)t=null!=t?Math.min(t,i):i;return t}(this.allowedValues)}get max(){return function(e){let t=null;for(const i of e)t=null!=t?Math.max(t,i):i;return t}(this.allowedValues)}get allowedValues(){return this._domainInfo.allowedValues}set allowedValues(e){null==e?this._clearOverride("allowedValues"):this._override("allowedValues",e);const t=O(this.value,this);null!=t&&(this.value=t)}get hasNext(){if(!this.enabled)return!0;const e=this._valueIndex;return e>=0&&e<this.allowedValues.length-1}get hasPrevious(){return!this.enabled||this._valueIndex>0}set layers(e){const t=this._get("layers");this._set("layers",(0,h.Z)(e,t))}get filterExpressions(){return{solid:null,xRay:null}}get _valueIndex(){return(0,I.$A)(this.allowedValues,this.value)}select(e){"ready"===this.state?null!=O(e,this)&&(this.enabled=!0,this.value=e):this._valueBeforeReady=e}clear(){"ready"===this.state?this.enabled=!1:this._valueBeforeReady=null}next(){const{state:e,allowedValues:t,enabled:i,hasNext:n,_valueIndex:r}=this;if("ready"===e||null==this._valueBeforeReady){if(0!==t.length)return i?void(n&&(this.value=t[r+1])):(this.enabled=!0,void(this.value=t[0]))}else this._valueBeforeReady++}previous(){const{state:e,allowedValues:t,enabled:i,hasPrevious:n,_valueIndex:r}=this;if("ready"===e||null==this._valueBeforeReady){if(0!==t.length)return i?void(n&&(this.value=t[r-1])):(this.enabled=!0,void(this.value=t[t.length-1]))}else this._valueBeforeReady++}getValueLabel(e){return 0===this.layers.length?null:this._domainInfo.fieldValueMap.get(e)??null}async _onLayersChange(){if(this._set("state","loading"),this._domainInfo=P([]),0!==this.layers.length)try{await this._loadLayers(this.layers),this._setup()}catch(e){(0,m.D_)(e)||this._set("state","failed")}}};(0,s._)([(0,o.Cb)({value:!1,nonNullable:!0})],L.prototype,"enabled",null),(0,s._)([(0,o.Cb)({nonNullable:!0})],L.prototype,"value",null),(0,s._)([(0,o.Cb)({readOnly:!0})],L.prototype,"min",null),(0,s._)([(0,o.Cb)({readOnly:!0})],L.prototype,"max",null),(0,s._)([(0,o.Cb)()],L.prototype,"allowedValues",null),(0,s._)([(0,o.Cb)({readOnly:!0})],L.prototype,"hasNext",null),(0,s._)([(0,o.Cb)({readOnly:!0})],L.prototype,"hasPrevious",null),(0,s._)([(0,o.Cb)({type:d.Z,nonNullable:!0})],L.prototype,"layers",null),(0,s._)([(0,o.Cb)({nonNullable:!0})],L.prototype,"state",void 0),(0,s._)([(0,o.Cb)()],L.prototype,"_valueBeforeReady",void 0),(0,s._)([(0,o.Cb)({readOnly:!0})],L.prototype,"_valueIndex",null),(0,s._)([(0,o.Cb)()],L.prototype,"_domainInfo",void 0),L=(0,s._)([(0,l.j)("esri.widgets.BuildingExplorer.BuildingNumericFilterViewModel")],L);const M=L;var R=i(18764),A=i(52031),D=i(5030),F=i(69801);const N="__BUILDING_EXPLORER_FILTER__";function V(e){const t="string"==typeof e?e:e.id;return!!t&&t.includes(N)}function z(e,t){for(const i of e.items)for(const e of i.filters.items){if(!V(e))continue;const i=t(e);if(null!=i)return i}return null}function U(e,t){e.forEach((e=>{const i=e.filters.filter((e=>!V(e)));null!=t&&i.push(t),function(e,t){const i=t.length;if(null==e||e.length!==i)return!1;for(let n=0;n<i;++n){const i=t.at(n).toJSON(),r=e.at(n).toJSON();if(i.id="",r.id="",JSON.stringify(i)!==JSON.stringify(r))return!1}return!0}(e.filters,i)||(e.filters=i);const n=e.filters.find((e=>V(e)));e.activeFilterId=null!=n?n.id:null}))}function $(e){return e.filter((e=>!!e)).map((e=>`(${e})`)).join(" AND ")}let B=class extends M{constructor(e){super(e),this._levelFieldName=null,this._parseValueFromFilter=e=>{const t=new RegExp(`${this._levelFieldName}\\s*=\\s*(\\d+)`,"gi"),i=new RegExp(`${this._levelFieldName}\\s*<\\s*(\\d+)`,"gi");for(const{filterMode:n,filterExpression:r}of e.filterBlocks?.items??[]){if(null==r)continue;let e=null;if("solid"===n.type?e=t.exec(r):"x-ray"===n.type&&(e=i.exec(r)),e)return parseInt(e[1],10)}return null}}get filterExpressions(){return this.enabled&&this._levelFieldName?{xRay:`${this._levelFieldName} < ${this.value}`,solid:`${this._levelFieldName} = ${this.value}`}:{solid:null,xRay:null}}get _firstValue(){const e=this.allowedValues;return e.length>0?e[0]:0}_setup(){const e=[];this.layers.forEach((t=>{const i=C(t,"bldglevel");null!=i&&(this._levelFieldName=i.fieldName,e.push(i))})),this._domainInfo=P(e);const t=this._valueBeforeReady;this._set("state","ready"),this._valueBeforeReady=null;const i=t??z(this.layers,this._parseValueFromFilter);null!=i?this.select(i):(this.enabled=!1,this.value=this._firstValue)}};(0,s._)([(0,o.Cb)({readOnly:!0})],B.prototype,"filterExpressions",null),(0,s._)([(0,o.Cb)()],B.prototype,"_levelFieldName",void 0),(0,s._)([(0,o.Cb)({readOnly:!0})],B.prototype,"_firstValue",null),B=(0,s._)([(0,l.j)("esri.widgets.BuildingExplorer.BuildingLevel")],B);const j=B;let H=class extends M{constructor(e){super(e),this._createdPhaseFieldName=null,this._demolishedPhaseFieldName=null,this._parseValueFromFilter=e=>{const t=this._createdPhaseFieldName,i=new RegExp(`${t}\\s*<=\\s*(\\d+)\\s*OR\\s*${t}\\s*IS\\s*NULL`,"gi"),n=this._demolishedPhaseFieldName,r=new RegExp(`${n}\\s*>\\s*(\\d+)\\s*OR\\s*${n}\\s*IS\\s*NULL`,"gi");for(const{filterExpression:t}of e.filterBlocks?.items??[]){const e=t?i.exec(t)??r.exec(t):null;if(e)return parseInt(e[1],10)}return null}}get filterExpressions(){if(!this.enabled)return{solid:null,xRay:null};const e=[],t=this._createdPhaseFieldName;t&&e.push(`(${t} <= ${this.value} OR ${t} IS NULL)`);const i=this._demolishedPhaseFieldName;i&&e.push(`(${i} > ${this.value} OR ${i} IS NULL)`);const n=e.join(" AND ");return{solid:n,xRay:n}}get _lastValue(){const e=this.allowedValues;return e.length>0?e[e.length-1]:0}_setup(){const e=[];this.layers.forEach((t=>{const i=C(t,"createdphase");null!=i&&(this._createdPhaseFieldName=i.fieldName,e.push(i));const n=C(t,"demolishedphase");null!=n&&(this._demolishedPhaseFieldName=n.fieldName,e.push(n))})),this._domainInfo=P(e);const t=this._valueBeforeReady;if(this._set("state","ready"),this._valueBeforeReady=null,this.allowedValues.length>0){const e=t??z(this.layers,this._parseValueFromFilter);this.select(e??this._lastValue)}else this.clear()}};(0,s._)([(0,o.Cb)({readOnly:!0})],H.prototype,"filterExpressions",null),(0,s._)([(0,o.Cb)()],H.prototype,"_createdPhaseFieldName",void 0),(0,s._)([(0,o.Cb)()],H.prototype,"_demolishedPhaseFieldName",void 0),(0,s._)([(0,o.Cb)({readOnly:!0})],H.prototype,"_lastValue",null),H=(0,s._)([(0,l.j)("esri.widgets.BuildingExplorer.BuildingPhase")],H);const Z=H;let q=class extends u.Z{constructor(e){super(e),this.view=null,this.state="disabled",this.level=new j,this.phase=new Z,this.disciplines=new k,this._loadLayers=S(),this.layers=new d.Z}initialize(){this.addHandles([this.layers.on("change",(()=>this._onLayersChange())),(0,f.YP)((()=>({state:this.state,layers:this.layers,filter:this._filter})),(({state:e,layers:t,filter:i})=>{"ready"===e&&U(t,i)}),{initial:!0})]),this._onLayersChange()}destroy(){this.level.destroyed||this.level.destroy(),this.phase.destroyed||this.phase.destroy(),this.disciplines.destroyed||this.disciplines.destroy()}get isSupported(){return"3d"===this.view?.type}get layers(){return this._get("layers")}set layers(e){const t=e.filter((e=>e instanceof v.default));t.length!==e.length&&p.Z.getLogger(this).error("Some layers are not BuildingSceneLayers but only BuildingSceneLayers can be passed to the widget."),this._set("layers",(0,h.Z)(t,this._get("layers")))}get _filter(){const e=this.level.filterExpressions,t=this.phase.filterExpressions,i=[],n=function(e){const t=$(e);return t?new A.Z({filterExpression:t,filterMode:new D.Z}):null}([e.solid,t.solid]);null!=n&&i.push(n);const r=function(e){const t=$(e);return t?new A.Z({filterExpression:t,filterMode:new F.Z}):null}([e.xRay,t.xRay]);return null!=r&&i.push(r),0===i.length?null:new g.Z({id:`${(0,R.DO)()}${N}`,name:"Building Explorer Filter",filterBlocks:i})}async _onLayersChange(){const e=this.layers;if(this.level.layers=e,this.phase.layers=e,this.disciplines.layers=e,0!==e.length){this._set("state","loading");try{await this._loadLayers(e),await Promise.all([(0,f.N1)((()=>"ready"===this.level.state)),(0,f.N1)((()=>"ready"===this.phase.state)),(0,f.N1)((()=>"ready"===this.disciplines.state))]),e.forEach(w),this._set("state","ready")}catch(e){(0,m.D_)(e)||this._set("state","failed")}}else this._set("state","disabled")}};(0,s._)([(0,o.Cb)({value:null})],q.prototype,"view",void 0),(0,s._)([(0,o.Cb)()],q.prototype,"isSupported",null),(0,s._)([(0,o.Cb)({type:d.Z,nonNullable:!0})],q.prototype,"layers",null),(0,s._)([(0,o.Cb)({readOnly:!0})],q.prototype,"state",void 0),(0,s._)([(0,o.Cb)({readOnly:!0,type:j})],q.prototype,"level",void 0),(0,s._)([(0,o.Cb)({readOnly:!0,type:Z})],q.prototype,"phase",void 0),(0,s._)([(0,o.Cb)({readOnly:!0,type:k})],q.prototype,"disciplines",void 0),(0,s._)([(0,o.Cb)()],q.prototype,"_filter",null),q=(0,s._)([(0,l.j)("esri.widgets.BuildingExplorer.BuildingExplorerViewModel")],q);const G=q,W="esri-building-explorer",Y={base:W,panelError:`${W}__panel--error`,loadingContainer:`${W}__loading-container`,content:`${W}__content`,section:`${W}__section`,levels:`${W}__levels`,phases:`${W}__phases`,disciplines:`${W}__disciplines`};var Q,K=i(84644),J=i(68808),X=i(23039);const ee={expand:"expand",collapse:"collapse",hideSublayer:"hideSublayer",showSublayer:"showSublayer"},te="esri-building-disciplines-tree-node",ie={base:te,label:`${te}__label`};let ne=class extends c.Z{static{Q=this}constructor(e){super(e),this.messages=ee,this.toggleSiblingsVisibility=!1,this._onCheckboxClick=e=>{e.stopPropagation(),(e.metaKey||e.ctrlKey)&&this.toggleSiblingsVisibility&&(this.node.toggleVisibility(),this.node.toggleAllSiblingsVisibility())},this._onCheckboxToggle=e=>{this.node.toggleVisibility(e.currentTarget.checked)}}static loadDependencies(){return(0,K.h)({checkbox:()=>i.e(14530).then(i.bind(i,69397)),label:()=>Promise.resolve().then(i.bind(i,36650)),tree:()=>i.e(58369).then(i.bind(i,58369)),"tree-item":()=>i.e(37058).then(i.bind(i,81656))})}loadDependencies(){return Q.loadDependencies()}static{this.vnodeSelector="calcite-tree-item"}render(){const{node:e,messages:t}=this;if(e.isDiscipline&&!e.hasChildren)return(0,X.u)("div",{key:`${e.id}-empty`});const i=e.visible,n=!0===i,r=null===i,s=n?t?.hideSublayer:t?.showSublayer;return(0,X.u)("calcite-tree-item",{class:ie.base,key:e.id},(0,X.u)("calcite-label",{class:ie.label,layout:"inline"},(0,X.u)("calcite-checkbox",{checked:n,indeterminate:r,label:s,onclick:this._onCheckboxClick,title:s,onCalciteCheckboxChange:this._onCheckboxToggle}),e.title),this._renderedChildren)}get _renderedChildren(){const{node:e}=this;if(!e.hasChildren)return null;const{messages:t}=this,{toggleSiblingsVisibility:i}=this;return(0,X.u)("calcite-tree",{lines:!0,selectionMode:"none",slot:"children"},this.node.children.toArray().reverse().map((e=>(0,X.u)(Q,{messages:t,node:e,toggleSiblingsVisibility:i}))))}};(0,s._)([(0,o.Cb)({type:x})],ne.prototype,"node",void 0),(0,s._)([(0,o.Cb)()],ne.prototype,"messages",void 0),(0,s._)([(0,o.Cb)({nonNullable:!0})],ne.prototype,"toggleSiblingsVisibility",void 0),(0,s._)([(0,o.Cb)()],ne.prototype,"_renderedChildren",null),ne=Q=(0,s._)([(0,l.j)("esri.widgets.BuildingExplorer.BuildingDisciplinesTree.BuildingDisciplinesNode")],ne);const re=ne,se={expand:"expand",collapse:"collapse",hideSublayer:"hideSublayer",showSublayer:"showSublayer"},oe="esri-building-disciplines-tree";let ae=class extends c.Z{constructor(e){super(e),this.toggleSiblingsVisibility=!1}loadDependencies(){return Promise.allSettled([(0,K.h)({tree:()=>i.e(58369).then(i.bind(i,58369))}),re.loadDependencies()])}static{this.vnodeSelector="calcite-tree"}render(){const{vm:e}=this,t=this.toggleSiblingsVisibility,i=this.messages??se;return(0,X.u)("calcite-tree",{class:oe,lines:!0,selectionMode:"none"},e.root.children.toArray().filter((e=>!e.isDiscipline||e.hasChildren)).reverse().map((e=>(0,X.u)(re,{messages:i,node:e,toggleSiblingsVisibility:t}))))}};(0,s._)([(0,o.Cb)()],ae.prototype,"vm",void 0),(0,s._)([(0,o.Cb)()],ae.prototype,"messages",void 0),(0,s._)([(0,o.Cb)()],ae.prototype,"toggleSiblingsVisibility",void 0),ae=(0,s._)([(0,l.j)("esri.widgets.BuildingExplorer.BuildingDisciplinesTree.BuildingDisciplinesTree")],ae);const le=ae;var ce=i(10729),ue=i(99574);const de=Object.freeze(Object.defineProperty({__proto__:null,alphaLevelDependencyFactor:30,alphaSpreadFactor:10,levelHeightDefault:14,levelHoveredExtraHeight:30,levelHoveredExtraWidth:20,levelWidthConstant:40,levelWidthMax:80,levelWidthMin:30,levelWidthNominator:100,levelsMarginFactor:2,levelsPadding:20,levelsPointerAdjustment:.035},Symbol.toStringTag,{value:"Module"})),he="esri-building-level-picker",pe={container:he,noLevel:`${he}--no-level`,animateLevel:`${he}--animate-level`,levelsContainer:`${he}__levels-container`,innerLevelsContainer:`${he}__inner-levels-container`,labelContainer:`${he}__label-container`,arrowUp:`${he}__arrow-up`,arrowDown:`${he}__arrow-down`},me="esri-building-level-picker-label",fe={base:me,active:`${me}--active`,hover:`${me}--hover`,empty:`${me}--empty`,clearButton:`${me}__clear-button`},ve={clearLevel:"",selectLevel:""};let ge=class extends c.Z{constructor(e,t){super(e,t),this.level=null,this.active=!1,this.hovering=!1,this.onClear=()=>{}}loadDependencies(){return(0,K.h)({fab:()=>i.e(59591).then(i.bind(i,59591))})}render(){const e=this.messages??ve;if(null==this.level)return(0,X.u)("div",{class:fe.empty,title:e.selectLevel},e.selectLevel);const t=e.clearLevel;return(0,X.u)("div",{"aria-label":t,bind:this,class:this.classes(fe.base,{[fe.active]:this.active,[fe.hover]:this.hovering}),onclick:this.onClear,title:t},(0,X.u)("span",null,this.level),(0,X.u)("calcite-fab",{appearance:"outline-fill",class:fe.clearButton,disabled:!this.active,icon:"x",key:"clear-button",kind:"neutral",onclick:this.onClear,scale:"s"}))}};(0,s._)([(0,o.Cb)()],ge.prototype,"level",void 0),(0,s._)([(0,o.Cb)({nonNullable:!0})],ge.prototype,"active",void 0),(0,s._)([(0,o.Cb)({nonNullable:!0})],ge.prototype,"hovering",void 0),(0,s._)([(0,o.Cb)()],ge.prototype,"messages",void 0),(0,s._)([(0,o.Cb)({nonNullable:!0})],ge.prototype,"onClear",void 0),ge=(0,s._)([(0,l.j)("esri.widgets.BuildingExplorer.BuildingLevelPicker.Label")],ge);const ye="esri-building-level-picker-item",be={container:ye,base:`${ye}__base`,hover:`${ye}--hover`,active:`${ye}--active`};let _e=class extends c.Z{constructor(e,t){super(e,t),this.active=!1,this.hovering=!1,this.width=0,this.height=0,this.onSelect=()=>{},this.onFocus=()=>{},this.onBlur=()=>{},this._baseElement=null}render(){return(0,X.u)("div",{bind:this,class:this.classes(be.container,{[be.active]:this.active,[be.hover]:this.hovering}),key:this,styles:{height:`${this.height}px`}},this._renderBase())}focus(){null!=this._baseElement&&this._baseElement.focus()}_renderBase(){const e=this.width,t=.8*this.width;return(0,X.u)("div",{class:be.base,styles:{width:`${Math.round(e)}px`,height:`${Math.round(e)}px`}},(0,X.u)("button",{afterCreate:J.Yo,"aria-label":this.label,bind:this,class:"rect","data-node-ref":"_baseElement",onblur:this.onBlur,onclick:this.onSelect,onfocus:this.onFocus,styles:{width:`${Math.round(t)}px`,height:`${Math.round(t)}px`,transform:`translate(${(0,J.dZ)(this.container),-50}%, -50%) rotateX(66deg) rotateZ(45deg)`},tabIndex:-1,title:this.label??"",type:"button"}))}};(0,s._)([(0,o.Cb)({nonNullable:!0})],_e.prototype,"level",void 0),(0,s._)([(0,o.Cb)({nonNullable:!0})],_e.prototype,"active",void 0),(0,s._)([(0,o.Cb)({nonNullable:!0})],_e.prototype,"hovering",void 0),(0,s._)([(0,o.Cb)({nonNullable:!0})],_e.prototype,"width",void 0),(0,s._)([(0,o.Cb)({nonNullable:!0})],_e.prototype,"height",void 0),(0,s._)([(0,o.Cb)({nonNullable:!0})],_e.prototype,"onSelect",void 0),(0,s._)([(0,o.Cb)({nonNullable:!0})],_e.prototype,"onFocus",void 0),(0,s._)([(0,o.Cb)({nonNullable:!0})],_e.prototype,"onBlur",void 0),_e=(0,s._)([(0,l.j)("esri.widgets.BuildingExplorer.BuildingLevelPicker.LevelItem")],_e);var we=i(46512);const Ce={selectLevel:"selectLevel",clearLevel:"clearLevel",nextLevel:"nextLevel",previousLevel:"previousLevel",currentLevel:"{{value}}"};let xe=class extends c.Z{constructor(e,t){super(e,t),this._levelHandlesKey="levelHandles",this._levelEventHandlesKey="levelEventHandles",this._levelWidgets=[],this._labelWidget=new ge({onClear:()=>this.vm.clear()}),this._hoveredLevel=null,this._expandedLevelsHeight=void 0,this._normalizedPointerPosition=0,this._hovering=!1,this._containerPosTop=null,this._levelsContainer=null,this._onKeyDown=e=>{switch(e.key){case"ArrowDown":case"ArrowLeft":e.preventDefault(),e.stopPropagation(),this.vm.previous(),this._focusCurrentLevel();break;case"ArrowUp":case"ArrowRight":e.preventDefault(),e.stopPropagation(),this.vm.next(),this._focusCurrentLevel()}},this._onFocus=()=>{this._hoveredLevel=this._levels.length>0?this._levels[0]:null},this._onArrowUpClick=()=>{this.vm.next()},this._onArrowDownClick=()=>{this.vm.previous()},this._onPointerUp=()=>{if(window.getSelection()?.removeAllRanges(),null==this._hoveredLevel)return;const{vm:e}=this;e.enabled&&this._hoveredLevel===e.value?e.clear():e.select(this._hoveredLevel)},this._onPointerEnter=()=>{this._hovering||null==this._levelsContainer||(this._hovering=!0,this._containerPosTop=this._levelsContainer.getBoundingClientRect().top??0)},this._onPointerLeave=()=>{this._hovering&&(this._normalizedPointerPosition=0,this._hoveredLevel=null,this._hovering=!1)},this._onPointerMove=e=>{if(!this._hovering)return!1;if(window.getSelection()?.removeAllRanges(),null!=this._containerPosTop){const t=this._containerPosTop,i=40,n=this._expandedLevelsMargin;let r=this._levelsHeight,s=t+i+n;const o=this._levelHeight/2;s+=o,r-=o;let a=(e.clientY-s)/r;a+=.035,this._normalizedPointerPosition=a}return!1}}loadDependencies(){return(0,K.h)({action:()=>Promise.resolve().then(i.bind(i,11030))})}postInitialize(){this.addHandles([(0,f.YP)((()=>this._levelsContainer),(()=>this._onContainerChange()),f.nn),(0,f.YP)((()=>this._levels),(()=>this._createLevelWidgets()),f.nn),(0,f.YP)((()=>this.messages),(()=>{this._labelWidget.messages=this.messages??Ce}),f.nn)])}destroy(){this._levelWidgets.forEach((e=>e.destroy())),this._labelWidget.destroy()}get _levels(){return this.vm.allowedValues}get _numLevels(){return this._levels.length}get _levelsHeight(){return Math.round(this._levelHeight*this._numLevels)}get _expandedLevelsMargin(){return Math.round(((this._expandedLevelsHeight??0)-this._levelsHeight)/2)}get _levelWidth(){const{levelWidthNominator:e,levelWidthConstant:t}=de,i=e/Math.sqrt(this._numLevels)+t;return Math.round((0,ue.uZ)(i,30,80))}get _levelHeight(){const e=28/Math.sqrt(this._numLevels);return Math.round((0,ue.uZ)(e,2,14))}get _gaussianFactor(){const e=this._numLevels;return e/Math.log(30*e)*10}get _levelClosestToPointer(){if(!this._hovering)return null;const e=this._numLevels-1,t=this._normalizedPointerPosition;return e>=0&&null!=t?this._levels[Math.round((1-t)*e)]:null}render(){const e=this._levelWidgets.length,t=e>1?this._levelWidgets.map((e=>e.render())):null,i=this._levelsHeight,n=i+80;return(0,X.u)("div",{class:this.classes(we.z.widget,pe.container,{[pe.animateLevel]:!this._hovering,[pe.noLevel]:e<2}),key:this,onkeydown:this._onKeyDown},this._renderLabelContainer(),(0,X.u)("div",{afterCreate:e=>this._levelsContainer=e,class:pe.levelsContainer,"data-node-ref":"",onfocus:this._onFocus,styles:{height:`${n}px`,marginBlockStart:"-20px",marginBlockEnd:"-20px"}},(0,X.u)("div",{class:pe.innerLevelsContainer,styles:{height:`${i}px`,margin:"0",marginBlockStart:20-this._expandedLevelsMargin+"px"}},t)))}_renderLabelContainer(){const{hasPrevious:e,hasNext:t}=this.vm,i=this.messages??Ce,n=i.previousLevel,r=i.nextLevel;return(0,X.u)("div",{class:pe.labelContainer,tabIndex:0},Ee({className:pe.arrowUp,disabled:!t,icon:"chevron-up",onClick:this._onArrowUpClick,text:r}),this._labelWidget.render(),Ee({className:pe.arrowDown,disabled:!e,icon:"chevron-down",onClick:this._onArrowDownClick,text:n}))}_updateComponents(){const e=this.messages??Ce,t=this.vm.enabled?this.vm.value:null,i=null!=this._hoveredLevel?this._hoveredLevel:t;this._levelWidgets.forEach((i=>{const n=this.vm.getValueLabel(i.level);i.label=null!=n?n:e.currentLevel?.replace("{{level}}",String(i.level)),i.active=i.level===t,i.hovering=i.level===this._hoveredLevel})),this._labelWidget.level=i,this._labelWidget.active=i===t,this._labelWidget.hovering=null!=this._hoveredLevel}_createLevelWidgets(){this._levelWidgets.forEach((e=>e.destroy())),this._levelWidgets=this._levels.map((e=>new _e({level:e,onSelect:()=>this._onLevelToggle(e)}))),this.removeHandles(this._levelHandlesKey),this.addHandles([(0,f.YP)((()=>{const{vm:e}=this;return[this.messages,e?.value,e?.enabled,this._hoveredLevel,this._hovering]}),(()=>this._updateComponents()),f.nn),(0,f.YP)((()=>[this._normalizedPointerPosition,this._hovering]),(()=>this._onPointerPositionChange()),f.nn),(0,f.YP)((()=>this._levelWidth),(e=>this._levelWidgets.forEach((t=>t.width=e))),f.nn)],this._levelHandlesKey)}_onContainerChange(){const e=this._levelsContainer;null!=e&&(this.removeHandles(this._levelEventHandlesKey),this.addHandles([(0,ce.on)(e,"pointerenter",this._onPointerEnter),(0,ce.on)(e,"pointerover",this._onPointerEnter),(0,ce.on)(e,"pointerleave",this._onPointerLeave),(0,ce.on)(e,"pointerup",this._onPointerUp),(0,ce.on)(e,"pointermove",this._onPointerMove)],this._levelEventHandlesKey))}_focusCurrentLevel(){this._levelWidgets.find((e=>e.level===this.vm.value))?.focus()}_onLevelToggle(e){const{vm:t}=this;t.enabled&&t.value===e?t.clear():t.select(e)}_onPointerPositionChange(){let e=0;this._levelWidgets.forEach(((t,i)=>{const{width:n,height:r}=this._getLevelWidgetSize(i);t.height=r,t.width=n,e+=r})),this._hoveredLevel=this._levelClosestToPointer;const t=this._expandedLevelsHeight;(null==t||Math.abs(t-e)>30)&&(this._expandedLevelsHeight=e)}_getLevelWidgetSize(e){const t={width:this._levelWidth,height:this._levelHeight};if(this._hovering){const i=this._getGaussianFactor(e,this._normalizedPointerPosition);t.width+=20*i,t.height+=30*i}return t}_getGaussianFactor(e,t){const i=this._numLevels-1,n=(i-e)/i,r=this._gaussianFactor*(n-t);return Math.exp(-(r**2))}};function Ee(e){return(0,X.u)("calcite-action",{appearance:"transparent",class:e.className,disabled:e.disabled,icon:e.icon,key:e.className,onclick:e.onClick,scale:"s",text:e.text,textEnabled:!1,title:e.text})}(0,s._)([(0,o.Cb)()],xe.prototype,"vm",void 0),(0,s._)([(0,o.Cb)()],xe.prototype,"messages",void 0),(0,s._)([(0,o.Cb)()],xe.prototype,"_levelWidgets",void 0),(0,s._)([(0,o.Cb)()],xe.prototype,"_labelWidget",void 0),(0,s._)([(0,o.Cb)()],xe.prototype,"_hoveredLevel",void 0),(0,s._)([(0,o.Cb)()],xe.prototype,"_levels",null),(0,s._)([(0,o.Cb)()],xe.prototype,"_numLevels",null),(0,s._)([(0,o.Cb)({readOnly:!0})],xe.prototype,"_levelsHeight",null),(0,s._)([(0,o.Cb)()],xe.prototype,"_expandedLevelsHeight",void 0),(0,s._)([(0,o.Cb)({readOnly:!0})],xe.prototype,"_expandedLevelsMargin",null),(0,s._)([(0,o.Cb)({readOnly:!0})],xe.prototype,"_levelWidth",null),(0,s._)([(0,o.Cb)({readOnly:!0})],xe.prototype,"_levelHeight",null),(0,s._)([(0,o.Cb)({readOnly:!0})],xe.prototype,"_gaussianFactor",null),(0,s._)([(0,o.Cb)({readOnly:!0})],xe.prototype,"_levelClosestToPointer",null),(0,s._)([(0,o.Cb)({type:Number,range:{min:0,max:1}})],xe.prototype,"_normalizedPointerPosition",void 0),(0,s._)([(0,o.Cb)()],xe.prototype,"_hovering",void 0),(0,s._)([(0,o.Cb)()],xe.prototype,"_containerPosTop",void 0),(0,s._)([(0,o.Cb)()],xe.prototype,"_levelsContainer",void 0),xe=(0,s._)([(0,l.j)("esri.widgets.BuildingExplorer.BuildingLevelPicker.BuildingLevelPicker")],xe);const Se=xe,Te="esri-building-phase-picker",ke={base:`${Te}`,phasesContainer:`${Te}__phases-container`,phase:`${Te}__phase`,phaseActive:`${Te}__phase--active`,phaseCurrent:`${Te}__phase--current`,divider:`${Te}__divider`,dividerActive:`${Te}__divider--active`,arrowLeft:`${Te}__arrow-left`,arrowRight:`${Te}__arrow-right`},Ie={nextPhase:"nextPhase",previousPhase:"previousPhase"};let Pe=class extends c.Z{constructor(e,t){super(e,t),this._phasesContainer=null,this._shouldScrollCurrentPhaseIntoView=!0,this._shouldFocusCurrentPhase=!1,this._onKeyDown=e=>{const{vm:t}=this;switch(e.key){case"ArrowDown":case"ArrowLeft":e.stopPropagation(),e.preventDefault(),t.previous(),this._shouldFocusCurrentPhase=!0;break;case"ArrowUp":case"ArrowRight":e.stopPropagation(),e.preventDefault(),t.next(),this._shouldFocusCurrentPhase=!0}},this._onArrowLeftClick=()=>{this.vm.previous()},this._onArrowRightClick=()=>{this.vm.next()},this._onPhasesContainerAfterCreate=e=>{this._phasesContainer=e,requestAnimationFrame(this._scrollOrFocusPhase)},this._scrollOrFocusPhase=()=>{const e=this._phasesContainer;if(this.destroyed||null==e)return;const t=e.querySelector(`.${ke.phaseCurrent}`);if(t){if(this._shouldScrollCurrentPhaseIntoView){const i=e.offsetWidth,n=t.offsetLeft,r=t.offsetWidth;e.scrollLeft=-i/2+n+r/2,this._shouldScrollCurrentPhaseIntoView=!1}this._shouldFocusCurrentPhase&&(t.focus(),this._shouldFocusCurrentPhase=!1)}}}loadDependencies(){return(0,K.h)({action:()=>Promise.resolve().then(i.bind(i,11030))})}initialize(){this.addHandles([(0,f.YP)((()=>[this._currentPhase,this._phasesContainer,this.container]),(()=>{this._shouldScrollCurrentPhaseIntoView=!0,requestAnimationFrame(this._scrollOrFocusPhase)}),f.nn),(0,f.YP)((()=>({container:this.container,numPhases:this._phases.length})),(({container:e,numPhases:t})=>{e&&e.style.setProperty("--num-phases",String(t))}),f.nn)])}get _phases(){return this.vm.allowedValues}get _currentPhase(){const{vm:e}=this;return e.enabled?e.value:null}render(){if(this._phases.length<2)return(0,X.u)("div",{key:"no-phases"});const{vm:e,messages:t}=this,{previousPhase:i,nextPhase:n}=t??Ie;return(0,X.u)("div",{class:this.classes(we.z.widget,ke.base),key:this,onkeydown:this._onKeyDown},Oe({className:ke.arrowLeft,disabled:!e.hasPrevious,icon:"chevron-left",onClick:this._onArrowLeftClick,text:i}),(0,X.u)("div",{afterCreate:this._onPhasesContainerAfterCreate,class:ke.phasesContainer},this._renderPhaseButtons()),Oe({className:ke.arrowRight,disabled:!e.hasNext,icon:"chevron-right",onClick:this._onArrowRightClick,text:n}))}_renderPhaseButtons(){const e=this._phases,t=this._currentPhase,i=[];for(let n=0;n<e.length;++n){const r=e[n],s={phase:r,active:null!=t&&r<=t,current:null!=t&&r===t};n>0&&i.push(this._renderDivider(s)),i.push(this._renderPhaseButton(s))}return i}_renderPhaseButton({phase:e,active:t,current:i}){const{vm:n}=this,r=n.getValueLabel(e);return(0,X.u)("button",{"aria-label":r,class:this.classes(ke.phase,{[ke.phaseActive]:t,[ke.phaseCurrent]:i}),key:`phase-${e}`,onclick:()=>n.select(e),title:r,type:"button"},e)}_renderDivider({phase:e,active:t}){return(0,X.u)("div",{class:this.classes(ke.divider,{[ke.dividerActive]:t}),key:`phase-divider-${e}`})}};function Oe(e){return(0,X.u)("calcite-action",{appearance:"transparent",class:e.className,disabled:e.disabled,icon:e.icon,iconFlipRtl:!0,key:e.className,onclick:e.onClick,scale:"s",text:e.text,textEnabled:!1,title:e.text})}(0,s._)([(0,o.Cb)({nonNullable:!0})],Pe.prototype,"vm",void 0),(0,s._)([(0,o.Cb)()],Pe.prototype,"messages",void 0),(0,s._)([(0,o.Cb)()],Pe.prototype,"_phases",null),(0,s._)([(0,o.Cb)()],Pe.prototype,"_currentPhase",null),(0,s._)([(0,o.Cb)()],Pe.prototype,"_phasesContainer",void 0),Pe=(0,s._)([(0,l.j)("esri.widgets.BuildingExplorer.BuildingPhasePicker.BuildingPhasePicker")],Pe);const Le=Pe;var Me=i(79691),Re=i(24225);const Ae={levels:!0,phases:!0,disciplines:!0};let De=class extends c.Z{constructor(e,t){super(e,t),this._defaultViewModel=new G,this.viewModel=this._defaultViewModel,this.visibleElements={...Ae},this.headingLevel=3,this.messages=null,this.messagesCommon=null,this.toggleSiblingsVisibility=!1}loadDependencies(){return(0,K.h)({loader:()=>Promise.resolve().then(i.bind(i,55001))})}destroy(){this.viewModel!==this._defaultViewModel&&this._defaultViewModel.destroy()}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get layers(){return this.viewModel.layers}set layers(e){this.viewModel.layers=e}_castVisibleElements(e){return{...Ae,...e}}get icon(){return"organization"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}render(){const e=this.viewModel,t="disabled"===e.state||!e.isSupported;return(0,X.u)("div",{"aria-label":this.messages.widgetLabel,class:(0,J.Sh)(we.z.widget,Y.base,we.z.panel,{[we.z.widgetDisabled]:t}),key:this},this._renderContent())}_renderContent(){const e=this.viewModel,t=this.messages;if(!e.isSupported)return(0,X.u)("p",{class:Y.panelError},t.unsupported);if(!e.layers.length)return(0,X.u)("p",{class:Y.panelError},t.noData);switch(e.state){case"loading":return this._renderLoadingIndicator();case"ready":return(0,X.u)("div",{class:Y.content,key:"content"},this._renderLevelPickerSection(),this._renderPhasePickerSection(),this._renderDisciplinesSection());case"failed":return(0,X.u)("p",{class:Y.panelError},t.failed);default:return null}}_renderLoadingIndicator(){const e=this.messagesCommon.loading;return(0,X.u)("div",{"aria-label":e,class:Y.loadingContainer,key:"loading-container",role:"presentation",title:e},(0,X.u)("calcite-loader",{label:e,type:"indeterminate"}))}_renderLevelPickerSection(){const e=this.viewModel.level,t="ready"===e.state,i=e.allowedValues.length>1;if(!this.visibleElements.levels||!t||!i)return null;const n=this.messages?.level;return(0,X.u)("div",{class:(0,J.Sh)(Y.section,Y.levels),key:"levels"},(0,X.u)(Me.X,{level:this.headingLevel},n?.title),(0,X.u)(Se,{messages:n,vm:e}))}_renderPhasePickerSection(){const e=this.viewModel.phase,t="ready"===e.state,i=e.allowedValues.length>1;if(!this.visibleElements.phases||!t||!i)return null;const n=this.messages.phase;return(0,X.u)("div",{class:(0,J.Sh)(Y.section,Y.phases),key:"phases"},(0,X.u)(Me.X,{level:this.headingLevel},n.title),(0,X.u)(Le,{messages:n,vm:e}))}_renderDisciplinesSection(){const e=this.viewModel.disciplines,t="ready"===e.state,i=e.root.hasChildren;if(!this.visibleElements.disciplines||!t||!i)return null;const n=this.messages?.disciplines;return(0,X.u)("div",{class:(0,J.Sh)(Y.section,Y.disciplines),key:"disciplines"},(0,X.u)(Me.X,{level:this.headingLevel},n.title),(0,X.u)(le,{messages:n,toggleSiblingsVisibility:this.toggleSiblingsVisibility,vm:e}))}};(0,s._)([(0,o.Cb)({type:G})],De.prototype,"viewModel",void 0),(0,s._)([(0,o.Cb)()],De.prototype,"view",null),(0,s._)([(0,o.Cb)()],De.prototype,"layers",null),(0,s._)([(0,o.Cb)()],De.prototype,"visibleElements",void 0),(0,s._)([(0,a.p)("visibleElements")],De.prototype,"_castVisibleElements",null),(0,s._)([(0,o.Cb)()],De.prototype,"headingLevel",void 0),(0,s._)([(0,o.Cb)()],De.prototype,"icon",null),(0,s._)([(0,o.Cb)()],De.prototype,"label",null),(0,s._)([(0,o.Cb)(),(0,Re.H)("esri/widgets/BuildingExplorer/t9n/BuildingExplorer")],De.prototype,"messages",void 0),(0,s._)([(0,o.Cb)(),(0,Re.H)("esri/t9n/common")],De.prototype,"messagesCommon",void 0),(0,s._)([(0,o.Cb)({nonNullable:!0})],De.prototype,"toggleSiblingsVisibility",void 0),(0,s._)([(0,o.Cb)()],De.prototype,"uiStrings",void 0),De=(0,s._)([(0,l.j)("esri.widgets.BuildingExplorer")],De);const Fe=De;var Ne=i(54503),Ve=i(8403);const ze=i(49006).iv`@layer{arcgis-building-explorer{display:block}}`,Ue=(0,Ve.m)(Fe);class $e extends Ne.oi{constructor(){super(...arguments),this.widget=Ue(this),this.viewModel=this.widget.viewModel,this.autoDestroyDisabled=!1,this.headingLevel=this.widget.headingLevel,this.hideDisciplines=this.widget.visibleElements.disciplines,this.hideLevels=this.widget.visibleElements.levels,this.hidePhases=this.widget.visibleElements.phases,this.icon=this.widget.icon,this.label=this.widget.label,this.layers=this.widget.layers,this.level=this.viewModel.level,this.phase=this.viewModel.phase,this.position="bottom-left",this.state=this.viewModel.state,this.arcgisPropertyChange=(0,r.OR)()("level","phase","state"),this.arcgisReady=(0,Ne.yM)()}static{this.properties={autoDestroyDisabled:5,headingLevel:9,hideDisciplines:5,hideLevels:5,hidePhases:5,icon:1,label:1,layers:0,level:0,phase:0,position:1,referenceElement:1,state:3}}static{this.shadowRootOptions=Ne.hZ}static{this.styles=ze}async destroy(){await this.manager.destroy()}}(0,n.c)("arcgis-building-explorer",$e)},97017:function(e,t,i){var n=i(64297),r=i(73440),s=i(96711),o=i(90403),a=i(17155),l=(i(61432),i(83850),i(48023)),c=i(74765),u=i(1803);const d="esri-daylight",h=`${d}__container`,p="esri-slider",m={base:d,dayContainer:`${h} ${d}__day-container`,dateContainer:`${h} ${d}__date-container`,containerDisabled:`${h}--disabled`,slider:p,sliderAmPmOn:`${p}--ampm-on`,sliderDateOff:`${p}--date-off`,sliderDateOn:`${p}--date-on`,playPauseButton:`${d}__play-pause-button`,datePicker:`${d}__date-picker`,seasonPicker:`${d}__season-picker`,panelError:`${d}__panel--error`,sunLightingCheckbox:`${d}__sun-lighting-checkbox`,shadowsCheckbox:`${d}__shadows-checkbox`};var f,v,g=i(87833),y=i(50702),b=i(61100),_=i(99153),w=i(92161),C=i(74558),x=i(24127),E=i(32185);(v=f||(f={}))[v.NORTHERN=0]="NORTHERN",v[v.SOUTHERN=1]="SOUTHERN";const S={spring:{dayOfMonth:20,month:2},summer:{dayOfMonth:21,month:5},fall:{dayOfMonth:23,month:8},winter:{dayOfMonth:21,month:11}},T=["spring","summer","fall","winter"];function k(e,t,i){const n=P(t,i),{dayOfMonth:r,month:s}=S[n],o=new Date(e.getTime());return o.setMonth(s,r),o}function I(e,t){return P(function(e){const t=e.getTime(),i=k(e,"spring",f.NORTHERN).getTime(),n=k(e,"summer",f.NORTHERN).getTime(),r=k(e,"fall",f.NORTHERN).getTime(),s=k(e,"winter",f.NORTHERN).getTime();return t>=i&&t<n?"spring":t>=n&&t<r?"summer":t>=r&&t<s?"fall":"winter"}(e),t)}function P(e,t){return t===f.NORTHERN?e:function(e){const t=T.indexOf(e);return T[(t+2)%4]}(e)}var O=i(70880),L=i(88194);let M=class extends O.Z{constructor(e){super(e),this.precision=4,this.thumbsConstrained=!0}set effectiveMax(e){this.setEffectiveMax(e)}set effectiveMin(e){this.setEffectiveMin(e)}set labelFormatFunction(e){this._set("labelFormatFunction",e)}set inputFormatFunction(e){this._set("inputFormatFunction",e)}set inputParseFunction(e){this._set("inputParseFunction",e)}get labels(){const{max:e,min:t,values:i}=this,n=i?.length?i.map(((e,t)=>this.getLabelForValue(e,"value",t))):[];return{max:this.getLabelForValue(e,"max"),min:this.getLabelForValue(t,"min"),values:n}}set max(e){this.setMax(e)}set min(e){this.setMin(e)}get state(){const{max:e,min:t}=this;return null!=e&&null!=t&&e>t?"ready":"disabled"}set values(e){const{max:t,min:i}=this,n=this.values;n&&e&&n.length===e.length&&n.every(((t,i)=>t===e[i]))||(this._set("values",null),e?.length&&(null!=i&&e.some((e=>e<i))&&(this.min=Math.min(...e)),null!=t&&e.some((e=>e>t))&&(this.max=Math.max(...e))),this._set("values",e))}toPrecision(e){return parseFloat(e.toFixed(this.precision))}defaultLabelFormatFunction(e){const{max:t,min:i,precision:n}=this,r=null!=t&&null!=i&&t-i>10?2:n;return parseFloat(e.toFixed(r)).toString()}defaultInputFormatFunction(e){return e.toString()}defaultInputParseFunction(e){return parseFloat(e)}getBounds(){const{effectiveMax:e,effectiveMin:t,max:i,min:n}=this;return{min:null!=t&&null!=n?Math.max(n,t):n,max:null!=e&&null!=i?Math.min(i,e):i}}getBoundsForValueAtIndex(e){const{thumbsConstrained:t,values:i}=this,{min:n,max:r}=this.getBounds();if(t&&i){const t=e-1,s=e+1;return{min:null!=i[t]?i[t]:n,max:null!=i[s]?i[s]:r}}return{min:n,max:r}}getLabelForValue(e,t,i){return null==e?null:this.labelFormatFunction?this.labelFormatFunction(e,t,i):this.defaultLabelFormatFunction(e)}setMax(e){const{max:t,values:i}=this;if(null==e)return void this._set("max",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'max' is NaN.");const n=this.toPrecision(e);if(t!==n&&(this._set("max",n),i?.length))for(let e=0;e<i.length;e++)n<i[e]&&this.setValue(e,n)}setMin(e){const{min:t,values:i}=this;if(null==e)return void this._set("min",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'min' is NaN.");const n=this.toPrecision(e);if(t!==n&&(this._set("min",n),i?.length))for(let e=0;e<i.length;e++)n>i[e]&&this.setValue(e,n)}setEffectiveMax(e){if(null==e)return void this._set("effectiveMax",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'effectiveMax' is NaN.");const t=this.toPrecision(e);this.effectiveMax!==t&&this._set("effectiveMax",this._applyBoundsToValue(t))}setEffectiveMin(e){if(null==e)return void this._set("effectiveMin",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'effectiveMin' is NaN.");const t=this.toPrecision(e);this.effectiveMin!==t&&this._set("effectiveMin",this._applyBoundsToValue(t))}setValue(e,t){if(isNaN(t))return void this._logError("slider:invalid-value","Supplied value for member of property 'values' is NaN.");const{values:i}=this;if(null==i)return void this._logError("slider:invalid-value","Supplied value for member of property 'values' is null.");const n=i[e],r=this.toPrecision(t);if(n===r)return;const s=[...i];s[e]=r,this._set("values",s)}_applyBoundsToValue(e){const{max:t,min:i}=this;return null!=i&&e<i?i:null!=t&&e>t?t:e}_logError(e,t,i){s.Z.getLogger(this).error(new L.Z(e,t,i))}};(0,r._)([(0,a.Cb)()],M.prototype,"effectiveMax",null),(0,r._)([(0,a.Cb)()],M.prototype,"effectiveMin",null),(0,r._)([(0,a.Cb)()],M.prototype,"labelFormatFunction",null),(0,r._)([(0,a.Cb)()],M.prototype,"inputFormatFunction",null),(0,r._)([(0,a.Cb)()],M.prototype,"inputParseFunction",null),(0,r._)([(0,a.Cb)({readOnly:!0})],M.prototype,"labels",null),(0,r._)([(0,a.Cb)()],M.prototype,"max",null),(0,r._)([(0,a.Cb)()],M.prototype,"min",null),(0,r._)([(0,a.Cb)()],M.prototype,"precision",void 0),(0,r._)([(0,a.Cb)({readOnly:!0})],M.prototype,"state",null),(0,r._)([(0,a.Cb)()],M.prototype,"thumbsConstrained",void 0),(0,r._)([(0,a.Cb)()],M.prototype,"values",null),M=(0,r._)([(0,l.j)("esri.widgets.Slider.SliderViewModel")],M);const R=M;let A=class extends R{constructor(){super(...arguments),this.utcOffset=null,this.timezonePickerOpen=!1}};(0,r._)([(0,a.Cb)()],A.prototype,"utcOffset",void 0),(0,r._)([(0,a.Cb)()],A.prototype,"timezonePickerOpen",void 0),A=(0,r._)([(0,l.j)("esri.widgets.Daylight.support.SliderWithDropdownViewModel")],A);var D=i(60646),F=i(69069);const N="esri-slider",V={base:N,reversed:`${N}--reversed`,horizontalLayout:`${N}--horizontal`,verticalLayout:`${N}--vertical`,contentElement:`${N}__content`,extraContentElement:`${N}__extra-content`,trackElement:`${N}__track`,ticksContainerElement:`${N}__ticks`,tickElement:`${N}__tick`,tickLabelElement:`${N}__tick-label`,maxElement:`${N}__max`,minElement:`${N}__min`,maxElementInteractive:`${N}__max--interactive`,minElementInteractive:`${N}__min--interactive`,rangeElementActive:`${N}__range--active`,rangeInput:`${N}__range-input`,anchorElement:`${N}__anchor`,movingAnchorElement:`${N}__anchor--moving`,lastMovedAnchorElement:`${N}__anchor--moved`,anchorElementActive:`${N}__anchor--active`,anchorElementIndexPrefix:`${N}__anchor-`,segmentElement:`${N}__segment`,segmentElementIndexPrefix:`${N}__segment-`,segmentElementInteractive:`${N}__segment--interactive`,segmentElementActive:`${N}__segment--active`,effectiveSegmentElement:`${N}__effective-segment`,effectiveMaxSegmentElement:`${N}__effective-max-segment`,effectiveMinSegmentElement:`${N}__effective-min-segment`,thumbElement:`${N}__thumb`,labelElement:`${N}__label`,labelElementInteractive:`${N}__label--interactive`,labelInput:`${N}__label-input`};var z=i(46512);const U={hour:"numeric",minute:"numeric",timeZone:"UTC"},$={hour:"numeric",timeZone:"UTC"};function B(e,t){const i=H(e,t);let n=(0,D.p6)(i,U);return 0!==e&&"00:00"===n&&(n="24:00"),"tick"===t&&n.includes(" ")&&(n=(0,D.p6)(i,$),n=n.replace(":00","")),n}function j(e){e.classList.toggle(z.z.primaryTickLabelKeepAll,"ko"===(0,c.v2)()?.language)}function H(e,t){if("tick"===t){const t=Math.round((0,w.rJ)(e,"minutes","hours"));return new Date((0,w.rJ)(t,"hours","milliseconds"))}return new Date(6e4*e)}let Z=class extends g.Z.EventedAccessor{constructor(e){super(e),this.view=null,this.timeSliderViewModel=new A({min:0,max:1439,values:[0],labelFormatFunction:B,inputFormatFunction:B}),this.lightingUpdateInterval=200,this._oldLighting=null,this.playSpeedMultiplier=1,this._lastTime=null,this._sunrise=null,this._sunset=null,this._cachedLightingDateUTC=new Date(0),this._cachedDisplayUTCOffset=0,this._lastLightingUpdate=0,this._lightingUpdateHandle=null}initialize(){this.addHandles([(0,o.gx)((()=>this.view),(e=>e.when((()=>this._updateLighting()))),o.nn),(0,o.YP)((()=>{const e=this._lighting;return"sun"===e?.type?e.date:null}),(e=>this._scheduleLightingUpdate(e))),(0,o.on)((()=>this._lighting),"timezone-will-change",(e=>this._timezoneWillChange(e)),{onListenerAdd:()=>this._timezoneWillChange(null)}),(0,o.YP)((()=>!0===this.view?.stationary),(()=>{(this.dayPlaying||this.yearPlaying)&&this._updateSunriseAndSunset()}),o.nn),(0,o.YP)((()=>{const e=this.timeSliderViewModel;return{vm:e,state:e.state,sliderPosition:this.timeSliderPosition}}),(({vm:e,state:t,sliderPosition:i})=>{"ready"===t&&e.setValue(0,i)})),(0,o.YP)((()=>this.timeSliderViewModel?.utcOffset),(e=>{null!=e&&(this.utcOffset=e)})),(0,o.YP)((()=>({utcOffset:this.utcOffset,sliderViewModel:this.timeSliderViewModel})),(({utcOffset:e,sliderViewModel:t})=>{t&&(t.utcOffset=e)}),o.tX),(0,o.YP)((()=>this.timeSliderViewModel.timezonePickerOpen),(()=>this.stopPlaying())),(0,o.YP)((()=>this.timeSliderViewModel.values),(e=>this._setTimeSliderPosition(e?.[0]??0,{forceLightingUpdate:!1})))])}destroy(){this._cancelLightingUpdate(),this.view=null}get isSupported(){return null==this.view||"3d"===this.view.type}get utcOffset(){return this._cachedDisplayUTCOffset}set utcOffset(e){e!==this.utcOffset&&null!=this._lighting&&"virtual"!==this._lighting.type&&(this._lighting.displayUTCOffset=e,this._updateLighting())}get localDate(){return(0,w.cH)(this._lightingDateDisplay)}set localDate(e){this.view?.ready?(0,w.qb)(e)&&e.getTime()!==this.localDate.getTime()&&(this._lightingDateDisplay=(0,w.y7)(this._lightingDateDisplay,e)):s.Z.getLogger(this).error("The localDate property cannot be set before the view and the widget are ready.")}get timeSliderPosition(){return function(e){return(0,w.Ni)(e,"minutes")}(this._lightingDateDisplay)}set timeSliderPosition(e){this.view?.ready&&"ready"===this.timeSliderViewModel?.state?this._setTimeSliderPosition(e,{forceLightingUpdate:!0}):s.Z.getLogger(this).error("The timeSliderPosition property cannot be set before the view and the widget are ready.")}_setTimeSliderPosition(e,t){Math.abs(e-this.timeSliderPosition)<=1/60||(this.stopPlaying(),this._onUserDateTimeChange(),t.forceLightingUpdate&&(this._cancelLightingUpdate(),this._updateLighting()),this._lightingDateDisplay=function(e,t){return(0,w.cl)(e,t,"minutes")}(this._lightingDateDisplay,e))}_timezoneFromCamera(e,t){if(null==t||!e.cameraTrackingEnabled)return 0;const i=(0,E.dF)([t.longitude,t.latitude]);return null==i?0:Math.round(i.hours+i.minutes/60+i.seconds/3600)}get directShadowsEnabled(){return this._lighting?.directShadowsEnabled??!1}set directShadowsEnabled(e){const t=this._lighting;t&&(t.directShadowsEnabled=e)}get sunLightingEnabled(){return"sun"===this._lightingType}set sunLightingEnabled(e){const t=this._environment;if(e===this._get("sunLightingEnabled")||null==t)return;const i=t.lighting,n=this._oldLighting;this._oldLighting=i;const r={directShadowsEnabled:i.directShadowsEnabled,cameraTrackingEnabled:i.cameraTrackingEnabled},s=e?"sun":"virtual";let o;o=null!=n&&n.type===s?n:e?new C.Z:new x.Z,o.set(r),t.lighting=o,e||(this.stopPlaying(),this.timeSliderViewModel.timezonePickerOpen=!1)}set playingState(e){this.playingState!==e&&(this._set("playingState",e),"none"!==e&&this.sunLightingEnabled&&(this._updateSunriseAndSunset(),this._lastTime=Date.now(),this._play(),this._onUserDateTimeChange()))}get dayPlaying(){return"day"===this.playingState}set dayPlaying(e){e?this.playingState="day":this.dayPlaying&&(this.playingState="none")}get yearPlaying(){return"year"===this.playingState}set yearPlaying(e){e?this.playingState="year":this.yearPlaying&&(this.playingState="none")}get currentSeason(){return I(this.localDate,this._currentHemisphere)}set currentSeason(e){this.stopPlaying(),this._onUserDateTimeChange();const t=P(e,this._currentHemisphere);this.localDate=k(this.localDate,t,f.NORTHERN)}get _currentHemisphere(){const e=this.view?.camera?.position?.latitude;return null==e||e>=0?f.NORTHERN:f.SOUTHERN}get _environment(){return this.view?.environment}get _lighting(){return this._environment?.lighting}get _lightingType(){return this._lighting?.type}get _lightingDateDisplay(){return(0,w.Nm)(this._cachedLightingDateUTC,this._cachedDisplayUTCOffset,"hours")}set _lightingDateDisplay(e){const t=this._lighting;if(null==t||!this.sunLightingEnabled||"virtual"===t.type||!(0,w.qb)(e))return;const i=t.date,n=(0,w.Nm)(e,-this._cachedDisplayUTCOffset,"hours");n.getTime()!==i.getTime()&&(t.date=n,this._updateLighting())}stopPlaying(){this.playingState="none"}toggleDayPlaying(){this.dayPlaying=!this.dayPlaying}toggleYearPlaying(){this.yearPlaying=!this.yearPlaying}toggleSunLightingEnabled(){this.stopPlaying(),this.sunLightingEnabled=!this.sunLightingEnabled}toggleDirectShadowsEnabled(){this.stopPlaying(),this.directShadowsEnabled=!this.directShadowsEnabled}onDateChange(e){this.dayPlaying=!1,this.localDate=e,this._onUserDateTimeChange()}_updateLighting(e){const t=Date.now();this._lastLightingUpdate=t;const{view:i}=this,n=this._lighting;if(null==i||null==n||"virtual"===n.type)return;e??=n.date;const r=n.displayUTCOffset,s=null!=r?r:this._timezoneFromCamera(n,i.camera?.position);this._cachedLightingDateUTC.getTime()!==e.getTime()&&(this._cachedLightingDateUTC=new Date(e.getTime())),this._cachedDisplayUTCOffset!==s&&(this._cachedDisplayUTCOffset=s)}_timezoneWillChange(e){const t=this._lighting;if(null==t||"virtual"===t.type||!t.cameraTrackingEnabled)return;let i;if(e)i=e.timezoneOffset;else{if(null!=t.displayUTCOffset)return;i=C.Z.calculateTimezoneOffset(t.positionTimezoneInfo)}t.displayUTCOffset=i,this._scheduleLightingUpdate()}_scheduleLightingUpdate(e){if(e&&(this._lightingUpdateHandle=(0,b.hw)(this._lightingUpdateHandle),!(0,w.qb)(e)))return;if(this._lightingUpdateHandle)return;const t=Date.now()-this._lastLightingUpdate,i=this.lightingUpdateInterval-t;let n=null;const r=()=>{this._updateLighting(e),this._lightingUpdateHandle===n&&(this._lightingUpdateHandle=null)};if(i<=0)this._lightingUpdateHandle=n=(0,_.Os)(r);else{const e=setTimeout(r,i);this._lightingUpdateHandle=n=(0,y.kB)((()=>clearTimeout(e)))}}_cancelLightingUpdate(){this._lightingUpdateHandle=(0,b.hw)(this._lightingUpdateHandle)}_play(){const e=this._lighting;if(null==e||!this.sunLightingEnabled||"virtual"===e.type)return;const t=e.date;if(this.dayPlaying||this.yearPlaying){const i=Date.now()-(this._lastTime??0);if(this.dayPlaying){this._lastTime=Date.now();const n=function(e,t,i){const n=12e5,r=n/4,s=18e5,o=r/3*2,a=72e5;if(null==e||null==t||isNaN(e.getTime())&&isNaN(t.getTime()))return r;const l=i.getTime(),c=e.getTime(),u=t.getTime(),d=c-a/2,h=c+a/2,p=u-a/3*2,m=u+a/3;let f=r;return l>=d&&l<=h?f=l-d<=n?s-(l-d)/n*(s-o):h-l<=n/2?r-(h-l)/n*2*(r-o):o:l>=p&&l<=m?f=l-p<=n/2?r-(l-p)/n*2*(r-o):m-l<=n?s-(m-l)/n*(s-o):o:(l<c||l>u)&&(f=s),f}(this._sunrise,this._sunset,t)*this.playSpeedMultiplier/100*i;if(n>0){let i=new Date(t.getTime()+n);const r=e.displayUTCOffset??0;if(((i.getUTCHours()+r)%24+24)%24<((t.getUTCHours()+r)%24+24)%24){const e=864e5;i=new Date(t.getTime()+n-e)}e.date=i}}else if(i>1e3){this._lastTime=Date.now();const i=(t.getUTCMonth()+1)%12,n=new Date(t.getTime());n.setUTCMonth(i),e.date=n}requestAnimationFrame((()=>this._play()))}}_updateSunriseAndSunset(){const e=this._lighting;if(null==e||"virtual"===e.type||!this.sunLightingEnabled)return;const t=this.view?.camera?.position;if(null==t)return;const{latitude:i,longitude:n}=t,{date:r,displayUTCOffset:s}=e,o=function(e,t,i,n){if(null==t||null==i)return null;const r=F.S.getTimes(e,t,i),s=r.sunrise,o=r.sunset,a=(0,w.Nm)(e,n,"hours"),l=(0,w.Nm)(s,n,"hours"),c=(0,w.Nm)(o,n,"hours");if(a.getUTCDate()!==l.getUTCDate()||a.getUTCDate()!==c.getUTCDate()){const e=a.getTime()-l.getTime()>0?1:-1;s.setUTCDate(s.getUTCDate()+e),o.setUTCDate(o.getUTCDate()+e)}return{sunrise:s,sunset:o}}(r,i,n,s??0);o&&(this._sunrise=new Date(o.sunrise),this._sunset=new Date(o.sunset))}_onUserDateTimeChange(){this.emit("user-date-time-change",{})}};(0,r._)([(0,a.Cb)()],Z.prototype,"view",void 0),(0,r._)([(0,a.Cb)({type:A,nonNullable:!0})],Z.prototype,"timeSliderViewModel",void 0),(0,r._)([(0,a.Cb)()],Z.prototype,"isSupported",null),(0,r._)([(0,a.Cb)()],Z.prototype,"lightingUpdateInterval",void 0),(0,r._)([(0,a.Cb)()],Z.prototype,"utcOffset",null),(0,r._)([(0,a.Cb)({type:Date})],Z.prototype,"localDate",null),(0,r._)([(0,a.Cb)()],Z.prototype,"timeSliderPosition",null),(0,r._)([(0,a.Cb)()],Z.prototype,"directShadowsEnabled",null),(0,r._)([(0,a.Cb)()],Z.prototype,"sunLightingEnabled",null),(0,r._)([(0,a.Cb)({type:["none","day","year"],value:"none"})],Z.prototype,"playingState",null),(0,r._)([(0,a.Cb)()],Z.prototype,"dayPlaying",null),(0,r._)([(0,a.Cb)()],Z.prototype,"yearPlaying",null),(0,r._)([(0,a.Cb)()],Z.prototype,"playSpeedMultiplier",void 0),(0,r._)([(0,a.Cb)()],Z.prototype,"currentSeason",null),(0,r._)([(0,a.Cb)()],Z.prototype,"_lastTime",void 0),(0,r._)([(0,a.Cb)()],Z.prototype,"_sunrise",void 0),(0,r._)([(0,a.Cb)()],Z.prototype,"_sunset",void 0),(0,r._)([(0,a.Cb)()],Z.prototype,"_cachedLightingDateUTC",void 0),(0,r._)([(0,a.Cb)()],Z.prototype,"_cachedDisplayUTCOffset",void 0),(0,r._)([(0,a.Cb)()],Z.prototype,"_currentHemisphere",null),(0,r._)([(0,a.Cb)()],Z.prototype,"_environment",null),(0,r._)([(0,a.Cb)()],Z.prototype,"_lighting",null),(0,r._)([(0,a.Cb)()],Z.prototype,"_lightingType",null),(0,r._)([(0,a.Cb)()],Z.prototype,"_lightingDateDisplay",null),Z=(0,r._)([(0,l.j)("esri.widgets.Daylight.DaylightViewModel")],Z);const q=Z;let G=class extends O.Z{constructor(e){super(e),this.header=!0,this.playButtons=!0,this.datePicker=!0,this.timezone=!0,this.sunLightingToggle=!0,this.shadowsToggle=!0}};(0,r._)([(0,a.Cb)({type:Boolean,nonNullable:!0})],G.prototype,"header",void 0),(0,r._)([(0,a.Cb)({type:Boolean,nonNullable:!0})],G.prototype,"playButtons",void 0),(0,r._)([(0,a.Cb)({type:Boolean,nonNullable:!0})],G.prototype,"datePicker",void 0),(0,r._)([(0,a.Cb)({type:Boolean,nonNullable:!0})],G.prototype,"timezone",void 0),(0,r._)([(0,a.Cb)({type:Boolean,nonNullable:!0})],G.prototype,"sunLightingToggle",void 0),(0,r._)([(0,a.Cb)({type:Boolean,nonNullable:!0})],G.prototype,"shadowsToggle",void 0),G=(0,r._)([(0,l.j)("esri.widgets.Daylight.VisibleElements")],G);const W=G;i(55214);var Y=i(43254),Q=i(90775),K=i(68808),J=i(24225),X=i(23039),ee=i(37964);const te={showInput:"Enter",hideInput1:"Enter",hideInput2:"Escape",hideInput3:"Tab",moveAnchorUp:"ArrowUp",moveAnchorDown:"ArrowDown",moveAnchorLeft:"ArrowLeft",moveAnchorRight:"ArrowRight",moveAnchorToMax:"End",moveAnchorToMin:"Home"},ie={labels:!1,rangeLabels:!1};let ne=class extends u.Z{constructor(e,t){super(e,t),this._activeLabelInputIndex=null,this._anchorElements=[],this._dragged=!1,this._dragStartInfo=null,this._focusedAnchorIndex=null,this._isMinInputActive=!1,this._isMaxInputActive=!1,this._lastMovedHandleIndex=null,this._positionPrecision=5,this._segmentDragStartInfo=null,this._trackHeight=null,this._trackWidth=null,this._zIndices=[],this._zIndexOffset=3,this.disabled=!1,this.draggableSegmentsEnabled=!0,this.effectiveSegmentElements=new Y.Z,this.extraNodes=[],this.inputCreatedFunction=null,this.labelElements=new Y.Z,this.labelInputsEnabled=!1,this.maxLabelElement=null,this.messages=null,this.minLabelElement=null,this.rangeLabelInputsEnabled=!1,this.segmentElements=new Y.Z,this.snapOnClickEnabled=!0,this.steps=null,this.syncedSegmentsEnabled=!1,this.thumbCreatedFunction=null,this.thumbElements=new Y.Z,this.tickElements=new Y.Z,this.trackElement=null,this.viewModel=new R,this.visibleElements={...ie},this._onAnchorPointerDown=this._onAnchorPointerDown.bind(this),this._onAnchorPointerMove=this._onAnchorPointerMove.bind(this),this._onAnchorPointerUp=this._onAnchorPointerUp.bind(this),this._onLabelPointerDown=this._onLabelPointerDown.bind(this),this._onLabelPointerUp=this._onLabelPointerUp.bind(this),this._onSegmentPointerDown=this._onSegmentPointerDown.bind(this),this._onSegmentPointerMove=this._onSegmentPointerMove.bind(this),this._onSegmentPointerUp=this._onSegmentPointerUp.bind(this),this._onTrackPointerDown=this._onTrackPointerDown.bind(this),this._onTrackPointerMove=this._onTrackPointerMove.bind(this),this._onTrackPointerUp=this._onTrackPointerUp.bind(this)}destroy(){document.removeEventListener("pointerup",this._onLabelPointerUp),document.removeEventListener("pointermove",this._onLabelPointerMove),document.removeEventListener("pointerup",this._onAnchorPointerUp),document.removeEventListener("pointermove",this._onAnchorPointerMove),this.labelElements.removeAll(),this.labelElements.destroy(),this.segmentElements.removeAll(),this.segmentElements.destroy(),this.effectiveSegmentElements.removeAll(),this.effectiveSegmentElements.destroy(),this.thumbElements.removeAll(),this.thumbElements.destroy(),this.tickElements.removeAll(),this.tickElements.destroy()}get _isDisabled(){return this.disabled||"disabled"===this.state}get effectiveMax(){return this.viewModel.effectiveMax}set effectiveMax(e){this.viewModel.effectiveMax=e}get effectiveMin(){return this.viewModel.effectiveMin}set effectiveMin(e){this.viewModel.effectiveMin=e}get inputFormatFunction(){return this.viewModel.inputFormatFunction}set inputFormatFunction(e){this.viewModel.inputFormatFunction=e}get inputParseFunction(){return this.viewModel.inputParseFunction}set inputParseFunction(e){this.viewModel.inputParseFunction=e}get icon(){return"caret-double-horizontal"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get labelFormatFunction(){return this.viewModel.labelFormatFunction}set labelFormatFunction(e){this.viewModel.labelFormatFunction=e}get labels(){return this.viewModel.labels}set layout(e){["vertical","vertical-reversed","horizontal","horizontal-reversed"].includes(e)||(e="horizontal"),this._set("layout",e)}get max(){return this.viewModel.max}set max(e){this.viewModel.max=e}get min(){return this.viewModel.min}set min(e){this.viewModel.min=e}get precision(){return this.viewModel.precision}set precision(e){this.viewModel.precision=e}get state(){const{_activeLabelInputIndex:e,_isMaxInputActive:t,_isMinInputActive:i,_dragStartInfo:n,_segmentDragStartInfo:r,disabled:s,viewModel:o}=this;return s?"disabled":null!==e||t||i?"editing":null!=n||null!=r?"dragging":o.state}get thumbsConstrained(){return this.viewModel.thumbsConstrained}set thumbsConstrained(e){this.viewModel.thumbsConstrained=e}set tickConfigs(e){this._set("tickConfigs",e),this.scheduleRender()}get values(){return this.viewModel.values}set values(e){this.viewModel.values=e}castVisibleElements(e){return{...ie,...e}}render(){const{label:e}=this,t=this.classes(V.base,z.z.widget,this._isHorizontalLayout()?V.horizontalLayout:V.verticalLayout,this._isReversedLayout()?V.reversed:null,this._isDisabled?z.z.disabled:null);return this._storeTrackDimensions(),(0,X.u)("div",{afterCreate:this._afterContainerCreate,"aria-label":e,bind:this,class:t,"touch-action":"none"},this._renderContent())}toNextStep(e){this._toStep(e,1)}toPreviousStep(e){this._toStep(e,-1)}getCurrentPosition(){return this._positionFromValue(this.values?.[0]??0)}_renderContent(){const{max:e,min:t}=this;if(!(null==t||null==e||t>=e))return[this._renderMin(),this._renderSliderContainer(),this._renderMax()]}_renderSliderContainer(){return(0,X.u)("div",{bind:this,class:V.contentElement,key:"slider-container"},this._renderTrackElement(),this._renderTicksContainer(),this._renderExtraContentElements())}_renderTrackElement(){return(0,X.u)("div",{afterCreate:this._afterTrackCreate,afterRemoved:this._afterTrackRemoved,bind:this,class:V.trackElement,"touch-action":"none"},this._renderEffectiveSegmentElements(),this._renderSegmentElements(),this._renderAnchorElements())}_renderEffectiveSegmentElements(){if(!this.trackElement||!this.values?.length)return;const e=null!=this.effectiveMax,t=null!=this.effectiveMin;if(!e&&!t)return;const{max:i,min:n,viewModel:r}=this,s=r.getBounds(),o=[];return t&&o.push(this._renderEffectiveSegmentElement(n,s.min,!0)),e&&o.push(this._renderEffectiveSegmentElement(s.max,i,!1)),o}_renderSegmentElements(){if(!this.trackElement||!this.values?.length)return;const e=this.values.length,t=[];for(let i=0;i<=e;i++)t.push(this._renderSegmentElement(i));return t}_renderSegmentElement(e){const{_trackHeight:t,_trackWidth:i,draggableSegmentsEnabled:n,id:r,state:s}=this,o=this.values,a=this._isHorizontalLayout(),l=a?i:t,c=this.viewModel.getBounds(),u=this._positionFromValue(c.max),d=this._positionFromValue(c.min),h=e===o?.length?null:e,p=0===e?null:e-1,m=null!=h,f=null!=p;let v,g;const y=[...o].sort(((e,t)=>e-t));this._isReversedLayout()?(v=f?this._positionFromValue(y[p]):d,g=m?this._positionFromValue(y[h]):u):(v=m?this._positionFromValue(y[h]):u,g=f?this._positionFromValue(y[p]):d);const b=this._applyPrecisionToPosition(100*g/l),_=(v-g)/l,w=a?`transform: translate(${b}%, 0px) scale(${_}, 1);`:`transform: translate(0px, ${b}%) scale(1, ${_});`,C=this.classes(V.segmentElement,V.segmentElementIndexPrefix+e,n&&m&&f&&"disabled"!==s?V.segmentElementInteractive:null);return(0,X.u)("div",{afterCreate:this._afterSegmentCreate,afterRemoved:this._afterSegmentRemoved,bind:this,class:C,"data-max-thumb-index":h,"data-min-thumb-index":p,"data-segment-index":e,key:`${r}-segment-${e}`,style:w,"touch-action":"none"})}_renderEffectiveSegmentElement(e,t,i){const{_trackHeight:n,_trackWidth:r,layout:s}=this,o=this._positionFromValue(e),a=this._positionFromValue(t),l=this._isHorizontalLayout(),c=l?r:n,u=this._applyPrecisionToPosition(100*o/c);let d=null;if("horizontal"===s){const e=i?c-a:a,t=o===c?0:u;d=`clip-path: inset(0% ${a===c?0:this._applyPrecisionToPosition(e/c*100)}% 0% ${t}%);`}else{const e=(a-o)/c;d=l?`transform: translate(${u}%, 0px) scale(${e}, 1);`:`transform: translate(0px, ${u}%) scale(1, ${e});`}const h=i?V.effectiveMinSegmentElement:V.effectiveMaxSegmentElement,p=this.classes(V.segmentElement,V.effectiveSegmentElement,h);return(0,X.u)("div",{afterCreate:this._afterEffectiveSegmentCreate,afterRemoved:this._afterEffectiveSegmentRemoved,bind:this,class:p,style:d,"touch-action":"none"})}_renderAnchorElements(){const{trackElement:e,values:t}=this;if(t?.length)return this._zIndices=t.map(((e,i)=>{const n=this._positionFromValue(e),r=this._positionToPercent(n),s=(this._isHorizontalLayout()?r>50:r<50)?-1:1;return this._zIndexOffset+(t.length+s*i)})),e&&t&&t.length?t.map(((e,t)=>this._renderAnchorElement(e,t))):null}_renderAnchorElement(e,t){const i=this._positionFromValue(e),n=this._valueFromPosition(i);if(null==n||isNaN(n))return;const{_dragStartInfo:r,_lastMovedHandleIndex:s,id:o,layout:a,visibleElements:{labels:l}}=this,c=this.values,u=r&&r.index===t,d=s===t,h=this.classes(V.anchorElement,V.anchorElementIndexPrefix+t,u?V.movingAnchorElement:null,d?V.lastMovedAnchorElement:null),p=this.labels.values[t],m=this._getStyleForAnchor(e,t,u||d),{min:f,max:v}=this.viewModel.getBoundsForValueAtIndex(t),{disabled:g,messages:y}=this,b=2===c.length?(0,ee.n)(0===t?y.rangeMinimum:y.rangeMaximum,{value:e}):p,_=1===c.length?null:0===t?`${o}-handle-${t+1}`:t===c.length-1?`${o}-handle-${t-1}`:`${o}-handle-${t-1} ${o}-handle-${t+1}`;return(0,X.u)("div",{afterCreate:this._afterAnchorCreate,afterRemoved:this._afterAnchorRemoved,afterUpdate:this._afterAnchorUpdate,"aria-controls":_,"aria-label":y.sliderValue,"aria-labelledby":l?`${o}-label-${t}`:null,"aria-orientation":a,"aria-valuemax":v?.toString(),"aria-valuemin":f?.toString(),"aria-valuenow":e.toString(),"aria-valuetext":b,bind:this,class:h,"data-thumb-index":t,"data-value":e,id:`${o}-handle-${t}`,key:`${o}-handle-${t}`,onkeydown:this._onAnchorKeyDown,role:"slider",style:m,tabIndex:g?-1:0,"touch-action":"none"},(0,X.u)("span",{afterCreate:this._afterThumbCreate,afterRemoved:this._afterThumbRemoved,bind:this,class:V.thumbElement,"data-thumb-index":t,"touch-action":"none"}),this.renderThumbLabel(t))}renderThumbLabel(e){const{id:t,labels:i,labelInputsEnabled:n,state:r}=this,s=this.visibleElements.labels,o=i.values[e],a=this.classes(V.labelElement,s?null:z.z.hidden,n&&"disabled"!==r?V.labelElementInteractive:null);return(0,X.u)("span",{afterCreate:this._afterLabelCreate,afterRemoved:this._afterLabelRemoved,"aria-hidden":(!s).toString(),bind:this,class:a,"data-thumb-index":e,id:`${t}-label-${e}`,key:`${t}-label-${e}`,role:n?"button":void 0,"touch-action":"none"},this._activeLabelInputIndex===e?this._renderValueInput(e):o)}_renderValueInput(e){const{disabled:t,values:i}=this;if(null==i)return;const n=i[e];return(0,X.u)("input",{afterCreate:this._afterInputCreate,"aria-label":this.messages.sliderValue,bind:this,class:V.labelInput,"data-input-index":e,"data-input-type":"thumb",key:`value-input-${e}`,onblur:this._onLabelInputBlur,onkeydown:this._onInputKeyDown,required:!0,tabIndex:t?-1:0,type:"text",value:this._formatInputValue(n,"value",e)})}_renderMax(){const{_isMaxInputActive:e,labels:t,rangeLabelInputsEnabled:i,state:n}=this,r=this.visibleElements.rangeLabels,s=this.classes(V.maxElement,{[z.z.hidden]:!r,[V.maxElementInteractive]:i&&"disabled"!==n,[V.rangeElementActive]:e});return(0,X.u)("div",{afterCreate:this._afterMaxLabelCreate,"aria-hidden":(!r).toString(),bind:this,class:s,onclick:this._onMaxLabelClick,onkeydown:this._onMaxLabelKeyDown,role:i?"button":void 0,tabIndex:!this.disabled&&i?0:-1},e?this._renderMaxInput():t.max)}_renderMin(){const{_isMinInputActive:e,labels:t,rangeLabelInputsEnabled:i,state:n}=this,r=this.visibleElements.rangeLabels,s=this.classes(V.minElement,{[z.z.hidden]:!r,[V.minElementInteractive]:i&&"disabled"!==n,[V.rangeElementActive]:e});return(0,X.u)("div",{afterCreate:this._afterMinLabelCreate,"aria-hidden":(!r).toString(),bind:this,class:s,onclick:this._onMinLabelClick,onkeydown:this._onMinLabelKeyDown,role:i?"button":void 0,tabIndex:!this.disabled&&i?0:-1},e?this._renderMinInput():t.min)}_renderMaxInput(){return(0,X.u)("input",{afterCreate:this._afterInputCreate,"aria-label":this.messages.maximumValue,bind:this,class:V.rangeInput,"data-input-type":"max",onblur:this._onMaxInputBlur,onkeydown:this._onInputKeyDown,required:!0,tabIndex:this.disabled?-1:0,type:"text",value:this._formatInputValue(this.max,"max")})}_renderMinInput(){return(0,X.u)("input",{afterCreate:this._afterInputCreate,"aria-label":this.messages.minimumValue,bind:this,class:V.rangeInput,"data-input-type":"min",onblur:this._onMinInputBlur,onkeydown:this._onInputKeyDown,required:!0,tabIndex:this.disabled?-1:0,type:"text",value:this._formatInputValue(this.min,"min")})}_renderExtraContentElements(){return(0,X.u)("div",{bind:this,class:V.extraContentElement},this.extraNodes)}_renderTicksContainer(){if(this.tickConfigs&&this.trackElement&&(0!==this._trackHeight||0!==this._trackWidth))return this.tickConfigs.map(((e,t)=>(0,X.u)("div",{class:this.classes(V.ticksContainerElement),key:"ticks-container"},this._renderTicks(e,t))))}_renderTicks(e,t){const{mode:i,values:n}=e;if(this.tickElements.at(t)||this.tickElements.add(new Y.Z,t),"position"===i){const i=Array.isArray(n)?n:[n];return this._calculateTickPositions(i).map(((i,n)=>this._renderTickGroup(e,n,t,i)))}if("percent"===i&&Array.isArray(n)){const i=this.min??0,r=(this.max??0)-i,s=n.map((e=>this._applyPrecisionToPosition(e/100*r+i)));return this._calculateTickPositions(s).map(((i,n)=>this._renderTickGroup(e,n,t,i)))}const r=Array.isArray(n)&&n.length?n[0]:isNaN(n)?null:n,s=this._getTickCounts(r,e);return this._calculateEquidistantTickPositions(s).map(((i,n)=>this._renderTickGroup(e,n,t,i)))}_renderTickGroup(e,t,i,n){const r="position"===e.mode?Array.isArray(e.values)?e.values[t]:e.values:this._valueFromPosition(n);if(null!=r&&!isNaN(r))return(0,X.u)("div",{afterCreate:this._afterTickGroupCreate,afterRemoved:this._afterTickGroupRemoved,bind:this,"data-config":e,"data-position":n,"data-tick-config-index":i,"data-tick-group-index":t,"data-value":r,key:`tick-group-${t}`,onclick:this._onTickGroupClick},this._renderTickLine(e,t,i,r),e.labelsVisible?this._renderTickLabel(e,t,i,r):null)}_renderTickLine(e,t,i,n){return(0,X.u)("div",{afterCreate:this._afterTickLineCreate,"aria-valuenow":n.toString(),bind:this,class:V.tickElement,"data-config":e,"data-tick-config-index":i,"data-tick-group-index":t,"data-value":n,key:`tick-label-${t}`,style:this._getPositionStyleForElement(n)})}_renderTickLabel(e,t,i,n){const r=e.labelFormatFunction?e.labelFormatFunction(n,"tick",t):this.viewModel.getLabelForValue(n,"tick",t);return(0,X.u)("div",{afterCreate:this._afterTickLabelCreate,"aria-label":r,"aria-valuenow":n.toString(),"aria-valuetext":r,bind:this,class:V.tickLabelElement,"data-config":e,"data-tick-config-index":i,"data-tick-group-index":t,"data-value":n,key:`tick-label-${t}`,style:`transform: translate(-50%); ${this._getPositionStyleForElement(n)}`},r)}_afterContainerCreate(e){this.addHandles((0,K.ib)(e,(()=>this.scheduleRender())))}_afterTrackCreate(e){this._set("trackElement",e),e.addEventListener("pointerdown",this._onTrackPointerDown),this.scheduleRender()}_afterTrackRemoved(e){e.removeEventListener("pointerdown",this._onTrackPointerDown),document.removeEventListener("pointermove",this._onTrackPointerMove),document.removeEventListener("pointerup",this._onTrackPointerUp)}_afterSegmentCreate(e){this.segmentElements.add(e),e.addEventListener("pointerdown",this._onSegmentPointerDown)}_afterSegmentRemoved(e){this.segmentElements.remove(e),e.removeEventListener("pointerdown",this._onSegmentPointerDown)}_afterEffectiveSegmentCreate(e){this.effectiveSegmentElements.add(e)}_afterEffectiveSegmentRemoved(e){this.effectiveSegmentElements.remove(e)}_afterAnchorCreate(e){if(this._anchorElements.push(e),e.addEventListener("pointerdown",this._onAnchorPointerDown),this.thumbCreatedFunction){const t=re(e),i=se(e),n=this.thumbElements.at(t),r=this.labelElements.at(t)||null;this.thumbCreatedFunction(t,i,n,r)}}_afterAnchorUpdate(e){null!=this._focusedAnchorIndex&&re(e)===this._focusedAnchorIndex&&(e.focus(),this._focusedAnchorIndex=null)}_afterAnchorRemoved(e){const t=this._anchorElements.indexOf(e,0);t>-1&&this._anchorElements.splice(t,1),e.removeEventListener("pointerdown",this._onAnchorPointerDown)}_afterThumbCreate(e){this.thumbElements.add(e)}_afterThumbRemoved(e){this.thumbElements.remove(e)}_afterLabelCreate(e){this.labelElements.add(e),e.addEventListener("pointerdown",this._onLabelPointerDown),e.addEventListener("pointerup",this._onLabelPointerUp)}_afterLabelRemoved(e){this.labelElements.remove(e),e.removeEventListener("pointerdown",this._onLabelPointerDown),e.removeEventListener("pointerup",this._onLabelPointerUp)}_afterInputCreate(e){if(e.focus(),e.select(),this.inputCreatedFunction){const t=e.getAttribute("data-input-type"),i="thumb"===t?function(e){return e?.["data-input-index"]}(e):null;this.inputCreatedFunction(e,t,i)}}_afterTickLineCreate(e){const t=oe(e),i=ae(e),n=this.tickElements.at(t),r=n.at(i);r?r.tickElement=e:n.add({groupElement:null,tickElement:e,labelElement:null},i)}_afterTickLabelCreate(e){const t=oe(e),i=ae(e),n=this.tickElements.at(t),r=n.at(i);r?r.labelElement=e:n.add({groupElement:null,labelElement:e,tickElement:null},i)}_afterTickGroupRemoved(e){const t=oe(e),i=this.tickElements.items[t],n=i?.find((t=>t.groupElement===e));n&&i.remove(n)}_afterTickGroupCreate(e){const t=le(e);if(t?.tickCreatedFunction){const i=oe(e),n=ae(e),r=se(e),s=this.tickElements?.at(i)?.at(n);if(s){s.groupElement=e;const i=s.tickElement||null,n=s.labelElement||null;t.tickCreatedFunction(r,i,n)}}}_afterMaxLabelCreate(e){this._set("maxLabelElement",e)}_afterMinLabelCreate(e){this._set("minLabelElement",e)}_onAnchorKeyDown(e){if(this._isDisabled||"editing"===this.state)return;const{key:t,target:i}=e,n=this.values,r=re(i),s=this._anchorElements[r],o=n[r],a=[te.moveAnchorUp,te.moveAnchorDown,te.moveAnchorLeft,te.moveAnchorRight];if(t===te.showInput&&this.labelInputsEnabled)this._activeLabelInputIndex=r;else if(a.includes(t)){e.preventDefault();const{steps:i}=this,n=t===te.moveAnchorUp||t===te.moveAnchorRight?1:-1;if(null!=i)this._toStep(r,this._isReversedLayout()?-1*n:n);else{const{precision:e}=this,t=this._getPositionOfElement(s),i=this._valueFromPosition(t),o=this._isHorizontalLayout()?n:-1*n;let a;a=0===e?this._positionFromValue(i+o):1===e?this._positionFromValue(i+.1*o):t+o,this._toPosition(r,a)}const a=this.values[r];o!==a&&this._emitThumbChangeEvent({index:r,oldValue:o,value:a})}else if(t===te.moveAnchorToMax||t===te.moveAnchorToMin){e.preventDefault();const{min:i,max:n}=this._getAnchorBoundsInPixels(r),s=this._isPositionInverted()?t===te.moveAnchorToMax?i:n:t===te.moveAnchorToMin?i:n;this._toPosition(r,s);const a=this.values[r];o!==a&&this._emitThumbChangeEvent({index:r,oldValue:o,value:a})}}_onAnchorPointerDown(e){if(this._isDisabled)return;const{target:t,clientX:i,clientY:n}=e,r=re(t);null!=r&&(e.preventDefault(),this._anchorElements[r]&&this._anchorElements[r].focus(),this._storeTrackDimensions(),this._dragStartInfo={clientX:i,clientY:n,index:r,position:this._getPositionOfElement(this._anchorElements[r])},document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove))}_onAnchorPointerMove(e){if("editing"===this.state||!this._dragStartInfo)return;e.preventDefault();const{values:t,_anchorElements:i,_dragged:n,_dragStartInfo:r,_dragStartInfo:{index:s,position:o}}=this,{clientX:a,clientY:l}=e,c=n?"drag":"start",u=i[s],d=this._getPositionOfElement(u),h=this._applyPrecisionToPosition(this._isHorizontalLayout()?o+a-r.clientX:o+l-r.clientY);if(d===h)return;const p=t[s];this._dragged=!0,this._toPosition(s,h);const m=this.values[s];n?p!==m&&this._emitThumbDragEvent({index:s,state:c,value:m}):this._emitThumbDragEvent({index:s,state:c,value:p})}_onAnchorPointerUp(e){if(document.removeEventListener("pointerup",this._onAnchorPointerUp),document.removeEventListener("pointermove",this._onAnchorPointerMove),!this._dragStartInfo)return;e.preventDefault();const{index:t}=this._dragStartInfo,i=this._dragged,n=this.values[t];this._dragged=!1,this._dragStartInfo=null,this._lastMovedHandleIndex=t,i?this._emitThumbDragEvent({index:t,state:"stop",value:n}):(this.scheduleRender(),"editing"!==this.state&&this._emitThumbClickEvent({index:t,value:n}))}_onTrackPointerDown(e){const{_dragStartInfo:t,snapOnClickEnabled:i,state:n,values:r}=this;if(this._isDisabled||"editing"===n||t)return;if(document.addEventListener("pointermove",this._onTrackPointerMove),document.addEventListener("pointerup",this._onTrackPointerUp),!i||!r?.length)return;const{steps:s}=this,{clientX:o,clientY:a}=e,l=this._getCursorPositionFromEvent(e),c=this._valueFromPosition(l),u=this._getIndexOfNearestValue(c),d=r[u],h=r.some(((e,t)=>e===d&&t!==u))&&c>d?r.lastIndexOf(d):u;if(null==h)return;const p=r[h],m=null!=s?this._calculateNearestStepPosition(l):l;this._toPosition(h,m),this._dragged=!0,this._dragStartInfo={clientX:o,clientY:a,index:h,position:m},this._focusedAnchorIndex=h,this._emitThumbDragEvent({index:h,state:"start",value:p});const f=this.values[h];p!==f&&this._emitThumbDragEvent({index:h,state:"drag",value:f}),document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove)}_onTrackPointerMove(e){e.preventDefault(),this._dragged=!0}_onTrackPointerUp(e){if(e.preventDefault(),document.removeEventListener("pointermove",this._onTrackPointerMove),document.removeEventListener("pointerup",this._onTrackPointerUp),this.snapOnClickEnabled||(this._dragged=!1),!this._dragged){const t=this._getCursorPositionFromEvent(e),i=this._valueFromPosition(t);this._emitTrackClickEvent({value:i})}}_onSegmentPointerDown(e){e.preventDefault();const t=e.target,i=function(e){return e?.["data-segment-index"]}(t),n=function(e){return e?.["data-min-thumb-index"]}(t),r=function(e){return e?.["data-max-thumb-index"]}(t);if(this._isDisabled||null==n||null==r)return;e.stopPropagation(),this._storeTrackDimensions(),document.addEventListener("pointerup",this._onSegmentPointerUp);const s=this._getAnchorDetails(n),o=this._getAnchorDetails(r);this.syncedSegmentsEnabled?(this.segmentElements.forEach((e=>e.classList.add(V.segmentElementActive))),this._anchorElements.forEach((e=>e.classList.add(V.anchorElementActive)))):(this.segmentElements.at(i).classList.add(V.segmentElementActive),this._anchorElements[s.index]?.classList.add(V.anchorElementActive),this._anchorElements[o.index]?.classList.add(V.anchorElementActive)),this._segmentDragStartInfo={cursorPosition:this._getCursorPositionFromEvent(e),index:i,details:this._normalizeSegmentDetails({min:s,max:o})},this.draggableSegmentsEnabled&&(document.addEventListener("pointermove",this._onSegmentPointerMove),this._emitSegmentDragEvent({index:i,state:"start",thumbIndices:[n,r]}))}_onSegmentPointerMove(e){if(!this._segmentDragStartInfo)return;e.preventDefault();const{_trackHeight:t,_trackWidth:i,_segmentDragStartInfo:{index:n,cursorPosition:r,details:{min:s,max:o}}}=this,{index:a,position:l,value:c}=s,{index:u,position:d,value:h}=o;this._dragged=!0;const p=this._getCursorPositionFromEvent(e);if(p===r)return;const m=this._positionToPercent(r),f=this._positionToPercent(p)-m,v=this._positionToPercent(l)+f,g=this._positionToPercent(d)+f,{min:y}=this._getAnchorBoundsAsPercents(a),{max:b}=this._getAnchorBoundsAsPercents(u);let _=!1,w=!1;if(v<y?_=!0:g>b&&(w=!0),_){const{min:e,max:t}=this.viewModel.getBoundsForValueAtIndex(a),i=this._isPositionInverted()?t:e,n=i,r=h+(i-c),s=r-this.values[u];return void(this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(s):this._updateAnchorValues([a,u],[n,r]))}if(w){const{min:e,max:t}=this.viewModel.getBoundsForValueAtIndex(u),i=this._isPositionInverted()?e:t,n=i,r=c+(i-h),s=r-this.values[a];return void(this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(s):this._updateAnchorValues([a,u],[r,n]))}const C=this._isHorizontalLayout()?i:t,x=g/100*C,E=v/100*C,S=this.values,T=[S[a],S[u]],k=this._getValueForAnchorAtPosition(a,E),I=this._getValueForAnchorAtPosition(u,x);this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(k-T[0]):this._updateAnchorValues([a,u],[k,I]),[this.values[a],this.values[u]].every(((e,t)=>e===T[t]))||this._emitSegmentDragEvent({index:n,state:"drag",thumbIndices:[a,u]})}_onSegmentPointerUp(e){if(e.preventDefault(),document.removeEventListener("pointerup",this._onSegmentPointerUp),document.removeEventListener("pointermove",this._onSegmentPointerMove),!this._segmentDragStartInfo)return;const{_dragged:t}=this,i=this.min,n=this.max,r=this.values,{index:s,details:{min:{index:o},max:{index:a}}}=this._segmentDragStartInfo;if(this.segmentElements.forEach((e=>e.classList.remove(V.segmentElementActive))),this._anchorElements.forEach((e=>e.classList.remove(V.anchorElementActive))),this.draggableSegmentsEnabled){const e=n-i,t=r[o],l=r[a];this._lastMovedHandleIndex=t===l?t>e/2?o:a:null,this._dragged=!1,this._segmentDragStartInfo=null,this._emitSegmentDragEvent({index:s,state:"stop",thumbIndices:[o,a]})}if(!t){const t=this._getCursorPositionFromEvent(e),i=this._valueFromPosition(t);this._emitSegmentClickEvent({index:s,value:i,thumbIndices:[o,a]})}}_onTickGroupClick(e){const t=e.target;if(le(t)){const e=oe(t),i=ae(t),n=se(t);this._emitTickClickEvent({configIndex:e,groupIndex:i,value:n})}}_storeTrackDimensions(){if(this.trackElement){const e=this._getDimensions(this.trackElement);this._trackHeight=this._applyPrecisionToPosition(e.height),this._trackWidth=this._applyPrecisionToPosition(e.width)}}_onLabelPointerDown(){this._isDisabled||(this._dragged=!1,document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove))}_onLabelPointerMove(){this._isDisabled||(this._dragged=!0)}_onLabelPointerUp(e){if(this._isDisabled)return;const t=re(e.target);this.labelInputsEnabled&&!this._dragged&&null!=t&&(this._activeLabelInputIndex=t),this._dragged=!1,document.removeEventListener("pointerup",this._onLabelPointerUp),document.removeEventListener("pointermove",this._onLabelPointerMove)}_onLabelInputBlur(e){const{_activeLabelInputIndex:t,values:i,viewModel:n}=this,r=e.target.value;if(this._activeLabelInputIndex=null,!r||null==t||null==i)return;const s=this._parseInputValue(r,"value",t),o=i[t],{min:a,max:l}=this.viewModel.getBoundsForValueAtIndex(t);if(s<a||s>l)return;n.setValue(t,s);const c=this.values[t];o!==c&&this._emitThumbChangeEvent({index:t,oldValue:o,value:c})}_onInputKeyDown(e){if(this._isDisabled)return;const{key:t,target:i}=e,{hideInput1:n,hideInput2:r,hideInput3:s}=te,{_activeLabelInputIndex:o,_anchorElements:a}=this,l=i;if(t===n||t===r||t===s){e.stopPropagation();const t=o;l.blur(),null!=t?a[t].focus():l.parentElement?.focus()}}_onMaxLabelClick(){this._isDisabled||(this._emitMaxRangeLabelClickEvent({type:"max-click",value:this.max}),this.rangeLabelInputsEnabled&&(this._isMaxInputActive=!0))}_onMaxLabelKeyDown({key:e}){this._isDisabled||e!==te.showInput||(this._isMaxInputActive=!0)}_onMaxInputBlur(e){const t=e.target.value;if(this._isMaxInputActive=!1,!t)return;const i=this.max,n=this._parseInputValue(t,"max");n<=this.min||(this.viewModel.set("max",n),this.max!==i&&this._emitMaxChangeEvent({oldValue:i,value:this.max}))}_onMinLabelClick(){this._isDisabled||(this._emitMinRangeLabelClickEvent({type:"min-click",value:this.min}),this.rangeLabelInputsEnabled&&(this._isMinInputActive=!0))}_onMinLabelKeyDown({key:e}){this._isDisabled||e!==te.showInput||(this._isMinInputActive=!0)}_onMinInputBlur(e){const t=e.target.value;if(this._isMinInputActive=!1,!t)return;const i=this.min,n=this._parseInputValue(t,"min");n>=this.max||(this.viewModel.set("min",n),this.min!==i&&this._emitMinChangeEvent({oldValue:i,value:this.min}))}_positionFromValue(e){const{_trackHeight:t,_trackWidth:i}=this,n=this.min??0,r=this.max??0,s=r-n;if(0===s||null==e)return 0;const o=this._isHorizontalLayout();let a=o?this._applyPrecisionToPosition(i*(e-n)/s):this._applyPrecisionToPosition(t*(r-e)/s);return this._isReversedLayout()&&(a=o?i-a:t-a),a}_valueFromPosition(e){const{_trackHeight:t,_trackWidth:i,precision:n}=this,r=this.min??0,s=this.max??0,o=s-r;let a=this._isHorizontalLayout()?e*o/i+r:o*(1e3-e/t*1e3)/1e3+r;return this._isReversedLayout()&&(a=s+r-a),parseFloat(a.toFixed(n))}_positionToPercent(e){const{_trackHeight:t,_trackWidth:i}=this,n=100*e/(this._isHorizontalLayout()?i:t);return this._applyPrecisionToPosition(n)}_applyPrecisionToPosition(e){return parseFloat(e.toFixed(this._positionPrecision))}_isPositionInverted(){const{layout:e}=this;return"horizontal-reversed"===e||"vertical"===e}_isHorizontalLayout(){return this.layout.includes("horizontal")}_isReversedLayout(){return this.layout.includes("reversed")}_normalizeSegmentDetails(e){if(this._isPositionInverted()){const{min:t,max:i}=e;return{min:i,max:t}}return e}_parseInputValue(e,t,i){return this.inputParseFunction?this.inputParseFunction(e,t,i):this.viewModel.defaultInputParseFunction(e)}_formatInputValue(e,t,i){return this.inputFormatFunction?this.inputFormatFunction(e,t,i):this.viewModel.defaultInputFormatFunction(e)}_getAnchorDetails(e){const t=this.values,i=[...t].sort(((e,t)=>e-t))[e],n=t.indexOf(i);return{index:n,position:this._getPositionOfElement(this._anchorElements[n]),value:i}}_updateAnchorStyle(e,t){const i=this._anchorElements[e];i&&(this._isHorizontalLayout()?i.style.left=`${t}`:i.style.top=`${t}`)}_getStyleForAnchor(e,t,i){const n=this._getPositionStyleForElement(e);if(1===this.values?.length)return`${n}`;const r=this._zIndices[t];return`${n}; z-index: ${i?this._zIndexOffset+r:r}`}_getPositionStyleForElement(e){const t=this._positionFromValue(e),i=this._positionToPercent(t);return`${this._isHorizontalLayout()?"left":"top"}: ${i}%`}_getPositionOfElement(e){const t=this._getDimensions(e.offsetParent),i=this._getDimensions(e);return this._isHorizontalLayout()?this._applyPrecisionToPosition(i.left-t.left):this._applyPrecisionToPosition(i.top-t.top)}_updateAnchorValues(e,t){e.forEach(((e,i)=>this._toValue(e,t[i])))}_updateAnchorValuesByDifference(e){const{min:t,max:i,values:n}=this;n?.forEach(((n,r)=>this._toValue(r,Math.max(Math.min(n+e,i),t))))}_toValue(e,t){null!=this.steps&&(t=this._getStepValues()[this._getIndexOfNearestStepValue(t)]),this._updateAnchorStyle(e,this._getPositionStyleForElement(t)),this.viewModel.setValue(e,t)}_toPosition(e,t){const i=null!=this.steps?this._getStepValueForAnchorAtPosition(e,t):this._getValueForAnchorAtPosition(e,t);this._updateAnchorStyle(e,this._getPositionStyleForElement(i)),this.viewModel.setValue(e,i)}_getValueForAnchorAtPosition(e,t){const{min:i,max:n}=this._getAnchorBoundsInPixels(e),{min:r,max:s}=this.viewModel.getBoundsForValueAtIndex(e);let o,a,l=null;return this._isPositionInverted()?(o=r,a=s):(o=s,a=r),l=t>n?o:t<i?a:this._valueFromPosition(t),l>s?l=s:l<r&&(l=r),l}_getStepValueForAnchorAtPosition(e,t){const i=this._getStepValues(),n=this._calculateNearestStepPosition(t),r=this._getValueForAnchorAtPosition(e,n);return i[this._getIndexOfNearestStepValue(r)]}_getAnchorBoundsAsPercents(e){const{min:t,max:i}=this._getAnchorBoundsInPixels(e);return{min:this._positionToPercent(t),max:this._positionToPercent(i)}}_getAnchorBoundsInPixels(e){const{_anchorElements:t,_trackHeight:i,_trackWidth:n,effectiveMax:r,effectiveMin:s,thumbsConstrained:o}=this,a=t[e-1],l=t[e+1],c=this._isHorizontalLayout()?n:i;let u,d;return this._isPositionInverted()?(u=null!=s?this._positionFromValue(s):c,d=null!=r?this._positionFromValue(r):0):(u=null!=r?this._positionFromValue(r):c,d=null!=s?this._positionFromValue(s):0),o?this._isPositionInverted()?{max:a?this._getPositionOfElement(a):u,min:l?this._getPositionOfElement(l):d}:{max:l?this._getPositionOfElement(l):u,min:a?this._getPositionOfElement(a):d}:{max:u,min:d}}_getIndexOfNearestValue(e){const t=this.values;return t.indexOf(t.reduce(((t,i)=>Math.abs(i-e)<Math.abs(t-e)?i:t)))}_getCursorPositionFromEvent(e){const t=this._getDimensions(this.trackElement);return this._isHorizontalLayout()?this._applyPrecisionToPosition(e.clientX-t.left):this._applyPrecisionToPosition(e.clientY-t.top)}_getStepValues(){const{steps:e}=this;if(Array.isArray(e))return e;const{max:t,min:i}=this;if(null==i||null==t||null==e)return[];const n=Math.ceil((t-i)/e),r=[];for(let s=0;s<=n;s++){const n=i+e*s;r.push(n>t?t:n)}return r}_toStep(e,t){const i=this.values[e],n=this._getStepValues(),r=n.indexOf(i);let s=null;if(r>-1){let i=n[r+t];isNaN(i)&&(i=n[r]);const o=this._positionFromValue(i);s=this._getStepValueForAnchorAtPosition(e,o)}else s=n[this._getIndexOfNearestStepValue(i)+t];this.viewModel.setValue(e,s)}_getIndexOfNearestStepValue(e){const{steps:t}=this;if(null==t)return null;const i=this._getStepValues(),n=i.reduce(((t,i)=>Math.abs(i-e)<Math.abs(t-e)?i:t));return i.indexOf(n)}_calculateNearestStepPosition(e){const t=this._valueFromPosition(e),i=this._getIndexOfNearestStepValue(t),n=this._getStepValues();return this._positionFromValue(n[i])}_getTickCounts(e,t){const{mode:i}=t;return"count"===i||"position"===i?e||0:"percent"===i&&100/e||0}_calculateTickPositions(e){return e.map((e=>this._positionFromValue(e)))}_calculateEquidistantTickPositions(e){const{_trackWidth:t,_trackHeight:i}=this,n=this._isHorizontalLayout()?t:i,r=n/(e-1),s=[];if(1===e)return[n/2];for(let t=0;t<e;t++){const e=t*r;e<=n&&s.push(e)}return s}_getDimensions(e){try{return(0,b.O3)(e),e.getBoundingClientRect()}catch(e){if("object"==typeof e&&null!==e)return new DOMRect(0,0,0,0);throw e}}_emitTrackClickEvent(e){this.emit("track-click",{...e,type:"track-click"})}_emitTickClickEvent(e){this.emit("tick-click",{...e,type:"tick-click"})}_emitMaxChangeEvent(e){this.emit("max-change",{...e,type:"max-change"})}_emitMinChangeEvent(e){this.emit("min-change",{...e,type:"min-change"})}_emitThumbChangeEvent(e){this.emit("thumb-change",{...e,type:"thumb-change"})}_emitThumbClickEvent(e){this.emit("thumb-click",{...e,type:"thumb-click"})}_emitThumbDragEvent(e){this.emit("thumb-drag",{...e,type:"thumb-drag"})}_emitSegmentClickEvent(e){this.emit("segment-click",{...e,type:"segment-click"})}_emitSegmentDragEvent(e){this.emit("segment-drag",{...e,type:"segment-drag"})}_emitMinRangeLabelClickEvent(e){this.emit("min-click",e)}_emitMaxRangeLabelClickEvent(e){this.emit("min-click",e)}};function re(e){return e?.["data-thumb-index"]}function se(e){return e?.["data-value"]}function oe(e){return e?.["data-tick-config-index"]}function ae(e){return e?.["data-tick-group-index"]}function le(e){return e?.["data-config"]}(0,r._)([(0,a.Cb)()],ne.prototype,"_activeLabelInputIndex",void 0),(0,r._)([(0,a.Cb)()],ne.prototype,"_dragStartInfo",void 0),(0,r._)([(0,a.Cb)()],ne.prototype,"_isMinInputActive",void 0),(0,r._)([(0,a.Cb)()],ne.prototype,"_isMaxInputActive",void 0),(0,r._)([(0,a.Cb)()],ne.prototype,"_segmentDragStartInfo",void 0),(0,r._)([(0,a.Cb)({readOnly:!0})],ne.prototype,"_isDisabled",null),(0,r._)([(0,a.Cb)()],ne.prototype,"disabled",void 0),(0,r._)([(0,a.Cb)()],ne.prototype,"draggableSegmentsEnabled",void 0),(0,r._)([(0,a.Cb)()],ne.prototype,"effectiveMax",null),(0,r._)([(0,a.Cb)()],ne.prototype,"effectiveMin",null),(0,r._)([(0,a.Cb)({readOnly:!0})],ne.prototype,"effectiveSegmentElements",void 0),(0,r._)([(0,a.Cb)()],ne.prototype,"extraNodes",void 0),(0,r._)([(0,a.Cb)()],ne.prototype,"inputCreatedFunction",void 0),(0,r._)([(0,a.Cb)()],ne.prototype,"inputFormatFunction",null),(0,r._)([(0,a.Cb)()],ne.prototype,"inputParseFunction",null),(0,r._)([(0,a.Cb)()],ne.prototype,"icon",null),(0,r._)([(0,a.Cb)()],ne.prototype,"label",null),(0,r._)([(0,a.Cb)({readOnly:!0})],ne.prototype,"labelElements",void 0),(0,r._)([(0,a.Cb)()],ne.prototype,"labelInputsEnabled",void 0),(0,r._)([(0,a.Cb)()],ne.prototype,"labelFormatFunction",null),(0,r._)([(0,a.Cb)({readOnly:!0})],ne.prototype,"labels",null),(0,r._)([(0,a.Cb)({value:"horizontal"})],ne.prototype,"layout",null),(0,r._)([(0,a.Cb)()],ne.prototype,"max",null),(0,r._)([(0,a.Cb)({readOnly:!0})],ne.prototype,"maxLabelElement",void 0),(0,r._)([(0,a.Cb)(),(0,J.H)("esri/widgets/Slider/t9n/Slider")],ne.prototype,"messages",void 0),(0,r._)([(0,a.Cb)()],ne.prototype,"min",null),(0,r._)([(0,a.Cb)({readOnly:!0})],ne.prototype,"minLabelElement",void 0),(0,r._)([(0,a.Cb)()],ne.prototype,"precision",null),(0,r._)([(0,a.Cb)()],ne.prototype,"rangeLabelInputsEnabled",void 0),(0,r._)([(0,a.Cb)({readOnly:!0})],ne.prototype,"segmentElements",void 0),(0,r._)([(0,a.Cb)()],ne.prototype,"snapOnClickEnabled",void 0),(0,r._)([(0,a.Cb)({readOnly:!0})],ne.prototype,"state",null),(0,r._)([(0,a.Cb)()],ne.prototype,"steps",void 0),(0,r._)([(0,a.Cb)()],ne.prototype,"syncedSegmentsEnabled",void 0),(0,r._)([(0,a.Cb)()],ne.prototype,"thumbsConstrained",null),(0,r._)([(0,a.Cb)()],ne.prototype,"thumbCreatedFunction",void 0),(0,r._)([(0,a.Cb)({readOnly:!0})],ne.prototype,"thumbElements",void 0),(0,r._)([(0,a.Cb)()],ne.prototype,"tickConfigs",null),(0,r._)([(0,a.Cb)({readOnly:!0})],ne.prototype,"tickElements",void 0),(0,r._)([(0,a.Cb)({readOnly:!0})],ne.prototype,"trackElement",void 0),(0,r._)([(0,a.Cb)()],ne.prototype,"values",null),(0,r._)([(0,a.Cb)({type:R})],ne.prototype,"viewModel",void 0),(0,r._)([(0,a.Cb)()],ne.prototype,"visibleElements",void 0),(0,r._)([(0,Q.p)("visibleElements")],ne.prototype,"castVisibleElements",null),ne=(0,r._)([(0,l.j)("esri.widgets.Slider")],ne);const ce=ne;var ue=i(84644);const de="esri-timezone-picker",he={base:de,trigger:`${de}__trigger`,itemTitle:`${de}__item-title`,itemDescription:`${de}__item_description`};let pe=class extends u.Z{constructor(e,t){super(e,t),this.disabled=!1,this.value=null,this.onChange=null,this.open=!1,this.onOpen=null,this.onClose=null,this._selectedId=null,this._onOpen=()=>{this.open=!0,this.onOpen?.()},this._onClose=()=>{this.open=!1,this.onClose?.()},this._killEvent=e=>(e.stopPropagation(),!0),this._onChange=e=>{const t=e.target.selectedItems?.[0].getAttribute("data-id"),i=me(this._gmtOffsets,t)?.utcOffset;null!=i&&(this._selectedId=t,this.onChange?.(i))}}loadDependencies(){return(0,ue.h)({button:()=>Promise.resolve().then(i.bind(i,61637)),dropdown:()=>Promise.resolve().then(i.bind(i,54027)),"dropdown-group":()=>Promise.resolve().then(i.bind(i,64367)),"dropdown-item":()=>Promise.resolve().then(i.bind(i,97325))})}render(){const e=this._messages;if(!e)return(0,X.u)("div",{class:he.base,key:"empty"});const t=this._selectedItem,i=fe(t);return(0,X.u)("div",{class:he.base,key:"container",onpointerdown:this._killEvent},(0,X.u)("calcite-dropdown",{disabled:this.disabled,open:this.open,overlayPositioning:"fixed",placement:"bottom-end",scale:"s",onCalciteDropdownClose:this._onClose,onCalciteDropdownOpen:this._onOpen,onCalciteDropdownSelect:this._onChange},(0,X.u)("calcite-button",{appearance:"transparent",class:he.trigger,"data-testid":"timezone-picker-button",disabled:this.disabled,key:"trigger",kind:"neutral",scale:"s",slot:"trigger",title:e.chooseTimezone},t?.short??""),(0,X.u)("calcite-dropdown-group",{selectionMode:"single"},this._gmtOffsets.map((e=>{const t=fe(e);return(0,X.u)("calcite-dropdown-item",{"data-id":t,"data-testid":t,key:t,selected:i===t},(0,X.u)("div",{class:he.itemTitle,key:"title"},e.shortWithUTC),(0,X.u)("div",{class:he.itemDescription,key:"description"},e.long))})))))}get _gmtOffsets(){const e=this._messages;return e?function(e){return[{utcOffset:-12,short:"UTC-12",long:e.timezoneDateline},{utcOffset:-11,short:"UTC-11",long:e.timezoneSamoa},{utcOffset:-10,short:e.timezoneHAST,long:e.timezoneHawaii},{utcOffset:-9,short:e.timezoneAKST,long:e.timezoneAlaska},{utcOffset:-8,short:e.timezonePST,long:e.timezoneBaja},{utcOffset:-7,short:e.timezoneMST,long:e.timezoneMountain},{utcOffset:-7,short:e.timezoneMST,long:e.timezoneLaPaz},{utcOffset:-7,short:e.timezoneMST,long:e.timezoneArizona},{utcOffset:-6,short:e.timezoneCST,long:e.timezoneSaskatchewan},{utcOffset:-6,short:e.timezoneCST,long:e.timezoneCentralAmerica},{utcOffset:-6,short:e.timezoneCST,long:e.timezoneCentralTime},{utcOffset:-6,short:e.timezoneCST,long:e.timezoneMexico},{utcOffset:-5,short:e.timezoneEST,long:e.timezoneEasternUS},{utcOffset:-5,short:e.timezoneEST,long:e.timezoneLima},{utcOffset:-5,short:e.timezoneEST,long:e.timezoneIndiana},{utcOffset:-4,short:null,long:e.timezoneAtlantic},{utcOffset:-4,short:null,long:e.timezoneCuiaba},{utcOffset:-4,short:null,long:e.timezoneSantiago},{utcOffset:-4,short:null,long:e.timezoneManaus},{utcOffset:-4,short:null,long:e.timezoneAsuncion},{utcOffset:-3,short:null,long:e.timezoneBrasilia},{utcOffset:-3,short:null,long:e.timezoneGreenland},{utcOffset:-3,short:null,long:e.timezoneMontevideo},{utcOffset:-3,short:null,long:e.timezoneCayenne},{utcOffset:-3,short:null,long:e.timezoneBuenosAires},{utcOffset:-2,short:null,long:e.timezoneMidAtlantic},{utcOffset:-1,short:null,long:e.timezoneAzores},{utcOffset:-1,short:null,long:e.timezoneCaboVerde},{utcOffset:0,short:null,long:e.timezoneDublin},{utcOffset:0,short:null,long:e.timezoneReykjavik},{utcOffset:0,short:null,long:e.timezoneCasablanca},{utcOffset:1,short:e.timezoneCET,long:e.timezoneBelgrade},{utcOffset:1,short:e.timezoneCET,long:e.timezoneSarajevo},{utcOffset:1,short:e.timezoneCET,long:e.timezoneBrussels},{utcOffset:1,short:e.timezoneCET,long:e.timezoneWCAfrica},{utcOffset:1,short:e.timezoneCET,long:e.timezoneAmsterdam},{utcOffset:1,short:e.timezoneCET,long:e.timezoneWindhoek},{utcOffset:2,short:e.timezoneEET,long:e.timezoneMinsk},{utcOffset:2,short:e.timezoneEET,long:e.timezoneCairo},{utcOffset:2,short:e.timezoneEET,long:e.timezoneHelsinki},{utcOffset:2,short:e.timezoneEET,long:e.timezoneAthens},{utcOffset:2,short:e.timezoneEET,long:e.timezoneJerusalem},{utcOffset:2,short:e.timezoneEET,long:e.timezoneAmman},{utcOffset:2,short:e.timezoneEET,long:e.timezoneBeirut},{utcOffset:2,short:e.timezoneEET,long:e.timezoneHarare},{utcOffset:2,short:e.timezoneEET,long:e.timezoneDamascus},{utcOffset:2,short:e.timezoneEET,long:e.timezoneIstanbul},{utcOffset:3,short:e.timezoneMSK,long:e.timezoneKuwait},{utcOffset:3,short:e.timezoneMSK,long:e.timezoneBaghdad},{utcOffset:3,short:e.timezoneMSK,long:e.timezoneNairobi},{utcOffset:3,short:e.timezoneMSK,long:e.timezoneKaliningrad},{utcOffset:4,short:e.timezoneGST,long:e.timezoneMoscow},{utcOffset:4,short:e.timezoneGST,long:e.timezoneMuscat},{utcOffset:4,short:e.timezoneGST,long:e.timezoneBaku},{utcOffset:4,short:e.timezoneGST,long:e.timezoneYerevan},{utcOffset:4,short:e.timezoneGST,long:e.timezoneTbilisi},{utcOffset:4,short:e.timezoneGST,long:e.timezonePortLouis},{utcOffset:5,short:null,long:e.timezoneTashkent},{utcOffset:5,short:null,long:e.timezoneIslamabad},{utcOffset:6,short:null,long:e.timezoneEkaterinburg},{utcOffset:6,short:null,long:e.timezoneAstana},{utcOffset:6,short:null,long:e.timezoneDhaka},{utcOffset:7,short:e.timezoneICT,long:e.timezoneNovosibirsk},{utcOffset:7,short:e.timezoneICT,long:e.timezoneBangkok},{utcOffset:8,short:e.timezoneCCT,long:e.timezoneKrasnoyarsk},{utcOffset:8,short:e.timezoneCCT,long:e.timezoneBeijing},{utcOffset:8,short:e.timezoneCCT,long:e.timezoneSingapore},{utcOffset:8,short:e.timezoneCCT,long:e.timezoneTaipei},{utcOffset:8,short:e.timezoneCCT,long:e.timezonePerth},{utcOffset:8,short:e.timezoneCCT,long:e.timezoneUlaanbaatar},{utcOffset:9,short:e.timezoneJST,long:e.timezoneIrkutsk},{utcOffset:9,short:e.timezoneJST,long:e.timezoneSeoul},{utcOffset:9,short:e.timezoneJST,long:e.timezoneOsaka},{utcOffset:10,short:e.timezoneAEST,long:e.timezoneYakutsk},{utcOffset:10,short:e.timezoneAEST,long:e.timezoneCanberra},{utcOffset:10,short:e.timezoneAEST,long:e.timezoneBrisbane},{utcOffset:10,short:e.timezoneAEST,long:e.timezoneHobart},{utcOffset:10,short:e.timezoneAEST,long:e.timezoneGuam},{utcOffset:11,short:null,long:e.timezoneVladivostok},{utcOffset:11,short:null,long:e.timezoneSolomon},{utcOffset:12,short:e.timezoneNZST,long:e.timezoneMagadan},{utcOffset:12,short:e.timezoneNZST,long:e.timezoneFiji},{utcOffset:12,short:e.timezoneNZST,long:e.timezoneAuckland},{utcOffset:12,short:e.timezoneNZST,long:e.timezoneNukualofa}].map((({utcOffset:e,short:t,long:i})=>{const n=e>0?`UTC+${e}`:e<0?`UTC${e}`:"GMT";return t?{utcOffset:e,short:t,shortWithUTC:`${n} (${t})`,long:i}:{utcOffset:e,short:n,shortWithUTC:n,long:i}}))}(e):[]}get _selectedItem(){const e=this._gmtOffsets,t=this.value,i=me(e,this._selectedId);return i?.utcOffset===t?i:function(e,t){return e.find((e=>e.utcOffset===t))}(e,t)}};function me(e,t){return e.find((e=>fe(e)===t))}function fe(e){return e?`${e.utcOffset}-${e.long}`:void 0}(0,r._)([(0,a.Cb)()],pe.prototype,"disabled",void 0),(0,r._)([(0,a.Cb)()],pe.prototype,"value",void 0),(0,r._)([(0,a.Cb)()],pe.prototype,"onChange",void 0),(0,r._)([(0,a.Cb)()],pe.prototype,"open",void 0),(0,r._)([(0,a.Cb)()],pe.prototype,"onOpen",void 0),(0,r._)([(0,a.Cb)()],pe.prototype,"onClose",void 0),(0,r._)([(0,a.Cb)(),(0,J.H)("esri/widgets/support/t9n/timezone")],pe.prototype,"_messages",void 0),(0,r._)([(0,a.Cb)()],pe.prototype,"_gmtOffsets",null),(0,r._)([(0,a.Cb)()],pe.prototype,"_selectedItem",null),(0,r._)([(0,a.Cb)()],pe.prototype,"_selectedId",void 0),pe=(0,r._)([(0,l.j)("esri.widgets.support.TimezonePicker")],pe);const ve="esri-slider-with-dropdown",ge="esri-slider__label",ye=`${ve}__box`,be=`${ve}__box--drop-down-on`,_e=`${ve}__box--drop-down-off`;let we=class extends ce{constructor(e,t){super(e,t),this.viewModel=new A,this.showDropDown=!0,this._labelWidth=0,this._onLabelAfterCreate=e=>{const t="label-size-observer";this.removeHandles(t),this.addHandles((0,K.ib)(e,(({contentRect:e})=>{this._labelWidth=e.width})),t)},this._getLabelStyles=()=>{if(!this.trackElement)return;const e=this._trackWidth,t=this._labelWidth/2,i=this.getCurrentPosition(),n=i-t,r=i+t;let s=-t;return n<0?s+=-n:r>e&&(s+=e-r),{left:`${s}px`}},this._onTimezoneChange=e=>{this.viewModel.utcOffset=e},this._onTimezonePickerOpen=()=>{this.viewModel.timezonePickerOpen=!0},this._onTimezonePickerClose=()=>{this.viewModel.timezonePickerOpen=!1}}renderThumbLabel(e){const{showDropDown:t,viewModel:i}=this;return(0,X.u)("div",{afterCreate:this._onLabelAfterCreate,class:this.classes({[ye]:!0,[ge]:!0,[be]:t,[_e]:!t}),key:"thumb-label",styles:this._getLabelStyles()},super.renderThumbLabel(e),t?(0,X.u)(pe,{disabled:this.disabled,open:i.timezonePickerOpen,value:i.utcOffset,onChange:this._onTimezoneChange,onClose:this._onTimezonePickerClose,onOpen:this._onTimezonePickerOpen}):null)}};(0,r._)([(0,a.Cb)()],we.prototype,"viewModel",void 0),(0,r._)([(0,a.Cb)()],we.prototype,"showDropDown",void 0),(0,r._)([(0,a.Cb)()],we.prototype,"_labelWidth",void 0),we=(0,r._)([(0,l.j)("esri.widgets.Daylight.support.SliderWithDropdown")],we);const Ce=we;var xe=i(79691),Ee=i(29629);const Se="date";let Te=class extends u.Z{constructor(e,t){super(e,t),this.headingLevel=3,this.viewModel=new q,this.visibleElements=new W,this.dateOrSeason=Se,this._timeSlider=new Ce({viewModel:this.viewModel.timeSliderViewModel,steps:this.timeSliderSteps,labelInputsEnabled:!1,visibleElements:{labels:!0},tickConfigs:[{mode:"position",values:[0,360,720,1080,1439],labelsVisible:!0,tickCreatedFunction:(e,t,i)=>function({tickElement:e,labelElement:t,tickClasses:i=[],onClick:n}){e&&t&&(e.classList.add(...i,z.z.primaryTick),t.classList.add(...i,z.z.primaryTickLabel),j(t),n&&(t.onclick=e.onclick=()=>n()))}({tickElement:t,labelElement:i,tickClasses:ke,onClick:this._makeGoToTime(e)})},{mode:"position",values:[120,240,480,600,840,960,1200,1320],tickCreatedFunction:(e,t)=>function({tickElement:e,tickClasses:t=[],onClick:i}){e&&(e.classList.add(...t,z.z.secondaryTick),i&&(e.onclick=()=>i()))}({tickElement:t,tickClasses:ke,onClick:this._makeGoToTime(e)})}]}),this._onPlayDayClick=()=>{this.viewModel.toggleDayPlaying()},this._onDateChange=e=>{const t=e.currentTarget.valueAsDate;this.viewModel.onDateChange(Array.isArray(t)?t[0]:t)},this._onYearPlayClick=()=>{this.viewModel.toggleYearPlaying()},this._onSeasonChange=e=>{this.viewModel.currentSeason=e.currentTarget.value},this._onSunLightingCheckboxChange=()=>{this.viewModel.toggleSunLightingEnabled()},this._onShadowCheckboxChange=()=>{this.viewModel.toggleDirectShadowsEnabled()}}get icon(){return"brightness"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.title??""}set label(e){this._overrideIfSome("label",e)}get playSpeedMultiplier(){return this.viewModel.playSpeedMultiplier}set playSpeedMultiplier(e){this.viewModel.playSpeedMultiplier=e}get timeSliderSteps(){return this._timeSlider?.steps??5}set timeSliderSteps(e){this._timeSlider.steps=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}postInitialize(){this.viewModel.isSupported&&(this.addHandles([(0,o.YP)((()=>this.viewModel.timeSliderViewModel),(e=>this._timeSlider.viewModel=e),o.tX),(0,o.YP)((()=>this.visibleElements?.timezone),(e=>this._timeSlider.showDropDown=e),o.tX),(0,o.YP)((()=>!this.viewModel.sunLightingEnabled),(e=>{this._timeSlider.disabled=e}),o.tX),(0,c.qe)((()=>this._adjustTimeSliderPadding()))]),this._adjustTimeSliderPadding())}destroy(){this._timeSlider.destroy()}render(){const{messages:e,viewModel:t,visibleElements:i}=this,n=t.isSupported;return(0,X.u)("div",{class:this.classes(m.base,z.z.widget)},n?(0,X.u)(X.D,null,i.header?(0,X.u)(xe.X,{level:this.headingLevel},e.title):null,this._renderTimeOptions(),i.datePicker?this._renderDateOrSeason():null,i.sunLightingToggle?this._renderSunLightingToggle():null,i.shadowsToggle?this._renderShadowsToggle():null):(0,X.u)("div",{class:m.panelError,key:"unsupported"},(0,X.u)("p",null,e.unsupported)))}loadDependencies(){return(0,ue.h)({button:()=>Promise.resolve().then(i.bind(i,61637)),checkbox:()=>i.e(14530).then(i.bind(i,69397)),label:()=>Promise.resolve().then(i.bind(i,36650)),"input-date-picker":()=>Promise.all([i.e(71823),i.e(63243),i.e(29628)]).then(i.bind(i,29628)),option:()=>Promise.resolve().then(i.bind(i,26344)),select:()=>Promise.resolve().then(i.bind(i,44015))})}_adjustTimeSliderPadding(){!function(e){if(!e)return;const t=(0,c.v2)(),i=t?.language??"",n=t?.region??"";e.querySelectorAll(`.${V.tickLabelElement}`).forEach((e=>{j(e)}));const r=["ar","bg","el","en","ko"].includes(i)||"zh"===i&&["HK","TW"].includes(n);e.style.paddingBlockEnd=r?"42px":"28px"}(this.domNode?.querySelector(`.${V.base}`))}_renderTimeOptions(){const{viewModel:e,visibleElements:t,messages:i}=this,{dayPlaying:n}=e,r=!e.sunLightingEnabled;return(0,X.u)("div",{class:this.classes(m.dayContainer,{[m.sliderDateOn]:t.datePicker,[m.sliderDateOff]:!t.datePicker,[m.sliderAmPmOn]:(0,D.Sh)($).formatToParts(H(0,"value")).some((({type:e})=>"dayPeriod"===e)),[m.containerDisabled]:r}),key:"daylight-time-options"},this._timeSlider.render(),t.playButtons?this._renderPlayPauseButton({playing:n,disabled:r,label:i.playDay,onClick:this._onPlayDayClick}):null)}_renderDateOptions(){const{viewModel:e,visibleElements:t,messages:i}=this,{yearPlaying:n}=e,r=!e.sunLightingEnabled;return(0,X.u)("div",{class:this.classes(m.dateContainer,r&&m.containerDisabled),key:m.dateContainer},(0,X.u)("calcite-input-date-picker",{class:m.datePicker,"data-testid":"daylight-date-picker",disabled:r,key:m.datePicker,overlayPositioning:"fixed",placement:"bottom",valueAsDate:e.localDate,onCalciteInputDatePickerChange:this._onDateChange}),t.playButtons?this._renderPlayPauseButton({playing:n,disabled:r,label:i.playYear,onClick:this._onYearPlayClick}):null)}_renderPlayPauseButton({playing:e,disabled:t,label:i,onClick:n}){return(0,X.u)("calcite-button",{appearance:"solid",class:m.playPauseButton,disabled:t,iconStart:e?"pause-f":"play-f",label:i,onclick:n,round:!0,title:i,type:"button"})}_renderSeasonSelect(){const{messages:e,viewModel:t}=this,i=!t.sunLightingEnabled;return(0,X.u)("calcite-select",{class:this.classes(m.seasonPicker),disabled:i,label:e.season,onCalciteSelectChange:this._onSeasonChange},T.map((i=>(0,X.u)("calcite-option",{selected:t.currentSeason===i,value:i},e[i]))))}_renderDateOrSeason(){return"date"===this.dateOrSeason?this._renderDateOptions():this._renderSeasonSelect()}_renderSunLightingToggle(){const e=this.messages?.sunLightingToggle;return(0,X.u)("calcite-label",{key:"date-time-toggle",layout:"inline",scale:"s",title:e?.tooltip},(0,X.u)("calcite-checkbox",{checked:this.viewModel.sunLightingEnabled,class:m.sunLightingCheckbox,onCalciteCheckboxChange:this._onSunLightingCheckboxChange}),e?.label)}_renderShadowsToggle(){const e=this.messages.shadowsToggle;return(0,X.u)("calcite-label",{key:"shadow-toggle",layout:"inline",scale:"s",title:e?.tooltip},(0,X.u)("calcite-checkbox",{checked:this.viewModel.directShadowsEnabled,class:m.shadowsCheckbox,onCalciteCheckboxChange:this._onShadowCheckboxChange}),e.label)}_makeGoToTime(e){return()=>{this.viewModel.timeSliderPosition=e}}};(0,r._)([(0,a.Cb)(),(0,J.H)("esri/widgets/Daylight/t9n/Daylight")],Te.prototype,"messages",void 0),(0,r._)([(0,a.Cb)(),(0,J.H)("esri/widgets/support/t9n/timezone")],Te.prototype,"timezoneMessages",void 0),(0,r._)([(0,a.Cb)()],Te.prototype,"headingLevel",void 0),(0,r._)([(0,a.Cb)()],Te.prototype,"icon",null),(0,r._)([(0,a.Cb)()],Te.prototype,"label",null),(0,r._)([(0,a.Cb)()],Te.prototype,"playSpeedMultiplier",null),(0,r._)([(0,a.Cb)()],Te.prototype,"timeSliderSteps",null),(0,r._)([(0,a.Cb)()],Te.prototype,"view",null),(0,r._)([(0,Ee.s)("user-date-time-change"),(0,a.Cb)({type:q})],Te.prototype,"viewModel",void 0),(0,r._)([(0,a.Cb)({type:W,nonNullable:!0})],Te.prototype,"visibleElements",void 0),(0,r._)([(0,a.Cb)({cast(e){return"season"===e||"date"===e?e:(s.Z.getLogger(this).warn(`"${e}" is not a valid option. Acceptable values are only "date" or "season". Defaulting to "${Se}".`),Se)}})],Te.prototype,"dateOrSeason",void 0),(0,r._)([(0,a.Cb)()],Te.prototype,"_timeSlider",void 0),Te=(0,r._)([(0,l.j)("esri.widgets.Daylight")],Te);const ke=[z.z.interactive,z.z.anchor],Ie=Te;var Pe=i(54503),Oe=i(8403),Le=i(49006),Me=i(46789);const Re=Le.iv`@layer{arcgis-daylight{display:block}}`,Ae=(0,Oe.m)(Ie);class De extends Pe.oi{constructor(){super(...arguments),this.widget=Ae(this),this.viewModel=this.widget.viewModel,this.autoDestroyDisabled=!1,this.currentSeason=this.viewModel.currentSeason,this.dateOrSeason=this.widget.dateOrSeason,this.dayPlaying=this.viewModel.dayPlaying,this.headingLevel=this.widget.headingLevel,this.hideDatePicker=this.widget.visibleElements.datePicker,this.hideHeader=this.widget.visibleElements.header,this.hidePlayButtons=this.widget.visibleElements.playButtons,this.hideShadowsToggle=this.widget.visibleElements.shadowsToggle,this.hideSunLightingToggle=this.widget.visibleElements.sunLightingToggle,this.hideTimezone=this.widget.visibleElements.timezone,this.icon=this.widget.icon,this.label=this.widget.label,this.playSpeedMultiplier=this.widget.playSpeedMultiplier,this.position="bottom-left",this.timeSliderSteps=this.widget.timeSliderSteps,this.yearPlaying=this.viewModel.yearPlaying,this.arcgisReady=(0,Pe.yM)(),this.arcgisUserDateTimeChange=(0,Me.Wk)((()=>this.viewModel),"user-date-time-change")}static{this.properties={autoDestroyDisabled:5,currentSeason:1,dateOrSeason:1,dayPlaying:5,headingLevel:9,hideDatePicker:5,hideHeader:5,hidePlayButtons:5,hideShadowsToggle:5,hideSunLightingToggle:5,hideTimezone:5,icon:1,label:1,playSpeedMultiplier:9,position:1,referenceElement:1,timeSliderSteps:9,yearPlaying:5}}static{this.shadowRootOptions=Pe.hZ}static{this.styles=Re}async destroy(){await this.manager.destroy()}}(0,n.c)("arcgis-daylight",De)},40221:function(e,t,i){i(64062),i(17394),i(61637);var n=i(64297),r=i(15294),s=i(54503),o=i(20803),a=i(41203),l=i(97237),c=i(29359),u=i(49006),d=i(73440),h=i(65475),p=i(61100),m=i(26636),f=i(17155),v=(i(61432),i(96711),i(83850),i(48023)),g=i(60508);let y=class extends h.Z{constructor(e){super(e),this.type="direct-line-measurement",this.startPoint=null,this.endPoint=null,this.unit=null}get valid(){return null!=this.startPoint&&null!=this.endPoint}clear(){this.startPoint=null,this.endPoint=null}equals(e){return this===e||super.equals(e)&&this.unit===e.unit&&(0,p._W)(this.startPoint,e.startPoint)&&(0,p._W)(this.endPoint,e.endPoint)}};(0,d._)([(0,f.Cb)({type:["direct-line-measurement"]})],y.prototype,"type",void 0),(0,d._)([(0,f.Cb)({type:g.Z})],y.prototype,"startPoint",void 0),(0,d._)([(0,f.Cb)({type:g.Z})],y.prototype,"endPoint",void 0),(0,d._)([(0,f.Cb)({type:m.oD,value:null})],y.prototype,"unit",void 0),(0,d._)([(0,f.Cb)({readOnly:!0})],y.prototype,"valid",null),y=(0,d._)([(0,v.j)("esri.analysis.DirectLineMeasurementAnalysis")],y);const b=y;var _=i(6496),w=i(26961),C=i(49898),x=i(90403),E=i(60629),S=i(99978);const T=u.iv`@layer{arcgis-directline-measurement-3d,arcgis-direct-line-measurement-3d{display:block}.arcgis-direct-line-measurement-3d{position:relative;padding:var(--esri-widget-padding);overflow-y:auto}}`;var k=Object.defineProperty,I=Object.getOwnPropertyDescriptor,P=(e,t,i,n)=>{for(var r,s=n>1?void 0:n?I(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(s=(n?r(t,i,s):r(s))||s);return n&&s&&k(t,i,s),s};let O=class extends E.A{constructor(){super(...arguments),this.supportedViewType="3d",this.unsupportedErrorMessage="The Direct Line Measurement 3D component is only supported in 3D views."}initialize(){this.addHandles((0,x.YP)((()=>({analysis:this.analysis,unit:this.unit})),(({analysis:e,unit:t})=>{null!=e&&(e.unit=t)}),{sync:!0,initial:!0}))}get state(){return this.disabled||!this.ready?"disabled":"inactive"===this.operationState?this.analysis.valid?"measured":"ready":"measuring"}get displayState(){if(!this.supported)return"unsupported";switch(this.state){case"disabled":case"ready":return"ready";case"measuring":return null==this.analysis.startPoint?"measuring":"measured";case"measured":return"measured"}}get measurement(){const e=this.analysisView?.result,t=e?.mode??"euclidean";if(!this.analysis.valid)return{mode:t,directDistance:(0,S.g)(void 0),horizontalDistance:(0,S.g)(void 0),verticalDistance:(0,S.g)(void 0)};const i=e?.directDistance,n=null!=i&&(0,_.xo)(i);return{mode:t??"euclidean",directDistance:(0,S.g)(n?void 0:i),horizontalDistance:(0,S.g)(e?.horizontalDistance),verticalDistance:(0,S.g)(e?.verticalDistance)}}get unitOptions(){const e=this._userUnitOptions?.filter((e=>S.m.includes(e)));return e&&e.length>0?e:S.m.slice()}set unitOptions(e){this._userUnitOptions=e}get unit(){const e=this._userUnit,t=this.unitOptions;if(e&&t.includes(e))return e;const i=this.defaultUnit;return i&&t.includes(i)?i:t[0]}set unit(e){this._userUnit=e}get defaultUnit(){return this.view?(0,w.R)(this.view):void 0}async place(e){await(this.analysisView?.place(e))}clearAnalysis(){this.analysis.startPoint=null,this.analysis.endPoint=null}constructAnalysis(){return new b}};P([(0,C.Cb)({readOnly:!0})],O.prototype,"state",1),P([(0,C.Cb)({readOnly:!0})],O.prototype,"displayState",1),P([(0,C.Cb)({readOnly:!0})],O.prototype,"measurement",1),P([(0,C.Cb)()],O.prototype,"unitOptions",1),P([(0,C.Cb)()],O.prototype,"_userUnitOptions",2),P([(0,C.Cb)()],O.prototype,"unit",1),P([(0,C.Cb)()],O.prototype,"_userUnit",2),P([(0,C.Cb)({readOnly:!0})],O.prototype,"defaultUnit",1),O=P([(0,C.jY)("components.direct-line-measurement-3d.DirectLineMeasurement3dViewModel")],O);const L="arcgis-direct-line-measurement-3d",M=(0,l.m)(O);class R extends s.oi{constructor(){super(...arguments),this.viewModel=M(this),this.messages=(0,a.u)({name:"directline-measurement-3d",blocking:!0}),this.analysis=this.viewModel.analysis,this.autoDestroyDisabled=!1,this.icon="measure-line",this.position="bottom-left",this.state=this.viewModel.state,this.unit=this.viewModel.unit,this.unitOptions=this.viewModel.unitOptions,this.arcgisPropertyChange=(0,o.OR)()("analysis","state"),this.arcgisReady=(0,s.yM)()}static{this.properties={analysis:0,autoDestroyDisabled:5,icon:3,label:1,position:1,referenceElement:1,state:35,unit:1,unitOptions:0}}static{this.shadowRootOptions=s.hZ}static{this.styles=T}async clear(){this.viewModel.clear()}async destroy(){await this.manager.destroy()}async start(){await this.viewModel.start()}render(){const{messages:e,unit:t,unitOptions:i,viewModel:n}=this,{measurement:o,state:a}=n;return r.dy`<div aria-label=${e.componentLabel??s.Ld} class=${(0,s.Vp)({[L]:!0,[c.g.widget]:!0,[c.g.panel]:!0})} role=presentation><arcgis-measurement-content .state=${n.displayState} .hintLabel=${e.hint} .unsupportedLabel=${e.unsupported} .items=${[{title:e.direct,measurement:o.directDistance},{title:e.horizontal,measurement:o.horizontalDistance},{title:e.vertical,measurement:o.verticalDistance}]}><arcgis-unit-select slot=settings .options=${i} .selectLabel=${e.unit} .value=${t} @arcgisUnitSelectChange=${e=>{this.unit=e.detail}}></arcgis-unit-select><calcite-button slot=actions .disabled=${"disabled"===a} @click=${()=>{this.viewModel.clear(),this.viewModel.start()}}>${e.newMeasurement}</calcite-button></arcgis-measurement-content></div>`}}(0,n.c)("arcgis-direct-line-measurement-3d",R),(0,n.c)("arcgis-directline-measurement-3d",class extends R{constructor(){super(),console.warn('arcgis-directline-measurement-3d - this component is deprecated. Use the "arcgis-direct-line-measurement-3d" component instead.')}})},61288:function(e,t,i){var n=i(64297),r=i(20803),s=i(73440),o=i(29292),a=i(61100),l=i(30062),c=i(93568),u=i(90403),d=i(17155),h=(i(61432),i(96711)),p=(i(83850),i(48023)),m=i(1803);const f="esri-elevation-profile",v={base:`${f}`,portrait:`${f}--portrait`,refined:`${f}--refined`,mainContainer:`${f}__main-container`,promptContainer:`${f}__prompt-container`,header:`${f}__header`,zoomOutButton:`${f}__zoom-out-button`,clearButton:`${f}__clear-button`,actionButton:`${f}__action-button`,sketchButton:`${f}__sketch-button`,sketchCancelButton:`${f}__sketch-cancel-button`,sketchDoneButton:`${f}__sketch-done-button`,selectButton:`${f}__select-button`,selectCancelButton:`${f}__select-cancel-button`,chartContainer:`${f}__chart-container`,chartSpinner:`${f}__chart-spinner`,chartSpinnerVisible:`${f}__chart-spinner--visible`,chartSpinnerSmall:`${f}__chart-spinner--small`,footer:`${f}__footer`},g="esri-elevation-profile-legend",y="esri-elevation-profile-legend-item",b={base:y,disabled:`${y}--disabled`,expanded:`${y}--expanded`,colorIndicator:`${y}__color-indicator`,header:`${y}__header`,content:`${y}__content`,collapseToggle:`${y}__collapse-toggle`,label:`${y}__label`,checkbox:`${y}__checkbox`},_="esri-elevation-profile-statistics",w={base:_,statistic:`${_}__statistic`,statisticLabel:`${_}__statistic__label`,statisticValue:`${_}__statistic__value`,slopeValue:`${_}__slope-value`},C="esri-elevation-profile-settings",x={base:`${C}`,popoverContent:`${C}__popover-content`,uniformChartScalingLabel:`${C}__uniform-scaling-label`,uniformChartScalingCheckbox:`${C}__uniform-scaling-checkbox`};var E=i(46451),S=i(70880),T=i(3480),k=i(46965),I=i(43254),P=i(41145),O=i(12853),L=i(26636),M=i(42810),R=i(34615),A=i(50702),D=i(12506),F=i(51870),N=i(63216),V=i(11583),z=i(16363);const U=Symbol("line-change");let $=class extends S.Z{constructor(e){super(e),this._updateTask=null,this._paramsPerProfile=new Map,this._getUpdateParametersMemoized=(0,l.H)(((e,t,i)=>({stationary:e,visibleProfiles:t,generationParameters:i}))),this._getGenerationParametersMemoized=(0,l.H)(((e,t,i,n,r,s,o)=>(0,V.l9)(t)&&(0,V.G9)(t)&&null!=n?{view:e,geometry:t,elevationInfo:i,options:s,queue:n,cache:r,slicePlane:o}:null)),this._getElevationInfoMemoized=(0,l.H)(((e,t)=>({mode:e,offset:t}))),this._getOptionsMemoized=(0,l.H)(((e,t)=>{const{densificationMaxSamples:i,maxTotalSamples:n}=(0,N.iE)();return{samplingDistance:e,densificationMaxSamples:Math.round(i/t),maxTotalSamples:n}})),this._updateThrottled=(0,D.P)((e=>(0,c.R8)(this._update(e))),(0,N.iE)().updateThrottleMillis)}initialize(){const e=this.viewModel;this.addHandles([(0,u.YP)((()=>({visible:e.visible,profiles:e.profiles.toArray()})),(({visible:e,profiles:t})=>{this._abortUpdate(),this._paramsPerProfile.clear(),this.removeHandles(U),e&&0!==t.length&&this.addHandles([...t.map((e=>(0,A.AL)([e.attach(this.viewModel),e.on("change",(()=>{this._invalidateProfile(e)}))]))),(0,u.YP)((()=>this._updateParameters),this._updateThrottled,u.tX),this._updateThrottled],U)}),u.tX)])}destroy(){this._paramsPerProfile.clear()}get _updateParameters(){const{viewModel:e}=this,t=e.view;return this._getUpdateParametersMemoized(null==t||t.stationary,this.viewModel.visibleProfiles,this._generationParameters)}get _generationParameters(){const{view:e,input:t,queue:i,tileCache:n}=this.viewModel;return null!=e&&e.ready?this._getGenerationParametersMemoized(e,t?.geometry,this._elevationInfo,i,n,this._options,"3d"===e.type?e.slice.plane:null):null}get _elevationInfo(){const e=this.viewModel.input,t=e?(0,F.Lt)(e)?null:(0,F.RL)(e):null;return null!=t?this._getElevationInfoMemoized(t.mode,t.offset):null}get _options(){const e=this.viewModel,t=e.visibleProfiles.length;let i=e.minDemResolution??(0,N.iE)().defaultDemResolution;return i=parseFloat(i.toFixed(2)),this._getOptionsMemoized(i,t)}async _update({stationary:e,visibleProfiles:t,generationParameters:i}){this._abortUpdate(),e&&(null!=i?this._updateTask=(0,o.vr)((async e=>{this.viewModel.error=null;const n=t.filter((e=>!this._isProfileValid(e,i))),r=(0,z.m7)({...i,providers:n},{signal:e});try{for await(const t of r){(0,c.k_)(e),this._clearInvalidResults(i);for(let e=0;e<n.length;e++)n[e].result=t[e]}for(const e of n)this._paramsPerProfile.set(e,i)}catch(e){(0,c.r9)(e),this._abortUpdate(),this.viewModel.error=e,n.forEach((e=>{e.result=null}))}})):this._clearResults())}_abortUpdate(){this._updateTask=(0,a.IM)(this._updateTask)}_isProfileValid(e,t){return this._paramsPerProfile.has(e)&&this._paramsPerProfile.get(e)===t}_invalidateProfile(e){this._paramsPerProfile.delete(e),this._updateThrottled(this._updateParameters)}_clearInvalidResults(e){for(const t of this.viewModel.profiles.items)this._isProfileValid(t,e)||(t.result=null,this._paramsPerProfile.delete(t))}_clearResults(){for(const e of this.viewModel.profiles.items)e.result=null,this._paramsPerProfile.delete(e)}};(0,s._)([(0,d.Cb)({nonNullable:!0})],$.prototype,"viewModel",void 0),(0,s._)([(0,d.Cb)()],$.prototype,"_updateParameters",null),(0,s._)([(0,d.Cb)()],$.prototype,"_generationParameters",null),(0,s._)([(0,d.Cb)()],$.prototype,"_elevationInfo",null),(0,s._)([(0,d.Cb)()],$.prototype,"_options",null),$=(0,s._)([(0,p.j)("esri.widgets.ElevationProfile.ElevationProfileController")],$);var B=i(53147),j=i(87833),H=i(18764),Z=i(60508);function q(e,t,i){return null==e?null:(0,L.En)(e*t,"meters",i)}function G(e,t,i){return null==e?null:(0,L.En)(e*t,"meters",i)}let W=class extends j.Z.EventedAccessor{constructor(e){super(e),this.type=null,this.id=(0,H.DO)(),this.title=null,this.color=new B.Z("#000000"),this.visible=!0,this._getSamplesMemoized=(0,l.H)(((e,t)=>function(e,t){if(null==e||null==t)return null;const{samples:i,spatialReference:n}=e,{distance:r,elevation:s}=t,o=(0,L.c9)(n),a=(0,L._R)(n),l=i.length,c=new Array(l);for(let e=0;e<l;++e){const t=i[e],n=t.sampledZ,l=t.coordinate;c[e]={x:l[0],y:l[1],z:n,distance:q(t.distance,o,r),elevation:G(n,a,s)}}return c}(e,t))),this._getStatisticsMemoized=(0,l.H)(((e,t)=>function(e,t){if(null==e||null==t||null==e.statistics||null==e.spatialReference)return null;const{distance:i,elevation:n}=t,{statistics:r,spatialReference:s}=e,o=(0,L.c9)(s),a=(0,L._R)(s);return{maxDistance:q(r.maxDistance,o,i),minElevation:G(r.minElevation,a,n),maxElevation:G(r.maxElevation,a,n),avgElevation:G(r.avgElevation,a,n),elevationGain:G(r.elevationGain,a,n),elevationLoss:G(r.elevationLoss,a,n),maxPositiveSlope:r.maxPositiveSlope,maxNegativeSlope:r.maxNegativeSlope,avgPositiveSlope:r.avgPositiveSlope,avgNegativeSlope:r.avgNegativeSlope}}(e,t))),this.viewVisualizationEnabled=!0,this.result=null,this.effectiveUnits=null,this.numSamplesForPreview=30,this.numSamplesPerChunk=200,this.chartFillEnabled=!0,this.chartStrokeWidth=1.5,this.chartStrokeOffsetY=0,this._viewModel=null}get progress(){return null!=this.result&&this.visible?this.result.progress:0}get samples(){return this._getSamplesMemoized(this.result,this.effectiveUnits)}get statistics(){return this._getStatisticsMemoized(this.result,this.effectiveUnits)}get hoveredPoint(){const e=this._viewModel?.hoveredChartPosition;return null!=e?this._getPoint(e):null}get available(){return!0}get hasZ(){const e=this.result;return null!=e&&e.hasZ}get minDemResolution(){return(0,N.iE)().defaultDemResolution}queryElevation(){throw new Error("not implemented")}attach(e){return this._viewModel=e,(0,A.AL)([(0,u.YP)((()=>e.effectiveUnits),(e=>{this.effectiveUnits=e}),u.tX),(0,u.YP)((()=>[e.input]),(()=>this._onChange()),u.Z_)])}toggleVisibility(e){this.visible=void 0===e?!this.visible:e}_onChange(){this.emit("change")}_getPoint(e){const{samples:t,result:i}=this;if(null==t||null==i)return null;const n=t.length;if(0===n)return null;const r=t[n-1].distance,s=(0,z.hG)(t,e*r,(e=>e.distance));if(null==s)return null;const{x:o,y:a,z:l}=s;return null==l?null:new Z.Z({x:o,y:a,z:l,spatialReference:i.spatialReference})}};(0,s._)([(0,d.Cb)({nonNullable:!0})],W.prototype,"id",void 0),(0,s._)([(0,d.Cb)({nonNullable:!0})],W.prototype,"title",void 0),(0,s._)([(0,d.Cb)({type:B.Z,nonNullable:!0})],W.prototype,"color",void 0),(0,s._)([(0,d.Cb)({nonNullable:!0})],W.prototype,"visible",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],W.prototype,"progress",null),(0,s._)([(0,d.Cb)({readOnly:!0})],W.prototype,"samples",null),(0,s._)([(0,d.Cb)({readOnly:!0})],W.prototype,"statistics",null),(0,s._)([(0,d.Cb)()],W.prototype,"hoveredPoint",null),(0,s._)([(0,d.Cb)()],W.prototype,"viewVisualizationEnabled",void 0),(0,s._)([(0,d.Cb)()],W.prototype,"available",null),(0,s._)([(0,d.Cb)()],W.prototype,"result",void 0),(0,s._)([(0,d.Cb)()],W.prototype,"effectiveUnits",void 0),(0,s._)([(0,d.Cb)()],W.prototype,"numSamplesForPreview",void 0),(0,s._)([(0,d.Cb)()],W.prototype,"numSamplesPerChunk",void 0),(0,s._)([(0,d.Cb)()],W.prototype,"chartFillEnabled",void 0),(0,s._)([(0,d.Cb)()],W.prototype,"chartStrokeWidth",void 0),(0,s._)([(0,d.Cb)()],W.prototype,"chartStrokeOffsetY",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],W.prototype,"hasZ",null),(0,s._)([(0,d.Cb)({readOnly:!0})],W.prototype,"minDemResolution",null),(0,s._)([(0,d.Cb)()],W.prototype,"_viewModel",void 0),W=(0,s._)([(0,p.j)("esri.widgets.ElevationProfile.ElevationProfileLine")],W);const Y=W;var Q=i(3048);function K(e){if(null==e)return null;if((0,Q.K)(e))return J(e);const t=e.tileInfo;if(null==t)return null;const i=t.lods?.at(-1);return null==i?null:i.resolution*(0,L.c9)(t.spatialReference)}function J(e){if(null==e)return null;const t=e.layers.items.map(X).filter(T.pC);return(0,T.VV)(t)??null}function X(e){return e&&"tileInfo"in e?K(e):null}let ee=class extends Y{constructor(e){super(e),this.type="ground",this.color=new B.Z("#ff7f00"),this.viewVisualizationEnabled=!0,this.numSamplesForPreview=50,this.numSamplesPerChunk=1e3,this._getQueryElevationDependencies=(0,l.H)(((e,t)=>({ground:e,groundLayers:t})))}get available(){const e=this._ground;return null!=e&&e.layers.some((e=>e.visible))}get minDemResolution(){return J(this._ground)}get _queryElevationDependencies(){return this._getQueryElevationDependencies(this._ground,this._groundLayers)}get _ground(){return this._viewModel?.view?.map?.ground}get _groundLayers(){return this._ground?.layers?.toArray()??[]}async queryElevation(e,t){const i=this._queryElevationDependencies;if(null==i)throw new Error("ElevationProfileLineGround: no dependencies");const{ground:n}=i;if(null==n)throw new Error("No ground configured in the view");const r=await n.queryElevation(e,t),s=(0,L._R)(e.spatialReference),o=(0,L._R)(n.layers.at(0).spatialReference);if(s!==o){const e=r.geometry;e.points=e.points.map((([e,i,n])=>[e,i,n===t.noDataValue?n:n*o/s]))}return r}attach(e){return(0,A.AL)([super.attach(e),(0,u.YP)((()=>this._queryElevationDependencies),(()=>this._onChange()))])}};(0,s._)([(0,d.Cb)({type:B.Z,nonNullable:!0})],ee.prototype,"color",void 0),(0,s._)([(0,d.Cb)()],ee.prototype,"viewVisualizationEnabled",void 0),(0,s._)([(0,d.Cb)()],ee.prototype,"available",null),(0,s._)([(0,d.Cb)({readOnly:!0})],ee.prototype,"minDemResolution",null),(0,s._)([(0,d.Cb)()],ee.prototype,"_queryElevationDependencies",null),(0,s._)([(0,d.Cb)()],ee.prototype,"_ground",null),(0,s._)([(0,d.Cb)()],ee.prototype,"_groundLayers",null),ee=(0,s._)([(0,p.j)("esri.widgets.ElevationProfile.ElevationProfileLineGround")],ee);const te=ee;var ie=i(58086);let ne=class extends Y{constructor(e){super(e),this.type="input",this.color=new B.Z("#00c8c8"),this.viewVisualizationEnabled=!1,this.numSamplesForPreview=50,this.numSamplesPerChunk=500,this.chartFillEnabled=!1,this.chartStrokeOffsetY=-1,this._getQueryElevationDependencies=(0,l.H)(((e,t,i,n,r)=>e?{elevationInfo:e,visibleLayers:t,view:i,stationary:n,spatialReference:r}:null))}get queryElevationDependencies(){const e=this._viewModel?.view;return null==e?null:this._getQueryElevationDependencies(this._elevationInfo,this._visibleLayers,e,e.stationary,e.spatialReference)}get available(){return!this._viewModel?.inputIsSketched}get _elevationInfo(){const e=this._viewModel?.input;return e?(0,F.RL)(e):null}get _visibleLayers(){return this._viewModel?.view?.map?.allLayers?.filter((e=>e.visible)).toArray()??[]}async queryElevation(e,{noDataValue:t,signal:i}){const n=this.queryElevationDependencies;if(null==n)throw new Error("ElevationProfileLineInput: no dependencies");const{view:r,elevationInfo:s,spatialReference:o}=n;if("on-the-ground"===s.mode&&"3d"===r.type&&o){const n=await ie.e.fromGeometry(e).project(o,i);if(!n)return{geometry:e,noDataValue:t};const s=r.elevationProvider;return n.coordinates.forEach((e=>{e.z=s.getElevation(e.x,e.y,0,o,"ground")??0})),{geometry:n.export(),noDataValue:t}}return{geometry:e,noDataValue:t}}attach(e){const t=()=>this._onChange();return(0,A.AL)([super.attach(e),(0,u.YP)((()=>this.queryElevationDependencies),t),(0,u.on)((()=>e.elevationProvider),"elevation-change",t,{onListenerAdd:t,onListenerRemove:t})])}};(0,s._)([(0,d.Cb)({type:B.Z,nonNullable:!0})],ne.prototype,"color",void 0),(0,s._)([(0,d.Cb)()],ne.prototype,"viewVisualizationEnabled",void 0),(0,s._)([(0,d.Cb)()],ne.prototype,"queryElevationDependencies",null),(0,s._)([(0,d.Cb)()],ne.prototype,"available",null),(0,s._)([(0,d.Cb)()],ne.prototype,"_elevationInfo",null),(0,s._)([(0,d.Cb)()],ne.prototype,"_visibleLayers",null),ne=(0,s._)([(0,p.j)("esri.widgets.ElevationProfile.ElevationProfileLineInput")],ne);const re=ne;let se=class extends Y{constructor(e){super(e),this.type="query",this.color=new B.Z("#db334a"),this.viewVisualizationEnabled=!0,this.source=null,this.numSamplesForPreview=50,this.numSamplesPerChunk=500}get minDemResolution(){return K(this.source)}get available(){const e=this.source;return!!e&&(null==e.visible||e.visible)&&(null==e.layers||e.layers.some((e=>e.visible)))}queryElevation(e,t){if(!this.source)throw new Error("No source configured for the elevation profile line");return this.source.queryElevation(e,t)}attach(e){return(0,A.AL)([super.attach(e),(0,u.YP)((()=>this.source),(()=>this._onChange()),u.Z_)])}};(0,s._)([(0,d.Cb)({type:B.Z,nonNullable:!0})],se.prototype,"color",void 0),(0,s._)([(0,d.Cb)()],se.prototype,"viewVisualizationEnabled",void 0),(0,s._)([(0,d.Cb)()],se.prototype,"source",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],se.prototype,"minDemResolution",null),(0,s._)([(0,d.Cb)()],se.prototype,"available",null),se=(0,s._)([(0,p.j)("esri.widgets.ElevationProfile.ElevationProfileLineQuery")],se);const oe=se;var ae=i(74355),le=i(24910),ce=i(82846),ue=i(47925),de=i(12659),he=i(43759),pe=i(92490),me=i(61442),fe=i(90189);let ve=class extends Y{constructor(e){super(e),this.type="view",this.color=new B.Z("#cf4ccf"),this.viewVisualizationEnabled=!0,this.include=null,this.exclude=null,this.numSamplesForPreview=50,this.numSamplesPerChunk=25,this._getQueryElevationDependencies=(0,l.H)(((e,t,i,n,r,s,o)=>({inputGraphicUid:null!=e?ye(e):null,visibleLayers:t,maxIntersectionDistance:i,intersectOptions:n,view:r,stationary:s,spatialReference:o}))),this._vecA=(0,ce.Ue)(),this._vecB=(0,ce.Ue)(),this._ray=(0,de.Ue)()}get minDemResolution(){const e=this._viewModel?.view;if(null==e||"3d"!==e.type)return null;const t=e.pointsOfInterest?.focus?.worldUnitsPerContentPixel;return null==t?null:t*(0,L._R)(e.spatialReference)}get queryElevationDependencies(){const e=this._view;return e?this._getQueryElevationDependencies(this._viewModel?.input,this._visibleLayers,this._maxIntersectionDistance,this._intersectOptions,e,e.stationary,e.spatialReference):null}get _visibleLayers(){return this._view?.map?.allLayers?.filter((e=>e.visible)).toArray()??[]}get _intersectOptions(){const e=this._view;if(null==e||e.destroyed)return{};const t=(0,he.us)(e,{include:this.include,exclude:this.exclude}),i=(0,he.us)(e,{exclude:this._pointCloudLayers});return t.exclude=(0,ae.G0)(t.exclude,i.exclude),t}get _pointCloudLayers(){const e=this._view;return null==e?[]:e.allLayerViews.toArray().filter((e=>"point-cloud"===e.layer?.type)).map((e=>e.layer))}get _view(){const e=this._viewModel?.view;return null!=e&&"3d"===e.type?e:null}get _maxIntersectionDistance(){const e=this._view;return e?.renderCoordsHelper?(0,ue.Iu)(e.spatialReference).radius/e.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY}get _intersector(){const e=this._view;if(null==e)return null;const t=new pe.r(e.state.viewingMode),i=t.options;return i.hud=!1,i.invisibleTerrain=!1,i.backfacesTerrain=!1,i.selectionMode=!1,i.store=me.e.ALL,t}async queryElevation(e,{noDataValue:t,signal:i}){const n=this.queryElevationDependencies;if(null==n)throw new Error("ElevationProfileLineInput: no dependencies");const r=this._intersector;if(null==r)throw new Error("ElevationProfileLineInput: no view");const{intersectOptions:s,view:o,spatialReference:a}=n,l=o.renderCoordsHelper,c=o.sceneIntersectionHelper,u=this._vecA,d=this._vecA,h=this._vecB,p=this._ray;if(!a)return{geometry:e,noDataValue:t};const m=await ie.e.fromGeometry(e).project(a,i);if(!m)return{geometry:e,noDataValue:t};const f=m.coordinates,v=f.length;for(let e=0;e<v;++e){const i=f[e];(0,le.i)(h,i.x,i.y,i.z??0),l.toRenderCoords(h,a,h),l.setAltitude(u,2e5,h);const o=(0,de.zk)(u,h,p);c.computeIntersection(o,r,!0,s);const m=ge(n,r.results.all);m?(m.getIntersectionPoint(d),l.fromRenderCoords(d,d,a),i.z=d[2]):i.z=t}return{geometry:m.export(),noDataValue:t}}attach(e){const t=()=>this._onChange();return(0,A.AL)([super.attach(e),(0,u.YP)((()=>this.queryElevationDependencies),t),(0,u.on)((()=>e.elevationProvider),"elevation-change",t,{onListenerAdd:t,onListenerRemove:t})])}};function ge({view:e,inputGraphicUid:t,maxIntersectionDistance:i},n){for(const r of n){if(!r.withinDistance(i))continue;const n=(0,fe.tB)(r,e);if(null==n||ye(n)!==t)return r}return null}function ye(e){if(e.layer&&"objectIdField"in e.layer){const t=e.attributes[e.layer.objectIdField];if(t)return`o-${e.layer.id}-${t}`}return`u-${e.uid}`}(0,s._)([(0,d.Cb)({type:B.Z,nonNullable:!0})],ve.prototype,"color",void 0),(0,s._)([(0,d.Cb)()],ve.prototype,"viewVisualizationEnabled",void 0),(0,s._)([(0,d.Cb)()],ve.prototype,"include",void 0),(0,s._)([(0,d.Cb)()],ve.prototype,"exclude",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],ve.prototype,"minDemResolution",null),(0,s._)([(0,d.Cb)()],ve.prototype,"queryElevationDependencies",null),(0,s._)([(0,d.Cb)()],ve.prototype,"_visibleLayers",null),(0,s._)([(0,d.Cb)()],ve.prototype,"_intersectOptions",null),(0,s._)([(0,d.Cb)()],ve.prototype,"_pointCloudLayers",null),(0,s._)([(0,d.Cb)()],ve.prototype,"_view",null),(0,s._)([(0,d.Cb)()],ve.prototype,"_maxIntersectionDistance",null),(0,s._)([(0,d.Cb)()],ve.prototype,"_intersector",null),ve=(0,s._)([(0,p.j)("esri.widgets.ElevationProfile.ElevationProfileLineView")],ve);const be={base:Y,key:"type",typeMap:{ground:te,input:re,query:oe,view:ve},errorContext:"elevation-profile-line"},_e=I.Z.ofType(be);var we,Ce,xe,Ee=i(53447),Se=i(44783),Te=i(38096),ke=i(96620),Ie=i(67947);(xe=we||(we={})).Ready="ready",xe.Creating="creating",xe.Reshaping="reshaping",xe.ReshapingDisabled="reshaping-disabled",xe.Selecting="selecting",xe.Selected="selected",function(e){e.View="view",e.Main="main",e.Interaction="interaction"}(Ce||(Ce={}));let Pe=class extends S.Z{constructor(e){super(e),this.state=we.Ready,this._pendingStartOptions=null,this._previousInputInfo=null,this._shouldRemoveLastPoint=!1,this._sketchedGraphics=new WeakSet,this._creationToolPromise=null,this._updateToolPromise=null,this._updateDisabled=!1}initialize(){this.addHandles((0,u.YP)((()=>({view:this.tool.viewModel.view,visible:this.tool.visible})),(({view:e,visible:t})=>{null!=e&&t?this._attach(e):this._detach()}),u.tX),Ce.View)}destroy(){this._detach()}get canStopCreating(){const e=this._geometry,t=this._shouldRemoveLastPoint?3:2;return(0,V.l9)(e)&&e.paths.length>0&&e.paths[0].length>=t}get _input(){return this.tool.viewModel.input}set _input(e){this.tool.viewModel.input=e}get _geometry(){return this._input?.geometry}get _visibleAndEditable(){return this.tool.visible&&this.tool.editable}get _view(){return this.tool.viewModel.view}get test(){}start(e={mode:"sketch"}){if(!this.tool.editable)return;const t=this._view;if(null!=t&&t.ready)switch(this._pendingStartOptions=null,this._stopInteraction(),null==this._previousInputInfo&&this._storePreviousInput(this._input),this._setSketchedGraphic(null),e.mode){case"sketch":this._set("state",we.Creating),this._startCreationInteraction();break;case"select":this._set("state",we.Selecting),this._startSelectionInteraction()}else this._pendingStartOptions=e}stop(){this._pendingStartOptions=null,this._stopInteractionAndUpdate(),this._clearPreviousInput()}cancel(){this._pendingStartOptions=null,this._stopInteractionAndUpdate(),this._restorePreviousInput()}clear(){this._stopInteractionAndUpdate(),this._set("state",we.Ready),this._clearPreviousInput(),this._input=null,this._pendingStartOptions=null}isSketchedGraphic(e){return null!=e&&this._sketchedGraphics.has(e)}_attach(e){this._detach();const t={mode:"3d"===e.type?"relative-to-ground":"on-the-ground",offset:null};this._graphicsLayer=new Ee.Z({listMode:"hide",internal:!0,elevationInfo:t});const i=function(e){return"2d"===e?new Se.Z({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[5,4],lineDashEnding:"FullGap",controlPointEnding:"NoConstraint"}],enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5,color:[0,0,0,255]},{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5,color:[255,255,255,255]}]}}}):new Te.Z({color:[0,0,0,0]})}(e.type);this._sketchVM=new Ie.Z({layer:this._graphicsLayer,view:e,defaultCreateOptions:{mode:"click",hasZ:!1},updateOnGraphicClick:!1,defaultUpdateOptions:{reshapeOptions:{shapeOperation:"none"},enableRotation:!1,enableScaling:!1,enableMoveAllGraphics:!1,enableZ:!1,multipleSelectionEnabled:!1,toggleToolOnClick:!1,tool:"reshape"},polylineSymbol:i,activeLineSymbol:i}),this.addHandles([(0,u.gx)((()=>e.ready),(()=>{const e=this._pendingStartOptions;e&&this.start(e)}),u.tX),(0,u.YP)((()=>[this._input,this._visibleAndEditable]),(()=>this._update()),u.tX),(0,u.YP)((()=>({map:e.map,graphicsLayer:this._graphicsLayer})),(({map:e,graphicsLayer:t})=>{null!=e&&null!=t&&e.add(t),this._update()}),u.tX)],Ce.Main)}_detach(){this.removeHandles(Ce.Main),this._sketchVM=(0,a.SC)(this._sketchVM),this._creationToolPromise=null,this._updateToolPromise=null;const e=this._view?.map,t=this._graphicsLayer;null!=e&&null!=t&&e.remove(t),this._graphicsLayer=(0,a.SC)(this._graphicsLayer),this._shouldRemoveLastPoint=!1,this._set("state",we.Ready)}_startCreationInteraction(){this._stopInteractionAndUpdate();const e=this._view,t=this._sketchVM;if(null==e||null==t)return;this._shouldRemoveLastPoint=!1;const i=t.on("create",(e=>{const t=e.graphic;switch(e.state){case"complete":this._shouldRemoveLastPoint=!1,this._setSketchedGraphic(t),this._stopInteractionAndUpdate(),this._clearPreviousInput();break;case"cancel":this.cancel();break;case"active":this._setSketchedGraphic(t),"cursor-update"===e.toolEventInfo?.type&&(this._shouldRemoveLastPoint=!0);break;case"start":this._setSketchedGraphic(t)}}));this.removeHandles(Ce.Interaction),this.addHandles((0,A.kB)((()=>{i.remove();const e=this.canStopCreating,n=this._geometry?.clone();t.cancel(),this._creationToolPromise=null,null!=n&&e?this._shouldRemoveLastPoint&&this._setSketchedGraphic(new E.Z({geometry:Oe(n)})):this._input=null})),Ce.Interaction),this._creationToolPromise=(0,c.R8)(t.create("polyline"))}_startReshapeInteraction(){this._stopInteraction();const e=this._view,t=this._sketchVM;if(null==e||null==t)return;const i=t.on("update",(e=>{const t=e.graphics[0];switch(e.state){case"complete":this._setSketchedGraphic(t),this._stopInteractionAndUpdate(),this._clearPreviousInput();break;case"active":case"start":this._setSketchedGraphic(t)}}));this.removeHandles(Ce.Interaction),this.addHandles((0,A.kB)((()=>{i.remove(),t.cancel(),this._updateToolPromise=null})),Ce.Interaction);const n=this._input;n&&(n.visible=!0,this._updateToolPromise=(0,c.R8)(t.update(n,{tool:"reshape"})))}_startSelectionInteraction(){this._stopInteraction();const e=this._view;if(null==e)return;const t=e.cursor,i=(0,A.kB)((()=>e.cursor=t));e.cursor="crosshair",e.closePopup();let n=null;const r=(0,A.kB)((()=>(0,a.IM)(n))),s=e.on("immediate-click",(t=>{t.defer((async()=>{(0,a.IM)(n),n=(0,o.vr)((async i=>{const{results:n}=await e.hitTest(t);(0,c.k_)(i);const r=n.filter((e=>"graphic"===e.type)).map((e=>e.graphic)).find((e=>null!=e.geometry&&"polyline"===e.geometry.type));r&&(t.preventDefault(),t.stopPropagation(),this._input=r,this._clearPreviousInput(),this._stopInteractionAndUpdate())})),await n.promise}))}),ke.f.TOOL),l=e.on("key-down",(e=>{"Escape"===e.key&&this.cancel()}));this.removeHandles(Ce.Interaction),this.addHandles([s,l,r,i],Ce.Interaction),e.ready&&e.focus()}_stopInteraction(){this.removeHandles(Ce.Interaction)}_stopInteractionAndUpdate(){this.hasHandles(Ce.Interaction)&&(this._updateDisabled=!0,this._stopInteraction(),this._updateDisabled=!1,this._triggerUpdate())}_triggerUpdate(){this._set("state",we.Ready),this._update()}_update(){if(this._updateDisabled)return;const e=this.state;if(e!==we.Selecting){if(this._visibleAndEditable){if(e===we.Creating||e===we.Reshaping&&this.isSketchedGraphic(this._input))return}else this.cancel();this._set("state",this._getNextState()),this._updateVisuals()}else this.stop()}_getNextState(){return null==this._input?we.Ready:this.isSketchedGraphic(this._input)?this.state===we.Creating?we.Creating:this._visibleAndEditable?we.Reshaping:we.ReshapingDisabled:we.Selected}_updateVisuals(){switch(this.state){case we.Creating:break;case we.Reshaping:this._startReshapeInteraction();break;case we.ReshapingDisabled:{this._stopInteractionAndUpdate();const e=this._input;null!=e&&this.isSketchedGraphic(e)&&(e.visible=!1);break}case we.Ready:case we.Selected:this._stopInteractionAndUpdate();case we.Selecting:}this._updateSketchedGraphic()}_storePreviousInput(e){this._previousInputInfo={graphic:e}}_restorePreviousInput(){const e=this._previousInputInfo;null!=e&&(this._clearPreviousInput(),this._input=e.graphic,this._triggerUpdate())}_clearPreviousInput(){this._previousInputInfo=null}_updateSketchedGraphic(){const e=this._graphicsLayer;if(null==e)return;const t=e.graphics,i=this._input;if(null!=i&&this.isSketchedGraphic(i)){if(-1===t.indexOf(i))t.removeAll(),t.add(i);else if(1!==t.length){const e=t.filter((e=>e!==i));t.removeMany(e)}}else t.removeAll()}_setSketchedGraphic(e){null!=e&&this._sketchedGraphics.add(e),this._input=e,this._updateSketchedGraphic()}};function Oe(e){if((0,V.l9)(e)){const t=e.clone();return t.paths=[t.paths[0].slice(0,-1)],t}return e}(0,s._)([(0,d.Cb)({nonNullable:!0})],Pe.prototype,"state",void 0),(0,s._)([(0,d.Cb)({nonNullable:!0})],Pe.prototype,"tool",void 0),(0,s._)([(0,d.Cb)()],Pe.prototype,"canStopCreating",null),(0,s._)([(0,d.Cb)()],Pe.prototype,"_graphicsLayer",void 0),(0,s._)([(0,d.Cb)()],Pe.prototype,"_sketchVM",void 0),(0,s._)([(0,d.Cb)()],Pe.prototype,"_input",null),(0,s._)([(0,d.Cb)()],Pe.prototype,"_geometry",null),(0,s._)([(0,d.Cb)()],Pe.prototype,"_visibleAndEditable",null),(0,s._)([(0,d.Cb)()],Pe.prototype,"_view",null),(0,s._)([(0,d.Cb)()],Pe.prototype,"_shouldRemoveLastPoint",void 0),Pe=(0,s._)([(0,p.j)("esri.widgets.ElevationProfile.ElevationProfileInteraction")],Pe);let Le=class extends S.Z{constructor(e){super(e),this._implementation=null,this._loadingTask=null}initialize(){this.addHandles((0,u.YP)((()=>({tool:this.tool,view:this.tool.viewModel.view,visible:this.tool.visible&&!!this.tool.viewModel.view?.ready})),(({tool:e,view:t,visible:i})=>{null!=t&&i?this._show(t,e):this._hide()}),u.tX))}destroy(){this._hide()}_show(e,t){this._loadingTask=(0,a.IM)(this._loadingTask),this._loadingTask=(0,o.vr)((async n=>{if("2d"===e.type){const r=Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(1663),i.e(33671)]).then(i.bind(i,35078)),s=(await(0,c.Hl)(r,n)).ElevationProfileView2D;this._implementation=new s(e,t)}else if("3d"===e.type){const r=Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(93891),i.e(92273),i.e(1663),i.e(35151),i.e(232),i.e(20562),i.e(43370)]).then(i.bind(i,2453)),s=(await(0,c.Hl)(r,n)).ElevationProfileView3D;this._implementation=new s(e,t)}}))}_hide(){this._loadingTask=(0,a.IM)(this._loadingTask),this._implementation=(0,a.SC)(this._implementation)}};(0,s._)([(0,d.Cb)()],Le.prototype,"tool",void 0),Le=(0,s._)([(0,p.j)("esri.widgets.ElevationProfile.support.ElevationProfileView")],Le);let Me=class extends S.Z{constructor(e){super(e),this.editable=!0,this.visible=!0,this.highlightEnabled=!0}initialize(){this.view=new Le({tool:this}),this.interaction=new Pe({tool:this})}destroy(){this.interaction.destroy(),this.view.destroy()}get state(){const e=this.interaction?.state;switch(e){case we.Ready:return N.dd.Ready;case we.Creating:return N.dd.Creating;case we.Selecting:return N.dd.Selecting;case we.Selected:return N.dd.Selected;case we.Reshaping:case we.ReshapingDisabled:return N.dd.Created}}};(0,s._)([(0,d.Cb)({nonNullable:!0})],Me.prototype,"viewModel",void 0),(0,s._)([(0,d.Cb)()],Me.prototype,"view",void 0),(0,s._)([(0,d.Cb)()],Me.prototype,"interaction",void 0),(0,s._)([(0,d.Cb)()],Me.prototype,"editable",void 0),(0,s._)([(0,d.Cb)()],Me.prototype,"visible",void 0),(0,s._)([(0,d.Cb)()],Me.prototype,"highlightEnabled",void 0),Me=(0,s._)([(0,p.j)("esri.widgets.ElevationProfile.ElevationProfileTool")],Me);var Re=i(41266),Ae=i(36091);let De=class extends S.Z{constructor(e){super(e),this.view=null,this.input=null,this._getEffectiveUnitsMemoized=(0,l.H)(((e,t)=>({distance:e,elevation:t}))),this.hoveredChartPosition=null,this.uniformChartScaling=!1,this.defaultUnit=null,this.queue=null,this._currentTileCache=null,this.error=null,this._defaultProfileLineGround=new te,this._userUnitOptions=null,this._userUnit=null,e?.profiles||(this.profiles=new I.Z([this._defaultProfileLineGround]))}initialize(){this.addHandles((0,u.YP)((()=>this.view),(e=>{if(null==e)return void h.Z.getLogger(this).warnOnce("no view. Widget will be disabled until a view is provided.");this.removeHandles(Fe);const t="3d"===e.type?e.resourceController:void 0;this.queue?.destroy(),this.queue=(0,z.Qr)(t?.scheduler);const i=t?.addUpdatingObject(this);i&&this.addHandles(i,Fe)}),u.tX)),this.tool=new Me({viewModel:this}),this._controller=new $({viewModel:this})}destroy(){this._defaultProfileLineGround=(0,a.SC)(this._defaultProfileLineGround),this._controller=(0,a.SC)(this._controller),this._currentTileCache=(0,a.SC)(this._currentTileCache),this.tool=(0,a.SC)(this.tool),this.queue=(0,a.SC)(this.queue)}get profiles(){return this._get("profiles")}set profiles(e){const t=this._get("profiles"),i=e??new I.Z;this._set("profiles",(0,P.Z)(i,t))}get state(){const e=this.view;return null!=e&&e.ready?this.tool.state:N.dd.Disabled}get progress(){let e=0,t=0;for(const i of this.visibleProfiles)e++,t+=i.progress;return e>0?t/e:0}set unitOptions(e){this._userUnitOptions=e,this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}get unitOptions(){return this._filteredOrAllUnits(this._userUnitOptions)}set unit(e){this._userUnit=e?this._findSelectableUnit(e,this._userUnit):null,this.notifyChange("unit")}get unit(){return this._userUnit?(this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit),this._userUnit):this._findSelectableUnit(this.defaultUnit)}get effectiveUnits(){const e=(0,Ae.lg)(this.visibleProfiles.map((e=>e.result))),t=(0,L.wd)(e.maxDistance,"meters",this.unit),i=(0,L.yv)(e.maxElevation,"meters",this.unit);return this._getEffectiveUnitsMemoized(t,i)}get highlightEnabled(){return this.tool.highlightEnabled}set highlightEnabled(e){this.tool.highlightEnabled=e}get hasVertices(){const e=this.input?.geometry;return(0,V.l9)(e)&&e.paths.reduce(((e,t)=>e+t.length),0)>0}get hoveredPoints(){return null!=this.input&&this.visible&&this.tool.editable?this.visibleProfiles.map((e=>{const t=e.hoveredPoint;return null!=t?{hoveredPoint:t,color:e.color}:null})).filter(T.pC):[]}get statistics(){return(0,Ae.Ds)(this.visibleProfiles.map((e=>e.statistics)))}get chartData(){if(null==this.input)return null;const{effectiveUnits:e,progress:t,statistics:i,visibleProfiles:n,uniformChartScaling:r}=this,s=n.filter((e=>e.hasZ)).map((e=>({id:e.id,type:e.type,title:e.title,color:e.color,samples:e.samples,progress:e.progress,chartFillEnabled:e.chartFillEnabled,chartStrokeWidth:e.chartStrokeWidth,chartStrokeOffsetY:e.chartStrokeOffsetY,viewVisualizationEnabled:e.viewVisualizationEnabled})));return 0===s.length?null:{lines:s,effectiveUnits:e,statistics:i,refined:1===t,dynamicElevationRange:n.some((e=>"view"===e.type)),uniformScaling:r}}get visibleProfiles(){return this.profiles.toArray().filter((e=>e.available&&e.visible))}get minDemResolutions(){const e=[];for(const{minDemResolution:t}of this.visibleProfiles)null!=t&&e.push(t);return e}get minDemResolution(){return(0,T.VV)(this.minDemResolutions)}get errorState(){const e=this.input?.geometry;if(!(0,V.G9)(e))return N.J8.NoValidInput;if(null!=this.error){if((0,Re.eq)(this.error))switch(this.error.cause){case Re.k2.TooComplex:return N.J8.TooComplex;case Re.k2.InvalidGeometry:return N.J8.InvalidGeometry;case Re.k2.InvalidElevationInfo:return N.J8.InvalidElevationInfo;case Re.k2.ElevationQueryError:return N.J8.NoValidInput}return N.J8.UnknownError}return 0===this.visibleProfiles.length?N.J8.NoVisibleProfiles:null==this.chartData&&1===this.progress?N.J8.RefinedButNoChartData:N.J8.None}get tileCache(){this._currentTileCache=(0,a.SC)(this._currentTileCache);const e=this.view;if(null!=e&&"3d"===e?.type){const t=e.basemapTerrain?.elevationQueryCache;if(null!=t)return t}return null==this._currentTileCache&&(this._currentTileCache=new M.b(new O.z(20*k.Y.MEGABYTES))),this._currentTileCache}get visible(){return this.tool.visible}set visible(e){this.tool.visible=e}get selectAvailable(){for(const e of this.view?.map?.allLayers??[]){if("graphics"===e.type&&!e.internal&&e.graphics.some((e=>"polyline"===e.geometry?.type)))return!0;if("geometryType"in e&&"polyline"===e.geometryType)return!0}return!!this.view?.graphics?.some((e=>"polyline"===e.geometry?.type))}get inputIsSketched(){return this.tool.interaction.isSketchedGraphic(this.input)}get elevationProvider(){const e=this.view;return null!=e&&"3d"===e.type?e.elevationProvider:null}get updating(){const{progress:e}=this,t=!!this.queue?.updating;return e>0&&e<1||t}start(e){this.tool.interaction.start(e)}stop(){this.tool.interaction.stop()}cancel(){this.tool.interaction.cancel()}clear(){this.tool.interaction.clear()}_findSelectableUnit(e,t){const i=this.unitOptions;return null!=e&&i.includes(e)?e:t?this._findSelectableUnit(t):i[0]}_filteredOrAllUnits(e){const t=(null!=e?e:[]).filter((e=>L.oD.includes(e)));return 0===t.length?L.oD.slice():t}};(0,s._)([(0,d.Cb)()],De.prototype,"view",void 0),(0,s._)([(0,d.Cb)({type:E.Z})],De.prototype,"input",void 0),(0,s._)([(0,d.Cb)({type:_e,nonNullable:!0})],De.prototype,"profiles",null),(0,s._)([(0,d.Cb)({readOnly:!0})],De.prototype,"state",null),(0,s._)([(0,d.Cb)({readOnly:!0})],De.prototype,"progress",null),(0,s._)([(0,d.Cb)()],De.prototype,"unitOptions",null),(0,s._)([(0,d.Cb)()],De.prototype,"unit",null),(0,s._)([(0,d.Cb)({readOnly:!0})],De.prototype,"effectiveUnits",null),(0,s._)([(0,d.Cb)()],De.prototype,"hoveredChartPosition",void 0),(0,s._)([(0,d.Cb)()],De.prototype,"uniformChartScaling",void 0),(0,s._)([(0,d.Cb)()],De.prototype,"highlightEnabled",null),(0,s._)([(0,d.Cb)({readOnly:!0})],De.prototype,"hoveredPoints",null),(0,s._)([(0,d.Cb)({readOnly:!0})],De.prototype,"statistics",null),(0,s._)([(0,d.Cb)()],De.prototype,"chartData",null),(0,s._)([(0,d.Cb)()],De.prototype,"visibleProfiles",null),(0,s._)([(0,d.Cb)()],De.prototype,"minDemResolutions",null),(0,s._)([(0,d.Cb)({readOnly:!0})],De.prototype,"minDemResolution",null),(0,s._)([(0,d.Cb)({readOnly:!0})],De.prototype,"errorState",null),(0,s._)([(0,d.Cb)(R.Y)],De.prototype,"defaultUnit",void 0),(0,s._)([(0,d.Cb)()],De.prototype,"queue",void 0),(0,s._)([(0,d.Cb)()],De.prototype,"tileCache",null),(0,s._)([(0,d.Cb)()],De.prototype,"tool",void 0),(0,s._)([(0,d.Cb)()],De.prototype,"visible",null),(0,s._)([(0,d.Cb)()],De.prototype,"error",void 0),(0,s._)([(0,d.Cb)()],De.prototype,"selectAvailable",null),(0,s._)([(0,d.Cb)()],De.prototype,"inputIsSketched",null),(0,s._)([(0,d.Cb)()],De.prototype,"elevationProvider",null),(0,s._)([(0,d.Cb)()],De.prototype,"updating",null),(0,s._)([(0,d.Cb)()],De.prototype,"_defaultProfileLineGround",void 0),(0,s._)([(0,d.Cb)()],De.prototype,"_userUnitOptions",void 0),(0,s._)([(0,d.Cb)()],De.prototype,"_controller",void 0),(0,s._)([(0,d.Cb)()],De.prototype,"_userUnit",void 0),De=(0,s._)([(0,p.j)("esri.widgets.ElevationProfile.ElevationProfileViewModel")],De);const Fe=Symbol("updating-object"),Ne=De;let Ve=class extends S.Z{constructor(){super(...arguments),this.legend=!0,this.chart=!0,this.clearButton=!0,this.settingsButton=!0,this.sketchButton=!0,this.selectButton=!0,this.unitSelector=!0,this.uniformChartScalingToggle=!0}};(0,s._)([(0,d.Cb)()],Ve.prototype,"legend",void 0),(0,s._)([(0,d.Cb)()],Ve.prototype,"chart",void 0),(0,s._)([(0,d.Cb)()],Ve.prototype,"clearButton",void 0),(0,s._)([(0,d.Cb)()],Ve.prototype,"settingsButton",void 0),(0,s._)([(0,d.Cb)()],Ve.prototype,"sketchButton",void 0),(0,s._)([(0,d.Cb)()],Ve.prototype,"selectButton",void 0),(0,s._)([(0,d.Cb)()],Ve.prototype,"unitSelector",void 0),(0,s._)([(0,d.Cb)()],Ve.prototype,"uniformChartScalingToggle",void 0),Ve=(0,s._)([(0,p.j)("esri.widgets.ElevationProfile.ElevationProfileVisibleElements")],Ve);const ze=Ve;i(55214);var Ue=i(51067),$e=i(84644),Be=(i(68808),i(24225)),je=i(23039);let He=class extends m.Z{constructor(e,t){super(e,t),this._updateLayout=e=>{const t=e.parentElement,i=e.style.display;t?.removeChild(e),document.body.appendChild(e),e.style.display="block";let n=80;for(const t of e.childNodes)t instanceof HTMLElement&&(n=Math.max(n,t.offsetWidth));document.body.removeChild(e),t?.appendChild(e),e.style.display=i,e.style.setProperty("--max-width",`${n}px`)},this._updateLayoutThrottled=(0,D.P)(this._updateLayout,100)}loadDependencies(){return(0,$e.h)({icon:()=>Promise.resolve().then(i.bind(i,4204))})}initialize(){this.addHandles(this._updateLayoutThrottled)}render(){return(0,je.u)("div",{afterCreate:this._updateLayout,afterUpdate:this._updateLayoutThrottled,bind:this,class:w.base},this._renderStatistics())}_renderStatistics(){const e=this._messages?.statistics;return e?[this._renderDistanceStatistic("maxDistance",e.maxDistance),this._renderElevationStatistic("elevationGain",e.gain),this._renderElevationStatistic("elevationLoss",e.loss),this._renderElevationStatistic("minElevation",e.minElevation),this._renderElevationStatistic("maxElevation",e.maxElevation),this._renderElevationStatistic("avgElevation",e.avgElevation),this._renderSlopeStatistic("maxPositiveSlope","maxNegativeSlope",e.maxSlope),this._renderSlopeStatistic("avgPositiveSlope","avgNegativeSlope",e.avgSlope)]:[]}_renderDistanceStatistic(e,t){const i=(0,N.iE)().formatPrecision,n=this._renderValue(e,(e=>{const t=this.effectiveUnits.distance;return(0,Ue.VG)(this._messagesUnits,e,t,i)}));return this._renderStatistic(t,n)}_renderElevationStatistic(e,t){const i=(0,N.iE)().formatPrecision,n=this._renderValue(e,(e=>{const t=this.effectiveUnits.elevation;return(0,Ue.VG)(this._messagesUnits,e,t,i)}));return this._renderStatistic(t,n)}_renderSlopeStatistic(e,t,i){const n=(0,N.iE)().formatPrecision,r=(0,je.u)("div",{class:w.slopeValue,key:"slope-up"},(0,je.u)("calcite-icon",{icon:"arrow-up",scale:"s"}),this._renderValue(e,(e=>(0,Ue.L4)(e,"degrees","geographic","geographic",n))),(0,je.u)("calcite-icon",{icon:"arrow-down",scale:"s"}),this._renderValue(t,(e=>(0,Ue.L4)(e,"degrees","geographic","geographic",n))));return this._renderStatistic(i,r)}_renderStatistic(e,t){return(0,je.u)("div",{class:w.statistic},(0,je.u)("label",{class:w.statisticLabel},e),(0,je.u)("div",{class:w.statisticValue},t))}_renderValue(e,t){const i=this.line,n=(1===i.progress?i.statistics:null)?.[e];return null!=n?t(n):N.h8}};(0,s._)([(0,d.Cb)()],He.prototype,"effectiveUnits",void 0),(0,s._)([(0,d.Cb)()],He.prototype,"line",void 0),(0,s._)([(0,d.Cb)(),(0,Be.H)("esri/widgets/ElevationProfile/t9n/ElevationProfile")],He.prototype,"_messages",void 0),(0,s._)([(0,d.Cb)(),(0,Be.H)("esri/core/t9n/Units")],He.prototype,"_messagesUnits",void 0),He=(0,s._)([(0,p.j)("esri.widgets.ElevationProfile.components.Statistics")],He);var Ze=i(8221),qe=i(37964);let Ge=class extends m.Z{constructor(e,t){super(e,t),this.checkboxVisible=!0,this.expanded=!1}loadDependencies(){return(0,$e.h)({action:()=>Promise.resolve().then(i.bind(i,11030)),checkbox:()=>i.e(14530).then(i.bind(i,69397)),label:()=>Promise.resolve().then(i.bind(i,36650))})}initialize(){this._statistics=new He(this._statisticsProps),this.addHandles((0,u.YP)((()=>this._statisticsProps),(e=>this._statistics.set(e))))}destroy(){this._statistics=(0,a.SC)(this._statistics)}render(){const e=this.expanded;return(0,je.u)("div",{class:this.classes(b.base,{[b.disabled]:this.disabled,[b.expanded]:e}),key:this},this._renderColorIndicator(),(0,je.u)("div",{class:b.header,key:"header"},this._renderLabelWithCheckbox(),this._renderCollapseToggleButton()),e?(0,je.u)("div",{class:b.content,key:"content"},this._statistics.render()):null)}get disabled(){return!this.line.available}get _statisticsProps(){return{line:this.line,effectiveUnits:this.effectiveUnits}}_renderColorIndicator(){return(0,je.u)("div",{class:b.colorIndicator,key:"color-indicator",styles:{backgroundColor:this.line.color.toCss()}})}_renderCollapseToggleButton(){const{expanded:e,messages:t}=this,i=e?t.hideDetails:t.showDetails;return(0,je.u)("calcite-action",{appearance:"transparent",bind:this,class:b.collapseToggle,"data-testid":"legend-toggle",icon:e?"chevron-up":"chevron-down",key:"collapse-toggle",onclick:this._onCollapseToggleClick,scale:"s",text:i,title:i})}_onCollapseToggleClick(){this.onExpandedToggle()}_renderLabelWithCheckbox(){const{line:e,checkboxVisible:t,disabled:i,messages:n}=this;return(0,je.u)("calcite-label",{class:b.label,disabled:i,key:`label-${e.id}`,layout:"inline"},t?this._renderCheckbox():null,(0,Ze.f)(e,n))}_renderCheckbox(){const{disabled:e,line:t,messages:i}=this,n=t.visible,r=n?i.hideProfile:i.showProfile,s=(0,qe.n)(r,{name:(0,Ze.f)(t,i)});return(0,je.u)("calcite-checkbox",{checked:n,class:b.checkbox,disabled:e,title:s,onCalciteCheckboxChange:()=>t.toggleVisibility()})}};(0,s._)([(0,d.Cb)()],Ge.prototype,"checkboxVisible",void 0),(0,s._)([(0,d.Cb)()],Ge.prototype,"disabled",null),(0,s._)([(0,d.Cb)({nonNullable:!0})],Ge.prototype,"effectiveUnits",void 0),(0,s._)([(0,d.Cb)()],Ge.prototype,"expanded",void 0),(0,s._)([(0,d.Cb)({nonNullable:!0})],Ge.prototype,"line",void 0),(0,s._)([(0,d.Cb)()],Ge.prototype,"messages",void 0),(0,s._)([(0,d.Cb)()],Ge.prototype,"onExpandedToggle",void 0),(0,s._)([(0,d.Cb)()],Ge.prototype,"_statistics",void 0),Ge=(0,s._)([(0,p.j)("esri.widgets.ElevationProfile.components.LegendItem")],Ge);let We=class extends m.Z{constructor(){super(...arguments),this._expandedLine=null}render(){const{profiles:e,messages:t,effectiveUnits:i,_expandedLine:n}=this;return(0,je.u)("div",{class:g},e.map((r=>(0,je.u)(Ge,{checkboxVisible:e.length>1,effectiveUnits:i,expanded:r===n,line:r,messages:t,onExpandedToggle:()=>this._onExpandedToggle(r)}))))}_onExpandedToggle(e){this._expandedLine=e===this._expandedLine?null:e}};(0,s._)([(0,d.Cb)()],We.prototype,"effectiveUnits",void 0),(0,s._)([(0,d.Cb)()],We.prototype,"messages",void 0),(0,s._)([(0,d.Cb)()],We.prototype,"profiles",void 0),(0,s._)([(0,d.Cb)()],We.prototype,"_expandedLine",void 0),We=(0,s._)([(0,p.j)("esri.widgets.ElevationProfile.components.Legend")],We);const Ye="esri-unit-select",Qe={base:Ye,label:`${Ye}__label`,select:`${Ye}__select`};let Ke=class extends m.Z{constructor(e,t){super(e,t),this._onSelectChange=e=>{this.onChange(e.currentTarget.value)}}loadDependencies(){return(0,$e.h)({label:()=>Promise.resolve().then(i.bind(i,36650)),option:()=>Promise.resolve().then(i.bind(i,26344)),select:()=>Promise.resolve().then(i.bind(i,44015))})}render(){const{messages:e,options:t,selectLabel:i,value:n,_onSelectChange:r}=this;return(0,je.u)("div",{class:Qe.base,key:"units"},(0,je.u)("calcite-label",{class:Qe.label},i,(0,je.u)("calcite-select",{class:Qe.select,label:i,onCalciteSelectChange:r},t.map((t=>(0,je.u)("calcite-option",{key:t,selected:t===n,value:t},(0,L.ZO)(t)?e.systems[t]:e.units[t]?.pluralCapitalized))))))}};(0,s._)([(0,d.Cb)()],Ke.prototype,"options",void 0),(0,s._)([(0,d.Cb)()],Ke.prototype,"onChange",void 0),(0,s._)([(0,d.Cb)()],Ke.prototype,"selectLabel",void 0),(0,s._)([(0,d.Cb)()],Ke.prototype,"value",void 0),(0,s._)([(0,d.Cb)(),(0,Be.H)("esri/core/t9n/Units")],Ke.prototype,"messages",void 0),Ke=(0,s._)([(0,p.j)("esri.widgets.support.UnitSelect")],Ke);let Je=class extends m.Z{constructor(){super(...arguments),this.messages=null,this._popoverIsOpen=!1,this._referenceElement=null,this._onUniformChartScalingChange=e=>{this.onUniformChartScalingChange(e.currentTarget.checked)}}loadDependencies(){return(0,$e.h)({action:()=>Promise.resolve().then(i.bind(i,11030)),checkbox:()=>i.e(14530).then(i.bind(i,69397)),label:()=>Promise.resolve().then(i.bind(i,36650)),popover:()=>Promise.all([i.e(71823),i.e(99144)]).then(i.bind(i,24006))})}render(){const{id:e,messages:t,visibleElements:i}=this,{unitSelector:n,uniformChartScalingToggle:r}=i;if(!t||!n&&!r)return(0,je.u)("div",{key:`${e}-empty`});const s=this._popoverIsOpen?t.hideSettings:t.showSettings;return(0,je.u)("div",{class:x.base,key:this},(0,je.u)("calcite-action",{afterCreate:e=>{this._referenceElement=e},appearance:"transparent","data-testid":"settings-button",icon:"gear",scale:"s",text:s,title:s}),this._referenceElement?(0,je.u)("calcite-popover",{autoClose:!0,label:s,placement:"bottom-end",referenceElement:this._referenceElement,onCalcitePopoverClose:()=>{this._popoverIsOpen=!1},onCalcitePopoverOpen:()=>{this._popoverIsOpen=!0}},this._renderPopoverContent()):null)}_renderPopoverContent(){const{unitSelector:e,uniformChartScalingToggle:t}=this.visibleElements;return(0,je.u)("div",{class:x.popoverContent},e?this._renderUnitSelector():null,t?this._renderUniformChartScalingToggle():null)}_renderUnitSelector(){const{messages:e}=this;return(0,je.u)(Ke,{key:"unit-selector-label",options:this.unitOptions,selectLabel:e?.unitSelectLabel??"",value:this.unit,onChange:this.onUnitChange})}_renderUniformChartScalingToggle(){const{messages:e}=this,t=this.uniformChartScaling,i=e?.[t?"uniformChartScalingDisable":"uniformChartScalingEnable"]??"";return(0,je.u)("calcite-label",{class:x.uniformChartScalingLabel,key:"uniform-chart-scaling-label",layout:"inline"},(0,je.u)("calcite-checkbox",{checked:t,class:x.uniformChartScalingCheckbox,title:i,onCalciteCheckboxChange:this._onUniformChartScalingChange}),e?.uniformChartScalingLabel)}};(0,s._)([(0,d.Cb)()],Je.prototype,"messages",void 0),(0,s._)([(0,d.Cb)()],Je.prototype,"onUniformChartScalingChange",void 0),(0,s._)([(0,d.Cb)()],Je.prototype,"onUnitChange",void 0),(0,s._)([(0,d.Cb)()],Je.prototype,"uniformChartScaling",void 0),(0,s._)([(0,d.Cb)()],Je.prototype,"unit",void 0),(0,s._)([(0,d.Cb)()],Je.prototype,"unitOptions",void 0),(0,s._)([(0,d.Cb)()],Je.prototype,"visibleElements",void 0),(0,s._)([(0,d.Cb)()],Je.prototype,"_popoverIsOpen",void 0),(0,s._)([(0,d.Cb)()],Je.prototype,"_referenceElement",void 0),Je=(0,s._)([(0,p.j)("esri.widgets.ElevationProfile.components.SettingsButton")],Je);var Xe,et=i(46512);!function(e){e.Sketch="sketch",e.SketchCancel="sketch-cancel",e.SketchDone="sketch-done",e.Select="select",e.SelectCancel="select-cancel"}(Xe||(Xe={}));const tt=[{type:Xe.Select},{type:Xe.Sketch}],it={[N.J8.None]:null,[N.J8.NoValidInput]:"noProfile",[N.J8.NoVisibleProfiles]:"noProfile",[N.J8.RefinedButNoChartData]:"noProfile",[N.J8.TooComplex]:"tooComplex",[N.J8.UnknownError]:"unknown",[N.J8.InvalidGeometry]:"invalidGeometry",[N.J8.InvalidElevationInfo]:"invalidElevationInfo"};let nt=class extends m.Z{constructor(e,t){super(e,t),this.viewModel=null,this.visibleElements=new ze,this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this._chartContainer=null,this._chart=null,this._chartInitTask=null,this._chartIsRefined=!1,this._zoomOutButtonVisible=!1,this._getChartUpdateParamsMemoized=(0,l.H)(((e,t,i,n)=>({chart:e,data:t,stationary:i,messages:n}))),this._onZoomOutButtonClick=()=>{this._chart?.zoomOut()},this._onClearButtonClick=()=>{this.viewModel.clear()},e?.viewModel||(this._defaultViewModel=new Ne({view:e?.view}),this.viewModel=this._defaultViewModel)}loadDependencies(){return(0,$e.h)({action:()=>Promise.resolve().then(i.bind(i,11030)),button:()=>Promise.resolve().then(i.bind(i,61637)),loader:()=>Promise.resolve().then(i.bind(i,55001))})}postInitialize(){this.addHandles([(0,u.YP)((()=>({container:this._chartContainer})),(({container:e})=>{this._destroyChart(),null!=e&&this._initializeChart(e)}),u.nn),(0,u.YP)((()=>this._chartUpdateParams),(()=>this._updateChart(this._chartUpdateParams)),u.nn)])}destroy(){this._destroyChart(),null!=this._defaultViewModel&&this.viewModel!==this._defaultViewModel&&this._defaultViewModel.destroy()}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get input(){return this.viewModel.input}set input(e){this.viewModel.input=e}get profiles(){return this.viewModel.profiles}set profiles(e){this.viewModel.profiles=e}get unitOptions(){return this.viewModel.unitOptions}set unitOptions(e){this.viewModel.unitOptions=e}get unit(){return this.viewModel.unit}set unit(e){this.viewModel.unit=e}get icon(){return"altitude"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}get test(){return{chart:this._chart}}get _selectButtonVisible(){return!0===this.visibleElements.selectButton&&this.viewModel.selectAvailable}get _chartUpdateParams(){const e=this.view;return this._getChartUpdateParamsMemoized(this._chart,this.viewModel.chartData,null==e||e.stationary,this._chartMessages)}get _chartMessages(){return{...this.messagesUnits,...this.messages}}get _profilesArray(){return this.profiles.toArray()}render(){const{viewModel:e,visible:t}=this;return(0,je.u)("div",{"aria-label":this.messages.widgetLabel,class:this.classes({[v.base]:t,[et.z.widget]:t,[et.z.panel]:t,[et.z.widgetDisabled]:t&&"disabled"===e.state,[v.refined]:1===e.progress}),key:this},(0,je.u)("div",{bind:this,key:"content-wrapper"},t?this._renderContentForState():null))}_renderContentForState(){switch(this.viewModel.state){case N.dd.Ready:return this._renderContentForReadyState();case N.dd.Selecting:return this._renderContentForSelectingState();case N.dd.Creating:return this._renderContentForCreatingState();case N.dd.Selected:return this._renderContentForSelectedState();case N.dd.Created:return this._renderContentForCreatedState();case N.dd.Disabled:return this._renderContentForReadyState()}}_renderContentForReadyState(){const{messages:e,visibleElements:t,_selectButtonVisible:i}=this,{sketchButton:n}=t;let r;return r=n&&i?e.readyPrompt:n?e.readyPromptCreateOnly:i?e.readyPromptSelectOnly:e.errors?.noProfile,this._renderContent({prompt:r,chart:!1,actions:tt})}_renderContentForSelectingState(){const{view:e}=this;if(null==e)return null;const t=this.messages[`selectingPrompt-${e.type}`];return this._renderContent({prompt:t,chart:!1,actions:[{type:Xe.SelectCancel}]})}_renderContentForCreatingState(){const{view:e,viewModel:t}=this;if(null==e)return null;const i=t.hasVertices?[{type:Xe.SketchCancel},{type:Xe.SketchDone,disabled:!t.tool.interaction.canStopCreating}]:[{type:Xe.Select},{type:Xe.Sketch,disabled:!0}];if(t.errorState===N.J8.NoValidInput){const t=this.messages[`creatingPrompt-${e.type}`];return this._renderContent({chart:!1,actions:i,prompt:t})}const n=this._getErrorMessage();return n?this._renderContent({chart:!1,actions:i,prompt:n}):this._renderContent({chart:!0,actions:i})}_renderContentForSelectedState(){const e=this._getErrorMessage();return e?this._renderContent({chart:!1,actions:tt,prompt:e}):this._renderContent({chart:!0,actions:tt})}_renderContentForCreatedState(){const e=this._getErrorMessage();return e?this._renderContent({chart:!1,actions:tt,prompt:e}):this._renderContent({chart:!0,actions:tt})}_getErrorMessage(){const e=it[this.viewModel.errorState];return e?this.messages?.errors?.[e]:null}_renderContent(e){const t=null!=e.prompt?this._renderPrompt(e.prompt):e.chart&&this._renderChart(),{viewModel:i}=this,n=null!=i.input;return(0,je.u)(je.D,null,(0,je.u)("header",{class:v.header,key:"header"},this._zoomOutButtonVisible?this._renderZoomOutButton():null,this.visibleElements.clearButton&&n?this._renderClearButton():null,this.visibleElements.settingsButton?(0,je.u)(Je,{messages:this.messages,uniformChartScaling:i.uniformChartScaling,unit:i.unit,unitOptions:i.unitOptions,visibleElements:this.visibleElements,onUniformChartScalingChange:e=>i.uniformChartScaling=e,onUnitChange:e=>i.unit=e}):null),(0,je.u)("div",{class:v.mainContainer,key:"main-container"},t),this.visibleElements.legend?(0,je.u)(We,{effectiveUnits:i.effectiveUnits,messages:this.messages,profiles:this._profilesArray}):null,this._renderActions(e))}_renderZoomOutButton(){const e=this.messages.zoomOut;return(0,je.u)("calcite-action",{appearance:"transparent",class:v.zoomOutButton,"data-testid":"zoom-out-button",icon:"magnifying-glass-minus",key:"zoom-out",onclick:this._onZoomOutButtonClick,scale:"s",text:e,title:e})}_renderClearButton(){const e=this.messages.clearProfile;return(0,je.u)("calcite-action",{appearance:"transparent",class:v.clearButton,"data-testid":"clear-button",icon:"trash",key:"clear-profile",onclick:this._onClearButtonClick,scale:"s",text:e,title:e})}_renderPrompt(e){return[(0,je.u)("div",{bind:this,class:v.promptContainer,key:"prompt-container"},(0,je.u)("p",null,e))]}_renderChart(){if(!this.visibleElements.chart)return(0,je.u)("div",{class:v.chartContainer,key:"empty-chart-container"});const{chartData:e,progress:t}=this.viewModel,i=this._chartIsRefined||this._canRenderChart(),n=null!=e&&t<1;return i?(0,je.u)(je.D,null,this._renderSpinner({size:i?"small":"large",visible:n}),(0,je.u)("div",{afterCreate:this._onChartContainerUpdate,afterRemoved:this._onChartContainerRemoved,afterUpdate:this._onChartContainerUpdate,bind:this,class:v.chartContainer,key:"chart-container"})):(0,je.u)(je.D,null,this._renderSpinner({size:"large",visible:n}),(0,je.u)("div",{class:v.chartContainer,key:"chart-container-empty"}))}_renderSpinner(e){const t="small"===e.size,i=e.visible??!0;return(0,je.u)("calcite-loader",{class:this.classes(v.chartSpinner,t&&v.chartSpinnerSmall,i&&v.chartSpinnerVisible),"data-testid":"chart-spinner",inline:t,key:"spinner",label:"",scale:"s"})}_canRenderChart(){const e=this.viewModel.chartData;if(null==e)return!1;if(!this.viewModel.inputIsSketched)return e.refined;let t=0;for(const{samples:i}of e.lines)t+=null!=i?i.length:0;return e.refined||t<=(0,N.iE)().largeChartSamples}_renderActions({actions:e}){const t=e.map((e=>{switch(e.type){case Xe.Sketch:return this.visibleElements.sketchButton&&this._renderAction({action:e,className:v.sketchButton,label:this.messages.sketchButtonLabel,onClick:this._onSketchButtonClick,primary:!0});case Xe.SketchCancel:return this.visibleElements.sketchButton&&this._renderAction({action:e,onClick:this._onCancelButtonClick,className:v.sketchCancelButton,label:this.messagesCommon.cancel,primary:!1});case Xe.SketchDone:return this.visibleElements.sketchButton&&this._renderAction({action:e,onClick:this._onDoneButtonClick,className:v.sketchDoneButton,label:this.messagesCommon.done,primary:!0});case Xe.Select:return this._selectButtonVisible&&this._renderAction({action:e,onClick:this._onSelectButtonClick,className:v.selectButton,label:this.messages.selectButtonLabel,primary:!1});case Xe.SelectCancel:return this._selectButtonVisible&&this._renderAction({action:e,onClick:this._onCancelButtonClick,className:v.selectCancelButton,label:this.messagesCommon.cancel,primary:!1})}})).filter(Boolean);return t.length?(0,je.u)("footer",{class:v.footer,key:"footer"},t):null}_renderAction({action:e,className:t,label:i,onClick:n,primary:r}){return(0,je.u)("calcite-button",{appearance:r?"solid":"outline-fill",bind:this,class:this.classes(v.actionButton,t),disabled:e.disabled,key:`action-${e.type}`,onclick:n},i)}_onSketchButtonClick(){this.viewModel.start({mode:"sketch"})}_onSelectButtonClick(){this.viewModel.start({mode:"select"})}_onCancelButtonClick(){this.viewModel.cancel()}_onDoneButtonClick(){this.viewModel.stop()}_updateChart(e){const{data:t,chart:i,messages:n,stationary:r}=e;null!=i&&null!=n&&r&&this._canRenderChart()&&(i.update(e),this._chartIsRefined=null!=t&&t.refined)}_onChartContainerUpdate(e){this._chartContainer=e}_onChartContainerRemoved(e){this._chartContainer===e&&(this._chartContainer=null)}_initializeChart(e){(0,a.IM)(this._chartInitTask),this._chartInitTask=(0,o.vr)((async t=>{const{createChart:n}=await Promise.all([i.e(6466),i.e(11542),i.e(91085),i.e(5048),i.e(83270)]).then(i.bind(i,42536));(0,c.k_)(t);const r=await n({container:e,abortOptions:{signal:t},onRangeChange:(e,t)=>{this._zoomOutButtonVisible=1!==e||1!==t},onCursorPositionChange:e=>{this.viewModel.hoveredChartPosition=e}});if(t.aborted)throw(0,a.SC)(r),(0,c.zE)();this._chart=r,this._updateChart(this._chartUpdateParams)}))}_destroyChart(){this._chartInitTask=(0,a.IM)(this._chartInitTask),this._chart=(0,a.SC)(this._chart),this._chartIsRefined=!1}};(0,s._)([(0,d.Cb)({type:Ne})],nt.prototype,"viewModel",void 0),(0,s._)([(0,d.Cb)()],nt.prototype,"view",null),(0,s._)([(0,d.Cb)()],nt.prototype,"input",null),(0,s._)([(0,d.Cb)()],nt.prototype,"profiles",null),(0,s._)([(0,d.Cb)()],nt.prototype,"unitOptions",null),(0,s._)([(0,d.Cb)()],nt.prototype,"unit",null),(0,s._)([(0,d.Cb)({type:ze,nonNullable:!0})],nt.prototype,"visibleElements",void 0),(0,s._)([(0,d.Cb)()],nt.prototype,"icon",null),(0,s._)([(0,d.Cb)()],nt.prototype,"label",null),(0,s._)([(0,d.Cb)()],nt.prototype,"visible",null),(0,s._)([(0,d.Cb)(),(0,Be.H)("esri/widgets/ElevationProfile/t9n/ElevationProfile")],nt.prototype,"messages",void 0),(0,s._)([(0,d.Cb)(),(0,Be.H)("esri/t9n/common")],nt.prototype,"messagesCommon",void 0),(0,s._)([(0,d.Cb)(),(0,Be.H)("esri/core/t9n/Units")],nt.prototype,"messagesUnits",void 0),(0,s._)([(0,d.Cb)()],nt.prototype,"_chartContainer",void 0),(0,s._)([(0,d.Cb)()],nt.prototype,"_chart",void 0),(0,s._)([(0,d.Cb)()],nt.prototype,"_chartInitTask",void 0),(0,s._)([(0,d.Cb)()],nt.prototype,"_chartIsRefined",void 0),(0,s._)([(0,d.Cb)()],nt.prototype,"_zoomOutButtonVisible",void 0),(0,s._)([(0,d.Cb)()],nt.prototype,"_selectButtonVisible",null),(0,s._)([(0,d.Cb)()],nt.prototype,"_chartUpdateParams",null),(0,s._)([(0,d.Cb)()],nt.prototype,"_chartMessages",null),(0,s._)([(0,d.Cb)()],nt.prototype,"_profilesArray",null),nt=(0,s._)([(0,p.j)("esri.widgets.ElevationProfile")],nt);const rt=nt;var st=i(54503),ot=i(8403);const at=i(49006).iv`@layer{arcgis-elevation-profile{display:block}}`,lt=(0,ot.m)(rt);class ct extends st.oi{constructor(){super(...arguments),this.widget=lt(this),this.viewModel=this.widget.viewModel,this.autoDestroyDisabled=!1,this.effectiveUnits=this.viewModel.effectiveUnits,this.hideChart=this.widget.visibleElements.chart,this.hideClearButton=this.widget.visibleElements.clearButton,this.hideLegend=this.widget.visibleElements.legend,this.hideSelectButton=this.widget.visibleElements.selectButton,this.hideSettingsButton=this.widget.visibleElements.settingsButton,this.hideSketchButton=this.widget.visibleElements.sketchButton,this.hideUniformChartScalingToggle=this.widget.visibleElements.uniformChartScalingToggle,this.hideUnitSelector=this.widget.visibleElements.unitSelector,this.highlightEnabled=this.viewModel.highlightEnabled,this.hoveredChartPosition=this.viewModel.hoveredChartPosition,this.icon=this.widget.icon,this.input=this.widget.input,this.label=this.widget.label,this.position="bottom-left",this.profiles=this.widget.profiles,this.progress=this.viewModel.progress,this.state=this.viewModel.state,this.uniformChartScaling=this.viewModel.uniformChartScaling,this.unit=this.widget.unit,this.unitOptions=this.widget.unitOptions,this.arcgisPropertyChange=(0,r.OR)()("input","effectiveUnits","progress","state"),this.arcgisReady=(0,st.yM)()}static{this.properties={autoDestroyDisabled:5,effectiveUnits:0,hideChart:5,hideClearButton:5,hideLegend:5,hideSelectButton:5,hideSettingsButton:5,hideSketchButton:5,hideUniformChartScalingToggle:5,hideUnitSelector:5,highlightEnabled:5,hoveredChartPosition:9,icon:1,input:0,label:1,position:1,profiles:0,progress:8,referenceElement:1,state:3,uniformChartScaling:5,unit:1,unitOptions:0}}static{this.shadowRootOptions=st.hZ}static{this.styles=at}async destroy(){await this.manager.destroy()}async start(){this.widget.viewModel.start()}async stop(){this.widget.viewModel.stop()}}(0,n.c)("arcgis-elevation-profile",ct)},64678:function(e,t,i){i(61637);var n=i(64297),r=i(15294),s=i(20803),o=i(54503),a=i(49006),l=i(29359),c=i(41203),u=i(97237),d=i(60629),h=i(51741),p=i(49898);const m=a.iv`@layer{arcgis-line-of-sight{display:block}.arcgis-line-of-sight__container{display:flex;position:relative;flex-flow:column;gap:var(--calcite-spacing-md);padding:var(--esri-widget-padding);overflow-y:auto}.arcgis-line-of-sight__error{color:var(--calcite-color-status-danger)}.arcgis-line-of-sight__hint{display:flex;flex-direction:column;gap:var(--calcite-spacing-md)}.arcgis-line-of-sight__error,.arcgis-line-of-sight__hint{overflow:hidden;animation:arcgis-line-of-sight-fade-in .25s ease-in-out;p{margin:0;padding:0}}.arcgis-line-of-sight__actions{display:flex;flex-flow:column;gap:var(--calcite-spacing-xxs);justify-content:center}@keyframes arcgis-line-of-sight-fade-in{0%{opacity:0}25%{opacity:0}to{opacity:1}}}`,f="arcgis-line-of-sight",v={base:f,actions:`${f}__actions`,container:`${f}__container`,error:`${f}__error`,hint:`${f}__hint`,hintText:`${f}__hint-text`,newAnalysisButton:`${f}__new-analysis-button`};var g=Object.defineProperty,y=Object.getOwnPropertyDescriptor,b=(e,t,i,n)=>{for(var r,s=n>1?void 0:n?y(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(s=(n?r(t,i,s):r(s))||s);return n&&s&&g(t,i,s),s};let _=class extends d.A{constructor(){super(...arguments),this.supportedViewType="3d",this.unsupportedErrorMessage="The Line Of Sight component is only supported in 3D views."}get state(){return this.disabled||!this.ready?"disabled":"active"===this.operationState?"creating":this.analysis.valid?"created":"ready"}constructAnalysis(){return new h.Z}clearAnalysis(){this.analysis.observer=null,this.analysis.targets.removeAll()}async place(e){await(this.analysisView?.place(e))}};b([(0,p.Cb)({readOnly:!0})],_.prototype,"state",1),_=b([(0,p.jY)("esri.components.LineOfSight.LineOfSightViewModel")],_);const w=(0,u.m)(_);class C extends o.oi{constructor(){super(...arguments),this.viewModel=w(this),this._messages=(0,c.u)({blocking:!0}),this.view=this.viewModel.view,this.analysis=this.viewModel.analysis,this.autoDestroyDisabled=!1,this.icon="line-of-sight",this.position="bottom-left",this.arcgisPropertyChange=(0,s.OR)()("analysis","state"),this.arcgisReady=(0,o.yM)()}static{this.properties={analysis:0,autoDestroyDisabled:5,icon:3,label:1,messageOverrides:0,position:1,referenceElement:1,state:35,_supported:16}}static{this.shadowRootOptions=o.hZ}static{this.styles=m}get state(){return this.viewModel.state}get _supported(){return null==this.view||"3d"===this.view.type}async clear(){this.viewModel.clear()}async continue(){this.viewModel.start()}async destroy(){await this.manager.destroy()}async start(){this.viewModel.startNewAnalysis()}async stop(){this.viewModel.stop()}render(){return r.dy`<div class=${(0,o.Vp)({[v.base]:!0,[l.g.widget]:!0,[l.g.panel]:!0})} role=presentation>${this._renderContainerNode()}</div>`}_renderContainerNode(){if(!this._supported)return r.dy`<div class=${(0,o.Vp)(v.error)}><p>${this._messages.unsupported}</p></div>`;const e=this.viewModel.state,t="creating"===e;return r.dy`<div class=${(0,o.Vp)(v.container)}>${t?r.dy`<div class=${(0,o.Vp)(v.hint)}><p class=${(0,o.Vp)(v.hintText)}>${this._messages.hint}</p></div>`:null}<div class=${(0,o.Vp)(v.actions)}>${"creating"===e?x({onClick:()=>{this.stop()},children:this._messages.done}):null}${"created"===e?x({onClick:()=>{this.continue()},children:this._messages.continueAnalysis}):null}${x({className:v.newAnalysisButton,onClick:()=>{this.start()},primary:!0,disabled:"disabled"===e,children:this._messages.newAnalysis})}</div></div>`}}function x({className:e,onClick:t,primary:i,disabled:n,children:s}){return r.dy`<calcite-button .appearance=${i?"solid":"outline-fill"} class=${(0,o.Vp)(e)} .disabled=${n} @click=${t}>${s}</calcite-button>`}(0,n.c)("arcgis-line-of-sight",C)},64062:function(e,t,i){var n=i(64297),r=i(15294),s=i(73440),o=(i(55214),i(70880)),a=i(29292),l=i(55430),c=i(17155),u=(i(61432),i(96711),i(83850),i(48023)),d=i(74765),h=i(12816);let p=class extends o.Z{constructor(){super()}initialize(){this.addHandles((0,d.qe)((()=>this._load()))),this._load()}destroy(){this._messagesTask.abort()}async when(){await this._messagesTask.promise}_load(){return null!=this._messagesTask&&this._messagesTask.abort(),this._messagesTask=(0,a.vr)((()=>(0,h.ME)("esri/core/t9n/Units"))),this._messagesTask.promise}get _messages(){return this._messagesTask.value}formatLength(e,t,i){return this._messages?(0,l.N9)(this._messages,e,e.unit,t,i):""}formatVerticalLength(e,t,i){return this._messages?(0,l.ym)(this._messages,e,e.unit,t,i):""}formatArea(e,t,i){return this._messages?(0,l.Se)(this._messages,e,e.unit,t,i):""}formatDecimal(e,t,i){return this._messages?(0,l.VG)(this._messages,e,e.unit,t,i):""}};(0,s._)([(0,c.Cb)()],p.prototype,"_messagesTask",void 0),(0,s._)([(0,c.Cb)()],p.prototype,"_messages",null),p=(0,s._)([(0,u.j)("esri.applications.Components.QuantityFormatter")],p);const m=p;var f=i(54503),v=i(99978);const g=i(49006).iv`:host,.hint,.error,.section,.actions,.item{display:flex;flex-direction:column;gap:var(--calcite-spacing-md);animation:esri-fade-in .25s ease-in-out}.error{color:var(--calcite-color-status-danger)}.error,.hint{overflow:hidden;p{margin:0;padding:0}}.item-disabled{color:var(--calcite-color-text-1);opacity:var(--calcite-opacity-light)}.item-value{font-weight:var(--calcite-font-weight-semibold)}.actions{justify-content:center}`,y="error",b="hint",_="actions",w="section",C="item",x="item-disabled",E="item-title",S="item-value";class T extends f.oi{constructor(){super(...arguments),this._formatter=new m,this.items=[],this.state="disabled",this.unsupportedLabel=""}static{this.properties={hintLabel:1,items:0,state:1,unsupportedLabel:1}}static{this.styles=g}async load(){await this._formatter.when()}render(){switch(this.state){case"unsupported":return r.dy`<section class=${(0,f.Vp)(y)}><p>${this.unsupportedLabel}</p></section>`;case"measuring":return r.dy`<section class=${(0,f.Vp)(b)}><p>${this.hintLabel}</p></section>`;case"ready":return r.dy`<div class=${(0,f.Vp)(_)}><slot name=actions></slot></div>`;default:return r.dy`<slot name=settings></slot>${e={formatter:this._formatter,items:this.items},r.dy`<section class=${(0,f.Vp)(w)}>${e.items.map((t=>function(e){const t="available"===e.measurement.state?(0,v.f)(e.formatter,e.measurement.value):null,i="unavailable"===e.measurement.state;return r.dy`<div class=${(0,f.Vp)({[C]:!0,[x]:i})}><span class=${(0,f.Vp)(E)}>${e.title}</span><span aria-live=polite class=${(0,f.Vp)(S)}>${t??"-"}</span></div>`}({formatter:e.formatter,measurement:t.measurement,title:t.title})))}</section>`}<div class=${(0,f.Vp)(_)}><slot name=actions></slot></div>`}var e}}(0,n.c)("arcgis-measurement-content",T)},4853:function(e,t,i){i(61637),i(96326),i(11030),i(41506);var n=i(64297),r=i(15294),s=i(20803),o=i(54503),a=i(49006),l=i(97237),c=i(60629),u=i(73440),d=i(65475),h=i(68651),p=i(63255),m=i(17155),f=(i(61432),i(96711),i(83850),i(48023));let v=class extends p.Z{constructor(e){super(e),this.layerId=""}static fromLayer(e){return new this({layerId:"building-component"===e.type?e.layer.id:e.id,sublayerId:"building-component"===e.type?e.id:void 0})}};(0,u._)([(0,m.Cb)({type:String,json:{write:{isRequired:!0}}})],v.prototype,"layerId",void 0),(0,u._)([(0,m.Cb)({type:Number,json:{write:!0}})],v.prototype,"sublayerId",void 0),v=(0,u._)([(0,f.j)("esri.analysis.support.SliceAnalysisExcludedLayer")],v);var g=i(43254),y=i(41145),b=i(28947),_=i(61100),w=i(1194),C=i(29884);let x=class extends d.Z{constructor(e){super(e),this.type="slice",this.tiltEnabled=!1,this.shape=null,this.excludeGroundSurface=!1}get excludedLayers(){return this._get("excludedLayers")||new g.Z}set excludedLayers(e){this._set("excludedLayers",(0,y.Z)(e,this._get("excludedLayers")))}writeExcludedLayers(e,t,i,n){0!==e.length&&(t[i]=e.toArray().map((e=>v.fromLayer(e).toJSON(n))))}readExcludedLayers(e,t,i){const n=i?.initiator;n&&i?.hooks?.onAfterLoad((async()=>{for(const t of e){const{layerId:e,sublayerId:r}=v.fromJSON(t,i),s=n.allLayers.find((({id:t})=>t===e));if(s)if(null!=r&&"allSublayers"in s){await s.load();const e=s.allSublayers.find((({id:e})=>e===r));e&&"type"in e&&"building-component"===e.type&&this.excludedLayers.add(e)}else this.excludedLayers.add(s)}}))}get valid(){return null!=this.shape?.position}equals(e){return this===e||super.equals(e)&&(0,_._W)(this.shape,e.shape)&&this.tiltEnabled===e.tiltEnabled&&(0,b.y7)(this.excludedLayers.toArray(),e.excludedLayers.toArray())&&this.excludeGroundSurface===e.excludeGroundSurface}clear(){this.shape=null}};(0,u._)([(0,m.Cb)({type:["slice"],json:{read:!1,write:{isRequired:!0}}})],x.prototype,"type",void 0),(0,u._)([(0,m.Cb)({type:Boolean,nonNullable:!0,json:{write:!0,default:!1}})],x.prototype,"tiltEnabled",void 0),(0,u._)([(0,m.Cb)({types:{key:"type",base:null,typeMap:{plane:h.Z},defaultKeyValue:"plane"},json:{write:{isRequired:!0}}})],x.prototype,"shape",void 0),(0,u._)([(0,m.Cb)({cast:y.R,clonable:e=>e.slice(),json:{type:[v],write:!0}})],x.prototype,"excludedLayers",null),(0,u._)([(0,C.c)("excludedLayers")],x.prototype,"writeExcludedLayers",null),(0,u._)([(0,w.r)("excludedLayers")],x.prototype,"readExcludedLayers",null),(0,u._)([(0,m.Cb)({type:Boolean,nonNullable:!0,json:{write:!0}})],x.prototype,"excludeGroundSurface",void 0),(0,u._)([(0,m.Cb)({readOnly:!0})],x.prototype,"valid",null),x=(0,u._)([(0,f.j)("esri.analysis.SliceAnalysis")],x);const E=x;var S=i(49898),T=i(41203),k=i(93568),I=i(93844),P=i(29359),O=i(90403);const L=a.iv`@layer{arcgis-slice{display:block}.arcgis-slice__container{display:flex;padding:var(--esri-widget-padding-y) var(--esri-widget-padding-x);overflow-y:auto;--layer-item-background: var(--calcite-color-foreground-2)}.arcgis-slice__error{color:var(--calcite-color-status-danger)}.arcgis-slice__container,.arcgis-slice__hint{display:flex;flex-direction:column;gap:var(--calcite-spacing-md)}.arcgis-slice__error,.arcgis-slice__hint{overflow:hidden;animation:arcgis-slice-fade-in .25s ease-in-out}.arcgis-slice__error p,.arcgis-slice__hint p{margin:0;padding:0}.arcgis-slice__hint:not(:has(*)){display:none}.arcgis-slice__layer-item{--calcite-color-foreground-2: var(--layer-item-background);--calcite-color-foreground-1: var(--layer-item-background)}.arcgis-slice__actions{display:flex;flex-flow:column;gap:var(--calcite-spacing-xxs);justify-content:center}.arcgis-slice__actions:not(:has(*)){display:none}@keyframes arcgis-slice-fade-in{0%{opacity:0}25%{opacity:0}to{opacity:1}}}`;var M=Object.defineProperty,R=Object.getOwnPropertyDescriptor,A=(e,t,i,n)=>{for(var r,s=n>1?void 0:n?R(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(s=(n?r(t,i,s):r(s))||s);return n&&s&&M(t,i,s),s};const D=new Set;let F=class extends c.A{constructor(){super(...arguments),this.supportedViewType="3d",this.unsupportedErrorMessage="SliceViewModel is only supported in 3D views."}async pickLayerToExclude(){const e=this.analysisView;if(e){const t=super.start((t=>e.pickLayerToExclude(t)));this._excludingLayers=t,t.finally((()=>{this._excludingLayers===t&&(this._excludingLayers=void 0)})),await t.catch()}}async place(e){await(this.analysisView?.place(e))}clearAnalysis(){this.analysis.shape=null}initialize(){D.add(this)}destroy(){D.delete(this)}get state(){return this.disabled||!this.ready?"disabled":this._excludingLayers?"excludingLayer":"active"===this.operationState?"slicing":this.analysis.valid?"sliced":"ready"}get shape(){return this.analysis.shape}set shape(e){this.analysis.shape=e}get tiltEnabled(){return this.analysis.tiltEnabled}set tiltEnabled(e){this.analysis.tiltEnabled=e}get excludedLayers(){return this.analysis.excludedLayers}set excludedLayers(e){this.analysis.excludedLayers=e}get excludeGroundSurface(){return this.analysis.excludeGroundSurface}set excludeGroundSurface(e){this.analysis.excludeGroundSurface=e}async start(){D.forEach((e=>{e.view===this.view&&e!==this&&e.clear()})),this.clear(),await super.start()}onConnectToAnalysisView(e){e.active=!0}constructAnalysis(){return new E}};A([(0,S.Cb)()],F.prototype,"_excludingLayers",2),A([(0,S.Cb)({readOnly:!0})],F.prototype,"state",1),A([(0,S.Cb)()],F.prototype,"shape",1),A([(0,S.Cb)()],F.prototype,"tiltEnabled",1),A([(0,S.Cb)()],F.prototype,"excludedLayers",1),A([(0,S.Cb)()],F.prototype,"excludeGroundSurface",1),F=A([(0,S.jY)("esri.components.Slice.SliceViewModel")],F);const N="arcgis-slice",V={base:N,actions:`${N}__actions`,cancelButton:`${N}__cancel-button`,container:`${N}__container`,error:`${N}__error`,excludeButton:`${N}__exclude-button`,hint:`${N}__hint`,hintText:`${N}__hint-text`,layerItem:`${N}__layer-item`,layerList:`${N}__layer-list`,layerListHeading:`${N}__layer-list-title`,newSliceButton:`${N}__clear-button`},z=(0,l.m)(F);class U extends o.oi{constructor(){super(...arguments),this.viewModel=z(this),this._messages=(0,T.u)(),this._onNewSliceClick=()=>{(0,k.R8)(this.viewModel.start())},this.analysis=this.viewModel.analysis,this.autoDestroyDisabled=!1,this.excludeGroundSurface=this.viewModel.excludeGroundSurface,this.excludedLayers=this.viewModel.excludedLayers,this.headingLevel=3,this.icon="slice",this.position="bottom-left",this.shape=this.viewModel.shape,this.state=this.viewModel.state,this.tiltEnabled=this.viewModel.tiltEnabled,this.arcgisPropertyChange=(0,s.OR)()("analysis","state"),this.arcgisReady=(0,o.yM)()}static{this.properties={_hasVoxelLayers:16,analysis:0,autoDestroyDisabled:5,excludeGroundSurface:5,excludedLayers:0,headingLevel:9,icon:3,label:1,messageOverrides:0,position:1,referenceElement:1,shape:0,state:35,tiltEnabled:5}}static{this.shadowRootOptions=o.hZ}static{this.styles=L}get _hasVoxelLayers(){const e=this.viewModel?.view;return null!=e&&e.allLayerViews.some((e=>"voxel-3d"===e.type))}async clear(){this.viewModel.clear()}async destroy(){await this.manager.destroy()}async start(){this.viewModel.start()}load(){this.manager.onLifecycle((()=>[(0,O.YP)((()=>this._renderContainerNode()),(()=>this.requestUpdate()))]))}render(){return r.dy`<div class=${(0,o.Vp)({[V.base]:!0,[P.g.widget]:!0,[P.g.panel]:!0})} role=presentation>${this._renderContainerNode()}</div>`}_renderContainerNode(){const e=this._messages,{state:t,visible:i,supported:n}=this.viewModel,s="slicing"===t||"excludingLayer"===t;if(!i||!n)return null;n||r.dy`<div class=${(0,o.Vp)(V.container)}><div class=${(0,o.Vp)(V.error)}><p>${this._messages.unsupported}</p></div></div>`;const{excludedLayers:a}=this.viewModel,l=this.excludeGroundSurface,c=a.length>0||l,u="disabled"===t;return r.dy`<div class=${(0,o.Vp)(V.container)}><div class=${(0,o.Vp)(V.hint)}>${"excludingLayer"===t?r.dy`<p class=${(0,o.Vp)(V.hintText)}>${e.excludeHint}</p>`:null}${"slicing"===t?r.dy`<p class=${(0,o.Vp)(V.hintText)}>${this._hasVoxelLayers?e.voxelHint:e.hint}</p><p class=${(0,o.Vp)(V.hintText)}>${e.verticalHint}</p>`:null}</div>${!s&&c?r.dy`<div class=${(0,o.Vp)(V.layerList)}>${(0,I.H)({class:V.layerListHeading,level:this.headingLevel,children:e.excludedLayers})}${function(e){const t=e.layers.map((t=>$({uid:t.uid,title:t.title??"",onClick:()=>e.onLayerClick(t),actionLabel:e.layerActionLabel})));return e.excludeGroundSurface&&t.push($({uid:"ground",title:e.groundItemTitle,onClick:e.onGroundClick,actionLabel:e.layerActionLabel})),r.dy`<calcite-list .label=${e.listLabel} selection-mode=none>${t}</calcite-list>`}({layers:a.toArray(),excludeGroundSurface:l,onLayerClick:e=>{this.excludedLayers.remove(e)},onGroundClick:()=>{this.excludeGroundSurface=!1},listLabel:e.excludedLayers,layerActionLabel:e.includeLayer,groundItemTitle:e.ground})}</div>`:null}<div class=${(0,o.Vp)(V.actions)}>${s?null:r.dy`<calcite-button class=${(0,o.Vp)(V.newSliceButton)} .disabled=${u} @click=${this._onNewSliceClick}>${e.newSlice}</calcite-button>`}${"sliced"===t?r.dy`<calcite-button appearance=outline-fill class=${(0,o.Vp)(V.excludeButton)} .disabled=${u} @click=${()=>this.viewModel.pickLayerToExclude()}>${e.excludeLayer}</calcite-button>`:null}${"excludingLayer"===t?r.dy`<calcite-button appearance=outline-fill class=${(0,o.Vp)(V.cancelButton)} .disabled=${u} @click=${()=>this.viewModel.stop()}>${e.cancel}</calcite-button>`:null}</div></div>`}}function $(e){return r.dy`<calcite-list-item class=${(0,o.Vp)(V.layerItem)} data-testid=${`list-item-${e.uid}`} .label=${e.title??""}><calcite-action icon=x @click=${e.onClick} scale=s slot=actions-end .text=${e.actionLabel} title=${e.actionLabel??o.Ld}></calcite-action></calcite-list-item>`}(0,n.c)("arcgis-slice",U)},17394:function(e,t,i){i(36650),i(44015),i(26344);var n=i(64297),r=i(89434),s=i(15294),o=i(41203),a=i(54503);const l=i(49006).iv`.arcgis-unit-select{width:100%}.arcgis-unit-select__label{--calcite-label-margin-bottom: 0;width:100%}`,c={label:"arcgis-unit-select__label"};class u extends a.oi{constructor(){super(...arguments),this.messages=(0,o.u)({}),this.options=[],this.arcgisUnitSelectChange=(0,a.yM)()}static{this.properties={options:0,selectLabel:1,value:0,messageOverrides:0,label:1}}static{this.styles=l}async destroy(){await this.manager.destroy()}render(){const{messages:e,options:t,selectLabel:i,value:n,arcgisUnitSelectChange:o}=this;return s.dy`<calcite-label class=${(0,a.Vp)(c.label)}>${i}<calcite-select .label=${i} @calciteSelectChange=${e=>{o.emit(e.target.value)}}>${(0,r.r)(t,(e=>e),(t=>{return s.dy`<calcite-option .selected=${t===n} .value=${t}>${i=t,"imperial"===i||"metric"===i?e.systems?.[t]:e.units?.[t]?.pluralCapitalized}</calcite-option>`;var i}))}</calcite-select></calcite-label>`}}(0,n.c)("arcgis-unit-select",u)},86526:function(e,t,i){i.d(t,{s:function(){return a}});const n=["date","datetime-local","month","number","range","time","week"],r=["email","password","search","tel","text","url"],s=["email","password","search","tel","text","textarea","url"];function o(e,t,i,n){const r=i.toLowerCase(),s=e[i];n&&null!=s?t.setAttribute(r,`${s}`):t.removeAttribute(r)}function a(e,t,i){i.type="textarea"===e?"text":e;const a=n.includes(e),l=t;o(l,i,"min",a),o(l,i,"max",a),o(l,i,"step",a);const c=s.includes(e),u=t;o(u,i,"minLength",c),o(u,i,"maxLength",c);o(u,i,"pattern",r.includes(e))}},52642:function(e,t,i){i.d(t,{c:function(){return r}});var n=i(73444);function r(e,t,i){if(n.sk)return;const r=function(e){class t extends window.MutationObserver{constructor(e){super(e),this.observedEntry=[],this.callback=e}observe(e,t){return this.observedEntry.push({target:e,options:t}),super.observe(e,t)}unobserve(e){const t=this.observedEntry.filter((t=>t.target!==e));this.observedEntry=[],this.callback(super.takeRecords(),this),this.disconnect(),t.forEach((e=>this.observe(e.target,e.options)))}}return"intersection"===e?window.IntersectionObserver:"mutation"===e?t:window.ResizeObserver}(e);return new r(t,i)}},61637:function(e,t,i){i.r(t),i.d(t,{Button:function(){return O}});i(55001),i(4204);var n=i(43625),r=i(73444),s=i(81879),o=i(46490),a=i(23230),l=i(7940),c=i(15022),u=i(4431),d=i(44002),h=i(25064),p=i(52642),m=i(76299),f=i(58268),v=i(49006);const g="calcite-button--loader",y="content",b="content--slotted",_="icon",w="icon--start",C="icon--end",x="loading-in",E="loading-out",S="icon-start-empty",T="icon-end-empty",k="button-padding",I="button-padding--shrunk",P=v.iv`:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:inline-block;inline-size:auto;vertical-align:middle;border-radius:var(--calcite-button-corner-radius, var(--calcite-internal-button-corner-radius, 0))}:host a,:host button{--calcite-internal-button-content-margin: .5rem;--calcite-internal-button-padding-x: 7px;--calcite-internal-button-padding-y: 3px;position:relative;box-sizing:border-box;display:flex;block-size:100%;inline-size:100%;cursor:pointer;-webkit-user-select:none;user-select:none;appearance:none;align-items:center;justify-content:center;border-style:none;text-align:center;font-family:inherit;font-weight:var(--calcite-font-weight-normal);text-decoration-line:none;outline-color:transparent;background-color:var(--calcite-button-background-color, var(--calcite-internal-button-background-color, var(--calcite-color-transparent)));border-block-start-color:var(--calcite-button-border-color, var(--calcite-internal-button-border-block-start-color, var(--calcite-internal-button-border-color, var(--calcite-color-transparent))));border-block-end-color:var(--calcite-button-border-color, var(--calcite-internal-button-border-block-end-color, var(--calcite-internal-button-border-color, var(--calcite-color-transparent))));border-inline-start-color:var(--calcite-button-border-color, var(--calcite-internal-button-border-inline-start-color, var(--calcite-internal-button-border-color, var(--calcite-color-transparent))));border-inline-end-color:var(--calcite-button-border-color, var(--calcite-internal-button-border-inline-end-color, var(--calcite-internal-button-border-color, var(--calcite-color-transparent))));border-style:solid;border-width:var(--calcite-border-width-sm);box-shadow:inset 0 0 0 0 var(--calcite-button-shadow-color, var(--calcite-internal-button-shadow-color, var(--calcite-color-transparent)));border-radius:var(--calcite-button-corner-radius, var(--calcite-internal-button-corner-radius, 0));color:var(--calcite-button-text-color, var(--calcite-internal-button-text-color, currentColor));padding-block:var(--calcite-internal-button-padding-y);padding-inline:var(--calcite-internal-button-padding-x);transition:color var(--calcite-animation-timing) ease-in-out,background-color var(--calcite-animation-timing) ease-in-out,box-shadow var(--calcite-animation-timing) ease-in-out,outline-color var(--calcite-internal-animation-timing-fast) ease-in-out}:host a:hover,:host button:hover{text-decoration-line:none}:host a:focus,:host button:focus{outline:2px solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline-offset:calc(2px*(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}:host a span,:host button span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host a calcite-loader,:host button calcite-loader{color:var(--calcite-button-loader-color, var(--calcite-internal-button-loader-color, var(--calcite-button-text-color, var(--calcite-internal-button-text-color))))}:host([round]){--calcite-internal-button-corner-radius: 50px}.content{margin-inline:var(--calcite-internal-button-content-margin)}.icon-start-empty .content{margin-inline-start:unset}.icon-end-empty .content{margin-inline-end:unset}:host([scale=m]) button,:host([scale=m]) a{--calcite-internal-button-content-margin: .75rem}:host([scale=l]) button,:host([scale=l]) a{--calcite-internal-button-content-margin: 1rem}:host([width=auto]){inline-size:auto}:host([width=half]){inline-size:50%}:host([width=full]){inline-size:100%}:host([alignment=center]:not([width=auto])) a,:host([alignment=center]:not([width=auto])) button{justify-content:center}:host([alignment=start]:not([width=auto])) a,:host([alignment=start]:not([width=auto])) button{justify-content:flex-start}:host([alignment=end]:not([width=auto])) a,:host([alignment=end]:not([width=auto])) button{justify-content:flex-end}:host([alignment*=space-between]:not([width=auto])) a,:host([alignment*=space-between]:not([width=auto])) button{justify-content:space-between}:host([alignment=icon-start-space-between]:not([width=auto])) .icon--start{margin-inline-end:auto}:host([alignment=icon-start-space-between]:not([width=auto])) a,:host([alignment=icon-start-space-between]:not([width=auto])) button{text-align:unset}:host([alignment=icon-end-space-between]:not([width=auto])) .icon--end{margin-inline-start:auto}:host([alignment=icon-end-space-between]:not([width=auto])) a,:host([alignment=icon-end-space-between]:not([width=auto])) button{text-align:unset}:host([alignment=center]) a:not(.content--slotted) .icon--start+.icon--end,:host([alignment=center]) button:not(.content--slotted) .icon--start+.icon--end{margin-inline-start:var(--calcite-internal-button-content-margin)}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}@keyframes loader-in{0%{inline-size:0;opacity:0;transform:scale(.5)}to{inline-size:1em;opacity:1;transform:scale(1)}}@keyframes loader-out{0%{inline-size:1em;opacity:1;transform:scale(1)}to{inline-size:0;opacity:0;transform:scale(.5)}}.calcite-button--loader{display:flex}.calcite-button--loader calcite-loader{margin:0}:host([loading]) button.content--slotted .calcite-button--loader calcite-loader,:host([loading]) a.content--slotted .calcite-button--loader calcite-loader{margin-inline-end:var(--calcite-internal-button-content-margin)}:host([loading]) button:not(.content--slotted) .icon--start,:host([loading]) button:not(.content--slotted) .icon--end,:host([loading]) a:not(.content--slotted) .icon--start,:host([loading]) a:not(.content--slotted) .icon--end{display:none}:host([appearance]) button,:host([appearance]) a{--calcite-internal-button-border-color: var(--calcite-color-transparent);border-style:solid;border-width:var(--calcite-button-border-size, 1px)}:host([kind=brand]) button,:host([kind=brand]) a{--calcite-internal-button-text-color: var(--calcite-color-text-inverse);--calcite-internal-button-background-color: var(--calcite-color-brand);--calcite-internal-button-loader-color: var(--calcite-color-text-inverse)}:host([kind=brand]) button:hover,:host([kind=brand]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-brand-hover)}:host([kind=brand]) button:active,:host([kind=brand]) a:active{--calcite-internal-button-background-color: var(--calcite-color-brand-press)}:host([kind=danger]) button,:host([kind=danger]) a{--calcite-internal-button-text-color: var(--calcite-color-text-inverse);--calcite-internal-button-background-color: var(--calcite-color-status-danger);--calcite-internal-button-loader-color: var(--calcite-color-text-inverse)}:host([kind=danger]) button:hover,:host([kind=danger]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-status-danger-hover)}:host([kind=danger]) button:active,:host([kind=danger]) a:active{--calcite-internal-button-background-color: var(--calcite-color-status-danger-press)}:host([kind=neutral]) button,:host([kind=neutral]) a{--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-background-color: var(--calcite-color-foreground-3);--calcite-internal-button-loader-color: var(--calcite-color-text-1)}:host([kind=neutral]) button:hover,:host([kind=neutral]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-foreground-2)}:host([kind=neutral]) button:active,:host([kind=neutral]) a:active{--calcite-internal-button-background-color: var(--calcite-color-foreground-1)}:host([kind=inverse]) button,:host([kind=inverse]) a{--calcite-internal-button-text-color: var(--calcite-color-text-inverse);--calcite-internal-button-background-color: var(--calcite-color-inverse);--calcite-internal-button-loader-color: var(--calcite-color-text-inverse)}:host([kind=inverse]) button:hover,:host([kind=inverse]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-inverse-hover)}:host([kind=inverse]) button:active,:host([kind=inverse]) a:active{--calcite-internal-button-background-color: var(--calcite-color-inverse-press)}:host([appearance=outline-fill]) button,:host([appearance=outline-fill]) a{--calcite-internal-button-background-color: var(--calcite-color-foreground-1);border-style:solid;border-width:var(--calcite-button-border-size, 1px)}:host([appearance=outline-fill]) button:hover,:host([appearance=outline-fill]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-foreground-2)}:host([appearance=outline-fill]) button:active,:host([appearance=outline-fill]) a:active{--calcite-internal-button-background-color: var(--calcite-color-foreground-3)}:host([appearance=outline-fill][kind=brand]) button,:host([appearance=outline-fill][kind=brand]) a{--calcite-internal-button-border-color: var(--calcite-color-brand);--calcite-internal-button-text-color: var(--calcite-color-brand);--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=outline-fill][kind=brand]) button:hover,:host([appearance=outline-fill][kind=brand]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-brand-hover);--calcite-internal-button-text-color: var(--calcite-color-brand-hover);--calcite-internal-button-shadow-color: var(--calcite-color-brand-hover)}:host([appearance=outline-fill][kind=brand]) button:focus,:host([appearance=outline-fill][kind=brand]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-brand);--calcite-internal-button-text-color: var(--calcite-color-brand);--calcite-internal-button-shadow-color: var(--calcite-color-brand)}:host([appearance=outline-fill][kind=brand]) button:active,:host([appearance=outline-fill][kind=brand]) a:active{--calcite-internal-button-border-color: var(--calcite-color-brand-press);--calcite-internal-button-text-color: var(--calcite-color-brand-press);--calcite-internal-button-shadow-color: var(--calcite-color-brand-press)}:host([appearance=outline-fill][kind=brand]) button calcite-loader,:host([appearance=outline-fill][kind=brand]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=outline-fill][kind=danger]) button,:host([appearance=outline-fill][kind=danger]) a{--calcite-internal-button-border-color: var(--calcite-color-status-danger);--calcite-internal-button-text-color: var(--calcite-color-status-danger);--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=outline-fill][kind=danger]) button:hover,:host([appearance=outline-fill][kind=danger]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-status-danger-hover);--calcite-internal-button-text-color: var(--calcite-color-status-danger-hover);--calcite-internal-button-shadow-color: var(--calcite-color-status-danger-hover)}:host([appearance=outline-fill][kind=danger]) button:focus,:host([appearance=outline-fill][kind=danger]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-status-danger);--calcite-internal-button-text-color: var(--calcite-color-status-danger);--calcite-internal-button-shadow-color: var(--calcite-color-status-danger)}:host([appearance=outline-fill][kind=danger]) button:active,:host([appearance=outline-fill][kind=danger]) a:active{--calcite-internal-button-border-color: var(--calcite-color-status-danger-press);--calcite-internal-button-text-color: var(--calcite-color-status-danger-press);--calcite-internal-button-shadow-color: var(--calcite-color-status-danger-press)}:host([appearance=outline-fill][kind=danger]) button calcite-loader,:host([appearance=outline-fill][kind=danger]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=outline-fill][kind=neutral]) button,:host([appearance=outline-fill][kind=neutral]) a{--calcite-internal-button-border-color: var(--calcite-color-border-1);--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-loader-color: var(--calcite-color-text-1)}:host([appearance=outline-fill][kind=neutral]) button:hover,:host([appearance=outline-fill][kind=neutral]) a:hover{--calcite-internal-button-shadow-color: var(--calcite-color-foreground-3);--calcite-internal-button-border-color: var(--calcite-color-border-input)}:host([appearance=outline-fill][kind=neutral]) button:focus,:host([appearance=outline-fill][kind=neutral]) a:focus{--calcite-internal-button-shadow-color: var(--calcite-color-foreground-3)}:host([appearance=outline-fill][kind=neutral]) button:active,:host([appearance=outline-fill][kind=neutral]) a:active{--calcite-internal-button-shadow-color: var(--calcite-color-foreground-3);--calcite-internal-button-border-color: var(--calcite-color-text-3)}:host([appearance=solid][kind=neutral]) button:hover,:host([appearance=solid][kind=neutral]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-border-3)}:host([appearance=solid][kind=neutral]) button:active,:host([appearance=solid][kind=neutral]) a:active{--calcite-internal-button-background-color: var(--calcite-color-border-2)}:host([appearance=outline-fill][kind=inverse]) button,:host([appearance=outline-fill][kind=inverse]) a{--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-border-color: var(--calcite-color-inverse);--calcite-internal-button-loader-color: var(--calcite-color-text-1)}:host([appearance=outline-fill][kind=inverse]) button:hover,:host([appearance=outline-fill][kind=inverse]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-inverse-hover);--calcite-internal-button-shadow-color: var(--calcite-color-inverse-hover)}:host([appearance=outline-fill][kind=inverse]) button:focus,:host([appearance=outline-fill][kind=inverse]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-inverse);--calcite-internal-button-shadow-color: var(--calcite-color-inverse)}:host([appearance=outline-fill][kind=inverse]) button:active,:host([appearance=outline-fill][kind=inverse]) a:active{--calcite-internal-button-border-color: var(--calcite-color-inverse-press);--calcite-internal-button-shadow-color: var(--calcite-color-inverse-press)}:host([appearance=outline]) button,:host([appearance=outline]) a{--calcite-internal-button-background-color: var(--calcite-color-transparent);border-style:solid;border-width:var(--calcite-button-border-size, 1px)}:host([appearance=outline]) button:hover,:host([appearance=outline]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-transparent-hover)}:host([appearance=outline]) button:active,:host([appearance=outline]) a:active{--calcite-internal-button-background-color: var(--calcite-color-transparent-press)}:host([appearance=outline][kind=brand]) button,:host([appearance=outline][kind=brand]) a{--calcite-internal-button-border-color: var(--calcite-color-brand);--calcite-internal-button-text-color: var(--calcite-color-brand);--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=outline][kind=brand]) button:hover,:host([appearance=outline][kind=brand]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-brand-hover);--calcite-internal-button-text-color: var(--calcite-color-brand-hover);--calcite-internal-button-shadow-color: var(--calcite-color-brand-hover)}:host([appearance=outline][kind=brand]) button:focus,:host([appearance=outline][kind=brand]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-brand);--calcite-internal-button-text-color: var(--calcite-color-brand);--calcite-internal-button-shadow-color: var(--calcite-color-brand)}:host([appearance=outline][kind=brand]) button:active,:host([appearance=outline][kind=brand]) a:active{--calcite-internal-button-border-color: var(--calcite-color-brand-press);--calcite-internal-button-text-color: var(--calcite-color-brand-press);--calcite-internal-button-shadow-color: var(--calcite-color-brand-press)}:host([appearance=outline][kind=brand]) button calcite-loader,:host([appearance=outline][kind=brand]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=outline][kind=danger]) button,:host([appearance=outline][kind=danger]) a{--calcite-internal-button-border-color: var(--calcite-color-status-danger);--calcite-internal-button-text-color: var(--calcite-color-status-danger);--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=outline][kind=danger]) button:hover,:host([appearance=outline][kind=danger]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-status-danger-hover);--calcite-internal-button-text-color: var(--calcite-color-status-danger-hover);--calcite-internal-button-shadow-color: var(--calcite-color-status-danger-hover)}:host([appearance=outline][kind=danger]) button:focus,:host([appearance=outline][kind=danger]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-status-danger);--calcite-internal-button-text-color: var(--calcite-color-status-danger);--calcite-internal-button-shadow-color: var(--calcite-color-status-danger)}:host([appearance=outline][kind=danger]) button:active,:host([appearance=outline][kind=danger]) a:active{--calcite-internal-button-border-color: var(--calcite-color-status-danger-press);--calcite-internal-button-text-color: var(--calcite-color-status-danger-press);--calcite-internal-button-shadow-color: var(--calcite-color-status-danger-press)}:host([appearance=outline][kind=danger]) button calcite-loader,:host([appearance=outline][kind=danger]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=outline][kind=neutral]) button,:host([appearance=outline][kind=neutral]) a{--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-border-color: var(--calcite-color-border-1);--calcite-internal-button-loader-color: var(--calcite-color-text-1)}:host([appearance=outline][kind=neutral]) button:hover,:host([appearance=outline][kind=neutral]) a:hover{--calcite-internal-button-shadow-color: var(--calcite-color-foreground-3);--calcite-internal-button-border-color: var(--calcite-color-border-input)}:host([appearance=outline][kind=neutral]) button:focus,:host([appearance=outline][kind=neutral]) a:focus{--calcite-internal-button-shadow-color: var(--calcite-color-foreground-3)}:host([appearance=outline][kind=neutral]) button:active,:host([appearance=outline][kind=neutral]) a:active{--calcite-internal-button-shadow-color: var(--calcite-color-foreground-3);--calcite-internal-button-border-color: var(--calcite-color-text-3)}:host([appearance=outline][kind=inverse]) button,:host([appearance=outline][kind=inverse]) a{--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-border-color: var(--calcite-color-inverse);--calcite-internal-button-loader-color: var(--calcite-color-text-1)}:host([appearance=outline][kind=inverse]) button:hover,:host([appearance=outline][kind=inverse]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-inverse-hover);--calcite-internal-button-shadow-color: var(--calcite-color-inverse-hover)}:host([appearance=outline][kind=inverse]) button:focus,:host([appearance=outline][kind=inverse]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-inverse);--calcite-internal-button-shadow-color: var(--calcite-color-inverse)}:host([appearance=outline][kind=inverse]) button:active,:host([appearance=outline][kind=inverse]) a:active{--calcite-internal-button-border-color: var(--calcite-color-inverse-press);--calcite-internal-button-shadow-color: var(--calcite-color-inverse-press)}:host([appearance=outline-fill][split-child=primary]) button,:host([appearance=outline][split-child=primary]) button,:host([appearance=outline-fill][split-child=primary]) a,:host([appearance=outline][split-child=primary]) a{border-inline-end-width:0;border-inline-start-width:1px}:host([appearance=outline-fill][split-child=secondary]) button,:host([appearance=outline][split-child=secondary]) button,:host([appearance=outline-fill][split-child=secondary]) a,:host([appearance=outline][split-child=secondary]) a{border-inline-start-width:0;border-inline-end-width:1px}:host([appearance=transparent]) button,:host([appearance=transparent]) a{--calcite-internal-button-background-color: var(--calcite-color-transparent)}:host([appearance=transparent]) button:hover,:host([appearance=transparent]) button:focus,:host([appearance=transparent]) a:hover,:host([appearance=transparent]) a:focus{--calcite-internal-button-background-color: var(--calcite-color-transparent-hover)}:host([appearance=transparent]) button:active,:host([appearance=transparent]) a:active{--calcite-internal-button-background-color: var(--calcite-color-transparent-press)}:host([appearance=transparent]:not(.enable-editing-button)) button,:host([appearance=transparent]:not(.enable-editing-button)) a{background-color:var(--calcite-color-transparent)}:host([appearance=transparent]:not(.enable-editing-button)) button:hover,:host([appearance=transparent]:not(.enable-editing-button)) a:hover{background-color:var(--calcite-color-transparent-hover)}:host([appearance=transparent]:not(.enable-editing-button)) button:active,:host([appearance=transparent]:not(.enable-editing-button)) a:active{background-color:var(--calcite-color-transparent-press)}:host([appearance=transparent][kind=brand]) button,:host([appearance=transparent][kind=brand]) a{--calcite-internal-button-text-color: var(--calcite-color-brand);--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=transparent][kind=brand]) button:hover,:host([appearance=transparent][kind=brand]) a:hover{--calcite-internal-button-text-color: var(--calcite-color-brand-hover)}:host([appearance=transparent][kind=brand]) button:focus,:host([appearance=transparent][kind=brand]) a:focus{--calcite-internal-button-text-color: var(--calcite-color-brand)}:host([appearance=transparent][kind=brand]) button:active,:host([appearance=transparent][kind=brand]) a:active{--calcite-internal-button-text-color: var(--calcite-color-brand-press)}:host([appearance=transparent][kind=brand]) button calcite-loader,:host([appearance=transparent][kind=brand]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=transparent][kind=danger]) button,:host([appearance=transparent][kind=danger]) a{--calcite-internal-button-text-color: var(--calcite-color-status-danger);--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=transparent][kind=danger]) button:hover,:host([appearance=transparent][kind=danger]) a:hover{--calcite-internal-button-text-color: var(--calcite-color-status-danger-hover)}:host([appearance=transparent][kind=danger]) button:focus,:host([appearance=transparent][kind=danger]) a:focus{--calcite-internal-button-text-color: var(--calcite-color-status-danger)}:host([appearance=transparent][kind=danger]) button:active,:host([appearance=transparent][kind=danger]) a:active{--calcite-internal-button-text-color: var(--calcite-color-status-danger-press)}:host([appearance=transparent][kind=danger]) button calcite-loader,:host([appearance=transparent][kind=danger]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=transparent][kind=neutral]:not(.cancel-editing-button)) button,:host([appearance=transparent][kind=neutral]:not(.cancel-editing-button)) a,:host([appearance=transparent][kind=neutral]:not(.cancel-editing-button)) calcite-loader{--calcite-internal-button-text-color: var(--calcite-color-text-1)}:host([appearance=transparent][kind=neutral].cancel-editing-button) button{--calcite-internal-button-text-color: var(--calcite-color-text-3)}:host([appearance=transparent][kind=neutral].cancel-editing-button) button:hover{--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-padding-y: 0}:host(.confirm-changes-button) button:focus,:host(.cancel-editing-button) button:focus,:host(.enable-editing-button) button:focus{outline-offset:-2px}:host([appearance=transparent][kind=inverse]) button:hover,:host([appearance=transparent][kind=inverse]) a:hover{background-color:var(--calcite-color-transparent-inverse-hover)}:host([appearance=transparent][kind=inverse]) button:active,:host([appearance=transparent][kind=inverse]) a:active{background-color:var(--calcite-color-transparent-inverse-press)}:host([appearance=transparent][kind=inverse]) button calcite-loader,:host([appearance=transparent][kind=inverse]) a calcite-loader{--calcite-internal-button-text-color: var(--calcite-color-text-inverse)}:host([scale=s]) button.content--slotted,:host([scale=s]) a.content--slotted{font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=s][appearance=transparent]) button.content--slotted,:host([scale=s][appearance=transparent]) a.content--slotted{--calcite-internal-button-padding-x: .5rem}:host([scale=s]) button,:host([scale=s]) a{--calcite-internal-button-padding-y: 3px}:host([scale=m]) button.content--slotted,:host([scale=m]) a.content--slotted{--calcite-internal-button-padding-x: 11px;font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=m]) button,:host([scale=m]) a{--calcite-internal-button-padding-y: 7px}:host([scale=m][appearance=transparent]) button.content--slotted,:host([scale=m][appearance=transparent]) a.content--slotted{--calcite-internal-button-padding-x: .75rem}:host([scale=l]) button.content--slotted,:host([scale=l]) a.content--slotted{--calcite-internal-button-padding-x: 15px;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l]) .button-padding{--calcite-internal-button-padding-x: 1rem;--calcite-internal-button-padding-y: 11px}:host([scale=l]) .button-padding--shrunk{--calcite-internal-button-padding-y: 9px}:host([scale=s]) button:not(.content--slotted),:host([scale=s]) a:not(.content--slotted){--calcite-internal-button-padding-x: .125rem;--calcite-internal-button-padding-y: 3px;inline-size:1.5rem;font-size:var(--calcite-font-size-0);line-height:1.25rem;min-block-size:1.5rem}:host([scale=m]) button:not(.content--slotted),:host([scale=m]) a:not(.content--slotted){--calcite-internal-button-padding-x: .125rem;--calcite-internal-button-padding-y: 7px;inline-size:2rem;font-size:var(--calcite-font-size-0);line-height:1.25rem;min-block-size:2rem}:host([scale=l]) button:not(.content--slotted),:host([scale=l]) a:not(.content--slotted){--calcite-internal-button-padding-x: .125rem;--calcite-internal-button-padding-y: 9px;inline-size:2.75rem;font-size:var(--calcite-font-size-0);line-height:1.25rem;min-block-size:2.75rem}:host(:is([scale=s],[scale=m],[scale=l])[width=full]) a:not(.content--slotted),:host(:is([scale=s],[scale=m],[scale=l])[width=full]) button:not(.content--slotted){inline-size:var(--calcite-container-size-content-fluid)}:host([scale=l][appearance=transparent]) button:not(.content--slotted),:host([scale=l][appearance=transparent]) a:not(.content--slotted){--calcite-internal-button-padding-y: .625rem}:host([scale=s][icon-start][icon-end]) button:not(.content--slotted),:host([scale=s][icon-start][icon-end]) a:not(.content--slotted){--calcite-internal-button-padding-x: 23px;block-size:1.5rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=s][icon-start][icon-end][appearance=transparent]) button:not(.content--slotted),:host([scale=s][icon-start][icon-end][appearance=transparent]) a:not(.content--slotted){--calcite-internal-button-padding-x: 1.5rem}:host([scale=m][icon-start][icon-end]) button:not(.content--slotted),:host([scale=m][icon-start][icon-end]) a:not(.content--slotted){--calcite-internal-button-padding-x: 2rem;block-size:2rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=m][icon-start][icon-end][appearance=transparent]) button:not(.content--slotted),:host([scale=m][icon-start][icon-end][appearance=transparent]) a:not(.content--slotted){--calcite-internal-button-padding-x: 33px}:host([scale=l][icon-start][icon-end]) button:not(.content--slotted),:host([scale=l][icon-start][icon-end]) a:not(.content--slotted){--calcite-internal-button-padding-x: 43px;block-size:2.75rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l][icon-start][icon-end]) button:not(.content--slotted) .icon--start+.icon--end,:host([scale=l][icon-start][icon-end]) a:not(.content--slotted) .icon--start+.icon--end{margin-inline-start:1rem}:host([scale=l][icon-start][icon-end][appearance=transparent]) button:not(.content--slotted),:host([scale=l][icon-start][icon-end][appearance=transparent]) a:not(.content--slotted){--calcite-internal-button-padding-x: 2.75rem}:host([hidden]){display:none}[hidden]{display:none}`;class O extends a.oi{constructor(){super(...arguments),this.attributeWatch=(0,l.g0)(["aria-expanded"],this.handleGlobalAttributesChanged),this.contentEl=(0,s.V)(),this.mutationObserver=(0,p.c)("mutation",(()=>this.updateHasContent())),this.resizeObserver=(0,p.c)("resize",(()=>this.setTooltipText())),this.messages=(0,m.u)(),this.hasContent=!1,this.alignment="center",this.appearance="solid",this.disabled=!1,this.download=!1,this.kind="brand",this.loading=!1,this.round=!1,this.scale="m",this.splitChild=!1,this.type="button",this.width="auto"}static{this.properties={hasContent:[16,{},{state:!0}],tooltipText:[16,{},{state:!0}],alignment:[3,{},{reflect:!0}],appearance:[3,{},{reflect:!0}],disabled:[7,{},{reflect:!0,type:Boolean}],download:[3,{converter:a.Kb},{reflect:!0}],form:[3,{},{reflect:!0}],href:[3,{},{reflect:!0}],iconEnd:[3,{},{reflect:!0}],iconFlipRtl:[3,{},{reflect:!0}],iconStart:[3,{},{reflect:!0}],kind:[3,{},{reflect:!0}],label:1,loading:[7,{},{reflect:!0,type:Boolean}],messageOverrides:[0,{},{attribute:!1}],name:[3,{},{reflect:!0}],rel:[3,{},{reflect:!0}],round:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],splitChild:[3,{},{reflect:!0}],target:[3,{},{reflect:!0}],type:[3,{},{reflect:!0}],width:[3,{},{reflect:!0}]}}static{this.styles=P}async setFocus(){await(0,h.c)(this),this.childEl?.focus()}connectedCallback(){super.connectedCallback(),this.setupTextContentObserver(),(0,d.c)(this),this.formEl=(0,c.f)(this)}async load(){r.sk||this.updateHasContent()}updated(){(0,u.u)(this)}loaded(){this.setTooltipText()}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver?.disconnect(),(0,d.d)(this),this.resizeObserver?.disconnect(),this.formEl=null}handleGlobalAttributesChanged(){this.requestUpdate()}updateHasContent(){this.hasContent=(0,f.D)(this.el)}setupTextContentObserver(){this.mutationObserver?.observe(this.el,{childList:!0,subtree:!0})}onLabelClick(){this.handleClick(),this.setFocus()}handleClick(){const{type:e}=this;this.href||("submit"===e?(0,c.s)(this):"reset"===e&&(0,c.r)(this))}setTooltipText(){const{contentEl:{value:e}}=this;e&&(this.tooltipText=e.offsetWidth<e.scrollWidth&&this.el.innerText||null)}setChildEl(e){this.childEl=e,e&&this.resizeObserver?.observe(e)}render(){const e=this.href?"a":"button",t=this.href?o.i0`a`:o.i0`button`,i=this.loading?r.dy`<div class=${(0,a.Vp)(g)}><calcite-loader class=${(0,a.Vp)(this.loading?x:E)} inline .label=${this.messages.loading} .scale=${"l"===this.scale?"m":"s"}></calcite-loader></div>`:null,n=!this.iconStart&&!this.iconEnd,l=r.dy`<calcite-icon class=${(0,a.Vp)({[_]:!0,[w]:!0})} .flipRtl=${"start"===this.iconFlipRtl||"both"===this.iconFlipRtl} .icon=${this.iconStart} .scale=${(0,h.g)(this.scale)}></calcite-icon>`,c=r.dy`<calcite-icon class=${(0,a.Vp)({[_]:!0,[C]:!0})} .flipRtl=${"end"===this.iconFlipRtl||"both"===this.iconFlipRtl} .icon=${this.iconEnd} .scale=${(0,h.g)(this.scale)}></calcite-icon>`,p=r.dy`<span class=${(0,a.Vp)(y)} ${(0,s.i)(this.contentEl)}><slot></slot></span>`;return(0,u.I)({disabled:this.disabled,children:o.dy`<${t} .ariaBusy=${this.loading} .ariaExpanded=${this.el.ariaExpanded?this.el.ariaExpanded:null} .ariaLabel=${this.loading?this.messages.loading:(0,d.g)(this)} aria-live=polite class=${(0,a.Vp)({[k]:n,[I]:!n,[b]:this.hasContent,[S]:!this.iconStart,[T]:!this.iconEnd})} .disabled=${"button"===e?this.disabled:null} download=${("a"===e?!0===this.download||""===this.download?"":this.download||null:null)??r.Ld} href=${("a"===e&&this.href)??r.Ld} name=${("button"===e&&this.name)??r.Ld} @click=${this.handleClick} rel=${("a"===e&&this.rel)??r.Ld} tabindex=${(this.disabled?-1:null)??r.Ld} target=${("a"===e&&this.target)??r.Ld} title=${this.tooltipText??r.Ld} type=${("button"===e?this.type:null)??r.Ld} ${(0,s.i)(this.setChildEl)}>${i}${this.iconStart?l:null}${this.hasContent?p:null}${this.iconEnd?c:null}</${t}>`})}}(0,n.c)("calcite-button",O)},4204:function(e,t,i){i.r(t),i.d(t,{Icon:function(){return g}});var n=i(43625),r=i(73444),s=i(23230),o=i(58268),a=i(52642),l=i(28936),c=i(49006);const u="flip-rtl",d={},h={},p={s:16,m:24,l:32};function m({icon:e,scale:t}){const i=p[t],n=function(e){const t=!isNaN(Number(e.charAt(0))),i=e.split("-");if(i.length>0){const t=/[a-z]/i;e=i.map(((e,i)=>e.replace(t,(function(e,t){return 0===i&&0===t?e:e.toUpperCase()})))).join("")}return t?`i${e}`:e}(e),r="F"===n.charAt(n.length-1);return`${r?n.substring(0,n.length-1):n}${i}${r?"F":""}`}function f(e){return d[e]}const v=c.iv`:host{display:inline-flex;color:var(--calcite-icon-color, var(--calcite-ui-icon-color, currentColor))}:host([scale=s]){inline-size:16px;block-size:16px;min-inline-size:16px;min-block-size:16px}:host([scale=m]){inline-size:24px;block-size:24px;min-inline-size:24px;min-block-size:24px}:host([scale=l]){inline-size:32px;block-size:32px;min-inline-size:32px;min-block-size:32px}.flip-rtl{transform:scaleX(-1)}.svg{display:block}:host([hidden]){display:none}[hidden]{display:none}`;class g extends s.oi{constructor(){super(...arguments),this.visible=!1,this.flipRtl=!1,this.icon=null,this.preload=!1,this.scale="m"}static{this.properties={pathData:[16,{},{state:!0}],visible:[16,{},{state:!0}],flipRtl:[7,{},{reflect:!0,type:Boolean}],icon:[3,{},{reflect:!0}],preload:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],textLabel:1}}static{this.styles=v}connectedCallback(){if(super.connectedCallback(),this.preload)return this.visible=!0,void this.loadIconPathData();this.visible||this.waitUntilVisible((()=>{this.visible=!0,this.loadIconPathData()}))}willUpdate(e){(e.has("icon")&&(this.hasUpdated||null!==this.icon)||e.has("scale")&&(this.hasUpdated||"m"!==this.scale))&&this.loadIconPathData()}disconnectedCallback(){super.disconnectedCallback(),this.intersectionObserver?.disconnect(),this.intersectionObserver=null}async loadIconPathData(){const{icon:e,scale:t,visible:i}=this;if(r.sk||!e||!i)return;const s={icon:e,scale:t},o=f(m(s))||await async function(e){const t=m(e),i=f(t);if(i)return i;h[t]||(h[t]=fetch((0,n.g)(`./assets/icon/${t}.json`)).then((e=>e.json())).catch((()=>(l.l.error(`${e.icon} (${e.scale}) icon failed to load`),""))));const r=await h[t];return d[t]=r,r}(s);e===this.icon&&(this.pathData=o)}waitUntilVisible(e){this.intersectionObserver=(0,a.c)("intersection",(t=>{t.forEach((t=>{t.isIntersecting&&(this.intersectionObserver.disconnect(),this.intersectionObserver=null,e())}))}),{rootMargin:"50px"}),this.intersectionObserver?this.intersectionObserver.observe(this.el):e()}render(){const{el:e,flipRtl:t,pathData:i,scale:n,textLabel:a}=this,l=(0,o.g)(e),c=p[n],d=!!a,h=[].concat(i||"");return this.el.ariaHidden=(0,o.t)(!d),this.el.ariaLabel=d?a:null,this.el.role=d?"img":null,r.dy`<svg aria-hidden=true class=${(0,s.Vp)({[u]:"rtl"===l&&t,svg:!0})} fill=currentColor height=100% viewBox=${`0 0 ${c} ${c}`} width=100% xmlns=http://www.w3.org/2000/svg>${h.map((e=>"string"==typeof e?r.YP`<path d=${e??r.Ld} />`:r.YP`<path d=${e.d??r.Ld} opacity=${("opacity"in e?e.opacity:1)??r.Ld} />`))}</svg>`}}(0,n.c)("calcite-icon",g)},75014:function(e,t,i){i.r(t),i.d(t,{Input:function(){return $}});i(7337),i(18162),i(4204);var n=i(43625),r=i(85986),s=i(73733),o=i(73444),a=i(81879),l=i(46490),c=i(23230),u=i(7940),d=i(58268),h=i(15022),p=i(4431),m=i(113),f=i(44002),v=i(25064),g=i(54113),y=i(57618),b=i(76299),_=i(86526),w=i(49006);const C="loader",x="clear-button",E="editing-enabled",S="inline-child",T="icon",k="prefix",I="suffix",P="number-button-wrapper",O="number-button-item--horizontal",L="element-wrapper",M="wrapper",R="action-wrapper",A="number-button-item",D="has-suffix",F="has-prefix",N="inputValidationMessage",V={tel:"phone",password:"lock",email:"email-address",date:"calendar",time:"clock",search:"search"},z="action",U=w.iv`:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:block}:host([scale=s]) input,:host([scale=s]) .prefix,:host([scale=s]) .suffix{block-size:1.5rem;padding-inline:.5rem;font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=s]) input[type=file],:host([scale=s]) textarea{min-block-size:1.5rem}:host([scale=s]) .number-button-wrapper,:host([scale=s]) .action-wrapper calcite-button,:host([scale=s]) .action-wrapper calcite-button button{block-size:1.5rem}:host([scale=s]) .clear-button{min-block-size:1.5rem;min-inline-size:1.5rem}:host([scale=s]) textarea{block-size:auto;padding-block:.25rem;padding-inline:.5rem;font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=m]) input,:host([scale=m]) .prefix,:host([scale=m]) .suffix{block-size:2rem;padding-inline:.75rem;font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=m]) textarea,:host([scale=m]) input[type=file]{min-block-size:2rem}:host([scale=m]) .number-button-wrapper,:host([scale=m]) .action-wrapper calcite-button,:host([scale=m]) .action-wrapper calcite-button button{block-size:2rem}:host([scale=m]) .clear-button{min-block-size:2rem;min-inline-size:2rem}:host([scale=m]) textarea{block-size:auto;padding-block:.5rem;padding-inline:.75rem;font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=l]) input,:host([scale=l]) .prefix,:host([scale=l]) .suffix{block-size:2.75rem;padding-inline:1rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l]) textarea,:host([scale=l]) input[type=file]{min-block-size:2.75rem}:host([scale=l]) .number-button-wrapper,:host([scale=l]) .action-wrapper calcite-button,:host([scale=l]) .action-wrapper calcite-button button{block-size:2.75rem}:host([scale=l]) .clear-button{min-block-size:2.75rem;min-inline-size:2.75rem}:host([scale=l]) textarea{block-size:auto;padding-block:.75rem;padding-inline:1rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([disabled]) textarea{resize:none}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}textarea,input{position:relative;margin:0;box-sizing:border-box;display:flex;max-block-size:100%;inline-size:100%;max-inline-size:100%;flex:1 1 0%;text-overflow:ellipsis;border-width:1px;border-style:solid;font-family:inherit;font-weight:var(--calcite-font-weight-normal);border-color:var(--calcite-input-border-color, var(--calcite-color-border-input));background-color:var(--calcite-input-background-color, var(--calcite-color-foreground-1));color:var(--calcite-input-text-color, var(--calcite-color-text-1));transition:var(--calcite-animation-timing),block-size 0,outline-offset 0s;-webkit-appearance:none}textarea:placeholder-shown,input:placeholder-shown{text-overflow:ellipsis}textarea{border-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp))}input{border-start-start-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp));border-start-end-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp));border-end-start-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp));border-end-end-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp))}.has-prefix input{border-start-start-radius:0;border-end-start-radius:0}.has-suffix input,.element-wrapper:has(.clear-button) input,:host([number-button-type=vertical][type=number]) input,:host([number-button-type=horizontal]) .has-suffix .suffix,:host([number-button-type=vertical][type=number]) .has-suffix .suffix,:host([number-button-type=vertical][type=number]) .clear-button,:host([number-button-type=horizontal][type=number]) .clear-button{border-start-end-radius:0;border-end-end-radius:0}:host([number-button-type=horizontal]) input{border-start-start-radius:0;border-start-end-radius:0;border-end-start-radius:0;border-end-end-radius:0}.has-prefix .prefix:first-child,:host([number-button-type=horizontal]) .number-button-item[data-adjustment=down]{border-start-start-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp));border-end-start-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp))}.has-suffix .suffix,:host([number-button-type=vertical][type=number][read-only]) .has-suffix .suffix,:host([clearable]) .clear-button,:host([number-button-type=horizontal]) .number-button-item[data-adjustment=up]{border-end-end-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp));border-start-end-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp))}:host([clearable]) .has-suffix .clear-button{border-end-end-radius:0;border-start-end-radius:0}:host([number-button-type=vertical]) .number-button-item[data-adjustment=down]{border-block-start-width:0px;border-end-end-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp))}:host([number-button-type=vertical]) .number-button-item[data-adjustment=up]{border-start-end-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp))}input[type=search]::-webkit-search-decoration{-webkit-appearance:none}input:focus,textarea:focus{border-color:var(--calcite-color-brand);color:var(--calcite-input-text-color, var(--calcite-color-text-1))}input[readonly],textarea[readonly]{font-weight:var(--calcite-font-weight-medium);background-color:var(--calcite-input-background-color, var(--calcite-color-background))}input[readonly]:focus,textarea[readonly]:focus{color:var(--calcite-input-text-color, var(--calcite-color-text-1))}textarea,input{outline-color:transparent}textarea:focus,input:focus{outline:2px solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline-offset:calc(-2px*(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}:host([status=invalid]) input,:host([status=invalid]) textarea{border-color:var(--calcite-color-status-danger)}:host([status=invalid]) input:focus,:host([status=invalid]) textarea:focus{outline:2px solid var(--calcite-color-status-danger);outline-offset:calc(-2px*(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}:host([scale=s]) .icon{inset-inline-start:.5rem}:host([scale=m]) .icon{inset-inline-start:.75rem}:host([scale=l]) .icon{inset-inline-start:1rem}:host([icon][scale=s]) input{padding-inline-start:2rem}:host([icon][scale=m]) input{padding-inline-start:2.5rem}:host([icon][scale=l]) input{padding-inline-start:3.5rem}.element-wrapper{position:relative;order:3;display:inline-flex;flex:1 1 0%;align-items:center}.icon{pointer-events:none;position:absolute;display:block;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;color:var(--calcite-input-icon-color, var(--calcite-color-text-3));z-index:var(--calcite-z-index)}input[type=text]::-ms-clear,input[type=text]::-ms-reveal{display:none;block-size:0px;inline-size:0px}input[type=search]::-webkit-search-decoration,input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-results-button,input[type=search]::-webkit-search-results-decoration,input[type=date]::-webkit-clear-button,input[type=time]::-webkit-clear-button{display:none}.clear-button{pointer-events:initial;order:4;margin:0;box-sizing:border-box;display:flex;min-block-size:100%;cursor:pointer;align-items:center;justify-content:center;align-self:stretch;border-width:1px;border-style:solid;outline-color:transparent;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;border-color:var(--calcite-input-border-color, var(--calcite-color-border-input));background-color:var(--calcite-input-actions-background-color, var(--calcite-color-foreground-1));border-inline-start-width:0px}.clear-button calcite-icon{transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;color:var(--calcite-input-actions-icon-color, var(--calcite-color-text-3))}.clear-button:hover{background-color:var(--calcite-input-actions-background-color-hover, var(--calcite-color-foreground-2))}.clear-button:hover calcite-icon{color:var(--calcite-input-actions-icon-color-hover, var(--calcite-color-text-1))}.clear-button:active{background-color:var(--calcite-input-actions-background-color-press, var(--calcite-color-foreground-3))}.clear-button:active calcite-icon{color:var(--calcite-input-actions-icon-color-press, var(--calcite-color-text-1))}.clear-button:focus{outline:2px solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline-offset:calc(-2px*(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}.clear-button:disabled{opacity:var(--calcite-opacity-disabled)}.loader{inset-block-start:1px;inset-inline:1px;pointer-events:none;position:absolute;display:block;--calcite-progress-background-color: var(--calcite-input-loading-background-color);--calcite-progress-fill-color: var(--calcite-input-loading-fill-color)}.action-wrapper{order:7;display:flex}.prefix,.suffix{box-sizing:border-box;display:flex;block-size:auto;min-block-size:100%;-webkit-user-select:none;user-select:none;align-content:center;align-items:center;overflow-wrap:break-word;border-width:1px;border-style:solid;font-weight:var(--calcite-font-weight-medium);line-height:1;border-color:var(--calcite-input-border-color, var(--calcite-color-border-input))}.prefix{order:2;border-inline-end-width:0px;inline-size:var(--calcite-input-prefix-size, auto);background-color:var(--calcite-input-prefix-background-color, var(--calcite-color-background));color:var(--calcite-input-prefix-text-color, var(--calcite-color-text-2))}.suffix{order:5;border-inline-start-width:0px;inline-size:var(--calcite-input-suffix-size, auto);background-color:var(--calcite-input-suffix-background-color, var(--calcite-color-background));color:var(--calcite-input-suffix-text-color, var(--calcite-color-text-2))}:host([alignment=start]) textarea,:host([alignment=start]) input{text-align:start}:host([alignment=end]) textarea,:host([alignment=end]) input{text-align:end}input[type=number]{-moz-appearance:textfield}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;-moz-appearance:textfield;margin:0}.number-button-wrapper{pointer-events:none;order:6;box-sizing:border-box;display:flex;flex-direction:column;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out}:host([number-button-type=vertical]) .wrapper{flex-direction:row;display:flex}:host([number-button-type=vertical]) input,:host([number-button-type=vertical]) textarea{order:2}:host([number-button-type=horizontal]) .calcite--rtl .number-button-item[data-adjustment=down] calcite-icon{transform:rotate(-90deg)}:host([number-button-type=horizontal]) .calcite--rtl .number-button-item[data-adjustment=up] calcite-icon{transform:rotate(-90deg)}.number-button-item.number-button-item--horizontal{border-color:var(--calcite-input-border-color, var(--calcite-color-border-input));order:1;max-block-size:100%;min-block-size:100%;align-self:stretch;border-width:1px;border-style:solid}.number-button-item.number-button-item--horizontal[data-adjustment=down] calcite-icon,.number-button-item.number-button-item--horizontal[data-adjustment=up] calcite-icon{transform:rotate(90deg)}.number-button-item.number-button-item--horizontal[data-adjustment=down]{border-inline-end-width:0px}.number-button-item.number-button-item--horizontal[data-adjustment=up]{border-inline-start-width:0px;order:5}.number-button-item{max-block-size:50%;min-block-size:50%;pointer-events:initial;margin:0;box-sizing:border-box;display:flex;cursor:pointer;align-items:center;align-self:center;border-width:1px;border-style:solid;background-color:var(--calcite-color-foreground-1);padding-block:0px;padding-inline:.5rem;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;border-color:var(--calcite-input-border-color, var(--calcite-color-border-input));background-color:var(--calcite-input-actions-background-color, var(--calcite-color-foreground-1));border-inline-start-width:0px}.number-button-item calcite-icon{pointer-events:none;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;color:var(--calcite-input-actions-icon-color, var(--calcite-color-text-3))}.number-button-item:hover{background-color:var(--calcite-input-actions-background-color-hover, var(--calcite-color-foreground-2))}.number-button-item:hover calcite-icon{color:var(--calcite-input-actions-icon-color-hover, var(--calcite-color-text-1))}.number-button-item:active{background-color:var(--calcite-input-actions-background-color-press, var(--calcite-color-foreground-3))}.number-button-item:active calcite-icon{color:var(--calcite-input-actions-icon-color-press, var(--calcite-color-text-1))}.number-button-item:disabled{pointer-events:none}.wrapper{position:relative;display:flex;flex-direction:row;align-items:center;border-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp));box-shadow:var(--calcite-input-shadow, var(--calcite-shadow-none))}input[type=date]::-webkit-input-placeholder{visibility:hidden!important}:host([type=color]) input{padding:.25rem}:host([type=file]) input{cursor:pointer;border-width:1px;border-style:dashed;background-color:var(--calcite-color-foreground-1);text-align:center;border-color:var(--calcite-input-border-color, var(--calcite-color-border-input));block-size:initial}:host([type=file][scale=s]) input{padding-block:1px;padding-inline:.5rem}:host([type=file][scale=m]) input{padding-block:.25rem;padding-inline:.75rem}:host([type=file][scale=l]) input{padding-block:.5rem;padding-inline:1rem}:host(.no-bottom-border) input{border-block-end-width:0px}:host(.border-top-color-one) input{border-block-start-color:var(--calcite-color-border-1)}input.inline-child{background-color:transparent;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out}input.inline-child .editing-enabled{background-color:inherit}input.inline-child:not(.editing-enabled){display:flex;cursor:pointer;text-overflow:ellipsis;border-color:transparent;padding-inline-start:0}.validation-container{display:flex;flex-direction:column;align-items:flex-start;align-self:stretch}:host([scale=m]) .validation-container,:host([scale=l]) .validation-container{padding-block-start:.5rem}:host([scale=s]) .validation-container{padding-block-start:.25rem}::slotted(input[slot=hidden-form-input]){margin:0!important;opacity:0!important;outline:none!important;padding:0!important;position:absolute!important;inset:0!important;transform:none!important;-webkit-appearance:none!important;z-index:-1!important}:host([hidden]){display:none}[hidden]{display:none}::placeholder{font-weight:var(--calcite-font-weight-normal);color:var(--calcite-input-placeholder-text-color, var(--calcite-color-text-3))}`;class $ extends c.oi{constructor(){super(),this.actionWrapperEl=(0,a.V)(),this.attributeWatch=(0,u.g0)(["autofocus","enterkeyhint","inputmode","spellcheck"],this.handleGlobalAttributesChanged),this.childElType="input",this.inputWrapperEl=(0,a.V)(),this.onHiddenFormInputInput=e=>{e.target.name===this.name&&this.setValue({value:e.target.value,origin:"direct"}),this.setFocus(),e.stopPropagation()},this.previousValueOrigin="initial",this.userChangedValue=!1,this._value="",this.messages=(0,b.u)(),this.slottedActionElDisabledInternally=!1,this.alignment="start",this.clearable=!1,this.disabled=!1,this.editingEnabled=!1,this.groupSeparator=!1,this.iconFlipRtl=!1,this.loading=!1,this.localeFormat=!1,this.multiple=!1,this.numberButtonType="vertical",this.readOnly=!1,this.required=!1,this.scale="m",this.status="idle",this.type="text",this.validity={valid:!1,badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1},this.calciteInputChange=(0,c.yM)({cancelable:!1}),this.calciteInputInput=(0,c.yM)(),this.calciteInternalInputBlur=(0,c.yM)({cancelable:!1}),this.calciteInternalInputFocus=(0,c.yM)({cancelable:!1}),this.listen("click",this.clickHandler),this.listen("keydown",this.keyDownHandler)}static{this.properties={displayedValue:[16,{},{state:!0}],slottedActionElDisabledInternally:[16,{},{state:!0}],accept:1,alignment:[3,{},{reflect:!0}],autocomplete:[0,{},{attribute:!1}],clearable:[7,{},{reflect:!0,type:Boolean}],disabled:[7,{},{reflect:!0,type:Boolean}],editingEnabled:[7,{},{reflect:!0,type:Boolean}],files:[0,{},{attribute:!1}],form:[3,{},{reflect:!0}],groupSeparator:[7,{},{reflect:!0,type:Boolean}],icon:[3,{converter:c.Kb},{reflect:!0}],iconFlipRtl:[7,{},{reflect:!0,type:Boolean}],label:1,loading:[7,{},{reflect:!0,type:Boolean}],localeFormat:[5,{},{type:Boolean}],max:[11,{},{reflect:!0,type:Number}],maxLength:[11,{},{reflect:!0,type:Number}],messageOverrides:[0,{},{attribute:!1}],min:[11,{},{reflect:!0,type:Number}],minLength:[11,{},{reflect:!0,type:Number}],multiple:[5,{},{type:Boolean}],name:[3,{},{reflect:!0}],numberButtonType:[3,{},{reflect:!0}],numberingSystem:[3,{},{reflect:!0}],pattern:1,placeholder:1,prefixText:1,readOnly:[7,{},{reflect:!0,type:Boolean}],required:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],status:[3,{},{reflect:!0}],step:[3,{},{reflect:!0}],suffixText:1,type:[3,{},{reflect:!0}],validationIcon:[3,{converter:c.Kb},{reflect:!0}],validationMessage:1,validity:[0,{},{attribute:!1}],value:1}}static{this.styles=U}get value(){return this._value}set value(e){const t=this._value;e!==t&&(this._value=e,this.valueWatcher(e,t),e&&""===this._value&&this.setValue({origin:"reset",value:t}))}async selectText(){"number"===this.type?this.childNumberEl?.select():this.childEl?.select()}async setFocus(){await(0,v.c)(this),(0,d.h)("number"===this.type?this.childNumberEl:this.childEl)}connectedCallback(){super.connectedCallback(),this.inlineEditableEl=this.el.closest("calcite-inline-editable"),this.inlineEditableEl&&(this.editingEnabled=this.inlineEditableEl.editingEnabled||!1),(0,f.c)(this),(0,h.c)(this),this.el.addEventListener(h.i,this.onHiddenFormInputInput)}async load(){this.childElType="textarea"===this.type?"textarea":"input",this.maxString=this.max?.toString(),this.minString=this.min?.toString(),this.requestedIcon=(0,d.v)(V,this.icon,this.type),this.setPreviousEmittedValue(this.value),this.setPreviousValue(this.value),"number"===this.type&&("Infinity"===this.value||"-Infinity"===this.value?(this.displayedValue=this.value,this.previousEmittedValue=this.value):(this.warnAboutInvalidNumberValue(this.value),this.setValue({origin:"connected",value:(0,g.i)(this.value)?this.value:""})))}willUpdate(e){e.has("max")&&(this.maxString=this.max?.toString()||null),e.has("min")&&(this.minString=this.min?.toString()||null),(e.has("icon")||e.has("type")&&(this.hasUpdated||"text"!==this.type))&&(this.requestedIcon=(0,d.v)(V,this.icon,this.type))}updated(){(0,p.u)(this)}disconnectedCallback(){super.disconnectedCallback(),(0,f.d)(this),(0,h.d)(this),this.el.removeEventListener(h.i,this.onHiddenFormInputInput)}get isClearable(){return!this.isTextarea&&(this.clearable||"search"===this.type)&&this.value?.length>0}get isTextarea(){return"textarea"===this.childElType}handleGlobalAttributesChanged(){this.requestUpdate()}valueWatcher(e,t){if(!this.userChangedValue){if("number"===this.type&&("Infinity"===e||"-Infinity"===e))return this.displayedValue=e,void(this.previousEmittedValue=e);this.setValue({origin:"direct",previousValue:t,value:null==e||""==e?"":"number"===this.type?(0,g.i)(e)?e:this.previousValue||"":e}),this.warnAboutInvalidNumberValue(e)}this.userChangedValue=!1}keyDownHandler(e){this.readOnly||this.disabled||e.defaultPrevented||(this.isClearable&&"Escape"===e.key&&(this.clearInputValue(e),e.preventDefault()),"Enter"===e.key&&(0,h.s)(this)&&e.preventDefault())}onLabelClick(){this.setFocus()}incrementOrDecrementNumberValue(e,t,i,n){const{value:r}=this;if("Infinity"===r||"-Infinity"===r)return;const s="up"===e?1:-1,o="any"===this.step?1:Math.abs(this.step||1),a=new g.B(""!==r?r:"0").add(""+o*s),l="number"==typeof i&&!isNaN(i)&&a.subtract(`${i}`).isNegative?`${i}`:"number"!=typeof t||isNaN(t)||a.subtract(`${t}`).isNegative?a.toString():`${t}`;this.setValue({committing:!0,nativeEvent:n,origin:"user",value:l})}clearInputValue(e){this.setValue({committing:!0,nativeEvent:e,origin:"user",value:""})}emitChangeIfUserModified(){"user"===this.previousValueOrigin&&this.value!==this.previousEmittedValue&&(this.calciteInputChange.emit(),this.setPreviousEmittedValue(this.value))}inputBlurHandler(){window.clearInterval(this.nudgeNumberValueIntervalId),this.calciteInternalInputBlur.emit(),this.emitChangeIfUserModified()}clickHandler(e){if(this.disabled)return;const t=e.composedPath();t.includes(this.inputWrapperEl.value)&&!t.includes(this.actionWrapperEl.value)&&this.setFocus()}inputFocusHandler(){this.calciteInternalInputFocus.emit()}inputInputHandler(e){this.disabled||this.readOnly||("file"===this.type&&(this.files=this.childEl.files),this.setValue({nativeEvent:e,origin:"user",value:e.target.value}))}inputKeyDownHandler(e){this.disabled||this.readOnly||"Enter"===e.key&&this.emitChangeIfUserModified()}inputNumberInputHandler(e){if(this.disabled||this.readOnly)return;if("Infinity"===this.value||"-Infinity"===this.value)return;const t=e.target.value;g.n.numberFormatOptions={locale:this.messages._lang,numberingSystem:this.numberingSystem,useGrouping:this.groupSeparator};const i=g.n.delocalize(t);"insertFromPaste"===e.inputType?((0,g.i)(i)||e.preventDefault(),this.setValue({nativeEvent:e,origin:"user",value:(0,g.p)(i)}),this.childNumberEl.value=this.displayedValue):this.setValue({nativeEvent:e,origin:"user",value:i})}inputNumberKeyDownHandler(e){if("number"!==this.type||this.disabled||this.readOnly)return;if("Infinity"===this.value||"-Infinity"===this.value)return e.preventDefault(),void("Backspace"!==e.key&&"Delete"!==e.key||this.clearInputValue(e));if("ArrowUp"===e.key)return e.preventDefault(),void this.nudgeNumberValue("up",e);if("ArrowDown"===e.key)return void this.nudgeNumberValue("down",e);const t=[...m.n,"ArrowLeft","ArrowRight","Backspace","Delete","Enter","Escape","Tab"];if(e.altKey||e.ctrlKey||e.metaKey)return;const i=e.shiftKey&&"Tab"===e.key;if(t.includes(e.key)||i)"Enter"===e.key&&this.emitChangeIfUserModified();else{if(g.n.numberFormatOptions={locale:this.messages._lang,numberingSystem:this.numberingSystem,useGrouping:this.groupSeparator},e.key===g.n.decimal){if(!this.value&&!this.childNumberEl.value)return;if(this.value&&-1===this.childNumberEl.value.indexOf(g.n.decimal))return}if(/[eE]/.test(e.key)){if(!this.value&&!this.childNumberEl.value)return;if(this.value&&!/[eE]/.test(this.childNumberEl.value))return}if("-"===e.key){if(!this.value&&!this.childNumberEl.value)return;if(this.value&&this.childNumberEl.value.split("-").length<=2)return}e.preventDefault()}}nudgeNumberValue(e,t){if(t instanceof KeyboardEvent&&t.repeat||"number"!==this.type)return;const i=this.maxString?parseFloat(this.maxString):null,n=this.minString?parseFloat(this.minString):null;this.incrementOrDecrementNumberValue(e,i,n,t),this.nudgeNumberValueIntervalId&&window.clearInterval(this.nudgeNumberValueIntervalId);let r=!0;this.nudgeNumberValueIntervalId=window.setInterval((()=>{r?r=!1:this.incrementOrDecrementNumberValue(e,i,n,t)}),150)}numberButtonPointerUpAndOutHandler(){window.clearInterval(this.nudgeNumberValueIntervalId)}numberButtonPointerDownHandler(e){if(!(0,d.i)(e))return;e.preventDefault();const t=e.target.dataset.adjustment;this.disabled||this.nudgeNumberValue(t,e)}syncHiddenFormInput(e){(0,_.s)(this.type,this,e)}setChildElRef(e){this.childEl=e}setChildNumberElRef(e){this.childNumberEl=e}setInputValue(e){"number"===this.type&&this.childNumberEl?this.childNumberEl.value=e:this.childEl&&(this.childEl.value=e)}setPreviousEmittedValue(e){this.previousEmittedValue=this.normalizeValue(e)}normalizeValue(e){return"number"===this.type?(0,g.i)(e)?e:"":e}setPreviousValue(e){this.previousValue=this.normalizeValue(e)}setValue({committing:e=!1,nativeEvent:t,origin:i,previousValue:n,value:r}){if(this.setPreviousValue(n??this.value),this.previousValueOrigin=i,"number"===this.type){g.n.numberFormatOptions={locale:this.messages._lang,numberingSystem:this.numberingSystem,useGrouping:this.groupSeparator,signDisplay:"never"};const e=this.previousValue?.length>r.length||this.value?.length>r.length,t="."===r.charAt(r.length-1),n=t&&e?r:(0,g.s)(r),s=r&&!n?(0,g.i)(this.previousValue)?this.previousValue:"":n;let o=g.n.localize(s);"connected"===i||t||(o=(0,g.c)(o,s,g.n)),this.displayedValue=t&&e?`${o}${g.n.decimal}`:o,this.userChangedValue="user"===i&&this.value!==s,this.value=["-","."].includes(s)?"":s}else this.userChangedValue="user"===i&&this.value!==r,this.value=r;if("direct"===i&&(this.setInputValue(r),this.previousEmittedValue=r),t){this.calciteInputInput.emit().defaultPrevented?(this.value=this.previousValue,this.displayedValue="number"===this.type?g.n.localize(this.previousValue):this.previousValue):e&&this.emitChangeIfUserModified()}}inputKeyUpHandler(){window.clearInterval(this.nudgeNumberValueIntervalId)}warnAboutInvalidNumberValue(e){"number"===this.type&&e&&!(0,g.i)(e)&&console.warn(`The specified value "${e}" cannot be parsed, or is out of range.`)}render(){const e=(0,d.g)(this.el),t=o.dy`<div class=${(0,c.Vp)(C)}><calcite-progress .label=${this.messages.loading} type=indeterminate></calcite-progress></div>`,i=o.dy`<button .ariaLabel=${this.messages.clear} class=${(0,c.Vp)(x)} .disabled=${this.disabled||this.readOnly} @click=${this.clearInputValue} tabindex=-1 type=button><calcite-icon icon=x .scale=${(0,v.g)(this.scale)}></calcite-icon></button>`,u=o.dy`<calcite-icon class=${(0,c.Vp)(T)} .flipRtl=${this.iconFlipRtl} .icon=${this.requestedIcon} .scale=${(0,v.g)(this.scale)}></calcite-icon>`,m="horizontal"===this.numberButtonType,g=o.dy`<button aria-hidden=true class=${(0,c.Vp)({[A]:!0,[O]:m})} data-adjustment=up .disabled=${this.disabled||this.readOnly} @pointerdown=${this.numberButtonPointerDownHandler} @pointerout=${this.numberButtonPointerUpAndOutHandler} @pointerup=${this.numberButtonPointerUpAndOutHandler} tabindex=-1 type=button><calcite-icon icon=chevron-up .scale=${(0,v.g)(this.scale)}></calcite-icon></button>`,b=o.dy`<button aria-hidden=true class=${(0,c.Vp)({[A]:!0,[O]:m})} data-adjustment=down .disabled=${this.disabled||this.readOnly} @pointerdown=${this.numberButtonPointerDownHandler} @pointerout=${this.numberButtonPointerUpAndOutHandler} @pointerup=${this.numberButtonPointerUpAndOutHandler} tabindex=-1 type=button><calcite-icon icon=chevron-down .scale=${(0,v.g)(this.scale)}></calcite-icon></button>`,_=o.dy`<div class=${(0,c.Vp)(P)}>${g}${b}</div>`,w=o.dy`<div class=${(0,c.Vp)(k)}>${this.prefixText}</div>`,V=o.dy`<div class=${(0,c.Vp)(I)}>${this.suffixText}</div>`,U=this.el.autofocus,$=this.el.enterKeyHint,B=this.el.inputMode,j="number"===this.type?(0,s.U)("localized-input",o.dy`<input accept=${this.accept??o.Ld} aria-errormessage=${N} .ariaInvalid=${"invalid"===this.status} .ariaLabel=${(0,f.g)(this)} autocomplete=${this.autocomplete??o.Ld} .autofocus=${U} value=${this.defaultValue??o.Ld} .disabled=${!!this.disabled||null} enterkeyhint=${$??o.Ld} inputmode=${B??o.Ld} maxlength=${this.maxLength??o.Ld} minlength=${this.minLength??o.Ld} .multiple=${this.multiple} name=${o.Ld} @blur=${this.inputBlurHandler} @focus=${this.inputFocusHandler} @input=${this.inputNumberInputHandler} @keydown=${this.inputNumberKeyDownHandler} @keyup=${this.inputKeyUpHandler} pattern=${this.pattern??o.Ld} placeholder=${(this.placeholder||"")??o.Ld} .readOnly=${this.readOnly} type=text .value=${(0,r.a)(this.displayedValue??"")} ${(0,a.i)(this.setChildNumberElRef)}>`):null,H="input"===this.childElType?l.i0`input`:l.i0`textarea`,Z="number"!==this.type?l.dy`<${H} accept=${this.accept??o.Ld} aria-errormessage=${N} .ariaInvalid=${"invalid"===this.status} .ariaLabel=${(0,f.g)(this)} autocomplete=${this.autocomplete??o.Ld} .autofocus=${U} class=${(0,c.Vp)({[E]:this.editingEnabled,[S]:!!this.inlineEditableEl})} .defaultValue=${this.defaultValue??""} .disabled=${!!this.disabled||null} enterkeyhint=${$??o.Ld} inputmode=${B??o.Ld} max=${this.maxString??o.Ld} maxlength=${this.maxLength??o.Ld} min=${this.minString??o.Ld} minlength=${this.minLength??o.Ld} .multiple=${this.multiple} name=${this.name??o.Ld} @blur=${this.inputBlurHandler} @focus=${this.inputFocusHandler} @input=${this.inputInputHandler} @keydown=${this.inputKeyDownHandler} @keyup=${this.inputKeyUpHandler} pattern=${this.pattern??o.Ld} placeholder=${(this.placeholder||"")??o.Ld} .readOnly=${this.readOnly} .required=${!!this.required||null} spellcheck=${this.el.spellcheck??o.Ld} step=${this.step??o.Ld} tabindex=${(this.disabled||this.inlineEditableEl&&!this.editingEnabled?-1:null)??o.Ld} type=${this.type??o.Ld} .value=${(0,r.a)(this.value??"")} ${(0,a.i)(this.setChildElRef)}></${H}>`:null;return(0,p.I)({disabled:this.disabled,children:o.dy`<div class=${(0,c.Vp)({[M]:!0,[n.C.rtl]:"rtl"===e,[D]:this.suffixText,[F]:this.prefixText})} ${(0,a.i)(this.inputWrapperEl)}>${"number"!==this.type||"horizontal"!==this.numberButtonType||this.readOnly?null:b}${this.prefixText?w:null}<div class=${(0,c.Vp)(L)}>${j}${Z}${this.isClearable?i:null}${this.requestedIcon?u:null}${this.loading?t:null}</div><div class=${(0,c.Vp)(R)} ${(0,a.i)(this.actionWrapperEl)}><slot name=${z}></slot></div>${"number"!==this.type||"vertical"!==this.numberButtonType||this.readOnly?null:_}${this.suffixText?V:null}${"number"!==this.type||"horizontal"!==this.numberButtonType||this.readOnly?null:g}${(0,h.H)({component:this})}</div>${this.validationMessage&&"invalid"===this.status?(0,y.V)({icon:this.validationIcon,id:N,message:this.validationMessage,scale:this.scale,status:this.status}):null}`})}}(0,n.c)("calcite-input",$)},26344:function(e,t,i){i.r(t),i.d(t,{Option:function(){return l}});var n=i(43625),r=i(73444),s=i(23230),o=i(52642);const a=i(49006).iv`:host{display:block}:host([hidden]){display:none}[hidden]{display:none}`;class l extends s.oi{constructor(){super(...arguments),this.mutationObserver=(0,o.c)("mutation",(()=>{this.ensureTextContentDependentProps(),this.calciteInternalOptionChange.emit()})),this.disabled=!1,this.calciteInternalOptionChange=(0,s.yM)({cancelable:!1})}static{this.properties={disabled:[7,{},{reflect:!0,type:Boolean}],label:1,selected:[7,{},{reflect:!0,type:Boolean}],value:1}}static{this.styles=a}connectedCallback(){super.connectedCallback(),this.ensureTextContentDependentProps(),this.mutationObserver?.observe(this.el,{attributeFilter:["label","value"],characterData:!0,childList:!0,subtree:!0})}willUpdate(e){e.has("disabled")&&(this.hasUpdated||!1!==this.disabled)&&this.handlePropChange(this.disabled,e.get("disabled"),"disabled"),e.has("label")&&this.handlePropChange(this.label,e.get("label"),"label"),e.has("selected")&&this.handlePropChange(this.selected,e.get("selected"),"selected"),e.has("value")&&this.handlePropChange(this.value,e.get("value"),"value")}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver?.disconnect()}handlePropChange(e,t,i){"label"!==i&&"value"!==i||this.ensureTextContentDependentProps(),this.calciteInternalOptionChange.emit()}ensureTextContentDependentProps(){const{el:{textContent:e},internallySetLabel:t,internallySetValue:i,label:n,value:r}=this;n&&n!==t||(this.label=e,this.internallySetLabel=e),null!=r&&r!==i||(this.value=e,this.internallySetValue=e)}render(){return r.dy`<slot>${this.label}</slot>`}}(0,n.c)("calcite-option",l)},18162:function(e,t,i){var n=i(43625),r=i(15294),s=i(23230),o=i(58268);const a=i(49006).iv`:host{position:relative;display:block;inline-size:100%}.track,.bar{position:absolute;inset-block-start:0px;block-size:2px}.track{z-index:var(--calcite-z-index);inline-size:100%;overflow:hidden;background-color:var(--calcite-progress-background-color, var(--calcite-color-border-3))}.bar{z-index:var(--calcite-z-index);background-color:var(--calcite-progress-fill-color, var(--calcite-color-brand))}@media (forced-colors: active){.track{background-color:highlightText}.bar{background-color:linkText}}.indeterminate{inline-size:20%;animation:looping-progress-bar-ani calc(var(--calcite-internal-animation-timing-medium) / var(--calcite-internal-duration-factor) * 11 / var(--calcite-internal-duration-factor)) linear infinite}.indeterminate.calcite--rtl{animation-name:looping-progress-bar-ani-rtl}.reversed{animation-direction:reverse}.text{padding-inline:0px;padding-block:1rem 0px;text-align:center;font-size:var(--calcite-font-size--2);line-height:1rem;font-weight:var(--calcite-font-weight-medium);color:var(--calcite-progress-text-color, var(--calcite-color-text-2))}@keyframes looping-progress-bar-ani{0%{transform:translate3d(-100%,0,0)}50%{inline-size:40%}to{transform:translate3d(600%,0,0)}}@keyframes looping-progress-bar-ani-rtl{0%{transform:translate3d(100%,0,0)}50%{inline-size:40%}to{transform:translate3d(-600%,0,0)}}:host([hidden]){display:none}[hidden]{display:none}`;class l extends s.oi{constructor(){super(...arguments),this.reversed=!1,this.type="determinate",this.value=0}static{this.properties={label:1,reversed:[7,{},{reflect:!0,type:Boolean}],text:1,type:[3,{},{reflect:!0}],value:[9,{},{type:Number}]}}static{this.styles=a}render(){const e="determinate"===this.type,t=e?{width:`${this.value}%`}:{},i=(0,o.g)(this.el);return r.dy`<div .ariaLabel=${this.label||this.text} .ariaValueMax=${e?"100":void 0} .ariaValueMin=${e?"0":void 0} .ariaValueNow=${e?this.value:void 0} role=progressbar><div class="track"><div class=${(0,s.Vp)({bar:!0,indeterminate:"indeterminate"===this.type,[n.C.rtl]:"rtl"===i,reversed:this.reversed})} style=${(0,s.kA)(t)}></div></div>${this.text?r.dy`<div class="text">${this.text}</div>`:null}</div>`}}(0,n.c)("calcite-progress",l)},26059:function(e,t,i){i(55001);var n=i(43625),r=i(81879),s=i(15294),o=i(23230),a=i(52642),l=i(58268),c=i(76299),u=i(49006);const d="scrim",h="content",p=72,m=480,f=u.iv`:host{position:absolute;inset:0;z-index:var(--calcite-z-index-overlay);display:flex;block-size:100%;inline-size:100%;flex-direction:column;align-items:stretch}@keyframes calcite-scrim-fade-in{0%{--tw-bg-opacity: 0 }to{--tw-text-opacity: 1 }}.scrim{position:absolute;inset:0;display:flex;flex-direction:column;align-content:center;align-items:center;justify-content:center;overflow:hidden;animation:calcite-scrim-fade-in var(--calcite-internal-animation-timing-medium) ease-in-out;background-color:var(--calcite-scrim-background, var(--calcite-color-transparent-scrim))}.content{padding:1rem}:host([hidden]){display:none}[hidden]{display:none}`;class v extends o.oi{constructor(){super(...arguments),this.resizeObserver=(0,a.c)("resize",(()=>this.handleResize())),this.messages=(0,c.u)(),this.hasContent=!1,this.loading=!1}static{this.properties={hasContent:[16,{},{state:!0}],loaderScale:[16,{},{state:!0}],loading:[7,{},{reflect:!0,type:Boolean}],messageOverrides:[0,{},{attribute:!1}]}}static{this.styles=f}connectedCallback(){super.connectedCallback(),this.resizeObserver?.observe(this.el)}disconnectedCallback(){super.disconnectedCallback(),this.resizeObserver?.disconnect()}handleDefaultSlotChange(e){this.hasContent=(0,l.r)(e)}storeLoaderEl(e){this.loaderEl=e,this.handleResize()}getScale(e){return e<p?"s":e>=m?"l":"m"}handleResize(){const{loaderEl:e,el:t}=this;e&&(this.loaderScale=this.getScale(Math.min(t.clientHeight,t.clientWidth)??0))}render(){const{hasContent:e,loading:t,messages:i}=this;return s.dy`<div class=${(0,o.Vp)(d)}>${t?s.dy`<calcite-loader .label=${i.loading} .scale=${this.loaderScale} ${(0,r.i)(this.storeLoaderEl)}></calcite-loader>`:null}<div class=${(0,o.Vp)(h)} .hidden=${!e}><slot @slotchange=${this.handleDefaultSlotChange}></slot></div></div>`}}(0,n.c)("calcite-scrim",v)},44015:function(e,t,i){i.r(t),i.d(t,{Select:function(){return w}});i(7337),i(4204);var n=i(43625),r=i(81879),s=i(73444),o=i(23230),a=i(58268),l=i(15022),c=i(4431),u=i(44002),d=i(25064),h=i(52642),p=i(57618);const m=i(49006).iv`:host{--calcite-icon-size: 1rem;--calcite-spacing-eighth: .125rem;--calcite-spacing-quarter: .25rem;--calcite-spacing-half: .5rem;--calcite-spacing-three-quarters: .75rem;--calcite-spacing: 1rem;--calcite-spacing-plus-quarter: 1.25rem;--calcite-spacing-plus-half: 1.5rem;--calcite-spacing-double: 2rem;--calcite-menu-min-width: 10rem;--calcite-header-min-height: 3rem;--calcite-footer-min-height: 3rem}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:flex;flex-direction:column;font-size:var(--calcite-select-font-size);font-weight:var(--calcite-internal-select-font-weight, var(--calcite-font-weight-regular))}.wrapper{position:relative;display:flex;align-items:stretch;inline-size:var(--select-width);block-size:var(--calcite-internal-select-block-size, 32px)}.wrapper:focus-within .icon,.wrapper:active .icon,.wrapper:hover .icon{color:var(--calcite-select-icon-color-hover, var(--calcite-color-text-1))}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}:host([scale=s]){--calcite-internal-select-font-size: var(--calcite-font-size--2);--calcite-select-spacing-inline: .5rem 2rem;--calcite-internal-select-icon-container-padding-inline: var(--calcite-spacing-sm);--calcite-internal-select-block-size: 24px}:host([scale=m]){--calcite-internal-select-font-size: var(--calcite-font-size--1);--calcite-select-spacing-inline: .75rem 2.5rem;--calcite-internal-select-icon-container-padding-inline: var(--calcite-spacing-md)}:host([scale=l]){--calcite-internal-select-font-size: var(--calcite-font-size-0);--calcite-select-spacing-inline: 1rem 3rem;--calcite-internal-select-icon-container-padding-inline: var(--calcite-spacing-lg);--calcite-internal-select-block-size: 44px}:host([width=auto]){inline-size:auto}:host([width=half]){inline-size:50%}:host([width=full]){inline-size:100%}.select{margin:0;box-sizing:border-box;inline-size:100%;cursor:pointer;appearance:none;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;border-radius:0;border-style:solid;background-color:var(--calcite-color-foreground-1);font-family:inherit;outline-color:transparent;font-weight:inherit;font-size:var(--calcite-select-font-size, var(--calcite-internal-select-font-size));color:var(--calcite-select-text-color, var(--calcite-color-text-2));border-color:var(--calcite-select-border-color, var(--calcite-color-border-input));border-width:var(--calcite-select-internal-border-width, var(--calcite-border-width-sm));padding-inline:var(--calcite-select-spacing-inline);padding-block:var(--calcite-internal-select-spacing-block);border-inline-end-width:0;line-height:var(--calcite-internal-select-line-height, normal)}.select:focus{outline:2px solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline-offset:calc(-2px*(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}select:disabled{border-color:var(--calcite-color-border-input);--tw-bg-opacity: 1}.icon-container{pointer-events:none;position:absolute;inset-block:0px;display:flex;align-items:center;border-width:0px;border-style:solid;border-color:var(--calcite-color-border-input);background-color:transparent;color:var(--calcite-color-text-2);inset-inline-end:0px;border-color:var(--calcite-select-border-color, var(--calcite-color-border-input));border-inline-width:0px var(--calcite-select-internal-icon-border-inline-end-width, 1px);padding-inline:var(--calcite-internal-select-icon-container-padding-inline)}.icon-container .icon{color:var(--calcite-select-icon-color, var(--calcite-color-text-3))}:host([status=invalid]) select,:host([status=invalid]) .icon-container{border-color:var(--calcite-color-status-danger)}:host([status=invalid]) select:focus,:host([status=invalid]) .icon-container:focus{outline:2px solid var(--calcite-color-status-danger);outline-offset:calc(-2px*(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}.select:focus~.icon-container{border-color:transparent}.validation-container{display:flex;flex-direction:column;align-items:flex-start;align-self:stretch}:host([scale=m]) .validation-container,:host([scale=l]) .validation-container{padding-block-start:.5rem}:host([scale=s]) .validation-container{padding-block-start:.25rem}::slotted(input[slot=hidden-form-input]){margin:0!important;opacity:0!important;outline:none!important;padding:0!important;position:absolute!important;inset:0!important;transform:none!important;-webkit-appearance:none!important;z-index:-1!important}:host([hidden]){display:none}[hidden]{display:none}`,f="icon",v="icon-container",g="select",y="wrapper",b="selectValidationMessage";function _(e){return"CALCITE-OPTION"===e.tagName}class w extends o.oi{constructor(){super(),this.componentToNativeEl=new Map,this.mutationObserver=(0,h.c)("mutation",(()=>this.populateInternalSelect())),this.disabled=!1,this.required=!1,this.scale="m",this.status="idle",this.validity={valid:!1,badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1},this.value=null,this.width="auto",this.calciteSelectChange=(0,o.yM)({cancelable:!1}),this.listen("calciteInternalOptionChange",this.handleOptionOrGroupChange),this.listen("calciteInternalOptionGroupChange",this.handleOptionOrGroupChange)}static{this.properties={disabled:[7,{},{reflect:!0,type:Boolean}],form:[3,{},{reflect:!0}],label:1,name:[3,{},{reflect:!0}],required:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],selectedOption:[0,{},{attribute:!1}],status:[3,{},{reflect:!0}],validationIcon:[3,{converter:o.Kb},{reflect:!0}],validationMessage:1,validity:[0,{},{attribute:!1}],value:1,width:[3,{},{reflect:!0}]}}static{this.styles=m}async setFocus(){await(0,d.c)(this),(0,a.b)(this.selectEl)}connectedCallback(){super.connectedCallback();const{el:e}=this;this.mutationObserver?.observe(e,{subtree:!0,childList:!0}),(0,u.c)(this),(0,l.c)(this)}willUpdate(e){e.has("value")&&(this.hasUpdated||null!==this.value)&&this.updateItemsFromValue(this.value),e.has("selectedOption")&&(this.value=this.selectedOption?.value)}updated(){(0,c.u)(this)}loaded(){"string"==typeof this.value&&this.updateItemsFromValue(this.value),this.populateInternalSelect();const e=this.selectEl.selectedOptions[0];this.selectFromNativeOption(e),(0,l.a)(this,this.selectedOption?.value??"")}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver?.disconnect(),(0,u.d)(this),(0,l.d)(this)}handleInternalSelectChange(){const e=this.selectEl.selectedOptions[0];this.selectFromNativeOption(e),requestAnimationFrame((()=>this.emitChangeEvent()))}handleOptionOrGroupChange(e){e.stopPropagation();const t=e.target,i=this.componentToNativeEl.get(t);i&&(this.updateNativeElement(t,i),_(t)&&t.selected&&(this.deselectAllExcept(t),this.selectedOption=t))}onLabelClick(){this.setFocus()}updateItemsFromValue(e){this.el.querySelectorAll("calcite-option").forEach((t=>t.selected=t.value===e))}updateNativeElement(e,t){if(t.disabled=e.disabled,t.label=e.label,_(e)){const i=t;i.selected=e.selected,i.value=e.value,i.innerText=e.label}}populateInternalSelect(){const e=Array.from(this.el.children).filter((e=>"CALCITE-OPTION"===e.tagName||"CALCITE-OPTION-GROUP"===e.tagName));this.clearInternalSelect(),e.forEach((e=>this.selectEl?.append(this.toNativeElement(e))))}clearInternalSelect(){this.componentToNativeEl.forEach((e=>e.remove())),this.componentToNativeEl.clear()}storeSelectRef(e){e&&(this.selectEl=e)}selectFromNativeOption(e){if(!e)return;let t;this.componentToNativeEl.forEach(((i,n)=>{_(n)&&i===e&&(n.selected=!0,t=n,this.deselectAllExcept(n))})),t&&(this.selectedOption=t)}toNativeElement(e){if(_(e)){const t=document.createElement("option");return this.updateNativeElement(e,t),this.componentToNativeEl.set(e,t),t}if(function(e){return"CALCITE-OPTION-GROUP"===e.tagName}(e)){const t=document.createElement("optgroup");return this.updateNativeElement(e,t),Array.from(e.children).forEach((i=>{const n=this.toNativeElement(i);t.append(n),this.componentToNativeEl.set(e,n)})),this.componentToNativeEl.set(e,t),t}throw new Error("unsupported element child provided")}deselectAllExcept(e){this.el.querySelectorAll("calcite-option").forEach((t=>{t!==e&&(t.selected=!1)}))}emitChangeEvent(){this.calciteSelectChange.emit()}renderChevron(){return s.dy`<div class=${(0,o.Vp)(v)}><calcite-icon class=${(0,o.Vp)(f)} icon=chevron-down .scale=${(0,d.g)(this.scale)}></calcite-icon></div>`}render(){const{disabled:e}=this;return(0,c.I)({disabled:e,children:s.dy`<div class=${(0,o.Vp)(y)}><select aria-errormessage=${b} .ariaInvalid=${"invalid"===this.status} .ariaLabel=${(0,u.g)(this)} class=${(0,o.Vp)(g)} .disabled=${e} @change=${this.handleInternalSelectChange} ${(0,r.i)(this.storeSelectRef)}><slot></slot></select>${this.renderChevron()}${(0,l.H)({component:this})}</div>${this.validationMessage&&"invalid"===this.status?(0,p.V)({icon:this.validationIcon,id:b,message:this.validationMessage,scale:this.scale,status:this.status}):null}`})}}(0,n.c)("calcite-select",w)},89434:function(e,t,i){i.d(t,{r:function(){return a}});var n=i(15294),r=i(50445),s=i(23652);const o=(e,t,i)=>{const n=new Map;for(let r=t;r<=i;r++)n.set(e[r],r);return n},a=(0,r.XM)(class extends r.Xe{constructor(e){if(super(e),e.type!==r.pX.CHILD)throw Error("repeat() can only be used in text expressions")}dt(e,t,i){let n;void 0===i?i=t:void 0!==t&&(n=t);const r=[],s=[];let o=0;for(const t of e)r[o]=n?n(t,o):o,s[o]=i(t,o),o++;return{values:s,keys:r}}render(e,t,i){return this.dt(e,t,i).values}update(e,[t,i,r]){const a=(0,s.i9)(e),{values:l,keys:c}=this.dt(t,i,r);if(!Array.isArray(a))return this.ut=c,l;const u=this.ut??=[],d=[];let h,p,m=0,f=a.length-1,v=0,g=l.length-1;for(;m<=f&&v<=g;)if(null===a[m])m++;else if(null===a[f])f--;else if(u[m]===c[v])d[v]=(0,s.fk)(a[m],l[v]),m++,v++;else if(u[f]===c[g])d[g]=(0,s.fk)(a[f],l[g]),f--,g--;else if(u[m]===c[g])d[g]=(0,s.fk)(a[m],l[g]),(0,s._Y)(e,d[g+1],a[m]),m++,g--;else if(u[f]===c[v])d[v]=(0,s.fk)(a[f],l[v]),(0,s._Y)(e,a[m],a[f]),f--,v++;else if(void 0===h&&(h=o(c,v,g),p=o(u,m,f)),h.has(u[m]))if(h.has(u[f])){const t=p.get(c[v]),i=void 0!==t?a[t]:null;if(null===i){const t=(0,s._Y)(e,a[m]);(0,s.fk)(t,l[v]),d[v]=t}else d[v]=(0,s.fk)(i,l[v]),(0,s._Y)(e,a[m],i),a[t]=null;v++}else(0,s.ws)(a[f]),f--;else(0,s.ws)(a[m]),m++;for(;v<=g;){const t=(0,s._Y)(e,d[g+1]);(0,s.fk)(t,l[v]),d[v++]=t}for(;m<=f;){const e=a[m++];null!==e&&(0,s.ws)(e)}return this.ut=c,(0,s.hl)(e,d),n.Jb}})},46490:function(e,t,i){i.d(t,{dy:function(){return u},i0:function(){return a},s2:function(){return o}});var n=i(15294);const r=Symbol.for(""),s=e=>{if(e?.r===r)return e?._$litStatic$},o=e=>({_$litStatic$:e,r:r}),a=(e,...t)=>({_$litStatic$:t.reduce(((t,i,n)=>t+(e=>{if(void 0!==e._$litStatic$)return e._$litStatic$;throw Error(`Value passed to 'literal' function must be a 'literal' result: ${e}. Use 'unsafeStatic' to pass non-literal values, but\n            take care to ensure page security.`)})(i)+e[n+1]),e[0]),r:r}),l=new Map,c=e=>(t,...i)=>{const n=i.length;let r,o;const a=[],c=[];let u,d=0,h=!1;for(;d<n;){for(u=t[d];d<n&&void 0!==(o=i[d],r=s(o));)u+=r+t[++d],h=!0;d!==n&&c.push(o),a.push(u),d++}if(d===n&&a.push(t[n]),h){const e=a.join("$$lit$$");void 0===(t=l.get(e))&&(a.raw=a,l.set(e,t=a)),i=c}return e(t,...i)},u=c(n.dy);c(n.YP),c(n.cV)}}]);