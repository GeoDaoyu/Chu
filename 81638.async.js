"use strict";(self.webpackChunkscene_pro=self.webpackChunkscene_pro||[]).push([[81638,4506],{54229:function(t,e,n){n.d(e,{Z:function(){return y}});var r,o=n(73440),s=n(63255),i=n(17155),a=(n(61432),n(96711),n(83850),n(48023)),l=n(31865),u=n(10934),c=n(18156),f=n(21117),p=n(82846),m=n(86456);let y=class extends s.Z{static{r=this}constructor(t){super(t),this.translation=(0,p.Ue)(),this.rotationAxis=(0,p.nI)(m.up),this.rotationAngle=0,this.scale=(0,p.al)(1,1,1)}get rotation(){return(0,m.uT)(this.rotationAxis,this.rotationAngle)}set rotation(t){this.rotationAxis=(0,p.d9)((0,m.ZZ)(t)),this.rotationAngle=(0,m.EU)(t)}get localMatrix(){const t=(0,u.Ue)();return(0,c.yY)(h,(0,m.ZZ)(this.rotation),(0,m.WH)(this.rotation)),(0,l.Iw)(t,h,this.translation,this.scale),t}get localMatrixInverse(){return(0,l.U_)((0,u.Ue)(),this.localMatrix)}equals(t){return this===t||null!=t&&(0,l.I6)(this.localMatrix,t.localMatrix)}clone(){const t={translation:(0,p.d9)(this.translation),rotationAxis:(0,p.d9)(this.rotationAxis),rotationAngle:this.rotationAngle,scale:(0,p.d9)(this.scale)};return new r(t)}};(0,o._)([(0,i.Cb)({type:[Number],nonNullable:!0,json:{write:!0}})],y.prototype,"translation",void 0),(0,o._)([(0,i.Cb)({type:[Number],nonNullable:!0,json:{write:!0}})],y.prototype,"rotationAxis",void 0),(0,o._)([(0,i.Cb)({type:Number,nonNullable:!0,json:{write:!0}})],y.prototype,"rotationAngle",void 0),(0,o._)([(0,i.Cb)({type:[Number],nonNullable:!0,json:{write:!0}})],y.prototype,"scale",void 0),(0,o._)([(0,i.Cb)()],y.prototype,"rotation",null),(0,o._)([(0,i.Cb)()],y.prototype,"localMatrix",null),(0,o._)([(0,i.Cb)()],y.prototype,"localMatrixInverse",null),y=r=(0,o._)([(0,a.j)("esri.geometry.support.MeshTransform")],y);const h=(0,f.Ue)()},60419:function(t,e,n){n.d(e,{$6:function(){return v},$z:function(){return s},F7:function(){return o},S0:function(){return i},Si:function(){return y},Wr:function(){return d},X4:function(){return f},Zq:function(){return p},d1:function(){return l},dm:function(){return u},eP:function(){return c},fe:function(){return m},sg:function(){return h}});const r=[["binary","application/octet-stream","bin",""]];function o(t,e){return null!=x(e.name,t?.supportedFormats??[])}function s(t,e){if(!t)return!1;const n=u(e,t.supportedFormats??[]);return null!=n&&t.editFormats.includes(n)}function i(t,e){return b(function(t,e){const n=t.toLowerCase();return g(e).find((t=>w(t)===n))}(t,e))}function a(t,e){return b(x(t,e))}function l(t,e){return w(function(t,e){return g(e).find((e=>b(e)===t))}(t,e))}function u(t,e){return a(t.name,e)??i(t.type,e)}function c(t,e,n){return i(t,n)??a(e,n)}function f({supportedFormats:t}){return c("model/gltf-binary","glb",t)}function p(t){const e=f(t);return null!=e&&t.editFormats.includes(e)}function m({supportedFormats:t}){return c("model/gltf+json","gltf",t)}function y(t){if(!t)return null;const e=f(t),n=m(t);let r=null;for(const o of t.queryFormats){if(o===e)return o;o===n&&(r=o)}return r}function h({supportedFormats:t}){return c("application/esri3do-SR_world","wld",t)}function d({supportedFormats:t}){return c("application/esri3do-SR_prj","prj",t)}function g(t){return[...r,...t]}function x(t,e){const n=t.toLowerCase();return g(e).find((t=>Z(t).some((t=>n.endsWith(t)))))}function b(t){return t?.[0]}function w(t){return t?.[1].toLowerCase()}function Z(t){return t?.[2].split(",").map((t=>t.toLowerCase()))??[]}function v(t){return t.tables?.find((t=>"assetMaps"===t.role))}},13878:function(t,e,n){n.d(e,{Z:function(){return x}});var r,o=n(73440),s=n(46451),i=n(41773),a=n(63255),l=n(28947),u=n(17155),c=(n(61432),n(96711),n(1194)),f=n(48023),p=n(29884),m=n(45213),y=n(90756),h=n(98842),d=n(49651);const g=new i.X({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let x=r=class extends a.Z{constructor(t){super(t),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(t,e){return this.readFeaturesWithClass(t,e,s.Z)}writeGeometryType(t,e,n,r){if(t)return void g.write(t,e,n,r);const{features:o}=this;if(o)for(const t of o)if(null!=t?.geometry)return void g.write(t.geometry.type,e,n,r)}readQueryGeometry(t,e){if(!t)return null;const n=!!t.spatialReference,r=(0,y.im)(t);return r&&!n&&e.spatialReference&&(r.spatialReference=m.Z.fromJSON(e.spatialReference)),r}writeSpatialReference(t,e){if(t)return void(e.spatialReference=t.toJSON());const{features:n}=this;if(n)for(const t of n)if(t&&null!=t.geometry&&t.geometry.spatialReference)return void(e.spatialReference=t.geometry.spatialReference.toJSON())}clone(){return new r(this.cloneProperties())}cloneProperties(){return(0,l.d9)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(t){const e=this.write();if(e.features&&Array.isArray(t)&&t.length>0)for(let n=0;n<e.features.length;n++){const r=e.features[n];if(r.geometry){const e=t?.[n];r.geometry=e?.toJSON()||r.geometry}}return e}quantize(t){const{scale:[e,n],translate:[r,o]}=t,s=this.features,i=this._getQuantizationFunction(this.geometryType,(t=>Math.round((t-r)/e)),(t=>Math.round((o-t)/n)));for(let t=0,e=s.length;t<e;t++)i?.(s[t].geometry)||(s.splice(t,1),t--,e--);return this.transform=t,this}unquantize(){const{geometryType:t,features:e,transform:n}=this;if(!n)return this;const{translate:[r,o],scale:[s,i]}=n;let a=null,l=null;if(this.hasZ&&null!=n?.scale?.[2]){const{translate:[,,t],scale:[,,e]}=n;a=n=>n*e+t}if(this.hasM&&null!=n?.scale?.[3]){const{translate:[,,,t],scale:[,,,e]}=n;l=n=>null==n?n:n*e+t}const u=this._getHydrationFunction(t,(t=>t*s+r),(t=>o-t*i),a,l);for(const{geometry:t}of e)null!=t&&u&&u(t);return this.transform=null,this}readFeaturesWithClass(t,e,n){const r=m.Z.fromJSON(e.spatialReference),o=[];for(let e=0;e<t.length;e++){const s=t[e],i=n.fromJSON(s),a=s.geometry?.spatialReference;null==i.geometry||a||(i.geometry.spatialReference=r);const l=s.aggregateGeometries,u=i.aggregateGeometries;if(l&&null!=u)for(const t in u){const e=u[t],n=l[t]?.spatialReference;null==e||n||(e.spatialReference=r)}o.push(i)}return o}_quantizePoints(t,e,n){let r,o;const s=[];for(let i=0,a=t.length;i<a;i++){const a=t[i];if(i>0){const t=e(a[0]),i=n(a[1]);t===r&&i===o||(s.push([t-r,i-o]),r=t,o=i)}else r=e(a[0]),o=n(a[1]),s.push([r,o])}return s.length>0?s:null}_getQuantizationFunction(t,e,n){return"point"===t?t=>(t.x=e(t.x),t.y=n(t.y),t):"polyline"===t||"polygon"===t?t=>{const r=(0,y.oU)(t)?t.rings:t.paths,o=[];for(let t=0,s=r.length;t<s;t++){const s=r[t],i=this._quantizePoints(s,e,n);i&&o.push(i)}return o.length>0?((0,y.oU)(t)?t.rings=o:t.paths=o,t):null}:"multipoint"===t?t=>{const r=this._quantizePoints(t.points,e,n);return r&&r.length>0?(t.points=r,t):null}:"extent"===t?t=>t:null}_getHydrationFunction(t,e,n,r,o){return"point"===t?t=>{t.x=e(t.x),t.y=n(t.y),r&&(t.z=r(t.z))}:"polyline"===t||"polygon"===t?t=>{const s=(0,y.oU)(t)?t.rings:t.paths;let i,a;for(let t=0,r=s.length;t<r;t++){const r=s[t];for(let t=0,o=r.length;t<o;t++){const o=r[t];t>0?(i+=o[0],a+=o[1]):(i=o[0],a=o[1]),o[0]=e(i),o[1]=n(a)}}if(r&&o)for(let t=0,e=s.length;t<e;t++){const e=s[t];for(let t=0,n=e.length;t<n;t++){const n=e[t];n[2]=r(n[2]),n[3]=o(n[3])}}else if(r)for(let t=0,e=s.length;t<e;t++){const e=s[t];for(let t=0,n=e.length;t<n;t++){const n=e[t];n[2]=r(n[2])}}else if(o)for(let t=0,e=s.length;t<e;t++){const e=s[t];for(let t=0,n=e.length;t<n;t++){const n=e[t];n[2]=o(n[2])}}}:"extent"===t?t=>{t.xmin=e(t.xmin),t.ymin=n(t.ymin),t.xmax=e(t.xmax),t.ymax=n(t.ymax),r&&null!=t.zmax&&null!=t.zmin&&(t.zmax=r(t.zmax),t.zmin=r(t.zmin)),o&&null!=t.mmax&&null!=t.mmin&&(t.mmax=o(t.mmax),t.mmin=o(t.mmin))}:"multipoint"===t?t=>{const s=t.points;let i,a;for(let t=0,r=s.length;t<r;t++){const r=s[t];t>0?(i+=r[0],a+=r[1]):(i=r[0],a=r[1]),r[0]=e(i),r[1]=n(a)}if(r&&o)for(let t=0,e=s.length;t<e;t++){const e=s[t];e[2]=r(e[2]),e[3]=o(e[3])}else if(r)for(let t=0,e=s.length;t<e;t++){const e=s[t];e[2]=r(e[2])}else if(o)for(let t=0,e=s.length;t<e;t++){const e=s[t];e[2]=o(e[2])}}:null}};(0,o._)([(0,u.Cb)({type:String,json:{write:!0}})],x.prototype,"displayFieldName",void 0),(0,o._)([(0,u.Cb)({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],x.prototype,"exceededTransferLimit",void 0),(0,o._)([(0,u.Cb)({type:[s.Z],json:{write:!0}})],x.prototype,"features",void 0),(0,o._)([(0,c.r)("features")],x.prototype,"readFeatures",null),(0,o._)([(0,u.Cb)({type:[d.Z],json:{write:!0}})],x.prototype,"fields",void 0),(0,o._)([(0,u.Cb)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:g.read}}})],x.prototype,"geometryType",void 0),(0,o._)([(0,p.c)("geometryType")],x.prototype,"writeGeometryType",null),(0,o._)([(0,u.Cb)({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],x.prototype,"hasM",void 0),(0,o._)([(0,u.Cb)({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],x.prototype,"hasZ",void 0),(0,o._)([(0,u.Cb)({types:h.qM,json:{write:!0}})],x.prototype,"queryGeometry",void 0),(0,o._)([(0,c.r)("queryGeometry")],x.prototype,"readQueryGeometry",null),(0,o._)([(0,u.Cb)({type:m.Z,json:{write:!0}})],x.prototype,"spatialReference",void 0),(0,o._)([(0,p.c)("spatialReference")],x.prototype,"writeSpatialReference",null),(0,o._)([(0,u.Cb)({json:{write:!0}})],x.prototype,"transform",void 0),x=r=(0,o._)([(0,f.j)("esri.rest.support.FeatureSet")],x),x.prototype.toJSON.isDefaultToJSON=!0},57513:function(t,e,n){n.d(e,{A:function(){return s},E:function(){return i}});var r=n(60508),o=n(54229);function s(t,e,n=a){return new r.Z({x:t[n.originX],y:t[n.originY],z:t[n.originZ],spatialReference:e})}function i(t,e=a){return new o.Z({translation:[t[e.translationX],-t[e.translationZ],t[e.translationY]],rotationAxis:[t[e.rotationX],-t[e.rotationZ],t[e.rotationY]],rotationAngle:t[e.rotationDeg],scale:[t[e.scaleX],t[e.scaleZ],t[e.scaleY]]})}const a={originX:"originX",originY:"originY",originZ:"originZ",translationX:"translationX",translationY:"translationY",translationZ:"translationZ",scaleX:"scaleX",scaleY:"scaleY",scaleZ:"scaleZ",rotationX:"rotationX",rotationY:"rotationY",rotationZ:"rotationZ",rotationDeg:"rotationDeg"}},81638:function(t,e,n){n.r(e),n.d(e,{assetMapFromAssetMapsJSON:function(){return g},extractMesh:function(){return y},meshFeatureSetFromJSON:function(){return m}});var r=n(46451),o=n(96711),s=n(79577),i=n(71354),a=n(29097),l=n(45213),u=n(27299),c=n(60419),f=n(13878),p=n(57513);function m(t,e,n){const o=n.features;n.features=[],delete n.geometryType;const s=f.Z.fromJSON(n);if(s.geometryType="mesh",!n.assetMaps)return s;const i=g(e,n.assetMaps),a=t.sourceSpatialReference??l.Z.WGS84,u=n.globalIdFieldName,{outFields:c}=t,p=null!=c&&c.length>0?(m=c.includes("*")?null:new Set(c),({attributes:t})=>{if(!t)return{};if(!m)return t;for(const e in t)m.has(e)||delete t[e];return t}):()=>({});var m;for(const t of o){const n=y(t,u,a,e,i);s.features.push(new r.Z({geometry:n,attributes:p(t)}))}return s}function y(t,e,n,r,o){const s=t.attributes[e],l=o.get(s);if(null==l||!t.geometry)return null;const c=(0,p.A)(t.attributes,n,r.transformFieldRoles),f=i.Z.fromJSON(t.geometry);f.spatialReference=n;const m=(0,p.E)(t.attributes,r.transformFieldRoles),y=n.isGeographic?"local":"georeferenced",d=function(t){const e=Array.from(t.files.values()),n=new Array;for(const t of e){if(t.status!==h.COMPLETED)return null;const e=new Array;for(const n of t.parts){if(!n)return null;e.push(new u.LL(n.url,n.hash))}n.push(new u.CP(t.name,t.mimeType,e))}return{type:"service",assets:n}}(l);return d?a.default.createWithExternalSource(c,d,{extent:f,transform:m,vertexSpace:y,unitConversionDisabled:!0}):a.default.createIncomplete(c,{extent:f,transform:m,vertexSpace:y})}var h,d;function g(t,e){const n=new Map;for(const r of e){const e=r.parentGlobalId;if(null==e)continue;const i=r.assetName,a=r.assetType,l=r.assetHash,u=r.assetURL,f=r.conversionStatus,p=r.seqNo,m=(0,c.d1)(a,t.supportedFormats);if(!m){o.Z.getLogger("esri.rest.support.meshFeatureSet").error("mesh-feature-set:unknown-format",`Service returned an asset of type ${a}, but it does not list it as a supported type`);continue}const y=(0,s.s1)(n,e,(()=>({files:new Map})));(0,s.s1)(y.files,i,(()=>({name:i,type:a,mimeType:m,status:x(f),parts:[]}))).parts[p]={hash:l,url:u}}return n}function x(t){switch(t){case"COMPLETED":case"SUBMITTED":return h.COMPLETED;case"INPROGRESS":return h.PENDING;default:return h.FAILED}}(d=h||(h={}))[d.FAILED=0]="FAILED",d[d.PENDING=1]="PENDING",d[d.COMPLETED=2]="COMPLETED"}}]);