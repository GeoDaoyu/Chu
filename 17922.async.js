"use strict";(self.webpackChunkscene_pro=self.webpackChunkscene_pro||[]).push([[17922],{46451:function(e,t,n){n.d(t,{Z:function(){return x}});var i,r=n(73440),s=n(997),o=n(89314),a=n(85168),l=n(63255),u=n(96711),c=n(90403),d=n(67908),p=n(17155),f=(n(61432),n(83850),n(48023)),h=n(69306),m=n(90756),g=n(98842),y=n(15083),v=n(68578);function b(e){if(null==e)return null;const t={};for(const n in e){const i=e[n];i&&(t[n]=i.toJSON())}return 0!==Object.keys(t).length?t:null}let x=class extends(o.Z.ClonableMixin(l.Z)){static{i=this}constructor(e){super(e),this.isAggregate=!1,this.layer=null,this.origin=null,this.sourceLayer=null,this._version=0,Object.defineProperty(this,"uid",{value:(0,d.D)(),configurable:!0}),Object.defineProperty(this,"_lastMeshTransform",{value:{},configurable:!0,writable:!0,enumerable:!1}),arguments.length>1&&(0,a.bP)(u.Z.getLogger(this),"Graphic",{version:"4.30"})}initialize(){this._watchMeshGeometryChanges()}set aggregateGeometries(e){const t=this._get("aggregateGeometries");JSON.stringify(t)!==JSON.stringify(e)&&this._set("aggregateGeometries",e)}set attributes(e){const t=this._get("attributes");t!==e&&(this._set("attributes",e),this._notifyLayer("attributes",t,e))}set geometry(e){const t=this._get("geometry");t!==e&&(this._set("geometry",e),"mesh"!==e?.type&&this._notifyLayer("geometry",t,e))}set popupTemplate(e){const t=this._get("popupTemplate");t!==e&&(this._set("popupTemplate",e),this._notifyLayer("popupTemplate",t,e))}set symbol(e){const t=this._get("symbol");t!==e&&(this._set("symbol",e),this._notifyLayer("symbol",t,e))}get version(){return this._version}set visible(e){const t=this._get("visible");t!==e&&(this._set("visible",e),this._notifyLayer("visible",t,e))}cloneShallow(){return new i({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible,origin:this.origin})}getEffectivePopupTemplate(e=!1){if(this.popupTemplate)return this.popupTemplate;const t=this.origin&&"layer"in this.origin?this.origin.layer:null;for(const n of[t,this.sourceLayer,this.layer])if(n){if("popupTemplate"in n&&n.popupTemplate)return n.popupTemplate;if(e&&"defaultPopupTemplate"in n&&null!=n.defaultPopupTemplate)return n.defaultPopupTemplate}return null}getAttribute(e){return this.attributes?.[e]}setAttribute(e,t){if(this.attributes){const n=this.getAttribute(e);this.attributes[e]=t,this._notifyLayer("attributes",n,t,e)}else this.attributes={[e]:t}}getObjectId(){const e=this.sourceLayer??this.layer;return e?(0,y.v)(this,e):null}getGlobalId(){const e=this.sourceLayer??this.layer;return e&&"globalIdField"in e&&e.globalIdField?this.getAttribute(e.globalIdField):null}toJSON(){return{aggregateGeometries:b(this.aggregateGeometries),geometry:null!=this.geometry?this.geometry.toJSON():null,symbol:null!=this.symbol?this.symbol.toJSON():null,attributes:(0,h.A)(this.attributes)?this.attributes.toJSON():{...this.attributes},popupTemplate:this.popupTemplate?.toJSON()??null}}notifyMeshTransformChanged(e={}){const{geometry:t}=this;if("mesh"===t?.type){const n={origin:t.origin,transform:t.transform};this._notifyLayer("origin-transform",n,n,e.action)}}_notifyLayer(e,t,n,i){if(this._version++,!this.layer||!("graphicChanged"in this.layer))return;const r={graphic:this,property:e,oldValue:t,newValue:n};"origin-transform"===e&&(r.action=i),"attributes"===e&&(r.attributeName=i),this.layer.graphicChanged(r)}_watchMeshGeometryChanges(){this.addHandles([(0,c.gx)((()=>"mesh"===this.geometry?.type&&this.geometry.vertexSpace.origin?{localMatrix:this.geometry.transform?.localMatrix,origin:this.geometry.vertexSpace.origin}:void 0),(({localMatrix:e,origin:t})=>{this._lastMeshTransform.localMatrix===e&&this._lastMeshTransform.origin===t||(this._lastMeshTransform.localMatrix=e,this._lastMeshTransform.origin=t,this.notifyMeshTransformChanged())})),(0,c.gx)((()=>"mesh"===this.geometry?.type?{vertexAttributes:this.geometry.vertexAttributes}:void 0),(()=>{const e=this.geometry;"mesh"===e?.type&&e.vertexSpace.origin?(this._lastMeshTransform.localMatrix=e.transform?.localMatrix,this._lastMeshTransform.origin=e.vertexSpace.origin):(this._lastMeshTransform.localMatrix=void 0,this._lastMeshTransform.origin=void 0),this._notifyLayer("geometry",this.geometry,this.geometry)}),{equals:(e,t)=>e===t,sync:!0})])}};(0,r._)([(0,p.Cb)({value:null,json:{read:function(e){if(!e)return null;const t={};for(const n in e){const i=(0,m.im)(e[n]);i&&(t[n]=i)}return 0!==Object.keys(t).length?t:null}}})],x.prototype,"aggregateGeometries",null),(0,r._)([(0,p.Cb)({value:null})],x.prototype,"attributes",null),(0,r._)([(0,p.Cb)({value:null,types:g.qM,json:{read:m.im}})],x.prototype,"geometry",null),(0,r._)([(0,p.Cb)({type:Boolean})],x.prototype,"isAggregate",void 0),(0,r._)([(0,p.Cb)({clonable:!1})],x.prototype,"layer",void 0),(0,r._)([(0,p.Cb)({clonable:"reference"})],x.prototype,"origin",void 0),(0,r._)([(0,p.Cb)({type:s.Z,value:null})],x.prototype,"popupTemplate",null),(0,r._)([(0,p.Cb)({clonable:"reference"})],x.prototype,"sourceLayer",void 0),(0,r._)([(0,p.Cb)({value:null,types:v.LB})],x.prototype,"symbol",null),(0,r._)([(0,p.Cb)({clonable:!1,json:{read:!1,write:!1}})],x.prototype,"_version",void 0),(0,r._)([(0,p.Cb)({type:Boolean,value:!0})],x.prototype,"visible",null),x=i=(0,r._)([(0,f.j)("esri.Graphic")],x)},62920:function(e,t,n){n.d(t,{T:function(){return d}});var i=n(73440),r=n(89314),s=n(63255),o=n(92161),a=n(17155),l=(n(61432),n(96711),n(83850),n(79775)),u=n(48023),c=n(24009);let d=class extends(r.Z.ClonableMixin(s.Z)){constructor(e){super(e),this.unit="milliseconds",this.value=0}toMilliseconds(){return(0,o.rJ)(this.value,this.unit,"milliseconds")}};(0,i._)([(0,l.J)(c.v,{nonNullable:!0})],d.prototype,"unit",void 0),(0,i._)([(0,a.Cb)({type:Number,json:{write:!0},nonNullable:!0})],d.prototype,"value",void 0),d=(0,i._)([(0,u.j)("esri.time.TimeInterval")],d)},73749:function(e,t,n){n.d(t,{a:function(){return x},b:function(){return m},c:function(){return r},d:function(){return d},e:function(){return w},f:function(){return f},g:function(){return a},h:function(){return y},i:function(){return s},j:function(){return h},l:function(){return v},n:function(){return g},s:function(){return o},t:function(){return b},v:function(){return A}});var i=n(66130);function r(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function s(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function o(e,t,n,i,r){return e[0]=t,e[1]=n,e[2]=i,e[3]=r,e}function a(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}function l(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function u(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}function c(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e}function d(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function p(e,t){const n=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2],s=t[3]-e[3];return Math.sqrt(n*n+i*i+r*r+s*s)}function f(e,t){const n=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2],s=t[3]-e[3];return n*n+i*i+r*r+s*s}function h(e){const t=e[0],n=e[1],i=e[2],r=e[3];return Math.sqrt(t*t+n*n+i*i+r*r)}function m(e){const t=e[0],n=e[1],i=e[2],r=e[3];return t*t+n*n+i*i+r*r}function g(e,t){const n=t[0],i=t[1],r=t[2],s=t[3];let o=n*n+i*i+r*r+s*s;return o>0&&(o=1/Math.sqrt(o),e[0]=n*o,e[1]=i*o,e[2]=r*o,e[3]=s*o),e}function y(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function v(e,t,n,i){const r=t[0],s=t[1],o=t[2],a=t[3];return e[0]=r+i*(n[0]-r),e[1]=s+i*(n[1]-s),e[2]=o+i*(n[2]-o),e[3]=a+i*(n[3]-a),e}function b(e,t,n){const i=t[0],r=t[1],s=t[2],o=t[3];return e[0]=n[0]*i+n[4]*r+n[8]*s+n[12]*o,e[1]=n[1]*i+n[5]*r+n[9]*s+n[13]*o,e[2]=n[2]*i+n[6]*r+n[10]*s+n[14]*o,e[3]=n[3]*i+n[7]*r+n[11]*s+n[15]*o,e}function x(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function w(e,t){const n=e[0],r=e[1],s=e[2],o=e[3],a=t[0],l=t[1],u=t[2],c=t[3],d=(0,i.bn)();return Math.abs(n-a)<=d*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-l)<=d*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(s-u)<=d*Math.max(1,Math.abs(s),Math.abs(u))&&Math.abs(o-c)<=d*Math.max(1,Math.abs(o),Math.abs(c))}const C=l,S=u,_=c,I=p,T=f,M=h,E=m,A=Object.freeze(Object.defineProperty({__proto__:null,add:a,ceil:function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},copy:r,copyVec3:s,dist:I,distance:p,div:_,divide:c,dot:y,equals:w,exactEquals:x,floor:function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},len:M,length:h,lerp:v,max:function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e},min:function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e},mul:S,multiply:u,negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},normalize:g,random:function(e,t=1){const n=i.FD;let r,s,o,a,l,u;do{r=2*n()-1,s=2*n()-1,l=r*r+s*s}while(l>=1);do{o=2*n()-1,a=2*n()-1,u=o*o+a*a}while(u>=1);const c=Math.sqrt((1-l)/u);return e[0]=t*r,e[1]=t*s,e[2]=t*o*c,e[3]=t*a*c,e},round:function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},scale:d,scaleAndAdd:function(e,t,n,i){return e[0]=t[0]+n[0]*i,e[1]=t[1]+n[1]*i,e[2]=t[2]+n[2]*i,e[3]=t[3]+n[3]*i,e},set:o,sqrDist:T,sqrLen:E,squaredDistance:f,squaredLength:m,str:function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},sub:C,subtract:l,transformMat4:b,transformQuat:function(e,t,n){const i=t[0],r=t[1],s=t[2],o=n[0],a=n[1],l=n[2],u=n[3],c=u*i+a*s-l*r,d=u*r+l*i-o*s,p=u*s+o*r-a*i,f=-o*i-a*r-l*s;return e[0]=c*u+f*-o+d*-l-p*-a,e[1]=d*u+f*-a+p*-o-c*-l,e[2]=p*u+f*-l+c*-a-d*-o,e[3]=t[3],e}},Symbol.toStringTag,{value:"Module"}))},69071:function(e,t,n){n.d(t,{Jv:function(){return r},M4:function(){return i},WJ:function(){return a},Xq:function(){return o},lN:function(){return s}});const i=-3,r=i-1;var s;!function(e){e[e.ALL=0]="ALL",e[e.SOME=1]="SOME"}(s||(s={}));class o{constructor(e,t,n,i=0){this.name=e,this._storage=t,this.removeFunc=n,this._defaultPriority=i,this.id=`${l++}${c}`,this.size=0,this._hit=0,this._miss=0,this._storage.register(this)}destroy(){this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(e){return this._storage.getSize(this,e)}set maxSize(e){this._storage.setMaxSize(this,e)}resetHitRate(){this._hit=this._miss=0}put(e,t,n=this._defaultPriority){this._storage.put(this,e,t,t.cachedMemory,n)}pop(e){const t=this._storage.pop(this,e);return void 0===t?++this._miss:++this._hit,t}get(e){const t=this._storage.get(this,e);return void 0===t?++this._miss:++this._hit,t}peek(e){return this._storage.peek(this,e)}updateSize(e,t){this._storage.updateSize(this,e,t,t.cachedMemory)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}*[Symbol.iterator](){yield*this._storage.values(this)}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class a{get size(){return this._size}constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._users=new Map,this._sizeLimits=new Map}destroy(){this.clearAll(),this._sizeLimits.clear(),this._users.clear()}register(e){this._users.set(e.id.slice(0,-1),e)}deregister(e){this.clear(e),this._sizeLimits.delete(e),this._users.delete(e.id.slice(0,-1))}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,-1),this._checkSize()}getSize(e,t){return this._db.get(e.id+t)?.size??0}put(e,t,n,o,a){t=e.id+t;const l=this._db.get(t);if(l&&(this._size-=l.size,e.size-=l.size,this._db.delete(t),l.entry!==n&&this._notifyRemove(t,l.entry,l.size,s.ALL)),o>this._maxSize)return void this._notifyRemove(t,n,o,s.ALL);if(void 0===n)return void console.warn("Refusing to cache undefined entry ");if(!o||o<0)return console.warn(`Refusing to cache entry with size ${o} for key ${t}`),void this._notifyRemove(t,n,0,s.ALL);const c=1+Math.max(a,r)-i;this._db.set(t,new u(n,o,c)),this._size+=o,e.size+=o,this._checkSize()}updateSize(e,t,n,i){t=e.id+t;const r=this._db.get(t);if(r&&r.entry===n){for(this._size-=r.size,e.size-=r.size;i>this._maxSize;){const e=this._notifyRemove(t,n,i,s.SOME);if(!(null!=e&&e>0))return void this._db.delete(t);i=e}r.size=i,this._size+=i,e.size+=i,this._checkSize()}}pop(e,t){t=e.id+t;const n=this._db.get(t);if(n)return this._size-=n.size,e.size-=n.size,this._db.delete(t),++this._hit,n.entry;++this._miss}get(e,t){t=e.id+t;const n=this._db.get(t);if(void 0!==n)return this._db.delete(t),n.lives=n.lifetime,this._db.set(t,n),++this._hit,n.entry;++this._miss}peek(e,t){const n=this._db.get(e.id+t);return n?++this._hit:++this._miss,n?.entry}get performanceInfo(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},t={},n=new Array;this._db.forEach(((e,i)=>{const r=e.lifetime;n[r]=(n[r]||0)+e.size,this._users.forEach((n=>{const{id:r,name:s}=n;if(i.startsWith(r)){const n=t[s]||0;t[s]=n+e.size}}))}));const r={};this._users.forEach((e=>{const n=e.name;if("hitRate"in e&&"number"==typeof e.hitRate&&!isNaN(e.hitRate)&&e.hitRate>0){const i=t[n]||0;t[n]=i,r[n]=Math.round(100*e.hitRate)+"%"}else r[n]="0%"}));const s=Object.keys(t);s.sort(((e,n)=>t[n]-t[e])),s.forEach((n=>e[n]=Math.round(t[n]/2**20)+"MB / "+r[n]));for(let t=n.length-1;t>=0;--t){const r=n[t];r&&(e["Priority "+(t+i-1)]=Math.round(r/this._size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forEach((e=>e.resetHitRate()))}clear(e){const t=e.id;this._db.forEach(((e,n)=>{n.startsWith(t)&&(this._size-=e.size,this._db.delete(n),this._notifyRemove(n,e.entry,e.size,s.ALL))})),e.size=0}clearAll(){this._db.forEach(((e,t)=>this._notifyRemove(t,e.entry,e.size,s.ALL))),this._users.forEach((e=>e.size=0)),this._size=0,this._db.clear()}*values(e){for(const[t,n]of this._db)t.startsWith(e.id)&&(yield n.entry)}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(e,t,n,i){const r=this._users.get(e.split(c)[0])?.removeFunc,s=r?.(t,i,n);return"number"==typeof s?s:null}_checkSize(){this._sizeLimits.forEach(((e,t)=>this._checkSizeLimits(e,t))),this._checkSizeLimits(this.maxSize)}setMaxSize(e,t){null==t||t<=0?this._sizeLimits.delete(e):this._sizeLimits.set(e,t)}_checkSizeLimits(e,t){const n=t??this;if(n.size<=e)return;const i=t?.id;let r=!0;for(;r;){r=!1;for(const[s,o]of this._db)if(0===o.lifetime&&(!i||s.startsWith(i))){const i=t??this._users.get(s.split(c)[0]);if(this._purgeItem(s,o,i),n.size<=.9*e)return;r||=this._db.has(s)}}for(const[r,s]of this._db)if(!i||r.startsWith(i)){const i=t??this._users.get(r.split(c)[0]);if(this._purgeItem(r,s,i),n.size<=.9*e)return}}_purgeItem(e,t,n){if(this._db.delete(e),t.lives<=1){this._size-=t.size,n&&(n.size-=t.size);const i=this._notifyRemove(e,t.entry,t.size,s.SOME);null!=i&&i>0&&(this._size+=i,n&&(n.size+=i),t.lives=t.lifetime,t.size=i,this._db.set(e,t))}else--t.lives,this._db.set(e,t)}}let l=0;class u{constructor(e,t,n){this.entry=e,this.size=t,this.lifetime=n,this.lives=n}}const c=":"},27583:function(e,t,n){function i(){return[0,0,0,0]}function r(e){return[e[0],e[1],e[2],e[3]]}function s(e,t,n,i){return[e,t,n,i]}function o(e,t,n,i){return[e,t,n,i]}function a(e,t=[0,0,0,0]){const n=Math.min(4,e.length);for(let i=0;i<n;++i)t[i]=e[i];return t}function l(){return[0,0,0,0]}function u(){return s(1,1,1,1)}function c(){return s(1,0,0,0)}function d(){return s(0,1,0,0)}function p(){return s(0,0,1,0)}function f(){return s(0,0,0,1)}n.d(t,{AG:function(){return h},Ue:function(){return i},al:function(){return s},d9:function(){return r},hq:function(){return m},iU:function(){return u},nI:function(){return a},vV:function(){return o}});const h=[0,0,0,0],m=u(),g=c(),y=d(),v=p(),b=f();Object.freeze(Object.defineProperty({__proto__:null,ONES:m,UNIT_W:b,UNIT_X:g,UNIT_Y:y,UNIT_Z:v,ZEROS:h,clone:r,create:i,freeze:o,fromArray:a,fromValues:s,ones:u,unitW:f,unitX:c,unitY:d,unitZ:p,zeros:l},Symbol.toStringTag,{value:"Module"}))},60199:function(e,t,n){n.d(t,{QZ:function(){return s},Rq:function(){return o},bg:function(){return r}});var i=n(59384);function r(e,t=!1){return e<=i.c8?t?new Array(e).fill(0):new Array(e):new Float64Array(e)}function s(e){return((0,i.fU)(e)?e.byteLength/8:e.length)<=i.c8?Array.from(e):new Float64Array(e)}function o(e,t,n){return Array.isArray(e)?e.slice(t,t+n):e.subarray(t,t+n)}},16447:function(e,t,n){n.d(t,{BD:function(){return I},Cb:function(){return w},FY:function(){return l},G1:function(){return g},G_:function(){return G},HH:function(){return d},I7:function(){return A},JR:function(){return B},KE:function(){return F},TC:function(){return f},Tn:function(){return O},Ue:function(){return o},VK:function(){return h},Wi:function(){return y},Ye:function(){return x},Zp:function(){return E},al:function(){return a},bA:function(){return R},bM:function(){return W},bZ:function(){return z},be:function(){return S},bf:function(){return b},cS:function(){return k},cv:function(){return L},dp:function(){return _},eZ:function(){return c},fS:function(){return $},gy:function(){return U},is:function(){return V},kK:function(){return M},nX:function(){return p},op:function(){return P},pp:function(){return m},r3:function(){return T},re:function(){return j},sU:function(){return v},t8:function(){return N},wp:function(){return Z},wq:function(){return u},wz:function(){return C},y8:function(){return D}});var i=n(71354),r=n(47566),s=n(60199);function o(e=W){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function a(e,t,n,i,r,s,a=o()){return a[0]=e,a[1]=t,a[2]=n,a[3]=i,a[4]=r,a[5]=s,a}function l(e,t=o()){return u(e,0,e.length/3,t)}function u(e,t,n,i=o()){return N(i,G),g(i,e,t,n),i}function c(e,t=(0,s.bg)(24)){const[n,i,r,o,a,l]=e;return t[0]=n,t[1]=i,t[2]=r,t[3]=n,t[4]=i,t[5]=l,t[6]=n,t[7]=a,t[8]=r,t[9]=n,t[10]=a,t[11]=l,t[12]=o,t[13]=i,t[14]=r,t[15]=o,t[16]=i,t[17]=l,t[18]=o,t[19]=a,t[20]=r,t[21]=o,t[22]=a,t[23]=l,t}function d(e,t){const n=isFinite(e[2])||isFinite(e[5]);return new i.Z(n?{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],zmin:e[2],zmax:e[5],spatialReference:t}:{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],spatialReference:t})}function p(e,t,n=o()){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=t[0],n[4]=t[1],n[5]=t[2],n}function f(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])}function h(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[3]=Math.max(e[3],t[2]),e[4]=Math.max(e[4],t[3])}function m(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[0]),e[4]=Math.max(e[4],t[1]),e[5]=Math.max(e[5],t[2])}function g(e,t,n=0,i=t.length/3){let r=e[0],s=e[1],o=e[2],a=e[3],l=e[4],u=e[5];for(let e=0;e<i;e++)r=Math.min(r,t[n+3*e]),s=Math.min(s,t[n+3*e+1]),o=Math.min(o,t[n+3*e+2]),a=Math.max(a,t[n+3*e]),l=Math.max(l,t[n+3*e+1]),u=Math.max(u,t[n+3*e+2]);e[0]=r,e[1]=s,e[2]=o,e[3]=a,e[4]=l,e[5]=u}function y(e,t,n){const i=t.length;let r=e[0],s=e[1],o=e[2],a=e[3],l=e[4],u=e[5];if(n)for(let e=0;e<i;e++){const n=t[e];r=Math.min(r,n[0]),s=Math.min(s,n[1]),o=Math.min(o,n[2]),a=Math.max(a,n[0]),l=Math.max(l,n[1]),u=Math.max(u,n[2])}else for(let e=0;e<i;e++){const n=t[e];r=Math.min(r,n[0]),s=Math.min(s,n[1]),a=Math.max(a,n[0]),l=Math.max(l,n[1])}e[0]=r,e[1]=s,e[2]=o,e[3]=a,e[4]=l,e[5]=u}function v(e){for(let t=0;t<6;t++)if(!isFinite(e[t]))return!1;return!0}function b(e){return e[0]>=e[3]?0:e[3]-e[0]}function x(e){return e[1]>=e[4]?0:e[4]-e[1]}function w(e){return e[2]>=e[5]?0:e[5]-e[2]}function C(e){const t=b(e),n=w(e),i=x(e);return Math.sqrt(t*t+n*n+i*i)}function S(e,t=[0,0,0]){return t[0]=e[0]+b(e)/2,t[1]=e[1]+x(e)/2,t[2]=e[2]+w(e)/2,t}function _(e,t=[0,0,0]){return t[0]=b(e),t[1]=x(e),t[2]=w(e),t}function I(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[0]<=e[3]&&t[1]<=e[4]&&t[2]<=e[5]}function T(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[3]<=e[3]&&t[4]<=e[4]&&t[5]<=e[5]}function M(e,t){return Math.max(t[0],e[0])<=Math.min(t[3],e[3])&&Math.max(t[1],e[1])<=Math.min(t[4],e[4])&&Math.max(t[2],e[2])<=Math.min(t[5],e[5])}function E(e,t){return null==t||M(e,t)}function A(e,t,n){let i=0,r=1;for(let s=0;s<3;++s){const o=e[s],a=e[s+3],l=t[s],u=n[s],c=u<l,d=c?u:l,p=c?l:u,f=Math.max(o,d),h=Math.min(a,p);if(f>h)return!1;if(p===d)break;const m=p-d,g=(f-d)/m,y=(h-d)/m;if(i=Math.max(i,c?1-y:g),r=Math.min(r,c?1-g:y),i>r)return!1}return!0}function L(e,t,n,i,r=e){return r[0]=e[0]+t,r[1]=e[1]+n,r[2]=e[2]+i,r[3]=e[3]+t,r[4]=e[4]+n,r[5]=e[5]+i,r}function R(e,t,n=e){const i=e[0]+b(e)/2,r=e[1]+x(e)/2,s=e[2]+w(e)/2;return n[0]=i+(e[0]-i)*t,n[1]=r+(e[1]-r)*t,n[2]=s+(e[2]-s)*t,n[3]=i+(e[3]-i)*t,n[4]=r+(e[4]-r)*t,n[5]=s+(e[5]-s)*t,n}function F(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function P(e,t,n=e){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n!==e&&(n[3]=e[3],n[4]=e[4],n[5]=e[5]),n}function O(e,t,n=e){return n[3]=t[0],n[4]=t[1],n[5]=t[2],n!==e&&(n[0]=e[0],n[1]=e[1],n[2]=e[2]),e}function N(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function k(e){return e?N(e,G):o(G)}function D(e,t){return t||(t=(0,r.Ue)()),t[0]=e[0],t[1]=e[1],t[2]=e[3],t[3]=e[4],t}function B(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e}function z(e,t,n,i,r){return e[0]=t,e[1]=n,e[2]=Number.NEGATIVE_INFINITY,e[3]=i,e[4]=r,e[5]=Number.POSITIVE_INFINITY,e}function V(e){return 6===e.length}function Z(e){return 0===b(e)&&0===x(e)&&0===w(e)}function $(e,t,n){if(null==e||null==t)return e===t;if(!V(e)||!V(t))return!1;if(n){for(let i=0;i<e.length;i++)if(!n(e[i],t[i]))return!1}else for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function j(e,t,n,i,r,s){return a(e,t,n,i,r,s,H)}const U=[-1/0,-1/0,-1/0,1/0,1/0,1/0],G=[1/0,1/0,1/0,-1/0,-1/0,-1/0],W=[0,0,0,0,0,0],H=o()},98842:function(e,t,n){n.d(t,{Mk:function(){return c},P$:function(){return d},qM:function(){return p}});var i=n(41773),r=n(71354),s=n(82890),o=n(82868),a=n(60508),l=n(67764),u=n(62197);const c=(0,i.w)()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),d=(0,i.w)()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"}),p={base:s.Z,key:"type",typeMap:{extent:r.Z,multipoint:o.Z,point:a.Z,polyline:u.Z,polygon:l.Z}}},65838:function(e,t,n){n.r(t),n.d(t,{default:function(){return Te}});var i=n(73440),r=n(997),s=n(89314),o=n(88194),a=n(84060),l=n(93568),u=n(90403),c=n(17155),d=(n(61432),n(96711)),p=(n(83850),n(48023)),f=n(38209),h=n(83263),m=n(55591),g=n(9642),y=n(85330),v=n(27202),b=n(57554),x=n(19306),w=n(3752),C=n(99671),S=n(93295),_=n(49651),I=n(72327),T=n(71354),M=n(62065),E=n(78619),A=n(8761);function L(e){return e.endsWith("?")?e.slice(0,-1):e}function R(e){return e.filter((({coverageSubType:e})=>null==e||""===e||/^rectified(grid|dataset)/i.test(e)))}function F(e){const t={};for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];if(1!==i.nodeType)continue;const r=(0,A.ZB)(i).toLowerCase();switch(r){case"title":case"abstract":t[r]=(0,A.Y)(i);break;case"identifier":t.id=(0,A.Y)(i);break;case"wgs84boundingbox":{const e=(0,A.kH)(i,"LowerCorner"),n=(0,A.kH)(i,"UpperCorner");t.lonLatEnvelope=new T.Z({xmin:e[0],ymin:e[1],xmax:n[0],ymax:n[1],spatialReference:{wkid:4326}})}break;case"coveragesummary":t.coverageSummaries=t.coverageSummaries||[],t.coverageSummaries.push(F(i))}}return t}function P(e,t){if(e.coverageSummaries)for(let n=0;n<e.coverageSummaries.length;n++)e.coverageSummaries[n].abstract=e.coverageSummaries[n].abstract||e.abstract,e.coverageSummaries[n].lonLatEnvelope=e.coverageSummaries[n].lonLatEnvelope||e.lonLatEnvelope,e.coverageSummaries[n].title=e.coverageSummaries[n].title||e.title,P(e.coverageSummaries[n],t);null!=e.id&&t.push(e)}function O(e){const t=(0,A.sb)(e.querySelector("Operation[name=GetCapabilities]"),"Get")?.getAttribute("xlink:href")||"",n=(0,A.sb)(e.querySelector("Operation[name=DescribeCoverage]"),"Get")?.getAttribute("xlink:href")||"",i=(0,A.sb)(e.querySelector("Operation[name=GetCoverage]"),"Get")?.getAttribute("xlink:href")||"";return{getCapabilities:L(t),describeCoverage:L(n),getCoverage:L(i)}}function N(e,t=null){let n=null;n="string"==typeof e?(new DOMParser).parseFromString(e,"text/xml"):e;let i=n.documentElement.getAttribute("version");"1.0"===i?i="1.0.0":"1.1"===i&&(i="1.1.0");const r=i||t||"1.0.0",s=r.slice(0,3);let a;if("2.0"===s)a=function(e){const t=(0,A.sb)(e,"ServiceIdentification"),n=(0,A.Y)(t,"Title"),i=(0,A.tz)(t,"ServiceTypeVersion"),r=(0,A.tz)(t,"Profile"),s=O((0,A.sb)(e,"OperationsMetadata")),o=(0,A.$3)(e,"Contents/CoverageSummary"),a=[];for(let e=0;e<o.length;e++){const t=o[e],n=(0,A.Y)(t,"CoverageId"),i=(0,A.sb)(t,"WGS84BoundingBox");let r;if(i){const e=(0,A.kH)(i,"LowerCorner"),t=(0,A.kH)(i,"UpperCorner");r=new T.Z({xmin:e[0],ymin:e[1],xmax:t[0],ymax:t[1],spatialReference:{wkid:4326}})}const s=(0,A.Y)(t,"CoverageSubtype")||"RectifiedGridCoverage";a.push({id:n,lonLatEnvelope:r,coverageSubType:s})}const l=(0,A.sb)(e,"ServiceMetadata");return{name:n,supportedVersions:i,supportedFormats:(0,A.tz)(l,"formatSupported"),supportedInterpolations:(0,A.tz)(l,"interpolationSupported").concat((0,A.tz)(l,"InterpolationSupported")),onlineResources:s,profiles:r,coverages:a,gridCoverages:R(a),version:"2.0.1"}}(n);else if("1.1"===s)a=function(e){const t=(0,A.Y)(e,"ServiceIdentification/Title"),n=(0,A.tz)(e,"ServiceIdentification/ServiceTypeVersion"),i=O((0,A.sb)(e,"OperationsMetadata")),r=[],s=(0,A.sb)(e,"Contents");for(let e=0;e<s.childNodes.length;e++){const t=s.childNodes[e];1===t.nodeType&&(0,A.W9)(t,"CoverageSummary")&&P(F(t),r)}const o=(0,A.tz)(s,"SupportedFormat");return{name:t,onlineResources:i,coverages:r,gridCoverages:R(r),supportedVersions:n,supportedFormats:o,version:"1.1.0"}}(n);else{if("1.0"!==s)throw new o.Z("wcsraster:parsecapabilities","the capabilities version is not supported");a=function(e){const t=(0,A.Y)(e,"Service/name"),n=(0,A.sb)(e,"Capability"),i=(0,A.sb)(n,"GetCapabilities/Get/OnlineResource")?.getAttribute("xlink:href")??"",r=(0,A.sb)(n,"DescribeCoverage/Get/OnlineResource")?.getAttribute("xlink:href")??"",s=(0,A.sb)(n,"GetCoverage/Get/OnlineResource")?.getAttribute("xlink:href")??"",o={getCapabilities:L(i),describeCoverage:L(r),getCoverage:L(s)},a=(0,A.$3)(e,"CoverageOfferingBrief"),l=[];for(let e=0;e<a.length;e++){const t=a[e],n=(0,A.Y)(t,"name"),i=(0,A.$3)(t,"pos"),r=(0,A.kH)(i[0]),s=(0,A.kH)(i[1]),o=new T.Z({xmin:r[0],ymin:r[1],xmax:s[0],ymax:s[1],spatialReference:{wkid:4326}});l.push({id:n,lonLatEnvelope:o})}return{name:t,onlineResources:o,coverages:l,gridCoverages:R(l),supportedVersions:["1.0.0"],version:"1.0.0"}}(n)}return a.version=r,a}var k=n(67764),D=n(11472),B=n(57528);function z(e){e.variables.forEach((e=>e.dimensions.forEach((e=>e.values??=(0,B.Rw)(e)))))}function V(e){return{requestResponseCRSs:(0,A.tz)(e,"requestResponseCRSs").map((e=>e.split(":")[1])),nativeCRSs:(0,A.tz)(e,"nativeCRSs").map((e=>e.split(":")[1]))}}function Z(e,t){const n=(0,A.tz)(e,"1.0.0"===t?"interpolationMethod":"InterpolationMethod"),i="1.0.0"===t?e.getAttribute("default"):(0,A.Y)(e,"InterpolationMethods/Default");return null!=i?[i].concat(n.filter((e=>e.toLowerCase()!==i.toLowerCase()))):n}function $(e){return null==e?["nearest"]:e.map((e=>{const t=e.toLowerCase();return t.includes("nearest")?"nearest":t.includes("linear")?"bilinear":t.includes("cubic")?"cubic":null})).filter((e=>!!e))}function j(e){const t=(0,A.$3)(e,"pos"),n=(0,A.kH)(t[0]),i=(0,A.kH)(t[1]);return new T.Z({xmin:n[0],ymin:n[1],xmax:i[0],ymax:i[1],spatialReference:{wkid:4326}})}function U(e,t){const n=(0,A.tz)(e,t);return n?.length&&""!==n[0]&&!isNaN(Number(n[0]))?n.map((e=>Number(e))):null}function G(e){const t=(0,A.kH)(e,"MinimumValue"),n=(0,A.kH)(e,"MaximumValue");return t.length&&n.length?t.map(((e,t)=>({min:e,max:n[t],avg:-1,stddev:-1}))):null}function W(e){return null==e?null:e.every((t=>t===e[0]))?e[0]:e}function H(e){const t=[],n=(0,A.$3)(e,"RangeSet");let i=[];for(let e=0;e<n.length;e++){const r=(0,A.Y)(n[e],"name"),s=(0,A.Y)(n[e],"label"),o=[],a=U(n[e],"nullValues/singleValue"),l=(0,A.$3)(n[e],"AxisDescription");for(let e=0;e<l.length;e++){const t=(0,A.Y)(l[e],"name"),n=(0,A.Y)(l[e],"label"),r=(0,A.tz)(l[e],"singleValue");if(0===r.length){const t=(0,A.Y)(l[e],"min"),n=(0,A.Y)(l[e],"max"),i=Number((0,A.Y)(l[e],"res"))||1;if(null!==t&&null!==n)for(let e=parseInt(t,10);e<=parseInt(n,10);e+=i)r.push(e.toString())}"band"===t.toLowerCase()&&(i=r),o.push({name:t,label:n,values:r})}t.push({name:r,label:s,nullValues:a,axis:o})}return{rangeSet:t,bandNames:i}}function Y(e=null){if(!e)return{resolution:null,units:null};let t=e.toUpperCase();const n=["Years","Months","Days","Hours","Minutes","Seconds"];let i,r,s;return t.includes("PT")?(t=t.slice(2),s=["H","M","S"].findIndex((e=>t.includes(e))),i=n[3+s],r=parseFloat(t.slice(0,-1))):(t=t.slice(1),s=["Y","M","D"].findIndex((e=>t.includes(e))),s>-1&&(i=n[s]),r=parseFloat(t.slice(0,-1))),{resolution:r,units:i}}function q(e){const t=(0,A.$3)(e,"timeposition");if(t.length>0){const e=[];for(let n=0;n<t.length;n++)e.push(new Date((0,A.Y)(t[n])));return{begin:e[0],end:e[e.length-1],values:e}}const n=(0,A.sb)(e,"timePeriod")||(0,A.sb)(e,"TimePeriod");return n?{begin:new Date((0,A.Y)(n,"beginPosition")||(0,A.Y)(n,"BeginPosition")),end:new Date((0,A.Y)(n,"endPosition")||(0,A.Y)(n,"EndPosition")),...Y((0,A.Y)(n,"timeResolution")||(0,A.Y)(n,"TimeResolution"))}:null}function J(e){const t=(0,A.sb)(e,"spatialDomain"),n=(0,A.sb)(t,"Envelope")||(0,A.sb)(t,"EnvelopeWithTimePeriod"),i=n.getAttribute("srsName").split(":"),r=i[i.length-1],s=(0,A.$3)(n,"pos"),o=(0,A.kH)(s[0]),a=(0,A.kH)(s[1]),l=parseInt(r,10),u=isNaN(l)?null:{wkid:l},c=new T.Z({xmin:o[0],ymin:o[1],xmax:a[0],ymax:a[1],spatialReference:u}),d=(0,A.sb)(t,"RectifiedGrid"),p=(0,A.Y)(d,"low").split(" "),f=(0,A.Y)(d,"high").split(" "),h=parseInt(f[0],10)-parseInt(p[0],10)+1,m=parseInt(f[1],10)-parseInt(p[1],10)+1,g=(0,A.kH)(t,"origin/pos"),y=(0,A.$3)(t,"offsetVector"),v={envelope:c,columns:h,rows:m,offset:{x:parseFloat((0,A.Y)(y[0]).split(" ")[0]),y:parseFloat((0,A.Y)(y[1]).split(" ")[1])},origin:{x:g[0],y:g[1]}},b=(0,A.sb)(e,"temporalDomain")||(0,A.sb)(e,"TemporalDomain");return{spatialDomain:v,temporalDomain:b?q(b):null}}function X(e){const t={version:"1.0"};let n,i=[];for(let r=0;r<e.childNodes.length;r++){const s=e.childNodes[r];if(1===s.nodeType)if((0,A.W9)(s,"description"))t.description=(0,A.Y)(s);else if((0,A.W9)(s,"name"))t.name=(0,A.Y)(s);else if((0,A.W9)(s,"label"))t.label=(0,A.Y)(s);else if((0,A.W9)(s,"supportedFormats"))t.supportedFormats=(0,A.tz)(s,"formats");else if((0,A.W9)(s,"supportedCRSs"))t.supportedCRSs=V(s);else if((0,A.W9)(s,"supportedInterpolations"))t.supportedInterpolations=Z(s,"1.0.0");else if((0,A.W9)(s,"lonLatEnvelope"))t.lonLatEnvelope=j(s);else if((0,A.W9)(s,"rangeSet")){const e=H(s);t.rangeSet=e.rangeSet,i=e.bandNames;const r=e.rangeSet[0].nullValues;r?.length&&(n=W(r))}else(0,A.W9)(s,"domainSet")&&(t.domainSet=J(s))}const r=$(t.supportedInterpolations),{name:s,description:o,label:a,lonLatEnvelope:l,supportedFormats:u}=t,{spatialDomain:c}=t.domainSet,d={x:Math.abs(c.offset.x),y:Math.abs(c.offset.y)},p=function(e){if(!e.temporalDomain)return null;const{begin:t,end:n,values:i,units:r,resolution:s}=e.temporalDomain,o={variables:[{name:"default",description:"",dimensions:[{name:"StdTime",description:"",unit:"ISO8601",values:i?.map((e=>e.getTime())),hasRegularIntervals:!i,interval:s,intervalUnit:r,extent:[t.getTime(),n.getTime()]}]}]};return z(o),o}(t.domainSet),f=new D.Z({width:c.columns,height:c.rows,pixelSize:d,pixelType:"unknown",extent:c.envelope,spatialReference:c.envelope.spatialReference,bandCount:i.length||1,noDataValue:n,multidimensionalInfo:p});return{id:s,title:t.name,description:o||a,lonLatEnvelope:l,rasterInfo:f,bandNames:i,supportedFormats:u,supportedInterpolations:r,coverageDescription:t,version:"1.0.0",useEPSGAxis:!1}}function K(e,t){const n=[],i=(0,A.$3)(e,"Field");let r,s=[];for(let e=0;e<i.length;e++){const o=(0,A.Y)(i[e],"Identifier"),a=(0,A.Y)(i[e],"Description"),l=(0,A.Y)(i[e],"Definition"),u=(0,A.Y)(i[e],"Abstract"),c=(0,A.Y)(i[e],"Title"),d=U(i[e],"NullValue"),p=(0,A.sb)(i[e],"AllowedValues"),f=p?G(p):null,h=Z(i[e],"1.1.0"),m=[],g=(0,A.$3)(i[e],"Axis");for(let e=0;e<g.length;e++){const n=g[e].getAttribute("identifier"),i=(0,A.Y)(g[e],"UOM"),o=(0,A.Y)(g[e],"DataType"),a=(0,A.tz)(g[e],"Key");t&&!n.toLowerCase().includes("band")||(s=a,r=d),m.push({identifier:n,uom:i,dataType:o,values:a,bandNoDataValues:r})}n.push({identifier:o,description:a,definition:l,abstract:u,title:c,supportedInterpolations:h,axis:m,nullValues:d,statistics:f})}return{rangeSet:n,bandNames:s,bandNoDataValues:r,statistics:n[0].statistics}}function Q(e){const t=(0,A.sb)(e,"SpatialDomain"),n=(0,A.sb)(t,"GridCRS"),i=(0,A.Y)(n,"GridBaseCRS"),r=(0,A.Y)(n,"GridOrigin")?.split(" ").map((e=>parseFloat(e)))??[0,0],s=(0,A.kH)(n,"GridOffsets"),o=(0,A.$3)(t,"BoundingBox");let a,l,u,c;for(let e=0;e<o.length;e++){const t=o[e].getAttribute("crs")?.toLowerCase();if(null!=t)if(t.includes("imagecrs")){const t=(0,A.kH)(o[e],"LowerCorner"),n=(0,A.kH)(o[e],"UpperCorner");a=n[0]-t[0]+1,l=n[1]-t[1]+1}else if(t.indexOf("epsg")>0){const n=t.split(":");u=parseInt(n[n.length-1],10);const i=(0,A.kH)(o[e],"LowerCorner"),r=(0,A.kH)(o[e],"UpperCorner");c=new T.Z({xmin:i[0],ymin:i[1],xmax:r[0],ymax:r[1],spatialReference:{wkid:u}})}}const d=a>l,p=c.xmax-c.xmin>c.ymax-c.ymin;let f=!1;(0,M.A)(u)&&(d===p?f=!1:(f=!0,c=new T.Z({xmin:c.ymin,ymin:c.xmin,xmax:c.ymax,ymax:c.xmax,spatialReference:{wkid:u}})));const h={columns:a,rows:l,origin:{x:r[0],y:r[1]},offset:{x:s[0],y:s[s.length-1]},gridBaseCRS:i,envelope:c,useEPSGAxis:f},m=(0,A.sb)(e,"temporalDomain")||(0,A.sb)(e,"TemporalDomain");return{spatialDomain:h,temporalDomain:m?q(m):null}}function ee(e,t){const n=[],i=[],r={supportedFormats:n,supportedCRSs:i,version:"1.1"};let s,o,a=[];for(let t=0;t<e.childNodes.length;t++){const l=e.childNodes[t];if(1!==l.nodeType)continue;const u=(0,A.ZB)(l).toLowerCase();switch(u){case"title":case"abstract":case"identifier":r[u]=(0,A.Y)(l);break;case"supportedformat":{const e=(0,A.Y)(l);n.includes(e)||n.push(e)}break;case"supportedcrs":{const e=(0,A.Y)(l);i.includes(e)||i.push(e)}break;case"range":{const e=K(l,!!r.domain?.temporalDomain);r.range=e.rangeSet,a=e.bandNames;const{bandNoDataValues:t}=e;t?.length&&(s=W(t)),o=e.statistics}break;case"domain":r.domain=Q(l)}}const l=$(r.range[0].supportedInterpolations),{identifier:u,abstract:c,title:d,domain:p,range:f}=r,h={x:Math.abs(p.spatialDomain.offset.x),y:Math.abs(p.spatialDomain.offset.y)},m=function(e,t){if(!t.temporalDomain)return null;const n=e.filter((e=>!e.identifier.toLowerCase().includes("field_1")&&!e.axis.some((e=>e.identifier.includes("band"))))),i=[];if(n.length&&n.forEach((e=>{const t=e.axis.map((e=>{const t=e.values.map((t=>"ISO8601"===e.uom?(t=t.trim()).toLowerCase().includes("z")?new Date(t).getTime():new Date(t+"Z").getTime():parseFloat(t.trim()))),n=[Math.min.apply(null,t),Math.max.apply(null,t)];return{name:e.identifier.trim(),description:"",field:e.identifier.trim(),unit:e.uom?e.uom.trim():"",hasRegularIntervals:!1,values:t,extent:n}}));i.push({name:e.identifier.trim(),description:e.description?.trim()??"",unit:"",dimensions:t,statistics:e.statistics})})),t.temporalDomain){const{begin:e,end:n,values:r,units:s,resolution:o}=t.temporalDomain;i.some((e=>e.dimensions.some((e=>"stdtime"===e.name.toLowerCase()))))||i.forEach((t=>{t.dimensions.push({name:"StdTime",description:"",unit:"ISO8601",values:r?.map((e=>e.getTime())),hasRegularIntervals:!r,interval:o,intervalUnit:s,extent:[e.getTime(),n.getTime()]})}))}if(i.length){const e={variables:i};return z(e),e}return null}(f,p);m&&(s=f[0].nullValues,1===s?.length&&(s=s[0]));const g=new D.Z({width:p.spatialDomain.columns,height:p.spatialDomain.rows,pixelSize:h,pixelType:"unknown",extent:p.spatialDomain.envelope,spatialReference:p.spatialDomain.envelope.spatialReference,bandCount:a.length||1,noDataValue:s,statistics:o,multidimensionalInfo:m});return{id:u,title:r.title,description:c||d,bandNames:a,rasterInfo:g,supportedFormats:n,supportedInterpolations:l,coverageDescription:r,version:t,useEPSGAxis:p.spatialDomain.useEPSGAxis}}function te(e){const t=(0,A.sb)(e,"Envelope")||(0,A.sb)(e,"EnvelopeWithTimePeriod"),n=t.getAttribute("srsName"),i=n.slice(n.lastIndexOf("/")+1),r=t.getAttribute("axisLabels").split(" ").map((e=>e.trim())).filter((e=>""!==e.trim())),s=(0,A.kH)(t,"lowerCorner"),o=(0,A.kH)(t,"upperCorner"),a=!["y","lat","latitude","north","nor","n","b"].includes(r[0].toLowerCase());let l;const u=parseInt(i,10),c=isNaN(u)?null:{wkid:u};l=new T.Z(a?{xmin:s[0],ymin:s[1],xmax:o[0],ymax:o[1],spatialReference:c}:{xmin:s[1],ymin:s[0],xmax:o[1],ymax:o[0],spatialReference:c});const d={mins:s,maxs:o},p=t.getAttribute("uomLabels").trim().split(" ");let f,h;if((0,A.W9)(t,"EnvelopeWithTimePeriod")){f=new Date((0,A.Y)(e,"beginPosition")||(0,A.Y)(e,"BeginPosition")),h=new Date((0,A.Y)(e,"endPosition")||(0,A.Y)(e,"EndPosition"));const t=p?.findIndex((e=>"oledatetime"===e?.toLowerCase()));t>-1&&(p[t]="ISO8601")}return{envelope:l,axisLabels:r,uomLabels:p.length?p:null,envelopeAllDims:d,beginPosition:f,endPosition:h,isEastFirst:a}}function ne(e,t){const n=[],i=(0,A.$3)(e,"DataRecord"),r=[];let s,o=[];for(let e=0;e<i.length;e++){const a=(0,A.$3)(i[e],"field"),l=[];for(let e=0;e<a.length;e++){const n=a[e].getAttribute("name"),i=(0,A.Y)(a[e],"description")||"",u=(0,A.sb)(a[e],"uom")?.getAttribute("code")||"",c=(0,A.kH)(a[e],"interval"),d=U(a[e],"nilValue")?.[0];t&&!n.toLowerCase().includes("band")||(r.push(n),c?.length&&(s=s||[],s.push({min:c[0],max:c[1],avg:-1,stddev:-1})),o.push(d)),l.push({name:n,description:i,uom:u,allowedValues:c,nilValue:d})}n.push(l)}return o.some((e=>null!=e))||(o=null),{rangeType:n,bandNames:r,bandStats:s,bandNoDataValues:o}}function ie(e){let t=1,n="";const i=.01;return Math.abs(e-1/24)<1/24*i?n="Hours":Math.abs(e-1)<1*i?n="Days":e<1?(t=Math.round(24*e),n="Hours"):e>28-i&&e<31+i||Math.round(e/30)<12?n="Months":e>365-i&&e<366+i&&(n="Years"),{interval:t,intervalUnit:n}}function re(e,t){const n=(0,A.sb)(e,"RectifiedGrid"),i=(0,A.kH)(n,"low"),r=(0,A.kH)(n,"high"),s=[];for(let e=0;e<i.length;e++)s.push(r[e]-i[e]+1);const o=(0,A.Y)(n,"axisLabels").split(" "),a=(0,A.kH)(n,"origin/pos"),l=(0,A.$3)(n,"offsetVector"),u=[];for(let e=0;e<l.length;e++){const t=(0,A.kH)(l[e]),n=t.findIndex((e=>0!==e));u[n]=t[n]}let c=!1;t?.length&&o?.length&&(c=[...t].sort(((e,t)=>e<t?-1:1)).join(",")===[...o].sort(((e,t)=>e<t?-1:1)).join(","));let d,p,f;return["y","lat","latitude","north","nor","n","b"].includes((c?o:t)[0].toLowerCase())?(d=s[1],p=s[0],f={y:Math.abs(u[0]),x:Math.abs(u[1])}):(d=s[0],p=s[1],f={x:Math.abs(u[0]),y:Math.abs(u[1])}),{columns:d,rows:p,origin:a,offset:u,resolution:f,gridSamples:s,axisLabels:o,hasSameAxisLabelsAsBoundedBy:c}}function se(e){const t=(0,A.sb)(e,"EarthObservation");if(!t)return null;const n=(0,A.sb)(t,"phenomenonTime"),i=n?q(n):null,r=(0,A.sb)(t,"phenomenonTime"),s=r?q(r):null,o=(0,A.Y)(t,"featureOfInterest/Footprint/multiExtentOf/MultiSurface/surfaceMembers/Polygon/exterior/LinearRing/posList");let a=null;if(o){const e=o.split(" ").map((e=>e.trim())).filter((e=>null!=e&&""!==e)).map(Number);if(e.length){const t=[];for(let n=0;n<e.length/2;n+=2)t.push(e[n],e[n+1]);a=new k.Z({rings:[[t]]})}}return{observation:{phenomenonTime:i,resultTime:s,footprint:a,identifier:(0,A.Y)(e,"metaDataProperty/EarthObservationMetaData/identifier"),acquisitionType:(0,A.Y)(e,"metaDataProperty/EarthObservationMetaData/acquisitionType"),status:(0,A.Y)(e,"metaDataProperty/EarthObservationMetaData/status")}}}function oe(e){const t={version:"2.0"};let n,i,r=[];for(let s=0;s<e.childNodes.length;s++){const o=e.childNodes[s];if(1===o.nodeType)if((0,A.W9)(o,"coverageId"))t.coverageId=(0,A.Y)(o);else if((0,A.W9)(o,"ServiceParameters"))t.serviceParameters={supportedFormats:(0,A.tz)(o,"nativeFormat")};else if((0,A.W9)(o,"boundedBy"))t.boundedBy=te(o);else if((0,A.W9)(o,"rangeType")){const e=ne(o,t.boundedBy?.axisLabels.length>2||t.domainSet?.axisLabels.length>2);t.rangeType=e.rangeType,r=e.bandNames,n=e.bandStats;const{bandNoDataValues:s}=e;s?.length&&(i=W(s))}else if((0,A.W9)(o,"domainSet"))t.domainSet=re(o,t.boundedBy?.axisLabels);else if((0,A.W9)(o,"metadata")){const e=(0,A.sb)(o,"EOMetadata");t.eoMetadata=e?se(e):null}}const{coverageId:s,boundedBy:o,domainSet:a,rangeType:l,serviceParameters:u}=t,c=function(e,t,n){if(n.axisLabels.length<=2)return null;const i=[];for(let t=0;t<e.length;t++){const n=e[t];for(let e=0;e<n.length;e++)n[e].name.toLowerCase().includes("band")||i.push(n[e])}const r=[];if(i.length){const e=[];for(let i=2;i<n.axisLabels.length;i++){const r=t.uomLabels?.[i]?.trim()??"",s=n.axisLabels[i].toLowerCase().includes("time")||"iso8601"===r.toLowerCase()||"oledatetime"===r.toLowerCase();let o,a;if(s){const e=ie(n.offset[i]);o=e.interval,a=e.intervalUnit}else o=n.offset[i],a=r;const l=[];s?(l.push((0,B.de)(t.envelopeAllDims.mins[i])),l.push((0,B.de)(t.envelopeAllDims.maxs[i]))):(l.push(t.envelopeAllDims.mins[i]),l.push(t.envelopeAllDims.maxs[i])),e.push({name:n.axisLabels[i].trim(),description:n.axisLabels[i].trim(),unit:s?"ISO8601":r,hasRegularIntervals:!0,extent:l,interval:o,intervalUnit:a})}if(i.forEach((t=>{const{allowedValues:n}=t,i=2===n?.length?[{min:n[0],max:n[1],avg:-1,stddev:-1}]:null;r.push({name:t.name.trim(),description:t.description?.trim()??"",unit:t.uom.trim(),statistics:i,dimensions:[...e]})})),r.length){const e={variables:r};return z(e),e}}return null}(l,o,a);return!n&&c&&(n=c?.variables[0].statistics),null!=c&&(i=l[0][0].nilValue),{id:s,title:s,description:s,bandNames:r,rasterInfo:new D.Z({width:a.columns,height:a.rows,pixelSize:a.resolution,pixelType:"unknown",extent:o.envelope,spatialReference:o.envelope.spatialReference,bandCount:r.length||1,statistics:n,noDataValue:i,multidimensionalInfo:c}),supportedFormats:u.supportedFormats,coverageDescription:t,version:"2.0.1",useEPSGAxis:!1}}async function ae(e,t){const{version:n,customParameters:i,signal:r}=t??{},s=n?.startsWith("1.0")?"version":"acceptVersions",a={service:"WCS",request:"GetCapabilities",[s]:n,...i};try{let{data:n}=await(0,E.Z)(e,{query:a,responseType:"xml",signal:r});return t?.version||function(e){let t=null;t="string"==typeof e?(new DOMParser).parseFromString(e,"text/xml"):e;const n=t.documentElement.getAttribute("version")?.slice(0,3);return null!=n&&n<"2.1"}(n)||(a[s]="2.0.1",({data:n}=await(0,E.Z)(e,{query:a,responseType:"xml",signal:r}))),N(n)}catch(e){if(!(0,l.D_)(e))throw new o.Z("wcslayer:open","wcs capabilities is not valid or supported");throw e}}async function le(e,t){const{coverageIds:n,version:i,customParameters:r,signal:s}=t,a=i.slice(0,3),u={service:"WCS",request:"DescribeCoverage",version:i,["1.0"===a?"coverage":"1.1"===a?"identifiers":"coverageId"]:n.join(","),...r};try{const{data:t}=await(0,E.Z)(e,{query:u,responseType:"xml",signal:s});return function(e,t){let n=null;if(n="string"==typeof e?(new DOMParser).parseFromString(e,"text/xml"):e,"1.0.0"===t)return(0,A.$3)(n,"CoverageOffering").map((e=>X(e)));const i=(0,A.$3)(n,"CoverageDescription");return"1.1.0"===t||"1.1.1"===t||"1.1.2"===t?i.map((e=>ee(e,t))):i.map((e=>oe(e)))}(t,i)}catch(e){if(!(0,l.D_)(e))throw new o.Z("wcslayer:open","wcs coverage description is not valid or supported");throw e}}var ue=n(68004),ce=n(36129);function de(e){const t=function(e){const t=e.getHeader?.("Content-Type")?.split(";");if(!t)return null;if(!(t[0].trim()??"").startsWith("multipart/"))return null;const n={boundary:"",start:"",type:""};for(let e=1;e<t.length;e++){const i=t[e].indexOf("=");if(i>0){const r=t[e].slice(0,i).trim(),s=t[e].slice(i+1).trim();n[r]=s.startsWith('"')?s.slice(1,-1):s}}return n}(e);return t?{isMultipart:!0,data:t.boundary?pe(e.data,t,0):null}:{isMultipart:!1,data:null}}function pe(e,t,n=0){const i="--"+t.boundary,r=[];for(let e=0;e<i.length;e++)r.push(i.charCodeAt(e));const s=[],o="\n--"+t.boundary+"--";for(let e=0;e<o.length;e++)s.push(o.charCodeAt(e));const a=[10],l=[13,10],u=[],c=r.length,d=new Uint8Array(e,n),p=d.length-c;let f=0,h=0;for(let e=0;e<p;e++){for(h=0;h<c&&d[e+h]===r[h];h++);if(h!==c)continue;let n=!1;if(f){const i=fe(d.subarray(f,e),t);u.push(i),n=!!i.isValidImage}if(e+=c-1,d[e+1]===a[0]?e+=1:d[e+1]===l[0]&&d[e+2]===l[1]&&(e+=2),f=e+1,n)break}const m=s.length;for(let e=d.length-m-10;e<d.length-m;e++){for(h=0;h<m&&d[e+h]===s[h];h++);if(h===m){u.push(fe(d.subarray(f,e),t));break}}return u}function fe(e,t){const n=String.fromCharCode.apply(null,e.subarray(0,Math.min(300,e.length))).split("\n"),i=Math.min(n.length,7),r={contentDisposition:"inline"};let s=0;for(let o=0;o<i;o++)if(n[o].length<4)s=s+n[o].length+1;else if("content"===n[o].slice(0,7).toLowerCase()){s=s+n[o].length+1;const e=n[o].indexOf(":");if(-1===e)continue;const t=n[o].slice(0,e).trim(),i=n[o].slice(e+1).trim();switch(t.toLowerCase()){case"content-type":r.contentType=i;break;case"content-description":r.contentDescription=i;break;case"content-transfer-encoding":r.contentTransferEncoding=i;break;case"content-id":r.contentID=i;break;case"content-disposition":r.contentDisposition=i;break;case"content-location":r.contentLocation=i}}else{if(r.contentDisposition.toLowerCase().includes("inline")&&n[o].length>=4&&r.contentType?.toLowerCase().indexOf("image")>-1){let t=!0,n=e.subarray(s,e.length);if(r.contentType.toLowerCase().indexOf("tif")>0){if("base64"===r.contentTransferEncoding){let e="";const t=n;for(let n=0;n<t.length;n+=65535){const i=t.subarray(n,n+65535>t.length-1?t.length-1:n+65535);e+=String.fromCharCode.apply(null,i)}const i=atob(e);n=new Uint8Array(i.length);for(let e=0;e<n.length;e++)n[e]=i.charCodeAt(e)}t=73===n[0]&&73===n[1]||77===n[0]&&77===n[1]}if(t){let t=n.buffer;"base64"!==r.contentTransferEncoding&&(t=new ArrayBuffer(e.length-s),n=new Uint8Array(t),n.set(e.subarray(s,e.length))),r.contentData=t,r.isValidImage=!0}break}if((""===t.start||r.contentID===t.start)&&r.contentType){if(r.contentType.includes("text")||r.contentType.includes("xml")){r.contentData=String.fromCharCode.apply(null,e.subarray(s,e.length));break}r.contentData=e.subarray(s,e.length)}}return r}var he=n(89014),me=n(91172);const ge=["nearest neighbor","bilinear","bicubic"],ye=["nearest","linear","cubic"],ve="response is not a supported multipart/related mediaType with inline tiff,  switching to compatibility mode",be=new Set(["1.0.0","1.1.0","1.1.1","1.1.2","2.0.1"]);let xe=class extends ce.Z{constructor(){super(...arguments),this.datasetFormat="WCSServer",this.tileType="Raster"}get rasterId(){return`${this.url}-${this.coverageId}-${this.version}`}async fetchRawTile(e,t,n,i={}){if(this.isBlockOutside(e,t,n))return null;const{nativePixelSize:r,spatialReference:s}=this.rasterInfo,a=2**e,l=r.x*a,u=r.y*a,{blockWidth:c,blockHeight:d}=this.getBlockWidthHeight(e),{origin:p}=this.rasterInfo.storageInfo.tileInfo,f=this.getTileExtent({x:l,y:u},t,n,p,s,[c,d]),h=this.rasterInfo.extent,m=f.xmax>h.xmax,g=f.ymin<h.ymin,y=m||g;let v=f,b=c,x=d;if(y&&(v=f.clone().intersection(h),null!=v&&(m&&(b=Math.floor((v.xmax-v.xmin)/l),v.xmax=v.xmin+l*b),g&&(x=Math.floor((v.ymax-v.ymin)/u),v.ymin=v.ymax-u*x))),null==v||b<=1||x<=1)return null;const w=await this._getCoverage(v,b,x,a,i);if(!w)return null;const{coverageDescription:C}=this.coverageInfo,{noDataValue:S,multidimensionalInfo:_}=this.rasterInfo,{multidimensionalDefinition:I}=i;let T;if(null!=_&&null!=I&&I.length){const e=I[0].variableName;if("2.0"===C.version){T=C.rangeType[0].find((t=>t.name===e))?.nilValue}else if("1.1"===C.version){T=C.range.find((t=>t.identifier===e))?.nullValues}}const M=T??S,E=await this.decodePixelBlock(w,{width:b,height:x,planes:null,pixelType:null,tiffNoDataValue:Array.isArray(M)?M[0]:M,matchAllNoData:!0});if(null==E)return null;if(E&&(E.width!==b||E.height!==x))throw new o.Z("wcsraster-fetch",`the response has unexpected dimension width: ${E.width}, height: {pixelBlock.height}`);return y?(0,me.oq)(E,{x:0,y:0},{width:d,height:d}):E}async _open(e){const{customFetchParameters:t}=this.ioConfig,n=e?.signal,i=await ae(this.url,{version:t?.version??this.version,customParameters:t,signal:n});if(this.capabilities=i,!this.version){let e=i.version.slice(0,3);"2.0"===e||"1.1"===e||"1.0"===e?this.version=i.version:(e=i.supportedVersions.find((e=>"2.0.1"===e))||i.supportedVersions.find((e=>"2.0"===e.slice(0,3)))||i.supportedVersions.find((e=>"1.1"===e.slice(0,3)))||i.supportedVersions.find((e=>"1.0"===e.slice(0,3)))||"1.0.0",this.version=e)}const{version:r}=this;if(!be.has(r))throw new o.Z("wcsraster-open",`unsupported WCS version ${r}`);const{gridCoverages:s}=i;if(!s.length)throw new o.Z("wcsraster-open","cannot find rectified grid coverages");this.coverageId??=s[0].id;const{coverageId:a}=this,l=s.find((e=>e.id===a));if(null==l)throw new o.Z("wcsraster-open",`the coverageId ${a} does not exist in capabilities`);const u=await le(this.url,{coverageIds:[a],version:r,customParameters:t,signal:n});if(this.coverageInfo=u[0],"2.0"===r.slice(0,3)){const{coverageInfo:e}=this;e.lonLatEnvelope=l.lonLatEnvelope,e.supportedInterpolations=$(i.supportedInterpolations),this._patchDimensionValues201(a,n)}this.datasetName=this.coverageInfo.title;const{rasterInfo:c}=this.coverageInfo;if(this.createRemoteDatasetStorageInfo(c,512,512),this._set("rasterInfo",c),null==c.spatialReference)throw new o.Z("wcsraster-open",`coverage without spatial reference is not supported: ${a}`);const{pixelType:d,bandCount:p}=await this._getPixelTypeAndBandCount(n);c.pixelType=d,1===c.bandCount&&p>1&&(c.bandCount=p),this.updateTileInfo()}async _patchDimensionValues201(e,t){const{coverageInfo:n}=this,i=n.rasterInfo.multidimensionalInfo?.variables,r=be.has("1.1.2")?"1.1.2":be.has("1.1.1")?"1.1.1":be.has("1.1.0")?"1.1.0":null,{customFetchParameters:s}=this.ioConfig;if(i&&r)try{const n=this.url.includes("/ImageServer/"),o=e.length>8&&e.startsWith("Coverage")&&n?e.slice(8):e,a=(await le(this.url,{coverageIds:[o??e],version:r,customParameters:s,signal:t}).catch((()=>{if(o)return le(this.url,{coverageIds:[e],version:r,customParameters:s,signal:t})})))?.[0].rasterInfo.multidimensionalInfo?.variables;if(a)for(const e of i){const t=a.find((({name:t})=>t===e.name));if(t?.dimensions?.length)for(let i=e.dimensions.length-1;i>=0;i--){const r=e.dimensions[i],s=t.dimensions.find((({name:e})=>e===r.name));s?s.values&&s.extent?.join(",")===r.extent?.join(",")&&(e.dimensions[i]={...r,values:s.values}):n&&e.dimensions.splice(i,1)}}}catch{}}async _getPixelTypeAndBandCount(e){const{pixelSize:t,extent:n,multidimensionalInfo:i}=this.rasterInfo,r=n.center,s=new T.Z({xmin:r.x-t.x,xmax:r.x+t.x,ymin:r.y-t.y,ymax:r.y+t.y,spatialReference:n.spatialReference});let a=[];if(null!=i){const e=i.variables[0];a=[],e.dimensions.forEach((t=>{a.push(new ue.Z({variableName:e.name,dimensionName:t.name,values:t.hasRegularIntervals?t.extent?.[0]:t.values?.[0],isSlice:!0}))}))}const{coverageDescription:l}=this.coverageInfo,u={interpolation:"nearest",multidimensionalDefinition:a,signal:e},{version:c}=l,{ioConfig:p}=this,f="2.0"===c&&null==p.allowAnyMediaType||"1.1"===c&&null==p.use2GridOffsets;let h;try{h=await this._getCoverage(s,2,2,1,u,!0)}catch(e){if(!f)throw e;if("1.1"===c){if(!e.details?.isResolutionMismatch)throw e;p.use2GridOffsets=!0}}if(!h&&f&&("2.0"===c&&(p.allowAnyMediaType=!0),h=await this._getCoverage(s,2,2,1,u),h&&d.Z.getLogger(this).warn("wcsraster:getcoverage",ve)),!h)throw new o.Z("wcsraster-open","unable to determine pixel type");const m=await this.decodePixelBlock(h,{width:2,height:2,planes:null,pixelType:null});if(null==m)throw new o.Z("wcsraster-open","unable to determine pixel type");return{pixelType:m.pixelType,bandCount:m.getPlaneCount()??0}}async _getCoverage(e,t,n,i,r,s=!1){const{coverageDescription:a}=this.coverageInfo,{version:l}=a,u="2.0"===l?this._getCoverage201Parameters(e,t,n,i,r,a):"1.1"===l?this._getCoverage110Parameters(e,t,n,r,a):this._getCoverage100Parameters(e,t,n,r),c="2.0"===l?await this.request(this._constructWCS201Url(u),{signal:r.signal,responseType:"array-buffer"}):await this.request(this.url,{query:u,signal:r.signal,responseType:"array-buffer"});if("1.0"===l)return c.data;if("2.0"===l&&!1!==this.ioConfig.allowAnyMediaType&&"tiff"===(0,he.y)(c.data))return s&&(this.ioConfig.allowAnyMediaType=!0,d.Z.getLogger(this).warn("wcsraster:getcoverage",ve)),c.data;const p=de(c);if(p.isMultipart&&p.data){const e=p.data.find((e=>e.isValidImage));return s&&"base64"===e?.contentTransferEncoding&&d.Z.getLogger(this).warn("wcsraster:getcoverage","response is base64 encoded which may impact layer display performance"),e?.contentData}const f=new Uint8Array(c.data,0,Math.min(c.data.byteLength,2e3)),h=String.fromCharCode.apply(null,f).toLowerCase().includes("exception"),m=h&&String.fromCharCode.apply(null,f).includes("A non-zero RESX/RESY or WIDTH/HEIGHT is required but neither was provided");if(h)throw new o.Z("wcsraster:getcoverage","server returns an exception",{isResolutionMismatch:m});throw new o.Z("wcsraster:getcoverage","response is not a supported multipart mediaType with inline tiff")}_getInterpolationIndex(e){return e&&this.coverageInfo.supportedInterpolations?.includes(e)?"nearest"===e?0:"bilinear"===e?1:"cubic"===e?2:0:0}_getCoverage100Parameters(e,t,n,i){const r=`${e.xmin},${e.ymin},${e.xmax},${e.ymax}`,s=e.spatialReference.wkid,o=(this.coverageInfo.supportedFormats||[]).find((e=>e.toLowerCase().includes("tiff")))||"GEOTIFF",{bandIds:a,interpolation:l}=i,u=this._getInterpolationIndex(l),c=a?a.map((e=>this.coverageInfo.bandNames[e])):null,d=ge[u],{multidimensionalDefinition:p}=i;let f;if(null!=p&&null!=this.rasterInfo.multidimensionalInfo){let e=p.find((e=>"StdTime"===e.dimensionName))?.values;e&&e.length>0&&(Array.isArray(e[0])&&(e=e[0]),f=e.map((e=>we(e))).join(","))}return{service:"WCS",request:"GetCoverage",version:this.version,coverage:this.coverageId,format:o,crs:`EPSG:${s}`,bbox:r,width:t,height:n,time:f,interpolation:d,band:c?.join(",")}}_getCoverage110Parameters(e,t,n,i,r){const{multidimensionalDefinition:s,bandIds:o,interpolation:a}=i,l=e.spatialReference.wkid,u=`urn:ogc:def:crs:EPSG::${l}`,c=(this.coverageInfo.supportedFormats||[]).find((e=>e.toLowerCase().includes("tiff")))||"image/tiff",d=this._getInterpolationIndex(a),p=ye[d],f=null==a||0===this.coverageInfo.supportedInterpolations?.indexOf(a),h=r.domain.spatialDomain,m=h.origin.x<=h.envelope.xmin&&h.origin.y<=h.envelope.ymin,g=e.width/t,y=e.height/n*(m?1:-1),v=m?[e.xmin,e.ymin]:[e.xmin,e.ymax],b=h.useEPSGAxis&&(0,M.A)(l),x=b?`${v[1]},${v[0]}`:`${v[0]},${v[1]}`,w=this.ioConfig.use2GridOffsets,C=b?w?`${y},${g}`:`${y},0,0,${g}`:w?`${g},${y}`:`${g},0,0,${y}`,S=g/2,_=e.xmin+S,I=e.xmax-S,T=Math.abs(y)/2,E=e.ymin+T,A=e.ymax-T,L=b?`${E},${_},${A},${I},${u}`:`${_},${E},${I},${A},${u}`,R=r.range.find((e=>e.axis.some((e=>e.identifier.toLowerCase().includes("band")))));let F,P=R&&p&&o?f?`${R.identifier}[${R.axis[0].identifier}[${o.join(",")}]]`:`${R.identifier}:${p}[${R.axis[0].identifier}[${o.join(",")}]]`:null;if(null!=s&&s.length)for(let e=0;e<s.length;e++){let t=s[e].values;const n=s[e].dimensionName?.toLowerCase(),i=s[e].variableName?.toLowerCase(),o=r.range.find((e=>e.identifier.toLowerCase()===i));if(t.length>0)if(Array.isArray(t[0])&&(t=t[0]),"stdtime"===n)F=t.map((e=>we(e))).join(",");else if(o){const e=o.axis.find((e=>e.identifier.toLowerCase()===n));e&&(P=f?o.identifier+"["+e.identifier+"["+t.join(",")+"]]":o.identifier+":"+p+"["+e.identifier+"["+t.join(",")+"]]")}e===s.length-1&&o&&!P&&(P=f?o.identifier:o.identifier+":"+p)}return{service:"WCS",request:"GetCoverage",version:this.version,identifier:this.coverageId,format:c,crs:`EPSG:${l}`,boundingbox:L,gridCS:"urn:ogc:def:cs:OGC:0.0:Grid2dSquareCS",gridType:"urn:ogc:def:method:WCS:1.1:2dGridIn2dCrs",gridOrigin:x,gridOffsets:C,gridBaseCRS:u,timeSequence:F,rangeSubset:P}}_getCoverage201Parameters(e,t,n,i,r,s){const{multidimensionalDefinition:o,interpolation:a}=r,l=this._getInterpolationIndex(a);let u=null;const{supportedInterpolations:c}=this.capabilities;if(c?.length)switch(l){case 0:u=c.find((e=>e.toLowerCase().includes("nearest")));break;case 1:u=c.find((e=>e.toLowerCase().includes("linear")));break;case 2:u=c.find((e=>e.toLowerCase().includes("cubic")||e.toLowerCase().includes("quadratic")))}const d=(this.coverageInfo.supportedFormats||[]).find((e=>e.toLowerCase().includes("tiff")))||"image/tiff",{bandNames:p}=this.coverageInfo,{boundedBy:f,domainSet:h,rangeType:m}=s,g=f.isEastFirst?0:1,y=1-g,{axisLabels:v}=f,b=v[g],x=v[y],w=`http://www.opengis.net/def/crs/EPSG/0/${e.spatialReference.wkid}`,C=w,S=[];S.push(`${b}(${e.xmin},${e.xmax})`),S.push(`${x}(${e.ymin},${e.ymax})`);const _=[];if(v.length>2)for(let e=2;e<v.length;e++){const t=h.origin[e];if(v[e].toLowerCase().includes("time")){let n=t.toString();f.uomLabels?.[e].toLowerCase().includes("ole")&&(_.push(v[e]),n=we(t,!0)),S.push(v[e]+",http://www.opengis.net("+n+")")}else S.push(v[e]+",http://www.opengis.net("+t+")")}let I=null;if(null!=o&&o.length){const e=[];m.forEach((t=>t.forEach((t=>e.push(t.name)))));const t=[];for(let n=0;n<o.length;n++){const i=v.find((e=>e===o[n].dimensionName)),r=e.find((e=>e===o[n].variableName));if(t.includes(r)||t.push(r),i){let e=o[n].values;if(e.length>0){Array.isArray(e[0])&&(e=e[0]);let t="";t=i.toLowerCase().includes("time")?e.map((e=>we(e))).join(","):e.join(",");const n=S.findIndex((e=>0===e.indexOf(i+",http://www.opengis.net")));-1===n&&S.push(i+",http://www.opengis.net("+t+")"),-1===n||S[n].includes("("+t+")")||S.splice(n,1,i+",http://www.opengis.net("+t+")")}}}t.length&&(I=t.join(","))}else p?.length>=2&&(I=(r.bandIds?r.bandIds.map((e=>p[e])):p).join(","));const T=S.join("&subset="),M=!s.domainSet.hasSameAxisLabelsAsBoundedBy&&!1!==this.ioConfig.allowScaleFactor,E=M?null:`${b}(${t}),${x}(${n})`,A=M?1/i:null;return{service:"WCS",request:"GetCoverage",version:this.version,coverageId:this.coverageId,rangesubset:I,interpolation:u,scaleSize:E,scaleFactor:A,subset:T,format:d,mediaType:this.ioConfig.allowAnyMediaType?null:"multipart/related",outputcrs:w,subsettingcrs:C}}_constructWCS201Url(e){const t={...this.ioConfig.customFetchParameters,...e},n=[];return Object.keys(t).forEach((e=>{const i=t[e];null!=i&&("subset"===e?"string"==typeof i&&i.split("&subset=").forEach((e=>{e&&n.push(`subset=${encodeURIComponent(e)}`)})):n.push(`${e}=${encodeURIComponent(i)}`))})),`${encodeURI(this.url)}?${n.join("&")}`}};function we(e,t=!1){return(t?new Date((0,B.de)(e)):new Date(e)).toISOString()}(0,i._)([(0,c.Cb)({type:String,json:{write:!0}})],xe.prototype,"datasetFormat",void 0),(0,i._)([(0,c.Cb)({readOnly:!0})],xe.prototype,"tileType",void 0),(0,i._)([(0,c.Cb)({type:String,json:{write:!0}})],xe.prototype,"version",void 0),(0,i._)([(0,c.Cb)({type:String,json:{write:!0}})],xe.prototype,"coverageId",void 0),(0,i._)([(0,c.Cb)({readOnly:!0})],xe.prototype,"rasterId",null),xe=(0,i._)([(0,p.j)("esri.layers.support.rasterDatasets.WCSRaster")],xe);var Ce=n(99382),Se=n(3651);const _e=new Set(["milliseconds","seconds","minutes","hours","days","weeks","months","years","decades","centuries"]);let Ie=class extends((0,h.h7)((0,w.M)((0,y.q)((0,v.I)((0,m.N)((0,g.r)((0,b.f)((0,C.n)((0,x.Q)((0,a.R)(s.Z.ClonableMixin(f.Z)))))))))))){constructor(...e){super(...e),this.coverageId=null,this.version=null,this.isReference=null,this.legendEnabled=!0,this.noData=0,this.operationalLayerType="WCS",this.type="wcs",this.popupEnabled=!0,this.popupTemplate=null,this.fields=null,this._debouncedSaveOperations=(0,l.Ds)((async(e,t,i)=>{const{save:r,saveAs:s}=await n.e(58722).then(n.bind(n,58722));switch(e){case Se.x.SAVE:return r(this,t);case Se.x.SAVE_AS:return s(this,i,t)}}))}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}load(e){const t=null!=e?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["WCS"]},e).catch(l.r9).then((()=>this._openRaster(t)))),Promise.resolve(this)}get coverageInfo(){return this.raster.coverageInfo}get defaultPopupTemplate(){return this.createPopupTemplate()}get rasterFields(){const e=[(0,I.Zp)("Pixel Value")],t=(this.raster?.rasterInfo??this.serviceRasterInfo)?.multidimensionalInfo;if(t){const n=(0,I.Mk)(t);e.push(...n)}return e}createPopupTemplate(e){return(0,Ce.eZ)({fields:this.rasterFields,title:this.title},e)}async save(e){return this._debouncedSaveOperations(Se.x.SAVE,e)}async saveAs(e,t){return this._debouncedSaveOperations(Se.x.SAVE_AS,t,e)}async _openRaster(e){const t=new xe({url:this.url,version:this.version,coverageId:this.coverageId,ioConfig:{sampling:"closest",...this.ioConfig,customFetchParameters:this.customParameters}});if(await t.open({signal:e}),!t.rasterInfo)throw t.destroy(),new o.Z("wcs-layer:load","cannot load resources on "+this.url);const{rasterInfo:n}=t;null==n.noDataValue&&(n.noDataValue=this.noData),this._set("serviceRasterInfo",n),this._set("spatialReference",n.spatialReference),null==this.title&&this.setAtOrigin("title",t.datasetName,"service"),null==this.coverageId&&this.setAtOrigin("coverageId",t.coverageInfo.id,"service"),null==this.version&&t.version&&this.setAtOrigin("version",t.version,"service"),this.setAtOrigin("tileInfo",t.rasterInfo.storageInfo.tileInfo,"service");const{multidimensionalInfo:i}=n;if(null!=i){const e=i.variables[0].dimensions.find((({name:e})=>"StdTime"===e));if(e){let t=e.extent?.[0]??e.values[0];Array.isArray(t)&&(t=t[0]);let n=e.extent?.[1]??e.values[e.values.length-1];Array.isArray(n)&&(n=n[1]);const i=_e.has(e.intervalUnit?.toLowerCase())?e.intervalUnit?.toLowerCase():null;this.set("timeInfo",{startField:"StdTime",fullTimeExtent:{start:t,end:n},timeZone:null,interval:i?{value:e.interval,unit:i}:null})}}this.raster=t,this._configDefaultSettings(),this.addHandles((0,u.YP)((()=>this.customParameters),(e=>this.raster.ioConfig.customFetchParameters=e)))}};(0,i._)([(0,c.Cb)({type:String,nonNullable:!0,json:{name:"wcsInfo.coverageId",write:{isRequired:!0,ignoreOrigin:!0}}})],Ie.prototype,"coverageId",void 0),(0,i._)([(0,c.Cb)()],Ie.prototype,"coverageInfo",null),(0,i._)([(0,c.Cb)({type:["1.0.0","1.1.0","1.1.1","1.1.2","2.0.1"],nonNullable:!0,json:{name:"wcsInfo.version",write:{isRequired:!0,ignoreOrigin:!0}}})],Ie.prototype,"version",void 0),(0,i._)([(0,c.Cb)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],Ie.prototype,"isReference",void 0),(0,i._)([(0,c.Cb)({json:{read:!0,write:!0}})],Ie.prototype,"blendMode",void 0),(0,i._)([(0,c.Cb)(S.rn)],Ie.prototype,"legendEnabled",void 0),(0,i._)([(0,c.Cb)({type:["show","hide"]})],Ie.prototype,"listMode",void 0),(0,i._)([(0,c.Cb)()],Ie.prototype,"noData",void 0),(0,i._)([(0,c.Cb)({type:["WCS"]})],Ie.prototype,"operationalLayerType",void 0),(0,i._)([(0,c.Cb)()],Ie.prototype,"raster",void 0),(0,i._)([(0,c.Cb)({readOnly:!0})],Ie.prototype,"type",void 0),(0,i._)([(0,c.Cb)(S.C_)],Ie.prototype,"popupEnabled",void 0),(0,i._)([(0,c.Cb)({type:r.Z,json:{name:"popupInfo",write:!0}})],Ie.prototype,"popupTemplate",void 0),(0,i._)([(0,c.Cb)({readOnly:!0})],Ie.prototype,"defaultPopupTemplate",null),(0,i._)([(0,c.Cb)({readOnly:!0,type:[_.Z]})],Ie.prototype,"fields",void 0),(0,i._)([(0,c.Cb)({readOnly:!0,type:[_.Z]})],Ie.prototype,"rasterFields",null),Ie=(0,i._)([(0,p.j)("esri.layers.WCSLayer")],Ie);const Te=Ie},615:function(e,t,n){n.d(t,{cW:function(){return l},ij:function(){return a},rM:function(){return u}});var i=n(88194),r=n(60123),s=n(13928),o=n(8971);function a(e,t,n){try{return function(e){if(!e||0===e.length)return null;if(function(e){const t=e[0];return!!t&&"scale"in t}(e)){const t=[];for(const n of e)t.push({scale:n.scale,value:u(n.value)});return t}return u(e)}(e)}catch(e){n?.messages?.push(e)}return null}function l(e,t,n,i){try{const i=function(e){const t=(0,s.Q)(e);return t?(0,o.Cb)(t)?t.map((e=>e.toJSON())):t.map((({scale:e,effects:t})=>({scale:e,value:t.map((e=>e.toJSON()))}))):null}(e);(0,r.RB)(n,i,t)}catch(e){i.messages&&i.messages.push(e)}}function u(e){if(!e?.length)return"";const t=[];for(const n of e){let e=[];switch(n.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":e=[c(n,"amount")];break;case"blur":e=[c(n,"radius","pt")];break;case"hue-rotate":e=[c(n,"angle","deg")];break;case"drop-shadow":e=[c(n,"xoffset","pt"),c(n,"yoffset","pt"),c(n,"blurRadius","pt"),d(n,"color")];break;case"bloom":e=[c(n,"strength"),c(n,"radius","pt"),c(n,"threshold")]}const i=`${n.type}(${e.filter(Boolean).join(" ")})`;(0,s.Q)(i),t.push(i)}return t.join(" ")}function c(e,t,n){if(null==e[t])throw new i.Z("effect:missing-parameter",`Missing parameter '${t}' in ${e.type} effect`,{effect:e});return n?e[t]+n:""+e[t]}function d(e,t){if(null==e[t])throw new i.Z("effect:missing-parameter",`Missing parameter '${t}' in ${e.type} effect`,{effect:e});const n=e[t];return`rgba(${n[0]||0}, ${n[1]||0}, ${n[2]||0}, ${n[3]/255||0})`}},13928:function(e,t,n){n.d(t,{Q:function(){return u}});var i=n(38461),r=n(88194),s=n(71480),o=n(8971);class a extends SyntaxError{constructor(e,t,n,i){super(e),this.expected=t,this.found=n,this.location=i,this.name="SyntaxError"}format(e){let t="Error: "+this.message;if(this.location){let n=null;const i=e.find((e=>e.source===this.location.source));i&&(n=i.text.split(/\r\n|\n|\r/g));const r=this.location.start,s=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(r):r,o=this.location.source+":"+s.line+":"+s.column;if(n){const e=this.location.end,i="".padEnd(s.line.toString().length," "),a=n[r.line-1],l=(r.line===e.line?e.column:a.length+1)-r.column||1;t+="\n --\x3e "+o+"\n"+i+" |\n"+s.line+" | "+a+"\n"+i+" | "+"".padEnd(r.column-1," ")+"".padEnd(l,"^")}else t+="\n at "+o}return t}static buildMessage(e,t){function n(e){return e.codePointAt(0).toString(16).toUpperCase()}const i=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function r(e){return i?e.replace(i,(e=>"\\u{"+n(e)+"}")):e}function s(e){return r(e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(e=>"\\x0"+n(e))).replace(/[\x10-\x1F\x7F-\x9F]/g,(e=>"\\x"+n(e))))}function o(e){return r(e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(e=>"\\x0"+n(e))).replace(/[\x10-\x1F\x7F-\x9F]/g,(e=>"\\x"+n(e))))}const a={literal:e=>'"'+s(e.text)+'"',class(e){const t=e.parts.map((e=>Array.isArray(e)?o(e[0])+"-"+o(e[1]):o(e)));return"["+(e.inverted?"^":"")+t.join("")+"]"+(e.unicode?"u":"")},any:()=>"any character",end:()=>"end of input",other:e=>e.description};function l(e){return a[e.type](e)}return"Expected "+function(e){const t=e.map(l);if(t.sort(),t.length>0){let e=1;for(let n=1;n<t.length;n++)t[n-1]!==t[n]&&(t[e]=t[n],e++);t.length=e}switch(t.length){case 1:return t[0];case 2:return t[0]+" or "+t[1];default:return t.slice(0,-1).join(", ")+", or "+t[t.length-1]}}(e)+" but "+function(e){return e?'"'+s(e)+'"':"end of input"}(t)+" found."}}function l(e,t){const n={},i=(t=void 0!==t?t:{}).grammarSource,r={start:le};let s=le;const o="none",l=",",u="grad",c="turn",d=/^[ \t\n\r]/,p=/^[a-z\-]/,f=/^[0-9a-fA-F]/,h=/^[+\-]/,m=/^[0-9]/,g=re("none"),y=ne("none",!1),v=ne(")",!1),b=ne(",",!1),x=ie([" ","\t","\n","\r"],!1,!1,!1),w=re("function"),C=ne("(",!1),S=re("identifier"),_=ie([["a","z"],"-"],!1,!1,!1),I=re("percentage"),T=ne("%",!1),M=re("length"),E=ne("px",!1),A=ne("cm",!1),L=ne("mm",!1),R=ne("in",!1),F=ne("pt",!1),P=ne("pc",!1),O=re("angle"),N=ne("deg",!1),k=ne("rad",!1),D=ne("grad",!1),B=ne("turn",!1),z=re("number"),V=re("color"),Z=ne("#",!1),$=ie([["0","9"],["a","f"],["A","F"]],!1,!1,!1),j=ie(["+","-"],!1,!1,!1),U=ie([["0","9"]],!1,!1,!1),G=ne(".",!1),W=ne("e",!1);function H(e,t){return t.length>0?function(e,t,n){return[e].concat(function(e,t){return e.map((function(e){return e[t]}))}(t,n))}(e,t,3):[e]}let Y=0|t.peg$currPos,q=Y;const J=[{line:1,column:1}];let X,K=Y,Q=t.peg$maxFailExpected||[],ee=0|t.peg$silentFails;if(t.startRule){if(!(t.startRule in r))throw new Error("Can't start parsing from rule \""+t.startRule+'".');s=r[t.startRule]}function te(){return e.substring(q,Y)}function ne(e,t){return{type:"literal",text:e,ignoreCase:t}}function ie(e,t,n,i){return{type:"class",parts:e,inverted:t,ignoreCase:n,unicode:i}}function re(e){return{type:"other",description:e}}function se(t){let n,i=J[t];if(i)return i;if(t>=J.length)n=J.length-1;else for(n=t;!J[--n];);for(i=J[n],i={line:i.line,column:i.column};n<t;)10===e.charCodeAt(n)?(i.line++,i.column=1):i.column++,n++;return J[t]=i,i}function oe(e,t,n){const r=se(e),s=se(t);return{source:i,start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:s.line,column:s.column}}}function ae(e){Y<K||(Y>K&&(K=Y,Q=[]),Q.push(e))}function le(){let e;return e=ue(),e===n&&(e=function(){let e,t;if(e=[],t=ce(),t!==n)for(;t!==n;)e.push(t),t=ce();else e=n;return e}()),e}function ue(){let t,i;return ee++,t=Y,pe(),e.substr(Y,4)===o?(i=o,Y+=4):(i=n,0===ee&&ae(y)),i!==n?(pe(),q=t,t=[]):(Y=t,t=n),ee--,t===n&&0===ee&&ae(g),t}function ce(){let t,i,r,s;return t=Y,pe(),i=function(){let t,i,r;return ee++,t=Y,i=fe(),i!==n?(40===e.charCodeAt(Y)?(r="(",Y++):(r=n,0===ee&&ae(C)),r!==n?(q=t,t=i):(Y=t,t=n)):(Y=t,t=n),ee--,t===n&&(i=n,0===ee&&ae(w)),t}(),i!==n?(pe(),r=function(){let t,i,r,s,o,a,u,c;if(t=Y,i=de(),i!==n){for(r=[],s=Y,o=pe(),44===e.charCodeAt(Y)?(a=l,Y++):(a=n,0===ee&&ae(b)),a===n&&(a=null),u=pe(),c=de(),c!==n?(o=[o,a,u,c],s=o):(Y=s,s=n);s!==n;)r.push(s),s=Y,o=pe(),44===e.charCodeAt(Y)?(a=l,Y++):(a=n,0===ee&&ae(b)),a===n&&(a=null),u=pe(),c=de(),c!==n?(o=[o,a,u,c],s=o):(Y=s,s=n);q=t,t=H(i,r)}else Y=t,t=n;return t}(),r===n&&(r=null),pe(),41===e.charCodeAt(Y)?(s=")",Y++):(s=n,0===ee&&ae(v)),s!==n?(pe(),q=t,t=function(e,t){return{type:"function",name:e,parameters:t||[]}}(i,r)):(Y=t,t=n)):(Y=t,t=n),t}function de(){let e,t;return e=Y,t=he(),t===n&&(t=me(),t===n&&(t=ge(),t===n&&(t=function(){let e,t;return ee++,e=Y,pe(),t=ve(),t!==n?(q=e,e=function(e){return{value:e,unit:null}}(t)):(Y=e,e=n),ee--,e===n&&0===ee&&ae(z),e}()))),t!==n&&(q=e,t=function(e){return{type:"quantity",value:e.value,unit:e.unit}}(t)),e=t,e===n&&(e=Y,t=ye(),t!==n&&(q=e,t=function(e){return{type:"color",colorType:e.type,value:e.value}}(t)),e=t),e}function pe(){let t,i;for(ee++,t=[],i=e.charAt(Y),d.test(i)?Y++:(i=n,0===ee&&ae(x));i!==n;)t.push(i),i=e.charAt(Y),d.test(i)?Y++:(i=n,0===ee&&ae(x));return ee--,t}function fe(){let t,i,r;if(ee++,t=Y,i=[],r=e.charAt(Y),p.test(r)?Y++:(r=n,0===ee&&ae(_)),r!==n)for(;r!==n;)i.push(r),r=e.charAt(Y),p.test(r)?Y++:(r=n,0===ee&&ae(_));else i=n;return i!==n&&(q=t,i=te()),t=i,ee--,t===n&&(i=n,0===ee&&ae(S)),t}function he(){let t,i,r;return ee++,t=Y,pe(),i=ve(),i!==n?(37===e.charCodeAt(Y)?(r="%",Y++):(r=n,0===ee&&ae(T)),r!==n?(q=t,t=function(e){return{value:e,unit:"%"}}(i)):(Y=t,t=n)):(Y=t,t=n),ee--,t===n&&0===ee&&ae(I),t}function me(){let t,i,r;return ee++,t=Y,pe(),i=ve(),i!==n?("px"===e.substr(Y,2)?(r="px",Y+=2):(r=n,0===ee&&ae(E)),r!==n?(q=t,t=function(e){return{value:e,unit:"px"}}(i)):(Y=t,t=n)):(Y=t,t=n),t===n&&(t=Y,pe(),i=ve(),i!==n?("cm"===e.substr(Y,2)?(r="cm",Y+=2):(r=n,0===ee&&ae(A)),r!==n?(q=t,t=function(e){return{value:e,unit:"cm"}}(i)):(Y=t,t=n)):(Y=t,t=n),t===n&&(t=Y,pe(),i=ve(),i!==n?("mm"===e.substr(Y,2)?(r="mm",Y+=2):(r=n,0===ee&&ae(L)),r!==n?(q=t,t=function(e){return{value:e,unit:"mm"}}(i)):(Y=t,t=n)):(Y=t,t=n),t===n&&(t=Y,pe(),i=ve(),i!==n?("in"===e.substr(Y,2)?(r="in",Y+=2):(r=n,0===ee&&ae(R)),r!==n?(q=t,t=function(e){return{value:e,unit:"in"}}(i)):(Y=t,t=n)):(Y=t,t=n),t===n&&(t=Y,pe(),i=ve(),i!==n?("pt"===e.substr(Y,2)?(r="pt",Y+=2):(r=n,0===ee&&ae(F)),r!==n?(q=t,t=function(e){return{value:e,unit:"pt"}}(i)):(Y=t,t=n)):(Y=t,t=n),t===n&&(t=Y,pe(),i=ve(),i!==n?("pc"===e.substr(Y,2)?(r="pc",Y+=2):(r=n,0===ee&&ae(P)),r!==n?(q=t,t=function(e){return{value:e,unit:"pc"}}(i)):(Y=t,t=n)):(Y=t,t=n)))))),ee--,t===n&&0===ee&&ae(M),t}function ge(){let t,i,r;return ee++,t=Y,i=ve(),i!==n?("deg"===e.substr(Y,3)?(r="deg",Y+=3):(r=n,0===ee&&ae(N)),r!==n?(q=t,t=function(e){return{value:e,unit:"deg"}}(i)):(Y=t,t=n)):(Y=t,t=n),t===n&&(t=Y,i=ve(),i!==n?("rad"===e.substr(Y,3)?(r="rad",Y+=3):(r=n,0===ee&&ae(k)),r!==n?(q=t,t=function(e){return{value:e,unit:"rad"}}(i)):(Y=t,t=n)):(Y=t,t=n),t===n&&(t=Y,i=ve(),i!==n?(e.substr(Y,4)===u?(r=u,Y+=4):(r=n,0===ee&&ae(D)),r!==n?(q=t,t=function(e){return{value:e,unit:"grad"}}(i)):(Y=t,t=n)):(Y=t,t=n),t===n&&(t=Y,i=ve(),i!==n?(e.substr(Y,4)===c?(r=c,Y+=4):(r=n,0===ee&&ae(B)),r!==n?(q=t,t=function(e){return{value:e,unit:"turn"}}(i)):(Y=t,t=n)):(Y=t,t=n)))),ee--,t===n&&(i=n,0===ee&&ae(O)),t}function ye(){let t,i,r,s;if(ee++,t=Y,35===e.charCodeAt(Y)?(i="#",Y++):(i=n,0===ee&&ae(Z)),i!==n){if(r=[],s=e.charAt(Y),f.test(s)?Y++:(s=n,0===ee&&ae($)),s!==n)for(;s!==n;)r.push(s),s=e.charAt(Y),f.test(s)?Y++:(s=n,0===ee&&ae($));else r=n;r!==n?(q=t,t={type:"hex",value:te()}):(Y=t,t=n)}else Y=t,t=n;return t===n&&(t=Y,i=ce(),i!==n&&(q=t,i=function(e){return{type:"function",value:e}}(i)),t=i,t===n&&(t=Y,i=fe(),i!==n&&(q=t,i={type:"named",value:te()}),t=i)),ee--,t===n&&(i=n,0===ee&&ae(V)),t}function ve(){let t,i,r,s,o,a,l,u;for(t=Y,i=e.charAt(Y),h.test(i)?Y++:(i=n,0===ee&&ae(j)),i===n&&(i=null),r=Y,s=[],o=e.charAt(Y),m.test(o)?Y++:(o=n,0===ee&&ae(U));o!==n;)s.push(o),o=e.charAt(Y),m.test(o)?Y++:(o=n,0===ee&&ae(U));if(46===e.charCodeAt(Y)?(o=".",Y++):(o=n,0===ee&&ae(G)),o!==n){if(a=[],l=e.charAt(Y),m.test(l)?Y++:(l=n,0===ee&&ae(U)),l!==n)for(;l!==n;)a.push(l),l=e.charAt(Y),m.test(l)?Y++:(l=n,0===ee&&ae(U));else a=n;a!==n?(s=[s,o,a],r=s):(Y=r,r=n)}else Y=r,r=n;if(r===n)if(r=[],s=e.charAt(Y),m.test(s)?Y++:(s=n,0===ee&&ae(U)),s!==n)for(;s!==n;)r.push(s),s=e.charAt(Y),m.test(s)?Y++:(s=n,0===ee&&ae(U));else r=n;if(r!==n){if(s=Y,101===e.charCodeAt(Y)?(o="e",Y++):(o=n,0===ee&&ae(W)),o!==n){if(a=e.charAt(Y),h.test(a)?Y++:(a=n,0===ee&&ae(j)),a===n&&(a=null),l=[],u=e.charAt(Y),m.test(u)?Y++:(u=n,0===ee&&ae(U)),u!==n)for(;u!==n;)l.push(u),u=e.charAt(Y),m.test(u)?Y++:(u=n,0===ee&&ae(U));else l=n;l!==n?(o=[o,a,l],s=o):(Y=s,s=n)}else Y=s,s=n;s===n&&(s=null),q=t,t=parseFloat(te())}else Y=t,t=n;return t}X=s();const be=X!==n&&Y===e.length;function xe(){throw X!==n&&Y<e.length&&ae({type:"end"}),function(e,t,n){return new a(a.buildMessage(e,t),e,t,n)}(Q,K<e.length?function(t=Y){const n=e.codePointAt(t);return void 0===n?"":String.fromCodePoint(n)}(K):null,K<e.length?oe(K,K+1):oe(K,K))}return t.peg$library?{peg$result:X,peg$currPos:Y,peg$FAILED:n,peg$maxFailExpected:Q,peg$maxFailPos:K,peg$success:be,peg$throw:be?void 0:xe}:be?X:void xe()}function u(e){if(!e||0===e.length)return null;if("string"==typeof e){const t=c(e);return t&&0!==t.length?t:null}const t=e.map((e=>{if(!Number.isFinite(e.scale)||e.scale<=0)throw new r.Z("effect:invalid-scale","scale must be finite and greater than 0",{stop:e});return{scale:e.scale,effects:c(e.value)}}));t.sort(((e,t)=>t.effects.length-e.effects.length));for(let e=0;e<t.length-1;e++){if(!(0,o.AS)(t[e].effects,t[e+1].effects))throw new r.Z("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:t[e].effects,b:t[e+1].effects});(0,o.uF)(t[e].effects,t[e+1].effects)}return t.sort(((e,t)=>t.scale-e.scale)),t}function c(e){let t;if(!e)return[];try{t=l(e)}catch(t){throw new r.Z("effect:invalid-syntax","Invalid effect syntax",{value:e,error:t})}return t.map((e=>function(e){try{switch(e.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return function(e){let t=1;return d(e.parameters,1),1===e.parameters.length&&(t=g(e.parameters[0])),new s.GI(e.name,t)}(e);case"opacity":return function(e){let t=1;return d(e.parameters,1),1===e.parameters.length&&(t=g(e.parameters[0])),new s.Zx(t)}(e);case"hue-rotate":return function(e){let t=0;return d(e.parameters,1),1===e.parameters.length&&(t=function(e){return function(e){if("quantity"!==e.type||!(0===e.value&&null===e.unit||e.unit&&null!=h[e.unit]))throw new r.Z("effect:type-error",`Expected <angle>, Actual: ${p(e)}`,{term:e})}(e),e.value*h[e.unit]||0}(e.parameters[0])),new s.Tq(t)}(e);case"blur":return function(e){let t=0;return d(e.parameters,1),1===e.parameters.length&&(t=v(e.parameters[0]),f(t,e.parameters[0])),new s.Tj(t)}(e);case"drop-shadow":return function(e){const t=[];let n=null;for(const i of e.parameters)if("color"===i.type){if(t.length&&Object.freeze(t),n)throw new r.Z("effect:type-error","Accepts only one color",{});n=b(i)}else{const e=v(i);if(Object.isFrozen(t))throw new r.Z("effect:type-error","<length> parameters not consecutive",{lengths:t});t.push(e),3===t.length&&f(e,i)}if(t.length<2||t.length>3)throw new r.Z("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${t.length}}`,{lengths:t});return new s.CE(t[0],t[1],t[2]||0,n||x("black"))}(e);case"bloom":return function(e){let t=1,n=0,i=0;return d(e.parameters,3),e.parameters[0]&&(t=g(e.parameters[0])),e.parameters[1]&&(n=v(e.parameters[1]),f(n,e.parameters[1])),e.parameters[2]&&(i=g(e.parameters[2])),new s.rk(t,n,i)}(e)}}catch(t){throw t.details.filter=e,t}throw new r.Z("effect:unknown-effect",`Effect '${e.name}' is not supported`,{effect:e})}(e)))}function d(e,t){if(e.length>t)throw new r.Z("effect:type-error",`Function supports up to ${t} parameters, Actual: ${e.length}`,{parameters:e})}function p(e){if("color"===e.type)return"<color>";if(e.unit){if(e.unit in m)return"<length>";if(e.unit in h)return"<angle>";if("%"===e.unit)return"<percentage>"}return"<double>"}function f(e,t){if(e<0)throw new r.Z("effect:type-error",`Negative values are not allowed, Actual: ${e}`,{term:t})}const h={deg:1,grad:.9,rad:180/Math.PI,turn:360};const m={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function g(e){!function(e){if("quantity"!==e.type||null!==e.unit&&"%"!==e.unit)throw new r.Z("effect:type-error",`Expected <double> or <percentage>, Actual: ${p(e)}`,{term:e})}(e);const t=e.value;return f(t,e),"%"===e.unit?.01*t:t}function y(e){return function(e){if("quantity"!==e.type||null!==e.unit)throw new r.Z("effect:type-error",`Expected <double>, Actual: ${p(e)}`,{term:e})}(e),f(e.value,e),e.value}function v(e){return function(e){if("quantity"!==e.type||!(0===e.value&&null===e.unit||e.unit&&null!=m[e.unit]))throw new r.Z("effect:type-error",`Expected <length>, Actual: ${p(e)}`,{term:e})}(e),e.value*m[e.unit]||0}function b(e){switch(e.colorType){case"hex":return(0,i.a7)(e.value);case"named":return x(e.value);case"function":return function(e){if(d(e.parameters,4),w.test(e.name))return[g(e.parameters[0]),g(e.parameters[1]),g(e.parameters[2]),e.parameters[3]?g(e.parameters[3]):1];if(C.test(e.name))return(0,i.Y6)(y(e.parameters[0]),g(e.parameters[1]),g(e.parameters[2]),e.parameters[3]?g(e.parameters[3]):1);throw new r.Z("effect:syntax-error",`Invalid color function '${e.name}'`,{colorFunction:e})}(e.value)}}function x(e){if(!(0,i.St)(e))throw new r.Z("effect:unknown-color",`color '${e}' isn't valid`,{namedColor:e});return(0,i.VL)(e)}const w=/^rgba?/i,C=/^hsla?/i},15083:function(e,t,n){function i(e,t){switch(t.type){case"object-id":case"unique-id-simple":return e.attributes[t.fieldName];case"unique-id-composite":{const n=[];for(const i of t.fieldNames)n.push(e.attributes[i]??null);return JSON.stringify(n)}}}function r(e,t){if("uniqueIdFields"in t&&t.uniqueIdFields?.length){if(1===t.uniqueIdFields.length)return e.attributes?.[t.uniqueIdFields[0]];const n=t.uniqueIdFields.map((t=>e.attributes?.[t]));return JSON.stringify(n)}return"objectIdField"in t&&t.objectIdField?e.attributes?.[t.objectIdField]:null}n.d(t,{C:function(){return i},v:function(){return r}})},83263:function(e,t,n){n.d(t,{h7:function(){return d},nE:function(){return l},qu:function(){return c}});var i=n(73440),r=n(17155),s=(n(61432),n(96711),n(83850),n(48023)),o=n(71840),a=n(615);const l={type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:{layerContainerTypes:o.C}},"portal-item":{read:!0,write:{layerContainerTypes:o.C}}}}},u={read:{reader:a.ij},write:{allowNull:!0,writer:a.cW,layerContainerTypes:o.C}},c={json:{read:!1,write:!1,origins:{"web-map":u,"portal-item":u}}},d=e=>{let t=class extends e{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return(0,i._)([(0,r.Cb)(l)],t.prototype,"blendMode",void 0),(0,i._)([(0,r.Cb)(c)],t.prototype,"effect",void 0),t=(0,i._)([(0,s.j)("esri.layers.mixins.BlendLayer")],t),t}},55591:function(e,t,n){n.d(t,{N:function(){return o}});var i=n(73440),r=n(17155),s=(n(61432),n(96711),n(83850),n(48023));const o=e=>{let t=class extends e{constructor(){super(...arguments),this.customParameters=null}};return(0,i._)([(0,r.Cb)({type:Object,json:{write:{overridePolicy:e=>({enabled:!!(e&&Object.keys(e).length>0)})}}})],t.prototype,"customParameters",void 0),t=(0,i._)([(0,s.j)("esri.layers.mixins.CustomParametersMixin")],t),t}},27202:function(e,t,n){n.d(t,{I:function(){return C}});var i=n(73440),r=n(81001),s=n(10218),o=n(78619),a=n(29292),l=n(88194),u=n(96711),c=n(61100),d=n(93568),p=n(95490),f=n(17155),h=(n(61432),n(83850),n(1194)),m=n(48023),g=n(29884),y=n(75428),v=n(77601),b=n(96193),x=n(91525),w=n(47626);const C=e=>{let t=class extends e{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,c.SC)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(e){e!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",e))}readPortalItem(e,t,n){if(t.itemId)return new b.default({id:t.itemId,portal:n?.portal})}writePortalItem(e,t){e?.id&&(t.itemId=e.id)}async loadFromPortal(e,t){if(this.portalItem?.id)try{const{load:i}=await n.e(64975).then(n.bind(n,64975));return(0,d.k_)(t),await i({instance:this,supportedTypes:e.supportedTypes,validateItem:e.validateItem,supportsData:e.supportsData,layerModuleTypeMap:e.layerModuleTypeMap,populateGroupLayer:e.populateGroupLayer},t)}catch(e){throw(0,d.D_)(e)||u.Z.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})\n  ${e}`),e}}async finishLoadEditablePortalLayer(e){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(e).catch((e=>((0,d.r9)(e),!0))))}async setUserPrivileges(e,t){if(!r.default.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(t);if(this.url)try{const{features:{edit:n,fullEdit:i},content:{updateItem:r}}=await this._fetchUserPrivileges(e,t);this._set("userHasEditingPrivileges",n),this._set("userHasFullEditingPrivileges",i),this._set("userHasUpdateItemPrivileges",r)}catch(e){(0,d.r9)(e)}}async _fetchUserPrivileges(e,t){let n=this.portalItem;if(!e||!n||!n.loaded||n.sourceUrl)return this._fetchFallbackUserPrivileges(t);const i=!s.id?.findCredential(this.url),r=e===n.id;if(r&&n.portal.user)return this._getUserPrivileges(n,i);let o,a;if(r)o=n.portal.url;else try{o=await(0,y.oP)(this.url,t)}catch(e){(0,d.r9)(e)}if(!o||!(0,p.Zo)(o,n.portal.url))return this._fetchFallbackUserPrivileges(t);try{const e=null!=t?t.signal:null;a=await(s.id?.getCredential(`${o}/sharing`,{prompt:!1,signal:e}))}catch(e){(0,d.r9)(e)}if(!a)return{features:{edit:true,fullEdit:false},content:{updateItem:false}};try{if(r?await n.reload():(n=new b.default({id:e,portal:{url:o}}),await n.load(t)),n.portal.user)return this._getUserPrivileges(n,i)}catch(e){(0,d.r9)(e)}return{features:{edit:true,fullEdit:false},content:{updateItem:false}}}_getUserPrivileges(e,t){const n=(0,w.Ss)(e);return t&&(n.features.edit=!0),n}async _fetchFallbackUserPrivileges(e){let t=!0;try{t=await this._fetchUserHasEditingPrivileges(e)}catch(e){(0,d.r9)(e)}return{features:{edit:t,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(e){const t=this.url?s.id?.findCredential(this.url):null;if(!t)return!0;const n=S.credential===t?S.user:await this._fetchEditingUser(e);return S.credential=t,S.user=n,null==n?.privileges||n.privileges.includes("features:user:edit")}async _fetchEditingUser(e){const t=this.portalItem?.portal?.user;if(t)return t;const n=s.id?.findServerInfo(this.url??"");if(!n?.owningSystemUrl)return null;const i=`${n.owningSystemUrl}/sharing/rest`,r=v.Z.getDefault();if(r&&r.loaded&&(0,p.Fv)(r.restUrl)===(0,p.Fv)(i))return r.user;const l=`${i}/community/self`,u=null!=e?e.signal:null,c=await(0,a.q6)((0,o.Z)(l,{authMode:"no-prompt",query:{f:"json"},signal:u}));return c.ok?x.Z.fromJSON(c.value.data):null}read(e,t){t&&(t.layer=this),super.read(e,t)}write(e,t){const n=t?.portal,i=this.portalItem?.id&&(this.portalItem.portal||v.Z.getDefault());return n&&i&&!(0,p.tm)(i.restUrl,n.restUrl)?(t.messages&&t.messages.push(new l.Z("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(e,{...t,layer:this})}};return(0,i._)([(0,f.Cb)({type:b.default})],t.prototype,"portalItem",null),(0,i._)([(0,h.r)("web-document","portalItem",["itemId"])],t.prototype,"readPortalItem",null),(0,i._)([(0,g.c)("web-document","portalItem",{itemId:{type:String}})],t.prototype,"writePortalItem",null),(0,i._)([(0,f.Cb)({clonable:!1})],t.prototype,"resourceReferences",void 0),(0,i._)([(0,f.Cb)({type:Boolean,readOnly:!0})],t.prototype,"userHasEditingPrivileges",void 0),(0,i._)([(0,f.Cb)({type:Boolean,readOnly:!0})],t.prototype,"userHasFullEditingPrivileges",void 0),(0,i._)([(0,f.Cb)({type:Boolean,readOnly:!0})],t.prototype,"userHasUpdateItemPrivileges",void 0),t=(0,i._)([(0,m.j)("esri.layers.mixins.PortalLayer")],t),t},S={credential:null,user:null}},19306:function(e,t,n){n.d(t,{Q:function(){return w},d:function(){return x}});var i=n(73440),r=(n(61432),n(96711)),s=n(93568),o=n(17155),a=n(90775),l=(n(83850),n(48023)),u=n(71840),c=n(43254),d=n(90403),p=n(21260);const f=new c.Z,h=new WeakMap;function m(e){return null!=e&&"object"==typeof e&&"refreshInterval"in e&&"refresh"in e}function g(e,t){return Number.isFinite(e)&&Number.isFinite(t)?t<=0?e:g(t,e%t):0}let y=0,v=0;function b(){const e=Date.now();let t=!1;for(const n of f){const i=n.deref();i?i.refreshInterval&&e-(h.get(i)??0)+5>=6e4*i.refreshInterval&&(h.set(i,e),i.refresh(e)):t=!0}if(t)for(let e=f.length-1;e>=0;e--)f.at(e).deref()||f.removeAt(e)}(0,p.EH)((()=>{const e=Date.now();let t=0;for(const n of f){const i=n.deref();i&&(t=g(Math.round(6e4*i.refreshInterval),t),i.refreshInterval?h.get(i)||h.set(i,e):h.delete(i))}if(t!==v){if(v=t,clearInterval(y),0===v)return void(y=0);y=setInterval(b,v)}}),d.Z_);function x(e){return null!=e&&"object"==typeof e&&"refreshTimestamp"in e&&"refresh"in e}const w=e=>{let t=class extends e{constructor(...e){super(...e),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=(0,s.Ds)((()=>this.hasDataChanged())),this.when().then((()=>{this.destroyed||function(e){m(e)&&f.push(new WeakRef(e))}(this)}),(()=>{}))}destroy(){!function(e){const t=f.find((t=>t.deref()===e));t&&f.remove(t)}(this)}castRefreshInterval(e){return e>=.1?e:e<=0?0:.1}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(e=Date.now()){(0,s.R8)(this._debounceHasDataChanged()).then((t=>{t&&this._set("refreshTimestamp",e),this.emit("refresh",{dataChanged:t})}),(e=>{r.Z.getLogger(this).error(e),this.emit("refresh",{dataChanged:!1,error:e})}))}async hasDataChanged(){return!0}get test(){}};return(0,i._)([(0,o.Cb)({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:u.C}}}}})],t.prototype,"refreshInterval",void 0),(0,i._)([(0,a.p)("refreshInterval")],t.prototype,"castRefreshInterval",null),(0,i._)([(0,o.Cb)({readOnly:!0})],t.prototype,"refreshTimestamp",void 0),(0,i._)([(0,o.Cb)({readOnly:!0})],t.prototype,"refreshParameters",null),t=(0,i._)([(0,l.j)("esri.layers.mixins.RefreshableLayer")],t),t}},3752:function(e,t,n){n.d(t,{M:function(){return o}});var i=n(73440),r=n(17155),s=(n(61432),n(96711),n(83850),n(48023));const o=e=>{let t=class extends e{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const e={minScale:this.minScale,maxScale:this.maxScale},t=this.parent;t&&"effectiveScaleRange"in t&&function(e,t){e.minScale=e.minScale>0?t.minScale>0?Math.min(e.minScale,t.minScale):e.minScale:t.minScale,e.maxScale=e.maxScale>0?t.maxScale>0?Math.max(e.maxScale,t.maxScale):e.maxScale:t.maxScale}(e,t.effectiveScaleRange);const n=this._get("effectiveScaleRange");return n&&n.minScale===e.minScale&&n.maxScale===e.maxScale?n:e}};return(0,i._)([(0,r.Cb)({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"minScale",void 0),(0,i._)([(0,r.Cb)({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"maxScale",void 0),(0,i._)([(0,r.Cb)({readOnly:!0})],t.prototype,"effectiveScaleRange",null),t=(0,i._)([(0,s.j)("esri.layers.mixins.ScaleRangeLayer")],t),t}},99671:function(e,t,n){n.d(t,{I:function(){return f},n:function(){return h}});var i=n(73440),r=n(17155),s=(n(61432),n(96711),n(83850),n(1194)),o=n(48023),a=n(71840),l=n(76554),u=n(83918),c=n(24009),d=n(85913),p=n(62920);const f={type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation",layerContainerTypes:a.C}}},h=e=>{let t=class extends e{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(e,t){const n=t.timeInfo.exportOptions;if(!n)return null;const i=n.timeOffset,r=c.v.fromJSON(n.timeOffsetUnits);return i&&r?new p.T({value:i,unit:r}):null}set timeInfo(e){(0,l.UF)(e,this.fieldsIndex),this._set("timeInfo",e)}};return(0,i._)([(0,r.Cb)({type:d.T,json:{write:!1}})],t.prototype,"timeExtent",void 0),(0,i._)([(0,r.Cb)({type:p.T})],t.prototype,"timeOffset",void 0),(0,i._)([(0,s.r)("service","timeOffset",["timeInfo.exportOptions"])],t.prototype,"readOffset",null),(0,i._)([(0,r.Cb)({value:null,type:u.Z,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],t.prototype,"timeInfo",null),(0,i._)([(0,r.Cb)(f)],t.prototype,"useViewTime",void 0),t=(0,i._)([(0,o.j)("esri.layers.mixins.TemporalLayer")],t),t}},62065:function(e,t,n){n.d(t,{A:function(){return r}});const i=[[3819,3819],[3821,3824],[3889,3889],[3906,3906],[4001,4025],[4027,4036],[4039,4047],[4052,4055],[4074,4075],[4080,4081],[4120,4176],[4178,4185],[4188,4216],[4218,4289],[4291,4304],[4306,4319],[4322,4326],[4463,4463],[4470,4470],[4475,4475],[4483,4483],[4490,4490],[4555,4558],[4600,4646],[4657,4765],[4801,4811],[4813,4821],[4823,4824],[4901,4904],[5013,5013],[5132,5132],[5228,5229],[5233,5233],[5246,5246],[5252,5252],[5264,5264],[5324,5340],[5354,5354],[5360,5360],[5365,5365],[5370,5373],[5381,5381],[5393,5393],[5451,5451],[5464,5464],[5467,5467],[5489,5489],[5524,5524],[5527,5527],[5546,5546],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3038,3051],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3150,3151],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3389,3390],[3416,3417],[3833,3841],[3844,3850],[3854,3854],[3873,3885],[3907,3910],[4026,4026],[4037,4038],[4417,4417],[4434,4434],[4491,4554],[4839,4839],[5048,5048],[5105,5130],[5253,5259],[5269,5275],[5343,5349],[5479,5482],[5518,5519],[5520,5520],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]];function r(e){return null!=e&&i.some((([t,n])=>e>=t&&e<=n))}},41964:function(e,t,n){n.d(t,{u:function(){return l}});var i,r=n(73440),s=n(63255),o=n(17155),a=(n(61432),n(96711),n(83850),n(48023));let l=i=class extends s.Z{constructor(e){super(e),this.name=null,this.code=null}clone(){return new i({name:this.name,code:this.code})}};(0,r._)([(0,o.Cb)({type:String,json:{write:{isRequired:!0}}})],l.prototype,"name",void 0),(0,r._)([(0,o.Cb)({type:[String,Number],json:{write:{isRequired:!0}}})],l.prototype,"code",void 0),l=i=(0,r._)([(0,a.j)("esri.layers.support.CodedValue")],l)},37127:function(e,t,n){n.d(t,{Z:function(){return d}});var i,r=n(73440),s=n(28947),o=n(17155),a=(n(61432),n(96711),n(79775)),l=n(48023),u=n(41964),c=n(85853);let d=class extends c.Z{static{i=this}constructor(e){super(e),this.codedValues=null,this.type="coded-value"}getName(e){let t=null;if(this.codedValues){const n=String(e);this.codedValues.some((e=>(String(e.code)===n&&(t=e.name),!!t)))}return t}clone(){return new i({codedValues:(0,s.d9)(this.codedValues),name:this.name})}};(0,r._)([(0,o.Cb)({type:[u.u],json:{write:{isRequired:!0}}})],d.prototype,"codedValues",void 0),(0,r._)([(0,a.J)({codedValue:"coded-value"})],d.prototype,"type",void 0),d=i=(0,r._)([(0,l.j)("esri.layers.support.CodedValueDomain")],d)},85853:function(e,t,n){n.d(t,{Z:function(){return c}});var i=n(73440),r=n(41773),s=n(63255),o=n(17155),a=(n(61432),n(96711),n(83850),n(79775)),l=n(48023);const u=new r.X({inherited:"inherited",codedValue:"coded-value",range:"range"});let c=class extends s.Z{constructor(e){super(e),this.name=null,this.type=null}};(0,i._)([(0,o.Cb)({type:String,json:{write:!0}})],c.prototype,"name",void 0),(0,i._)([(0,a.J)(u),(0,o.Cb)({json:{write:{isRequired:!0}}})],c.prototype,"type",void 0),c=(0,i._)([(0,l.j)("esri.layers.support.Domain")],c)},49651:function(e,t,n){n.d(t,{Z:function(){return m}});var i,r=n(73440),s=n(41773),o=n(63255),a=n(17155),l=n(95226),u=(n(61432),n(83850),n(79775)),c=n(1194),d=n(48023),p=n(76746),f=n(72396);const h=new s.X({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let m=class extends o.Z{static{i=this}constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(e,{description:t}){let n=null;try{n=t?JSON.parse(t):null}catch(e){}return n?.value??null}readValueType(e,{description:t}){let n=null;try{n=t?JSON.parse(t):null}catch(e){}return n?h.fromJSON(n.fieldValueType):null}clone(){return new i({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain?.clone()??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};(0,r._)([(0,a.Cb)({type:String,json:{write:!0}})],m.prototype,"alias",void 0),(0,r._)([(0,a.Cb)({type:[String,Number],json:{write:{allowNull:!0}}})],m.prototype,"defaultValue",void 0),(0,r._)([(0,a.Cb)()],m.prototype,"description",void 0),(0,r._)([(0,c.r)("description")],m.prototype,"readDescription",null),(0,r._)([(0,a.Cb)({types:p.V5,json:{read:{reader:p.im},write:!0}})],m.prototype,"domain",void 0),(0,r._)([(0,a.Cb)({type:Boolean,json:{write:!0}})],m.prototype,"editable",void 0),(0,r._)([(0,a.Cb)({type:l.z8,json:{write:{overridePolicy:e=>({enabled:Number.isFinite(e)})}}})],m.prototype,"length",void 0),(0,r._)([(0,a.Cb)({type:String,json:{write:!0}})],m.prototype,"name",void 0),(0,r._)([(0,a.Cb)({type:Boolean,json:{write:!0}})],m.prototype,"nullable",void 0),(0,r._)([(0,u.J)(f.v)],m.prototype,"type",void 0),(0,r._)([(0,a.Cb)()],m.prototype,"valueType",void 0),(0,r._)([(0,c.r)("valueType",["description"])],m.prototype,"readValueType",null),(0,r._)([(0,a.Cb)({type:Boolean,json:{read:!1}})],m.prototype,"visible",void 0),m=i=(0,r._)([(0,d.j)("esri.layers.support.Field")],m)},39502:function(e,t,n){n.d(t,{Z:function(){return l}});var i,r=n(73440),s=(n(96711),n(61432),n(83850),n(88194),n(79775)),o=n(48023),a=n(85853);let l=class extends a.Z{static{i=this}constructor(e){super(e),this.type="inherited"}clone(){return new i}};(0,r._)([(0,s.J)({inherited:"inherited"})],l.prototype,"type",void 0),l=i=(0,r._)([(0,o.j)("esri.layers.support.InheritedDomain")],l)},95951:function(e,t,n){n.d(t,{Z:function(){return u}});var i,r=n(73440),s=n(17155),o=(n(61432),n(96711),n(83850),n(79775)),a=n(48023),l=n(85853);let u=class extends l.Z{static{i=this}constructor(e){super(e),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new i({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};(0,r._)([(0,s.Cb)({json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range?.[1]},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(e,t,n){t[n]=[this.minValue||0,e]},isRequired:!0}}})],u.prototype,"maxValue",void 0),(0,r._)([(0,s.Cb)({json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range?.[0]},write:{target:"range",writer(e,t,n){t[n]=[e,this.maxValue||0]},isRequired:!0}}})],u.prototype,"minValue",void 0),(0,r._)([(0,o.J)({range:"range"})],u.prototype,"type",void 0),u=i=(0,r._)([(0,a.j)("esri.layers.support.RangeDomain")],u)},83918:function(e,t,n){n.d(t,{Z:function(){return h}});var i=n(73440),r=n(89314),s=n(63255),o=n(17155),a=(n(61432),n(96711),n(83850),n(1194)),l=n(48023),u=n(29884),c=n(85913),d=n(62920),p=n(88097);function f(e,t){return d.T.fromJSON({value:e,unit:t})}let h=class extends(r.Z.ClonableMixin(s.Z)){constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeZone=null,this.trackIdField=null,this.useTime=!0,this.stops=null}readFullTimeExtent(e,t){return t.timeExtent&&Array.isArray(t.timeExtent)&&2===t.timeExtent.length?c.T.fromArray(t.timeExtent):null}writeFullTimeExtent(e,t){null!=e?.start&&null!=e.end?t.timeExtent=e.toArray():t.timeExtent=null}readInterval(e,t){return t.timeInterval&&t.timeIntervalUnits?f(t.timeInterval,t.timeIntervalUnits):t.defaultTimeInterval&&t.defaultTimeIntervalUnits?f(t.defaultTimeInterval,t.defaultTimeIntervalUnits):null}writeInterval(e,t){t.timeInterval=e?.toJSON().value??null,t.timeIntervalUnits=e?.toJSON().unit??null}};(0,i._)([(0,o.Cb)({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],h.prototype,"cumulative",void 0),(0,i._)([(0,o.Cb)({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],h.prototype,"endField",void 0),(0,i._)([(0,o.Cb)({type:c.T,json:{write:{enabled:!0,allowNull:!0}}})],h.prototype,"fullTimeExtent",void 0),(0,i._)([(0,a.r)("fullTimeExtent",["timeExtent"])],h.prototype,"readFullTimeExtent",null),(0,i._)([(0,u.c)("fullTimeExtent")],h.prototype,"writeFullTimeExtent",null),(0,i._)([(0,o.Cb)({type:Boolean,json:{write:!0}})],h.prototype,"hasLiveData",void 0),(0,i._)([(0,o.Cb)({type:d.T,json:{write:{enabled:!0,allowNull:!0}}})],h.prototype,"interval",void 0),(0,i._)([(0,a.r)("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],h.prototype,"readInterval",null),(0,i._)([(0,u.c)("interval")],h.prototype,"writeInterval",null),(0,i._)([(0,o.Cb)({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],h.prototype,"startField",void 0),(0,i._)([(0,o.Cb)((0,p.mi)("timeReference",!0))],h.prototype,"timeZone",void 0),(0,i._)([(0,o.Cb)({type:String,json:{write:{enabled:!0,allowNull:!0}}})],h.prototype,"trackIdField",void 0),(0,i._)([(0,o.Cb)({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],h.prototype,"useTime",void 0),(0,i._)([(0,o.Cb)({type:[Date],json:{read:!1}})],h.prototype,"stops",void 0),h=(0,i._)([(0,l.j)("esri.layers.support.TimeInfo")],h)},76746:function(e,t,n){n.d(t,{V5:function(){return a},im:function(){return l}});n(61432);var i=n(37127),r=n(85853),s=n(39502),o=n(95951);const a={key:"type",base:r.Z,typeMap:{range:o.Z,"coded-value":i.Z,inherited:s.Z}};function l(e){if(!e?.type)return null;switch(e.type){case"range":return o.Z.fromJSON(e);case"codedValue":return i.Z.fromJSON(e);case"inherited":return s.Z.fromJSON(e)}return null}},72396:function(e,t,n){n.d(t,{v:function(){return i}});const i=new(n(41773).X)({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"})},47626:function(e,t,n){n.d(t,{$o:function(){return d},Fj:function(){return l},IW:function(){return c},Ss:function(){return f},_$:function(){return a},ck:function(){return u},hz:function(){return p},qj:function(){return o}});var i=n(13132),r=n(45213),s=n(97290);function o(e,t){if(!a(e,t)){const n=e.typeKeywords;n?n.push(t):e.typeKeywords=[t]}}function a(e,t){return!!e.typeKeywords?.includes(t)}function l(e){return a(e,p.HOSTED_SERVICE)}function u(e,t){const n=e.typeKeywords;if(n){const e=n.indexOf(t);e>-1&&n.splice(e,1)}}function c(e,t,n){n?o(e,t):u(e,t)}async function d(e){const t=e.clone().normalize();let n;if(t.length>1)for(const e of t)n?e.width>n.width&&(n=e):n=e;else n=t[0];return async function(e){const t=e.spatialReference;if(t.isWGS84)return e.clone();if(t.isWebMercator)return(0,s.Sx)(e);const n=r.Z.WGS84;return await(0,i.initializeProjection)(t,n),(0,i.project)(e,n)}(n)}const p={CHARTS:"Charts",DYNAMIC:"Dynamic",DEVELOPER_BASEMAP:"DeveloperBasemap",GROUP_LAYER_MAP:"Map",HOSTED_SERVICE:"Hosted Service",JSAPI:"ArcGIS API for JavaScript",LOCAL_SCENE:"ViewingMode-Local",METADATA:"Metadata",MULTI_LAYER:"Multilayer",ORIENTED_IMAGERY_LAYER:"OrientedImageryLayer",SINGLE_LAYER:"Singlelayer",SUBTYPE_GROUP_LAYER:"SubtypeGroupLayer",SUBTYPE_GROUP_TABLE:"SubtypeGroupTable",TABLE:"Table",TILED_IMAGERY:"Tiled Imagery"};function f(e){const{portal:t,isOrgItem:n,itemControl:i}=e,r=t.user?.privileges;let s=!r||r.includes("features:user:edit"),o=!!n&&!!r?.includes("features:user:fullEdit");const a="update"===i||"admin"===i;return a?o=s=!0:o&&(s=!0),{features:{edit:s,fullEdit:o},content:{updateItem:a}}}},24009:function(e,t,n){n.d(t,{v:function(){return i}});const i=(0,n(41773).w)()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0})},22225:function(e,t,n){n.d(t,{Z:function(){return M}});var i,r=n(73440),s=n(41773),o=n(28947),a=n(96711),l=n(17155),u=n(90775),c=n(79775),d=n(1194),p=n(48023),f=n(29884),h=n(95226),m=n(76554),g=n(69258),y=n(23298),v=n(58968),b=n(31186),x=n(29032),w=n(3411),C=n(68578);const S="percent-of-total",_="field",I=new s.X({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:S,esriNormalizeByField:_}),T=(0,h.se)(v.Z);let M=i=class extends((0,y.W)(g.Z)){constructor(e){super(e),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(e,t,n){if(!Array.isArray(e))return;let i=t.minValue;return e.map((e=>{const t=new v.Z;return t.read(e,n),null==t.minValue&&(t.minValue=i),null==t.maxValue&&(t.maxValue=t.minValue),i=t.maxValue,t}))}writeClassBreakInfos(e,t,n,i){const r=e.map((e=>e.write({},i)));this._areClassBreaksConsecutive()&&r.forEach((e=>delete e.classMinValue)),t[n]=r}castField(e){return null==e?e:"function"==typeof e?(a.Z.getLogger(this).error(".field: field must be a string value"),null):(0,h.Zs)(e)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let e=this._get("normalizationType");const t=!!this.normalizationField,n=null!=this.normalizationTotal;return t||n?(e=t&&_||n&&S||null,t&&n&&a.Z.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):e!==_&&e!==S||(e=null),e}set normalizationType(e){this._set("normalizationType",e)}addClassBreakInfo(e,t,n){let i=null;i="number"==typeof e?new v.Z({minValue:e,maxValue:t,symbol:(0,C.se)(n)}):T((0,o.d9)(e)),this.classBreakInfos.push(i),1===this.classBreakInfos.length&&this.notifyChange("minValue")}removeClassBreakInfo(e,t){const n=this.classBreakInfos.length;for(let i=0;i<n;i++){const n=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(n[0]===e&&n[1]===t){this.classBreakInfos.splice(i,1);break}}}getBreakIndex(e,t){return this.valueExpression&&null==t?.arcade&&a.Z.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(e,t):this._getBreakIndexForField(e)}async getClassBreakInfo(e,t){let n=t;this.valueExpression&&null==t?.arcade&&(n={...n,arcade:await(0,w.L)()});const i=this.getBreakIndex(e,n);return-1!==i?this.classBreakInfos[i]:null}getSymbol(e,t){if(this.valueExpression&&null==t?.arcade)return void a.Z.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const n=this.getBreakIndex(e,t);return n>-1?this.classBreakInfos[n].symbol:this.defaultSymbol}async getSymbolAsync(e,t){let n=t;if(this.valueExpression&&null==t?.arcade){const e=await(0,w.L)(),{arcadeUtils:t}=e;t.hasGeometryOperations(this.valueExpression)&&await t.enableGeometryOperations(),n={...n,arcade:e}}const i=this.getBreakIndex(e,n);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}get symbols(){const e=[];return this.classBreakInfos.forEach((t=>{t.symbol&&e.push(t.symbol)})),this.defaultSymbol&&e.push(this.defaultSymbol),e}getAttributeHash(){return this.visualVariables?.reduce(((e,t)=>e+t.getAttributeHash()),"")??""}getMeshHash(){const e=JSON.stringify(this.backgroundFillSymbol),t=JSON.stringify(this.defaultSymbol),n=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${e}.${t}.${this.classBreakInfos.reduce(((e,t)=>e+t.getMeshHash()),"")}.${n}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){return new i({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol?.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol?.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:(0,o.d9)(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:(0,o.d9)(this.visualVariables),legendOptions:(0,o.d9)(this.legendOptions),authoringInfo:(0,o.d9)(this.authoringInfo)})}async collectRequiredFields(e,t){const n=[this.collectVVRequiredFields(e,t),this.collectSymbolFields(e,t)];await Promise.all(n)}async collectSymbolFields(e,t){const n=[...this.symbols.map((n=>n.collectRequiredFields(e,t))),(0,m.io)(e,t,this.valueExpression)];(0,m.AB)(e,t,this.field),(0,m.AB)(e,t,this.normalizationField),await Promise.all(n)}_getBreakIndexForExpression(e,t){const{viewingMode:n,scale:i,spatialReference:r,arcade:s,timeZone:o}=t??{},{valueExpression:a}=this;let l=this._compiledValueExpression.valueExpression===a?this._compiledValueExpression.compiledFunction:null;const u=s.arcadeUtils;if(!l){const e=u.createSyntaxTree(a);l=u.createFunction(e),this._compiledValueExpression.compiledFunction=l}this._compiledValueExpression.valueExpression=a;const c=u.executeFunction(l,u.createExecContext(e,u.getViewInfo({viewingMode:n,scale:i,spatialReference:r}),o));return this._getBreakIndexfromInfos(c)}_getBreakIndexForField(e){const t=this.field,n=e.attributes,i=this.normalizationType;let r=parseFloat(n[t]);if(i){const e=this.normalizationTotal,t=parseFloat(this.normalizationField?n[this.normalizationField]:void 0);if("log"===i)r=Math.log(r)*Math.LOG10E;else if(i!==S||null==e||isNaN(e)){if(i===_&&!isNaN(t)){if(isNaN(r)||isNaN(t))return-1;r/=t}}else r=r/e*100}return this._getBreakIndexfromInfos(r)}_getBreakIndexfromInfos(e){const t=this.isMaxInclusive;if(null!=e&&"number"==typeof e&&!isNaN(e))for(let n=0;n<this.classBreakInfos.length;n++){const i=[this.classBreakInfos[n].minValue,this.classBreakInfos[n].maxValue];if(i[0]<=e&&(t?e<=i[1]:e<i[1]))return n}return-1}_areClassBreaksConsecutive(){const e=this.classBreakInfos,t=e.length;for(let n=1;n<t;n++)if(e[n-1].maxValue!==e[n].minValue)return!1;return!0}};(0,r._)([(0,l.Cb)(b.KK)],M.prototype,"backgroundFillSymbol",void 0),(0,r._)([(0,l.Cb)({type:[v.Z],json:{write:{isRequired:!0}}})],M.prototype,"classBreakInfos",void 0),(0,r._)([(0,d.r)("classBreakInfos")],M.prototype,"readClassBreakInfos",null),(0,r._)([(0,f.c)("classBreakInfos")],M.prototype,"writeClassBreakInfos",null),(0,r._)([(0,l.Cb)({type:String,json:{write:!0}})],M.prototype,"defaultLabel",void 0),(0,r._)([(0,l.Cb)(b.Gn)],M.prototype,"defaultSymbol",void 0),(0,r._)([(0,l.Cb)({type:String,json:{write:!0}})],M.prototype,"field",void 0),(0,r._)([(0,u.p)("field")],M.prototype,"castField",null),(0,r._)([(0,l.Cb)({type:Boolean})],M.prototype,"isMaxInclusive",void 0),(0,r._)([(0,l.Cb)({type:x.Z,json:{write:!0}})],M.prototype,"legendOptions",void 0),(0,r._)([(0,l.Cb)({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return 0!==this.classBreakInfos.length&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],M.prototype,"minValue",null),(0,r._)([(0,l.Cb)({type:String,json:{write:!0}})],M.prototype,"normalizationField",void 0),(0,r._)([(0,l.Cb)({type:Number,json:{write:!0}})],M.prototype,"normalizationTotal",void 0),(0,r._)([(0,l.Cb)({type:I.apiValues,value:null,json:{type:I.jsonValues,read:I.read,write:I.write}})],M.prototype,"normalizationType",null),(0,r._)([(0,c.J)({classBreaks:"class-breaks"})],M.prototype,"type",void 0),(0,r._)([(0,l.Cb)({type:String,json:{write:!0}})],M.prototype,"valueExpression",void 0),(0,r._)([(0,l.Cb)({type:String,json:{write:!0}})],M.prototype,"valueExpressionTitle",void 0),M=i=(0,r._)([(0,p.j)("esri.renderers.ClassBreaksRenderer")],M)},58968:function(e,t,n){n.d(t,{Z:function(){return u}});var i,r=n(73440),s=n(63255),o=n(17155),a=(n(61432),n(96711),n(83850),n(48023)),l=n(31186);let u=i=class extends s.Z{constructor(e){super(e),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new i({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?.clone()??null})}getMeshHash(){const e=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${e}`}};(0,r._)([(0,o.Cb)({type:String,json:{write:!0}})],u.prototype,"description",void 0),(0,r._)([(0,o.Cb)({type:String,json:{write:!0}})],u.prototype,"label",void 0),(0,r._)([(0,o.Cb)({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],u.prototype,"minValue",void 0),(0,r._)([(0,o.Cb)({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],u.prototype,"maxValue",void 0),(0,r._)([(0,o.Cb)(l.EW)],u.prototype,"symbol",void 0),u=i=(0,r._)([(0,a.j)("esri.renderers.support.ClassBreakInfo")],u)},99382:function(e,t,n){n.d(t,{eZ:function(){return u}});var i=n(997),r=n(76554),s=n(45497),o=(n(48864),n(62905),n(80730),n(92628)),a=(n(40062),n(22271),n(17956),n(10677),n(60415)),l=n(79074);function u({displayField:e,editFieldsInfo:t,fields:n,objectIdField:a,title:l},u){if(!n)return null;const c=p({editFieldsInfo:t,fields:n,objectIdField:a},u);if(!c.length)return null;const d=function(e){const t=(0,r.O5)(e),{titleBase:n}=e;return t?`${n}: {${t.trim()}}`:n??""}({titleBase:l,fields:n,displayField:e}),f=[new o.Z,new s.Z];return new i.Z({title:d,content:f,fieldInfos:c})}const c=(e,t)=>t.visibleFieldNames?t.visibleFieldNames.has(e.name):(0,r.Fv)(e,t);function d(e,t){return"oid"===e.type?-1:"oid"===t.type?1:h(e)?-1:h(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function p(e,t){const n=t?.visibleFieldNames;return function({fields:e,ignoreFieldTypes:t,sortDisabled:n}){const i=e;return t&&(e=e.filter((e=>!t.includes(e.type)))),e===i&&(e=e.slice()),!0!==n&&e.sort(d),e}({fields:e.fields??[],ignoreFieldTypes:t?.ignoreFieldTypes||m,sortDisabled:t?.sortDisabled}).map((t=>new a.Z({fieldName:t.name,isEditable:(0,r.Hp)(t,e),label:t.alias,format:f(t),visible:c(t,{...e,visibleFieldNames:n})})))}function f(e){switch(e.type){case"small-integer":case"integer":case"single":return new l.Z({digitSeparator:!0,places:0});case"double":return new l.Z({digitSeparator:!0,places:2});case"string":return(0,r.Ec)(e.name)?new l.Z({digitSeparator:!0,places:0}):void 0;default:return}}function h(e){if("name"===(e.name&&e.name.toLowerCase()))return!0;const t=e.alias?.toLowerCase();return"name"===t}const m=["geometry","blob","raster","guid","xml"]},44252:function(e,t,n){var i,r,s,o,a,l,u,c,d,p,f,h,m,g,y,v,b,x,w,C,S,_,I,T,M,E,A,L,R,F,P,O,N,k,D,B,z,V,Z,$,j,U,G,W,H,Y,q,J,X,K,Q,ee,te,ne,ie,re,se,oe,ae,le,ue,ce,de;n.d(t,{$y:function(){return I},AH:function(){return r},BZ:function(){return T},CS:function(){return X},DD:function(){return c},Dd:function(){return F},Em:function(){return _},IB:function(){return h},IH:function(){return re},JS:function(){return q},Ky:function(){return d},Lh:function(){return K},Qb:function(){return ae},RL:function(){return i},RS:function(){return ue},TF:function(){return S},Tx:function(){return a},UR:function(){return x},UX:function(){return oe},bj:function(){return J},eZ:function(){return u},id:function(){return E},kP:function(){return V},mC:function(){return ne},of:function(){return f},r4:function(){return U},sj:function(){return Z},v2:function(){return s},zQ:function(){return R},zV:function(){return b}}),function(e){e[e.BUTT=0]="BUTT",e[e.ROUND=1]="ROUND",e[e.SQUARE=2]="SQUARE",e[e.UNKNOWN=4]="UNKNOWN"}(i||(i={})),function(e){e[e.BEVEL=0]="BEVEL",e[e.ROUND=1]="ROUND",e[e.MITER=2]="MITER",e[e.UNKNOWN=4]="UNKNOWN"}(r||(r={})),function(e){e[e.SCREEN=0]="SCREEN",e[e.MAP=1]="MAP"}(s||(s={})),function(e){e[e.Tint=0]="Tint",e[e.Ignore=1]="Ignore",e[e.Multiply=99]="Multiply"}(o||(o={})),function(e){e.Both="Both",e.JustBegin="JustBegin",e.JustEnd="JustEnd",e.None="None"}(a||(a={})),function(e){e[e.Mosaic=0]="Mosaic",e[e.Centered=1]="Centered"}(l||(l={})),function(e){e[e.Normal=0]="Normal",e[e.Superscript=1]="Superscript",e[e.Subscript=2]="Subscript"}(u||(u={})),function(e){e[e.MSSymbol=0]="MSSymbol",e[e.Unicode=1]="Unicode"}(c||(c={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.TrueType=1]="TrueType",e[e.PSOpenType=2]="PSOpenType",e[e.TTOpenType=3]="TTOpenType",e[e.Type1=4]="Type1"}(d||(d={})),function(e){e[e.Display=0]="Display",e[e.Map=1]="Map"}(p||(p={})),function(e){e.None="None",e.Loop="Loop",e.Oscillate="Oscillate"}(f||(f={})),function(e){e.Linear="Linear",e.EaseIn="EaseIn",e.EaseOut="EaseOut",e.EaseInOut="EaseInOut"}(h||(h={})),function(e){e[e.Z=0]="Z",e[e.X=1]="X",e[e.Y=2]="Y"}(m||(m={})),function(e){e[e.XYZ=0]="XYZ",e[e.ZXY=1]="ZXY",e[e.YXZ=2]="YXZ"}(g||(g={})),function(e){e[e.Rectangle=0]="Rectangle",e[e.RoundedRectangle=1]="RoundedRectangle",e[e.Oval=2]="Oval"}(y||(y={})),function(e){e[e.None=0]="None",e[e.Alpha=1]="Alpha",e[e.Screen=2]="Screen",e[e.Multiply=3]="Multiply",e[e.Add=4]="Add"}(v||(v={})),function(e){e[e.TTB=0]="TTB",e[e.RTL=1]="RTL",e[e.BTT=2]="BTT"}(b||(b={})),function(e){e[e.None=0]="None",e[e.SignPost=1]="SignPost",e[e.FaceNearPlane=2]="FaceNearPlane"}(x||(x={})),function(e){e[e.Float=0]="Float",e[e.String=1]="String",e[e.Boolean=2]="Boolean"}(w||(w={})),function(e){e[e.Intersect=0]="Intersect",e[e.Subtract=1]="Subtract"}(C||(C={})),function(e){e.OpenEnded="OpenEnded",e.Block="Block",e.Crossed="Crossed"}(S||(S={})),function(e){e.FullGeometry="FullGeometry",e.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",e.ReversedFirstSegment="ReversedFirstSegment",e.PerpendicularToSecondSegment="PerpendicularToSecondSegment",e.SecondSegmentWithTicks="SecondSegmentWithTicks",e.DoublePerpendicular="DoublePerpendicular",e.OppositeToFirstSegment="OppositeToFirstSegment",e.TriplePerpendicular="TriplePerpendicular",e.HalfCircleFirstSegment="HalfCircleFirstSegment",e.HalfCircleSecondSegment="HalfCircleSecondSegment",e.HalfCircleExtended="HalfCircleExtended",e.OpenCircle="OpenCircle",e.CoverageEdgesWithTicks="CoverageEdgesWithTicks",e.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",e.GapExtentMidline="GapExtentMidline",e.Chevron="Chevron",e.PerpendicularWithArc="PerpendicularWithArc",e.ClosedHalfCircle="ClosedHalfCircle",e.TripleParallelExtended="TripleParallelExtended",e.ParallelWithTicks="ParallelWithTicks",e.Parallel="Parallel",e.PerpendicularToFirstSegment="PerpendicularToFirstSegment",e.ParallelOffset="ParallelOffset",e.OffsetOpposite="OffsetOpposite",e.OffsetSame="OffsetSame",e.CircleWithArc="CircleWithArc",e.DoubleJog="DoubleJog",e.PerpendicularOffset="PerpendicularOffset",e.LineExcludingLastSegment="LineExcludingLastSegment",e.MultivertexArrow="MultivertexArrow",e.CrossedArrow="CrossedArrow",e.ChevronArrow="ChevronArrow",e.ChevronArrowOffset="ChevronArrowOffset",e.PartialFirstSegment="PartialFirstSegment",e.Arch="Arch",e.CurvedParallelTicks="CurvedParallelTicks",e.Arc90Degrees="Arc90Degrees",e.TipWithPerpendicularAndTicks="TipWithPerpendicularAndTicks",e.ConcentricCircles="ConcentricCircles",e.DoubleJogArrow="DoubleJogArrow",e.LinkedChevrons="LinkedChevrons",e.SegmentThenHalfCircle="SegmentThenHalfCircle",e.LineWithStraightTicks="LineWithStraightTicks",e.DoubleCurve="DoubleCurve",e.ParallelWithTicksByWidth="ParallelWithTicksByWidth",e.EnclosingRoundedRectangle="EnclosingRoundedRectangle"}(_||(_={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square",e.TrueBuffer="TrueBuffer"}(I||(I={})),function(e){e.ClosePath="ClosePath",e.ConvexHull="ConvexHull",e.RectangularBox="RectangularBox"}(T||(T={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(M||(M={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square"}(E||(E={})),function(e){e.Fast="Fast",e.Accurate="Accurate"}(A||(A={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(L||(L={})),function(e){e.Sinus="Sinus",e.Square="Square",e.Triangle="Triangle",e.Random="Random"}(R||(R={})),function(e){e[e.None=0]="None",e[e.Default=1]="Default",e[e.Force=2]="Force"}(F||(F={})),function(e){e[e.Buffered=0]="Buffered",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.AlongLine=3]="AlongLine"}(P||(P={})),function(e){e[e.Linear=0]="Linear",e[e.Rectangular=1]="Rectangular",e[e.Circular=2]="Circular",e[e.Buffered=3]="Buffered"}(O||(O={})),function(e){e[e.Discrete=0]="Discrete",e[e.Continuous=1]="Continuous"}(N||(N={})),function(e){e[e.AcrossLine=0]="AcrossLine",e[e.AlongLine=1]="AlongLine"}(k||(k={})),function(e){e[e.Auto=0]="Auto",e[e.Clockwise=1]="Clockwise",e[e.Counterclockwise=2]="Counterclockwise"}(D||(D={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justify=3]="Justify"}(B||(B={})),function(e){e[e.Base=0]="Base",e[e.MidPoint=1]="MidPoint",e[e.ThreePoint=2]="ThreePoint",e[e.FourPoint=3]="FourPoint",e[e.Underline=4]="Underline",e[e.CircularCW=5]="CircularCW",e[e.CircularCCW=6]="CircularCCW"}(z||(z={})),function(e){e.Butt="Butt",e.Round="Round",e.Square="Square"}(V||(V={})),function(e){e.NoConstraint="NoConstraint",e.HalfPattern="HalfPattern",e.HalfGap="HalfGap",e.FullPattern="FullPattern",e.FullGap="FullGap",e.Custom="Custom"}(Z||(Z={})),function(e){e[e.None=-1]="None",e[e.Custom=0]="Custom",e[e.Circle=1]="Circle",e[e.OpenArrow=2]="OpenArrow",e[e.ClosedArrow=3]="ClosedArrow",e[e.Diamond=4]="Diamond"}($||($={})),function(e){e[e.ExtraLeading=0]="ExtraLeading",e[e.Multiple=1]="Multiple",e[e.Exact=2]="Exact"}(j||(j={})),function(e){e.Bevel="Bevel",e.Round="Round",e.Miter="Miter"}(U||(U={})),function(e){e[e.Default=0]="Default",e[e.String=1]="String",e[e.Numeric=2]="Numeric"}(G||(G={})),function(e){e[e.InsidePolygon=0]="InsidePolygon",e[e.PolygonCenter=1]="PolygonCenter",e[e.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"}(W||(W={})),function(e){e[e.Tint=0]="Tint",e[e.Replace=1]="Replace",e[e.Multiply=2]="Multiply"}(H||(H={})),function(e){e[e.ClipAtBoundary=0]="ClipAtBoundary",e[e.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",e[e.DoNotTouchBoundary=2]="DoNotTouchBoundary",e[e.DoNotClip=3]="DoNotClip"}(Y||(Y={})),function(e){e.NoConstraint="NoConstraint",e.WithMarkers="WithMarkers",e.WithFullGap="WithFullGap",e.WithHalfGap="WithHalfGap",e.Custom="Custom"}(q||(q={})),function(e){e.Fixed="Fixed",e.Random="Random",e.RandomFixedQuantity="RandomFixedQuantity"}(J||(J={})),function(e){e.LineMiddle="LineMiddle",e.LineBeginning="LineBeginning",e.LineEnd="LineEnd",e.SegmentMidpoint="SegmentMidpoint"}(X||(X={})),function(e){e.OnPolygon="OnPolygon",e.CenterOfMass="CenterOfMass",e.BoundingBoxCenter="BoundingBoxCenter"}(K||(K={})),function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"}(Q||(Q={})),function(e){e[e.MarkerCenter=0]="MarkerCenter",e[e.MarkerBounds=1]="MarkerBounds"}(ee||(ee={})),function(e){e[e.None=0]="None",e[e.PropUniform=1]="PropUniform",e[e.PropNonuniform=2]="PropNonuniform",e[e.DifUniform=3]="DifUniform",e[e.DifNonuniform=4]="DifNonuniform"}(te||(te={})),function(e){e.Tube="Tube",e.Strip="Strip",e.Wall="Wall"}(ne||(ne={})),function(e){e[e.Random=0]="Random",e[e.Increasing=1]="Increasing",e[e.Decreasing=2]="Decreasing",e[e.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"}(ie||(ie={})),function(e){e[e.Relative=0]="Relative",e[e.Absolute=1]="Absolute"}(re||(re={})),function(e){e[e.Normal=0]="Normal",e[e.LowerCase=1]="LowerCase",e[e.Allcaps=2]="Allcaps"}(se||(se={})),function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"}(oe||(oe={})),function(e){e.Draft="Draft",e.Picture="Picture",e.Text="Text"}(ae||(ae={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Baseline=2]="Baseline",e[e.Bottom=3]="Bottom"}(le||(le={})),function(e){e[e.Right=0]="Right",e[e.Upright=1]="Upright"}(ue||(ue={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(ce||(ce={})),function(e){e[e.Calm=0]="Calm",e[e.Rippled=1]="Rippled",e[e.Slight=2]="Slight",e[e.Moderate=3]="Moderate"}(de||(de={}))}}]);