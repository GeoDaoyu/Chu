(self.webpackChunk=self.webpackChunk||[]).push([[95474,17623,82738,90378,61637,50820,66882,96009,80379,76149],{36066:function(e,t,i){"use strict";i.d(t,{Z:function(){return oe}});var n=i(44194),o=i(51865),s=i.n(o),r=i(26402),a=i(81890),l=i(9665);var c=e=>{const{getPrefixCls:t,direction:i}=(0,n.useContext)(r.E_),{prefixCls:o,className:c}=e,d=t("input-group",o),u=t("input"),[h,p,y]=(0,l.ZP)(u),g=s()(d,y,{[`${d}-lg`]:"large"===e.size,[`${d}-sm`]:"small"===e.size,[`${d}-compact`]:e.compact,[`${d}-rtl`]:"rtl"===i},p,c),m=(0,n.useContext)(a.aM),f=(0,n.useMemo)((()=>Object.assign(Object.assign({},m),{isFormItemInput:!1})),[m]);return h(n.createElement("span",{className:g,style:e.style,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onFocus:e.onFocus,onBlur:e.onBlur},n.createElement(a.aM.Provider,{value:f},e.children)))},d=i(27016),u=i(31789),h=i(95357),p=i(20093),y=i(8763),g=i(30151),m=i(31699),f=i(5187),v=i(33987),b=i(23479);function _(e,t){const i=(0,n.useRef)([]),o=()=>{i.current.push(setTimeout((()=>{var t,i,n,o;(null===(t=e.current)||void 0===t?void 0:t.input)&&"password"===(null===(i=e.current)||void 0===i?void 0:i.input.getAttribute("type"))&&(null===(n=e.current)||void 0===n?void 0:n.input.hasAttribute("value"))&&(null===(o=e.current)||void 0===o||o.input.removeAttribute("value"))})))};return(0,n.useEffect)((()=>(t&&o(),()=>i.current.forEach((e=>{e&&clearTimeout(e)})))),[]),o}var w=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i};var C=(0,n.forwardRef)(((e,t)=>{const{prefixCls:i,bordered:o=!0,status:c,size:C,disabled:x,onBlur:S,onFocus:E,suffix:k,allowClear:L,addonAfter:T,addonBefore:M,className:I,style:O,styles:P,rootClassName:A,onChange:R,classNames:D,variant:$}=e,N=w(e,["prefixCls","bordered","status","size","disabled","onBlur","onFocus","suffix","allowClear","addonAfter","addonBefore","className","style","styles","rootClassName","onChange","classNames","variant"]);const{getPrefixCls:F,direction:V,allowClear:z,autoComplete:Z,className:B,style:U,classNames:H,styles:G}=(0,r.dj)("input"),j=F("input",i),K=(0,n.useRef)(null),W=(0,m.Z)(j),[Y,q,X]=(0,l.TI)(j,A),[J]=(0,l.ZP)(j,W),{compactSize:Q,compactItemClassnames:ee}=(0,b.ri)(j,V),te=(0,f.Z)((e=>{var t;return null!==(t=null!=C?C:Q)&&void 0!==t?t:e})),ie=n.useContext(g.Z),ne=null!=x?x:ie,{status:oe,hasFeedback:se,feedbackIcon:re}=(0,n.useContext)(a.aM),ae=(0,y.F)(oe,c),le=function(e){return!!(e.prefix||e.suffix||e.allowClear||e.showCount)}(e)||!!se;(0,n.useRef)(le);const ce=_(K,!0),de=(se||k)&&n.createElement(n.Fragment,null,k,se&&re),ue=(0,p.Z)(null!=L?L:z),[he,pe]=(0,v.Z)("input",$,o);return Y(J(n.createElement(d.Z,Object.assign({ref:(0,u.sQ)(t,K),prefixCls:j,autoComplete:Z},N,{disabled:ne,onBlur:e=>{ce(),null==S||S(e)},onFocus:e=>{ce(),null==E||E(e)},style:Object.assign(Object.assign({},U),O),styles:Object.assign(Object.assign({},G),P),suffix:de,allowClear:ue,className:s()(I,A,X,W,ee,B),onChange:e=>{ce(),null==R||R(e)},addonBefore:M&&n.createElement(h.Z,{form:!0,space:!0},M),addonAfter:T&&n.createElement(h.Z,{form:!0,space:!0},T),classNames:Object.assign(Object.assign(Object.assign({},D),H),{input:s()({[`${j}-sm`]:"small"===te,[`${j}-lg`]:"large"===te,[`${j}-rtl`]:"rtl"===V},null==D?void 0:D.input,H.input,q),variant:s()({[`${j}-${he}`]:pe},(0,y.Z)(j,ae)),affixWrapper:s()({[`${j}-affix-wrapper-sm`]:"small"===te,[`${j}-affix-wrapper-lg`]:"large"===te,[`${j}-affix-wrapper-rtl`]:"rtl"===V},q),wrapper:s()({[`${j}-group-rtl`]:"rtl"===V},q),groupWrapper:s()({[`${j}-group-wrapper-sm`]:"small"===te,[`${j}-group-wrapper-lg`]:"large"===te,[`${j}-group-wrapper-rtl`]:"rtl"===V,[`${j}-group-wrapper-${he}`]:pe},(0,y.Z)(`${j}-group-wrapper`,ae,se),q)})}))))})),x=i(88153),S=i(46735),E=i(6674),k=i(91945),L=i(36480),T=i(43424);const M=e=>{const{componentCls:t,paddingXS:i}=e;return{[t]:{display:"inline-flex",alignItems:"center",flexWrap:"nowrap",columnGap:i,[`${t}-input-wrapper`]:{position:"relative",[`${t}-mask-icon`]:{position:"absolute",zIndex:"1",top:"50%",right:"50%",transform:"translate(50%, -50%)",pointerEvents:"none"},[`${t}-mask-input`]:{color:"transparent",caretColor:"var(--ant-color-text)"},[`${t}-mask-input[type=number]::-webkit-inner-spin-button`]:{"-webkit-appearance":"none",margin:0},[`${t}-mask-input[type=number]`]:{"-moz-appearance":"textfield"}},"&-rtl":{direction:"rtl"},[`${t}-input`]:{textAlign:"center",paddingInline:e.paddingXXS},[`&${t}-sm ${t}-input`]:{paddingInline:e.calc(e.paddingXXS).div(2).equal()},[`&${t}-lg ${t}-input`]:{paddingInline:e.paddingXS}}}};var I=(0,k.I$)(["Input","OTP"],(e=>{const t=(0,L.IX)(e,(0,T.e)(e));return[M(t)]}),T.T),O=i(85180),P=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i};var A=n.forwardRef(((e,t)=>{const{className:i,value:o,onChange:a,onActiveChange:l,index:c,mask:d}=e,u=P(e,["className","value","onChange","onActiveChange","index","mask"]),{getPrefixCls:h}=n.useContext(r.E_),p=h("otp"),y="string"==typeof d?d:o,g=n.useRef(null);n.useImperativeHandle(t,(()=>g.current));const m=()=>{(0,O.Z)((()=>{var e;const t=null===(e=g.current)||void 0===e?void 0:e.input;document.activeElement===t&&t&&t.select()}))};return n.createElement("span",{className:`${p}-input-wrapper`,role:"presentation"},d&&""!==o&&void 0!==o&&n.createElement("span",{className:`${p}-mask-icon`,"aria-hidden":"true"},y),n.createElement(C,Object.assign({"aria-label":`OTP Input ${c+1}`,type:!0===d?"password":"text"},u,{ref:g,value:o,onInput:e=>{a(c,e.target.value)},onFocus:m,onKeyDown:e=>{const{key:t,ctrlKey:i,metaKey:n}=e;"ArrowLeft"===t?l(c-1):"ArrowRight"===t?l(c+1):"z"===t&&(i||n)&&e.preventDefault(),m()},onKeyUp:e=>{"Backspace"!==e.key||o||l(c-1),m()},onMouseDown:m,onMouseUp:m,className:s()(i,{[`${p}-mask-input`]:d})})))})),R=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i};function D(e){return(e||"").split("")}const $=e=>{const{index:t,prefixCls:i,separator:o}=e,s="function"==typeof o?o(t):o;return s?n.createElement("span",{className:`${i}-separator`},s):null};var N=n.forwardRef(((e,t)=>{const{prefixCls:i,length:o=6,size:l,defaultValue:c,value:d,onChange:u,formatter:h,separator:p,variant:g,disabled:m,status:v,autoFocus:b,mask:_,type:w,onInput:C,inputMode:k}=e,L=R(e,["prefixCls","length","size","defaultValue","value","onChange","formatter","separator","variant","disabled","status","autoFocus","mask","type","onInput","inputMode"]);const{getPrefixCls:T,direction:M}=n.useContext(r.E_),O=T("otp",i),P=(0,E.Z)(L,{aria:!0,data:!0,attr:!0}),[N,F,V]=I(O),z=(0,f.Z)((e=>null!=l?l:e)),Z=n.useContext(a.aM),B=(0,y.F)(Z.status,v),U=n.useMemo((()=>Object.assign(Object.assign({},Z),{status:B,hasFeedback:!1,feedbackIcon:null})),[Z,B]),H=n.useRef(null),G=n.useRef({});n.useImperativeHandle(t,(()=>({focus:()=>{var e;null===(e=G.current[0])||void 0===e||e.focus()},blur:()=>{var e;for(let t=0;t<o;t+=1)null===(e=G.current[t])||void 0===e||e.blur()},nativeElement:H.current})));const j=e=>h?h(e):e,[K,W]=n.useState((()=>D(j(c||""))));n.useEffect((()=>{void 0!==d&&W(D(d))}),[d]);const Y=(0,S.Z)((e=>{W(e),C&&C(e),u&&e.length===o&&e.every((e=>e))&&e.some(((e,t)=>K[t]!==e))&&u(e.join(""))})),q=(0,S.Z)(((e,t)=>{let i=(0,x.Z)(K);for(let t=0;t<e;t+=1)i[t]||(i[t]="");t.length<=1?i[e]=t:i=i.slice(0,e).concat(D(t)),i=i.slice(0,o);for(let e=i.length-1;e>=0&&!i[e];e-=1)i.pop();const n=j(i.map((e=>e||" ")).join(""));return i=D(n).map(((e,t)=>" "!==e||i[t]?e:i[t])),i})),X=(e,t)=>{var i;const n=q(e,t),s=Math.min(e+t.length,o-1);s!==e&&void 0!==n[e]&&(null===(i=G.current[s])||void 0===i||i.focus()),Y(n)},J=e=>{var t;null===(t=G.current[e])||void 0===t||t.focus()},Q={variant:g,disabled:m,status:B,mask:_,type:w,inputMode:k};return N(n.createElement("div",Object.assign({},P,{ref:H,className:s()(O,{[`${O}-sm`]:"small"===z,[`${O}-lg`]:"large"===z,[`${O}-rtl`]:"rtl"===M},V,F),role:"group"}),n.createElement(a.aM.Provider,{value:U},Array.from({length:o}).map(((e,t)=>{const i=`otp-${t}`,s=K[t]||"";return n.createElement(n.Fragment,{key:i},n.createElement(A,Object.assign({ref:e=>{G.current[t]=e},index:t,size:z,htmlSize:1,className:`${O}-input`,onChange:X,value:s,onActiveChange:J,autoFocus:0===t&&b},Q)),t<o-1&&n.createElement($,{separator:p,index:t,prefixCls:O}))})))))})),F=i(95051),V={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2Q889.47 375.11 816.7 305l-50.88 50.88C807.31 395.53 843.45 447.4 874.7 512 791.5 684.2 673.4 766 512 766q-72.67 0-133.87-22.38L323 798.75Q408 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 000-51.5zm-63.57-320.64L836 122.88a8 8 0 00-11.32 0L715.31 232.2Q624.86 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 000 51.5q56.69 119.4 136.5 191.41L112.48 835a8 8 0 000 11.31L155.17 889a8 8 0 0011.31 0l712.15-712.12a8 8 0 000-11.32zM149.3 512C232.6 339.8 350.7 258 512 258c54.54 0 104.13 9.36 149.12 28.39l-70.3 70.3a176 176 0 00-238.13 238.13l-83.42 83.42C223.1 637.49 183.3 582.28 149.3 512zm246.7 0a112.11 112.11 0 01146.2-106.69L401.31 546.2A112 112 0 01396 512z"}},{tag:"path",attrs:{d:"M508 624c-3.46 0-6.87-.16-10.25-.47l-52.82 52.82a176.09 176.09 0 00227.42-227.42l-52.82 52.82c.31 3.38.47 6.79.47 10.25a111.94 111.94 0 01-112 112z"}}]},name:"eye-invisible",theme:"outlined"},z=i(43638),Z=function(e,t){return n.createElement(z.Z,(0,F.Z)({},e,{ref:t,icon:V}))};var B=n.forwardRef(Z),U={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"eye",theme:"outlined"},H=function(e,t){return n.createElement(z.Z,(0,F.Z)({},e,{ref:t,icon:U}))};var G=n.forwardRef(H),j=i(54570),K=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i};const W=e=>e?n.createElement(G,null):n.createElement(B,null),Y={click:"onClick",hover:"onMouseOver"};var q=n.forwardRef(((e,t)=>{const{disabled:i,action:o="click",visibilityToggle:a=!0,iconRender:l=W}=e,c=n.useContext(g.Z),d=null!=i?i:c,h="object"==typeof a&&void 0!==a.visible,[p,y]=(0,n.useState)((()=>!!h&&a.visible)),m=(0,n.useRef)(null);n.useEffect((()=>{h&&y(a.visible)}),[h,a]);const f=_(m),v=()=>{var e;if(d)return;p&&f();const t=!p;y(t),"object"==typeof a&&(null===(e=a.onVisibleChange)||void 0===e||e.call(a,t))},{className:b,prefixCls:w,inputPrefixCls:x,size:S}=e,E=K(e,["className","prefixCls","inputPrefixCls","size"]),{getPrefixCls:k}=n.useContext(r.E_),L=k("input",x),T=k("input-password",w),M=a&&(e=>{const t=Y[o]||"",i=l(p),s={[t]:v,className:`${e}-icon`,key:"passwordIcon",onMouseDown:e=>{e.preventDefault()},onMouseUp:e=>{e.preventDefault()}};return n.cloneElement(n.isValidElement(i)?i:n.createElement("span",null,i),s)})(T),I=s()(T,b,{[`${T}-${S}`]:!!S}),O=Object.assign(Object.assign({},(0,j.Z)(E,["suffix","iconRender","visibilityToggle"])),{type:p?"text":"password",className:I,prefixCls:L,suffix:M});return S&&(O.size=S),n.createElement(C,Object.assign({ref:(0,u.sQ)(t,m)},O))})),X=i(74692),J=i(66197),Q=i(33273),ee=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i};var te=n.forwardRef(((e,t)=>{const{prefixCls:i,inputPrefixCls:o,className:a,size:l,suffix:c,enterButton:d=!1,addonAfter:h,loading:p,disabled:y,onSearch:g,onChange:m,onCompositionStart:v,onCompositionEnd:_}=e,w=ee(e,["prefixCls","inputPrefixCls","className","size","suffix","enterButton","addonAfter","loading","disabled","onSearch","onChange","onCompositionStart","onCompositionEnd"]),{getPrefixCls:x,direction:S}=n.useContext(r.E_),E=n.useRef(!1),k=x("input-search",i),L=x("input",o),{compactSize:T}=(0,b.ri)(k,S),M=(0,f.Z)((e=>{var t;return null!==(t=null!=l?l:T)&&void 0!==t?t:e})),I=n.useRef(null),O=e=>{var t;document.activeElement===(null===(t=I.current)||void 0===t?void 0:t.input)&&e.preventDefault()},P=e=>{var t,i;g&&g(null===(i=null===(t=I.current)||void 0===t?void 0:t.input)||void 0===i?void 0:i.value,e,{source:"input"})},A="boolean"==typeof d?n.createElement(X.Z,null):null,R=`${k}-button`;let D;const $=d||{},N=$.type&&!0===$.type.__ANT_BUTTON;D=N||"button"===$.type?(0,J.Tm)($,Object.assign({onMouseDown:O,onClick:e=>{var t,i;null===(i=null===(t=null==$?void 0:$.props)||void 0===t?void 0:t.onClick)||void 0===i||i.call(t,e),P(e)},key:"enterButton"},N?{className:R,size:M}:{})):n.createElement(Q.ZP,{className:R,type:d?"primary":void 0,size:M,disabled:y,key:"enterButton",onMouseDown:O,onClick:P,loading:p,icon:A},d),h&&(D=[D,(0,J.Tm)(h,{key:"addonAfter"})]);const F=s()(k,{[`${k}-rtl`]:"rtl"===S,[`${k}-${M}`]:!!M,[`${k}-with-button`]:!!d},a),V=Object.assign(Object.assign({},w),{className:F,prefixCls:L,type:"search"});return n.createElement(C,Object.assign({ref:(0,u.sQ)(I,t),onPressEnter:e=>{E.current||p||P(e)}},V,{size:M,onCompositionStart:e=>{E.current=!0,null==v||v(e)},onCompositionEnd:e=>{E.current=!1,null==_||_(e)},addonAfter:D,suffix:c,onChange:e=>{(null==e?void 0:e.target)&&"click"===e.type&&g&&g(e.target.value,e,{source:"clear"}),null==m||m(e)},disabled:y}))})),ie=i(38256);const ne=C;ne.Group=c,ne.Search=te,ne.TextArea=ie.Z,ne.Password=q,ne.OTP=N;var oe=ne},82534:function(e,t,i){"use strict";i.d(t,{Z:function(){return St}});var n=i(95051),o=i(20686),s=i(92961),r=i(88153),a=i(76524),l=i(70296),c=i(45603),d=i(63733),u=i(53936),h=i(8593),p=i(51865),y=i.n(p),g=i(65041),m=i(6674),f=i(61517),v=i(44194),b=v.createContext(null),_=v.createContext({});var w=function(e){var t=e.dropPosition,i=e.dropLevelOffset,n=e.indent,o={pointerEvents:"none",position:"absolute",right:0,backgroundColor:"red",height:2};switch(t){case-1:o.top=0,o.left=-i*n;break;case 1:o.bottom=0,o.left=-i*n;break;case 0:o.bottom=0,o.left=n}return v.createElement("div",{style:o})};function C(e){if(null==e)throw new TypeError("Cannot destructure "+e)}var x=i(83914),S=i(23829),E=i(39721),k=i(54561),L=i(46848),T=function(e){for(var t=e.prefixCls,i=e.level,n=e.isStart,o=e.isEnd,s="".concat(t,"-indent-unit"),r=[],a=0;a<i;a+=1)r.push(v.createElement("span",{key:a,className:y()(s,(0,h.Z)((0,h.Z)({},"".concat(s,"-start"),n[a]),"".concat(s,"-end"),o[a]))}));return v.createElement("span",{"aria-hidden":"true",className:"".concat(t,"-indent")},r)},M=v.memo(T);function I(e,t){return e[t]}var O=i(45802),P=i(54570),A=["children"];function R(e,t){return"".concat(e,"-").concat(t)}function D(e,t){return null!=e?e:t}function $(e){var t=e||{},i=t.title||"title";return{title:i,_title:t._title||[i],key:t.key||"key",children:t.children||"children"}}function N(e){return function e(t){return(0,O.Z)(t).map((function(t){if(!function(e){return e&&e.type&&e.type.isTreeNode}(t))return(0,f.ZP)(!t,"Tree/TreeNode can only accept TreeNode as children."),null;var i=t.key,n=t.props,o=n.children,r=(0,S.Z)(n,A),a=(0,s.Z)({key:i},r),l=e(o);return l.length&&(a.children=l),a})).filter((function(e){return e}))}(e)}function F(e,t,i){var n=$(i),o=n._title,s=n.key,a=n.children,l=new Set(!0===t?[]:t),c=[];return function e(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return i.map((function(d,u){for(var h,p=R(n?n.pos:"0",u),y=D(d[s],p),g=0;g<o.length;g+=1){var m=o[g];if(void 0!==d[m]){h=d[m];break}}var f=Object.assign((0,P.Z)(d,[].concat((0,r.Z)(o),[s,a])),{title:h,key:y,parent:n,pos:p,children:null,data:d,isStart:[].concat((0,r.Z)(n?n.isStart:[]),[0===u]),isEnd:[].concat((0,r.Z)(n?n.isEnd:[]),[u===i.length-1])});return c.push(f),!0===t||l.has(y)?f.children=e(d[a]||[],f):f.children=[],f}))}(e),c}function V(e,t,i){var n,s=("object"===(0,o.Z)(i)?i:{externalGetKey:i})||{},a=s.childrenPropName,l=s.externalGetKey,c=$(s.fieldNames),d=c.key,u=c.children,h=a||u;l?"string"==typeof l?n=function(e){return e[l]}:"function"==typeof l&&(n=function(e){return l(e)}):n=function(e,t){return D(e[d],t)},function i(o,s,a,l){var c=o?o[h]:e,d=o?R(a.pos,s):"0",u=o?[].concat((0,r.Z)(l),[o]):[];if(o){var p=n(o,d),y={node:o,index:s,pos:d,key:p,parentPos:a.node?a.pos:null,level:a.level+1,nodes:u};t(y)}c&&c.forEach((function(e,t){i(e,t,{node:o,pos:d,level:a?a.level+1:-1},u)}))}(null)}function z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.initWrapper,n=t.processEntity,o=t.onProcessFinished,s=t.externalGetKey,r=t.childrenPropName,a=t.fieldNames,l=arguments.length>2?arguments[2]:void 0,c=s||l,d={},u={},h={posEntities:d,keyEntities:u};return i&&(h=i(h)||h),V(e,(function(e){var t=e.node,i=e.index,o=e.pos,s=e.key,r=e.parentPos,a=e.level,l={node:t,nodes:e.nodes,index:i,key:s,pos:o,level:a},c=D(s,o);d[o]=l,u[c]=l,l.parent=d[r],l.parent&&(l.parent.children=l.parent.children||[],l.parent.children.push(l)),n&&n(l,h)}),{externalGetKey:c,childrenPropName:r,fieldNames:a}),o&&o(h),h}function Z(e,t){var i=t.expandedKeys,n=t.selectedKeys,o=t.loadedKeys,s=t.loadingKeys,r=t.checkedKeys,a=t.halfCheckedKeys,l=t.dragOverNodeKey,c=t.dropPosition,d=I(t.keyEntities,e);return{eventKey:e,expanded:-1!==i.indexOf(e),selected:-1!==n.indexOf(e),loaded:-1!==o.indexOf(e),loading:-1!==s.indexOf(e),checked:-1!==r.indexOf(e),halfChecked:-1!==a.indexOf(e),pos:String(d?d.pos:""),dragOver:l===e&&0===c,dragOverGapTop:l===e&&-1===c,dragOverGapBottom:l===e&&1===c}}function B(e){var t=e.data,i=e.expanded,n=e.selected,o=e.checked,r=e.loaded,a=e.loading,l=e.halfChecked,c=e.dragOver,d=e.dragOverGapTop,u=e.dragOverGapBottom,h=e.pos,p=e.active,y=e.eventKey,g=(0,s.Z)((0,s.Z)({},t),{},{expanded:i,selected:n,checked:o,loaded:r,loading:a,halfChecked:l,dragOver:c,dragOverGapTop:d,dragOverGapBottom:u,pos:h,active:p,key:y});return"props"in g||Object.defineProperty(g,"props",{get:function(){return(0,f.ZP)(!1,"Second param return from event is node data instead of TreeNode instance. Please read value directly instead of reading from `props`."),e}}),g}var U=["eventKey","className","style","dragOver","dragOverGapTop","dragOverGapBottom","isLeaf","isStart","isEnd","expanded","selected","checked","halfChecked","loading","domRef","active","data","onMouseMove","selectable"],H="open",G="close",j=function(e){var t,i,o,r=e.eventKey,a=e.className,l=e.style,c=e.dragOver,d=e.dragOverGapTop,u=e.dragOverGapBottom,p=e.isLeaf,g=e.isStart,f=e.isEnd,w=e.expanded,C=e.selected,E=e.checked,k=e.halfChecked,L=e.loading,T=e.domRef,O=e.active,P=e.data,A=e.onMouseMove,R=e.selectable,D=(0,S.Z)(e,U),$=v.useContext(b),N=v.useContext(_),F=v.useRef(null),V=v.useState(!1),z=(0,x.Z)(V,2),Z=z[0],j=z[1],K=!!($.disabled||e.disabled||null!==(t=N.nodeDisabled)&&void 0!==t&&t.call(N,P)),W=v.useMemo((function(){return!(!$.checkable||!1===e.checkable)&&$.checkable}),[$.checkable,e.checkable]),Y=function(t){K||W&&!e.disableCheckbox&&$.onNodeCheck(t,B(e),!E)},q=v.useMemo((function(){return"boolean"==typeof R?R:$.selectable}),[R,$.selectable]),X=function(t){$.onNodeClick(t,B(e)),q?function(t){K||$.onNodeSelect(t,B(e))}(t):Y(t)},J=function(t){$.onNodeDoubleClick(t,B(e))},Q=function(t){$.onNodeMouseEnter(t,B(e))},ee=function(t){$.onNodeMouseLeave(t,B(e))},te=function(t){$.onNodeContextMenu(t,B(e))},ie=v.useMemo((function(){return!(!$.draggable||$.draggable.nodeDraggable&&!$.draggable.nodeDraggable(P))}),[$.draggable,P]),ne=function(t){L||$.onNodeExpand(t,B(e))},oe=v.useMemo((function(){var e=(I($.keyEntities,r)||{}).children;return Boolean((e||[]).length)}),[$.keyEntities,r]),se=v.useMemo((function(){return!1!==p&&(p||!$.loadData&&!oe||$.loadData&&e.loaded&&!oe)}),[p,$.loadData,oe,e.loaded]);v.useEffect((function(){L||"function"!=typeof $.loadData||!w||se||e.loaded||$.onNodeLoad(B(e))}),[L,$.loadData,$.onNodeLoad,w,se,e]);var re=v.useMemo((function(){var e;return null!==(e=$.draggable)&&void 0!==e&&e.icon?v.createElement("span",{className:"".concat($.prefixCls,"-draggable-icon")},$.draggable.icon):null}),[$.draggable]),ae=function(t){var i=e.switcherIcon||$.switcherIcon;return"function"==typeof i?i((0,s.Z)((0,s.Z)({},e),{},{isLeaf:t})):i},le=v.useMemo((function(){if(!W)return null;var t="boolean"!=typeof W?W:null;return v.createElement("span",{className:y()("".concat($.prefixCls,"-checkbox"),(0,h.Z)((0,h.Z)((0,h.Z)({},"".concat($.prefixCls,"-checkbox-checked"),E),"".concat($.prefixCls,"-checkbox-indeterminate"),!E&&k),"".concat($.prefixCls,"-checkbox-disabled"),K||e.disableCheckbox)),onClick:Y,role:"checkbox","aria-checked":k?"mixed":E,"aria-disabled":K||e.disableCheckbox,"aria-label":"Select ".concat("string"==typeof e.title?e.title:"tree node")},t)}),[W,E,k,K,e.disableCheckbox,e.title]),ce=v.useMemo((function(){return se?null:w?H:G}),[se,w]),de=v.useMemo((function(){return v.createElement("span",{className:y()("".concat($.prefixCls,"-iconEle"),"".concat($.prefixCls,"-icon__").concat(ce||"docu"),(0,h.Z)({},"".concat($.prefixCls,"-icon_loading"),L))})}),[$.prefixCls,ce,L]),ue=v.useMemo((function(){var t=Boolean($.draggable);return!e.disabled&&t&&$.dragOverNodeKey===r?$.dropIndicatorRender({dropPosition:$.dropPosition,dropLevelOffset:$.dropLevelOffset,indent:$.indent,prefixCls:$.prefixCls,direction:$.direction}):null}),[$.dropPosition,$.dropLevelOffset,$.indent,$.prefixCls,$.direction,$.draggable,$.dragOverNodeKey,$.dropIndicatorRender]),he=v.useMemo((function(){var t,i,n=e.title,o=void 0===n?"---":n,s="".concat($.prefixCls,"-node-content-wrapper");if($.showIcon){var r=e.icon||$.icon;t=r?v.createElement("span",{className:y()("".concat($.prefixCls,"-iconEle"),"".concat($.prefixCls,"-icon__customize"))},"function"==typeof r?r(e):r):de}else $.loadData&&L&&(t=de);return i="function"==typeof o?o(P):$.titleRender?$.titleRender(P):o,v.createElement("span",{ref:F,title:"string"==typeof o?o:"",className:y()(s,"".concat(s,"-").concat(ce||"normal"),(0,h.Z)({},"".concat($.prefixCls,"-node-selected"),!K&&(C||Z))),onMouseEnter:Q,onMouseLeave:ee,onContextMenu:te,onClick:X,onDoubleClick:J},t,v.createElement("span",{className:"".concat($.prefixCls,"-title")},i),ue)}),[$.prefixCls,$.showIcon,e,$.icon,de,$.titleRender,P,ce,Q,ee,te,X,J]),pe=(0,m.Z)(D,{aria:!0,data:!0}),ye=(I($.keyEntities,r)||{}).level,ge=f[f.length-1],me=!K&&ie,fe=$.draggingNodeKey===r,ve=void 0!==R?{"aria-selected":!!R}:void 0;return v.createElement("div",(0,n.Z)({ref:T,role:"treeitem","aria-expanded":p?void 0:w,className:y()(a,"".concat($.prefixCls,"-treenode"),(o={},(0,h.Z)((0,h.Z)((0,h.Z)((0,h.Z)((0,h.Z)((0,h.Z)((0,h.Z)((0,h.Z)((0,h.Z)((0,h.Z)(o,"".concat($.prefixCls,"-treenode-disabled"),K),"".concat($.prefixCls,"-treenode-switcher-").concat(w?"open":"close"),!p),"".concat($.prefixCls,"-treenode-checkbox-checked"),E),"".concat($.prefixCls,"-treenode-checkbox-indeterminate"),k),"".concat($.prefixCls,"-treenode-selected"),C),"".concat($.prefixCls,"-treenode-loading"),L),"".concat($.prefixCls,"-treenode-active"),O),"".concat($.prefixCls,"-treenode-leaf-last"),ge),"".concat($.prefixCls,"-treenode-draggable"),ie),"dragging",fe),(0,h.Z)((0,h.Z)((0,h.Z)((0,h.Z)((0,h.Z)((0,h.Z)((0,h.Z)(o,"drop-target",$.dropTargetKey===r),"drop-container",$.dropContainerKey===r),"drag-over",!K&&c),"drag-over-gap-top",!K&&d),"drag-over-gap-bottom",!K&&u),"filter-node",null===(i=$.filterTreeNode)||void 0===i?void 0:i.call($,B(e))),"".concat($.prefixCls,"-treenode-leaf"),se))),style:l,draggable:me,onDragStart:me?function(t){t.stopPropagation(),j(!0),$.onNodeDragStart(t,e);try{t.dataTransfer.setData("text/plain","")}catch(e){}}:void 0,onDragEnter:ie?function(t){t.preventDefault(),t.stopPropagation(),$.onNodeDragEnter(t,e)}:void 0,onDragOver:ie?function(t){t.preventDefault(),t.stopPropagation(),$.onNodeDragOver(t,e)}:void 0,onDragLeave:ie?function(t){t.stopPropagation(),$.onNodeDragLeave(t,e)}:void 0,onDrop:ie?function(t){t.preventDefault(),t.stopPropagation(),j(!1),$.onNodeDrop(t,e)}:void 0,onDragEnd:ie?function(t){t.stopPropagation(),j(!1),$.onNodeDragEnd(t,e)}:void 0,onMouseMove:A},ve,pe),v.createElement(M,{prefixCls:$.prefixCls,level:ye,isStart:g,isEnd:f}),re,function(){if(se){var e=ae(!0);return!1!==e?v.createElement("span",{className:y()("".concat($.prefixCls,"-switcher"),"".concat($.prefixCls,"-switcher-noop"))},e):null}var t=ae(!1);return!1!==t?v.createElement("span",{onClick:ne,className:y()("".concat($.prefixCls,"-switcher"),"".concat($.prefixCls,"-switcher_").concat(w?H:G))},t):null}(),le,he)};j.isTreeNode=1;var K=j;var W=function(e,t){var i=v.useState(!1),n=(0,x.Z)(i,2),o=n[0],s=n[1];(0,E.Z)((function(){if(o)return e(),function(){t()}}),[o]),(0,E.Z)((function(){return s(!0),function(){s(!1)}}),[])},Y=["className","style","motion","motionNodes","motionType","onMotionStart","onMotionEnd","active","treeNodeRequiredProps"],q=v.forwardRef((function(e,t){var i=e.className,o=e.style,s=e.motion,r=e.motionNodes,a=e.motionType,l=e.onMotionStart,c=e.onMotionEnd,d=e.active,u=e.treeNodeRequiredProps,h=(0,S.Z)(e,Y),p=v.useState(!0),g=(0,x.Z)(p,2),m=g[0],f=g[1],_=v.useContext(b).prefixCls,w=r&&"hide"!==a;(0,E.Z)((function(){r&&w!==m&&f(w)}),[r]);var k=v.useRef(!1),T=function(){r&&!k.current&&(k.current=!0,c())};W((function(){r&&l()}),T);return r?v.createElement(L.ZP,(0,n.Z)({ref:t,visible:m},s,{motionAppear:"show"===a,onVisibleChanged:function(e){w===e&&T()}}),(function(e,t){var i=e.className,o=e.style;return v.createElement("div",{ref:t,className:y()("".concat(_,"-treenode-motion"),i),style:o},r.map((function(e){var t=Object.assign({},(C(e.data),e.data)),i=e.title,o=e.key,s=e.isStart,r=e.isEnd;delete t.children;var a=Z(o,u);return v.createElement(K,(0,n.Z)({},t,a,{title:i,active:d,data:e.data,key:o,isStart:s,isEnd:r}))})))})):v.createElement(K,(0,n.Z)({domRef:t,className:i,style:o},h,{active:d}))}));var X=q;function J(e,t,i){var n=e.findIndex((function(e){return e.key===i})),o=e[n+1],s=t.findIndex((function(e){return e.key===i}));if(o){var r=t.findIndex((function(e){return e.key===o.key}));return t.slice(s+1,r)}return t.slice(s+1)}var Q=["prefixCls","data","selectable","checkable","expandedKeys","selectedKeys","checkedKeys","loadedKeys","loadingKeys","halfCheckedKeys","keyEntities","disabled","dragging","dragOverNodeKey","dropPosition","motion","height","itemHeight","virtual","scrollWidth","focusable","activeItem","focused","tabIndex","onKeyDown","onFocus","onBlur","onActiveChange","onListChangeStart","onListChangeEnd"],ee={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},te=function(){},ie="RC_TREE_MOTION_".concat(Math.random()),ne={key:ie},oe={key:ie,level:0,index:0,pos:"0",node:ne,nodes:[ne]},se={parent:null,children:[],pos:oe.pos,data:ne,title:null,key:ie,isStart:[],isEnd:[]};function re(e,t,i,n){return!1!==t&&i?e.slice(0,Math.ceil(i/n)+1):e}function ae(e){return D(e.key,e.pos)}var le=v.forwardRef((function(e,t){var i=e.prefixCls,o=e.data,s=(e.selectable,e.checkable,e.expandedKeys),r=e.selectedKeys,a=e.checkedKeys,l=e.loadedKeys,c=e.loadingKeys,d=e.halfCheckedKeys,u=e.keyEntities,h=e.disabled,p=e.dragging,y=e.dragOverNodeKey,g=e.dropPosition,m=e.motion,f=e.height,b=e.itemHeight,_=e.virtual,w=e.scrollWidth,L=e.focusable,T=e.activeItem,M=e.focused,I=e.tabIndex,O=e.onKeyDown,P=e.onFocus,A=e.onBlur,R=e.onActiveChange,$=e.onListChangeStart,N=e.onListChangeEnd,F=(0,S.Z)(e,Q),V=v.useRef(null),z=v.useRef(null);v.useImperativeHandle(t,(function(){return{scrollTo:function(e){V.current.scrollTo(e)},getIndentWidth:function(){return z.current.offsetWidth}}}));var B=v.useState(s),U=(0,x.Z)(B,2),H=U[0],G=U[1],j=v.useState(o),K=(0,x.Z)(j,2),W=K[0],Y=K[1],q=v.useState(o),ne=(0,x.Z)(q,2),oe=ne[0],le=ne[1],ce=v.useState([]),de=(0,x.Z)(ce,2),ue=de[0],he=de[1],pe=v.useState(null),ye=(0,x.Z)(pe,2),ge=ye[0],me=ye[1],fe=v.useRef(o);function ve(){var e=fe.current;Y(e),le(e),he([]),me(null),N()}fe.current=o,(0,E.Z)((function(){G(s);var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=e.length,n=t.length;if(1!==Math.abs(i-n))return{add:!1,key:null};function o(e,t){var i=new Map;e.forEach((function(e){i.set(e,!0)}));var n=t.filter((function(e){return!i.has(e)}));return 1===n.length?n[0]:null}return i<n?{add:!0,key:o(e,t)}:{add:!1,key:o(t,e)}}(H,s);if(null!==e.key)if(e.add){var t=W.findIndex((function(t){return t.key===e.key})),i=re(J(W,o,e.key),_,f,b),n=W.slice();n.splice(t+1,0,se),le(n),he(i),me("show")}else{var r=o.findIndex((function(t){return t.key===e.key})),a=re(J(o,W,e.key),_,f,b),l=o.slice();l.splice(r+1,0,se),le(l),he(a),me("hide")}else W!==o&&(Y(o),le(o))}),[s,o]),v.useEffect((function(){p||ve()}),[p]);var be=m?oe:o,_e={expandedKeys:s,selectedKeys:r,loadedKeys:l,loadingKeys:c,checkedKeys:a,halfCheckedKeys:d,dragOverNodeKey:y,dropPosition:g,keyEntities:u};return v.createElement(v.Fragment,null,M&&T&&v.createElement("span",{style:ee,"aria-live":"assertive"},function(e){for(var t=String(e.data.key),i=e;i.parent;)i=i.parent,t="".concat(i.data.key," > ").concat(t);return t}(T)),v.createElement("div",null,v.createElement("input",{style:ee,disabled:!1===L||h,tabIndex:!1!==L?I:null,onKeyDown:O,onFocus:P,onBlur:A,value:"",onChange:te,"aria-label":"for screen reader"})),v.createElement("div",{className:"".concat(i,"-treenode"),"aria-hidden":!0,style:{position:"absolute",pointerEvents:"none",visibility:"hidden",height:0,overflow:"hidden",border:0,padding:0}},v.createElement("div",{className:"".concat(i,"-indent")},v.createElement("div",{ref:z,className:"".concat(i,"-indent-unit")}))),v.createElement(k.Z,(0,n.Z)({},F,{data:be,itemKey:ae,height:f,fullHeight:!1,virtual:_,itemHeight:b,scrollWidth:w,prefixCls:"".concat(i,"-list"),ref:V,role:"tree",onVisibleChange:function(e){e.every((function(e){return ae(e)!==ie}))&&ve()}}),(function(e){var t=e.pos,i=Object.assign({},(C(e.data),e.data)),o=e.title,s=e.key,r=e.isStart,a=e.isEnd,l=D(s,t);delete i.key,delete i.children;var c=Z(l,_e);return v.createElement(X,(0,n.Z)({},i,c,{title:o,active:!!T&&s===T.key,pos:t,data:e.data,isStart:r,isEnd:a,motion:m,motionNodes:s===ie?ue:null,motionType:ge,onMotionStart:$,onMotionEnd:ve,treeNodeRequiredProps:_e,onMouseMove:function(){R(null)}}))})))}));var ce=le;function de(e,t){if(!e)return[];var i=e.slice(),n=i.indexOf(t);return n>=0&&i.splice(n,1),i}function ue(e,t){var i=(e||[]).slice();return-1===i.indexOf(t)&&i.push(t),i}function he(e){return e.split("-")}function pe(e,t){var i=[];return function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach((function(t){var n=t.key,o=t.children;i.push(n),e(o)}))}(I(t,e).children),i}function ye(e){if(e.parent){var t=he(e.pos);return Number(t[t.length-1])===e.parent.children.length-1}return!1}function ge(e,t,i,n,o,s,r,a,l,c){var d,u=e.clientX,h=e.clientY,p=e.target.getBoundingClientRect(),y=p.top,g=p.height,m=(("rtl"===c?-1:1)*(((null==o?void 0:o.x)||0)-u)-12)/n,f=l.filter((function(e){var t;return null===(t=a[e])||void 0===t||null===(t=t.children)||void 0===t?void 0:t.length})),v=I(a,i.eventKey);if(h<y+g/2){var b=r.findIndex((function(e){return e.key===v.key})),_=r[b<=0?0:b-1].key;v=I(a,_)}var w=v.key,C=v,x=v.key,S=0,E=0;if(!f.includes(w))for(var k=0;k<m&&ye(v);k+=1)v=v.parent,E+=1;var L,T=t.data,M=v.node,O=!0;return L=he(v.pos),0===Number(L[L.length-1])&&0===v.level&&h<y+g/2&&s({dragNode:T,dropNode:M,dropPosition:-1})&&v.key===i.eventKey?S=-1:(C.children||[]).length&&f.includes(x)?s({dragNode:T,dropNode:M,dropPosition:0})?S=0:O=!1:0===E?m>-1.5?s({dragNode:T,dropNode:M,dropPosition:1})?S=1:O=!1:s({dragNode:T,dropNode:M,dropPosition:0})?S=0:s({dragNode:T,dropNode:M,dropPosition:1})?S=1:O=!1:s({dragNode:T,dropNode:M,dropPosition:1})?S=1:O=!1,{dropPosition:S,dropLevelOffset:E,dropTargetKey:v.key,dropTargetPos:v.pos,dragOverNodeKey:x,dropContainerKey:0===S?null:(null===(d=v.parent)||void 0===d?void 0:d.key)||null,dropAllowed:O}}function me(e,t){if(e)return t.multiple?e.slice():e.length?[e[0]]:e}function fe(e){if(!e)return null;var t;if(Array.isArray(e))t={checkedKeys:e,halfCheckedKeys:void 0};else{if("object"!==(0,o.Z)(e))return(0,f.ZP)(!1,"`checkedKeys` is not an array or an object"),null;t={checkedKeys:e.checked||void 0,halfCheckedKeys:e.halfChecked||void 0}}return t}function ve(e,t){var i=new Set;function n(e){if(!i.has(e)){var o=I(t,e);if(o){i.add(e);var s=o.parent;o.node.disabled||s&&n(s.key)}}}return(e||[]).forEach((function(e){n(e)})),(0,r.Z)(i)}function be(e,t){var i=new Set;return e.forEach((function(e){t.has(e)||i.add(e)})),i}function _e(e){var t=e||{},i=t.disabled,n=t.disableCheckbox,o=t.checkable;return!(!i&&!n)||!1===o}function we(e,t,i,n){var o,s=[];o=n||_e;var r,a=new Set(e.filter((function(e){var t=!!I(i,e);return t||s.push(e),t}))),l=new Map,c=0;return Object.keys(i).forEach((function(e){var t=i[e],n=t.level,o=l.get(n);o||(o=new Set,l.set(n,o)),o.add(t),c=Math.max(c,n)})),(0,f.ZP)(!s.length,"Tree missing follow keys: ".concat(s.slice(0,100).map((function(e){return"'".concat(e,"'")})).join(", "))),r=!0===t?function(e,t,i,n){for(var o=new Set(e),s=new Set,r=0;r<=i;r+=1)(t.get(r)||new Set).forEach((function(e){var t=e.key,i=e.node,s=e.children,r=void 0===s?[]:s;o.has(t)&&!n(i)&&r.filter((function(e){return!n(e.node)})).forEach((function(e){o.add(e.key)}))}));for(var a=new Set,l=i;l>=0;l-=1)(t.get(l)||new Set).forEach((function(e){var t=e.parent,i=e.node;if(!n(i)&&e.parent&&!a.has(e.parent.key))if(n(e.parent.node))a.add(t.key);else{var r=!0,l=!1;(t.children||[]).filter((function(e){return!n(e.node)})).forEach((function(e){var t=e.key,i=o.has(t);r&&!i&&(r=!1),l||!i&&!s.has(t)||(l=!0)})),r&&o.add(t.key),l&&s.add(t.key),a.add(t.key)}}));return{checkedKeys:Array.from(o),halfCheckedKeys:Array.from(be(s,o))}}(a,l,c,o):function(e,t,i,n,o){for(var s=new Set(e),r=new Set(t),a=0;a<=n;a+=1)(i.get(a)||new Set).forEach((function(e){var t=e.key,i=e.node,n=e.children,a=void 0===n?[]:n;s.has(t)||r.has(t)||o(i)||a.filter((function(e){return!o(e.node)})).forEach((function(e){s.delete(e.key)}))}));r=new Set;for(var l=new Set,c=n;c>=0;c-=1)(i.get(c)||new Set).forEach((function(e){var t=e.parent,i=e.node;if(!o(i)&&e.parent&&!l.has(e.parent.key))if(o(e.parent.node))l.add(t.key);else{var n=!0,a=!1;(t.children||[]).filter((function(e){return!o(e.node)})).forEach((function(e){var t=e.key,i=s.has(t);n&&!i&&(n=!1),a||!i&&!r.has(t)||(a=!0)})),n||s.delete(t.key),a&&r.add(t.key),l.add(t.key)}}));return{checkedKeys:Array.from(s),halfCheckedKeys:Array.from(be(r,s))}}(a,t.halfCheckedKeys,l,c,o),r}var Ce=function(e){(0,d.Z)(i,e);var t=(0,u.Z)(i);function i(){var e;(0,a.Z)(this,i);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return e=t.call.apply(t,[this].concat(o)),(0,h.Z)((0,c.Z)(e),"destroyed",!1),(0,h.Z)((0,c.Z)(e),"delayedDragEnterLogic",void 0),(0,h.Z)((0,c.Z)(e),"loadingRetryTimes",{}),(0,h.Z)((0,c.Z)(e),"state",{keyEntities:{},indent:null,selectedKeys:[],checkedKeys:[],halfCheckedKeys:[],loadedKeys:[],loadingKeys:[],expandedKeys:[],draggingNodeKey:null,dragChildrenKeys:[],dropTargetKey:null,dropPosition:null,dropContainerKey:null,dropLevelOffset:null,dropTargetPos:null,dropAllowed:!0,dragOverNodeKey:null,treeData:[],flattenNodes:[],focused:!1,activeKey:null,listChanging:!1,prevProps:null,fieldNames:$()}),(0,h.Z)((0,c.Z)(e),"dragStartMousePosition",null),(0,h.Z)((0,c.Z)(e),"dragNodeProps",null),(0,h.Z)((0,c.Z)(e),"currentMouseOverDroppableNodeKey",null),(0,h.Z)((0,c.Z)(e),"listRef",v.createRef()),(0,h.Z)((0,c.Z)(e),"onNodeDragStart",(function(t,i){var n=e.state,o=n.expandedKeys,s=n.keyEntities,r=e.props.onDragStart,a=i.eventKey;e.dragNodeProps=i,e.dragStartMousePosition={x:t.clientX,y:t.clientY};var l=de(o,a);e.setState({draggingNodeKey:a,dragChildrenKeys:pe(a,s),indent:e.listRef.current.getIndentWidth()}),e.setExpandedKeys(l),window.addEventListener("dragend",e.onWindowDragEnd),null==r||r({event:t,node:B(i)})})),(0,h.Z)((0,c.Z)(e),"onNodeDragEnter",(function(t,i){var n=e.state,o=n.expandedKeys,s=n.keyEntities,a=n.dragChildrenKeys,l=n.flattenNodes,c=n.indent,d=e.props,u=d.onDragEnter,h=d.onExpand,p=d.allowDrop,y=d.direction,g=i.pos,m=i.eventKey;if(e.currentMouseOverDroppableNodeKey!==m&&(e.currentMouseOverDroppableNodeKey=m),e.dragNodeProps){var f=ge(t,e.dragNodeProps,i,c,e.dragStartMousePosition,p,l,s,o,y),v=f.dropPosition,b=f.dropLevelOffset,_=f.dropTargetKey,w=f.dropContainerKey,C=f.dropTargetPos,x=f.dropAllowed,S=f.dragOverNodeKey;!a.includes(_)&&x?(e.delayedDragEnterLogic||(e.delayedDragEnterLogic={}),Object.keys(e.delayedDragEnterLogic).forEach((function(t){clearTimeout(e.delayedDragEnterLogic[t])})),e.dragNodeProps.eventKey!==i.eventKey&&(t.persist(),e.delayedDragEnterLogic[g]=window.setTimeout((function(){if(null!==e.state.draggingNodeKey){var n=(0,r.Z)(o),a=I(s,i.eventKey);a&&(a.children||[]).length&&(n=ue(o,i.eventKey)),e.props.hasOwnProperty("expandedKeys")||e.setExpandedKeys(n),null==h||h(n,{node:B(i),expanded:!0,nativeEvent:t.nativeEvent})}}),800)),e.dragNodeProps.eventKey!==_||0!==b?(e.setState({dragOverNodeKey:S,dropPosition:v,dropLevelOffset:b,dropTargetKey:_,dropContainerKey:w,dropTargetPos:C,dropAllowed:x}),null==u||u({event:t,node:B(i),expandedKeys:o})):e.resetDragState()):e.resetDragState()}else e.resetDragState()})),(0,h.Z)((0,c.Z)(e),"onNodeDragOver",(function(t,i){var n=e.state,o=n.dragChildrenKeys,s=n.flattenNodes,r=n.keyEntities,a=n.expandedKeys,l=n.indent,c=e.props,d=c.onDragOver,u=c.allowDrop,h=c.direction;if(e.dragNodeProps){var p=ge(t,e.dragNodeProps,i,l,e.dragStartMousePosition,u,s,r,a,h),y=p.dropPosition,g=p.dropLevelOffset,m=p.dropTargetKey,f=p.dropContainerKey,v=p.dropTargetPos,b=p.dropAllowed,_=p.dragOverNodeKey;!o.includes(m)&&b&&(e.dragNodeProps.eventKey===m&&0===g?null===e.state.dropPosition&&null===e.state.dropLevelOffset&&null===e.state.dropTargetKey&&null===e.state.dropContainerKey&&null===e.state.dropTargetPos&&!1===e.state.dropAllowed&&null===e.state.dragOverNodeKey||e.resetDragState():y===e.state.dropPosition&&g===e.state.dropLevelOffset&&m===e.state.dropTargetKey&&f===e.state.dropContainerKey&&v===e.state.dropTargetPos&&b===e.state.dropAllowed&&_===e.state.dragOverNodeKey||e.setState({dropPosition:y,dropLevelOffset:g,dropTargetKey:m,dropContainerKey:f,dropTargetPos:v,dropAllowed:b,dragOverNodeKey:_}),null==d||d({event:t,node:B(i)}))}})),(0,h.Z)((0,c.Z)(e),"onNodeDragLeave",(function(t,i){e.currentMouseOverDroppableNodeKey!==i.eventKey||t.currentTarget.contains(t.relatedTarget)||(e.resetDragState(),e.currentMouseOverDroppableNodeKey=null);var n=e.props.onDragLeave;null==n||n({event:t,node:B(i)})})),(0,h.Z)((0,c.Z)(e),"onWindowDragEnd",(function(t){e.onNodeDragEnd(t,null,!0),window.removeEventListener("dragend",e.onWindowDragEnd)})),(0,h.Z)((0,c.Z)(e),"onNodeDragEnd",(function(t,i){var n=e.props.onDragEnd;e.setState({dragOverNodeKey:null}),e.cleanDragState(),null==n||n({event:t,node:B(i)}),e.dragNodeProps=null,window.removeEventListener("dragend",e.onWindowDragEnd)})),(0,h.Z)((0,c.Z)(e),"onNodeDrop",(function(t,i){var n,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.state,a=r.dragChildrenKeys,l=r.dropPosition,c=r.dropTargetKey,d=r.dropTargetPos,u=r.dropAllowed;if(u){var h=e.props.onDrop;if(e.setState({dragOverNodeKey:null}),e.cleanDragState(),null!==c){var p=(0,s.Z)((0,s.Z)({},Z(c,e.getTreeNodeRequiredProps())),{},{active:(null===(n=e.getActiveItem())||void 0===n?void 0:n.key)===c,data:I(e.state.keyEntities,c).node}),y=a.includes(c);(0,f.ZP)(!y,"Can not drop to dragNode's children node. This is a bug of rc-tree. Please report an issue.");var g=he(d),m={event:t,node:B(p),dragNode:e.dragNodeProps?B(e.dragNodeProps):null,dragNodesKeys:[e.dragNodeProps.eventKey].concat(a),dropToGap:0!==l,dropPosition:l+Number(g[g.length-1])};o||null==h||h(m),e.dragNodeProps=null}}})),(0,h.Z)((0,c.Z)(e),"cleanDragState",(function(){null!==e.state.draggingNodeKey&&e.setState({draggingNodeKey:null,dropPosition:null,dropContainerKey:null,dropTargetKey:null,dropLevelOffset:null,dropAllowed:!0,dragOverNodeKey:null}),e.dragStartMousePosition=null,e.currentMouseOverDroppableNodeKey=null})),(0,h.Z)((0,c.Z)(e),"triggerExpandActionExpand",(function(t,i){var n=e.state,o=n.expandedKeys,r=n.flattenNodes,a=i.expanded,l=i.key;if(!(i.isLeaf||t.shiftKey||t.metaKey||t.ctrlKey)){var c=r.filter((function(e){return e.key===l}))[0],d=B((0,s.Z)((0,s.Z)({},Z(l,e.getTreeNodeRequiredProps())),{},{data:c.data}));e.setExpandedKeys(a?de(o,l):ue(o,l)),e.onNodeExpand(t,d)}})),(0,h.Z)((0,c.Z)(e),"onNodeClick",(function(t,i){var n=e.props,o=n.onClick;"click"===n.expandAction&&e.triggerExpandActionExpand(t,i),null==o||o(t,i)})),(0,h.Z)((0,c.Z)(e),"onNodeDoubleClick",(function(t,i){var n=e.props,o=n.onDoubleClick;"doubleClick"===n.expandAction&&e.triggerExpandActionExpand(t,i),null==o||o(t,i)})),(0,h.Z)((0,c.Z)(e),"onNodeSelect",(function(t,i){var n=e.state.selectedKeys,o=e.state,s=o.keyEntities,r=o.fieldNames,a=e.props,l=a.onSelect,c=a.multiple,d=i.selected,u=i[r.key],h=!d,p=(n=h?c?ue(n,u):[u]:de(n,u)).map((function(e){var t=I(s,e);return t?t.node:null})).filter(Boolean);e.setUncontrolledState({selectedKeys:n}),null==l||l(n,{event:"select",selected:h,node:i,selectedNodes:p,nativeEvent:t.nativeEvent})})),(0,h.Z)((0,c.Z)(e),"onNodeCheck",(function(t,i,n){var o,s=e.state,a=s.keyEntities,l=s.checkedKeys,c=s.halfCheckedKeys,d=e.props,u=d.checkStrictly,h=d.onCheck,p=i.key,y={event:"check",node:i,checked:n,nativeEvent:t.nativeEvent};if(u){var g=n?ue(l,p):de(l,p);o={checked:g,halfChecked:de(c,p)},y.checkedNodes=g.map((function(e){return I(a,e)})).filter(Boolean).map((function(e){return e.node})),e.setUncontrolledState({checkedKeys:g})}else{var m=we([].concat((0,r.Z)(l),[p]),!0,a),f=m.checkedKeys,v=m.halfCheckedKeys;if(!n){var b=new Set(f);b.delete(p);var _=we(Array.from(b),{checked:!1,halfCheckedKeys:v},a);f=_.checkedKeys,v=_.halfCheckedKeys}o=f,y.checkedNodes=[],y.checkedNodesPositions=[],y.halfCheckedKeys=v,f.forEach((function(e){var t=I(a,e);if(t){var i=t.node,n=t.pos;y.checkedNodes.push(i),y.checkedNodesPositions.push({node:i,pos:n})}})),e.setUncontrolledState({checkedKeys:f},!1,{halfCheckedKeys:v})}null==h||h(o,y)})),(0,h.Z)((0,c.Z)(e),"onNodeLoad",(function(t){var i,n=t.key,o=I(e.state.keyEntities,n);if(null==o||null===(i=o.children)||void 0===i||!i.length){var s=new Promise((function(i,o){e.setState((function(s){var r=s.loadedKeys,a=void 0===r?[]:r,l=s.loadingKeys,c=void 0===l?[]:l,d=e.props,u=d.loadData,h=d.onLoad;return!u||a.includes(n)||c.includes(n)?null:(u(t).then((function(){var o=ue(e.state.loadedKeys,n);null==h||h(o,{event:"load",node:t}),e.setUncontrolledState({loadedKeys:o}),e.setState((function(e){return{loadingKeys:de(e.loadingKeys,n)}})),i()})).catch((function(t){if(e.setState((function(e){return{loadingKeys:de(e.loadingKeys,n)}})),e.loadingRetryTimes[n]=(e.loadingRetryTimes[n]||0)+1,e.loadingRetryTimes[n]>=10){var s=e.state.loadedKeys;(0,f.ZP)(!1,"Retry for `loadData` many times but still failed. No more retry."),e.setUncontrolledState({loadedKeys:ue(s,n)}),i()}o(t)})),{loadingKeys:ue(c,n)})}))}));return s.catch((function(){})),s}})),(0,h.Z)((0,c.Z)(e),"onNodeMouseEnter",(function(t,i){var n=e.props.onMouseEnter;null==n||n({event:t,node:i})})),(0,h.Z)((0,c.Z)(e),"onNodeMouseLeave",(function(t,i){var n=e.props.onMouseLeave;null==n||n({event:t,node:i})})),(0,h.Z)((0,c.Z)(e),"onNodeContextMenu",(function(t,i){var n=e.props.onRightClick;n&&(t.preventDefault(),n({event:t,node:i}))})),(0,h.Z)((0,c.Z)(e),"onFocus",(function(){var t=e.props.onFocus;e.setState({focused:!0});for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];null==t||t.apply(void 0,n)})),(0,h.Z)((0,c.Z)(e),"onBlur",(function(){var t=e.props.onBlur;e.setState({focused:!1}),e.onActiveChange(null);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];null==t||t.apply(void 0,n)})),(0,h.Z)((0,c.Z)(e),"getTreeNodeRequiredProps",(function(){var t=e.state;return{expandedKeys:t.expandedKeys||[],selectedKeys:t.selectedKeys||[],loadedKeys:t.loadedKeys||[],loadingKeys:t.loadingKeys||[],checkedKeys:t.checkedKeys||[],halfCheckedKeys:t.halfCheckedKeys||[],dragOverNodeKey:t.dragOverNodeKey,dropPosition:t.dropPosition,keyEntities:t.keyEntities}})),(0,h.Z)((0,c.Z)(e),"setExpandedKeys",(function(t){var i=e.state,n=F(i.treeData,t,i.fieldNames);e.setUncontrolledState({expandedKeys:t,flattenNodes:n},!0)})),(0,h.Z)((0,c.Z)(e),"onNodeExpand",(function(t,i){var n=e.state.expandedKeys,o=e.state,s=o.listChanging,r=o.fieldNames,a=e.props,l=a.onExpand,c=a.loadData,d=i.expanded,u=i[r.key];if(!s){var h=n.includes(u),p=!d;if((0,f.ZP)(d&&h||!d&&!h,"Expand state not sync with index check"),n=p?ue(n,u):de(n,u),e.setExpandedKeys(n),null==l||l(n,{node:i,expanded:p,nativeEvent:t.nativeEvent}),p&&c){var y=e.onNodeLoad(i);y&&y.then((function(){var t=F(e.state.treeData,n,r);e.setUncontrolledState({flattenNodes:t})})).catch((function(){var t=de(e.state.expandedKeys,u);e.setExpandedKeys(t)}))}}})),(0,h.Z)((0,c.Z)(e),"onListChangeStart",(function(){e.setUncontrolledState({listChanging:!0})})),(0,h.Z)((0,c.Z)(e),"onListChangeEnd",(function(){setTimeout((function(){e.setUncontrolledState({listChanging:!1})}))})),(0,h.Z)((0,c.Z)(e),"onActiveChange",(function(t){var i=e.state.activeKey,n=e.props,o=n.onActiveChange,s=n.itemScrollOffset,r=void 0===s?0:s;i!==t&&(e.setState({activeKey:t}),null!==t&&e.scrollTo({key:t,offset:r}),null==o||o(t))})),(0,h.Z)((0,c.Z)(e),"getActiveItem",(function(){var t=e.state,i=t.activeKey,n=t.flattenNodes;return null===i?null:n.find((function(e){return e.key===i}))||null})),(0,h.Z)((0,c.Z)(e),"offsetActiveKey",(function(t){var i=e.state,n=i.flattenNodes,o=i.activeKey,s=n.findIndex((function(e){return e.key===o}));-1===s&&t<0&&(s=n.length);var r=n[s=(s+t+n.length)%n.length];if(r){var a=r.key;e.onActiveChange(a)}else e.onActiveChange(null)})),(0,h.Z)((0,c.Z)(e),"onKeyDown",(function(t){var i=e.state,n=i.activeKey,o=i.expandedKeys,r=i.checkedKeys,a=i.fieldNames,l=e.props,c=l.onKeyDown,d=l.checkable,u=l.selectable;switch(t.which){case g.Z.UP:e.offsetActiveKey(-1),t.preventDefault();break;case g.Z.DOWN:e.offsetActiveKey(1),t.preventDefault()}var h=e.getActiveItem();if(h&&h.data){var p=e.getTreeNodeRequiredProps(),y=!1===h.data.isLeaf||!!(h.data[a.children]||[]).length,m=B((0,s.Z)((0,s.Z)({},Z(n,p)),{},{data:h.data,active:!0}));switch(t.which){case g.Z.LEFT:y&&o.includes(n)?e.onNodeExpand({},m):h.parent&&e.onActiveChange(h.parent.key),t.preventDefault();break;case g.Z.RIGHT:y&&!o.includes(n)?e.onNodeExpand({},m):h.children&&h.children.length&&e.onActiveChange(h.children[0].key),t.preventDefault();break;case g.Z.ENTER:case g.Z.SPACE:!d||m.disabled||!1===m.checkable||m.disableCheckbox?d||!u||m.disabled||!1===m.selectable||e.onNodeSelect({},m):e.onNodeCheck({},m,!r.includes(n))}}null==c||c(t)})),(0,h.Z)((0,c.Z)(e),"setUncontrolledState",(function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e.destroyed){var o=!1,r=!0,a={};Object.keys(t).forEach((function(i){e.props.hasOwnProperty(i)?r=!1:(o=!0,a[i]=t[i])})),!o||i&&!r||e.setState((0,s.Z)((0,s.Z)({},a),n))}})),(0,h.Z)((0,c.Z)(e),"scrollTo",(function(t){e.listRef.current.scrollTo(t)})),e}return(0,l.Z)(i,[{key:"componentDidMount",value:function(){this.destroyed=!1,this.onUpdated()}},{key:"componentDidUpdate",value:function(){this.onUpdated()}},{key:"onUpdated",value:function(){var e=this.props,t=e.activeKey,i=e.itemScrollOffset,n=void 0===i?0:i;void 0!==t&&t!==this.state.activeKey&&(this.setState({activeKey:t}),null!==t&&this.scrollTo({key:t,offset:n}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("dragend",this.onWindowDragEnd),this.destroyed=!0}},{key:"resetDragState",value:function(){this.setState({dragOverNodeKey:null,dropPosition:null,dropLevelOffset:null,dropTargetKey:null,dropContainerKey:null,dropTargetPos:null,dropAllowed:!1})}},{key:"render",value:function(){var e,t=this.state,i=t.focused,s=t.flattenNodes,r=t.keyEntities,a=t.draggingNodeKey,l=t.activeKey,c=t.dropLevelOffset,d=t.dropContainerKey,u=t.dropTargetKey,p=t.dropPosition,g=t.dragOverNodeKey,f=t.indent,_=this.props,w=_.prefixCls,C=_.className,x=_.style,S=_.showLine,E=_.focusable,k=_.tabIndex,L=void 0===k?0:k,T=_.selectable,M=_.showIcon,I=_.icon,O=_.switcherIcon,P=_.draggable,A=_.checkable,R=_.checkStrictly,D=_.disabled,$=_.motion,N=_.loadData,F=_.filterTreeNode,V=_.height,z=_.itemHeight,Z=_.scrollWidth,B=_.virtual,U=_.titleRender,H=_.dropIndicatorRender,G=_.onContextMenu,j=_.onScroll,K=_.direction,W=_.rootClassName,Y=_.rootStyle,q=(0,m.Z)(this.props,{aria:!0,data:!0});P&&(e="object"===(0,o.Z)(P)?P:"function"==typeof P?{nodeDraggable:P}:{});var X={prefixCls:w,selectable:T,showIcon:M,icon:I,switcherIcon:O,draggable:e,draggingNodeKey:a,checkable:A,checkStrictly:R,disabled:D,keyEntities:r,dropLevelOffset:c,dropContainerKey:d,dropTargetKey:u,dropPosition:p,dragOverNodeKey:g,indent:f,direction:K,dropIndicatorRender:H,loadData:N,filterTreeNode:F,titleRender:U,onNodeClick:this.onNodeClick,onNodeDoubleClick:this.onNodeDoubleClick,onNodeExpand:this.onNodeExpand,onNodeSelect:this.onNodeSelect,onNodeCheck:this.onNodeCheck,onNodeLoad:this.onNodeLoad,onNodeMouseEnter:this.onNodeMouseEnter,onNodeMouseLeave:this.onNodeMouseLeave,onNodeContextMenu:this.onNodeContextMenu,onNodeDragStart:this.onNodeDragStart,onNodeDragEnter:this.onNodeDragEnter,onNodeDragOver:this.onNodeDragOver,onNodeDragLeave:this.onNodeDragLeave,onNodeDragEnd:this.onNodeDragEnd,onNodeDrop:this.onNodeDrop};return v.createElement(b.Provider,{value:X},v.createElement("div",{className:y()(w,C,W,(0,h.Z)((0,h.Z)((0,h.Z)({},"".concat(w,"-show-line"),S),"".concat(w,"-focused"),i),"".concat(w,"-active-focused"),null!==l)),style:Y},v.createElement(ce,(0,n.Z)({ref:this.listRef,prefixCls:w,style:x,data:s,disabled:D,selectable:T,checkable:!!A,motion:$,dragging:null!==a,height:V,itemHeight:z,virtual:B,focusable:E,focused:i,tabIndex:L,activeItem:this.getActiveItem(),onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown,onActiveChange:this.onActiveChange,onListChangeStart:this.onListChangeStart,onListChangeEnd:this.onListChangeEnd,onContextMenu:G,onScroll:j,scrollWidth:Z},this.getTreeNodeRequiredProps(),q))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var i,n=t.prevProps,o={prevProps:e};function r(t){return!n&&e.hasOwnProperty(t)||n&&n[t]!==e[t]}var a=t.fieldNames;if(r("fieldNames")&&(a=$(e.fieldNames),o.fieldNames=a),r("treeData")?i=e.treeData:r("children")&&((0,f.ZP)(!1,"`children` of Tree is deprecated. Please use `treeData` instead."),i=N(e.children)),i){o.treeData=i;var l=z(i,{fieldNames:a});o.keyEntities=(0,s.Z)((0,h.Z)({},ie,oe),l.keyEntities)}var c,d=o.keyEntities||t.keyEntities;if(r("expandedKeys")||n&&r("autoExpandParent"))o.expandedKeys=e.autoExpandParent||!n&&e.defaultExpandParent?ve(e.expandedKeys,d):e.expandedKeys;else if(!n&&e.defaultExpandAll){var u=(0,s.Z)({},d);delete u[ie];var p=[];Object.keys(u).forEach((function(e){var t=u[e];t.children&&t.children.length&&p.push(t.key)})),o.expandedKeys=p}else!n&&e.defaultExpandedKeys&&(o.expandedKeys=e.autoExpandParent||e.defaultExpandParent?ve(e.defaultExpandedKeys,d):e.defaultExpandedKeys);if(o.expandedKeys||delete o.expandedKeys,i||o.expandedKeys){var y=F(i||t.treeData,o.expandedKeys||t.expandedKeys,a);o.flattenNodes=y}if((e.selectable&&(r("selectedKeys")?o.selectedKeys=me(e.selectedKeys,e):!n&&e.defaultSelectedKeys&&(o.selectedKeys=me(e.defaultSelectedKeys,e))),e.checkable)&&(r("checkedKeys")?c=fe(e.checkedKeys)||{}:!n&&e.defaultCheckedKeys?c=fe(e.defaultCheckedKeys)||{}:i&&(c=fe(e.checkedKeys)||{checkedKeys:t.checkedKeys,halfCheckedKeys:t.halfCheckedKeys}),c)){var g=c,m=g.checkedKeys,v=void 0===m?[]:m,b=g.halfCheckedKeys,_=void 0===b?[]:b;if(!e.checkStrictly){var w=we(v,!0,d);v=w.checkedKeys,_=w.halfCheckedKeys}o.checkedKeys=v,o.halfCheckedKeys=_}return r("loadedKeys")&&(o.loadedKeys=e.loadedKeys),o}}]),i}(v.Component);(0,h.Z)(Ce,"defaultProps",{prefixCls:"rc-tree",showLine:!1,showIcon:!0,selectable:!0,multiple:!1,checkable:!1,disabled:!1,checkStrictly:!1,draggable:!1,defaultExpandParent:!0,autoExpandParent:!1,defaultExpandAll:!1,defaultExpandedKeys:[],defaultCheckedKeys:[],defaultSelectedKeys:[],dropIndicatorRender:w,allowDrop:function(){return!0},expandAction:!1}),(0,h.Z)(Ce,"TreeNode",K);var xe=Ce,Se={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file",theme:"outlined"},Ee=i(43638),ke=function(e,t){return v.createElement(Ee.Z,(0,n.Z)({},e,{ref:t,icon:Se}))};var Le=v.forwardRef(ke),Te={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 444H820V330.4c0-17.7-14.3-32-32-32H473L355.7 186.2a8.15 8.15 0 00-5.5-2.2H96c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h698c13 0 24.8-7.9 29.7-20l134-332c1.5-3.8 2.3-7.9 2.3-12 0-17.7-14.3-32-32-32zM136 256h188.5l119.6 114.4H748V444H238c-13 0-24.8 7.9-29.7 20L136 643.2V256zm635.3 512H159l103.3-256h612.4L771.3 768z"}}]},name:"folder-open",theme:"outlined"},Me=function(e,t){return v.createElement(Ee.Z,(0,n.Z)({},e,{ref:t,icon:Te}))};var Ie=v.forwardRef(Me),Oe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 298.4H521L403.7 186.2a8.15 8.15 0 00-5.5-2.2H144c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V330.4c0-17.7-14.3-32-32-32zM840 768H184V256h188.5l119.6 114.4H840V768z"}}]},name:"folder",theme:"outlined"},Pe=function(e,t){return v.createElement(Ee.Z,(0,n.Z)({},e,{ref:t,icon:Oe}))};var Ae=v.forwardRef(Pe),Re=i(26402),De={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M300 276.5a56 56 0 1056-97 56 56 0 00-56 97zm0 284a56 56 0 1056-97 56 56 0 00-56 97zM640 228a56 56 0 10112 0 56 56 0 00-112 0zm0 284a56 56 0 10112 0 56 56 0 00-112 0zM300 844.5a56 56 0 1056-97 56 56 0 00-56 97zM640 796a56 56 0 10112 0 56 56 0 00-112 0z"}}]},name:"holder",theme:"outlined"},$e=function(e,t){return v.createElement(Ee.Z,(0,n.Z)({},e,{ref:t,icon:De}))};var Ne=v.forwardRef($e),Fe=i(21358),Ve=i(87530),ze=i(28546),Ze=i(22582),Be=i(36480),Ue=i(91945);const He=e=>{const{checkboxCls:t}=e,i=`${t}-wrapper`;return[{[`${t}-group`]:Object.assign(Object.assign({},(0,Ze.Wf)(e)),{display:"inline-flex",flexWrap:"wrap",columnGap:e.marginXS,[`> ${e.antCls}-row`]:{flex:1}}),[i]:Object.assign(Object.assign({},(0,Ze.Wf)(e)),{display:"inline-flex",alignItems:"baseline",cursor:"pointer","&:after":{display:"inline-block",width:0,overflow:"hidden",content:"'\\a0'"},[`& + ${i}`]:{marginInlineStart:0},[`&${i}-in-form-item`]:{'input[type="checkbox"]':{width:14,height:14}}}),[t]:Object.assign(Object.assign({},(0,Ze.Wf)(e)),{position:"relative",whiteSpace:"nowrap",lineHeight:1,cursor:"pointer",borderRadius:e.borderRadiusSM,alignSelf:"center",[`${t}-input`]:{position:"absolute",inset:0,zIndex:1,cursor:"pointer",opacity:0,margin:0,[`&:focus-visible + ${t}-inner`]:Object.assign({},(0,Ze.oN)(e))},[`${t}-inner`]:{boxSizing:"border-box",display:"block",width:e.checkboxSize,height:e.checkboxSize,direction:"ltr",backgroundColor:e.colorBgContainer,border:`${(0,ze.bf)(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,borderCollapse:"separate",transition:`all ${e.motionDurationSlow}`,"&:after":{boxSizing:"border-box",position:"absolute",top:"50%",insetInlineStart:"25%",display:"table",width:e.calc(e.checkboxSize).div(14).mul(5).equal(),height:e.calc(e.checkboxSize).div(14).mul(8).equal(),border:`${(0,ze.bf)(e.lineWidthBold)} solid ${e.colorWhite}`,borderTop:0,borderInlineStart:0,transform:"rotate(45deg) scale(0) translate(-50%,-50%)",opacity:0,content:'""',transition:`all ${e.motionDurationFast} ${e.motionEaseInBack}, opacity ${e.motionDurationFast}`}},"& + span":{paddingInlineStart:e.paddingXS,paddingInlineEnd:e.paddingXS}})},{[`\n        ${i}:not(${i}-disabled),\n        ${t}:not(${t}-disabled)\n      `]:{[`&:hover ${t}-inner`]:{borderColor:e.colorPrimary}},[`${i}:not(${i}-disabled)`]:{[`&:hover ${t}-checked:not(${t}-disabled) ${t}-inner`]:{backgroundColor:e.colorPrimaryHover,borderColor:"transparent"},[`&:hover ${t}-checked:not(${t}-disabled):after`]:{borderColor:e.colorPrimaryHover}}},{[`${t}-checked`]:{[`${t}-inner`]:{backgroundColor:e.colorPrimary,borderColor:e.colorPrimary,"&:after":{opacity:1,transform:"rotate(45deg) scale(1) translate(-50%,-50%)",transition:`all ${e.motionDurationMid} ${e.motionEaseOutBack} ${e.motionDurationFast}`}}},[`\n        ${i}-checked:not(${i}-disabled),\n        ${t}-checked:not(${t}-disabled)\n      `]:{[`&:hover ${t}-inner`]:{backgroundColor:e.colorPrimaryHover,borderColor:"transparent"}}},{[t]:{"&-indeterminate":{[`${t}-inner`]:{backgroundColor:`${e.colorBgContainer} !important`,borderColor:`${e.colorBorder} !important`,"&:after":{top:"50%",insetInlineStart:"50%",width:e.calc(e.fontSizeLG).div(2).equal(),height:e.calc(e.fontSizeLG).div(2).equal(),backgroundColor:e.colorPrimary,border:0,transform:"translate(-50%, -50%) scale(1)",opacity:1,content:'""'}},[`&:hover ${t}-inner`]:{backgroundColor:`${e.colorBgContainer} !important`,borderColor:`${e.colorPrimary} !important`}}}},{[`${i}-disabled`]:{cursor:"not-allowed"},[`${t}-disabled`]:{[`&, ${t}-input`]:{cursor:"not-allowed",pointerEvents:"none"},[`${t}-inner`]:{background:e.colorBgContainerDisabled,borderColor:e.colorBorder,"&:after":{borderColor:e.colorTextDisabled}},"&:after":{display:"none"},"& + span":{color:e.colorTextDisabled},[`&${t}-indeterminate ${t}-inner::after`]:{background:e.colorTextDisabled}}}]};function Ge(e,t){const i=(0,Be.IX)(t,{checkboxCls:`.${e}`,checkboxSize:t.controlInteractiveSize});return[He(i)]}(0,Ue.I$)("Checkbox",((e,t)=>{let{prefixCls:i}=t;return[Ge(i,e)]}));var je=i(83606);const Ke=e=>{let{treeCls:t,treeNodeCls:i,directoryNodeSelectedBg:n,directoryNodeSelectedColor:o,motionDurationMid:s,borderRadius:r,controlItemBgHover:a}=e;return{[`${t}${t}-directory ${i}`]:{[`${t}-node-content-wrapper`]:{position:"static",[`> *:not(${t}-drop-indicator)`]:{position:"relative"},"&:hover":{background:"transparent"},"&:before":{position:"absolute",inset:0,transition:`background-color ${s}`,content:'""',borderRadius:r},"&:hover:before":{background:a}},[`${t}-switcher, ${t}-checkbox, ${t}-draggable-icon`]:{zIndex:1},"&-selected":{[`${t}-switcher, ${t}-draggable-icon`]:{color:o},[`${t}-node-content-wrapper`]:{color:o,background:"transparent","&:before, &:hover:before":{background:n}}}}}},We=new ze.E4("ant-tree-node-fx-do-not-use",{"0%":{opacity:0},"100%":{opacity:1}}),Ye=(e,t)=>({[`.${e}-switcher-icon`]:{display:"inline-block",fontSize:10,verticalAlign:"baseline",svg:{transition:`transform ${t.motionDurationSlow}`}}}),qe=(e,t)=>({[`.${e}-drop-indicator`]:{position:"absolute",zIndex:1,height:2,backgroundColor:t.colorPrimary,borderRadius:1,pointerEvents:"none","&:after":{position:"absolute",top:-3,insetInlineStart:-6,width:8,height:8,backgroundColor:"transparent",border:`${(0,ze.bf)(t.lineWidthBold)} solid ${t.colorPrimary}`,borderRadius:"50%",content:'""'}}}),Xe=(e,t)=>{const{treeCls:i,treeNodeCls:n,treeNodePadding:o,titleHeight:s,indentSize:r,nodeSelectedBg:a,nodeHoverBg:l,colorTextQuaternary:c,controlItemBgActiveDisabled:d}=t;return{[i]:Object.assign(Object.assign({},(0,Ze.Wf)(t)),{background:t.colorBgContainer,borderRadius:t.borderRadius,transition:`background-color ${t.motionDurationSlow}`,"&-rtl":{direction:"rtl"},[`&${i}-rtl ${i}-switcher_close ${i}-switcher-icon svg`]:{transform:"rotate(90deg)"},[`&-focused:not(:hover):not(${i}-active-focused)`]:Object.assign({},(0,Ze.oN)(t)),[`${i}-list-holder-inner`]:{alignItems:"flex-start"},[`&${i}-block-node`]:{[`${i}-list-holder-inner`]:{alignItems:"stretch",[`${i}-node-content-wrapper`]:{flex:"auto"},[`${n}.dragging:after`]:{position:"absolute",inset:0,border:`1px solid ${t.colorPrimary}`,opacity:0,animationName:We,animationDuration:t.motionDurationSlow,animationPlayState:"running",animationFillMode:"forwards",content:'""',pointerEvents:"none",borderRadius:t.borderRadius}}},[n]:{display:"flex",alignItems:"flex-start",marginBottom:o,lineHeight:(0,ze.bf)(s),position:"relative","&:before":{content:'""',position:"absolute",zIndex:1,insetInlineStart:0,width:"100%",top:"100%",height:o},[`&-disabled ${i}-node-content-wrapper`]:{color:t.colorTextDisabled,cursor:"not-allowed","&:hover":{background:"transparent"}},[`${i}-checkbox-disabled + ${i}-node-selected,&${n}-disabled${n}-selected ${i}-node-content-wrapper`]:{backgroundColor:d},[`${i}-checkbox-disabled`]:{pointerEvents:"unset"},[`&:not(${n}-disabled)`]:{[`${i}-node-content-wrapper`]:{"&:hover":{color:t.nodeHoverColor}}},[`&-active ${i}-node-content-wrapper`]:{background:t.controlItemBgHover},[`&:not(${n}-disabled).filter-node ${i}-title`]:{color:t.colorPrimary,fontWeight:500},"&-draggable":{cursor:"grab",[`${i}-draggable-icon`]:{flexShrink:0,width:s,textAlign:"center",visibility:"visible",color:c},[`&${n}-disabled ${i}-draggable-icon`]:{visibility:"hidden"}}},[`${i}-indent`]:{alignSelf:"stretch",whiteSpace:"nowrap",userSelect:"none","&-unit":{display:"inline-block",width:r}},[`${i}-draggable-icon`]:{visibility:"hidden"},[`${i}-switcher, ${i}-checkbox`]:{marginInlineEnd:t.calc(t.calc(s).sub(t.controlInteractiveSize)).div(2).equal()},[`${i}-switcher`]:Object.assign(Object.assign({},Ye(e,t)),{position:"relative",flex:"none",alignSelf:"stretch",width:s,textAlign:"center",cursor:"pointer",userSelect:"none",transition:`all ${t.motionDurationSlow}`,"&-noop":{cursor:"unset"},"&:before":{pointerEvents:"none",content:'""',width:s,height:s,position:"absolute",left:{_skip_check_:!0,value:0},top:0,borderRadius:t.borderRadius,transition:`all ${t.motionDurationSlow}`},[`&:not(${i}-switcher-noop):hover:before`]:{backgroundColor:t.colorBgTextHover},[`&_close ${i}-switcher-icon svg`]:{transform:"rotate(-90deg)"},"&-loading-icon":{color:t.colorPrimary},"&-leaf-line":{position:"relative",zIndex:1,display:"inline-block",width:"100%",height:"100%","&:before":{position:"absolute",top:0,insetInlineEnd:t.calc(s).div(2).equal(),bottom:t.calc(o).mul(-1).equal(),marginInlineStart:-1,borderInlineEnd:`1px solid ${t.colorBorder}`,content:'""'},"&:after":{position:"absolute",width:t.calc(t.calc(s).div(2).equal()).mul(.8).equal(),height:t.calc(s).div(2).equal(),borderBottom:`1px solid ${t.colorBorder}`,content:'""'}}}),[`${i}-node-content-wrapper`]:Object.assign(Object.assign({position:"relative",minHeight:s,paddingBlock:0,paddingInline:t.paddingXS,background:"transparent",borderRadius:t.borderRadius,cursor:"pointer",transition:`all ${t.motionDurationMid}, border 0s, line-height 0s, box-shadow 0s`},qe(e,t)),{"&:hover":{backgroundColor:l},[`&${i}-node-selected`]:{color:t.nodeSelectedColor,backgroundColor:a},[`${i}-iconEle`]:{display:"inline-block",width:s,height:s,textAlign:"center",verticalAlign:"top","&:empty":{display:"none"}}}),[`${i}-unselectable ${i}-node-content-wrapper:hover`]:{backgroundColor:"transparent"},[`${n}.drop-container > [draggable]`]:{boxShadow:`0 0 0 2px ${t.colorPrimary}`},"&-show-line":{[`${i}-indent-unit`]:{position:"relative",height:"100%","&:before":{position:"absolute",top:0,insetInlineEnd:t.calc(s).div(2).equal(),bottom:t.calc(o).mul(-1).equal(),borderInlineEnd:`1px solid ${t.colorBorder}`,content:'""'},"&-end:before":{display:"none"}},[`${i}-switcher`]:{background:"transparent","&-line-icon":{verticalAlign:"-0.15em"}}},[`${n}-leaf-last ${i}-switcher-leaf-line:before`]:{top:"auto !important",bottom:"auto !important",height:`${(0,ze.bf)(t.calc(s).div(2).equal())} !important`}})}},Je=function(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=`.${e}`,o=`${n}-treenode`,s=t.calc(t.paddingXS).div(2).equal(),r=(0,Be.IX)(t,{treeCls:n,treeNodeCls:o,treeNodePadding:s});return[Xe(e,r),i&&Ke(r)].filter(Boolean)};var Qe=(0,Ue.I$)("Tree",((e,t)=>{let{prefixCls:i}=t;return[{[e.componentCls]:Ge(`${i}-checkbox`,e)},Je(i,e),(0,je.Z)(e)]}),(e=>{const{colorTextLightSolid:t,colorPrimary:i}=e;return Object.assign(Object.assign({},(e=>{const{controlHeightSM:t,controlItemBgHover:i,controlItemBgActive:n}=e;return{titleHeight:t,indentSize:t,nodeHoverBg:i,nodeHoverColor:e.colorText,nodeSelectedBg:n,nodeSelectedColor:e.colorText}})(e)),{directoryNodeSelectedColor:t,directoryNodeSelectedBg:i})}));var et=function(e){const{dropPosition:t,dropLevelOffset:i,prefixCls:n,indent:o,direction:s="ltr"}=e,r="ltr"===s?"left":"right",a={[r]:-i*o+4,["ltr"===s?"right":"left"]:0};switch(t){case-1:a.top=-3;break;case 1:a.bottom=-3;break;default:a.bottom=-3,a[r]=o+4}return v.createElement("div",{style:a,className:`${n}-drop-indicator`})},tt={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z"}}]},name:"caret-down",theme:"filled"},it=function(e,t){return v.createElement(Ee.Z,(0,n.Z)({},e,{ref:t,icon:tt}))};var nt=v.forwardRef(it),ot=i(21833),st={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M328 544h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}},{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"minus-square",theme:"outlined"},rt=function(e,t){return v.createElement(Ee.Z,(0,n.Z)({},e,{ref:t,icon:st}))};var at=v.forwardRef(rt),lt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M328 544h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}},{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"plus-square",theme:"outlined"},ct=function(e,t){return v.createElement(Ee.Z,(0,n.Z)({},e,{ref:t,icon:lt}))};var dt=v.forwardRef(ct),ut=i(66197);var ht=e=>{const{prefixCls:t,switcherIcon:i,treeNodeProps:n,showLine:o,switcherLoadingIcon:s}=e,{isLeaf:r,expanded:a,loading:l}=n;if(l)return v.isValidElement(s)?s:v.createElement(ot.Z,{className:`${t}-switcher-loading-icon`});let c;if(o&&"object"==typeof o&&(c=o.showLeafIcon),r){if(!o)return null;if("boolean"!=typeof c&&c){const e="function"==typeof c?c(n):c,i=`${t}-switcher-line-custom-icon`;return v.isValidElement(e)?(0,ut.Tm)(e,{className:y()(e.props.className||"",i)}):e}return c?v.createElement(Le,{className:`${t}-switcher-line-icon`}):v.createElement("span",{className:`${t}-switcher-leaf-line`})}const d=`${t}-switcher-icon`,u="function"==typeof i?i(n):i;return v.isValidElement(u)?(0,ut.Tm)(u,{className:y()(u.props.className||"",d)}):void 0!==u?u:o?a?v.createElement(at,{className:`${t}-switcher-line-icon`}):v.createElement(dt,{className:`${t}-switcher-line-icon`}):v.createElement(nt,{className:d})};const pt=v.forwardRef(((e,t)=>{var i;const{getPrefixCls:n,direction:o,virtual:s,tree:r}=v.useContext(Re.E_),{prefixCls:a,className:l,showIcon:c=!1,showLine:d,switcherIcon:u,switcherLoadingIcon:h,blockNode:p=!1,children:g,checkable:m=!1,selectable:f=!0,draggable:b,motion:_,style:w}=e,C=n("tree",a),x=n(),S=null!=_?_:Object.assign(Object.assign({},(0,Fe.Z)(x)),{motionAppear:!1}),E=Object.assign(Object.assign({},e),{checkable:m,selectable:f,showIcon:c,motion:S,blockNode:p,showLine:Boolean(d),dropIndicatorRender:et}),[k,L,T]=Qe(C),[,M]=(0,Ve.ZP)(),I=M.paddingXS/2+((null===(i=M.Tree)||void 0===i?void 0:i.titleHeight)||M.controlHeightSM),O=v.useMemo((()=>{if(!b)return!1;let e={};switch(typeof b){case"function":e.nodeDraggable=b;break;case"object":e=Object.assign({},b)}return!1!==e.icon&&(e.icon=e.icon||v.createElement(Ne,null)),e}),[b]);return k(v.createElement(xe,Object.assign({itemHeight:I,ref:t,virtual:s},E,{style:Object.assign(Object.assign({},null==r?void 0:r.style),w),prefixCls:C,className:y()({[`${C}-icon-hide`]:!c,[`${C}-block-node`]:p,[`${C}-unselectable`]:!f,[`${C}-rtl`]:"rtl"===o},null==r?void 0:r.className,l,L,T),direction:o,checkable:m?v.createElement("span",{className:`${C}-checkbox-inner`}):m,selectable:f,switcherIcon:e=>v.createElement(ht,{prefixCls:C,switcherIcon:u,switcherLoadingIcon:h,treeNodeProps:e,showLine:d}),draggable:O}),g))}));var yt=pt;function gt(e,t,i){const{key:n,children:o}=i;e.forEach((function(e){const s=e[n],r=e[o];!1!==t(s,e)&&gt(r||[],t,i)}))}function mt(e){let{treeData:t,expandedKeys:i,startKey:n,endKey:o,fieldNames:s}=e;const r=[];let a=0;if(n&&n===o)return[n];if(!n||!o)return[];return gt(t,(e=>{if(2===a)return!1;if(function(e){return e===n||e===o}(e)){if(r.push(e),0===a)a=1;else if(1===a)return a=2,!1}else 1===a&&r.push(e);return i.includes(e)}),$(s)),r}function ft(e,t,i){const n=(0,r.Z)(t),o=[];return gt(e,((e,t)=>{const i=n.indexOf(e);return-1!==i&&(o.push(t),n.splice(i,1)),!!n.length}),$(i)),o}var vt=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i};function bt(e){const{isLeaf:t,expanded:i}=e;return t?v.createElement(Le,null):i?v.createElement(Ie,null):v.createElement(Ae,null)}function _t(e){let{treeData:t,children:i}=e;return t||N(i)}const wt=(e,t)=>{var{defaultExpandAll:i,defaultExpandParent:n,defaultExpandedKeys:o}=e,s=vt(e,["defaultExpandAll","defaultExpandParent","defaultExpandedKeys"]);const a=v.useRef(null),l=v.useRef(null),[c,d]=v.useState(s.selectedKeys||s.defaultSelectedKeys||[]),[u,h]=v.useState((()=>(()=>{const{keyEntities:e}=z(_t(s));let t;return t=i?Object.keys(e):n?ve(s.expandedKeys||o||[],e):s.expandedKeys||o||[],t})()));v.useEffect((()=>{"selectedKeys"in s&&d(s.selectedKeys)}),[s.selectedKeys]),v.useEffect((()=>{"expandedKeys"in s&&h(s.expandedKeys)}),[s.expandedKeys]);const{getPrefixCls:p,direction:g}=v.useContext(Re.E_),{prefixCls:m,className:f,showIcon:b=!0,expandAction:_="click"}=s,w=vt(s,["prefixCls","className","showIcon","expandAction"]),C=p("tree",m),x=y()(`${C}-directory`,{[`${C}-directory-rtl`]:"rtl"===g},f);return v.createElement(yt,Object.assign({icon:bt,ref:t,blockNode:!0},w,{showIcon:b,expandAction:_,prefixCls:C,className:x,expandedKeys:u,selectedKeys:c,onSelect:(e,t)=>{var i;const{multiple:n,fieldNames:o}=s,{node:c,nativeEvent:h}=t,{key:p=""}=c,y=_t(s),g=Object.assign(Object.assign({},t),{selected:!0}),m=(null==h?void 0:h.ctrlKey)||(null==h?void 0:h.metaKey),f=null==h?void 0:h.shiftKey;let v;n&&m?(v=e,a.current=p,l.current=v,g.selectedNodes=ft(y,v,o)):n&&f?(v=Array.from(new Set([].concat((0,r.Z)(l.current||[]),(0,r.Z)(mt({treeData:y,expandedKeys:u,startKey:p,endKey:a.current,fieldNames:o}))))),g.selectedNodes=ft(y,v,o)):(v=[p],a.current=p,l.current=v,g.selectedNodes=ft(y,v,o)),null===(i=s.onSelect)||void 0===i||i.call(s,v,g),"selectedKeys"in s||d(v)},onExpand:(e,t)=>{var i;return"expandedKeys"in s||h(e),null===(i=s.onExpand)||void 0===i?void 0:i.call(s,e,t)}}))};var Ct=v.forwardRef(wt);const xt=yt;xt.DirectoryTree=Ct,xt.TreeNode=K;var St=xt},78445:function(e,t,i){var n=i(88513);e.exports=function(e){if(Array.isArray(e))return n(e)},e.exports.__esModule=!0,e.exports.default=e.exports},26431:function(e){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},93647:function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},76711:function(e,t,i){var n=i(78445),o=i(26431),s=i(15274),r=i(93647);e.exports=function(e){return n(e)||o(e)||s(e)||r()},e.exports.__esModule=!0,e.exports.default=e.exports},90900:function(e,t,i){"use strict";i.d(t,{Z:function(){return h}});var n=i(73440),o=i(93460),s=i(70880),r=i(89314),a=i(15894),l=i(63255),c=i(17155),d=(i(61432),i(96711),i(83850),i(48023));let u=0,h=class extends(l.Z.JSONSupportMixin(r.Z.ClonableMixin(a.Z.IdentifiableMixin(s.Z)))){constructor(e){super(e),this.id=`${Date.now().toString(16)}-analysis-${u++}`,this.origin=null}get parent(){return this._get("parent")}set parent(e){const t=this.parent;if(null!=t)switch(t.type){case"line-of-sight":case"dimension":case"viewshed":t.releaseAnalysis(this);break;case"2d":case"3d":t.analyses.includes(this)&&t.analyses.remove(this)}this._set("parent",e)}equals(e){return!0}};(0,n._)([(0,c.Cb)({type:String,constructOnly:!0,clonable:!1})],h.prototype,"id",void 0),(0,n._)([(0,c.Cb)({clonable:!1,value:null})],h.prototype,"parent",null),(0,n._)([(0,c.Cb)({types:{key:"type",base:null,typeMap:{"web-scene":o.Z}}})],h.prototype,"origin",void 0),h=(0,n._)([(0,d.j)("esri.analysis.Analysis")],h)},51741:function(e,t,i){"use strict";i.d(t,{Z:function(){return v}});var n=i(73440),o=i(90900),s=i(49052),r=i(99965),a=i(3480),l=i(43254),c=i(41145),d=i(61100),u=i(90403),h=i(17155),p=(i(61432),i(96711),i(48023)),y=i(13132),g=i(16447),m=i(51870);const f=l.Z.ofType(r.Z);let v=class extends o.Z{constructor(e){super(e),this.type="line-of-sight",this.observer=null,this.extent=null}initialize(){this.addHandles((0,u.YP)((()=>this._computeExtent()),(e=>{null==e?.pending&&this._set("extent",null!=e?e.extent:null)}),u.tX))}get targets(){return this._get("targets")||new f}set targets(e){this._set("targets",(0,c.Z)(e,this.targets,f))}get spatialReference(){return null!=this.observer?.position?this.observer.position.spatialReference:null}get valid(){return null!=this.observer?.position}async waitComputeExtent(){const e=this._computeExtent();return null!=e?e.pending:Promise.resolve()}_computeExtent(){const e=this.spatialReference;if(null==this.observer?.position||null==e)return null;const t=e=>"absolute-height"===(0,m.VW)(e.position,e.elevationInfo),i=this.observer.position,n=(0,g.al)(i.x,i.y,i.z,i.x,i.y,i.z);for(const t of this.targets)if(null!=t.position){const i=(0,y.projectOrLoad)(t.position,e);if(null!=i.pending)return{pending:i.pending,extent:null};if(null!=i.geometry){const{x:e,y:t,z:o}=i.geometry;(0,g.pp)(n,[e,t,o])}}const o=(0,g.HH)(n,e);return t(this.observer)&&this.targets.every(t)||(o.zmin=void 0,o.zmax=void 0),{pending:null,extent:o}}clear(){this.observer=null,this.targets.removeAll()}equals(e){return this===e||super.equals(e)&&(0,d._W)(this.observer,e.observer)&&(0,a.fS)(this.targets.toArray(),e.targets.toArray(),((e,t)=>e.equals(t)))}};(0,n._)([(0,h.Cb)({type:["line-of-sight"]})],v.prototype,"type",void 0),(0,n._)([(0,h.Cb)({type:s.Z,json:{read:!0,write:!0}})],v.prototype,"observer",void 0),(0,n._)([(0,h.Cb)({cast:c.R,type:f,nonNullable:!0,json:{read:!0,write:!0}})],v.prototype,"targets",null),(0,n._)([(0,h.Cb)({value:null,readOnly:!0})],v.prototype,"extent",void 0),(0,n._)([(0,h.Cb)()],v.prototype,"spatialReference",null),(0,n._)([(0,h.Cb)({readOnly:!0})],v.prototype,"valid",null),v=(0,n._)([(0,p.j)("esri.analysis.LineOfSightAnalysis")],v)},49052:function(e,t,i){"use strict";i.d(t,{Z:function(){return g}});var n=i(73440),o=i(37877),s=i(70880),r=i(89314),a=i(63255),l=i(61100),c=i(17155),d=(i(61432),i(96711),i(83850),i(48023)),u=i(75432),h=i(60508),p=i(13689);let y=class extends(a.Z.JSONSupportMixin(r.Z.ClonableMixin(s.Z))){constructor(e){super(e),this.position=null,this.elevationInfo=null,this.feature=null}equals(e){return(0,l._W)(this.position,e.position)&&(0,l._W)(this.elevationInfo,e.elevationInfo)&&(0,o.kk)(this.feature,e.feature)}};(0,n._)([(0,c.Cb)({type:h.Z,json:{write:{isRequired:!0}}})],y.prototype,"position",void 0),(0,n._)([(0,c.Cb)({type:p.Z}),(0,u.B)()],y.prototype,"elevationInfo",void 0),(0,n._)([(0,c.Cb)(o.rX)],y.prototype,"feature",void 0),y=(0,n._)([(0,d.j)("esri.analysis.LineOfSightAnalysisObserver")],y);const g=y},99965:function(e,t,i){"use strict";i.d(t,{Z:function(){return p}});var n=i(73440),o=i(37877),s=i(89314),r=i(63255),a=i(61100),l=i(17155),c=(i(61432),i(96711),i(83850),i(48023)),d=i(75432),u=i(60508),h=i(13689);let p=class extends(r.Z.JSONSupportMixin(s.Z)){constructor(e){super(e),this.position=null,this.elevationInfo=null,this.feature=null}equals(e){return(0,a._W)(this.position,e.position)&&(0,a._W)(this.elevationInfo,e.elevationInfo)&&(0,o.kk)(this.feature,e.feature)}};(0,n._)([(0,l.Cb)({type:u.Z,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}}),(0,d.B)()],p.prototype,"position",void 0),(0,n._)([(0,l.Cb)({type:h.Z}),(0,d.B)()],p.prototype,"elevationInfo",void 0),(0,n._)([(0,l.Cb)(o.rX)],p.prototype,"feature",void 0),p=(0,n._)([(0,c.j)("esri.analysis.LineOfSightAnalysisTarget")],p)},37877:function(e,t,i){"use strict";i.d(t,{NS:function(){return u},kk:function(){return l},pD:function(){return c},rX:function(){return d}});var n=i(24910),o=i(82846),s=i(12659),r=i(61442),a=i(90189);function l(e,t){return c(e)===c(t)}function c(e){if(null==e)return null;const t=null!=e.layer?e.layer.id:"";let i=null;return i=null!=e.objectId?e.objectId:null!=e.layer&&"objectIdField"in e.layer&&null!=e.layer.objectIdField&&null!=e.attributes?e.attributes[e.layer.objectIdField]:e.uid,null==i?null:`o-${t}-${i}`}const d={json:{write:{writer:function(e,t){null!=e?.layer?.objectIdField&&null!=e.attributes&&(t.feature={layerId:e.layer.id,objectId:e.attributes[e.layer.objectIdField]})},target:{"feature.layerId":{type:[Number,String],isRequired:!0},"feature.objectId":{type:[Number,String],isRequired:!0}}},origins:{"web-scene":{read:function(e){if(null!=e.layerId&&null!=e.objectId)return{uid:null,layer:{id:e.layerId,objectIdField:"ObjectId"},attributes:{ObjectId:e.objectId}}}}}}};function u(e,t,i,l){const{sceneIntersectionHelper:d}=e,{observer:u,observerFeatureId:p,targetFeatureId:m,target:f}=i;if(null==p&&null==m)return;l||(l=e=>e),(0,n.a)(g,u,f);const v=(0,n.l)(g);(0,n.b)(g,u,g,1/v);const b=(0,s.zk)(g,f,y);t.options.store=r.e.ALL,d.intersectToolIntersectorRay(b,t);let _=null,w=null,C=null,x=null;for(const i of t.results.all){const t=(0,a.tB)(i,e);if(null==t||null==i.distanceInRenderSpace)continue;const n=c(t);null!=n&&(null!=p&&n===p&&(_??=l(h(i,e,v)),i.distanceInRenderSpace-1<_&&(C=i)),null!=m&&n===m&&(w??=l(h(i,e,v)),null==x&&i.distanceInRenderSpace-1<v&&v-i.distanceInRenderSpace+1<w&&(x=i)))}const{observerAdjusted:S,targetAdjusted:E}=i;C?.getIntersectionPoint(S)?i.observerSurfaceNormal=C.getTransformedNormal((0,o.Ue)()):i.observerSurfaceNormal=null,x?.getIntersectionPoint(E)?i.targetSurfaceNormal=x.getTransformedNormal((0,o.Ue)()):i.targetSurfaceNormal=null}function h(e,t,i){if((0,a._s)(e)){const n=(0,a.VB)(e,t);if(null!=n)return Math.min(n*p,i)}return 1e-5*i}const p=.05,y=(0,s.Ue)(),g=(0,o.Ue)()},38874:function(e,t,i){"use strict";function n(e,t,i){i=i||2;var n,s,a,l,c,d,h,p=t&&t.length,y=p?t[0]*i:e.length,g=o(e,0,y,i,!0),m=[];if(!g||g.next===g.prev)return m;if(p&&(g=u(e,t,g,i)),e.length>80*i){n=a=e[0],s=l=e[1];for(var f=i;f<y;f+=i)(c=e[f])<n&&(n=c),(d=e[f+1])<s&&(s=d),c>a&&(a=c),d>l&&(l=d);h=0!==(h=Math.max(a-n,l-s))?1/h:0}return r(g,m,i,n,s,h),m}function o(e,t,i,n,o){var s,r;if(o===O(e,t,i,n)>0)for(s=t;s<i;s+=n)r=T(s,e[s],e[s+1],r);else for(s=i-n;s>=t;s-=n)r=T(s,e[s],e[s+1],r);if(r&&C(r,r.next)){var a=r.next;M(r),r=a}return r}function s(e,t){if(!e)return e;t||(t=e);var i,n=e;do{if(i=!1,n.steiner||!C(n,n.next)&&0!==w(n.prev,n,n.next))n=n.next;else{var o=n.prev;if(M(n),(n=t=o)===n.next)break;i=!0}}while(i||n!==t);return t}function r(e,t,i,n,o,u,h){if(e){!h&&u&&m(e,n,o,u);for(var p,y,g=e;e.prev!==e.next;)if(p=e.prev,y=e.next,u?l(e,n,o,u):a(e))t.push(p.i/i),t.push(e.i/i),t.push(y.i/i),M(e),e=y.next,g=y.next;else if((e=y)===g){h?1===h?r(e=c(s(e),t,i),t,i,n,o,u,2):2===h&&d(e,t,i,n,o,u):r(s(e),t,i,n,o,u,1);break}}}function a(e){var t=e.prev,i=e,n=e.next;if(w(t,i,n)>=0)return!1;for(var o=e.next.next;o!==e.prev;){if(b(t.x,t.y,i.x,i.y,n.x,n.y,o.x,o.y)&&w(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function l(e,t,i,n){var o=e.prev,s=e,r=e.next;if(w(o,s,r)>=0)return!1;for(var a=o.x<s.x?o.x<r.x?o.x:r.x:s.x<r.x?s.x:r.x,l=o.y<s.y?o.y<r.y?o.y:r.y:s.y<r.y?s.y:r.y,c=o.x>s.x?o.x>r.x?o.x:r.x:s.x>r.x?s.x:r.x,d=o.y>s.y?o.y>r.y?o.y:r.y:s.y>r.y?s.y:r.y,u=f(a,l,t,i,n),h=f(c,d,t,i,n),p=e.prevZ,y=e.nextZ;p&&p.z>=u&&y&&y.z<=h;){if(p!==e.prev&&p!==e.next&&b(o.x,o.y,s.x,s.y,r.x,r.y,p.x,p.y)&&w(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,y!==e.prev&&y!==e.next&&b(o.x,o.y,s.x,s.y,r.x,r.y,y.x,y.y)&&w(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;p&&p.z>=u;){if(p!==e.prev&&p!==e.next&&b(o.x,o.y,s.x,s.y,r.x,r.y,p.x,p.y)&&w(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;y&&y.z<=h;){if(y!==e.prev&&y!==e.next&&b(o.x,o.y,s.x,s.y,r.x,r.y,y.x,y.y)&&w(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function c(e,t,i){var n=e;do{var o=n.prev,r=n.next.next;!C(o,r)&&x(o,n,n.next,r)&&k(o,r)&&k(r,o)&&(t.push(o.i/i),t.push(n.i/i),t.push(r.i/i),M(n),M(n.next),n=e=r),n=n.next}while(n!==e);return s(n)}function d(e,t,i,n,o,a){var l=e;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&_(l,c)){var d=L(l,c);return l=s(l,l.next),d=s(d,d.next),r(l,t,i,n,o,a),void r(d,t,i,n,o,a)}c=c.next}l=l.next}while(l!==e)}function u(e,t,i,n){var r,a,l,c=[];for(r=0,a=t.length;r<a;r++)(l=o(e,t[r]*n,r<a-1?t[r+1]*n:e.length,n,!1))===l.next&&(l.steiner=!0),c.push(v(l));for(c.sort(h),r=0;r<c.length;r++)i=s(i=y(c[r],i),i.next);return i}function h(e,t){return e.x-t.x}function p(e){if(e.next.prev===e)return e;let t=e;for(;;){const i=t.next;if(i.prev===t||i===t||i===e)break;t=i}return t}function y(e,t){var i=function(e,t){var i,n=t,o=e.x,s=e.y,r=-1/0;do{if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){var a=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=o&&a>r){if(r=a,a===o){if(s===n.y)return n;if(s===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!i)return null;if(o===r)return i;var l,c=i,d=i.x,u=i.y,h=1/0;n=i;do{o>=n.x&&n.x>=d&&o!==n.x&&b(s<u?o:r,s,d,u,s<u?r:o,s,n.x,n.y)&&(l=Math.abs(s-n.y)/(o-n.x),k(n,e)&&(l<h||l===h&&(n.x>i.x||n.x===i.x&&g(i,n)))&&(i=n,h=l)),n=n.next}while(n!==c);return i}(e,t);if(!i)return t;var n=L(i,e),o=s(i,i.next);let r=p(n);return s(r,r.next),o=p(o),p(t===i?o:t)}function g(e,t){return w(e.prev,e,t.prev)<0&&w(t.next,e,e.next)<0}function m(e,t,i,n){var o=e;do{null===o.z&&(o.z=f(o.x,o.y,t,i,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,function(e){var t,i,n,o,s,r,a,l,c=1;do{for(i=e,e=null,s=null,r=0;i;){for(r++,n=i,a=0,t=0;t<c&&(a++,n=n.nextZ);t++);for(l=c;a>0||l>0&&n;)0!==a&&(0===l||!n||i.z<=n.z)?(o=i,i=i.nextZ,a--):(o=n,n=n.nextZ,l--),s?s.nextZ=o:e=o,o.prevZ=s,s=o;i=n}s.nextZ=null,c*=2}while(r>1)}(o)}function f(e,t,i,n,o){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*o)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*o)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function v(e){var t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function b(e,t,i,n,o,s,r,a){return(o-r)*(t-a)-(e-r)*(s-a)>=0&&(e-r)*(n-a)-(i-r)*(t-a)>=0&&(i-r)*(s-a)-(o-r)*(n-a)>=0}function _(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&x(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&(k(e,t)&&k(t,e)&&function(e,t){var i=e,n=!1,o=(e.x+t.x)/2,s=(e.y+t.y)/2;do{i.y>s!=i.next.y>s&&i.next.y!==i.y&&o<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==e);return n}(e,t)&&(w(e.prev,e,t.prev)||w(e,t.prev,t))||C(e,t)&&w(e.prev,e,e.next)>0&&w(t.prev,t,t.next)>0)}function w(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function C(e,t){return e.x===t.x&&e.y===t.y}function x(e,t,i,n){var o=E(w(e,t,i)),s=E(w(e,t,n)),r=E(w(i,n,e)),a=E(w(i,n,t));return o!==s&&r!==a||!(0!==o||!S(e,i,t))||!(0!==s||!S(e,n,t))||!(0!==r||!S(i,e,n))||!(0!==a||!S(i,t,n))}function S(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function E(e){return e>0?1:e<0?-1:0}function k(e,t){return w(e.prev,e,e.next)<0?w(e,t,e.next)>=0&&w(e,e.prev,t)>=0:w(e,t,e.prev)<0||w(e,e.next,t)<0}function L(e,t){var i=new I(e.i,e.x,e.y),n=new I(t.i,t.x,t.y),o=e.next,s=t.prev;return e.next=t,t.prev=e,i.next=o,o.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function T(e,t,i,n){var o=new I(e,t,i);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function M(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function I(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function O(e,t,i,n){for(var o=0,s=t,r=i-n;s<i;s+=n)o+=(e[r]-e[s])*(e[s+1]+e[r+1]),r=s;return o}i.d(t,{e:function(){return n}}),n.deviation=function(e,t,i,n){var o=t&&t.length,s=o?t[0]*i:e.length,r=Math.abs(O(e,0,s,i));if(o)for(var a=0,l=t.length;a<l;a++){var c=t[a]*i,d=a<l-1?t[a+1]*i:e.length;r-=Math.abs(O(e,c,d,i))}var u=0;for(a=0;a<n.length;a+=3){var h=n[a]*i,p=n[a+1]*i,y=n[a+2]*i;u+=Math.abs((e[h]-e[y])*(e[p+1]-e[h+1])-(e[h]-e[p])*(e[y+1]-e[h+1]))}return 0===r&&0===u?0:Math.abs((u-r)/r)},n.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},n=0,o=0;o<e.length;o++){for(var s=0;s<e[o].length;s++)for(var r=0;r<t;r++)i.vertices.push(e[o][s][r]);o>0&&(n+=e[o-1].length,i.holes.push(n))}return i}},45415:function(e,t,i){"use strict";function n(e,t,i,n,s){o(e,t,i||0,n||e.length-1,s||r)}function o(e,t,i,n,r){for(;n>i;){if(n-i>600){var a=n-i+1,l=t-i+1,c=Math.log(a),d=.5*Math.exp(2*c/3),u=.5*Math.sqrt(c*d*(a-d)/a)*(l-a/2<0?-1:1);o(e,t,Math.max(i,Math.floor(t-l*d/a+u)),Math.min(n,Math.floor(t+(a-l)*d/a+u)),r)}var h=e[t],p=i,y=n;for(s(e,i,t),r(e[n],h)>0&&s(e,i,n);p<y;){for(s(e,p,y),p++,y--;r(e[p],h)<0;)p++;for(;r(e[y],h)>0;)y--}0===r(e[i],h)?s(e,i,y):s(e,++y,n),y<=t&&(i=y+1),t<=y&&(n=y-1)}}function s(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function r(e,t){return e<t?-1:e>t?1:0}i.d(t,{q:function(){return n}})},96946:function(e,t,i){"use strict";i.d(t,{Q:function(){return a},b:function(){return E}});var n=i(3480),o=i(79487),s=(i(61432),i(63974)),r=i(45415);class a{constructor(e=9,t){this._compareMinX=h,this._compareMinY=p,this._toBBox=e=>e,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this._toBBox=t:this._initFormat(t)),this.clear()}destroy(){this.clear(),w.prune(),C.prune(),x.prune(),S.prune()}all(e){l(this._data,e)}search(e,t){let i=this._data;const n=this._toBBox;if(b(e,i))for(w.clear();i;){for(let o=0,s=i.children.length;o<s;o++){const s=i.children[o],r=i.leaf?n(s):s;b(e,r)&&(i.leaf?t(s):v(e,r)?l(s,t):w.push(s))}i=w.pop()}}collides(e){let t=this._data;const i=this._toBBox;if(!b(e,t))return!1;for(w.clear();t;){for(let n=0,o=t.children.length;n<o;n++){const o=t.children[n],s=t.leaf?i(o):o;if(b(e,s)){if(t.leaf||v(e,s))return!0;w.push(o)}}t=w.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let t=0,i=e.length;t<i;t++)this.insert(e[t]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(this._data.children.length)if(this._data.height===t.height)this._splitRoot(this._data,t);else{if(this._data.height<t.height){const e=this._data;this._data=t,t=e}this._insert(t,this._data.height-t.height-1,!0)}else this._data=t;return this}insert(e){return e&&this._insert(e,this._data.height-1),this}clear(){return this._data=new L([]),this}remove(e){if(!e)return this;let t,i=this._data,s=null,r=0,a=!1;const l=this._toBBox(e);for(x.clear(),S.clear();i||x.length>0;){if(i||(i=x.pop(),s=x.data[x.length-1],r=S.pop()??0,a=!0),i.leaf&&(t=(0,n.cq)(i.children,(0,o.CY)(e),i.children.length,i.indexHint),-1!==t))return i.children.splice(t,1),x.push(i),this._condense(x),this;a||i.leaf||!v(i,l)?s?(r++,i=s.children[r],a=!1):i=null:(x.push(i),S.push(r),r=0,s=i,i=i.children[0])}return this}toJSON(){return this._data}fromJSON(e){return this._data=e,this}_build(e,t,i,n){const o=i-t+1;let s=this._maxEntries;if(o<=s){const n=new L(e.slice(t,i+1));return c(n,this._toBBox),n}n||(n=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/s**(n-1)));const r=new T([]);r.height=n;const a=Math.ceil(o/s),l=a*Math.ceil(Math.sqrt(s));_(e,t,i,l,this._compareMinX);for(let o=t;o<=i;o+=l){const t=Math.min(o+l-1,i);_(e,o,t,a,this._compareMinY);for(let i=o;i<=t;i+=a){const o=Math.min(i+a-1,t);r.children.push(this._build(e,i,o,n-1))}}return c(r,this._toBBox),r}_insert(e,t,i){const n=this._toBBox,o=i?e:n(e);x.clear();const s=function(e,t,i,n){for(;n.push(t),!0!==t.leaf&&n.length-1!==i;){let i,n=1/0,o=1/0;for(let s=0,r=t.children.length;s<r;s++){const r=t.children[s],a=y(r),l=m(e,r)-a;l<o?(o=l,n=a<n?a:n,i=r):l===o&&a<n&&(n=a,i=r)}t=i||t.children[0]}return t}(o,this._data,t,x);for(s.children.push(e),u(s,o);t>=0&&x.data[t].children.length>this._maxEntries;)this._split(x,t),t--;!function(e,t,i){for(let n=i;n>=0;n--)u(t.data[n],e)}(o,x,t)}_split(e,t){const i=e.data[t],n=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,n);const s=this._chooseSplitIndex(i,o,n);if(!s)return;const r=i.children.splice(s,i.children.length-s),a=i.leaf?new L(r):new T(r);a.height=i.height,c(i,this._toBBox),c(a,this._toBBox),t?e.data[t-1].children.push(a):this._splitRoot(i,a)}_splitRoot(e,t){this._data=new T([e,t]),this._data.height=e.height+1,c(this._data,this._toBBox)}_chooseSplitIndex(e,t,i){let n,o,s;n=o=1/0;for(let r=t;r<=i-t;r++){const t=d(e,0,r,this._toBBox),a=d(e,r,i,this._toBBox),l=f(t,a),c=y(t)+y(a);l<n?(n=l,s=r,o=c<o?c:o):l===n&&c<o&&(o=c,s=r)}return s}_chooseSplitAxis(e,t,i){const n=e.leaf?this._compareMinX:h,o=e.leaf?this._compareMinY:p;this._allDistMargin(e,t,i,n)<this._allDistMargin(e,t,i,o)&&e.children.sort(n)}_allDistMargin(e,t,i,n){e.children.sort(n);const o=this._toBBox,s=d(e,0,t,o),r=d(e,i-t,i,o);let a=g(s)+g(r);for(let n=t;n<i-t;n++){const t=e.children[n];u(s,e.leaf?o(t):t),a+=g(s)}for(let n=i-t-1;n>=t;n--){const t=e.children[n];u(r,e.leaf?o(t):t),a+=g(r)}return a}_condense(e){for(let t=e.length-1;t>=0;t--){const i=e.data[t];if(0===i.children.length)if(t>0){const o=e.data[t-1],s=o.children;s.splice((0,n.cq)(s,i,s.length,o.indexHint),1)}else this.clear();else c(i,this._toBBox)}}_initFormat(e){const t=["return a"," - b",";"];this._compareMinX=new Function("a","b",t.join(e[0])),this._compareMinY=new Function("a","b",t.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function l(e,t){let i=e;for(C.clear();i;){if(!0===i.leaf)for(const e of i.children)t((0,o.CY)(e));else C.pushArray(i.children);i=C.pop()??null}}function c(e,t){d(e,0,e.children.length,t,e)}function d(e,t,i,n,o){o||(o=new L([])),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(let s,r=t;r<i;r++)s=e.children[r],u(o,e.leaf?n(s):s);return o}function u(e,t){e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY)}function h(e,t){return e.minX-t.minX}function p(e,t){return e.minY-t.minY}function y(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function g(e){return e.maxX-e.minX+(e.maxY-e.minY)}function m(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function f(e,t){const i=Math.max(e.minX,t.minX),n=Math.max(e.minY,t.minY),o=Math.min(e.maxX,t.maxX),s=Math.min(e.maxY,t.maxY);return Math.max(0,o-i)*Math.max(0,s-n)}function v(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function b(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function _(e,t,i,n,o){const s=[t,i];for(;s.length;){const t=s.pop(),i=s.pop();if(t-i<=n)continue;const a=i+Math.ceil((t-i)/n/2)*n;(0,r.q)(e,a,i,t,o),s.push(i,a,a,t)}}const w=new s.Z,C=new s.Z,x=new s.Z,S=new s.Z({deallocator:void 0});class E{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class k extends E{constructor(){super(...arguments),this.height=1,this.indexHint=new n.SO}}class L extends k{constructor(e){super(),this.children=e,this.leaf=!0}}class T extends k{constructor(e){super(),this.children=e,this.leaf=!1}}},87864:function(e,t,i){"use strict";i.d(t,{Qc:function(){return d},WU:function(){return a},lt:function(){return c},ti:function(){return r}});var n=i(29138),o=i(74765);const s={ar:[".",","],bg:[",",""],bs:[",","."],ca:[",","."],cs:[",",""],da:[",","."],de:[",","."],"de-ch":[".",""],el:[",","."],en:[".",","],"en-au":[".",","],es:[",","."],"es-mx":[".",","],et:[",",""],fi:[",",""],fr:[",",""],"fr-ch":[",",""],he:[".",","],hi:[".",",","#,##,##0.###"],hr:[",","."],hu:[",",""],id:[",","."],it:[",","."],"it-ch":[".",""],ja:[".",","],ko:[".",","],lt:[",",""],lv:[",",""],mk:[",","."],nb:[",",""],nl:[",","."],no:[",",""],pl:[",",""],pt:[",","."],"pt-pt":[",",""],ro:[",","."],ru:[",",""],sk:[",",""],sl:[",","."],sr:[",","."],sv:[",",""],th:[".",","],tr:[",","."],uk:[",",""],vi:[",","."],zh:[".",","]};function r(e=(0,o.Kd)()){let t=(e=e.toLowerCase())in s;if(!t){const i=e.split("-");i.length>1&&i[0]in s&&(e=i[0],t=!0),t||(e="en")}const[i,n,r="#,##0.###"]=s[e];return{decimal:i,group:n,pattern:r}}function a(e,t){const i=r((t={...t}).locale);t.customs=i;const n=t.pattern||i.pattern;return isNaN(e)||Math.abs(e)===1/0?null:function(e,t,i){const n=(i=i||{}).customs.group,o=i.customs.decimal,s=t.split(";"),r=s[0];if((t=s[e<0?1:0]||"-"+r).includes("%"))e*=100;else if(t.includes(""))e*=1e3;else{if(t.includes(""))throw new Error("currency notation not supported");if(t.includes("E"))throw new Error("exponential notation not supported")}const a=l,c=r.match(a);if(!c)throw new Error("unable to find a number expression in pattern: "+t);return!1===i.fractional&&(i.places=0),t.replace(a,function(e,t,i){!0===(i=i||{}).places&&(i.places=0),i.places===1/0&&(i.places=6);const n=t.split("."),o="string"==typeof i.places&&i.places.indexOf(",");let s=i.places;o?s=i.places.slice(o+1):+s>=0||(s=(n[1]||[]).length),i.round<0||(e=Number(e.toFixed(Number(s))));const r=String(Math.abs(e)).split("."),a=r[1]||"";if(n[1]||i.places){o&&(i.places=i.places.slice(0,Math.max(0,o)));const e=void 0!==i.places?i.places:n[1]&&n[1].lastIndexOf("0")+1;+e>a.length&&(r[1]=a.padEnd(Number(e),"0")),+s<a.length&&(r[1]=a.slice(0,Math.max(0,Number(s))))}else r[1]&&r.pop();const l=n[0].replace(",","");let c=l.indexOf("0");-1!==c&&(c=l.length-c,c>r[0].length&&(r[0]=r[0].padStart(c,"0")),l.includes("#")||(r[0]=r[0].slice(-c)));let d,u,h=n[0].lastIndexOf(",");if(-1!==h){d=n[0].length-h-1;const e=n[0].slice(0,h);h=e.lastIndexOf(","),-1!==h&&(u=e.length-h-1)}const p=[];for(let e=r[0];e;){const t=e.length-d;p.push(t>0?e.slice(Math.max(0,t)):e),e=t>0?e.slice(0,t):"",u&&(d=u,u=void 0)}return r[0]=p.reverse().join(i.group||","),r.join(i.decimal||".")}(e,c[0],{decimal:o,group:n,places:i.places,round:i.round}))}(e,n,t)}const l=/[#0,]*[#0](?:\.0*#*)?/;function c(e){const t=r((e=e||{}).locale),i=e.pattern||t.pattern,o=t.group,s=t.decimal;let a=1;if(i.includes("%"))a/=100;else if(i.includes(""))a/=1e3;else if(i.includes(""))throw new Error("currency notation not supported");const c=i.split(";");1===c.length&&c.push("-"+c[0]);const d=h(c,(t=>(t="(?:"+(0,n.Qs)(t,".")+")").replace(l,(t=>{const i={signed:!1,separator:e.strict?o:[o,""],fractional:e.fractional,decimal:s,exponent:!1},n=t.split(".");let r=e.places;1===n.length&&1!==a&&(n[1]="###"),1===n.length||0===r?i.fractional=!1:(void 0===r&&(r=e.pattern?n[1].lastIndexOf("0")+1:1/0),r&&null==e.fractional&&(i.fractional=!0),!e.places&&+r<n[1].length&&(r+=","+n[1].length),i.places=r);const l=n[0].split(",");return l.length>1&&(i.groupSize=l.pop().length,l.length>1&&(i.groupSize2=l.pop().length)),"("+function(e){"places"in(e=e||{})||(e.places=1/0),"string"!=typeof e.decimal&&(e.decimal="."),"fractional"in e&&!String(e.places).startsWith("0")||(e.fractional=[!0,!1]),"exponent"in e||(e.exponent=[!0,!1]),"eSigned"in e||(e.eSigned=[!0,!1]);const t=u(e),i=h(e.fractional,(t=>{let i="";return t&&0!==e.places&&(i="\\"+e.decimal,e.places===1/0?i="(?:"+i+"\\d+)?":i+="\\d{"+e.places+"}"),i}),!0);let n=t+i;return i&&(n="(?:(?:"+n+")|(?:"+i+"))"),n+h(e.exponent,(t=>t?"([eE]"+u({signed:e.eSigned})+")":""))}(i)+")"}))),!0);return{regexp:d.replaceAll(/[\xa0 ]/g,"[\\s\\xa0]"),group:o,decimal:s,factor:a}}function d(e,t){const i=c(t),n=new RegExp("^"+i.regexp+"$").exec(e);if(!n)return NaN;let o=n[1];if(!n[1]){if(!n[2])return NaN;o=n[2],i.factor*=-1}return o=o.replaceAll(new RegExp("["+i.group+"\\s\\xa0]","g"),"").replace(i.decimal,"."),Number(o)*i.factor}function u(e){return"signed"in(e=e||{})||(e.signed=[!0,!1]),"separator"in e?"groupSize"in e||(e.groupSize=3):e.separator="",h(e.signed,(e=>e?"[-+]":""),!0)+h(e.separator,(t=>{if(!t)return"(?:\\d+)";" "===(t=(0,n.Qs)(t))?t="\\s":""===t&&(t="\\s\\xa0");const i=e.groupSize,o=e.groupSize2;if(o){const e="(?:0|[1-9]\\d{0,"+(o-1)+"}(?:["+t+"]\\d{"+o+"})*["+t+"]\\d{"+i+"})";return i-o>0?"(?:"+e+"|(?:0|[1-9]\\d{0,"+(i-1)+"}))":e}return"(?:0|[1-9]\\d{0,"+(i-1)+"}(?:["+t+"]\\d{"+i+"})*)"}),!0)}const h=(e,t,i)=>{if(!Array.isArray(e))return t(e);const n=[];for(let i=0;i<e.length;i++)n.push(t(e[i]));return p(n.join("|"),Boolean(i))},p=(e,t)=>"("+(t?"?:":"")+e+")"},26191:function(e,t,i){"use strict";i.d(t,{E:function(){return h},H:function(){return u}});var n=i(96373),o=i(30748),s=i(26821),r=i(24910);const a=(0,i(82846).Ue)(),l=(0,o.Ue)(),c=(0,o.Ue)(),d=(0,o.Ue)();function u(e,t,i){return(0,r.i)(a,t[0],t[1],1),(0,r.o)(a,a,(0,n.p4)(l,i)),0===a[2]?(0,s.t8)(e,a[0],a[1]):(0,s.t8)(e,a[0]/a[2],a[1]/a[2])}function h(e,t,i){return p(c,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]),p(d,i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]),(0,n.Jp)(e,(0,n.uj)(c,c),d),0!==e[8]&&(e[0]/=e[8],e[1]/=e[8],e[2]/=e[8],e[3]/=e[8],e[4]/=e[8],e[5]/=e[8],e[6]/=e[8],e[7]/=e[8],e[8]/=e[8]),e}function p(e,t,i,o,s,c,d,u,h){(0,n.t8)(e,t,o,c,i,s,d,1,1,1),(0,r.i)(a,u,h,1),(0,n.uj)(l,e);const[p,y,g]=(0,r.o)(a,a,(0,n.p4)(l,l));return(0,n.t8)(l,p,0,0,0,y,0,0,0,g),(0,n.Jp)(e,l,e)}},17256:function(e,t,i){"use strict";i.d(t,{$B:function(){return f},$i:function(){return b},BZ:function(){return p},DR:function(){return g},Ow:function(){return m},QU:function(){return d},cZ:function(){return y},kR:function(){return l},on:function(){return v},ul:function(){return h},wS:function(){return u},zD:function(){return c}});var n=i(88194),o=i(53286),s=i(60508),r=i(45213),a=i(40030);function l(){return(0,o.i)()}function c(){return(0,o.l)()}function d(e,t){const i=_(t),n=e.replaceAll(/[\u00B0\u00BA]/g,"^").replaceAll("","'").replaceAll("",'"'),a=[];return o.b.dmsToGeog(i,1,[n],a)?new s.Z(a[0][0],a[0][1],t||r.Z.WGS84):null}function u(e){return e&&l()?(0,a.p3)(e)??d(`0 0' 0" N | ${e}`)?.longitude??d(`0 N | ${e}`)?.longitude??null:null}function h(e){return e&&l()?(0,a.p3)(e)??d(`${e} | 0 0' 0" E`)?.latitude??d(`${e} | 0 E`)?.latitude??null:null}function p(e,t,i){const n=[],a=w(i);if(-1===a)return console.warn(`invalid conversionMode: ${i}`),null;const l=_(t);return o.e.mgrsToGeogExtended(l,1,[e],a,n)?new s.Z(n[0][0],n[0][1],t||r.Z.WGS84):null}function y(e,t){const i=[];!t&&/\(.+27/.test(e)&&(t=r.Z.GCS_NAD_1927);const n=_(t);return o.c.usngToGeog(n,1,[e],i)?new s.Z(i[0][0],i[0][1],t||r.Z.WGS84):null}function g(e,t,i){const n=[],a=C(i);if(-1===a)return console.warn(`invalid conversionMode: ${i}`),null;const l=_(t);return o.d.utmToGeog(l,1,[e],a,n)?new s.Z(n[0][0],n[0][1],t||r.Z.WGS84):null}function m(e,t,i=0){const n=[[e.x,e.y]],s=[],r=_(e.spatialReference);let a=0;switch(t){case"dd":a=o.b.geogToDd(r,1,n,i,s);break;case"ddm":a=o.b.geogToDdm(r,1,n,i,s);break;case"dms":a=o.b.geogToDms(r,1,n,i,s);break;default:return console.warn(`invalid format: ${t}`),null}return a?s[0]:null}function f(e,t,i=0,n=!1){const s=[[e.x,e.y]],r=[],a=_(e.spatialReference);let l=w(t);return-1===l?(console.warn(`invalid conversionMode: ${t}`),null):(n&&(l|=o.e.PE_MGRS_ADD_SPACES),o.e.geogToMgrsExtended(a,1,s,i,!1,l,r)?r[0]:null)}function v(e,t=0,i=!1){const n=[[e.x,e.y]],s=[],r=_(e.spatialReference);return o.c.geogToUsng(r,1,n,t,!1,i,s)?s[0]:null}function b(e,t,i=!1){const n=[[e.x,e.y]],s=[],r=_(e.spatialReference);let a=C(t);return-1===a?(console.warn(`invalid conversionMode: ${t}`),null):(i&&(a|=o.d.PE_UTM_OPTS_ADD_SPACES),o.d.geogToUtm(r,1,n,a,s)?s[0]:null)}function _(e){if(e??=r.Z.WGS84,e.wkid){const t=o.P.geogcs(e.wkid);if(!t)throw new n.Z("coordinate-formatter:invalid-spatial-reference","wkid is not valid");return t}const t=e.wkt2??e.wkt;if(t){const e=o.P.fromString(o.a.PE_TYPE_GEOGCS,t);if(!e)throw new n.Z("coordinate-formatter:invalid-spatial-reference","wkt is not valid");return e}throw new n.Z("coordinate-formatter:invalid-spatial-reference","wkid and wkt are missing")}function w(e){switch(e){case"automatic":return o.e.PE_MGRS_STYLE_AUTO;case"new-180-in-zone-01":return o.e.PE_MGRS_STYLE_NEW|o.e.PE_MGRS_180_ZONE_1_PLUS;case"new-180-in-zone-60":return o.e.PE_MGRS_STYLE_NEW;case"old-180-in-zone-01":return o.e.PE_MGRS_STYLE_OLD|o.e.PE_MGRS_180_ZONE_1_PLUS;case"old-180-in-zone-60":return o.e.PE_MGRS_STYLE_OLD;default:return-1}}function C(e){switch(e){case"latitude-band-indicators":return o.d.PE_UTM_OPTS_NONE;case"north-south-indicators":return o.d.PE_UTM_OPTS_NS;default:return-1}}},37204:function(e,t,i){"use strict";i.d(t,{SR:function(){return u},Ui:function(){return d}});var n=i(69306),o=i(47566),s=i(62951),r=i(28931),a=i(90756),l=i(76264),c=i(8554);function d(e){return h(e,!0)}function u(e){return h(e,!1)}function h(e,t){if(null==e)return null;const i=e.spatialReference,o=(0,c.C5)(i),r=(0,n.A)(e)?e.toJSON():e;if(!o)return r;const d=(0,c.sS)(i)?102100:4326,u=l.UZ[d].maxX,h=l.UZ[d].minX;if((0,a.wp)(r))return y(r,u,h);if((0,a.aW)(r))return r.points=r.points.map((e=>y(e,u,h))),r;if((0,a.YX)(r))return p(r,o);if((0,a.oU)(r)||(0,a.l9)(r)){const e=(0,s.$P)(_,r),i={xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3]},n=(0,l.XZ)(i.xmin,h)*(2*u),o=0===n?r:(0,l.Sy)(r,n);return i.xmin+=n,i.xmax+=n,i.xmax>u?v(o,u,t):i.xmin<h?v(o,h,t):o}return r}function p(e,t){if(!t)return e;const i=function(e,t){const i=[],{ymin:n,ymax:o,xmin:s,xmax:r}=e,a=e.xmax-e.xmin,[l,c]=t.valid,{x:d,frameId:u}=g(e.xmin,t),{x:h,frameId:p}=g(e.xmax,t),y=d===h&&a>0;if(a>2*c){const e={xmin:s<r?d:h,ymin:n,xmax:c,ymax:o},t={xmin:l,ymin:n,xmax:s<r?h:d,ymax:o},a={xmin:0,ymin:n,xmax:c,ymax:o},y={xmin:l,ymin:n,xmax:0,ymax:o},g=[],f=[];m(e,a)&&g.push(u),m(e,y)&&f.push(u),m(t,a)&&g.push(p),m(t,y)&&f.push(p);for(let e=u+1;e<p;e++)g.push(e),f.push(e);i.push(new b(e,[u]),new b(t,[p]),new b(a,g),new b(y,f))}else d>h||y?i.push(new b({xmin:d,ymin:n,xmax:c,ymax:o},[u]),new b({xmin:l,ymin:n,xmax:h,ymax:o},[p])):i.push(new b({xmin:d,ymin:n,xmax:h,ymax:o},[u]));return i}(e,t).map((e=>e.extent));return i.length<2?i[0]||e:i.length>2?(e.xmin=t.valid[0],e.xmax=t.valid[1],e):{rings:i.map((e=>[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]))}}function y(e,t,i){if(Array.isArray(e)){const n=e[0];if(n>t){const i=(0,l.XZ)(n,t);e[0]=n+i*(-2*t)}else if(n<i){const t=(0,l.XZ)(n,i);e[0]=n+t*(-2*i)}}else{const n=e.x;if(n>t){const i=(0,l.XZ)(n,t);e.x+=i*(-2*t)}else if(n<i){const t=(0,l.XZ)(n,i);e.x+=t*(-2*i)}}return e}function g(e,t){const[i,n]=t.valid,o=2*n;let s,r=0;return e>n?(s=Math.ceil(Math.abs(e-n)/o),e-=s*o,r=s):e<i&&(s=Math.ceil(Math.abs(e-i)/o),e+=s*o,r=-s),{x:e,frameId:r}}function m(e,t){const{xmin:i,ymin:n,xmax:o,ymax:s}=t;return f(e,i,n)&&f(e,i,s)&&f(e,o,s)&&f(e,o,n)}function f(e,t,i){return t>=e.xmin&&t<=e.xmax&&i>=e.ymin&&i<=e.ymax}function v(e,t,i=!0){const n=!(0,a.l9)(e);if(n&&(0,r.Zy)(e),i)return(new w).cut(e,t);const o=n?e.rings:e.paths,s=n?4:2,l=o.length,c=-2*t;for(let e=0;e<l;e++){const t=o[e];if(t&&t.length>=s){const e=[];for(const i of t)e.push([i[0]+c,i[1]]);o.push(e)}}return n?e.rings=o:e.paths=o,e}class b{constructor(e,t){this.extent=e,this.frameIds=t}}const _=(0,o.Ue)();class w{constructor(){this._linesIn=[],this._linesOut=[]}cut(e,t){let i;if(this._xCut=t,e.rings)this._closed=!0,i=e.rings,this._minPts=4;else{if(!e.paths)return null;this._closed=!1,i=e.paths,this._minPts=2}for(const e of i){if(!e||e.length<this._minPts)continue;let t=!0;for(const i of e)t?(this.moveTo(i),t=!1):this.lineTo(i);this._closed&&this.close()}this._pushLineIn(),this._pushLineOut(),i=[];for(const e of this._linesIn)e&&e.length>=this._minPts&&i.push(e);const n=-2*this._xCut;for(const e of this._linesOut)if(e&&e.length>=this._minPts){for(const t of e)t[0]+=n;i.push(e)}return this._closed?e.rings=i:e.paths=i,e}moveTo(e){this._pushLineIn(),this._pushLineOut(),this._prevSide=this._side(e[0]),this._moveTo(e[0],e[1],this._prevSide),this._prevPt=e,this._firstPt=e}lineTo(e){const t=this._side(e[0]);if(t*this._prevSide==-1){const i=this._intersect(this._prevPt,e);this._lineTo(this._xCut,i,0),this._prevSide=0,this._lineTo(e[0],e[1],t)}else this._lineTo(e[0],e[1],t);this._prevSide=t,this._prevPt=e}close(){const e=this._firstPt,t=this._prevPt;e[0]===t[0]&&e[1]===t[1]||this.lineTo(e),this._checkClosingPt(this._lineIn),this._checkClosingPt(this._lineOut)}_moveTo(e,t,i){this._closed?(this._lineIn.push([i<=0?e:this._xCut,t]),this._lineOut.push([i>=0?e:this._xCut,t])):(i<=0&&this._lineIn.push([e,t]),i>=0&&this._lineOut.push([e,t]))}_lineTo(e,t,i){this._closed?(C(this._lineIn,i<=0?e:this._xCut,t),C(this._lineOut,i>=0?e:this._xCut,t)):i<0?(0===this._prevSide&&this._pushLineOut(),this._lineIn.push([e,t])):i>0?(0===this._prevSide&&this._pushLineIn(),this._lineOut.push([e,t])):this._prevSide<0?(this._lineIn.push([e,t]),this._lineOut.push([e,t])):this._prevSide>0&&(this._lineOut.push([e,t]),this._lineIn.push([e,t]))}_checkClosingPt(e){const t=e.length;t>3&&e[0][0]===this._xCut&&e[t-2][0]===this._xCut&&e[1][0]===this._xCut&&(e[0][1]=e[t-2][1],e.pop())}_side(e){return e<this._xCut?-1:e>this._xCut?1:0}_intersect(e,t){const i=(this._xCut-e[0])/(t[0]-e[0]);return e[1]+i*(t[1]-e[1])}_pushLineIn(){this._lineIn&&this._lineIn.length>=this._minPts&&this._linesIn.push(this._lineIn),this._lineIn=[]}_pushLineOut(){this._lineOut&&this._lineOut.length>=this._minPts&&this._linesOut.push(this._lineOut),this._lineOut=[]}}function C(e,t,i){const n=e.length;n>1&&e[n-1][0]===t&&e[n-2][0]===t?e[n-1][1]=i:e.push([t,i])}},47635:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return Y}});var n=i(73440),o=i(997),s=i(84060),r=i(93568),a=i(95490),l=i(17155),c=i(61432),d=i(96711),u=(i(83850),i(48023)),h=i(71354),p=i(45213),y=i(98842),g=i(38209),m=i(88194),f=i(97006),v=i(82592),b=i(67764),_=i(73967),w=i(13878);let C=class extends f.Z{constructor(){super(...arguments),this.type="geojson",this.refresh=(0,r.Ds)((async e=>{await this.load();const{extent:t,timeExtent:i}=await this._connection.invoke("refresh",e);return this.sourceJSON.extent=t,i&&(this.sourceJSON.timeInfo.timeExtent=[i.start,i.end]),{dataChanged:!0,updates:{extent:this.sourceJSON.extent,timeInfo:this.sourceJSON.timeInfo}}}))}load(e){const t=null!=e?e.signal:null;return this.addResolvingPromise(this._startWorker(t)),Promise.resolve(this)}destroy(){this._connection?.close(),this._connection=null}applyEdits(e){return this.load().then((()=>this._applyEdits(e)))}openPorts(){return this.load().then((()=>this._connection.openPorts()))}queryFeatures(e,t={}){return this.load(t).then((()=>this._connection.invoke("queryFeatures",e?e.toJSON():null,t))).then((e=>w.Z.fromJSON(e)))}queryFeaturesJSON(e,t={}){return this.load(t).then((()=>this._connection.invoke("queryFeatures",e?e.toJSON():null,t)))}queryFeatureCount(e,t={}){return this.load(t).then((()=>this._connection.invoke("queryFeatureCount",e?e.toJSON():null,t)))}queryObjectIds(e,t={}){return this.load(t).then((()=>this._connection.invoke("queryObjectIds",e?e.toJSON():null,t)))}queryExtent(e,t={}){return this.load(t).then((()=>this._connection.invoke("queryExtent",e?e.toJSON():null,t))).then((e=>({count:e.count,extent:h.Z.fromJSON(e.extent)})))}querySnapping(e,t={}){return this.load(t).then((()=>this._connection.invoke("querySnapping",e,t)))}async queryAttributeBins(e,t={}){return await this.load(),this._connection.invoke("queryAttributeBins",e?.toJSON(),t)}_applyEdits(e){if(!this._connection)throw new m.Z("geojson-layer-source:edit-failure","Memory source not loaded");const t=this.layer.objectIdField,i=[],n=[],o=[];if(e.addFeatures)for(const t of e.addFeatures)i.push(this._serializeFeature(t));if(e.deleteFeatures)for(const i of e.deleteFeatures)"objectId"in i&&null!=i.objectId?n.push(i.objectId):"attributes"in i&&null!=i.attributes[t]&&n.push(i.attributes[t]);if(e.updateFeatures)for(const t of e.updateFeatures)o.push(this._serializeFeature(t));return this._connection.invoke("applyEdits",{adds:i,updates:o,deletes:n}).then((({extent:e,timeExtent:t,featureEditResults:i})=>(this.sourceJSON.extent=e,t&&(this.sourceJSON.timeInfo.timeExtent=[t.start,t.end]),this._createEditsResult(i))))}_createEditsResult(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(e){const t=!0===e.success?null:e.error||{code:void 0,description:""};return{objectId:e.objectId,globalId:e.globalId,error:t?new m.Z("geojson-layer-source:edit-failure",t.description,{code:t.code}):null}}_serializeFeature(e){const{attributes:t}=e,i=this._geometryForSerialization(e);return i?{geometry:i.toJSON(),attributes:t}:{attributes:t}}_geometryForSerialization(e){const{geometry:t}=e;return null==t?null:"mesh"===t.type||"extent"===t.type?b.Z.fromExtent(t.extent):t}async _startWorker(e){this._connection=await(0,v.bA)("GeoJSONSourceWorker",{strategy:(0,c.Z)("feature-layers-workers")?"dedicated":"local",signal:e,registryTarget:this});const{fields:t,spatialReference:i,hasZ:n,geometryType:o,objectIdField:s,url:r,timeInfo:a,customParameters:l}=this.layer,u="defaults"===this.layer.originOf("spatialReference"),h={url:r,customParameters:l,fields:t&&t.map((e=>e.toJSON())),geometryType:y.Mk.toJSON(o),hasZ:n,objectIdField:s,timeInfo:a?a.toJSON():null,spatialReference:u?null:i&&i.toJSON()},p=await this._connection.invoke("load",h,{signal:e});for(const e of p.warnings)d.Z.getLogger(this.layer).warn("#load()",`${e.message} (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{warning:e});p.featureErrors.length&&d.Z.getLogger(this.layer).warn("#load()",`Encountered ${p.featureErrors.length} validation errors while loading features. (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{errors:p.featureErrors}),this.sourceJSON=p.layerDefinition,this.capabilities=(0,_.MS)(this.sourceJSON.hasZ,!0)}};(0,n._)([(0,l.Cb)()],C.prototype,"capabilities",void 0),(0,n._)([(0,l.Cb)()],C.prototype,"type",void 0),(0,n._)([(0,l.Cb)({constructOnly:!0})],C.prototype,"layer",void 0),(0,n._)([(0,l.Cb)()],C.prototype,"sourceJSON",void 0),C=(0,n._)([(0,u.j)("esri.layers.graphics.sources.GeoJSONSource")],C);var x=i(83263),S=i(55591),E=i(7150),k=i(15303),L=i(88920),T=i(85330),M=i(90833),I=i(27202),O=i(19306),P=i(3752),A=i(99671),R=i(30472),D=i(93295),$=i(88792),N=i(11755),F=i(49651),V=i(13545),z=i(76554),Z=i(89428),B=i(80862),U=i(60541),H=i(29191),G=i(99382),j=i(88097);const K=(0,V.v)();let W=class extends((0,M.c_)((0,E.tM)((0,S.N)((0,L.M)((0,k.b)((0,x.h7)((0,A.n)((0,R._)((0,P.M)((0,O.Q)((0,T.q)((0,I.I)((0,s.R)(g.Z)))))))))))))){constructor(e){super(e),this.attributeTableTemplate=null,this.copyright=null,this.dateFieldsTimeZone=null,this.definitionExpression=null,this.displayField=null,this.editingEnabled=!1,this.elevationInfo=null,this.fields=null,this.fieldsIndex=null,this.fullExtent=null,this.geometryType=null,this.hasZ=void 0,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.operationalLayerType="GeoJSON",this.outFields=null,this.popupEnabled=!0,this.popupTemplate=null,this.screenSizePerspectiveEnabled=!0,this.source=new C({layer:this}),this.spatialReference=p.Z.WGS84,this.templates=null,this.title="GeoJSON",this.type="geojson"}destroy(){this.source?.destroy()}load(e){const t=this.loadFromPortal({supportedTypes:["GeoJson"],supportsData:!1},e).catch(r.r9).then((()=>this.source.load(e))).then((()=>{this.read(this.source.sourceJSON,{origin:"service",url:this.parsedUrl}),this.revert(["objectIdField","fields","timeInfo"],"service"),(0,z.YN)(this.renderer,this.fieldsIndex),(0,z.UF)(this.timeInfo,this.fieldsIndex)}));return this.addResolvingPromise(t),Promise.resolve(this)}get capabilities(){return this.source?this.source.capabilities:null}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("capabilities"),(this._get("createQueryVersion")||0)+1}get defaultPopupTemplate(){return this.createPopupTemplate()}get isTable(){return this.loaded&&null==this.geometryType}get parsedUrl(){return this.url?(0,a.mN)(this.url):null}set renderer(e){(0,z.YN)(e,this.fieldsIndex),this._set("renderer",e)}set url(e){if(!e)return void this._set("url",e);const t=(0,a.mN)(e);this._set("url",t.path),t.query&&(this.customParameters={...this.customParameters,...t.query})}async applyEdits(e,t){const{applyEdits:n}=await i.e(99813).then(i.bind(i,99813));await this.load();const o=await n(this,this.source,e,t);return this.read({extent:this.source.sourceJSON.extent,timeInfo:this.source.sourceJSON.timeInfo},{origin:"service",ignoreDefaults:!0}),o}on(e,t){return super.on(e,t)}createPopupTemplate(e){return(0,G.eZ)(this,e)}createQuery(){const e=new H.Z,t=this.capabilities?.data;e.returnGeometry=!0,t&&t.supportsZ&&(e.returnZ=!0),e.outFields=["*"],e.where=this.definitionExpression||"1=1";const{timeOffset:i,timeExtent:n}=this;return e.timeExtent=null!=i&&null!=n?n.offset(-i.value,i.unit):n||null,e}getFieldDomain(e,t){return this.getField(e)?.domain}getField(e){return this.fieldsIndex.get(e)}queryFeatures(e,t){return this.load().then((()=>this.source.queryFeatures(H.Z.from(e)||this.createQuery(),t))).then((e=>{if(e?.features)for(const t of e.features)t.layer=t.sourceLayer=this;return e}))}queryObjectIds(e,t){return this.load().then((()=>this.source.queryObjectIds(H.Z.from(e)||this.createQuery(),t)))}queryFeatureCount(e,t){return this.load().then((()=>this.source.queryFeatureCount(H.Z.from(e)||this.createQuery(),t)))}queryExtent(e,t){return this.load().then((()=>this.source.queryExtent(H.Z.from(e)||this.createQuery(),t)))}async queryAttributeBins(e,t){const{source:n,capabilities:o}=await this.load();(0,$.O2)(e,o,"GeoJSONLayer");const s=await Promise.all([i.e(37608),i.e(34042)]).then(i.bind(i,37608)),r=await n.queryAttributeBins(s.default.from(e),t);if(r.features)for(const e of r.features)e.layer=e.sourceLayer=this;return r}async hasDataChanged(){try{const{dataChanged:e,updates:t}=await this.source.refresh(this.customParameters);return null!=t&&this.read(t,{origin:"service",url:this.parsedUrl,ignoreDefaults:!0}),e}catch{}return!1}};(0,n._)([(0,l.Cb)(D.t4)],W.prototype,"attributeTableTemplate",void 0),(0,n._)([(0,l.Cb)({readOnly:!0,json:{read:!1,write:!1}})],W.prototype,"capabilities",null),(0,n._)([(0,l.Cb)({type:String})],W.prototype,"copyright",void 0),(0,n._)([(0,l.Cb)({readOnly:!0})],W.prototype,"createQueryVersion",null),(0,n._)([(0,l.Cb)((0,j.mi)("dateFieldsTimeReference"))],W.prototype,"dateFieldsTimeZone",void 0),(0,n._)([(0,l.Cb)({readOnly:!0})],W.prototype,"defaultPopupTemplate",null),(0,n._)([(0,l.Cb)({type:String,json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],W.prototype,"definitionExpression",void 0),(0,n._)([(0,l.Cb)({type:String})],W.prototype,"displayField",void 0),(0,n._)([(0,l.Cb)({type:Boolean})],W.prototype,"editingEnabled",void 0),(0,n._)([(0,l.Cb)(D.PV)],W.prototype,"elevationInfo",void 0),(0,n._)([(0,l.Cb)({type:[F.Z],json:{name:"layerDefinition.fields",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"fields"}}}})],W.prototype,"fields",void 0),(0,n._)([(0,l.Cb)(K.fieldsIndex)],W.prototype,"fieldsIndex",void 0),(0,n._)([(0,l.Cb)({type:h.Z,json:{name:"extent"}})],W.prototype,"fullExtent",void 0),(0,n._)([(0,l.Cb)({type:["point","polygon","polyline","multipoint"],json:{read:{reader:y.Mk.read}}})],W.prototype,"geometryType",void 0),(0,n._)([(0,l.Cb)({type:Boolean})],W.prototype,"hasZ",void 0),(0,n._)([(0,l.Cb)(D.id)],W.prototype,"id",void 0),(0,n._)([(0,l.Cb)({type:Boolean,readOnly:!0})],W.prototype,"isTable",null),(0,n._)([(0,l.Cb)(D.iR)],W.prototype,"labelsVisible",void 0),(0,n._)([(0,l.Cb)({type:[Z.Z],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:B.r},write:!0}})],W.prototype,"labelingInfo",void 0),(0,n._)([(0,l.Cb)(D.rn)],W.prototype,"legendEnabled",void 0),(0,n._)([(0,l.Cb)({type:["show","hide"]})],W.prototype,"listMode",void 0),(0,n._)([(0,l.Cb)({type:String,json:{name:"layerDefinition.objectIdField",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"objectIdField"}}}})],W.prototype,"objectIdField",void 0),(0,n._)([(0,l.Cb)(D.Oh)],W.prototype,"opacity",void 0),(0,n._)([(0,l.Cb)({type:["GeoJSON"]})],W.prototype,"operationalLayerType",void 0),(0,n._)([(0,l.Cb)(K.outFields)],W.prototype,"outFields",void 0),(0,n._)([(0,l.Cb)({readOnly:!0})],W.prototype,"parsedUrl",null),(0,n._)([(0,l.Cb)(D.C_)],W.prototype,"popupEnabled",void 0),(0,n._)([(0,l.Cb)({type:o.Z,json:{name:"popupInfo",write:!0}})],W.prototype,"popupTemplate",void 0),(0,n._)([(0,l.Cb)({types:U.Av,json:{name:"layerDefinition.drawingInfo.renderer",write:!0,origins:{service:{name:"drawingInfo.renderer"},"web-scene":{types:U.o}}}})],W.prototype,"renderer",null),(0,n._)([(0,l.Cb)(D.YI)],W.prototype,"screenSizePerspectiveEnabled",void 0),(0,n._)([(0,l.Cb)({readOnly:!0})],W.prototype,"source",void 0),(0,n._)([(0,l.Cb)({type:p.Z})],W.prototype,"spatialReference",void 0),(0,n._)([(0,l.Cb)({type:[N.Z]})],W.prototype,"templates",void 0),(0,n._)([(0,l.Cb)()],W.prototype,"title",void 0),(0,n._)([(0,l.Cb)({json:{read:!1},readOnly:!0})],W.prototype,"type",void 0),(0,n._)([(0,l.Cb)(D.HQ)],W.prototype,"url",null),W=(0,n._)([(0,u.j)("esri.layers.GeoJSONLayer")],W);const Y=W},53447:function(e,t,i){"use strict";i.d(t,{Z:function(){return h}});var n=i(73440),o=i(17155),s=(i(61432),i(96711),i(83850),i(48023)),r=i(34415),a=i(38209),l=i(83263),c=i(3752),d=i(53866),u=i(13689);let h=class extends((0,l.h7)((0,c.M)(a.Z))){constructor(e){super(e),this.elevationInfo=null,this.graphics=new d.J,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,t){return super.on(e,t)}graphicChanged(e){this.emit("graphic-update",e)}};(0,n._)([(0,o.Cb)({type:u.Z})],h.prototype,"elevationInfo",void 0),(0,n._)([(0,o.Cb)((0,r.z)(d.J,"graphics"))],h.prototype,"graphics",void 0),(0,n._)([(0,o.Cb)({type:["show","hide"]})],h.prototype,"listMode",void 0),(0,n._)([(0,o.Cb)()],h.prototype,"screenSizePerspectiveEnabled",void 0),(0,n._)([(0,o.Cb)({readOnly:!0})],h.prototype,"type",void 0),(0,n._)([(0,o.Cb)({constructOnly:!0})],h.prototype,"internal",void 0),h=(0,n._)([(0,s.j)("esri.layers.GraphicsLayer")],h)},43141:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return A}});var n=i(73440),o=i(78619),s=i(88194),r=i(96711),a=i(99574),l=i(84060),c=i(93568),d=i(90403),u=i(17155),h=(i(61432),i(83850),i(1194)),p=i(48023),y=i(75432),g=i(24910),m=i(82846),f=i(47925),v=i(71354),b=i(45213),_=i(30146),w=i(38209),C=i(38448),x=i(58560),S=i(55591),E=i(85330),k=i(27202),L=i(3752),T=i(93295),M=i(97113),I=i(51870),O=i(28938);let P=class extends((0,x.Y)((0,E.q)((0,k.I)((0,L.M)((0,l.R)((0,S.N)((0,C.V)(w.Z)))))))){readModifications(e,t,i){this._modificationsSource={url:(0,O.f)(e,i),context:i}}initialize(){this.addHandles((0,d.on)((()=>this.modifications),"after-changes",(()=>this.modifications=this.modifications),d.Z_))}constructor(e){super(e),this.operationalLayerType="IntegratedMesh3DTilesLayer",this.modifications=null,this._modificationsSource=null,this.spatialReference=new b.Z({wkid:4326,vcsWkid:115700}),this.fullExtent=new v.Z(-180,-90,180,90,this.spatialReference),this.url=null,this.type="integrated-mesh-3dtiles",this.path=null,this.minScale=0,this.maxScale=0,this.rootTilesetJSON=null}set elevationInfo(e){null!=e&&"absolute-height"!==e.mode||this._set("elevationInfo",e),this._validateElevationInfo(e)}_verifyArray(e,t){if(!Array.isArray(e)||e.length<t)return!1;for(const t of e)if("number"!=typeof t)return!1;return!0}_initFullExtent(){const e=this.rootTilesetJSON?.root?.boundingVolume;if(!e)return;if(e.box){const t=e?.box;if(t[3]>7972671&&t[7]>7972671&&t[11]>7945940)return}const t=this.rootTilesetJSON?.root?.transform,i=(0,m.Ue)();if(e.region&&this._verifyArray(e.region,6)){const t=e.region,i=(0,a.BV)(t[0]),n=(0,a.BV)(t[1]),o=t[4],s=(0,a.BV)(t[2]),r=(0,a.BV)(t[3]),l=t[5];this.fullExtent=new v.Z({xmin:i,ymin:n,zmin:o,xmax:s,ymax:r,zmax:l,spatialReference:this.spatialReference})}else if(e.sphere&&this._verifyArray(e.sphere,4)){const n=e.sphere,o=(0,m.al)(n[0],n[1],n[2]),s=n[3]/Math.sqrt(3),r=(0,m.Ue)();(0,g.d)(r,o,(0,m.al)(s,s,s));const a=(0,m.Ue)();if((0,g.f)(a,o,(0,m.al)(s,s,s)),t&&this._verifyArray(t,16)){const e=t;(0,g.t)(i,r,e),(0,g.c)(r,i),(0,g.t)(i,a,e),(0,g.c)(a,i)}(0,_.projectBuffer)(r,f.pn,0,r,b.Z.WGS84,0),(0,_.projectBuffer)(a,f.pn,0,a,b.Z.WGS84,0);const l=(0,m.Ue)(),c=(0,m.Ue)();(0,g.A)(l,r,a),(0,g.z)(c,r,a),this.fullExtent=new v.Z({xmin:l[0],ymin:l[1],zmin:l[2],xmax:c[0],ymax:c[1],zmax:c[2],spatialReference:this.spatialReference})}else if(e.box&&this._verifyArray(e.box,12)){const i=e.box,n=(0,m.al)(i[0],i[1],i[2]),o=(0,m.al)(i[3],i[4],i[5]),s=(0,m.al)(i[6],i[7],i[8]),r=(0,m.al)(i[9],i[10],i[11]),a=[];for(let e=0;e<8;++e)a.push((0,m.Ue)());if((0,g.f)(a[0],n,o),(0,g.f)(a[0],a[0],s),(0,g.f)(a[0],a[0],r),(0,g.a)(a[1],n,o),(0,g.f)(a[1],a[1],s),(0,g.f)(a[1],a[1],r),(0,g.f)(a[2],n,o),(0,g.a)(a[2],a[2],s),(0,g.f)(a[2],a[2],r),(0,g.a)(a[3],n,o),(0,g.a)(a[3],a[3],s),(0,g.f)(a[3],a[3],r),(0,g.f)(a[4],n,o),(0,g.f)(a[4],a[4],s),(0,g.a)(a[4],a[4],r),(0,g.a)(a[5],n,o),(0,g.f)(a[5],a[5],s),(0,g.a)(a[5],a[5],r),(0,g.f)(a[6],n,o),(0,g.a)(a[6],a[6],s),(0,g.a)(a[6],a[6],r),(0,g.a)(a[7],n,o),(0,g.a)(a[7],a[7],s),(0,g.a)(a[7],a[7],r),t&&this._verifyArray(t,16)){const e=t;for(let t=0;t<8;++t)(0,g.t)(a[t],a[t],e)}const l=(0,m.al)(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),c=(0,m.al)(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);for(let e=0;e<8;++e)(0,_.projectBuffer)(a[e],f.pn,0,a[e],b.Z.WGS84,0),(0,g.A)(c,c,a[e]),(0,g.z)(l,l,a[e]);this.fullExtent=new v.Z({xmin:c[0],ymin:c[1],zmin:c[2],xmax:l[0],ymax:l[1],zmax:l[2],spatialReference:this.spatialReference})}}async load(e){return this.addResolvingPromise(this._doLoad(e)),this}async _doLoad(e){const t=null!=e?e.signal:null;try{await this.loadFromPortal({supportedTypes:["3DTiles Service"],validateItem:e=>{if(e.typeKeywords?.includes("IntegratedMesh"))return!0;throw new s.Z("portal:invalid-layer-item-type","Invalid layer item, expected '${expectedType}' ",{expectedType:"3DTiles Service containing IntegratedMesh"})}},e)}catch(e){(0,c.r9)(e)}if(null!=this._modificationsSource){const t=await M.Z.fromUrl(this._modificationsSource.url,this.spatialReference,e);this.setAtOrigin("modifications",t,this._modificationsSource.context.origin),this._modificationsSource=null}if(this.url){const e=(0,o.Z)(this.url,{query:{...this.customParameters,token:this.apiKey},responseType:"json",signal:t}).then((e=>{this.rootTilesetJSON=e.data,this._initFullExtent()}),(e=>{(0,c.r9)(e)}));await e}}beforeSave(){if(null!=this._modificationsSource)return this.load().then((()=>{}),(()=>{}))}async fetchAttributionData(){return this.load().then((()=>({})))}_validateElevationInfo(e){const t="Integrated mesh 3d tiles layers";(0,I.LR)(r.Z.getLogger(this),(0,I.Uy)(t,"absolute-height",e)),(0,I.LR)(r.Z.getLogger(this),(0,I.kf)(t,e))}};(0,n._)([(0,u.Cb)({type:["IntegratedMesh3DTilesLayer"]})],P.prototype,"operationalLayerType",void 0),(0,n._)([(0,u.Cb)({type:M.Z,clonable:e=>e.clone()}),(0,y.B)({origins:["web-scene","portal-item"],type:"resource",prefix:"modifications"})],P.prototype,"modifications",void 0),(0,n._)([(0,h.r)(["web-scene","portal-item"],"modifications")],P.prototype,"readModifications",null),(0,n._)([(0,u.Cb)({type:b.Z})],P.prototype,"spatialReference",void 0),(0,n._)([(0,u.Cb)({type:v.Z})],P.prototype,"fullExtent",void 0),(0,n._)([(0,u.Cb)(T.PV)],P.prototype,"elevationInfo",null),(0,n._)([(0,u.Cb)({type:["show","hide"]})],P.prototype,"listMode",void 0),(0,n._)([(0,u.Cb)(T.HQ)],P.prototype,"url",void 0),(0,n._)([(0,u.Cb)({readOnly:!0})],P.prototype,"type",void 0),(0,n._)([(0,u.Cb)({type:String,json:{origins:{"web-scene":{read:!0,write:!0},"portal-item":{read:!0,write:!0}},read:!1}})],P.prototype,"path",void 0),(0,n._)([(0,u.Cb)({type:Number,json:{name:"layerDefinition.minScale",write:!0,origins:{service:{read:!1,write:!1}}}})],P.prototype,"minScale",void 0),(0,n._)([(0,u.Cb)({type:Number,json:{name:"layerDefinition.maxScale",write:!0,origins:{service:{read:!1,write:!1}}}})],P.prototype,"maxScale",void 0),P=(0,n._)([(0,p.j)("esri.layers.IntegratedMesh3DTilesLayer")],P);const A=P},57040:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return Z}});var n=i(73440),o=i(78619),s=i(88194),r=i(332),a=i(84060),l=i(93568),c=i(17155),d=i(95226),u=(i(61432),i(83850),i(1194)),h=i(48023),p=i(29884),y=i(66951),g=i(71354),m=i(4469),f=i(8554),v=i(38209),b=i(38448),_=i(34085),w=i(58560),C=i(83263),x=i(55591),S=i(85330),E=i(27202),k=i(19306),L=i(3752),T=i(70937),M=i(99671),I=i(93295),O=i(33287),P=i(97349),A=i(38120),R=i(33285),D=i(10852),$=i(13689),N=i(85913),F=i(88097),V=i(3651);let z=class extends((0,C.h7)((0,M.n)((0,L.M)((0,T.x)((0,_.O)((0,w.Y)((0,S.q)((0,E.I)((0,a.R)((0,k.Q)((0,b.V)((0,x.N)(v.Z))))))))))))){constructor(...e){super(...e),this._exportImageParameters=new O.R({layer:this}),this.dateFieldsTimeZone=null,this.datesInUnknownTimezone=!1,this.dpi=96,this.elevationInfo=new $.Z({mode:"on-the-ground"}),this.gdbVersion=null,this.imageFormat="png24",this.imageMaxHeight=2048,this.imageMaxWidth=2048,this.imageTransparency=!0,this.isReference=null,this.labelsVisible=!1,this.operationalLayerType="ArcGISMapServiceLayer",this.preferredTimeZone=null,this.sourceJSON=null,this.sublayers=null,this.type="map-image",this.url=null,this._debouncedSaveOperations=(0,l.Ds)((async(e,t,n)=>{const{save:o,saveAs:s}=await i.e(85790).then(i.bind(i,85790));switch(e){case V.x.SAVE:return o(this,t);case V.x.SAVE_AS:return s(this,n,t)}}))}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}load(e){const t=null!=e?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},e).catch(l.r9).then((()=>this._fetchService(t)))),Promise.resolve(this)}destroy(){this._exportImageParameters.destroy()}readImageFormat(e,t){const i=t.supportedImageFormatTypes;return i&&i.includes("PNG32")?"png32":"png24"}writeSublayers(e,t,i,n){if(!this.loaded||!e)return;const o=e.slice().reverse().flatten((({sublayers:e})=>e&&e.toArray().reverse())).toArray();let s=!1;const r=(0,y.M9)(n.origin);let a;if(this.capabilities?.operations.supportsExportMap&&this.capabilities?.exportMap?.supportsDynamicLayers)if(r===y.s3.PORTAL_ITEM){const e=this.createSublayersForOrigin("service").sublayers;s=(0,R.QV)(o,e,y.s3.SERVICE)}else if(r>y.s3.PORTAL_ITEM){const e=this.createSublayersForOrigin("portal-item");s=(0,R.QV)(o,e.sublayers,(0,y.M9)(e.origin)),a=e.originWithPartialOverrides}const l=[],c={writeSublayerStructure:s,...n,minimumWritableOrigin:a};let d=s||this.hasVisibleLayersForOrigin(r);o.forEach((e=>{const t=e.write({},c);l.push(t),d=d||"user"===e.originOf("visible")})),l.some((e=>Object.keys(e).length>1))&&(t.layers=l),d&&(t.visibleLayers=o.filter((e=>e.visible)).map((e=>e.id)))}createExportImageParameters(e,t,i,n){const o=n?.pixelRatio||1;e&&this.version>=10&&(e=e.clone().shiftCentralMeridian()),this._exportImageParameters.floors=n?.floors??null,this._exportImageParameters.scale=(0,m.yZ)({extent:e,width:t})*o;const s=this._exportImageParameters.toJSON(),r=!n?.rotation||this.version<10.3?{}:{rotation:-n.rotation},a=e?.spatialReference,l=(0,f.B9)(a);s.dpi*=o;const c={};if(n?.timeExtent){const{start:e,end:t}=n.timeExtent.toJSON();c.time=e&&t&&e===t?""+e:`${e??"null"},${t??"null"}`}else this.timeInfo&&!this.timeInfo.hasLiveData&&(c.time="null,null");return{bbox:e?e.xmin+","+e.ymin+","+e.xmax+","+e.ymax:void 0,bboxSR:l,imageSR:l,size:t+","+i,...s,...r,...c}}async fetchImage(e,t,i,n){const{data:o}=await this._fetchImage("image",e,t,i,n);return o}async fetchImageBitmap(e,t,i,n){const{data:o,url:s}=await this._fetchImage("blob",e,t,i,n);return(0,P.g)(o,s,n?.signal)}async fetchRecomputedExtents(e={}){const t={...e,query:{returnUpdates:!0,f:"json",...this.customParameters,token:this.apiKey}},{data:i}=await(0,o.Z)(this.url,t),{extent:n,fullExtent:s,timeExtent:r}=i,a=n||s;return{fullExtent:a&&g.Z.fromJSON(a),timeExtent:r&&N.T.fromJSON({start:r[0],end:r[1]})}}loadAll(){return(0,r.G)(this,(e=>{e(this.allSublayers),e(this.subtables)}))}async save(e){return this._debouncedSaveOperations(V.x.SAVE,e)}async saveAs(e,t){return this._debouncedSaveOperations(V.x.SAVE_AS,t,e)}serviceSupportsSpatialReference(e){return(0,D.D)(this,e)}async _fetchImage(e,t,i,n,r){const a={responseType:e,signal:r?.signal??null,query:{...this.parsedUrl.query,...this.createExportImageParameters(t,i,n,r),f:"image",...this.refreshParameters,...this.customParameters,token:this.apiKey}},c=this.parsedUrl.path+"/export";if(null!=a.query?.dynamicLayers&&!this.capabilities?.exportMap?.supportsDynamicLayers)throw new s.Z("mapimagelayer:dynamiclayer-not-supported",`service ${this.url} doesn't support dynamic layers, which is required to be able to change the sublayer's order, rendering, labeling or source.`,{query:a.query});try{const{data:e}=await(0,o.Z)(c,a);return{data:e,url:c}}catch(e){if((0,l.D_)(e))throw e;throw new s.Z("mapimagelayer:image-fetch-error",`Unable to load image: ${c}`,{error:e})}}async _fetchService(e){if(this.sourceJSON)return void this.read(this.sourceJSON,{origin:"service",url:this.parsedUrl});const{data:t,ssl:i}=await(0,o.Z)(this.parsedUrl.path,{query:{f:"json",...this.parsedUrl.query,...this.customParameters,token:this.apiKey},signal:e});i&&(this.url=this.url.replace(/^http:/i,"https:")),this.sourceJSON=t,this.read(t,{origin:"service",url:this.parsedUrl})}hasVisibleLayersForOrigin(e){return!(null==e||!this.sublayersSourceJSON[e]?.visibleLayers)}};(0,n._)([(0,c.Cb)((0,F.mi)("dateFieldsTimeReference"))],z.prototype,"dateFieldsTimeZone",void 0),(0,n._)([(0,c.Cb)({type:Boolean})],z.prototype,"datesInUnknownTimezone",void 0),(0,n._)([(0,c.Cb)()],z.prototype,"dpi",void 0),(0,n._)([(0,c.Cb)()],z.prototype,"elevationInfo",void 0),(0,n._)([(0,c.Cb)()],z.prototype,"gdbVersion",void 0),(0,n._)([(0,c.Cb)()],z.prototype,"imageFormat",void 0),(0,n._)([(0,u.r)("imageFormat",["supportedImageFormatTypes"])],z.prototype,"readImageFormat",null),(0,n._)([(0,c.Cb)({json:{origins:{service:{read:{source:"maxImageHeight"}}}}})],z.prototype,"imageMaxHeight",void 0),(0,n._)([(0,c.Cb)({json:{origins:{service:{read:{source:"maxImageWidth"}}}}})],z.prototype,"imageMaxWidth",void 0),(0,n._)([(0,c.Cb)()],z.prototype,"imageTransparency",void 0),(0,n._)([(0,c.Cb)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],z.prototype,"isReference",void 0),(0,n._)([(0,c.Cb)({json:{read:!1,write:!1}})],z.prototype,"labelsVisible",void 0),(0,n._)([(0,c.Cb)({type:["ArcGISMapServiceLayer"]})],z.prototype,"operationalLayerType",void 0),(0,n._)([(0,c.Cb)({json:{read:!1,write:!1}})],z.prototype,"popupEnabled",void 0),(0,n._)([(0,c.Cb)((0,F.mi)("preferredTimeReference"))],z.prototype,"preferredTimeZone",void 0),(0,n._)([(0,c.Cb)()],z.prototype,"sourceJSON",void 0),(0,n._)([(0,c.Cb)({json:{write:{ignoreOrigin:!0}}})],z.prototype,"sublayers",void 0),(0,n._)([(0,p.c)("sublayers",{layers:{type:[A.Z]},visibleLayers:{type:[d.z8]}})],z.prototype,"writeSublayers",null),(0,n._)([(0,c.Cb)({type:["show","hide","hide-children"],json:{origins:{"portal-item":{read:!1,write:!1}}}})],z.prototype,"listMode",void 0),(0,n._)([(0,c.Cb)({json:{read:!1},readOnly:!0,value:"map-image"})],z.prototype,"type",void 0),(0,n._)([(0,c.Cb)(I.HQ)],z.prototype,"url",void 0),z=(0,n._)([(0,h.j)("esri.layers.MapImageLayer")],z);const Z=z},59958:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return H}});var n=i(73440),o=i(43254),s=i(88194),r=i(96711),a=i(84060),l=i(93568),c=i(17155),d=i(90775),u=(i(61432),i(83850),i(1194)),h=i(48023),p=i(29884),y=i(66951),g=i(38209),m=i(83263),f=i(85330),v=i(27202),b=i(3752),_=i(41615),w=i(96928),C=i(41145),x=i(87833),S=i(97006),E=i(76329),k=i(90403),L=i(71354),T=i(13132),M=i(45213),I=i(47566),O=i(60680),P=i(8554),A=i(70677),R=i(38937),D=i(77271),$=i(67118);const N={key:"type",defaultKeyValue:"image",base:R.Z,typeMap:{image:w.Z,video:$.Z}},F=o.Z.ofType(N);let V=class extends(S.Z.LoadableMixin(E.Z.EsriPromiseMixin(x.Z.EventedAccessor))){constructor(e){super(e),this._index=new A.H,this._elementViewsMap=new Map,this._elementsIndexes=new Map,this._elementsChangedHandler=e=>{for(const t of e.removed){const e=this._elementViewsMap.get(t);this._elementViewsMap.delete(t),this._index.delete(e),this.removeHandles(e),e.destroy(),this.notifyChange("fullExtent")}const{spatialReference:t}=this;for(const i of e.added){if(this._elementViewsMap.get(i))continue;const e=new D.L({spatialReference:t,element:i});this._elementViewsMap.set(i,e);const n=(0,k.YP)((()=>e.coords),(()=>this._updateIndexForElement(e,!1)));this._updateIndexForElement(e,!0),this.addHandles(n,e)}this._elementsIndexes.clear(),this.elements.forEach(((e,t)=>this._elementsIndexes.set(e,t))),this.emit("refresh")},this.elements=new F}async load(e){if((0,l.k_)(e),!this.spatialReference){const e=this.elements.find((e=>null!=e.georeference?.coords));this._set("spatialReference",e?e.georeference.coords.spatialReference:M.Z.WGS84)}return this._elementsChangedHandler({added:this.elements.items,removed:[]}),this.addHandles(this.elements.on("change",this._elementsChangedHandler)),this}destroy(){this._index.clear(),this._elementViewsMap.clear(),this._elementsIndexes.clear()}set elements(e){this._set("elements",(0,C.Z)(e,this._get("elements"),F))}get fullExtent(){if("not-loaded"===this.loadStatus)return null;const e=this._index.fullBounds;return null==e?null:new L.Z({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:this.spatialReference})}set spatialReference(e){"not-loaded"===this.loadStatus?this._set("spatialReference",e):r.Z.getLogger(this).error("#spatialReference","spatialReference cannot be changed after the source is loaded.")}async queryElements(e,t){await this.load(),await(0,T.initializeProjection)(e.spatialReference,this.spatialReference,null,t);const i=(0,P.fS)(e.spatialReference,this.spatialReference)?e:(0,T.project)(e,this.spatialReference);if(!i)return[];const n=i.normalize(),o=[];for(const e of n)this._index.forEachInBounds((0,I.oJ)(e),(({normalizedCoords:t,element:i})=>{null!=t&&(0,O.Nl)(e,t)&&o.push(i)}));return o.sort(((e,t)=>this._elementsIndexes.get(e)-this._elementsIndexes.get(t))),o}hasElement(e){return this.elements.includes(e)}_updateIndexForElement(e,t){const i=e.normalizedBounds,n=this._index.has(e),o=null!=i;this._index.delete(e),o&&this._index.set(e,i),this.notifyChange("fullExtent"),t||(n!==o?this.emit("refresh"):this.emit("change",{element:e.element}))}};(0,n._)([(0,c.Cb)()],V.prototype,"elements",null),(0,n._)([(0,c.Cb)({readOnly:!0})],V.prototype,"fullExtent",null),(0,n._)([(0,c.Cb)()],V.prototype,"spatialReference",null),V=(0,n._)([(0,h.j)("esri.layers.support.LocalMediaElementSource")],V);var z=i(70924),Z=i(27353),B=i(3651);let U=class extends((0,m.h7)((0,b.M)((0,f.q)((0,v.I)((0,a.R)(g.Z)))))){constructor(e){super(e),this.effectiveSource=null,this.georeference=null,this.copyright=null,this.operationalLayerType="MediaLayer",this.spatialReference=null,this.type="media",this._debouncedSaveOperations=(0,l.Ds)((async(e,t,n)=>{const{save:o,saveAs:s}=await i.e(83558).then(i.bind(i,83558));switch(e){case B.x.SAVE:return o(this,t);case B.x.SAVE_AS:return s(this,n,t)}})),this.source=new V}load(e){return this.addResolvingPromise(this._doLoad(e)),Promise.resolve(this)}async _doLoad(e){await this.loadFromPortal({supportedTypes:["Media Layer"]},e);let t=this.source;if(!t)throw new s.Z("media-layer:source-missing","Set 'MediaLayer.source' before loading the layer.");const i=this._getSourceOverride(t,this.georeference);i&&(this.setAtOrigin("source",i,"web-map"),this.setAtOrigin("source",i,"web-scene"),t=i);const n=(0,Z.OG)(t)?new V({elements:new o.Z([t])}):t;this._set("effectiveSource",n),this.spatialReference&&(n.spatialReference=this.spatialReference),await n.load(e),this.spatialReference=n.spatialReference}destroy(){this.effectiveSource?.destroy(),this.effectiveSource!==this.source&&this.source?.destroy()}readGeoreference(e,t){return e&&"itemId"in t&&t.itemId?e:void 0}get fullExtent(){return this.loaded?this.effectiveSource.fullExtent:null}get source(){return this._get("source")}set source(e){"loaded"!==this.loadStatus&&"failed"!==this.loadStatus?this._set("source",e):r.Z.getLogger(this).error("#source","source cannot be changed after the layer is loaded.")}castSource(e){return e?Array.isArray(e)?new V({elements:new o.Z(e)}):e instanceof o.Z?new V({elements:e}):e:null}readSource(e,t,i){if("itemId"in t&&t.itemId)return;const n=this._createSource(t);return n?.read(t,i),n}writeSource(e,t,i,n){if(e&&e instanceof V){const t=e.elements.length;if(1!==t)return void(n?.messages&&n.messages.push(new s.Z("media-layer:unsupported-source",`local media element source can only be persisted if it contains exactly one ImageElement, but it has ${t}.`)));e=e.elements.at(0)}(0,Z.OG)(e)?e.write(t,n):n?.messages&&(e?n.messages.push(new s.Z("media-layer:unsupported-source","only media elements of type 'ImageElement' or 'VideoElement' can be persisted")):n.messages.push(new s.Z("media-layer:unsupported-source","the media layer is missing a source")))}async save(e){return this._debouncedSaveOperations(B.x.SAVE,e)}async saveAs(e,t){return this._debouncedSaveOperations(B.x.SAVE_AS,t,e)}_createSource(e){if("mediaType"in e)switch(e.mediaType){case"image":return new w.Z;case"video":return new $.Z}return null}_getSourceOverride(e,t){if((0,Z.OG)(e)&&this.originIdOf("source")===y.s3.PORTAL_ITEM&&t&&(this.originIdOf("georeference")===y.s3.WEB_MAP||this.originIdOf("georeference")===y.s3.WEB_SCENE)){const i=e.toJSON(),n=this._createSource(i);return n.read({...i},{origin:"portal-item"}),n.read({georeference:t},{origin:"web-map"}),n.read({georeference:t},{origin:"web-scene"}),n}return null}};(0,n._)([(0,c.Cb)({readOnly:!0})],U.prototype,"effectiveSource",void 0),(0,n._)([(0,c.Cb)({readOnly:!0,json:{read:!1,write:!1,origins:{"web-document":{read:!0}}}})],U.prototype,"georeference",void 0),(0,n._)([(0,u.r)("web-document","georeference")],U.prototype,"readGeoreference",null),(0,n._)([(0,c.Cb)({type:String})],U.prototype,"copyright",void 0),(0,n._)([(0,c.Cb)({readOnly:!0})],U.prototype,"fullExtent",null),(0,n._)([(0,c.Cb)({type:["MediaLayer"]})],U.prototype,"operationalLayerType",void 0),(0,n._)([(0,c.Cb)({type:["show","hide"]})],U.prototype,"listMode",void 0),(0,n._)([(0,c.Cb)({nonNullable:!0,json:{write:{enabled:!0,allowNull:!1,target:{url:{type:String},mediaType:{type:["image","video"]},georeference:{type:_.Z}},overridePolicy(e,t,i){return{enabled:!0,allowNull:!1,ignoreOrigin:(0,z.fN)(this,i?.origin)&&(0,Z.OG)(e)&&!!e.georeference&&e.originIdOf("georeference")>y.s3.PORTAL_ITEM}}}}})],U.prototype,"source",null),(0,n._)([(0,d.p)("source")],U.prototype,"castSource",null),(0,n._)([(0,u.r)("source",["url"])],U.prototype,"readSource",null),(0,n._)([(0,p.c)("source")],U.prototype,"writeSource",null),(0,n._)([(0,c.Cb)()],U.prototype,"spatialReference",void 0),(0,n._)([(0,c.Cb)({readOnly:!0})],U.prototype,"type",void 0),U=(0,n._)([(0,h.j)("esri.layers.MediaLayer")],U);const H=U},59259:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return N}});var n,o=i(73440),s=i(78619),r=i(88194),a=i(332),l=i(84060),c=i(93568),d=i(95490),u=i(17155),h=i(90775),p=(i(61432),i(83850),i(1194)),y=i(48023),g=i(29884),m=i(45213),f=i(38209),v=i(38448),b=i(39272),_=i(34085),w=i(58560),C=i(83263),x=i(55591),S=i(85330),E=i(27202),k=i(19306),L=i(3752),T=i(70937),M=i(66619),I=i(93295),O=i(97349),P=i(38120),A=i(13689);const R=["Canvas/World_Dark_Gray_Base","Canvas/World_Dark_Gray_Reference","Canvas/World_Light_Gray_Base","Canvas/World_Light_Gray_Reference","Elevation/World_Hillshade","Elevation/World_Hillshade_Dark","Ocean/World_Ocean_Base","Ocean/World_Ocean_Reference","Ocean_Basemap","Reference/World_Boundaries_and_Places","Reference/World_Boundaries_and_Places_Alternate","Reference/World_Transportation","World_Imagery","World_Street_Map","World_Topo_Map"];let D=n=class extends((0,C.h7)((0,L.M)((0,T.x)((0,b.Z)((0,_.O)((0,S.q)((0,E.I)((0,w.Y)((0,l.R)((0,k.Q)((0,v.V)((0,x.N)(f.Z))))))))))))){constructor(...e){super(...e),this.listMode="show",this.elevationInfo=new A.Z({mode:"on-the-ground"}),this.isReference=null,this.operationalLayerType="ArcGISTiledMapServiceLayer",this.resampling=!0,this.sourceJSON=null,this.spatialReference=null,this.path=null,this.sublayers=null,this.type="tile",this.url=null}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}load(e){const t=null!=e?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},e).catch(c.r9).then((()=>this._fetchService(t)))),Promise.resolve(this)}get attributionDataUrl(){const e=this.parsedUrl?.path.toLowerCase();return e?this._getDefaultAttribution(this._getMapName(e)):null}readSpatialReference(e,t){return(e=e||t.tileInfo?.spatialReference)&&m.Z.fromJSON(e)}writeSublayers(e,t,i,n){if(!this.loaded||!e)return;const o=e.slice().reverse().flatten((({sublayers:e})=>e&&e.toArray().reverse())).toArray(),s=[],r={writeSublayerStructure:!1,...n};o.forEach((e=>{const t=e.write({},r);s.push(t)})),s.some((e=>Object.keys(e).length>1))&&(t.layers=s)}get tileServers(){return this._getDefaultTileServers(this.parsedUrl?.path)}castTileServers(e){return Array.isArray(e)?e.map((e=>(0,d.mN)(e).path)):null}fetchTile(e,t,i,n={}){const{signal:o}=n,r=this.getTileUrl(e,t,i),a={responseType:"image",signal:o,query:{...this.refreshParameters}};return(0,s.Z)(r,a).then((e=>e.data))}async fetchImageBitmapTile(e,t,i,o={}){const{signal:r}=o;if(this.fetchTile!==n.prototype.fetchTile){const n=await this.fetchTile(e,t,i,o);return(0,O.V)(n,e,t,i,r)}const a=this.getTileUrl(e,t,i),l={responseType:"blob",signal:r,query:{...this.refreshParameters}},{data:c}=await(0,s.Z)(a,l);return(0,O.V)(c,e,t,i,r)}getTileUrl(e,t,i){const n=!this.capabilities.operations.supportsTileMap&&this.supportsBlankTile,o=(0,d.B7)({...this.parsedUrl?.query,blankTile:!n&&null,...this.customParameters,token:this.apiKey}),s=this.tileServers;return`${s&&s.length?s[t%s.length]:this.parsedUrl?.path}/tile/${e}/${t}/${i}${o?"?"+o:""}`}loadAll(){return(0,a.G)(this,(e=>{e(this.allSublayers)}))}_fetchService(e){return new Promise(((t,i)=>{if(this.sourceJSON){if(null!=this.sourceJSON.bandCount&&null!=this.sourceJSON.pixelSizeX)throw new r.Z("tile-layer:unsupported-url","use ImageryTileLayer to open a tiled image service");return void t({data:this.sourceJSON})}if(!this.parsedUrl)throw new r.Z("tile-layer:undefined-url","layer's url is not defined");const n=(0,M.Qc)(this.parsedUrl.path);if(null!=n&&"ImageServer"===n.serverType)throw new r.Z("tile-layer:unsupported-url","use ImageryTileLayer to open a tiled image service");(0,s.Z)(this.parsedUrl.path,{query:{f:"json",...this.parsedUrl.query,...this.customParameters,token:this.apiKey},responseType:"json",signal:e}).then(t,i)})).then((t=>{let i=this.url;if(t.ssl&&(i=this.url=i.replace(/^http:/i,"https:")),this.sourceJSON=t.data,this.read(t.data,{origin:"service",url:this.parsedUrl}),10.1===this.version&&!(0,M.M8)(i))return this._fetchServerVersion(i,e).then((e=>{this.read({currentVersion:e})})).catch((()=>{}))}))}_fetchServerVersion(e,t){if(!(0,M.B5)(e))return Promise.reject();const i=e.replace(/(.*\/rest)\/.*/i,"$1")+"/info";return(0,s.Z)(i,{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:t}).then((e=>{if(e.data?.currentVersion)return e.data.currentVersion;throw new r.Z("tile-layer:version-not-available","Server did not provide a version")}))}_getMapName(e){const t=e.match(/^(?:https?:)?\/\/(server\.arcgisonline\.com|services\.arcgisonline\.com|ibasemaps-api\.arcgis\.com)\/arcgis\/rest\/services\/([^/]+(\/[^/]+)*)\/mapserver/i);return t?t[2]:void 0}_getDefaultAttribution(e){if(null==e)return null;let t;e=e.toLowerCase();for(let i=0,n=R.length;i<n;i++)if(t=R[i],t.toLowerCase().includes(e))return(0,d.hF)("//static.arcgis.com/attribution/"+t);return null}_getDefaultTileServers(e){if(null==e)return[];const t=-1!==e.search(/^(?:https?:)?\/\/server\.arcgisonline\.com/i),i=-1!==e.search(/^(?:https?:)?\/\/services\.arcgisonline\.com/i);return t||i?[e,e.replace(t?/server\.arcgisonline/i:/services\.arcgisonline/i,t?"services.arcgisonline":"server.arcgisonline")]:[]}get hasOverriddenFetchTile(){return!this.fetchTile[$]}};(0,o._)([(0,u.Cb)({readOnly:!0})],D.prototype,"attributionDataUrl",null),(0,o._)([(0,u.Cb)({type:["show","hide","hide-children"]})],D.prototype,"listMode",void 0),(0,o._)([(0,u.Cb)({json:{read:!0,write:!0}})],D.prototype,"blendMode",void 0),(0,o._)([(0,u.Cb)()],D.prototype,"elevationInfo",void 0),(0,o._)([(0,u.Cb)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],D.prototype,"isReference",void 0),(0,o._)([(0,u.Cb)({readOnly:!0,type:["ArcGISTiledMapServiceLayer"]})],D.prototype,"operationalLayerType",void 0),(0,o._)([(0,u.Cb)({type:Boolean})],D.prototype,"resampling",void 0),(0,o._)([(0,u.Cb)()],D.prototype,"sourceJSON",void 0),(0,o._)([(0,u.Cb)({type:m.Z})],D.prototype,"spatialReference",void 0),(0,o._)([(0,p.r)("spatialReference",["spatialReference","tileInfo"])],D.prototype,"readSpatialReference",null),(0,o._)([(0,u.Cb)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],D.prototype,"path",void 0),(0,o._)([(0,u.Cb)({readOnly:!0})],D.prototype,"sublayers",void 0),(0,o._)([(0,g.c)("sublayers",{layers:{type:[P.Z]}})],D.prototype,"writeSublayers",null),(0,o._)([(0,u.Cb)({json:{read:!1,write:!1}})],D.prototype,"popupEnabled",void 0),(0,o._)([(0,u.Cb)()],D.prototype,"tileServers",null),(0,o._)([(0,h.p)("tileServers")],D.prototype,"castTileServers",null),(0,o._)([(0,u.Cb)({readOnly:!0,json:{read:!1}})],D.prototype,"type",void 0),(0,o._)([(0,u.Cb)(I.HQ)],D.prototype,"url",void 0),D=n=(0,o._)([(0,y.j)("esri.layers.TileLayer")],D);const $=Symbol("default-fetch-tile");D.prototype.fetchTile[$]=!0;const N=D},80379:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return ae}});var n=i(73440),o=i(78619),s=i(29292),r=i(88194),a=i(28947),l=i(84060),c=i(93568),d=i(95490),u=i(17155),h=(i(61432),i(96711)),p=i(1194),y=i(48023),g=i(29884),m=i(71354),f=i(45213),v=i(38209),b=i(38448),_=i(39272),w=i(58560),C=i(83263),x=i(55591),S=i(85330),E=i(27202),k=i(19306),L=i(3752);let T=null;var M=i(59384);class I{constructor(e,t){this._spriteSource=e,this._maxTextureSize=t,this.devicePixelRatio=1,this._spriteImageFormat="png",this._isRetina=!1,this._spritesData={},this.image=null,this.width=null,this.height=null,this.loadStatus="not-loaded","url"===e.type&&e.spriteFormat&&(this._spriteImageFormat=e.spriteFormat),e.pixelRatio&&(this.devicePixelRatio=e.pixelRatio),this.baseURL=e.spriteUrl}get spriteNames(){const e=[];for(const t in this._spritesData)e.push(t);return e.sort(),e}getSpriteInfo(e){return this._spritesData?this._spritesData[e]:null}async load(e){if(this.baseURL){this.loadStatus="loading";try{await this._loadSprites(e),this.loadStatus="loaded"}catch{this.loadStatus="failed"}}else this.loadStatus="failed"}async _loadSprites(e){this._isRetina=this.devicePixelRatio>1.15;const{width:t,height:i,data:n,json:o}=await this._getSpriteData(this._spriteSource,e),s=Object.keys(o);if(!s||0===s.length||!n)return this._spritesData=this.image=null,void(this.width=this.height=0);this._spritesData=o,this.width=t,this.height=i;const a=Math.max(this._maxTextureSize,4096);if(t>a||i>a){const e=`Sprite resource for style ${this.baseURL} is bigger than the maximum allowed of ${a} pixels}`;throw h.Z.getLogger("esri.layers.support.SpriteSource").error(e),new r.Z("SpriteSource",e)}let l;for(let e=0;e<n.length;e+=4)l=n[e+3]/255,n[e]=n[e]*l,n[e+1]=n[e+1]*l,n[e+2]=n[e+2]*l;this.image=n}async _getSpriteData(e,t){if("image"===e.type){let t,i;if(this.devicePixelRatio<1.15){if(!e.spriteSource1x)throw new r.Z("SpriteSource","no image data provided for low resolution sprites!");t=e.spriteSource1x.image,i=e.spriteSource1x.json}else{if(!e.spriteSource2x)throw new r.Z("SpriteSource","no image data provided for high resolution sprites!");t=e.spriteSource2x.image,i=e.spriteSource2x.json}return"width"in t&&"height"in t&&"data"in t&&((0,M.eP)(t.data)||(0,M.KZ)(t.data))?{width:t.width,height:t.height,data:new Uint8Array(t.data),json:i}:{...O(t),json:i}}const i=(0,d.mN)(this.baseURL),n=i.query?"?"+(0,d.B7)(i.query):"",s=this._isRetina?"@2x":"",a=`${i.path}${s}.${this._spriteImageFormat}${n}`,l=`${i.path}${s}.json${n}`,[c,u]=await Promise.all([(0,o.Z)(l,t),(0,o.Z)(a,{responseType:"image",...t})]);return{...O(u.data),json:c.data}}}function O(e){const t=document.createElement("canvas"),i=t.getContext("2d");t.width=e.width,t.height=e.height,i.drawImage(e,0,0,e.width,e.height);const n=i.getImageData(0,0,e.width,e.height);return{width:e.width,height:e.height,data:new Uint8Array(n.data)}}var P=i(97550),A=i(8682),R=i(8554),D=i(97290),$=i(64544);class N{constructor(e){this.url=e}destroy(){this._tileIndexPromise=null}async fetchTileIndex(){return this._tileIndexPromise||(this._tileIndexPromise=(0,o.Z)(this.url).then((e=>e.data.index))),this._tileIndexPromise}async dataKey(e,t){const i=await this.fetchTileIndex();return(0,c.k_)(t),this._getIndexedDataKey(i,e)}_getIndexedDataKey(e,t){const i=[t];if(t.level<0||t.row<0||t.col<0||t.row>>t.level>0||t.col>>t.level>0)return null;let n=t;for(;0!==n.level;)n=new $.Z(n.level-1,n.row>>1,n.col>>1,n.world),i.push(n);let o,s,r=e,a=i.pop();if(1===r)return a;for(;i.length;)if(o=i.pop(),s=(1&o.col)+((1&o.row)<<1),r){if(0===r[s]){a=null;break}if(1===r[s]){a=o;break}a=o,r=r[s]}return a}}var F=i(61100);class V{constructor(e,t){this._tilemap=e,this._tileIndexUrl=t}destroy(){this._tilemap=(0,F.SC)(this._tilemap),this._tileIndexPromise=null}async fetchTileIndex(e){return this._tileIndexPromise||(this._tileIndexPromise=(0,o.Z)(this._tileIndexUrl,{query:{...e?.query}}).then((e=>e.data.index))),this._tileIndexPromise}dataKey(e,t){const{level:i,row:n,col:o}=e,s=new $.Z(e);return this._tilemap.fetchAvailabilityUpsample(i,n,o,s,t).then((()=>(s.world=e.world,s))).catch((e=>{if((0,c.D_)(e))throw e;return null}))}}var z=i(79577);class Z{constructor(e){this._tileUrl=e,this._promise=null,this._abortController=null,this._abortOptions=[]}getData(e){(null==this._promise||(0,c.Hc)(this._abortController?.signal))&&(this._promise=this._makeRequest(this._tileUrl));const t=this._abortOptions;return t.push(e),(0,c.fu)(e,(()=>{t.every((e=>(0,c.Hc)(e)))&&this._abortController.abort()})),this._promise.then((e=>(0,a.d9)(e)))}async _makeRequest(e){this._abortController=new AbortController;const{data:t}=await(0,o.Z)(e,{responseType:"array-buffer",signal:this._abortController.signal});return t}}const B=new Map;function U(e,t){return(0,z.s1)(B,e,(()=>new Z(e))).getData(t).finally((()=>B.delete(e)))}class H{constructor(e,t,i){this.tilemap=null,this.tileInfo=null,this.capabilities=null,this.fullExtent=null,this.initialExtent=null,this.name=e,this.sourceUrl=t;const n=(0,d.mN)(this.sourceUrl),o=(0,a.d9)(i),s=o.tiles;if(n)for(let e=0;e<s.length;e++){const t=(0,d.mN)(s[e]);t&&((0,d.YP)(t.path)||(t.path=(0,d.v_)(n.path,t.path)),s[e]=(0,d.fl)(t.path,{...n.query,...t.query}))}this.tileServers=s;const r=i.capabilities&&i.capabilities.split(",").map((e=>e.toLowerCase().trim())),l=!0===i?.exportTilesAllowed,c=!0===r?.includes("tilemap"),u=l&&i.hasOwnProperty("maxExportTilesCount")?i.maxExportTilesCount:0;this.capabilities={operations:{supportsExportTiles:l,supportsTileMap:c},exportTiles:l?{maxExportTilesCount:+u}:null},this.tileInfo=P.Z.fromJSON(o.tileInfo);const h=i.tileMap?(0,d.fl)((0,d.v_)(n.path,i.tileMap),n.query??{}):null;c?(this.type="vector-tile",this.tilemap=new V(new A.y({layer:{parsedUrl:n,tileInfo:this.tileInfo},minLOD:o.minLOD??this.tileInfo.lods[0].level,maxLOD:o.maxLOD??this.tileInfo.lods[this.tileInfo.lods.length-1].level}),h)):h&&(this.tilemap=new N(h)),this.fullExtent=m.Z.fromJSON(i.fullExtent),this.initialExtent=m.Z.fromJSON(i.initialExtent)}destroy(){this.tilemap?.destroy()}async getRefKey(e,t){return this.tilemap?this.tilemap.dataKey(e,t):e}requestTile(e,t,i,n){return function(e,t,i,n,o){const s=(0,d.mN)(e),r=s.query;if(r)for(const[e,o]of Object.entries(r))switch(o){case"{x}":r[e]=n.toString();break;case"{y}":r[e]=i.toString();break;case"{z}":r[e]=t.toString()}const a=s.path;return U((0,d.fl)(a.replaceAll(/\{z\}/gi,t.toString()).replaceAll(/\{y\}/gi,i.toString()).replaceAll(/\{x\}/gi,n.toString()),{...s.query}),o)}(this.tileServers[t%this.tileServers.length],e,t,i,n)}isCompatibleWith(e){const t=this.tileInfo,i=e.tileInfo;if(!t.spatialReference.equals(i.spatialReference))return!1;if(!t.origin.equals(i.origin))return!1;if(Math.round(t.dpi)!==Math.round(i.dpi))return!1;const n=t.lods,o=i.lods,s=Math.min(n.length,o.length);for(let e=0;e<s;e++){const t=n[e],i=o[e];if(t.level!==i.level||Math.round(t.scale)!==Math.round(i.scale))return!1}return!0}}function G(...e){let t;for(const i of e)if(null!=i)if((0,d.oC)(i)){if(t){const e=t.split("://")[0];t=e+":"+i.trim()}}else t=(0,d.YP)(i)?i:(0,d.v_)(t,i);return t?(0,d.Qj)(t):void 0}async function j(e,t,i,n,s){let r,a,l;if((0,c.k_)(s),"string"==typeof i){const e=(0,d.Fv)(i);l=await(0,o.Z)(e,{...s,responseType:"json",query:{f:"json",...s?.query}}),l.ssl&&(r&&(r=r.replace(/^http:/i,"https:")),a&&(a=a.replace(/^http:/i,"https:"))),r=e,a=e}else null!=i&&(l={data:i},r=i.jsonUrl||null,a=n);const u=l?.data;if(W(u))return e.styleUrl=r||null,async function(e,t,i,n){const o=i?(0,d.Yd)(i):(0,d.L)();e.styleBase=o,e.style=t,t["sprite-format"]&&"webp"===t["sprite-format"].toLowerCase()&&(e.spriteFormat="webp");const s=[];if(t.sources&&t.sources.esri){const i=t.sources.esri;i.url?await j(e,"esri",G(o,i.url),void 0,n):s.push(j(e,"esri",i,o,n))}for(const i of Object.keys(t.sources))"esri"!==i&&"vector"===t.sources[i].type&&(t.sources[i].url?s.push(j(e,i,G(o,t.sources[i].url),void 0,n)):t.sources[i].tiles&&s.push(j(e,i,t.sources[i],o,n)));await Promise.all(s)}(e,u,a,s);if(function(e){return!W(e)}(u))return e.sourceUrl?Y(e,u,a,!1,t,s):(e.sourceUrl=r||null,Y(e,u,a,!0,t,s));throw new Error("You must specify the URL or the JSON for a service or for a style.")}function K(e){return"object"==typeof e&&!!e&&"tilejson"in e&&null!=e.tilejson}function W(e){return!!e&&"sources"in e&&!!e.sources}async function Y(e,t,i,n,o,s){const r=i?(0,d.Qj)(i)+"/":(0,d.L)(),l=function(e){const t=512;if(function(e){return e.hasOwnProperty("tileInfo")}(e)){const i=e?.tileInfo;return null!=i&&(null==i.rows&&(i.rows=t),null==i.cols&&(i.cols=t)),e}const i={xmin:-20037507.067161843,ymin:-20037507.067161843,xmax:20037507.067161843,ymax:20037507.067161843,spatialReference:{wkid:102100,latestWkid:3857}};let n=null;if(K(e)){const{bounds:t}=e;if(t){const e=(0,D.$)({x:t[0],y:t[1],spatialReference:(0,a.d9)(R.YU)}),i=(0,D.$)({x:t[2],y:t[3],spatialReference:(0,a.d9)(R.YU)});n={xmin:e.x,ymin:e.y,xmax:i.x,ymax:i.y,spatialReference:(0,a.d9)(R.IU)}}}null===n&&(n=i);let o=78271.51696400007,s=295828763.7957775;const r=[],l=e.hasOwnProperty("maxzoom")&&null!=e.maxzoom?+e.maxzoom:22,c=0,d=0;for(let e=0;e<=l;e++)r.push({level:e,scale:s,resolution:o}),o/=2,s/=2;return{capabilities:"TilesOnly",initialExtent:n,fullExtent:i,minScale:c,maxScale:d,tiles:e.tiles,tileInfo:{rows:t,cols:t,dpi:96,format:"pbf",origin:{x:-20037508.342787,y:20037508.342787},lods:r,spatialReference:(0,a.d9)(R.IU)}}}(t),c=new H(o,(0,d.fl)(r,s?.query??{}),l);if(!n&&e.primarySourceName in e.sourceNameToSource){const t=e.sourceNameToSource[e.primarySourceName];if(!t.isCompatibleWith(c))return;null!=c.fullExtent&&(null!=t.fullExtent?t.fullExtent.union(c.fullExtent):t.fullExtent=c.fullExtent.clone()),t.tileInfo&&c.tileInfo&&t.tileInfo.lods.length<c.tileInfo.lods.length&&(t.tileInfo=c.tileInfo)}if(n&&(e.sourceBase=r,e.source=t,e.validatedSource=l,e.primarySourceName=o),e.sourceNameToSource[o]=c,!K(e)&&"defaultStyles"in t&&!e.style){if(null==t.defaultStyles)throw new Error;return"string"==typeof t.defaultStyles?j(e,"",G(r,t.defaultStyles,"root.json"),void 0,s):j(e,"",t.defaultStyles,G(r,"root.json"),s)}}var q=i(39438),X=i(40182),J=i(28938),Q=i(60508),ee=i(45107);const te=1e-6;function ie(e,t){if(e===t)return!0;if(null==e&&null!=t)return!1;if(null!=e&&null==t)return!1;if(null==e||null==t)return!1;if(!e.spatialReference.equals(t.spatialReference)||e.dpi!==t.dpi)return!1;const i=e.origin,n=t.origin;if(Math.abs(i.x-n.x)>=te||Math.abs(i.y-n.y)>=te)return!1;let o,s;e.lods[0].scale>t.lods[0].scale?(o=e,s=t):(s=e,o=t);for(let e=o.lods[0].scale;e>=s.lods[s.lods.length-1].scale-te;e/=2)if(Math.abs(e-s.lods[0].scale)<te)return!0;return!1}function ne(e,t){if(e===t)return e;if(null==e&&null!=t)return t;if(null!=e&&null==t)return e;if(null==e||null==t)return null;const i=e.size[0],n=e.format,o=e.dpi,s=new Q.Z({x:e.origin.x,y:e.origin.y}),r=e.spatialReference,a=e.lods[0].scale>t.lods[0].scale?e.lods[0]:t.lods[0],l=e.lods[e.lods.length-1].scale<=t.lods[t.lods.length-1].scale?e.lods[e.lods.length-1]:t.lods[t.lods.length-1],c=a.scale,d=a.resolution,u=l.scale,h=[];let p=c,y=d,g=0;for(;p>=u;)h.push(new ee.Z({level:g,resolution:y,scale:p})),g++,p/=2,y/=2;return new P.Z({size:[i,i],dpi:o,format:n||"pbf",origin:s,lods:h,spatialReference:r})}var oe=i(89693),se=i(33776);let re=class extends((0,C.h7)((0,L.M)((0,k.Q)((0,_.Z)((0,w.Y)((0,S.q)((0,E.I)((0,x.N)((0,b.V)((0,l.R)(v.Z))))))))))){constructor(...e){super(...e),this._spriteSourceMap=new Map,this.currentStyleInfo=null,this.isReference=null,this.operationalLayerType="VectorTileLayer",this.path=null,this.refreshInterval=0,this.style=null,this.tilemapCache=null,this.type="vector-tile",this.url=null}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}destroy(){if(this.sourceNameToSource)for(const e of Object.values(this.sourceNameToSource))e?.destroy();this.primarySource?.destroy(),this._spriteSourceMap.clear()}async prefetchResources(e){await this.loadSpriteSource(globalThis.devicePixelRatio||1,e)}load(e){const t=this.loadFromPortal({supportedTypes:["Vector Tile Service"],supportsData:!1},e).catch(c.r9).then((async()=>{if(!this.portalItem?.id)return;const t=`${this.portalItem.itemCdnUrl}/resources/styles/root.json`;(await(0,o.Z)(t,{...e,query:{f:"json",...this.customParameters,token:this.apiKey},authMode:this.portalItem.portal.authMode})).data&&this.read({url:t},(0,q.h)(this.portalItem,"portal-item"))})).catch(c.r9).then((()=>this._loadStyle(e)));return this.addResolvingPromise(t),Promise.resolve(this)}get attributionDataUrl(){const e=this.currentStyleInfo,t=e?.serviceUrl&&(0,d.mN)(e.serviceUrl);if(!t)return null;const i=this._getDefaultAttribution(t.path);return i?(0,d.fl)(i,{...this.customParameters,token:this.apiKey}):null}get capabilities(){const e=this.primarySource;return e?e.capabilities:{operations:{supportsExportTiles:!1,supportsTileMap:!1},exportTiles:null}}get fullExtent(){return this.primarySource?.fullExtent||null}get initialExtent(){return this.primarySource?.initialExtent||null}get parsedUrl(){return this.serviceUrl?(0,d.mN)(this.serviceUrl):null}get serviceUrl(){return this.currentStyleInfo?.serviceUrl||null}get spatialReference(){return this.tileInfo?.spatialReference??null}get styleUrl(){return this.currentStyleInfo?.styleUrl||null}writeStyleUrl(e,t){e&&(0,d.oC)(e)&&(e=`https:${e}`);const i=(0,X.a5)(e);t.styleUrl=(0,J.e)(e,i)}get tileInfo(){const e=[];for(const t in this.sourceNameToSource)e.push(this.sourceNameToSource[t]);let t=this.primarySource?.tileInfo||new P.Z;if(e.length>1)for(let i=0;i<e.length;i++)ie(t,e[i].tileInfo)&&(t=ne(t,e[i].tileInfo));return t}readTilemapCache(e,t){const i=t.capabilities?.includes("Tilemap");return i?new A.y({layer:this}):null}readVersion(e,t){return t.version?parseFloat(t.version):parseFloat(t.currentVersion)}async loadSpriteSource(e=1,t){if(!this._spriteSourceMap.has(e)){const i=(0,se.h)().maxTextureSize,n=this.currentStyleInfo?.spriteUrl?(0,d.fl)(this.currentStyleInfo.spriteUrl,{...this.customParameters,token:this.apiKey}):null,o=new I({type:"url",spriteUrl:n,pixelRatio:e,spriteFormat:this.currentStyleInfo?.spriteFormat},i);await o.load(t),this._spriteSourceMap.set(e,o)}return this._spriteSourceMap.get(e)}async setSpriteSource(e,t){if(!e)return null;const i=(0,se.h)().maxTextureSize,n=e.spriteUrl,o=n?(0,d.fl)(n,{...this.customParameters,token:this.apiKey}):null;if(!o&&"url"===e.type)return null;const s=new I(e,i);try{await s.load(t);const i=e.pixelRatio||1;return this._spriteSourceMap.clear(),this._spriteSourceMap.set(i,s),o&&this.currentStyleInfo&&(this.currentStyleInfo.spriteUrl=o),this.emit("spriteSource-change",{spriteSource:s}),s}catch(e){(0,c.r9)(e)}return null}async loadStyle(e,t){const i=e||this.style||this.url;return this._loadingTask&&"string"==typeof i&&this.url===i||(this._loadingTask?.abort(),this._loadingTask=(0,s.vr)((e=>(this._spriteSourceMap.clear(),this._getSourceAndStyle(i,{signal:e}))),t)),this._loadingTask.promise}getStyleLayerId(e){return this.styleRepository.getStyleLayerId(e)}getStyleLayerIndex(e){return this.styleRepository.getStyleLayerIndex(e)}getPaintProperties(e){return(0,a.d9)(this.styleRepository?.getPaintProperties(e))}setPaintProperties(e,t){const i=this.styleRepository.isPainterDataDriven(e);this.styleRepository.setPaintProperties(e,t);const n=this.styleRepository.isPainterDataDriven(e);this.emit("paint-change",{layer:e,paint:t,isDataDriven:i||n})}getStyleLayer(e){return(0,a.d9)(this.styleRepository.getStyleLayer(e))}setStyleLayer(e,t){this.styleRepository.setStyleLayer(e,t),this.emit("style-layer-change",{layer:e,index:t})}deleteStyleLayer(e){this.styleRepository.deleteStyleLayer(e),this.emit("delete-style-layer",{layer:e})}getLayoutProperties(e){return(0,a.d9)(this.styleRepository.getLayoutProperties(e))}setLayoutProperties(e,t){this.styleRepository.setLayoutProperties(e,t),this.emit("layout-change",{layer:e,layout:t})}setStyleLayerVisibility(e,t){this.styleRepository.setStyleLayerVisibility(e,t),this.emit("style-layer-visibility-change",{layer:e,visibility:t})}getStyleLayerVisibility(e){return this.styleRepository.getStyleLayerVisibility(e)}write(e,t){return t?.origin&&!this.styleUrl?(t.messages&&t.messages.push(new r.Z("vectortilelayer:unsupported",`VectorTileLayer (${this.title}, ${this.id}) with style defined by JSON only are not supported`,{layer:this})),null):super.write(e,t)}getTileUrl(e,t,i){return null}async _getSourceAndStyle(e,t){if(!e)throw new Error("invalid style!");const i=await async function(e,t){const i={source:null,sourceBase:null,sourceUrl:null,validatedSource:null,style:null,styleBase:null,styleUrl:null,sourceNameToSource:{},primarySourceName:"",spriteFormat:"png"},[n,o]="string"==typeof e?[e,null]:[null,e.jsonUrl];return await j(i,"esri",e,o,t),{layerDefinition:i.validatedSource,url:n,serviceUrl:i.sourceUrl,style:i.style,styleUrl:i.styleUrl,spriteUrl:i.style.sprite&&G(i.styleBase,i.style.sprite),spriteFormat:i.spriteFormat,glyphsUrl:i.style.glyphs&&G(i.styleBase,i.style.glyphs),sourceNameToSource:i.sourceNameToSource,primarySourceName:i.primarySourceName}}(e,{...t,query:{...this.customParameters,token:this.apiKey}});"webp"===i.spriteFormat&&(await function(e){if(T)return T;const t={lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"};return T=new Promise((i=>{const n=new Image;n.onload=()=>{n.onload=n.onerror=null,i(n.width>0&&n.height>0)},n.onerror=()=>{n.onload=n.onerror=null,i(!1)},n.src="data:image/webp;base64,"+t[e]})),T}("lossy")||(i.spriteFormat="png")),this._set("currentStyleInfo",{...i}),"string"==typeof e?(this.url=e,this.style=null):(this.url=null,this.style=e),this._set("sourceNameToSource",i.sourceNameToSource),this._set("primarySource",i.sourceNameToSource[i.primarySourceName]),this._set("styleRepository",new oe.Z(i.style,!1)),this.read(i.layerDefinition,{origin:"service"}),this.emit("load-style")}_getDefaultAttribution(e){const t=e.match(/^https?:\/\/(?:basemaps|basemapsbeta|basemapsdev)(?:-api)?\.arcgis\.com(\/[^/]+)?\/arcgis\/rest\/services\/([^/]+(\/[^/]+)*)\/vectortileserver/i),i=["OpenBasemap_v2","OpenBasemap_GCS_v2","OpenStreetMap_v2","OpenStreetMap_Daylight_v2","OpenStreetMap_Export_v2","OpenStreetMap_FTS_v2","OpenStreetMap_GCS_v2","World_Basemap","World_Basemap_v2","World_Basemap_Export_v2","World_Basemap_GCS_v2","World_Basemap_WGS84","World_Contours_v2","World_Hillshade_v2"];if(!t)return;const n=t[2]&&t[2].toLowerCase();if(!n)return;const o=t[1]||"";for(const e of i)if(e.toLowerCase().includes(n))return(0,d.Fv)(`//static.arcgis.com/attribution/Vector${o}/${e}`)}async _loadStyle(e){return this._loadingTask?.promise??this.loadStyle(null,e)}};(0,n._)([(0,u.Cb)({readOnly:!0})],re.prototype,"attributionDataUrl",null),(0,n._)([(0,u.Cb)({type:["show","hide"]})],re.prototype,"listMode",void 0),(0,n._)([(0,u.Cb)({json:{read:!0,write:!0}})],re.prototype,"blendMode",void 0),(0,n._)([(0,u.Cb)({readOnly:!0,json:{read:!1}})],re.prototype,"capabilities",null),(0,n._)([(0,u.Cb)({readOnly:!0})],re.prototype,"currentStyleInfo",void 0),(0,n._)([(0,u.Cb)({json:{read:!1},readOnly:!0,type:m.Z})],re.prototype,"fullExtent",null),(0,n._)([(0,u.Cb)({json:{read:!1},readOnly:!0,type:m.Z})],re.prototype,"initialExtent",null),(0,n._)([(0,u.Cb)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],re.prototype,"isReference",void 0),(0,n._)([(0,u.Cb)({type:["VectorTileLayer"]})],re.prototype,"operationalLayerType",void 0),(0,n._)([(0,u.Cb)({readOnly:!0})],re.prototype,"parsedUrl",null),(0,n._)([(0,u.Cb)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],re.prototype,"path",void 0),(0,n._)([(0,u.Cb)({type:Number,json:{write:!1,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],re.prototype,"refreshInterval",void 0),(0,n._)([(0,u.Cb)()],re.prototype,"style",void 0),(0,n._)([(0,u.Cb)({readOnly:!0})],re.prototype,"serviceUrl",null),(0,n._)([(0,u.Cb)({type:f.Z,readOnly:!0})],re.prototype,"spatialReference",null),(0,n._)([(0,u.Cb)({readOnly:!0})],re.prototype,"styleRepository",void 0),(0,n._)([(0,u.Cb)({readOnly:!0})],re.prototype,"sourceNameToSource",void 0),(0,n._)([(0,u.Cb)({readOnly:!0})],re.prototype,"primarySource",void 0),(0,n._)([(0,u.Cb)({type:String,readOnly:!0,json:{write:{ignoreOrigin:!0},origins:{"web-document":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],re.prototype,"styleUrl",null),(0,n._)([(0,g.c)(["portal-item","web-document"],"styleUrl")],re.prototype,"writeStyleUrl",null),(0,n._)([(0,u.Cb)({json:{read:!1,origins:{service:{read:!1}}},readOnly:!0,type:P.Z})],re.prototype,"tileInfo",null),(0,n._)([(0,u.Cb)()],re.prototype,"tilemapCache",void 0),(0,n._)([(0,p.r)("service","tilemapCache",["capabilities","tileInfo"])],re.prototype,"readTilemapCache",null),(0,n._)([(0,u.Cb)({json:{read:!1},readOnly:!0,value:"vector-tile"})],re.prototype,"type",void 0),(0,n._)([(0,u.Cb)({json:{origins:{"web-document":{read:{source:"styleUrl"}},"portal-item":{read:{source:"url"}}},write:!1,read:!1}})],re.prototype,"url",void 0),(0,n._)([(0,u.Cb)({readOnly:!0})],re.prototype,"version",void 0),(0,n._)([(0,p.r)("version",["version","currentVersion"])],re.prototype,"readVersion",null),re=(0,n._)([(0,y.j)("esri.layers.VectorTileLayer")],re);const ae=re},70677:function(e,t,i){"use strict";i.d(t,{H:function(){return l}});var n=i(61432),o=i(96946),s=i(47566);const r={minX:0,minY:0,maxX:0,maxY:0};function a(e,t,i){(function(e){r.minX=e[0],r.minY=e[1],r.maxX=e[2],r.maxY=e[3]})(t),e.search(r,i)}class l{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new o.Q(9,(0,n.Z)("esri-csp-restrictions")?e=>({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const e=new Array(this._idByBounds.size);let t=0;this._idByBounds.forEach(((i,n)=>{e[t++]=n})),this._indexInvalid=!1,this._index.clear(),this._index.load(e)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter((e=>this._idByBounds.has(e)))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const e=(0,s.cS)();for(const t of this._boundsById.values())t&&(e[0]=Math.min(t[0],e[0]),e[1]=Math.min(t[1],e[1]),e[2]=Math.max(t[2],e[2]),e[3]=Math.max(t[3],e[3]));return e}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(e){const t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))}forEachInBounds(e,t){this._loadIndex(),a(this._index,e,(e=>t(this._idByBounds.get(e))))}get(e){return this._boundsById.get(e)}has(e){return this._boundsById.has(e)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(e,t){if(!this._indexInvalid){const t=this._boundsById.get(e);t&&(this._index.remove(t),this._idByBounds.delete(t))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},17749:function(e,t,i){"use strict";i.d(t,{e:function(){return o},g:function(){return n}});const n={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!0,supportsCurrentUser:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsPaginationOnAggregatedQueries:!1,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!0,supportsReturnMesh:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,maxUniqueIDCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0,supportsTrueCurve:!1},o={supportsDate:!0,supportsFixedInterval:!0,supportsAutoInterval:!0,supportsFixedBoundaries:!0,supportsStackBy:!0,supportsSplitBy:!0,supportsSnapToData:!1,supportsReturnFullIntervalBin:!1,supportsFirstDayOfWeek:!1,supportsNormalization:!0,supportedStatistics:{count:!0,sum:!0,avg:!0,var:!0,stddev:!0,min:!0,max:!0,percentileContinuous:!0,percentileDiscrete:!0,envelope:!0,centroid:!0,convexHull:!0},supportedNormalizationTypes:{field:!0,log:!0,naturalLog:!0,percentOfTotal:!0,squareRoot:!0}}},73967:function(e,t,i){"use strict";i.d(t,{Dm:function(){return d},Hq:function(){return h},MS:function(){return p},bU:function(){return a}});var n=i(61432),o=i(28947),s=i(17749),r=i(54914);function a(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?r.I4:"esriGeometryPolyline"===e?r.ET:r.lF}}}const l=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let c=1;function d(e,t){if((0,n.Z)("esri-csp-restrictions"))return()=>({[t]:null,...e});try{let i=`this${u(t)} = null;`;for(const t in e)i+=`this${u(t)} = ${JSON.stringify(e[t])};`;const n=new Function(`\n      return class AttributesClass$${c++} {\n        constructor() {\n          ${i};\n        }\n      }\n    `)();return()=>new n}catch(i){return()=>({[t]:null,...e})}}function u(e){return l.test(e)?`.${e}`:`["${e}"]`}function h(e={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,o.d9)(e)}}]}function p(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryBins:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:s.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryAttributeBins:s.e,editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},39272:function(e,t,i){"use strict";i.d(t,{Z:function(){return u}});var n=i(73440),o=i(17155),s=(i(61432),i(96711),i(83850),i(1194)),r=i(48023),a=i(45213),l=i(97550),c=i(94219),d=i(8682);const u=e=>{let t=class extends e{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}destroy(){this.tilemapCache?.destroy?.()}readMinScale(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}readMaxScale(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(e,t,i){const n=t.capabilities?.includes("Tilemap");let{minLOD:o,maxLOD:s,minScale:r,maxScale:a}=t;if(null==o&&null==s&&(0!==r||0!==a)){const e=e=>Math.round(1e4*e)/1e4;r=e(r||t.tileInfo.lods[0].scale),a=e(a||t.tileInfo.lods[t.tileInfo.lods.length-1].scale);for(const i of t.tileInfo.lods){const t=e(i.scale);o=t>=r?i.level:o,s=t>=a?i.level:s}}if(n)return new d.y({layer:this,minLOD:o,maxLOD:s});if(t.tileInfo){const e=new l.Z;return e.read(t.tileInfo,i),new c.Z(e,o,s)}return null}};return(0,n._)([(0,o.Cb)({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),(0,n._)([(0,o.Cb)()],t.prototype,"minScale",void 0),(0,n._)([(0,s.r)("service","minScale")],t.prototype,"readMinScale",null),(0,n._)([(0,o.Cb)()],t.prototype,"maxScale",void 0),(0,n._)([(0,s.r)("service","maxScale")],t.prototype,"readMaxScale",null),(0,n._)([(0,o.Cb)({type:a.Z})],t.prototype,"spatialReference",void 0),(0,n._)([(0,o.Cb)({readOnly:!0})],t.prototype,"supportsBlankTile",null),(0,n._)([(0,o.Cb)({type:l.Z})],t.prototype,"tileInfo",void 0),(0,n._)([(0,o.Cb)()],t.prototype,"tilemapCache",void 0),(0,n._)([(0,s.r)("service","tilemapCache",["capabilities","tileInfo"])],t.prototype,"readTilemapCache",null),(0,n._)([(0,o.Cb)()],t.prototype,"version",void 0),t=(0,n._)([(0,r.j)("esri.layers.mixins.ArcGISCachedService")],t),t}},33287:function(e,t,i){"use strict";i.d(t,{R:function(){return h}});var n=i(73440),o=i(70880),s=i(48797),r=i(17155),a=(i(61432),i(96711),i(83850),i(48023)),l=i(4469),c=i(44695),d=i(33285);const u={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};let h=class extends o.Z{constructor(e){super(e),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const e=this.visibleSublayers.map((e=>{const t=(0,c.f)(this.floors,e);return e.toExportImageJSON(t)}));return e.length?JSON.stringify(e):null}get hasDynamicLayers(){return this.layer&&(0,d.FN)(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(e){this._get("layer")!==e&&(this._set("layer",e),this.removeHandles("layer"),e&&this.addHandles([e.allSublayers.on("change",(()=>this.notifyChange("visibleSublayers"))),e.on("sublayer-update",(e=>this.notifyChange(u[e.propertyName])))],"layer"))}get layers(){const e=this.visibleSublayers;return e?e.length?"show:"+e.map((e=>e.id)).join(","):"show:-1":null}get layerDefs(){const e=!!this.floors?.length,t=this.visibleSublayers.filter((t=>null!=t.definitionExpression||e&&null!=t.floorInfo));return t.length?JSON.stringify(t.reduce(((e,t)=>{const i=(0,c.f)(this.floors,t),n=(0,s._$)(i,t.definitionExpression);return null!=n&&(e[t.id]=n),e}),{})):null}get version(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers");const e=this.layer;return e&&(e.commitProperty("dpi"),e.commitProperty("imageFormat"),e.commitProperty("imageTransparency"),e.commitProperty("gdbVersion")),(this._get("version")||0)+1}get visibleSublayers(){const e=[];if(!this.layer)return e;const t=this.layer.sublayers,i=this.scale,n=t=>{t.visible&&(0===i||(0,l.o2)(i,t.minScale,t.maxScale))&&(t.sublayers?t.sublayers.forEach(n):e.unshift(t))};t&&t.forEach(n);const o=this._get("visibleSublayers");return!o||o.length!==e.length||o.some(((t,i)=>e[i]!==t))?e:o}toJSON(){const e=this.layer;let t={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?t.dynamicLayers=this.dynamicLayers:t={...t,layers:this.layers,layerDefs:this.layerDefs},t}};(0,n._)([(0,r.Cb)({readOnly:!0})],h.prototype,"dynamicLayers",null),(0,n._)([(0,r.Cb)()],h.prototype,"floors",void 0),(0,n._)([(0,r.Cb)({readOnly:!0})],h.prototype,"hasDynamicLayers",null),(0,n._)([(0,r.Cb)()],h.prototype,"layer",null),(0,n._)([(0,r.Cb)({readOnly:!0})],h.prototype,"layers",null),(0,n._)([(0,r.Cb)({readOnly:!0})],h.prototype,"layerDefs",null),(0,n._)([(0,r.Cb)({type:Number})],h.prototype,"scale",void 0),(0,n._)([(0,r.Cb)({readOnly:!0})],h.prototype,"version",null),(0,n._)([(0,r.Cb)({readOnly:!0})],h.prototype,"visibleSublayers",null),h=(0,n._)([(0,a.j)("esri.layers.support.ExportImageParameters")],h)},77271:function(e,t,i){"use strict";i.d(t,{L:function(){return u}});var n=i(73440),o=i(70880),s=i(17155),r=(i(61432),i(96711),i(83850),i(48023)),a=i(67764),l=i(13132),c=i(47566),d=i(37204);let u=class extends o.Z{constructor(e){super(e)}get bounds(){const e=this.coords;return null==e?.extent?null:(0,c.oJ)(e.extent)}get coords(){const e=this.element.georeference?.coords;return(0,l.projectOrLoad)(e,this.spatialReference).geometry}get normalizedCoords(){return a.Z.fromJSON((0,d.Ui)(this.coords))}get normalizedBounds(){const e=null!=this.normalizedCoords?this.normalizedCoords.extent:null;return null!=e?(0,c.oJ)(e):null}};(0,n._)([(0,s.Cb)()],u.prototype,"spatialReference",void 0),(0,n._)([(0,s.Cb)()],u.prototype,"element",void 0),(0,n._)([(0,s.Cb)()],u.prototype,"bounds",null),(0,n._)([(0,s.Cb)()],u.prototype,"coords",null),(0,n._)([(0,s.Cb)()],u.prototype,"normalizedCoords",null),(0,n._)([(0,s.Cb)()],u.prototype,"normalizedBounds",null),u=(0,n._)([(0,r.j)("esri.layers.support.MediaElementView")],u)},49076:function(e,t,i){"use strict";i.d(t,{Z:function(){return y}});var n,o=i(73440),s=i(63255),r=i(28947),a=i(8914),l=i(17155),c=(i(61432),i(96711),i(48023)),d=i(29884),u=i(75432),h=i(67764),p=i(13132);let y=n=class extends s.Z{constructor(e){super(e),this.geometry=null,this.type="clip"}writeGeometry(e,t,i,n){if(n.layer?.spatialReference&&!n.layer.spatialReference.equals(this.geometry.spatialReference)){if(!(0,p.canProjectWithoutEngine)(e.spatialReference,n.layer.spatialReference))return void(n?.messages&&n.messages.push(new a.Z("scenemodification:unsupported","Scene modifications with incompatible spatial references are not supported",{modification:this,spatialReference:n.layer.spatialReference,context:n})));const o=new h.Z;(0,p.projectPolygon)(e,o,n.layer.spatialReference),t[i]=o.toJSON(n)}else t[i]=e.toJSON(n);delete t[i].spatialReference}clone(){return new n({geometry:(0,r.d9)(this.geometry),type:this.type})}};(0,o._)([(0,l.Cb)({type:h.Z}),(0,u.B)()],y.prototype,"geometry",void 0),(0,o._)([(0,d.c)(["web-scene","portal-item"],"geometry")],y.prototype,"writeGeometry",null),(0,o._)([(0,l.Cb)({type:["clip","mask","replace"],nonNullable:!0}),(0,u.B)()],y.prototype,"type",void 0),y=n=(0,o._)([(0,c.j)("esri.layers.support.SceneModification")],y)},97113:function(e,t,i){"use strict";i.d(t,{Z:function(){return h}});var n,o=i(73440),s=i(78619),r=i(43254),a=i(63255),l=i(95490),c=i(17155),d=(i(61432),i(96711),i(83850),i(48023)),u=i(49076);let h=n=class extends(a.Z.JSONSupportMixin(r.Z.ofType(u.Z))){constructor(e){super(e),this.url=null}clone(){return new n({url:this.url,items:this.items.map((e=>e.clone()))})}toJSON(e){return this.toArray().map((t=>t.toJSON(e))).filter((e=>!!e.geometry))}static fromJSON(e,t){const i=new n;for(const n of e)i.add(u.Z.fromJSON(n,t));return i}static async fromUrl(e,t,i){const o={url:(0,l.mN)(e),origin:"service"},r=await(0,s.Z)(e,{responseType:"json",signal:i?.signal}),a=t.toJSON(),c=[];for(const e of r.data)c.push(u.Z.fromJSON({...e,geometry:{...e.geometry,spatialReference:a}},o));return new n({url:e,items:c})}};(0,o._)([(0,c.Cb)({type:String})],h.prototype,"url",void 0),h=n=(0,o._)([(0,d.j)("esri.layers.support.SceneModifications")],h)},94219:function(e,t,i){"use strict";i.d(t,{Z:function(){return s}});var n=i(88194),o=i(93568);class s{constructor(e,t=0,i=e.lods[e.lods.length-1].level){this.tileInfo=e,this.minLOD=t,this.maxLOD=i,e.lodAt(t)||(this.minLOD=e.lods[0].level),e.lodAt(i)||(this.maxLOD=e.lods[e.lods.length-1].level)}get effectiveMinLOD(){return this.minLOD??this.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.tileInfo.lods[this.tileInfo.lods.length-1].level}getAvailability(e,t,i){const n=this.tileInfo?.lodAt(e);return!n||e<this.minLOD||e>this.maxLOD?"unavailable":n.cols&&n.rows?i>=n.cols[0]&&i<=n.cols[1]&&t>=n.rows[0]&&t<=n.rows[1]?"unknown":"unavailable":"unknown"}async fetchAvailability(e,t,i,s){await(0,o.Yn)(s);const r=this.getAvailability(e,t,i);if("unavailable"===r)throw new n.Z("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:i});return r}async fetchAvailabilityUpsample(e,t,i,n,s){await(0,o.Yn)(s),n.level=e,n.row=t,n.col=i;const r=this.tileInfo;return r.updateTileInfo(n),this.fetchAvailability(e,t,i,s).catch((e=>{if((0,o.D_)(e))throw e;if(r.upsampleTile(n))return this.fetchAvailabilityUpsample(n.level,n.row,n.col,n,s);throw e}))}}},44695:function(e,t,i){"use strict";function n(e){const t=e.layer;return"floorInfo"in t&&t.floorInfo?.floorField&&"floors"in e.view?s(e.view.floors,t.floorInfo.floorField):null}function o(e,t){return"floorInfo"in t&&t.floorInfo?.floorField?s(e,t.floorInfo.floorField):null}function s(e,t){if(!e?.length)return null;const i=e.filter((e=>""!==e)).map((e=>`'${e}'`));return i.push("''"),`${t} IN (${i.join(",")}) OR ${t} IS NULL`}i.d(t,{c:function(){return n},f:function(){return o}})},71730:function(e,t,i){"use strict";function n(e,t){return t?"xoffset"in t&&t.xoffset?Math.max(e,Math.abs(t.xoffset)):"yoffset"in t&&t.yoffset?Math.max(e,Math.abs(t.yoffset||0)):e:e}function o(e,t){return"number"==typeof e?e:e?.stops?.length?function(e){let t=0,i=0;for(let n=0;n<e.length;n++){const o=e[n].size;"number"==typeof o&&(t+=o,i++)}return t/i}(e.stops):t}function s(e,t){if(!t)return e;const i=t.filter((e=>"size"===e.type)).map((t=>{const{maxSize:i,minSize:n}=t;return(o(i,e)+o(n,e))/2}));let n=0;const s=i.length;if(0===s)return e;for(let e=0;e<s;e++)n+=i[e];const r=Math.floor(n/s);return Math.max(r,e)}function r(e){const t=e?.renderer,i=e?.pointerType,o="touch"===i?9:6;if(!t)return o;const r="visualVariables"in t?s(o,t.visualVariables):o;if("simple"===t.type)return n(r,t.symbol);if("unique-value"===t.type){let e=r;return t.uniqueValueInfos?.forEach((t=>{e=n(e,t.symbol)})),e}if("class-breaks"===t.type){let e=r;return t.classBreakInfos.forEach((t=>{e=n(e,t.symbol)})),e}return"dot-density"===t.type||t.type,r}i.d(t,{k:function(){return r}})},92680:function(e,t,i){"use strict";i.d(t,{e:function(){return r},s:function(){return a}});var n=i(3480),o=(i(61432),i(88194)),s=i(87644);function r(e){return null==e||"simple"===e.type||"unique-value"===e.type||"class-breaks"===e.type||"dictionary"===e.type||"heatmap"===e.type}function a(e,t){if(null==e)return null;if(!r(e))return new o.Z("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${e.type||e.declaredClass}'`,{renderer:e});switch(e.type){case"simple":return function(e,t){const i={...s.K,...t,cimFallbackEnabled:!0};return l(e,(0,s.q)(e.symbol,i).error)}(e,t);case"unique-value":return function(e,t){const i={...s.K,...t,cimFallbackEnabled:!0},o=e.uniqueValueInfos?.map((e=>(0,s.q)(e.symbol,i).error)).filter(n.pC),r=(0,s.q)(e.defaultSymbol,i);return r.error&&o?.unshift(r.error),l(e,o)}(e,t);case"class-breaks":return function(e,t){const i={...s.K,...t,cimFallbackEnabled:!0},o=e.classBreakInfos.map((e=>(0,s.q)(e.symbol,i).error)).filter(n.pC),r=(0,s.q)(e.defaultSymbol,i);return r.error&&o.unshift(r.error),l(e,o)}(e,t);case"dictionary":case"heatmap":return null}return null}function l(e,t){if(!t)return null;if(Array.isArray(t)||(t=[t]),t.length>0){const i=t.map((e=>e.details.symbol.type||e.details.symbol.declaredClass)).filter((e=>!!e));i.sort();const n=new Array;return i.forEach(((e,t)=>{0!==t&&e===i[t-1]||n.push(e)})),new o.Z("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${n.join(", ")}) which are not supported in 3D`,{renderer:e,symbolErrors:t})}return null}},95365:function(e,t,i){"use strict";i.d(t,{r6:function(){return h}});var n,o=i(28947);i(44783),i(44252);function s(e){switch(e){case"circle":return{rings:[[[8.5,.2],[7.06,.33],[5.66,.7],[4.35,1.31],[3.16,2.14],[2.14,3.16],[1.31,4.35],[.7,5.66],[.33,7.06],[.2,8.5],[.33,9.94],[.7,11.34],[1.31,12.65],[2.14,13.84],[3.16,14.86],[4.35,15.69],[5.66,16.3],[7.06,16.67],[8.5,16.8],[9.94,16.67],[11.34,16.3],[12.65,15.69],[13.84,14.86],[14.86,13.84],[15.69,12.65],[16.3,11.34],[16.67,9.94],[16.8,8.5],[16.67,7.06],[16.3,5.66],[15.69,4.35],[14.86,3.16],[13.84,2.14],[12.65,1.31],[11.34,.7],[9.94,.33],[8.5,.2]]]};case"square":return{rings:[[[.5,.5],[.5,16.5],[16.5,16.5],[16.5,.5],[.5,.5]]]};case"diamond":return{rings:[[[8.5,.5],[.2,8.5],[8.5,16.5],[16.5,8.5],[8.5,.5]]]};case"hexagon-pointy":return{rings:[[[15.86,12.75],[15.86,4.25],[8.5,0],[1.14,4.25],[1.14,12.75],[8.5,17],[15.86,12.75]]]};case"hexagon-flat":return{rings:[[[12.75,15.86],[17,8.5],[12.75,1.14],[4.25,1.14],[0,8.5],[4.25,15.86],[12.75,15.86]]]}}}function r(e){return"CIMVectorMarker"===e?.type?e.markerGraphics?.[0]:void 0}function a(e){return"CIMPolygonSymbol"===e?.symbol?.type?e.symbol.symbolLayers?.[0]:void 0}function l(e,t){"CIMVectorMarker"===e?.type&&null!=t&&(e.size=t)}function c(e,t){const i=r(e);i&&null!=t&&(i.geometry=s(t))}function d(e,t){const i=a(r(e));i&&null!=t&&(i.color=t.toArray())}function u(e,t,i){const n=a(r(e));n&&null!=t&&i&&(n.colorLocked=t)}function h(e,t){const{outerRingSize:i,innerDotSize:s,type:r,color:a,colorLocked:h,primitiveOverrides:p}=t,y="CIMPolygonSymbol"===e.data.symbol?.type?e.data.symbol.symbolLayers:null;if(2===y?.length)for(const e of y){const t=e.primitiveName===n.OuterRing;l(e,t?i:s),c(e,r),d(e,a),u(e,h,t)}return null!=i&&null!=s&&(e.data.primitiveOverrides=null),void 0!==p&&(e.data.primitiveOverrides=(0,o.d9)(p)),e}!function(e){e.OuterRing="reference-size-outer-ring",e.InnerDot="reference-size-inner-dot"}(n||(n={}))},50820:function(e,t,i){"use strict";i.r(t),i.d(t,{CIMSymbolRasterizer:function(){return h}});var n=i(90756),o=i(88890),s=i(35236);class r{constructor(){this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null,this.geometryEnginePromise=null}destroy(){this._inFlightResourceMap.clear(),this._resourceMap.clear()}getResource(e){return this._resourceMap.get(e)??null}async fetchResource(e,t){const i=this._resourceMap.get(e);if(i)return{width:i.width,height:i.height};let n=this._inFlightResourceMap.get(e);return n?n.then((e=>({width:e.width,height:e.height}))):(n=(0,s.n$)(e,t),this._inFlightResourceMap.set(e,n),n.then((t=>(this._inFlightResourceMap.delete(e),this._resourceMap.set(e,t),{width:t.width,height:t.height})),(()=>({width:0,height:0}))))}deleteResource(e){this._inFlightResourceMap.delete(e),this._resourceMap.delete(e)}loadFont(e){return(0,o.mx)(e)}}var a=i(32566),l=i(80746),c=i(17623),d=i(84210),u=i(61421);class h{constructor(e){this._spatialReference=e,this._imageDataCanvas=null,this._cimResourceManager=new r}get _canvas(){return this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas")),this._imageDataCanvas}get resourceManager(){return this._cimResourceManager}async rasterizeCIMSymbolAsync(e,t,i,o,s,r,a,h,y,g){if(!e)return null;const{data:m}=e;if(!m||"CIMSymbolReference"!==m.type||!m.symbol)return null;const{symbol:f}=m;r||(r=(0,u.JW)(f));const v=await c.OverrideHelper.resolveSymbolOverrides(m,t,this._spatialReference,s,r,a,h),b=this._cimResourceManager,_=[];l.B$.fetchResources(v,b,_),l.B$.fetchFonts(v,b,_),_.length>0&&await Promise.all(_);const{width:w,height:C}=i;let x=p(r,w,C,o,g);const S=l.B$.getEnvelope(v,x,b);if(!S)return null;S.x===1/0&&(S.x=w+2),S.y===1/0&&(S.y=-C/2),S.width===-1/0&&(S.width=w),S.height===-1/0&&(S.height=C);let E=1,k=0,L=0;switch(f.type){case"CIMPointSymbol":case"CIMTextSymbol":{let e=1;S.width>w&&(e=w/S.width);let t=1;S.height>C&&(t=C/S.height),"preview"===o&&(S.width<w&&(e=w/S.width),S.height<C&&(t=C/S.height)),E=Math.min(e,t),k=S.x+S.width/2,L=S.y+S.height/2}break;case"CIMLineSymbol":if(g){L=S.y+S.height/2,k=S.x+S.width/2;const e=S.width-w,t=S.height-C;x={paths:(0,d.bA)(x.paths,{xmin:-1*S.width/2+e,xmax:S.width/2-e,ymin:-1*S.height/2+t,ymax:S.height/2-t,width:S.width-2*e,height:S.height-2*t})}}else{(y||S.height>C)&&(E=C/S.height),L=S.y+S.height/2;const e=S.x*E+w/2,t=(S.x+S.width)*E+w/2,i=(0,n.l9)(x)?x.paths:(0,n.oU)(x)?x.rings:null;if(null===i)throw new Error("Bad geometry, can't rasterise symbol!");i[0][0][0]-=e/E,i[0][2][0]-=(t-w)/E}break;case"CIMPolygonSymbol":if(g){L=S.y+S.height/2,k=S.x+S.width/2;const e=S.width-w,t=S.height-C;x={paths:(0,d.bA)(x.rings,{xmin:-1*S.width/2+e,xmax:S.width/2-e,ymin:-1*S.height/2+t,ymax:S.height/2-t,width:S.width-2*e,height:S.height-2*t})}}else{k=S.x+S.width/2,L=S.y+S.height/2;const e=S.x*E+w/2,t=(S.x+S.width)*E+w/2,i=S.y*E+C/2,n=(S.y+S.height)*E+C/2,{rings:o}=x;e<0&&(o[0][0][0]-=e,o[0][3][0]-=e,o[0][4][0]-=e),i<0&&(o[0][0][1]+=i,o[0][1][1]+=i,o[0][4][1]+=i),t>w&&(o[0][1][0]-=t-w,o[0][2][0]-=t-w),n>C&&(o[0][2][1]+=n-C,o[0][3][1]+=n-C)}}const T={type:"cim",data:{type:"CIMSymbolReference",symbol:v}};return this.rasterize(T,w,C,k,L,E,r,1,x)}rasterize(e,t,i,n,o,s,r,l=0,c=null,d=window.devicePixelRatio||1){const{data:h}=e;if(!h||"CIMSymbolReference"!==h.type||!h.symbol)return null;const{symbol:y}=h,g=this._canvas,m=1.3333333333333333*d;g.width=t*m,g.height=i*m,r||(r=(0,u.JW)(y)),c||(c=p(r,t,i,"legend")),g.width+=2*l,g.height+=2*l;const f=g.getContext("2d",{willReadFrequently:!0}),v=a.zA.createIdentity();return v.translate(-n,-o),v.scale(s*m,-s*m),v.translate(t*m/2+l,i*m/2+l),f.clearRect(0,0,g.width,g.height),new a.cD(f,this._cimResourceManager,v,!0).drawSymbol(y,c),f.getImageData(0,0,g.width,g.height)}}function p(e,t,i,n,o){const s=-t/2+1,r=t/2-1,a=i/2-1,l=-i/2+1;if(o&&("esriGeometryPolygon"===e||"esriGeometryPolyline"===e)){const n=function(e,t,i,n){return"esriGeometryPolygon"===t?{rings:(0,d.Iu)((0,d.bA)(e.rings,{xmin:0,ymin:0,width:i,height:n}),-1*i/2,-1*n/2)}:"esriGeometryPolyline"===t?{paths:(0,d.Iu)((0,d.bA)(e.paths,{xmin:0,ymin:0,width:i,height:n}),-1*i/2,-1*n/2)}:null}(o,e,t,i);if(n)return n}switch(e){case"esriGeometryPoint":return{x:0,y:0};case"esriGeometryPolyline":return{paths:[[[s,0],[0,0],[r,0]]]};default:return"legend"===n?{rings:[[[s,a],[r,0],[r,l],[s,l],[s,a]]]}:{rings:[[[s,a],[r,a],[r,l],[s,l],[s,a]]]}}}},17623:function(e,t,i){"use strict";i.d(t,{OverrideHelper:function(){return u}});var n=i(53147),o=i(92643),s=i(28947),r=i(299),a=i(15065),l=i(61421),c=i(66882);const d=e=>{if(!e)return[0,0,0,0];const{r:t,g:i,b:n,a:o}=e;return[t,i,n,255*o]};class u{static findApplicableOverrides(e,t,i){if(e&&t){if(e.primitiveName){let n=!1;for(const t of i)if(t.primitiveName===e.primitiveName){n=!0;break}if(!n)for(const n of t)n.primitiveName===e.primitiveName&&i.push(n)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const n of e.effects)u.findApplicableOverrides(n,t,i);if(e.symbolLayers)for(const n of e.symbolLayers)u.findApplicableOverrides(n,t,i);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(e.effects)for(const n of e.effects)u.findApplicableOverrides(n,t,i);if(e.markerPlacement&&u.findApplicableOverrides(e.markerPlacement,t,i),"CIMVectorMarker"===e.type){if(e.markerGraphics)for(const n of e.markerGraphics)u.findApplicableOverrides(n,t,i),u.findApplicableOverrides(n.symbol,t,i)}else"CIMCharacterMarker"===e.type?u.findApplicableOverrides(e.symbol,t,i):"CIMHatchFill"===e.type?u.findApplicableOverrides(e.lineSymbol,t,i):"CIMPictureMarker"===e.type&&u.findApplicableOverrides(e.animatedSymbolProperties,t,i)}}}static findEffectOverrides(e,t){if(!e)return null;if("CIMGeometricEffectDashes"===e.type&&(0,l.hU)(e),!t||!e.primitiveName)return{type:"cim-effect-param",effect:e,overrides:[]};const i=(0,l.Ml)(e),n=e.primitiveName,o=[];for(const e of t)e.primitiveName===n&&o.push((0,l.Ml)(e));return{type:"cim-effect-param",effect:i,overrides:(0,l.Ul)(o)}}static async resolveSymbolOverrides(e,t,i,n,o,a,c){if(!e?.symbol)return null;let{symbol:d,primitiveOverrides:h}=e;const p=!!h;if(!p&&!n)return d;d=(0,s.d9)(d),h=(0,s.d9)(h);let y=!0;if(t||(t={attributes:{}},y=!1),p){if(y||(h=h.filter((e=>!e.valueExpressionInfo?.expression.includes("$feature")))),c||(h=h.filter((e=>!e.valueExpressionInfo?.expression.includes("$view")))),h.length>0){const e=(0,l.Qf)(t.attributes),n={spatialReference:i,fields:e,geometryType:o};await u.createRenderExpressions(h,n),u.evaluateOverrides(h,t,o??"esriGeometryPoint",a,c,new r.Z(e))}u.applyOverrides(d,h)}return n&&u.applyDictionaryTextOverrides(d,t,n,null),d}static{this._expressionToRenderExpression=new Map}static async createRenderExpressions(e,t){const i=[];for(const n of e){const e=n.valueExpressionInfo;if(!e||u._expressionToRenderExpression.has(e.expression))continue;const o=(0,a.Yi)(e.expression,t.spatialReference);i.push(o),o.then((t=>u._expressionToRenderExpression.set(e.expression,t)))}i.length>0&&await Promise.all(i)}static evaluateOverrides(e,t,i,n,s,r){const a={$view:{scale:s?.scale}};for(const s of e){s.value&&"object"==typeof s.value&&(0,o.jQ)(s.value)&&("Color"===s.propertyName||"StrokeColor"===s.propertyName)&&(s.value=d(s.value));const e=s.valueExpressionInfo;if(!e)continue;const l=u._expressionToRenderExpression.get(e.expression);l&&(s.value=(0,c.default)(l,t,a,i,r,n))}}static applyDictionaryTextOverrides(e,t,i,n,o="Normal"){if(e?.type)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const s=e.symbolLayers;if(!s)return;for(const r of s)r&&"CIMVectorMarker"===r.type&&u.applyDictionaryTextOverrides(r,t,i,n,"CIMTextSymbol"===e.type?e.textCase:o)}break;case"CIMVectorMarker":{const o=e.markerGraphics;if(!o)return;for(const e of o)e&&u.applyDictionaryTextOverrides(e,t,i,n)}break;case"CIMMarkerGraphic":{const s=e.textString;if(s&&s.includes("[")){const r=(0,l.H1)(s,i);e.textString=(0,l.E_)(t,r,n,o)}}}}static applyOverrides(e,t,i,n){if(e.primitiveName)for(const o of t)if(o.primitiveName===e.primitiveName){const t=(0,l.Le)(o.propertyName);if(n&&n.push({cim:e,nocapPropertyName:t,value:e[t]}),i){let t=!1;for(const n of i)n.primitiveName===e.primitiveName&&(t=!0);t||i.push(o)}null!=o.value&&(e[t]=o.value)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const o of e.effects)u.applyOverrides(o,t,i,n);if(e.symbolLayers)for(const o of e.symbolLayers)u.applyOverrides(o,t,i,n);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(e.effects)for(const o of e.effects)u.applyOverrides(o,t,i,n);if("CIMVectorMarker"===e.type&&e.markerGraphics)for(const o of e.markerGraphics)u.applyOverrides(o,t,i,n),u.applyOverrides(o.symbol,t,i,n)}}static restoreOverrides(e){for(const t of e)t.cim[t.nocapPropertyName]=t.value}static buildOverrideKey(e){let t="";for(const i of e)void 0!==i.value&&(t+=`${i.primitiveName}${i.propertyName}${JSON.stringify(i.value)}`);return t}static toValue(e,t){if("DashTemplate"===e)return t.split(" ").map((e=>Number(e)));if("Color"===e){const e=new n.Z(t).toRgba();return e[3]*=255,e}return t}}},82738:function(e,t,i){"use strict";i.d(t,{S:function(){return g},previewCIMSymbol:function(){return m}});var n=i(96094),o=i(80746),s=i(50820),r=i(17623),a=i(61421),l=i(77423),c=i(47967);const d=new s.CIMSymbolRasterizer(null),u=(0,n.Wz)(l.b_.size),h=(0,n.Wz)(l.b_.maxSize),p=(0,n.Wz)(l.b_.lineWidth);async function y(e,t,i){const n=t?.size;let o=null!=n&&"object"==typeof n&&"width"in n?n.width:n,s=null!=n&&"object"==typeof n&&"height"in n?n.height:n;if(!o||!s)if("esriGeometryPolygon"===i)o=s=t.maxSize?Math.min(t.maxSize,u):u;else{const n=await g(e,t,i);n&&(o=n.width,s=n.height),"esriGeometryPolyline"===i&&(o=t.maxSize?Math.min(t.maxSize,p):p),o=null!=o&&isFinite(o)?Math.min(o,h):u,s=null!=s&&isFinite(s)?Math.max(Math.min(s,h),1):u}return"legend"===t.style&&"esriGeometryPolyline"===i&&(o=p),{width:o,height:s}}async function g(e,t={},i){const n=t.cimOptions||t;i??=n.geometryType||(0,a.JW)(e?.data?.symbol);const{feature:s,fieldMap:l,viewParams:c}=n,u=await r.OverrideHelper.resolveSymbolOverrides(e.data,s,null,l,i,null,c);if(!u)return null;(e=e.clone()).data={type:"CIMSymbolReference",symbol:u},e.data.primitiveOverrides=void 0;const h=[];return o.B$.fetchResources(u,d.resourceManager,h),o.B$.fetchFonts(u,d.resourceManager,h),h.length>0&&await Promise.all(h),o.B$.getEnvelope(u,null,d.resourceManager)}async function m(e,t={}){const{node:i,opacity:o,symbolConfig:s}=t,r=null!=s&&"object"==typeof s&&"isSquareFill"in s&&s.isSquareFill,l=t.cimOptions||t,u=l.geometryType||(0,a.JW)(e?.data?.symbol),h=await y(e,t,u),{feature:p,fieldMap:g}=l,m=t?.geometry||r||"esriGeometryPolygon"!==u?"preview":"legend";let f=h;const v=h;if(t?.geometry&&("esriGeometryPolygon"===u||"esriGeometryPolyline"===u)){const e=200;if((0,n.F2)(h.width)<e||(0,n.F2)(h.height)<e){const t=h.width>h.height?(0,n.Wz)(e)*h.height/h.width:(0,n.Wz)(e);f={width:h.width>h.height?(0,n.Wz)(e):(0,n.Wz)(e)*h.width/h.height,height:t}}}const b=await d.rasterizeCIMSymbolAsync(e,p,f,m,g,u,null,l.viewParams,l.allowScalingUp,t?.geometry?.toJSON());if(!b)return null;const{width:_,height:w}=b,C=document.createElement("canvas");C.width=_,C.height=w,C.getContext("2d").putImageData(b,0,0);const x=(0,n.F2)(v.width),S=(0,n.F2)(v.height),E=new Image(x,S);E.src=C.toDataURL(),E.ariaLabel=t.ariaLabel??null,E.alt=t.ariaLabel??"",null!=o&&(E.style.opacity=`${o}`);let k=E;if(null!=t.effectView){const e={shape:{type:"image",x:0,y:0,width:x,height:S,src:E.src},fill:null,stroke:null,offset:[0,0]};k=(0,c.wh)([[e]],[x,S],t)}return i&&k&&i.appendChild(k),k}},66882:function(e,t,i){"use strict";i.d(t,{default:function(){return r}});var n=i(88194),o=i(96711),s=i(96610);function r(e,t,i,n,s,r){if(null==e)return null;const a=e.references("geometry")&&r?l(t,n,r):t,c=e.repurposeFeature(a,s);try{return e.evaluate(c,i)}catch(e){return o.Z.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",e),null}}const a=new Map;function l(e,t,i){const{transform:r,hasZ:l,hasM:c}=i;a.has(t)||a.set(t,function(e){const t={};switch(e){case"esriGeometryPoint":return(e,i,n,o)=>(0,s.U1)(i,t,e,n,o);case"esriGeometryPolygon":return(e,i,n,o)=>(0,s.Ie)(i,t,e,n,o);case"esriGeometryPolyline":return(e,i,n,o)=>(0,s.G6)(i,t,e,n,o);case"esriGeometryMultipoint":return(e,i,n,o)=>(0,s.J9)(i,t,e,n,o);default:return o.Z.getLogger("esri.views.2d.support.arcadeOnDemand").error(new n.Z("mapview-arcade",`Unable to handle geometryType: ${e}`)),e=>e}}(t));const d=a.get(t)(e.geometry,r,l,c);return{...e,geometry:d}}},85164:function(e,t,i){"use strict";i.d(t,{O:function(){return o},h:function(){return n}});var n;i(61432);function o(e){switch(e){case n.SUPPORTED:break;case n.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case n.GEOMETRY_MISSING:return"no geometry";case n.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case n.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case n.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""}!function(e){e[e.SUPPORTED=0]="SUPPORTED",e[e.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING",e[e.GEOMETRY_MISSING=2]="GEOMETRY_MISSING",e[e.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED",e[e.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED",e[e.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"}(n||(n={}))},51413:function(e,t,i){"use strict";i.d(t,{Y:function(){return s}});i(61432);var n=i(51870),o=i(85164);function s(e){if(e.graphic&&"graphics"!==e.graphic.layer?.type)return o.h.GRAPHICS_LAYER_MISSING;const t=e.operations?.data.type;if(!t)return o.h.GEOMETRY_TYPE_UNSUPPORTED;switch(t){case"polygon":case"point":case"polyline":case"mesh":break;default:return o.h.GEOMETRY_TYPE_UNSUPPORTED}const i=e.elevationInfo;return(0,n.XH)(i)?o.h.ELEVATION_MODE_UNSUPPORTED:o.h.SUPPORTED}},77308:function(e,t,i){"use strict";function n(e,t,i){if(!t||!e?.map)return;const{map:n}=e,o=n.layers.find((e=>e===t));o||n.add(t,i),o&&null!=i&&n.layers.reorder(o,i)}function o(e,t){const i="subtype-sublayer"===t?.type?t.parent:t;return e.allLayerViews.find((e=>{const t=e.layer;return t===i||"sublayers"in t&&null!=t.sublayers&&t.sublayers.includes(i)}))}i.d(t,{j:function(){return o},p:function(){return n}})},60396:function(e,t,i){"use strict";i.d(t,{Z:function(){return a}});var n=i(73440),o=i(70880),s=i(17155),r=(i(61432),i(96711),i(83850),i(48023));let a=class extends o.Z{constructor(e){super(e),this.enabled=!1}};(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],a.prototype,"enabled",void 0),a=(0,n._)([(0,r.j)("esri.views.interactive.sketch.SketchLabelOptions")],a)},41943:function(e,t,i){"use strict";i.d(t,{Z:function(){return d}});var n=i(73440),o=i(70880),s=i(17155),r=(i(61432),i(96711),i(83850),i(48023)),a=i(60396),l=i(69660),c=i(57440);let d=class extends o.Z{constructor(e){super(e),this.labels=new a.Z,this.tooltips=new l.Z,this.values=new c.Z}};(0,n._)([(0,s.Cb)({nonNullable:!0,type:a.Z})],d.prototype,"labels",void 0),(0,n._)([(0,s.Cb)({nonNullable:!0,type:l.Z})],d.prototype,"tooltips",void 0),(0,n._)([(0,s.Cb)({nonNullable:!0,type:c.Z})],d.prototype,"values",void 0),d=(0,n._)([(0,r.j)("esri.views.interactive.sketch.SketchOptions")],d)},69660:function(e,t,i){"use strict";i.d(t,{Z:function(){return c}});var n=i(73440),o=i(70880),s=i(17155),r=(i(61432),i(96711),i(83850),i(48023));let a=class extends o.Z{constructor(e){super(e),this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};(0,n._)([(0,s.Cb)({type:String,nonNullable:!0})],a.prototype,"mode",void 0),a=(0,n._)([(0,r.j)("esri.views.interactive.sketch.SketchTooltipElevationOptions")],a);let l=class extends o.Z{constructor(e){super(e),this.area=!0,this.coordinates=!0,this.direction=!0,this.distance=!0,this.elevation=!0,this.header=!0,this.helpMessage=!1,this.orientation=!0,this.radius=!0,this.rotation=!0,this.scale=!0,this.size=!0,this.totalLength=!0}};(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"area",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"coordinates",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"direction",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"distance",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"elevation",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"header",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"helpMessage",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"orientation",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"radius",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"rotation",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"scale",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"size",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"totalLength",void 0),l=(0,n._)([(0,r.j)("esri.views.interactive.sketch.SketchTooltipVisibleElements")],l);let c=class extends o.Z{constructor(e){super(e),this.enabled=!1,this.forceEnabled=!1,this.helpMessage=null,this.helpMessageIcon=null,this.inputEnabled=!0,this.elevation=new a,this.placement="auto",this.offset=null,this.visibleElements=new l,this.visualVariables=null,this.xyMode="auto"}get effectiveEnabled(){return this.forceEnabled||this.enabled}};(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],c.prototype,"enabled",void 0),(0,n._)([(0,s.Cb)()],c.prototype,"forceEnabled",void 0),(0,n._)([(0,s.Cb)()],c.prototype,"effectiveEnabled",null),(0,n._)([(0,s.Cb)()],c.prototype,"helpMessage",void 0),(0,n._)([(0,s.Cb)()],c.prototype,"helpMessageIcon",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],c.prototype,"inputEnabled",void 0),(0,n._)([(0,s.Cb)({type:a,nonNullable:!0})],c.prototype,"elevation",void 0),(0,n._)([(0,s.Cb)()],c.prototype,"placement",void 0),(0,n._)([(0,s.Cb)()],c.prototype,"offset",void 0),(0,n._)([(0,s.Cb)({type:l,nonNullable:!0})],c.prototype,"visibleElements",void 0),(0,n._)([(0,s.Cb)()],c.prototype,"visualVariables",void 0),(0,n._)([(0,s.Cb)()],c.prototype,"xyMode",void 0),c=(0,n._)([(0,r.j)("esri.views.interactive.sketch.SketchTooltipOptions")],c)},57440:function(e,t,i){"use strict";i.d(t,{Z:function(){return c}});var n=i(73440),o=i(70880),s=i(17155),r=(i(61432),i(96711),i(83850),i(48023));let a=class extends o.Z{constructor(e){super(e),this.length=null,this.verticalLength=null,this.area=null}};(0,n._)([(0,s.Cb)()],a.prototype,"length",void 0),(0,n._)([(0,s.Cb)()],a.prototype,"verticalLength",void 0),(0,n._)([(0,s.Cb)()],a.prototype,"area",void 0),a=(0,n._)([(0,r.j)("esri.views.interactive.sketch.Units")],a);var l=i(53257);let c=class extends o.Z{constructor(e){super(e),this.directionMode="relative",this.relativeDirectionIsBilateral=!1}get effectiveDirectionMode(){switch(this.directionMode){case"relative":return this.relativeDirectionIsBilateral?l.uE.RelativeBilateral:l.uE.Relative;case"absolute":return l.uE.Absolute}}get displayUnits(){return this._get("displayUnits")??new a}set displayUnits(e){this._set("displayUnits",e)}get inputUnits(){return this._get("inputUnits")??new a}set inputUnits(e){this._set("inputUnits",e)}};(0,n._)([(0,s.Cb)({type:String,nonNullable:!0})],c.prototype,"directionMode",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],c.prototype,"relativeDirectionIsBilateral",void 0),(0,n._)([(0,s.Cb)()],c.prototype,"effectiveDirectionMode",null),(0,n._)([(0,s.Cb)({type:a,nonNullable:!0})],c.prototype,"displayUnits",null),(0,n._)([(0,s.Cb)({type:a,nonNullable:!0})],c.prototype,"inputUnits",null),c=(0,n._)([(0,r.j)("esri.views.interactive.sketch.SketchValueOptions")],c)},31066:function(e,t,i){"use strict";i.d(t,{M:function(){return n}});const n={absolute:"absolute-direction",relative:"relative-direction"}},53257:function(e,t,i){"use strict";i.d(t,{Ci:function(){return b},LH:function(){return w},Lm:function(){return y},d3:function(){return _},ib:function(){return x},n6:function(){return m},uE:function(){return n},yd:function(){return C},zS:function(){return f}});var n,o=i(95437),s=i(1925),r=i(26636),a=i(26821),l=i(41788),c=i(24910),d=i(82846),u=i(2051),h=i(95872),p=i(8554);function y(e,t){if(null==e||null==t)return;const i=g(e,t);return null!=i?(0,s.GJ)(i,"radians","geographic"):void 0}!function(e){e.Absolute="absolute",e.Relative="relative",e.RelativeBilateral="relative-bilateral"}(n||(n={}));const g=(()=>{const e=(0,d.Ue)(),t=(0,d.Ue)();return(i,n)=>((0,c.i)(e,i.x,i.y,i.z??0),(0,c.i)(t,n.x,n.y,n.z??0),m(e,t,i.spatialReference,n.spatialReference))})(),m=(()=>{const e=(0,l.Ue)(),t=(0,d.Ue)(),i=(0,d.Ue)();return(n,o,s,d)=>{if((0,c.q)(n,o))return;const y=(0,h.Lc)(s),g=(0,h.Lc)(d);if(y&&g&&(0,p.fS)(y,g)&&(0,u.S)(n,s,t,y)&&(0,u.S)(o,d,i,g)){const{azimuth:e}=(0,h.cA)(E,t,i,y);return null!=e?(0,r.En)(e,"degrees","radians"):void 0}e[0]=o[0]-n[0],e[1]=o[1]-n[1];let m=(0,a.EU)(l.IO,e);return e[0]<0&&(m=k-m),m}})();function f(e,t,i,o=n.Absolute){if(t&&i)switch(o){case n.Absolute:return y(t,i);case n.Relative:return b(v(e,t,i),n.Relative);case n.RelativeBilateral:return b(v(e,t,i),n.RelativeBilateral)}}function v(e,t,i){if(!e||!t||!i)return;const n=g(e,t),o=g(t,i);return null!=n&&null!=o?(0,s.GJ)(o-n,"radians","geographic"):void 0}function b(e,t){if(null!=e)switch(t){case n.Absolute:return _(e);case n.Relative:{const t=C(e);let i=T.normalize(t,0,!0);return-180===i&&(i=180),(0,s.GJ)(i,"degrees","geographic")}case n.RelativeBilateral:{const t=C(e),i=Math.abs(T.normalize(t,0,!0));return(0,s.GJ)(i,"degrees","geographic")}}}function _(e){const t=C(e),i=L.normalize(t,0,!0);return(0,s.GJ)(i,"degrees","geographic")}const w=(()=>{const e=(0,d.Ue)();return(t,i,n,o,a,l="geodesic")=>{(0,c.c)(e,i);const d=C(a);if("geodesic"===l){const s=(0,h.Lc)(n);if(s&&(0,u.S)(e,n,e,s))return(0,h.TB)(t,e,d,o,s),t[2]=i[2],!!(0,u.S)(t,s,t,n)}const p=(0,s.hw)(d,"geographic","arithmetic"),y=(0,r.En)(p,"degrees","radians"),g=i[0]+o*Math.cos(y),m=i[1]+o*Math.sin(y),f=i[2];return(0,c.i)(t,g,m,f),!0}})();function C(e){if(null!=e)return(0,s.hw)(S(e),e.rotationType,"geographic")}function x(e){if(null!=e)return(0,s.hw)(S(e),e.rotationType,"arithmetic")}function S(e){return(0,r.En)(e.value,e.unit,"degrees")}const E=new h._q,k=2*Math.PI,L=o.BV,T=new o.pE(-180,180)},54074:function(e,t,i){"use strict";i.d(t,{A:function(){return a}});var n=i(73799),o=i(72575);const s=e=>({autoAreaByElevationMode(t,i,o=(0,n.ln)()){if("on-the-ground"===i){const i=e.geodesicArea(t);return null!=i?i:(0,n.X)(t,o)}return(0,n.oN)(t,o)},autoArea2D(e,t=(0,n.ln)()){return this.autoAreaByElevationMode(e,"on-the-ground",t)}});let r=null;async function a(){return r||(r=s(await(0,o.g)())),r}},8316:function(e,t,i){"use strict";i.d(t,{U:function(){return r}});var n=i(82846),o=i(49510),s=i(55274);async function r(){return function(e){return{autoLength2D:t=>e.geodesicLength(t)??(0,o.Sx)(t),autoDistanceBetweenPoints2D:(t,i)=>e.geodesicDistanceBetweenPoints(t,i)??(0,o.xI)(t,i),autoDistance2D:(t,i,n)=>(a[0]=t[0],a[1]=t[1],a[2]=3===t.length?t[2]:0,l[0]=i[0],l[1]=i[1],l[2]=3===i.length?i[2]:0,e.geodesicDistance(a,l,n)??(0,o.qj)(a,l,n))}}(await(0,s.H)())}const a=(0,n.Ue)(),l=(0,n.Ue)()},54318:function(e,t,i){"use strict";i.d(t,{D:function(){return a},K:function(){return r}});var n=i(26636),o=i(71354),s=i(71730);function r(e,t,i,s=new o.Z){let r=0;if("2d"===i.type)r=t*(i.resolution??0);else if("3d"===i.type){const o=i.overlayPixelSizeInMapUnits(e),s=i.basemapSpatialReference;r=null==s||s.equals(i.spatialReference)?t*o:(0,n.c9)(s)/(0,n.c9)(i.spatialReference)}const a=e.x-r,l=e.y-r,c=e.x+r,d=e.y+r,{spatialReference:u}=i;return s.xmin=Math.min(a,c),s.ymin=Math.min(l,d),s.xmax=Math.max(a,c),s.ymax=Math.max(l,d),s.spatialReference=u,s}function a(e,t,i){const n=i.toMap(e);return null!=n&&r(n,(0,s.k)(),i,l).intersects(t)}const l=new o.Z},73799:function(e,t,i){"use strict";i.d(t,{X:function(){return p},bT:function(){return v},ln:function(){return f},oN:function(){return h}});var n=i(1925),o=i(26636),s=i(38874),r=i(24910),a=i(82846),l=i(2051),c=i(77773),d=i(79012),u=i(27250);function h(e,t={positionsWorldCoords:[]}){return y(e,t)}function p(e,t={positionsWorldCoords:[]}){return y(e,t,!1)}function y(e,t,i=e.hasZ){const s=(0,u.m)(e.spatialReference),h=(0,o.oq)(s);if(null==h)return null;const p=(e,t)=>!(t.length<2||((0,r.i)(e,t[0],t[1],i&&t[2]||0),0));let y=0;for(const i of e.rings){const n=i.length;if(n<3)continue;const{positionsWorldCoords:o}=t;for(;o.length<n;)o.push((0,a.Ue)());const u=g,h=(0,r.i)(m,0,0,0),f=1/n;for(let t=0;t<n;t++){if(!p(u,i[t]))return null;if(!(0,l.S)(u,e.spatialReference,o[t],s))return null;(0,r.b)(h,h,o[t],f)}const b=(0,c.zk)(o[0],o[1],h,(0,c.re)());if(0===(0,r.k)((0,c.st)(b)))continue;for(let e=0;e<n;e++)(0,c.tx)(b,h,o[e],o[e]);const _=v(o);for(let e=0;e<_.length;e+=3)y+=(0,d.wu)(o[_[e]],o[_[e+1]],o[_[e+2]])}return(0,n.ne)(y,h)}const g=(0,a.Ue)(),m=(0,a.Ue)();function f(){return{positionsWorldCoords:[]}}function v(e){return(0,s.e)(function(e){const t=new Float64Array(2*e.length);for(let i=0;i<e.length;++i){const n=e[i],o=2*i;t[o]=n[0],t[o+1]=n[1]}return t}(e),[],2)}},72575:function(e,t,i){"use strict";i.d(t,{g:function(){return a}});var n=i(1925),o=i(95872),s=i(10618);const r=e=>({geodesicArea(t){const{spatialReference:i}=t;return(0,s.T5)(i,l,(t=>function(e,t){try{return(0,n.ne)(Math.abs(e.geodesicArea(t,"square-meters")),"square-meters")}catch(e){return null}}(e,t)),t)}});async function a(){const e=await Promise.all([i.e(27093),i.e(13746)]).then(i.bind(i,13746));return r(e)}function l(e){return(0,n.ne)(Math.abs((0,o.p8)([e],"square-meters")[0]),"square-meters")}},24858:function(e,t,i){"use strict";i.d(t,{Z:function(){return Q}});var n=i(73440),o=i(96711),s=i(61100),r=i(17155),a=i(90775),l=(i(61432),i(83850),i(48023)),c=i(1803),d=i(1800),u=i(46451),h=(i(55214),i(43254)),p=i(88194),y=i(87833),g=i(90403),m=i(60508),f=i(13132),v=i(48596),b=i(68578),_=i(70880),w=i(82344);let C=class extends _.Z{constructor(e){super(e),this.format=null,this.position={coordinate:null,location:null}}get displayCoordinate(){return this.format?.getDisplayCoordinate(this.position?.coordinate)}};(0,n._)([(0,r.Cb)({readOnly:!0})],C.prototype,"displayCoordinate",null),(0,n._)([(0,r.Cb)({type:w.Z})],C.prototype,"format",void 0),(0,n._)([(0,r.Cb)()],C.prototype,"position",void 0),C=(0,n._)([(0,l.j)("esri.widgets.CoordinateConversion.support.Conversion")],C);const x=C;var S=i(1985),E=i(86225),k=i(63712),L=i(12816),T=i(74765);const M="default",I="crosshair",O=new m.Z([0,0,500]),P=["mgrs","utm","usng","dd","dms","ddm"],A="esri__coordinateConversionWidgetState",R="conversions",D="formats",$="view",N="view-change";let F=class extends((0,k.Z)(y.Z.EventedAccessor)){constructor(e){super(e),this._conversionPromise=null,this._locationGraphic=null,this._pointerCount=0,this.conversions=new h.Z,this.formats=new h.Z,this.formatterAvailable=!1,this.messages=null,this.filteredFormats=new h.Z,this.locationSymbol=new v.Z({url:(0,d.V)("esri/images/search/search-symbol-32.png"),width:24,height:24}),this.storageEnabled=!0,this.storageType="session",this.view=null,this._saveWidgetState=this._saveWidgetState.bind(this),this._handleFormatChange=this._handleFormatChange.bind(this),this._handleConversionChange=this._handleConversionChange.bind(this),this._handleViewChange=this._handleViewChange.bind(this),this._onClick=this._onClick.bind(this),this._onPointerMove=this._onPointerMove.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerUp=this._onPointerUp.bind(this)}initialize(){const e=async()=>this.messages=await(0,L.ME)("esri/widgets/CoordinateConversion/t9n/CoordinateConversion");this.formats.addMany((0,E.CO)()),e().then((()=>{if(!this.destroyed&&((0,E.ke)(this.messages,this.formats),this.storageEnabled&&this._loadWidgetState(),this.formats.forEach((e=>{e.viewModel=this,this.addHandles((0,g.YP)((()=>e.currentPattern),this._saveWidgetState),e.name??"unnamed-format")})),this.addHandles(this.conversions.on("change",this._handleConversionChange),R),this.addHandles(this.formats.on("change",this._handleFormatChange),D),this.addHandles((0,T.qe)((()=>{e().then((()=>{(0,E.ke)(this.messages,this.formats)}))}))),(0,f.load)().then((()=>{this.formatterAvailable=!0})).catch((e=>{o.Z.getLogger(this).error(new p.Z("coordinate-conversion:projection-load-failed","Failed to load the projection module.",{error:e})),this.formatterAvailable=!1,this._filterFormatsAndConversions()})).then((()=>this.addHandles((0,g.YP)((()=>this.view),this._handleViewChange,g.nn),N))),0===this.conversions.length)){const e=this.formats.find((e=>"xy"===e.name))||this.formats.at(0);this.conversions.add(new x({format:e}))}}))}destroy(){this.removeHandles(),this._cleanUpView(this.view),this.view=null}castConversions(e){return this._castToConversions(e)}set currentLocation(e){this._set("currentLocation",e),this._updateConversions()}get currentLocation(){return this._get("currentLocation")||null}set mode(e){switch(e){case"capture":this.currentLocation=null,this._startCaptureMode(),this._set("mode",e);break;case"live":this._startLiveMode(),this._set("mode",e)}}get mode(){return this._get("mode")||"live"}get state(){const{messages:e,view:t}=this,i=t?.ready;return e?i?"ready":t?"loading":"disabled":"disabled"}get storage(){const{storageType:e}=this;return"session"===e?sessionStorage:localStorage}get waitingForConversions(){return null!=this._conversionPromise}setLocation(e){if(this._locationGraphic&&this.view?.graphics.remove(this._locationGraphic),!e)return;const t=e.clone();t.hasZ&&(t.z=void 0),this._locationGraphic=new u.Z({geometry:t,symbol:this.locationSymbol}),this.view?.graphics.add(this._locationGraphic)}async convert(e,t){if(!(0,S.J$)(t))throw new p.Z("coordinate-conversion:invalid-point","Invalid point cannot be converted.",{point:t});return Promise.resolve().then((()=>e.convert(t)))}async goToLocation(e){const{view:t}=this;if(!t)throw new p.Z("coordinate-conversion:go-to-failed","no view");const i="3d"===t.type?t.clippingArea:null,n=t.map?.basemap?.baseLayers;if(i||(n?.length??0)>0){const t=i??n?.at(0)?.fullExtent;if(null!=t&&!t.contains(e))throw new p.Z("coordinate-conversion:go-to-failed","Point outside basemap extent.",{point:e})}return this.callGoTo({target:e})}pause(){this.currentLocation=null,this.removeHandles($),this.view&&(this.view.cursor=M,this._locationGraphic&&this.view.graphics.remove(this._locationGraphic))}async previewConversion(e,t=this.currentLocation||O){return(await V(e,t)).displayCoordinate}resume(){"capture"===this.mode?this._startCaptureMode():this._startLiveMode()}reverseConvert(e,t){return t.reverseConvert(e)}async updateConversions(e,t){if("point"!==t?.type)throw this._clearConversions(this.conversions),new p.Z("coordinate-conversion:invalid-input-point","Point is invalid, conversions cannot be updated.",{point:t});return this._convertMany(e,t)}_castToConversions(e){const t=new h.Z;return e.forEach((e=>{let i=null;if(e instanceof x)i=e;else if("string"==typeof e){const t=this.formats.find((t=>t.name===e));t&&(i=new x({format:t}))}i&&t.add(i)})),t}_cleanUpView(e){e&&(this._locationGraphic&&e.graphics.remove(this._locationGraphic),this.removeHandles($),e.cursor=M)}_clearConversions(e){e.forEach((e=>{e.position={location:null,coordinate:null}}))}async _convertMany(e,t){return Promise.all(e.map((e=>V(e,t))))}_handleConversionChange(e){for(const t of e.added){const{format:e}=t;e&&(e.viewModel=this,this.currentLocation&&(this._set("waitingForConversions",!0),this.convert(e,this.currentLocation).then((e=>{t.position=e,this._set("waitingForConversions",!1)}))))}this._saveWidgetState()}_handleFormatChange(e){e.added.forEach((e=>{this.addHandles((0,g.YP)((()=>e.currentPattern),this._saveWidgetState),e.name??"unnamed-format"),e.viewModel=this})),e.removed.forEach((e=>{e.viewModel=null;const t=this.conversions.filter((t=>t.format===e));this.conversions.removeMany(t),e.name&&this.removeHandles(e.name)}))}_loadWidgetState(){try{const e=JSON.parse(this.storage.getItem(A));e&&this._setWidgetState(e)}catch(e){o.Z.getLogger(this).error(new p.Z("coordinate-conversion:invalid-session-storage-json","Could not read from storage.",{error:e}))}}_startCaptureMode(){this.removeHandles($),this.view&&(this.view.cursor=I,this.currentLocation&&this.setLocation(this.currentLocation),this.addHandles(this.view.on("click",this._onClick),$))}_startLiveMode(){this._pointerCount=0,this.removeHandles($),this.view&&(this.view.cursor=M,this._locationGraphic&&this.view.graphics.remove(this._locationGraphic),this.addHandles([this.view.on("pointer-down",this._onPointerDown),this.view.on("pointer-up",this._onPointerUp),this.view.on("pointer-move",this._onPointerMove)],$))}_handleViewChange(e,t){t&&t!==e&&this._cleanUpView(t),e&&("capture"===this.mode?this._startCaptureMode():this._startLiveMode(),t&&this._filterFormatsAndConversions())}_onClick(e){if(0===e.button){const t=this.view?.toMap(e),i=t?.normalize();this.setLocation(i),this.currentLocation=i}}_onPointerDown(e){const{pointerType:t}=e;if(this._pointerCount++,("touch"===t||"pen"===t)&&1===this._pointerCount){const t=this.view?.toMap(e);this.currentLocation=t?.normalize()}}_onPointerMove(e){const{pointerType:t}=e;if("mouse"===t||1===this._pointerCount){const t=this.view?.toMap(e);this.currentLocation=t?.normalize()}}_onPointerUp(){this._pointerCount--}_setWidgetState(e){try{e.formats.forEach((t=>{const i=this.formats.find((e=>e.name===t.name));i&&e.locale===(0,T.Kd)()&&t.currentPattern&&(i.currentPattern=t.currentPattern),i&&t.index>=0&&this.conversions.add(new x({format:i}))}))}catch(e){o.Z.getLogger(this).warn(new p.Z("coordinate-conversion:session-storage-read-error","Could not get widget state from stored JSON.",{error:e}))}}_saveWidgetState(){if(!this.storageEnabled)return;const e=this._toJSON();try{this.storage.setItem(A,JSON.stringify({formats:e,locale:(0,T.Kd)()}))}catch(e){o.Z.getLogger(this).error(new p.Z("coordinate-conversion:local-storage-write-error","Could not write to localStorage.",{error:e}))}}async _updateConversions(){try{await this.updateConversions(this.conversions.toArray(),this.currentLocation)}catch{}}_toJSON(){return this.formats.filter((e=>{const t=e.name;return"xy"===t||"basemap"===t||(0,S.hf)(t)})).map((e=>({name:e.name,currentPattern:e.currentPattern,defaultPattern:e.defaultPattern,index:this.conversions.findIndex((t=>t.format===e))}))).sort(((e,t)=>e.index-t.index)).toArray()}_filterFormatsAndConversions(){const{formatterAvailable:e,conversions:t,formats:i}=this;e||this.addHandles((0,g.gx)((()=>this.view?.spatialReference),(e=>{const n=e.isWebMercator||e.isWGS84,o=i.filter((e=>{const{name:t}=e;return!!function(e){return P.includes(e)}(t)||"xy"===t&&!n})),s=this.filteredFormats.filter((e=>"xy"===e.name&&n&&!this.formats.includes(e))),r=t.filter((e=>o.includes(e.format)));i.removeMany(o),t.removeMany(r),this.filteredFormats.addMany(o.filter((e=>!this.filteredFormats.includes(e)))),i.addMany(s)}),{once:!0,initial:!0}),$)}};async function V(e,t){try{e.position=await(e.format?.convert(t))}catch(t){e.position=null}return e}(0,n._)([(0,r.Cb)({type:h.Z.ofType(x)})],F.prototype,"conversions",void 0),(0,n._)([(0,a.p)("conversions")],F.prototype,"castConversions",null),(0,n._)([(0,r.Cb)({type:m.Z})],F.prototype,"currentLocation",null),(0,n._)([(0,r.Cb)({type:h.Z.ofType(w.Z)})],F.prototype,"formats",void 0),(0,n._)([(0,r.Cb)()],F.prototype,"messages",void 0),(0,n._)([(0,r.Cb)()],F.prototype,"mode",null),(0,n._)([(0,r.Cb)()],F.prototype,"filteredFormats",void 0),(0,n._)([(0,r.Cb)({readOnly:!0})],F.prototype,"state",null),(0,n._)([(0,r.Cb)({types:b.jY})],F.prototype,"locationSymbol",void 0),(0,n._)([(0,r.Cb)({readOnly:!0,dependsOn:["storageType"]})],F.prototype,"storage",null),(0,n._)([(0,r.Cb)()],F.prototype,"storageEnabled",void 0),(0,n._)([(0,r.Cb)()],F.prototype,"storageType",void 0),(0,n._)([(0,r.Cb)({readOnly:!0})],F.prototype,"waitingForConversions",null),(0,n._)([(0,r.Cb)()],F.prototype,"view",void 0),F=(0,n._)([(0,l.j)("esri.widgets.CoordinateConversion.CoordinateConversionViewModel")],F);const z=F;var Z=i(84644),B=i(46512),U=i(79691),H=i(34171),G=i(80079),j=i(24225),K=i(23039),W=i(68808);const Y="esri-coordinate-conversion",q={base:Y,captureMode:`${Y}--capture-mode`,noBasemap:`${Y}--no-basemap`,popup:`${Y}__popup`,clipboardPopup:`${Y}__clipboard-popup`,conversionList:`${Y}__conversion-list`,conversionRow:`${Y}__row`,coordDisplay:`${Y}__display`,expandButton:`${Y}__expand-button`,expanded:`${Y}__conversions-view--expanded`,expandDown:`${Y}__conversions-view--expand-down`,expandUp:`${Y}__conversions-view--expand-up`,conversionsView:`${Y}__conversions-view`,rowSelect:`${Y}__select-row`,toolDisplay:`${Y}__tools`,modeToggle:`${Y}__mode-toggle`,rowButton:`${Y}__row-button`,coordinateInput:`${Y}__input-coordinate`,inputForm:`${Y}__input-form`,inputFormGroup:`${Y}__input-group`,inputSelect:`${Y}__input-select`,sectionHeading:`${Y}__heading`,patternInput:`${Y}__pattern-input`,settings:`${Y}__settings`,settingsFormGroup:`${Y}__settings-group`,settingsFormGroupHorizontal:`${Y}__settings-group-horizontal`,previewCoordinate:`${Y}__preview-coordinate`},X={settingsButton:!0,inputButton:!0,captureButton:!0,expandButton:!0};let J=class extends c.Z{constructor(e,t){super(e,t),this._popupMessage=null,this._popupTimeoutId=void 0,this._clipboardPopupTimeoutId=void 0,this._coordinateInput=null,this._badInput=!1,this._goToEnabled=!1,this._conversionFormat=null,this._settingsFormat=null,this._previewConversion=null,this._expanded=!1,this._clipboardPopupVisible=!1,this._popupVisible=!1,this._settingsVisible=!1,this._inputVisible=!1,this.headingLevel=4,this.messages=null,this.messagesCommon=null,this.orientation="auto",this.viewModel=new z,this.visibleElements={...X}}loadDependencies(){return(0,Z.h)({button:()=>Promise.resolve().then(i.bind(i,61637)),checkbox:()=>Promise.resolve().then(i.bind(i,69397)),input:()=>i.e(75014).then(i.bind(i,75014)),label:()=>Promise.resolve().then(i.bind(i,36650)),option:()=>i.e(26344).then(i.bind(i,26344)),select:()=>i.e(44015).then(i.bind(i,44015))})}get conversions(){return this.viewModel.conversions}set conversions(e){this.viewModel.conversions=e}get currentLocation(){return this.viewModel.currentLocation}set currentLocation(e){this.viewModel.currentLocation=e}get formats(){return this.viewModel.formats}set formats(e){this.viewModel.formats=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return"coordinate-system"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get mode(){return this.viewModel.mode}set mode(e){this.viewModel.mode=e}set multipleConversions(e){!1===e&&(this._expanded=!1,this.conversions.splice(1,this.conversions.length-1)),this._set("multipleConversions",e)}get multipleConversions(){const e=this._get("multipleConversions");return"boolean"!=typeof e||e}get locationSymbol(){return this.viewModel.locationSymbol}set locationSymbol(e){this.viewModel.locationSymbol=e}get storageEnabled(){return this.viewModel.storageEnabled}set storageEnabled(e){this.viewModel.storageEnabled=e}get storageType(){return this.viewModel.storageType}set storageType(e){this.viewModel.storageType=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return{...X,...e}}reverseConvert(e,t){return this.viewModel.reverseConvert(e,t)}render(){const e=this.viewModel?.state,t="disabled"===e?(0,K.u)("div",{key:"esri-coordinate__no-basemap"},this.messages?.noBasemap):null,i=!t&&this._inputVisible?this._renderInputForm():null,n=!t&&this._settingsVisible?this._renderSettings():null,o=t||i||n?null:this._renderConversionsView(),s=this._popupVisible?this._renderPopup():null,r={[q.captureMode]:"capture"===this.mode,[B.z.disabled]:"loading"===e,[q.noBasemap]:"disabled"===e};return(0,K.u)("div",{class:this.classes(q.base,B.z.widget,r)},s,t,o,n,i)}_addConversion(e){const t=e.target,i=t.selectedOption.value,n=ee(t);if(null==i||null==n)return;const o=new x({format:i});t.value="default",n>=0?(this.conversions.removeAt(n),this.conversions.add(o,n)):this.conversions.add(o)}_findSettingsFormat(){return this._settingsFormat||this.conversions.reduceRight(((e,t)=>{const i=t.format;return i?.hasDisplayProperties?i:e}),null)||this.formats.find((e=>e.hasDisplayProperties))}_hidePopup(){this._popupTimeoutId&&(clearTimeout(this._popupTimeoutId),this._popupTimeoutId=void 0),this._popupVisible=!1,this._popupMessage=null,this.scheduleRender()}_hideClipboardPopup(){this._clipboardPopupTimeoutId&&(clearTimeout(this._clipboardPopupTimeoutId),this._clipboardPopupTimeoutId=void 0),this._clipboardPopupVisible=!1,this.scheduleRender()}_onConvertComplete(){this._inputVisible=!1,this._coordinateInput.value=""}_onCopy(e){const t=function(e){return e["data-conversion"]}(e.currentTarget)?.displayCoordinate;null!=t&&(e.clipboardData?.setData("text/plain",t),this._showClipboardPopup(),e.preventDefault())}_processUserInput(e){const t=(0,s.aF)(e,"key"),i=this.viewModel;if("Enter"!==t&&t)this._badInput&&(this._badInput=!1);else{const e=this._conversionFormat||this.conversions.at(0).format;if(!e)return;const t=this._coordinateInput.value;this._reverseConvert(t,e).then((e=>{"capture"===this.mode?i.resume():this.mode="capture",this.currentLocation=e,i.setLocation(e),this._onConvertComplete()})).catch((e=>{o.Z.getLogger(this).error(e),this._showPopup(this.messages?.invalidCoordinate),this._badInput=!0}))}}async _reverseConvert(e,t){const i=this.viewModel,n=await t.reverseConvert(e);return this._goToEnabled&&n&&i.goToLocation(n).catch((e=>{o.Z.getLogger(this).warn(e),this._showPopup(this.messages?.locationOffBasemap)})),n}_setInputFormat(e){const t=e.target.selectedOption.value;null!=t&&(this._conversionFormat=t)}_setPreviewConversion(){const e=this._findSettingsFormat(),t=this.viewModel;if(e){const i=this.conversions.find((t=>t.format===e));this._previewConversion=new x({format:e,position:{location:this.currentLocation,coordinate:i?.position?.coordinate}}),this._previewConversion.position?.coordinate||t.previewConversion(this._previewConversion)}}_setSettingsFormat(e){const t=e.target.selectedOption.value;null!=t&&(this._settingsFormat=t,this._setPreviewConversion())}_showClipboardPopup(){this._clipboardPopupVisible?clearTimeout(this._clipboardPopupTimeoutId):this._clipboardPopupVisible=!0,this.scheduleRender(),this._popupTimeoutId=setTimeout((()=>{this._popupTimeoutId=void 0,this._hideClipboardPopup()}),750)}_showPopup(e,t=2500){this._popupMessage=e,this._popupVisible?clearTimeout(this._popupTimeoutId):this._popupVisible=!0,this.scheduleRender(),this._popupTimeoutId=setTimeout((()=>{this._popupTimeoutId=void 0,this._hidePopup()}),t)}_toggleGoTo(){this._goToEnabled=!this._goToEnabled}_updateCurrentPattern(e){e.stopPropagation();const t=e.target,i=this._findSettingsFormat();i&&(i.currentPattern=t.value)}_renderConversion(e,t){const{messages:i}=this;if(!i)return(0,K.u)("li",null);const{format:n}=e,o=n?.label??"",s=`${this.id}__list-item-${t}`,r=`${o} ${i.conversionOutputSuffix}`,a=0===t,l=a||this._expanded,c=a?this._renderFirstConversion(e):this._renderTools(t,e,s),d=a&&!e.displayCoordinate?i.noLocation:e.displayCoordinate,u=(0,K.u)("div",{"aria-label":d,class:q.coordDisplay,"data-conversion":e,role:"listitem",tabIndex:0,title:d??""},d),h=this._renderOptions(this.formats.filter((e=>e!==n)));return l?(0,K.u)("li",{"aria-label":r,class:q.conversionRow,id:s,key:e,role:"group",tabIndex:0,title:r},(0,K.u)("calcite-select",{"aria-controls":s,bind:this,class:q.rowSelect,"data-index":t,label:i.selectFormat,scale:"s",onCalciteSelectChange:this._addConversion},(0,K.u)("calcite-option",{label:o.toUpperCase(),selected:!0},o.toUpperCase()),h),u,c):null}_renderCopyButton(e){const t=this._clipboardPopupVisible&&this._renderClipboardPopup(),{messagesCommon:i}=this;return i?(0,K.u)("li",{"aria-label":i.copy,bind:this,class:this.classes(B.z.widgetButton,q.rowButton),"data-conversion":e,onclick:this._copyCoordinateOutput,oncopy:this._onCopy,onkeydown:this._copyCoordinateOutput,role:"button",tabIndex:0,title:i.copy},t,(0,K.u)("span",{"aria-hidden":"true",class:H.W.duplicate})):(0,K.u)("li",null)}_renderFirstConversion(e){const t=this.id,{messages:i,messagesCommon:n,multipleConversions:o,visibleElements:s}=this;if(!n||!i)return(0,K.u)("ul",null);const r="live"===this.mode?i.captureMode:i.liveMode,a=this._expanded?n.collapse:n.expand,l=e.displayCoordinate&&"capture"===this.mode?this._renderCopyButton(e):null,c=o&&s.expandButton&&this._renderIconButton({iconType:this._expanded?"chevron-down":"chevron-up",clickFunction:this._toggleExpand,classes:[q.expandButton],attributes:{"aria-controls":`${t}__${q.conversionList}`,label:a}}),d=!o&&s.captureButton&&this._renderIconButton({iconType:"live"===this.mode?"pin-tear":"pin-tear-f",clickFunction:this._toggleMode,classes:[q.modeToggle],attributes:{label:r}});return(0,K.u)("ul",{class:q.toolDisplay},l,c,d)}_renderInputForm(){const e=this._conversionFormat||this.conversions.at(0).format,t=this.formats.findIndex((t=>t.name===e?.name)),i=this.id,n=`${i}__${q.coordinateInput}`,o=`${i}__${q.coordinateInput}__header`,s=this._renderOptions(this.formats,!0,t),{messages:r,messagesCommon:a,headingLevel:l}=this;if(!a||!r)return(0,K.u)("div",null);const c=this._renderIconButton({iconType:(0,W.dZ)(this.container)?"arrow-right":"arrow-left",clickFunction:this._toggleInputVisibility,attributes:{label:a.back}});return(0,K.u)("div",{"aria-labelledby":o,class:q.inputForm,key:"esri-coordinate-conversion__input-form",role:"search"},(0,K.u)("div",{class:q.sectionHeading},c,(0,K.u)(U.X,{class:B.z.heading,id:o,level:l},r.inputCoordTitle)),(0,K.u)("div",{class:q.inputFormGroup},(0,K.u)("calcite-select",{"aria-controls":n,bind:this,class:q.inputSelect,label:r.selectFormat,scale:"s",onCalciteSelectChange:this._setInputFormat},s),(0,K.u)("calcite-input",{afterCreate:W.Yo,"aria-labelledby":o,bind:this,class:q.coordinateInput,"data-format":e,"data-node-ref":"_coordinateInput",id:n,onkeydown:this._processUserInput,placeholder:r.inputCoordTitle,required:!0,scale:"s",spellcheck:!1,status:this._badInput?"invalid":"idle"})),(0,K.u)("div",{class:q.inputFormGroup},(0,K.u)("calcite-label",{layout:"inline",scale:"s"},(0,K.u)("calcite-checkbox",{bind:this,checked:this._goToEnabled,onCalciteCheckboxChange:this._toggleGoTo}),r.goTo),(0,K.u)("calcite-button",{appearance:"outline",bind:this,kind:"neutral",onclick:this._processUserInput,type:"button",width:"auto"},r.convert)))}_renderConversionsView(){const{messages:e}=this;if(!e)return(0,K.u)("div",null);const t=`${this.id}__${q.conversionList}`,i=this._renderPrimaryTools(),n=this._renderOptions(this.formats),o=this.conversions.map(((e,t)=>this._renderConversion(e,t))).toArray(),s=this._expanded?(0,K.u)("div",{class:q.conversionRow},(0,K.u)("calcite-select",{"aria-controls":t,bind:this,"data-index":-1,label:e.addConversion,scale:"s",onCalciteSelectChange:this._addConversion},(0,K.u)("calcite-option",{disabled:!0,selected:!0,value:"default"},e.addConversion),n),i):null,r={[q.expanded]:this._expanded,[q.expandUp]:"expand-up"===this.orientation,[q.expandDown]:"expand-down"===this.orientation};return(0,K.u)("div",{class:this.classes(q.conversionsView,r),key:"esri-coordinate-conversion__main-view"},(0,K.u)("ul",{"aria-expanded":this._expanded?"true":"false",class:q.conversionList,id:t},o),s)}_renderOptions(e,t,i){const n=this.conversions.at(0),o=n.format?.name;return e.map(((e,s)=>{const r=!(t||!n)&&(o===e.name||this.conversions.map((e=>e.format?.name)).includes(e.name));return(0,K.u)("calcite-option",{disabled:r,key:e.name??"unnamed-format",label:e.label.toUpperCase(),selected:s===i,value:e},e.label)})).toArray()}_renderPopup(){return(0,K.u)("div",{class:q.popup,role:"alert"},this._popupMessage)}_renderClipboardPopup(){const{messages:e}=this;return e?(0,K.u)("div",{class:this.classes(q.popup,q.clipboardPopup),role:"alert"},e.copySuccessMessage):(0,K.u)("div",null)}_renderPrimaryTools(){const{messages:e,visibleElements:t}=this;if(!e)return(0,K.u)("ul",null);const i="live"===this.mode?e.captureMode:e.liveMode,n=t.inputButton&&this._renderIconButton({iconType:"pencil",clickFunction:this._toggleInputVisibility,attributes:{label:e.inputCoordTitle}}),o=t.captureButton&&this._renderIconButton({iconType:"live"===this.mode?"pin-tear":"pin-tear-f",clickFunction:this._toggleMode,classes:[q.modeToggle],attributes:{label:i}}),s=t.settingsButton&&this._renderIconButton({iconType:"gear",clickFunction:this._toggleSettingsVisibility,attributes:{label:e.settingsTitle}});return(0,K.u)("ul",{class:q.toolDisplay},n,o,s)}_renderSettings(){const e=this.id,t=`${e}__${q.patternInput}`,i=`${e}__${q.patternInput}__header`,n=`${e}__${q.previewCoordinate}`,o=this.formats.filter((e=>e.hasDisplayProperties)),s=this._findSettingsFormat(),r=s?o.indexOf(s):-1,a=this._renderOptions(o,!0,r),l=s?.currentPattern,{messages:c,messagesCommon:d,headingLevel:u}=this;if(!d||!c)return(0,K.u)("div",null);const h=this._renderIconButton({iconType:(0,W.dZ)(this.container)?"arrow-right":"arrow-left",clickFunction:this._toggleSettingsVisibility,attributes:{label:d.back}}),p=this._renderIconButton({iconType:"reset",clickFunction:this._setDefaultPattern,attributes:{label:c.defaultPattern}});return(0,K.u)("div",{"aria-labelledby":i,class:q.settings,key:q.settings},(0,K.u)("div",{class:q.sectionHeading},h,(0,K.u)(U.X,{class:B.z.heading,id:i,level:u},c.settingsTitle)),(0,K.u)("div",{class:q.settingsFormGroup},(0,K.u)("label",{for:t},c.changeCoordinateDisplay),(0,K.u)("calcite-select",{bind:this,label:c.selectFormat,width:"full",onCalciteSelectChange:this._setSettingsFormat},a),(0,K.u)("div",{class:q.settingsFormGroupHorizontal},(0,K.u)("calcite-input",{"aria-controls":n,bind:this,class:q.patternInput,id:t,spellcheck:!1,type:"text",value:l,onCalciteInputInput:this._updateCurrentPattern}),p)),(0,K.u)("div",{class:q.settingsFormGroup},(0,K.u)("label",null,d.preview,(0,K.u)("div",{class:q.previewCoordinate,id:n,tabIndex:0},this._previewConversion?.displayCoordinate))))}_renderIconButton(e){const{iconType:t,clickFunction:i,classes:n,attributes:o}=e;return(0,K.u)("calcite-button",{appearance:"transparent",bind:this,class:this.classes(n),iconStart:t,kind:"neutral",onclick:i,onkeydown:i,...o})}_renderTools(e,t,i){const n=t.displayCoordinate&&"capture"===this.mode?this._renderCopyButton(t):null,{messages:o}=this;if(!o)return(0,K.u)("ul",null);const s=this._renderIconButton({iconType:"x",clickFunction:this._removeConversion,attributes:{"aria-controls":i,label:o.removeConversion,"data-index":e}});return(0,K.u)("ul",{class:q.toolDisplay,role:"listitem"},n,(0,K.u)("li",{class:this.classes(q.rowButton)},s))}_copyCoordinateOutput(e){const t=e.target;if(!("createTextRange"in document.body)){const e=window.getSelection(),i=document.createRange();i.selectNodeContents(t),e?.removeAllRanges(),e?.addRange(i)}document.execCommand("copy")}_removeConversion(e){const t=ee(e.currentTarget);null!=t&&this.conversions.removeAt(t)}_setDefaultPattern(e){e.stopPropagation();const t=this._findSettingsFormat();t&&(t.currentPattern=t.defaultPattern)}_toggleExpand(){this._expanded=!this._expanded}_toggleInputVisibility(){this._inputVisible=!this._inputVisible,this._popupVisible&&this._hidePopup(),this._inputVisible?this.viewModel.pause():this.viewModel.resume()}_toggleMode(){this.mode="live"===this.mode?"capture":"live"}_toggleSettingsVisibility(){this._settingsVisible=!this._settingsVisible,this._popupVisible&&this._hidePopup(),this._settingsVisible?(this._setPreviewConversion(),this.viewModel.pause()):this.viewModel.resume()}};(0,n._)([(0,r.Cb)()],J.prototype,"conversions",null),(0,n._)([(0,r.Cb)()],J.prototype,"currentLocation",null),(0,n._)([(0,r.Cb)()],J.prototype,"formats",null),(0,n._)([(0,r.Cb)()],J.prototype,"goToOverride",null),(0,n._)([(0,r.Cb)()],J.prototype,"headingLevel",void 0),(0,n._)([(0,r.Cb)()],J.prototype,"icon",null),(0,n._)([(0,r.Cb)()],J.prototype,"label",null),(0,n._)([(0,r.Cb)(),(0,j.H)("esri/widgets/CoordinateConversion/t9n/CoordinateConversion")],J.prototype,"messages",void 0),(0,n._)([(0,r.Cb)(),(0,j.H)("esri/t9n/common")],J.prototype,"messagesCommon",void 0),(0,n._)([(0,r.Cb)()],J.prototype,"mode",null),(0,n._)([(0,r.Cb)()],J.prototype,"orientation",void 0),(0,n._)([(0,r.Cb)()],J.prototype,"multipleConversions",null),(0,n._)([(0,r.Cb)()],J.prototype,"locationSymbol",null),(0,n._)([(0,r.Cb)()],J.prototype,"storageEnabled",null),(0,n._)([(0,r.Cb)()],J.prototype,"storageType",null),(0,n._)([(0,r.Cb)()],J.prototype,"view",null),(0,n._)([(0,r.Cb)({type:z})],J.prototype,"viewModel",void 0),(0,n._)([(0,r.Cb)()],J.prototype,"visibleElements",void 0),(0,n._)([(0,a.p)("visibleElements")],J.prototype,"castVisibleElements",null),(0,n._)([(0,G.h)()],J.prototype,"_copyCoordinateOutput",null),(0,n._)([(0,G.h)()],J.prototype,"_removeConversion",null),(0,n._)([(0,G.h)()],J.prototype,"_setDefaultPattern",null),(0,n._)([(0,G.h)()],J.prototype,"_toggleExpand",null),(0,n._)([(0,G.h)()],J.prototype,"_toggleInputVisibility",null),(0,n._)([(0,G.h)()],J.prototype,"_toggleMode",null),(0,n._)([(0,G.h)()],J.prototype,"_toggleSettingsVisibility",null),J=(0,n._)([(0,l.j)("esri.widgets.CoordinateConversion")],J);const Q=J;function ee(e){return e["data-index"]}},82344:function(e,t,i){"use strict";i.d(t,{Z:function(){return g}});var n=i(73440),o=i(70880),s=i(88194),r=(i(61432),i(17155)),a=(i(96711),i(83850),i(48023)),l=i(17256),c=i(13132),d=i(45213),u=i(8554),h=i(97290),p=i(1985);let y=class extends o.Z{constructor(e){super(e),this.conversionInfo=null,this.coordinateSegments=null,this._currentPattern=void 0,this.defaultPattern=null,this.name=null,this.viewModel=null}get currentPattern(){return(this._currentPattern||this.defaultPattern)??""}set currentPattern(e){this._currentPattern=e}get label(){return this.name??""}set label(e){this._overrideIfSome("label",e)}get hasDisplayProperties(){return!(!this.defaultPattern||!this.coordinateSegments)}get spatialReference(){return"basemap"===this.name?this._viewSpatialReference:this.conversionInfo?.spatialReference??d.Z.WGS84}set spatialReference(e){this._overrideIfSome("spatialReference",e)}get _viewSpatialReference(){return this.viewModel?.view?.spatialReference??d.Z.WGS84}get _additionalCharactersPattern(){const e=this.coordinateSegments;if(!e)return null;const t=e.map((e=>e.alias)),i=this.currentPattern.replaceAll(new RegExp(`["nsew${t.join()}]`,"gi"),"").replaceAll(" ","");return new RegExp(`[${i}]`,"g")}get test(){}async convert(e){if(!(0,p.J$)(e))throw new s.Z("format:invalid-point","Could not convert invalid point.",{point:e});const t=this.conversionInfo?.convert;if(t)return Promise.resolve().then((()=>t(e)));const i=await this._project(e,this.spatialReference);return{location:i,coordinate:await this._getCoordinate(i)}}getConversionStrategy(){const e=this._viewSpatialReference;return this.conversionInfo?.convert||this.viewModel?.formatterAvailable||"xy"===this.name&&(e.isWebMercator||e.isWGS84)||"basemap"===this.name?"client":"server"}getDisplayCoordinate(e){if(!e)return null;if(!this.coordinateSegments||!this.currentPattern)return e;let t=this.currentPattern;const i=this._getSegmentMatches(e,!1);for(let e=this.coordinateSegments.length-1;e>=0;e--){const n=this.coordinateSegments[e];t=t.replace(n.alias,i[e])}return t}_parseUserInput(e){const{defaultPattern:t,_additionalCharactersPattern:i,coordinateSegments:n}=this;if(!t||!i)return"";let o=t.replace(i,"");e=e.replace(i,"");const s=this._getSegmentMatches(e,!0);if(n)for(let e=n.length-1;e>=0;e--){const t=n[e];o=o.replace(t.alias,s[e])}return o}_getSegmentMatches(e,t){const i=new Array,{coordinateSegments:n}=this;if(!n)return i;for(let o=0;o<n.length;o++){const s=n[o],r=e.match(s.searchPattern);if(!r){i.push("");continue}let a=r[0];if(e=e.replace(a,"").trim(),s.substitution){const e=t?s.substitution.input(a):s.substitution.output(a);e&&(a=`${e}`)}i.push(a)}return i}async reverseConvert(e){const t=this._parseUserInput(e),i=this.conversionInfo?.reverseConvert;let n;if(i)n=i(t);else if("xy"===this.name||"basemap"===this.name)n=(0,p.mv)(t,this.spatialReference);else if(this.viewModel?.formatterAvailable)switch(this.name){case"dd":case"ddm":case"dms":n=(0,l.QU)(t,this.spatialReference);break;case"mgrs":{const e="automatic";n=(0,l.BZ)(t,this.spatialReference,e);break}case"utm":{const e="latitude-band-indicators";n=(0,l.DR)(t,this.spatialReference,e);break}case"usng":n=(0,l.cZ)(t,this.spatialReference);break;default:n=null}if(!n)throw new s.Z("format:invalid-input","Could not parse input into point.",{userInput:e});return this._project(n,this._viewSpatialReference)}async _getCoordinate(e){const t=this.viewModel?.view?.scale??0;if(!(0,p.J$)(e))throw new s.Z("format:invalid-point","Could not transform invalid point into coordinate.",{point:e});if(this.viewModel?.formatterAvailable||"basemap"===this.name||"xy"===this.name)switch(this.name){case"dd":case"ddm":case"dms":{const i=(0,p.GG)(t);return(0,l.Ow)(e,this.name,i)}case"mgrs":return(0,l.$B)(e,"automatic",5,!1);case"usng":return(0,l.on)(e,5,!1);case"utm":return(0,l.$i)(e,"latitude-band-indicators",!0);default:return(0,p.zq)(e,t)}return(0,p.zq)(e,t)}async _project(e,t){if((0,u.fS)(e.spatialReference,t)||!t)return e;if(this.viewModel?.formatterAvailable&&(0,c.isLoaded)())return(0,c.project)(e,t);if(!this.viewModel?.formatterAvailable){const i=(0,h.iV)(e,t);if(null!=i)return i}return null}};(0,n._)([(0,r.Cb)()],y.prototype,"conversionInfo",void 0),(0,n._)([(0,r.Cb)()],y.prototype,"coordinateSegments",void 0),(0,n._)([(0,r.Cb)()],y.prototype,"currentPattern",null),(0,n._)([(0,r.Cb)()],y.prototype,"_currentPattern",void 0),(0,n._)([(0,r.Cb)()],y.prototype,"label",null),(0,n._)([(0,r.Cb)()],y.prototype,"defaultPattern",void 0),(0,n._)([(0,r.Cb)({readOnly:!0})],y.prototype,"hasDisplayProperties",null),(0,n._)([(0,r.Cb)()],y.prototype,"name",void 0),(0,n._)([(0,r.Cb)({type:d.Z})],y.prototype,"spatialReference",null),(0,n._)([(0,r.Cb)()],y.prototype,"viewModel",void 0),(0,n._)([(0,r.Cb)({readOnly:!0})],y.prototype,"_viewSpatialReference",null),(0,n._)([(0,r.Cb)({readOnly:!0})],y.prototype,"_additionalCharactersPattern",null),y=(0,n._)([(0,a.j)("esri.widgets.CoordinateConversion.support.Format")],y);const g=y},1985:function(e,t,i){"use strict";i.d(t,{GG:function(){return r},J$:function(){return c},hf:function(){return h},mv:function(){return a},zq:function(){return d}});var n=i(60508),o=i(45213);function s(e,t){const i=r(t);return[e[0].toFixed(i),e[1].toFixed(i)]}function r(e){return e>=500?6:e<500&&e>=50?7:e<50&&e>=5?8:9}function a(e,t){const i=e.includes(",")?",":" ",[s,r,a]=e.split(i).map((e=>{const t=e.trim();return t?Number(t):null}));if(!l(s)||!l(r))return null;const c=new n.Z({x:s,y:r,spatialReference:t||o.Z.WGS84});return a&&(c.z=a,c.hasZ=!0),c}function l(e){return"number"==typeof e&&isFinite(e)}function c(e){return!!e&&l(e.x)&&l(e.y)}function d(e,t){if(e.spatialReference.isGeographic&&t){const[i,n]=s([e.x,e.y],t);return`${i}, ${n}`}return`${e.x.toFixed(3)}, ${e.y.toFixed(3)}`}const u=["dd","dms","ddm","mgrs","usng","utm"];function h(e){return u.includes(e)}},86225:function(e,t,i){"use strict";i.d(t,{A4:function(){return l},CO:function(){return h},ke:function(){return u}});var n=i(87864),o=i(74765),s=i(82344);const r=(0,n.ti)().decimal,a={N:"north",S:"south",E:"east",W:"west"},l="",c=new RegExp(`-?\\d+[\\.|\\${r}]?\\d*`),d=/^[\\0]+(?=\d)/;function u(e,t){const i="ar"===(0,o.Kd)(),s=e.abbreviatedDirections.north,r=e.abbreviatedDirections.south,c=e.abbreviatedDirections.east,d=e.abbreviatedDirections.west,u=(0,n.ti)().decimal,h={[s]:"N",[r]:"S",[c]:"E",[d]:"W"},g=new RegExp(`-?\\d+[\\.|\\${u}]?\\d*`),m=new RegExp(`N|S|${s}|${r}`,"i"),f=new RegExp(`E|W|${c}|${d}`,"i"),v={ddm:`Y${l} A'${e.abbreviatedDirections.north}, X${l} B'${e.abbreviatedDirections.east}`,dms:`Y${l} A' B"${e.abbreviatedDirections.north}, X${l} C' D"${e.abbreviatedDirections.east}`,dd:`Y${l}${e.abbreviatedDirections.north}, X${l}${e.abbreviatedDirections.east}`,xy:`X${l}, Y${l}`,basemap:"X, Y"},b={ddm:`${e.abbreviatedDirections.north}${l}Y 'A ,${e.abbreviatedDirections.east}${l}X 'B`,dms:`${e.abbreviatedDirections.north}${l}Y 'A "B ,${e.abbreviatedDirections.east}${l}X 'C "D`,dd:`${e.abbreviatedDirections.north}${l}Y ,${e.abbreviatedDirections.east}${l}X`,xy:`X${l} ,Y${l}`,basemap:"X ,Y"},_=new RegExp(`\\d{1,2}[\\.|\\${u}]?\\d*`,"i"),w=new RegExp(`\\d{1,3}[\\.|\\${u}]?\\d*`,"i");t.forEach((t=>{const{name:n}=t;if("dd"===n?t.coordinateSegments=[{alias:"Y",description:"degrees latitude",searchPattern:_,substitution:{input:e=>y(e),output:e=>p(e)}},{alias:e.abbreviatedDirections.north,description:"north/south indicator",searchPattern:m,substitution:{input:e=>h[e],output:t=>e.abbreviatedDirections[a[t]]}},{alias:"X",description:"degrees longitude",searchPattern:w,substitution:{input:e=>y(e),output:e=>p(e)}},{alias:e.abbreviatedDirections.east,description:"east/west indicator",searchPattern:f,substitution:{input:e=>h[e],output:t=>e.abbreviatedDirections[a[t]]}}]:"ddm"===n?t.coordinateSegments=[{alias:"Y",description:"degrees latitude",searchPattern:_,substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"A",description:"minutes latitude",searchPattern:_,substitution:{input:e=>y(e),output:e=>p(e)}},{alias:e.abbreviatedDirections.north,description:"north/south indicator",searchPattern:m,substitution:{input:e=>h[e],output:t=>e.abbreviatedDirections[a[t]]}},{alias:"X",description:"degrees longitude",searchPattern:w,substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"B",description:"minutes longitude",searchPattern:_,substitution:{input:e=>y(e),output:e=>p(e)}},{alias:e.abbreviatedDirections.east,description:"east/west indicator",searchPattern:f,substitution:{input:e=>h[e],output:t=>e.abbreviatedDirections[a[t]]}}]:"dms"===n?t.coordinateSegments=[{alias:"Y",description:"degrees latitude",searchPattern:_,substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"A",description:"minutes latitude",searchPattern:_,substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"B",description:"seconds latitude",searchPattern:_,substitution:{input:e=>y(e),output:e=>p(e)}},{alias:e.abbreviatedDirections.north,description:"north/south indicator",searchPattern:m,substitution:{input:e=>h[e],output:t=>e.abbreviatedDirections[a[t]]}},{alias:"X",description:"degrees longitude",searchPattern:w,substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"C",description:"minutes longitude",searchPattern:_,substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"D",description:"seconds longitude",searchPattern:_,substitution:{input:e=>y(e),output:e=>p(e)}},{alias:e.abbreviatedDirections.east,description:"east/west indicator",searchPattern:f,substitution:{input:e=>h[e],output:t=>e.abbreviatedDirections[a[t]]}}]:("xy"===t.name||"basemap"===t.name)&&(t.coordinateSegments=[{alias:"X",description:"easting",searchPattern:g,substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"Y",description:"northing",searchPattern:g,substitution:{input:e=>y(e),output:e=>p(e)}}]),(e=>null!=e&&Object.keys(v).includes(e))(n)){const e=i?b[n]:v[n];t.defaultPattern=e,t.currentPattern=e}}))}function h(){const e=new RegExp("N|S","i"),t=new RegExp("E|W","i");return[new s.Z({name:"basemap",coordinateSegments:[{alias:"X",description:"easting",searchPattern:c,substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"Y",description:"northing",searchPattern:c,substitution:{input:e=>y(e),output:e=>p(e)}}],defaultPattern:"X, Y",viewModel:null}),new s.Z({name:"dd",coordinateSegments:[{alias:"Y",description:"degrees latitude",searchPattern:new RegExp(`\\d{1,2}[\\.|\\${r}]?\\d*(?=\\D*?[N|S])`,"i"),substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"N",description:"north/south indicator",searchPattern:e},{alias:"X",description:"degrees longitude",searchPattern:new RegExp(`\\d{1,3}[\\.|\\${r}]?\\d*(?=\\D*?[E|W|])`,"i"),substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"E",description:"east/west indicator",searchPattern:t}],defaultPattern:`Y${l}N, X${l}E`,viewModel:null}),new s.Z({name:"ddm",coordinateSegments:[{alias:"Y",description:"degrees latitude",searchPattern:new RegExp("\\d{1,2}(?=.*?\\s+.*?[N|S])","i"),substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"A",description:"minutes latitude",searchPattern:new RegExp(`\\d{1,2}[\\.\\${r}]?\\d*(?=.*?[N|S])`,"i"),substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"N",description:"north/south indicator",searchPattern:e},{alias:"X",description:"degrees longitude",searchPattern:new RegExp("\\d{1,3}(?=\\D*?\\s+.*?[E|W])","i"),substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"B",description:"minutes longitude",searchPattern:new RegExp(`\\d{1,2}[\\.|\\|${r}]?\\d*(?=.*?[E|W])`,"i"),substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"E",description:"east/west indicator",searchPattern:t}],defaultPattern:`Y${l} A'N, X${l} B'E`,viewModel:null}),new s.Z({name:"dms",coordinateSegments:[{alias:"Y",description:"degrees latitude",searchPattern:new RegExp("\\d{1,2}(?=.*?\\s+.*?[N|S])","i"),substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"A",description:"minutes latitude",searchPattern:new RegExp("\\d{1,2}(?=.*?[N|S])","i"),substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"B",description:"seconds latitude",searchPattern:new RegExp(`\\d{1,2}[\\.|\\${r}]?\\d*(?=.*?[N|S])`,"i"),substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"N",description:"north/south indicator",searchPattern:e},{alias:"X",description:"degrees longitude",searchPattern:new RegExp("\\d{1,3}(?=.*?\\s+.*?[E|W])","i"),substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"C",description:"minutes longitude",searchPattern:new RegExp("\\d{1,2}(?=.*?[E|W])","i"),substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"D",description:"seconds longitude",searchPattern:new RegExp(`\\d{1,2}[\\.|\\${r}]?\\d*(?=.*?[E|W])`,"i"),substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"E",description:"east/west indicator",searchPattern:t}],defaultPattern:`Y${l} A' B"N, X${l} C' D"E`,viewModel:null}),new s.Z({name:"xy",coordinateSegments:[{alias:"X",description:"longitude",searchPattern:c,substitution:{input:e=>y(e),output:e=>p(e)}},{alias:"Y",description:"latitude",searchPattern:c,substitution:{input:e=>y(e),output:e=>p(e)}}],defaultPattern:`X${l}, Y${l}`,viewModel:null}),new s.Z({name:"mgrs",coordinateSegments:[{alias:"Z",description:"grid zone",searchPattern:/\d{1,2}\w|[abyz]/i},{alias:"S",description:"grid square",searchPattern:/\w{2}/},{alias:"X",description:"easting",searchPattern:/^\d{5}(?=.?\d{5}$)|^\d{4}(?=.?\d{4}$)|^\d{3}(?=.?\d{3}$)|^\d{2}(?=.?\d{2}$)|^\d(?=.?\d$)/},{alias:"Y",description:"northing",searchPattern:/^\d{1,5}/}],defaultPattern:"Z S X Y",viewModel:null}),new s.Z({name:"usng",coordinateSegments:[{alias:"Z",description:"grid zone",searchPattern:/\d{1,2}\w|[abyz]/i},{alias:"S",description:"grid square",searchPattern:/\w{2}/},{alias:"X",description:"easting",searchPattern:/^\d{5}(?=.?\d{5}$)|^\d{4}(?=.?\d{4}$)|^\d{3}(?=.?\d{3}$)|^\d{2}(?=.?\d{2}$)|^\d(?=.?\d$)/},{alias:"Y",description:"northing",searchPattern:/^\d{1,5}/}],defaultPattern:"Z S X Y",viewModel:null}),new s.Z({name:"utm",coordinateSegments:[{alias:"Z",description:"zone number",searchPattern:/\d{1,2}|[abyz]/i},{alias:"B",description:"latitude band",searchPattern:/^\D/},{alias:"X",description:"easting",searchPattern:/\d{1,7}(?=\s*\d{7}$)/},{alias:"Y",description:"northing",searchPattern:/\d{1,7}/}],defaultPattern:"ZB X Y",viewModel:null})]}function p(e){const t=e.match(d),i=t?t[0]:"",o=e.includes(".")?e.split(".")[1].length:0;return i+(0,n.WU)(Number(e),{pattern:"###0.###",places:o,round:-1})}function y(e){return(0,n.Qc)(e)}},59339:function(e,t,i){"use strict";i.d(t,{Z:function(){return m}});var n,o=i(73440),s=(i(55214),i(17155)),r=(i(61432),i(96711),i(83850),i(48023)),a=i(82114),l=i(89617),c=i(1803),d=i(5221),u=i(84644),h=i(23039),p=i(68808),y=i(37964);let g=class extends c.Z{static{n=this}constructor(e){super(e),this.dragEnabled=!1,this.listModeDisabled=!1,this.parent=null,this.parentTitles=null,this.viewModel=null,this._onActionMenuOpen=e=>{this.item.actionsOpen=e.currentTarget.open},this._setTooltipReference=e=>{this.onTooltipReferenceChange?.(this.item.layer?.uid,e)},this._removeTooltipReference=()=>{this.onTooltipReferenceChange?.(this.item.layer?.uid,null)}}loadDependencies(){return(0,u.h)({"action-group":()=>Promise.all([i.e(62737),i.e(32029),i.e(79767),i.e(22655)]).then(i.bind(i,22655)),"action-menu":()=>Promise.all([i.e(62737),i.e(32029),i.e(79767)]).then(i.bind(i,79767)),action:()=>i.e(77606).then(i.bind(i,11030)),icon:()=>Promise.resolve().then(i.bind(i,4204)),"list-item":()=>Promise.all([i.e(62737),i.e(8112),i.e(96326)]).then(i.bind(i,96326)),list:()=>Promise.all([i.e(75014),i.e(29749)]).then(i.bind(i,29749)),notice:()=>i.e(16615).then(i.bind(i,40473))})}static{this.vnodeSelector="calcite-list-item"}render(){const e=this.parentTitles??[],{_title:t,item:i,activeItem:n,selectionMode:o,selectedItems:s,messages:r,parent:a,css:l,dragDisabled:c}=this,d="visibleAtCurrentTimeExtent"in i&&"layerInvisibleAtTime"in r&&!i.visibleAtCurrentTimeExtent?`${t} (${r.layerInvisibleAtTime})`:"visibleAtCurrentScale"in i&&"layerInvisibleAtScale"in r&&!i.visibleAtCurrentScale?`${t} (${r.layerInvisibleAtScale})`:t,u="parent"in i&&"catalog"===i.parent?.layer?.type,{layer:p}=i,y="visibleAtCurrentScale"in i&&!i.visibleAtCurrentScale||"visibleAtCurrentTimeExtent"in i&&!i.visibleAtCurrentTimeExtent;return(0,h.u)("calcite-list-item",{afterCreate:e=>this._focusSelectedDragEl(e,i),afterUpdate:e=>this._focusSelectedDragEl(e,i),class:this.classes(l.item,"itemActive"in l&&{[l.itemActive]:n===i}),"data-item":i,"data-layer-id":p?.id,dragDisabled:!i.sortable||u||c,expanded:"open"in i&&i.open,id:p?.uid,key:`list-item-${p?.uid}`,label:t,metadata:{parentTitles:e,_title:t},selected:"none"!==o&&s.includes(i),title:d,unavailable:y,value:p?.uid,onCalciteListItemSelect:e=>"visible"in i&&this._handleCalciteListItemSelect(e,i,a),onCalciteListItemToggle:e=>"open"in i&&this._handleCalciteListItemToggle(e,i)},this._renderedCatalogFootprintIcon,this._renderedCatalogDynamicIcon,this._renderedItemStatus,this._renderedItemToggle,this._renderedCatalogSelectNode,this._renderedItemTemporaryIcon,this._renderedChildList,this._renderedItemMessage,this._renderedPanel,this._renderedPanelAction,this._renderedActions)}get _title(){const{messages:e}=this;return this.item.title||("untitledTable"in e?e.untitledTable:e.untitledLayer)}get _renderedItemStatus(){const{item:e,parent:t,visibleElements:i,css:n}=this;if(!i.statusIndicators)return null;const{publishing:o}=e,s="updating"in e&&e.updating&&!t,r="connectionStatus"in e?e.connectionStatus:void 0,a=!!r;return(0,h.u)("calcite-icon",{class:this.classes(n.statusIndicator,{[n.publishing]:o},"updating"in n&&{[n.updating]:s},"connectionStatus"in n&&{[n.connectionStatus]:a},"connectionStatusConnected"in n&&{[n.connectionStatusConnected]:a&&"connected"===r}),icon:(0,d.XO)({connectionStatus:r,publishing:o}),key:"layer-item-status",scale:"s",slot:"content-end"})}get _renderedItemTemporaryIcon(){const{item:e,visibleElements:t,css:i}=this,{layer:n}=e,o="temporaryLayerIndicators"in t&&t.temporaryLayerIndicators,s="temporaryTableIndicators"in t&&t.temporaryTableIndicators,r=n&&"persistenceEnabled"in n&&((0,a.xu)(n)||!n.persistenceEnabled);return(o||s)&&r?(0,h.u)("calcite-icon",{class:i.itemTemporaryIcon,icon:"temporary",key:"temporary-icon",scale:"s",slot:"content-start",title:this.messages.temporary}):null}get _renderedItemToggle(){const{_title:e,item:t,parent:i,messages:n,visibilityAppearance:o,css:s}=this;if(!("visible"in t&&"layerVisibility"in n&&"showLayer"in n&&"hideLayer"in n&&"visibleToggle"in s&&o))return null;const{visible:r}=t,a=this._getParentVisibilityMode(i);if("inherited"===a)return null;const l=(0,d.gk)({visible:r,exclusive:"exclusive"===a,visibilityAppearance:o}),c="checkbox"===o,u=n.layerVisibility,p=(0,y.n)(r?n.hideLayer:n.showLayer,{layerName:e});return(0,h.u)("calcite-action",{appearance:"transparent",class:s.visibleToggle,icon:c?l:void 0,key:"visibility-toggle",label:p,onclick:()=>this._toggleVisibility(t,i),scale:"s",slot:c?"actions-start":"actions-end",text:u,title:p},c?null:(0,h.u)("calcite-icon",{class:this.classes({[s.visibleIcon]:"exclusive"!==a&&r}),icon:l,scale:"s"}))}get _renderedPanel(){const{panel:e}=this.item;return!e?.open||e.disabled||e.flowEnabled?null:(0,h.u)("div",{class:this.css.itemContentBottom,key:`content-panel-${e.uid}`,slot:"content-bottom"},e.render())}get _renderedPanelAction(){const{panel:e}=this.item;if(!e?.visible)return null;const{open:t,title:i,disabled:n}=e;return(0,h.u)("calcite-action",{active:t,appearance:"transparent",disabled:n,icon:(0,l.mR)(e),key:`action-${e.uid}`,onclick:()=>this._togglePanel(e),scale:"s",slot:"actions-end",text:i??"",title:i??void 0},this._renderFallbackIcon(e))}get _renderedActions(){switch(this._actionsCount){case 0:return null;case 1:return this._singleAction;default:return this._renderedActionMenu}}get _renderedActionMenu(){const{item:e,messagesCommon:t}=this,i=t.options;return(0,h.u)("calcite-action-menu",{appearance:"transparent",key:"item-action-menu",label:t.menu,open:e.actionsOpen,overlayPositioning:"fixed",placement:"bottom-end",scale:"s",slot:"actions-end",onCalciteActionMenuOpen:this._onActionMenuOpen},(0,h.u)("calcite-action",{appearance:"transparent",icon:"ellipsis",scale:"s",slot:"trigger",text:i,title:i}),this._renderedActionMenuContent)}get _renderedActionMenuContent(){return this._filteredSections.toArray().map((e=>(0,h.u)("calcite-action-group",{key:`action-section-${e.uid}`},e.toArray().map((e=>this._renderAction({action:e,textEnabled:!0}))))))}get _renderedCatalogFootprintIcon(){const{css:e}=this,t=this.item.layer,i="catalog-footprint"===t?.type,n="sublayer"===t?.type&&(0,a.bs)(t,"footprints");return"itemCatalogIcon"in e&&(i||n)?(0,h.u)("calcite-icon",{class:e.itemCatalogIcon,icon:"footprint",key:"footprint",scale:"s",slot:"content-start"}):null}get _renderedCatalogDynamicIcon(){const{css:e}=this,t=this.item.layer,i="catalog-dynamic-group"===t?.type,n="sublayer"===t?.type&&(0,a.bs)(t,"layers-in-view");return"itemCatalogIcon"in e&&(i||n)?(0,h.u)("calcite-icon",{class:e.itemCatalogIcon,icon:"catalog-dataset",key:"catalog-dataset",scale:"s",slot:"content-start"}):null}get _renderedCatalogSelectNode(){const{_title:e,item:t,visibleElements:i}=this;if(!("visible"in t))return;const{layer:n}=t,o="catalog-dynamic-group"===n?.type;return"catalogLayerList"in i&&i.catalogLayerList&&o?(0,h.u)("calcite-action",{appearance:"transparent",disabled:!n.visible,icon:"chevron-right",iconFlipRtl:!0,onclick:()=>this._triggerOnCatalogOpen(t),scale:"s",slot:"actions-end",text:e}):null}get _renderedChildList(){const{dragEnabled:e,item:t,rootGroupUid:i,listModeDisabled:n,selectionMode:o,displayMode:s}=this;if(!("children"in t))return;const r=[...this.parentTitles??[],t.title],{children:a,layer:l}=t,c="catalog-dynamic-group"!==l?.type&&(0,d.bB)(t),u=!n&&(0,d.Kf)(l),p="group"===l?.type,y=!u&&!c&&e&&p,g=!!e&&"childrenSortable"in t&&t.childrenSortable&&(0,d.xA)(t);return c||y?(0,h.u)("calcite-list",{canPull:e=>!!this.canMove&&this.canMove(e,"pull"),canPut:e=>!!this.canMove&&this.canMove(e,"put"),"data-item":t,"data-layer-type":i,displayMode:s,dragEnabled:g,group:p?i:`${i}-${l?.uid}`,key:`child-list-${l?.uid}`,label:t.title,selectionAppearance:"border",selectionMode:o},a?.filter((e=>!e.hidden&&(this.visibleElements.errors||!e.error))).toArray().map((e=>this._renderItem(e,t,r))),this._renderedTablesItem):null}get _hasTables(){const{layerTablesEnabled:e}=this,t=this.item.layer;if(!e||!t)return!1;switch(t.type){case"knowledge-graph":return e.includes(t.type)&&"tables"in t&&!!t.tables?.length;case"map-image":case"tile":return e.includes(t.type)&&"subtables"in t&&!!t.subtables?.length;default:return!1}}get _renderedTablesItem(){const{item:e,messages:t,css:i}=this,{layer:n}=e;return"itemTableIcon"in i&&"visible"in e&&"tables"in t&&this._hasTables?(0,h.u)("calcite-list-item",{class:i.item,"data-layer-id":n?.id,dragDisabled:!0,key:`list-item-table-list-tables-${n?.uid}`,label:t.tables,title:t.tables,onCalciteListItemSelect:()=>this._triggerOnTablesOpen(e)},(0,h.u)("calcite-icon",{class:i.itemTableIcon,icon:"table",scale:"s",slot:"content-start"}),(0,h.u)("calcite-icon",{flipRtl:!0,icon:"chevron-right",scale:"s",slot:"content-end"})):null}get _renderedItemMessage(){const{item:e,messages:t,css:i}=this;return e.error?(0,h.u)("div",{class:i.itemMessage,key:"esri-layer-list__error",slot:"content-bottom"},(0,h.u)("calcite-notice",{icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",width:"full"},(0,h.u)("div",{slot:"message"},"tableError"in t?t.tableError:t.layerError))):"incompatible"in e&&e.incompatible&&"layerIncompatible"in t?(0,h.u)("div",{class:i.itemMessage,key:"esri-layer-list__incompatible",slot:"content-bottom"},(0,h.u)("calcite-notice",{afterCreate:this._setTooltipReference,afterRemoved:this._removeTooltipReference,bind:this,icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",tabIndex:0,width:"full"},(0,h.u)("div",{slot:"message"},t.layerIncompatible))):null}get _singleAction(){return this._renderAction({action:(0,d.g5)(this._filteredSections),textEnabled:!1})}get _filteredSections(){return this.item.actionsSections.map((e=>e.filter((e=>e.visible))))}get _actionsCount(){return this.item.actionsSections.reduce(((e,t)=>e+t.length),0)}_renderAction(e){const{item:t}=this,{action:i,textEnabled:n}=e;if(!i)return null;const{active:o,disabled:s,title:r,type:a,indicator:c}=i;return(0,h.u)("calcite-action",{active:"toggle"===a&&i.value,appearance:"transparent","data-action-id":i.id,disabled:s,icon:(0,l.mR)(i),indicator:c,key:`action-${i.uid}`,loading:o,onclick:()=>this._triggerAction(t,i),scale:"s",slot:n?void 0:"actions-end",text:r??"",textEnabled:n,title:r??void 0},this._renderFallbackIcon(i))}_renderFallbackIcon(e){const{css:t}=this,{icon:i}=e,n="className"in e?e.className:void 0;if(i)return null;const o="image"in e?e.image:void 0,s={[t.itemActionIcon]:!!n,[t.itemActionImage]:!!o};return n&&(s[n]=!0),o||n?(0,h.u)("span",{"aria-hidden":"true",class:this.classes(t.itemActionIcon,s),key:"icon",styles:(0,l.uS)(o)}):null}_renderItem(e,t,i=[]){return(0,h.u)(n,{activeItem:this.activeItem,canMove:this.canMove,css:this.css,displayMode:this.displayMode,dragEnabled:this.dragEnabled,item:e,key:`layerListItem-${e.layer?.uid}`,layerTablesEnabled:this.layerTablesEnabled,listModeDisabled:this.listModeDisabled,messages:this.messages,messagesCommon:this.messagesCommon,parent:t,parentTitles:i,rootGroupUid:this.rootGroupUid,selectedDragItemLayerUid:this.selectedDragItemLayerUid,selectedItems:this.selectedItems,selectionMode:this.selectionMode,visibilityAppearance:this.visibilityAppearance,visibleElements:this.visibleElements,onAction:this.onAction,onCatalogOpen:this.onCatalogOpen,onPanelOpen:this.onPanelOpen,onSelectedDragItemLayerUidChange:this.onSelectedDragItemLayerUidChange,onTablesOpen:this.onTablesOpen,onTooltipReferenceChange:this.onTooltipReferenceChange})}_triggerAction(e,t){t&&e&&("toggle"===t.type&&(t.value=!t.value),this.onAction(t,e))}_triggerOnTablesOpen(e){e&&this.onTablesOpen&&this.onTablesOpen(e)}_triggerOnCatalogOpen(e){e&&this.onCatalogOpen?.(e)}_focusSelectedDragEl(e,t){this.selectedDragItemLayerUid===t.layer?.uid&&((0,p.kW)(e),this.onSelectedDragItemLayerUidChange?.(null))}_handleCalciteListItemToggle(e,t){e.stopPropagation(),t.open=e.target.expanded}_getParentVisibilityMode(e){return e&&"visibilityMode"in e?e.visibilityMode:null}_handleCalciteListItemSelect(e,t,i){if((0,d.rV)(e.target)!==t)return;const n=this._getParentVisibilityMode(i);"none"===this.selectionMode&&"inherited"!==n&&this._toggleVisibility(t,i)}_togglePanel(e){e.open=!e.open,e.open&&this.onPanelOpen()}_toggleVisibility(e,t){e&&"visible"in e&&("exclusive"===this._getParentVisibilityMode(t)&&e.visible||(e.visible=!e.visible))}};(0,o._)([(0,s.Cb)()],g.prototype,"activeItem",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"canMove",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"css",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"displayMode",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"dragEnabled",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"dragDisabled",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"item",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"layerTablesEnabled",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"listModeDisabled",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"messages",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"messagesCommon",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"onAction",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"onPanelOpen",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"onCatalogOpen",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"onTablesOpen",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"onSelectedDragItemLayerUidChange",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"onTooltipReferenceChange",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"parent",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"parentTitles",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"rootGroupUid",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"selectionMode",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"selectedItems",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"selectedDragItemLayerUid",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"visibleElements",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"visibilityAppearance",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"_title",null),(0,o._)([(0,s.Cb)()],g.prototype,"_renderedItemStatus",null),(0,o._)([(0,s.Cb)()],g.prototype,"_renderedItemTemporaryIcon",null),(0,o._)([(0,s.Cb)()],g.prototype,"_renderedItemToggle",null),(0,o._)([(0,s.Cb)()],g.prototype,"_renderedPanel",null),(0,o._)([(0,s.Cb)()],g.prototype,"_renderedPanelAction",null),(0,o._)([(0,s.Cb)()],g.prototype,"_renderedActions",null),(0,o._)([(0,s.Cb)()],g.prototype,"_renderedActionMenu",null),(0,o._)([(0,s.Cb)()],g.prototype,"_renderedActionMenuContent",null),(0,o._)([(0,s.Cb)()],g.prototype,"_renderedCatalogFootprintIcon",null),(0,o._)([(0,s.Cb)()],g.prototype,"_renderedCatalogDynamicIcon",null),(0,o._)([(0,s.Cb)()],g.prototype,"_renderedCatalogSelectNode",null),(0,o._)([(0,s.Cb)()],g.prototype,"_renderedChildList",null),(0,o._)([(0,s.Cb)()],g.prototype,"_hasTables",null),(0,o._)([(0,s.Cb)()],g.prototype,"_renderedTablesItem",null),(0,o._)([(0,s.Cb)()],g.prototype,"_renderedItemMessage",null),(0,o._)([(0,s.Cb)()],g.prototype,"_singleAction",null),(0,o._)([(0,s.Cb)()],g.prototype,"_filteredSections",null),(0,o._)([(0,s.Cb)()],g.prototype,"_actionsCount",null),g=n=(0,o._)([(0,r.j)("esri.widgets.LayerList.LayerListItem")],g);const m=g},94027:function(e,t,i){"use strict";i.d(t,{Z:function(){return b}});var n=i(73440),o=i(43254),s=i(87833),r=i(90403),a=i(17155),l=(i(61432),i(96711),i(83850),i(48023));function c(e){return null!=e&&"object"==typeof e&&"2d"===e.type&&"linkchart"===e.view2dType}var d=i(48804),u=i(5221);const h="view",p="view-layers",y="map-layers",g="layer-views",m="layer-list-mode",f=o.Z.ofType(d.Z);let v=class extends s.Z.EventedAccessor{constructor(e){super(e),this.checkPublishStatusEnabled=!1,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.operationalItems=new f,this.view=null}initialize(){this.addHandles([(0,r.YP)((()=>!0===this.view?.ready),(()=>this._viewHandles()),r.nn),(0,r.YP)((()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled]),(()=>this._recompileList())),(0,r.YP)((()=>c(this.view)?this.view.inGeographicLayout:null),(()=>this._compileList()))],h)}destroy(){this._removeAllItems(),this.view=null}get state(){const{view:e}=this;return e?.ready?"ready":e?"loading":"disabled"}get totalItems(){return this.operationalItems.flatten((e=>e.children)).length}triggerAction(e,t){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:t})}moveListItem(e,t,i,n){const o=e?.layer;if(!o||"subtype-sublayer"===o.type||"sublayer"===o.type)return;const s=this.view?.map?.layers,r=t?(0,u.Hh)(t):s,a=i?(0,u.Hh)(i):s;if(!r||!a)return;const{operationalItems:l}=this,c=t?.children||l,d=i?.children||l,h=a.length-n;e.parent=i||null,c.remove(e),r.remove(o),d.includes(e)||d.add(e,h),a.includes(o)||a.add(o,h),this._compileList()}_createLayerViewHandles(e){this.removeHandles(g),this._compileList(),e&&this.addHandles(e.on("change",(()=>this._compileList())),g)}_createMapLayerHandles(e){this.removeHandles(y),this._compileList(),e&&this.addHandles(e.on("change",(()=>this._compileList())),y)}_createListItem(e){const{view:t,listItemCreatedFunction:i,checkPublishStatusEnabled:n,listModeDisabled:o}=this;return new d.Z({checkPublishStatusEnabled:n,listModeDisabled:o,layer:e,listItemCreatedFunction:i,view:t})}_removeAllItems(){this.operationalItems.destroyAll()}_getViewableLayers(e){return e?this.listModeDisabled?e:e.filter((e=>"hide"!==(0,u.aV)(e))):void 0}_watchLayersListMode(e){this.removeHandles(m),e&&!this.listModeDisabled&&this.addHandles((0,r.YP)((()=>e.filter((e=>"listMode"in e)).map((e=>e.listMode)).toArray()),(()=>this._compileList())),m)}_compileList(){const e=this.view?.map?.layers,t=c(this.view)&&!this.view.inGeographicLayout?e?.filter((({type:e})=>"link-chart"===e)):e;this._watchLayersListMode(t);const i=this._getViewableLayers(t);i?.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}_createNewItems(e){const{operationalItems:t}=this;e.forEach((e=>{t.some((t=>t.layer===e))||t.add(this._createListItem(e))}))}_removeItems(e){const{operationalItems:t}=this,i=[];t.forEach((t=>{t&&e&&e.includes(t.layer)||i.push(t)})),t.destroyMany(i)}_sortItems(e){const{operationalItems:t}=this;t.sort(((t,i)=>{const n=e.indexOf(t.layer),o=e.indexOf(i.layer);return n>o?-1:n<o?1:0}))}_recompileList(){this._removeAllItems(),this._compileList()}_viewHandles(){const{view:e}=this;this.removeHandles([y,g,p]),e?.ready?this.addHandles([(0,r.YP)((()=>this.view?.map?.allLayers),(e=>this._createMapLayerHandles(e)),r.nn),(0,r.YP)((()=>this.view?.allLayerViews),(e=>this._createLayerViewHandles(e)),r.nn)],p):this._removeAllItems()}};(0,n._)([(0,a.Cb)()],v.prototype,"checkPublishStatusEnabled",void 0),(0,n._)([(0,a.Cb)()],v.prototype,"listItemCreatedFunction",void 0),(0,n._)([(0,a.Cb)({nonNullable:!0})],v.prototype,"listModeDisabled",void 0),(0,n._)([(0,a.Cb)({type:f})],v.prototype,"operationalItems",void 0),(0,n._)([(0,a.Cb)({readOnly:!0})],v.prototype,"state",null),(0,n._)([(0,a.Cb)()],v.prototype,"totalItems",null),(0,n._)([(0,a.Cb)()],v.prototype,"view",void 0),v=(0,n._)([(0,l.j)("esri.widgets.LayerList.LayerListViewModel")],v);const b=v},48804:function(e,t,i){"use strict";i.d(t,{Z:function(){return M}});var n=i(73440),o=i(70880),s=i(3480),r=i(43254),a=i(15894),l=i(90403),c=i(17155),d=i(90775),u=(i(61432),i(48023)),h=i(57947),p=i(72689),y=i(47711),g=i(60650),m=i(61100),f=(i(96711),i(83850),i(1803)),v=i(5221),b=i(60916),_=i(23039);let w=class extends(a.Z.IdentifiableMixin(f.Z)){constructor(e,t){super(e,t),this._legend=null,this.content=null,this.flowEnabled=!1,this.image=null,this.listItem=null,this.open=!1,this.visible=!0}initialize(){this.addHandles([(0,l.YP)((()=>this._canCreateLegend),(()=>this._createLegend()),l.nn),(0,l.YP)((()=>[this._legend,this._legendOptions]),(()=>this._updateLegend()),l.nn)])}destroy(){this._legend=(0,m.SC)(this._legend)}get _canCreateLegend(){const{content:e,listItem:t}=this;if(!t)return!1;const i="legend";return e===i||null!=e&&!!Array.isArray(e)&&e.includes(i)}get _legendOptions(){const{listItem:e,_legendLayerInfo:t}=this,i=e?.view;return t&&i?{view:i,layerInfos:[t]}:{}}get _legendLayerInfo(){const e=this.listItem?.layer;if(!e||"subtype-sublayer"===e.type)return null;const t=(0,v.Dz)(e)?e:null,i=e?.parent,n=null!=i&&"type"in i&&"map-image"===i.type?t?.source:null;return n&&i?{layer:i,title:"",sublayerIds:[n.mapLayerId]}:{layer:e,title:""}}get disabled(){const{listItem:e,_legend:t,content:i}=this;return!(e&&(Array.isArray(i)&&i.length>1||!t||t.activeLayerInfos?.length&&e.visibleAtCurrentScale&&e.visible))}set disabled(e){this._overrideIfSome("disabled",e)}get icon(){const{image:e}=this,t=this._getFirstWidget();return this._get("icon")??(!e&&t?t.icon:null)}set icon(e){this._overrideIfSome("icon",e)}get title(){return this._get("title")||(this._getFirstWidget()?.label??"")}set title(e){this._override("title",e)}render(){return(0,_.u)("div",{class:"esri-list-item-panel"},this._renderContents())}_renderContent(e){const{_legend:t,disabled:i,open:n}=this;return e&&!i&&n?"legend"===e&&t?(0,_.u)("div",{key:"legend-widget"},t.render()):"string"==typeof e?(0,_.u)("div",{innerHTML:e,key:e}):(0,b.Qd)(e)?(0,_.u)("div",{key:"content-widget"},e.render()):e instanceof HTMLElement?(0,_.u)("div",{afterCreate:this._attachToNode,bind:e,key:"content-element"}):null:null}_renderContents(){const{content:e,open:t}=this;return t?Array.isArray(e)?e.map((e=>this._renderContent(e))):this._renderContent(e):null}async _createLegend(){if((0,m.SC)(this._legend),this._legend=null,!this._canCreateLegend)return;const{default:e}=await Promise.resolve().then(i.bind(i,83861)),t=new e(this._legendOptions);this._legend=t}_attachToNode(e){e.appendChild(this)}_updateLegend(){const e=this._legend;e&&e.set(this._legendOptions)}_getWidget(e){return"legend"===e?this._legend:(0,b.Qd)(e)?e:null}_getFirstWidget(){const{content:e}=this;return Array.isArray(e)?e.map((e=>this._getWidget(e))).find((e=>e)):this._getWidget(e)}};(0,n._)([(0,c.Cb)()],w.prototype,"_legend",void 0),(0,n._)([(0,c.Cb)()],w.prototype,"_canCreateLegend",null),(0,n._)([(0,c.Cb)()],w.prototype,"_legendOptions",null),(0,n._)([(0,c.Cb)()],w.prototype,"_legendLayerInfo",null),(0,n._)([(0,c.Cb)()],w.prototype,"content",void 0),(0,n._)([(0,c.Cb)()],w.prototype,"disabled",null),(0,n._)([(0,c.Cb)()],w.prototype,"flowEnabled",void 0),(0,n._)([(0,c.Cb)()],w.prototype,"icon",null),(0,n._)([(0,c.Cb)()],w.prototype,"image",void 0),(0,n._)([(0,c.Cb)()],w.prototype,"listItem",void 0),(0,n._)([(0,c.Cb)()],w.prototype,"open",void 0),(0,n._)([(0,c.Cb)()],w.prototype,"title",null),(0,n._)([(0,c.Cb)()],w.prototype,"visible",void 0),w=(0,n._)([(0,u.j)("esri.widgets.LayerList.ListItemPanel")],w);const C=w;var x;const S=r.Z.ofType({key:"type",defaultKeyValue:"button",base:p.Z,typeMap:{button:y.Z,toggle:g.Z}}),E=r.Z.ofType(S),k="layer",L="child-list-mode";let T=x=class extends(a.Z.IdentifiableMixin(o.Z)){constructor(e){super(e),this.actionsSections=new E,this.actionsOpen=!1,this.checkPublishStatusEnabled=!1,this.children=new(r.Z.ofType(x)),this.childrenSortable=!0,this.hidden=!1,this.layer=null,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.open=!1,this.parent=null,this.view=null}initialize(){if(this.addHandles([(0,l.YP)((()=>[this.layer,this.layer?.listMode,this.listModeDisabled]),(()=>this._watchLayerProperties(this.layer)),l.nn),(0,l.YP)((()=>this.checkPublishStatusEnabled),(e=>this._updateChildrenPublishing(e)),l.nn),(0,l.YP)((()=>this.view),(e=>this._updateChildrenView(e)),l.nn),(0,l.YP)((()=>this.panel),(e=>this._setListItemOnPanel(e)),l.nn)]),"function"==typeof this.listItemCreatedFunction){const e={item:this};this.listItemCreatedFunction.call(null,e)}}destroy(){this.panel?.destroy(),this.children.destroyAll(),this.view=null}get connectionStatus(){const{layerView:e,publishing:t}=this;if(!t&&e&&"connectionStatus"in e)return e.connectionStatus}get error(){return this.layer?.loadError}get incompatible(){const{layerView:e}=this;return!(!e||!("spatialReferenceSupported"in e)||e.spatialReferenceSupported)}get layerView(){const{layer:e,view:t}=this;if(!e||!t||"sublayer"===e.type)return null;const i="subtype-sublayer"===e.type?e.parent:e;return t.allLayerViews.find((e=>e.layer===i))??null}set panel(e){const t=this._get("panel");e!==t&&e&&t?.destroy(),this._set("panel",e)}castPanel(e){return this.panel?.open&&!e.hasOwnProperty("open")&&(e.open=!0),e?new C(e):null}get sortable(){return"knowledge-graph-sublayer"!==this.layer?.type&&this._get("sortable")}set sortable(e){this._set("sortable",e)}get title(){const e=(0,h.U2)(this,"layer.layer");return(!e||e&&(0,h.U2)(this,"layer.layer.loaded"))&&(0,h.U2)(this,"layer.title")||(0,h.U2)(this,"layer.attributes.title")||""}set title(e){this._override("title",e)}get publishing(){const{layer:e,checkPublishStatusEnabled:t}=this;return!!(t&&e&&"publishingInfo"in e&&"publishing"===e.publishingInfo?.status)}get updating(){const{layerView:e,connectionStatus:t,layer:i,publishing:n}=this;return!n&&!t&&(e?e.updating:"loading"===i?.loadStatus||!1)}get visible(){return!!this.layer?.visible}set visible(e){const t=this.layer;t&&(t.visible=e)}get visibleAtCurrentScale(){return this.layerView?.visibleAtCurrentScale??!(0,v.zb)(this.layer,this.view?.scale)}get visibleAtCurrentTimeExtent(){return this.layerView?.visibleAtCurrentTimeExtent??!0}get visibilityMode(){return(0,v.sT)(this.layer)}clone(){return new x({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),childrenSortable:this.childrenSortable,hidden:this.hidden,layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,open:this.open,panel:this.panel,parent:this.parent,sortable:this.sortable,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(e){e&&(e.listItem=this)}_updateChildrenPublishing(e){this.children?.forEach((t=>t.checkPublishStatusEnabled=e))}_updateChildrenView(e){const t=this.children;t&&t.forEach((t=>t.view=e))}_createChildren(e){const{listModeDisabled:t,children:i}=this,n=e.filter((e=>!i.some((t=>t.layer===e))));i.addMany(this._createChildItems(n,t))}_destroyChildren(e){const{children:t}=this,i=t.filter((t=>!!t.layer&&!e.includes(t.layer)));t.destroyMany(i)}_sortChildren(e){this.children.sort(((t,i)=>e.indexOf(i.layer)-e.indexOf(t.layer)))}_destroyAllChildren(){this.removeHandles(L),this.children.destroyAll()}_watchChildLayerListMode(e){this.removeHandles(L),this.listModeDisabled||this.addHandles(e.toArray().map((t=>(0,l.YP)((()=>t.listMode),(()=>this._compileChildren(e))))),L)}_compileChildren(e){const t=this.listModeDisabled?e:e?.filter((e=>"hide"!==(0,v.aV)(e)));e?.length?(this._createChildren(t),this._destroyChildren(t),this._sortChildren(t),this._watchChildLayerListMode(e)):this._destroyAllChildren()}_watchSublayerChanges(e){e&&this.addHandles(e.on("change",(()=>this._compileChildren(e))),k)}_initializeChildLayers(e){this._compileChildren(e),this._watchSublayerChanges(e)}_createChildItems(e,t){return e.reverse().map((e=>t||(0,v.gF)(e)?new x({layer:e,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,parent:this,view:this.view}):null)).filter(s.pC)}_watchLayerProperties(e){if(this.removeHandles(k),this.removeHandles(L),!e)return;if("hide-children"===(!this.listModeDisabled&&(0,v.aV)(e)))return void this.children.destroyAll();const t=(0,v.Ff)(e);t&&this.addHandles((0,l.YP)((()=>e[t]),(i=>{e.hasOwnProperty(t)&&this._initializeChildLayers(i)}),l.nn),k)}};(0,n._)([(0,c.Cb)({type:E})],T.prototype,"actionsSections",void 0),(0,n._)([(0,c.Cb)()],T.prototype,"actionsOpen",void 0),(0,n._)([(0,c.Cb)()],T.prototype,"checkPublishStatusEnabled",void 0),(0,n._)([(0,c.Cb)({type:r.Z.ofType(T)})],T.prototype,"children",void 0),(0,n._)([(0,c.Cb)()],T.prototype,"childrenSortable",void 0),(0,n._)([(0,c.Cb)({readOnly:!0})],T.prototype,"connectionStatus",null),(0,n._)([(0,c.Cb)({readOnly:!0})],T.prototype,"error",null),(0,n._)([(0,c.Cb)()],T.prototype,"hidden",void 0),(0,n._)([(0,c.Cb)({readOnly:!0})],T.prototype,"incompatible",null),(0,n._)([(0,c.Cb)()],T.prototype,"layer",void 0),(0,n._)([(0,c.Cb)({readOnly:!0})],T.prototype,"layerView",null),(0,n._)([(0,c.Cb)()],T.prototype,"listItemCreatedFunction",void 0),(0,n._)([(0,c.Cb)({nonNullable:!0})],T.prototype,"listModeDisabled",void 0),(0,n._)([(0,c.Cb)()],T.prototype,"open",void 0),(0,n._)([(0,c.Cb)({type:C})],T.prototype,"panel",null),(0,n._)([(0,d.p)("panel")],T.prototype,"castPanel",null),(0,n._)([(0,c.Cb)()],T.prototype,"parent",void 0),(0,n._)([(0,c.Cb)({value:!0})],T.prototype,"sortable",null),(0,n._)([(0,c.Cb)()],T.prototype,"title",null),(0,n._)([(0,c.Cb)({readOnly:!0})],T.prototype,"publishing",null),(0,n._)([(0,c.Cb)({readOnly:!0})],T.prototype,"updating",null),(0,n._)([(0,c.Cb)()],T.prototype,"view",void 0),(0,n._)([(0,c.Cb)()],T.prototype,"visible",null),(0,n._)([(0,c.Cb)({readOnly:!0})],T.prototype,"visibleAtCurrentScale",null),(0,n._)([(0,c.Cb)({readOnly:!0})],T.prototype,"visibleAtCurrentTimeExtent",null),(0,n._)([(0,c.Cb)({readOnly:!0})],T.prototype,"visibilityMode",null),T=x=(0,n._)([(0,u.j)("esri.widgets.LayerList.ListItem")],T);const M=T},5221:function(e,t,i){"use strict";i.d(t,{Cl:function(){return v},Dz:function(){return w},Ff:function(){return p},Gr:function(){return S},Hh:function(){return _},Kf:function(){return c},Kp:function(){return s},MZ:function(){return r},XO:function(){return l},YO:function(){return b},aV:function(){return d},bB:function(){return E},g5:function(){return k},gF:function(){return m},gX:function(){return h},gk:function(){return a},j5:function(){return y},rV:function(){return x},sT:function(){return u},xA:function(){return g},zb:function(){return f}});const n="hide",o="hide-children",s=10,r=2;function a({exclusive:e,visible:t,visibilityAppearance:i}){const n="checkbox"===i;return t?e?"circle-f":n?"check-square-f":"view-visible":e?"circle":n?"square":"view-hide"}function l({connectionStatus:e,publishing:t}){return e?"connected"===e?"beacon":"offline":t?"square":"bullet-point"}function c(e){return e?.listMode===o}function d(e){return e?.listMode??void 0}function u(e){if(!e)return"inherited";const t=function(e){const t=C(e);return null!=t&&"supportsSublayerVisibility"in t?t.supportsSublayerVisibility:void 0}(w(e)?e.layer:e);return null!=t?t?"independent":"inherited":"visibilityMode"in e&&null!=e.visibilityMode?e.visibilityMode:"independent"}function h(e){e?.removeMany(e.filter((e=>e?.destroyed)))}function p(e){if(e&&(!("type"in e)||"wmts"!==e.type))return"sublayers"in e?"sublayers":"layers"in e?"layers":void 0}function y(e,t){e&&(e.filterPredicate=t?e=>t(x(e)):void 0)}function g(e){const t=(e?.layer&&w(e.layer)?e.layer.layer:void 0)??e?.layer;return!!t&&"catalog"!==t.type&&(function(e){const t=C(e);return null!=t&&"supportsDynamicLayers"in t?t.supportsDynamicLayers:void 0}(t)??!0)}function m(e){return d(e)!==n}function f(e,t){if(!e||null==t||isNaN(t))return!1;const i=function(e){return null!=e&&"minScale"in e&&null!=e.minScale?e.minScale:void 0}(e),n=function(e){return null!=e&&"maxScale"in e&&null!=e.maxScale?e.maxScale:void 0}(e),o=null!=i&&!isNaN(i)&&i>0&&t>i,s=null!=n&&!isNaN(n)&&n>0&&t<n;return o||s}function v(e,t){e?.sort(((e,i)=>{const n="uid"in e?t.indexOf(e.uid):-1,o="uid"in i?t.indexOf(i.uid):-1;return n>o?-1:n<o?1:0}))}function b(e,t){const i=e?.layer;if(!i)return;const n=p(i);if(!n)return;let o;"layers"===n&&"layers"in i?o=i.layers:"sublayers"===n&&"sublayers"in i&&(o=i.sublayers),v(o,t)}function _(e){const t=e?.layer;return t&&"layers"in t?t.layers:null}function w(e){return null!=e&&"layer"in e&&null!=e.layer}function C(e){return e&&"capabilities"in e&&null!=e.capabilities&&"exportMap"in e.capabilities?e.capabilities.exportMap:void 0}function x(e){return e?.["data-item"]}function S(e){return e?.getAttribute("data-layer-type")}function E(e){const{children:t,error:i}=e,n="incompatible"in e&&e.incompatible;return!!t?.filter((e=>!e.hidden)).length&&!i&&!n}function k(e){for(const t of e)for(const e of t)if("button"===e.type||"toggle"===e.type)return e}},83861:function(e,t,i){"use strict";i.d(t,{default:function(){return ti}});var n=i(73440),o=i(90403),s=i(17155),r=i(90775),a=i(61432),l=(i(83850),i(48023)),c=i(1803),d=(i(55214),i(70880)),u=i(43254),h=i(96711),p=i(57947);function y(e,t){const i=e.featureReduction;return i&&"selection"!==i.type&&(!("maxScale"in i)||!i.maxScale||i.maxScale<t.scale)?i:null}var g=i(53147),m=i(10218),f=i(78619),v=i(3480),b=i(41773),_=i(99574),w=i(93568),C=i(96094),x=i(48797),S=i(95490),E=i(66951),k=i(28947),L=i(13928),T=i(8971);const M=-1;let I=class extends d.Z{constructor(e){super(e),this._from=null,this._to=null,this._final=null,this._current=[],this._time=0,this.duration=(0,a.Z)("mapview-transitions-duration"),this.effects=[]}set effect(e){if(this._get("effect")!==(e=e||"")){this._set("effect",e);try{this._transitionTo(O(e))}catch(t){this._transitionTo([]),h.Z.getLogger(this).warn("Invalid Effect",{effect:e,error:t})}}}get final(){return this._final}get hasEffects(){return this.transitioning||!!this.effects.length}set scale(e){this._updateForScale(e)}get transitioning(){return null!==this._to}canTransitionTo(e){try{return this.scale>0&&P(this._current,O(e),this.scale)}catch{return!1}}transitionStep(e,t){this._applyTimeTransition(e),this._updateForScale(t)}endTransition(){this._applyTimeTransition(this.duration)}_transitionTo(e){this.scale>0&&P(this._current,e,this.scale)?(this._final=e,this._to=(0,k.d9)(e),function(e,t,i){const n=e.length>t.length?e:t,o=e.length>t.length?t:e,s=o[o.length-1],r=s?.scale??i,a=s?.effects??[];for(let e=o.length;e<n.length;e++)o.push({scale:r,effects:[...a]});for(let e=0;e<n.length;e++)o[e].scale=o[e].scale===M?i:o[e].scale,n[e].scale=n[e].scale===M?i:n[e].scale,(0,T.uF)(o[e].effects,n[e].effects)}(this._current,this._to,this.scale),this._from=(0,k.d9)(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=e),this._set("effects",this._current[0]?(0,k.d9)(this._current[0].effects):[])}_applyTimeTransition(e){if(!(this._to&&this._from&&this._current&&this._final))return;this._time+=e;const t=Math.min(1,this._time/this.duration);for(let e=0;e<this._current.length;e++){const i=this._current[e],n=this._from[e],o=this._to[e];i.scale=A(n.scale,o.scale,t);for(let e=0;e<i.effects.length;e++){const s=i.effects[e],r=n.effects[e],a=o.effects[e];s.interpolate(r,a,t)}}1===t&&(this._current=this._final,this._set("effects",this._current[0]?(0,k.d9)(this._current[0].effects):[]),this._from=this._to=this._final=null)}_updateForScale(e){if(this._set("scale",e),0===this._current.length)return;const t=this._current,i=this._current.length-1;let n,o,s=1;if(1===t.length||e>=t[0].scale)o=n=t[0].effects;else if(e<=t[i].scale)o=n=t[i].effects;else for(let r=0;r<i;r++){const i=t[r],a=t[r+1];if(i.scale>=e&&a.scale<=e){s=(e-i.scale)/(a.scale-i.scale),n=i.effects,o=a.effects;break}}for(let e=0;e<this.effects.length;e++)this.effects[e].interpolate(n[e],o[e],s)}};function O(e){const t=(0,L.Q)(e)||[];return function(e){const t=e[0];return!!t&&"type"in t}(t)?[{scale:M,effects:t}]:t}function P(e,t,i){return!e[0]?.effects||!t[0]?.effects||!((e[0]?.scale===M||t[0]?.scale===M)&&(e.length>1||t.length>1)&&i<=0)&&(0,T.AS)(e[0].effects,t[0].effects)}function A(e,t,i){return e+(t-e)*i}(0,n._)([(0,s.Cb)()],I.prototype,"_to",void 0),(0,n._)([(0,s.Cb)()],I.prototype,"duration",void 0),(0,n._)([(0,s.Cb)({value:""})],I.prototype,"effect",null),(0,n._)([(0,s.Cb)({readOnly:!0})],I.prototype,"effects",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],I.prototype,"final",null),(0,n._)([(0,s.Cb)({readOnly:!0})],I.prototype,"hasEffects",null),(0,n._)([(0,s.Cb)({value:0})],I.prototype,"scale",null),(0,n._)([(0,s.Cb)({readOnly:!0})],I.prototype,"transitioning",null),I=(0,n._)([(0,l.j)("esri.layers.effects.EffectView")],I);var R=i(615),D=i(78279),$=i(33287),N=i(76554),F=i(75428),V=i(2003),z=i(84799),Z=i(92680),B=i(86690),U=i(11354),H=i(95365),G=i(89636),j=i(19886),K=i(27737),W=i(77423),Y=i(47967),q=i(70745),X=i(30903);var J=i(83133),Q=i(48375),ee=i(60192),te=i(90378),ie=i(94117),ne=(i(60646),i(40030));i(10368);var oe=i(12816),se=i(37964);const re=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,ae=new b.X({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),le=new j.Z({size:6,outline:{color:[128,128,128,.5],width:.5}}),ce=new G.Z({style:"solid"});function de(e){return"flow"===e.type}function ue(e){return"vector-field"===e.type}function he(e){return"raster-colormap"===e.type}function pe(e){return"raster-stretch"===e.type}function ye(e){return"raster-shaded-relief"===e.type}function ge(e){return"esri.renderers.SimpleRenderer"===e.declaredClass}function me(e){return"esri.renderers.ClassBreaksRenderer"===e.declaredClass}function fe(e){return"esri.renderers.UniqueValueRenderer"===e.declaredClass}function ve(e){return"esri.renderers.HeatmapRenderer"===e.declaredClass}function be(e){return"esri.renderers.PointCloudClassBreaksRenderer"===e.declaredClass}function _e(e){return"esri.renderers.PointCloudStretchRenderer"===e.declaredClass}function we(e){return"esri.renderers.PointCloudUniqueValueRenderer"===e.declaredClass}function Ce(e){return"esri.renderers.DotDensityRenderer"===e.declaredClass}function xe(e){return"esri.renderers.PieChartRenderer"===e.declaredClass}function Se(e){return"esri.layers.SubtypeGroupLayer"===e.declaredClass}function Ee(e){return"esri.layers.MapImageLayer"===e.declaredClass}function ke(e){return"esri.layers.TileLayer"===e.declaredClass}function Le(e){return"esri.layers.ImageryLayer"===e.declaredClass}function Te(e){return"esri.layers.ImageryTileLayer"===e.declaredClass}function Me(e){return"sublayers"in e}function Ie(e){return e&&"symbol"in e}async function Oe(e,t){const i=await(0,oe.ME)("esri/widgets/Legend/t9n/Legend");return"previewTemplateAriaLabel"!==e||t||(e="previewAriaLabel"),(0,se.n)(i[e],{label:t})}const Pe=new j.Z({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let Ae={},Re=class extends d.Z{constructor(e){super(e),this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._webStyleSymbolCache=new Map,this._dotDensityUrlCache=new Map,this._scaleDrivenSizeVariable=null,this._hasClusterSizeVariable=!1,this._layerDefinitionExpression=null,this._layerDefinitionExpressionClause=null,this._layerDisplayFilterId=null,this._layerDisplayFilterClause=null,this.children=new u.Z,this.layerView=null,this.layer=null,this.legendElements=[],this.parent=null,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerDefinitionExpression=!1,this.respectLayerVisibility=!0,this.sublayerIds=[],this.title=null,this.view=null}initialize(){const e=()=>this.notifyChange("ready");this.addHandles([(0,o.on)((()=>this.children),"change",(t=>{const{added:i,removed:n}=t;i.forEach((t=>{const i=`activeLayerInfo-ready-watcher-${t.layer.uid}`;this.addHandles((0,o.YP)((()=>t.ready),e,o.nn),i)})),n.forEach((e=>this.removeHandles(e.layer.uid))),e()}))]),this.keepCacheOnDestroy||(Ae={})}destroy(){this._webStyleSymbolCache=null,this._dotDensityUrlCache=null,this._scaleDrivenSizeVariable=null,this.keepCacheOnDestroy||(Ae=null),this._layerDefinitionExpressionClause=null}get effectList(){const e=this.layer;let t=null;return"effect"in e&&e.effect&&(t=new I,t.effect=e.effect,t.endTransition(),t.scale=this.scale),t}get opacity(){const e=this.layer.opacity,t=this.parent?.opacity,i=this.layer.parent,n=i&&"uid"in i?this._getParentLayerOpacity(i):null;return null!=t?t*e:null!=n?n*e:e}get ready(){return null===this.layer||(this.children.length>0?this._isGroupActive():this.legendElements.length>0)}get scale(){return this.view?.scale??0}get isScaleDriven(){const e=this.layer;if(null===e)return!1;if("effect"in e&&e.effect&&Array.isArray(e.effect))return!0;if("featureReduction"in e&&e.featureReduction){if("cluster"===e.featureReduction.type)return!0;if("binning"===e.featureReduction.type&&"renderer"in e.featureReduction&&e.featureReduction.renderer)return this._isRendererScaleDriven(e.featureReduction.renderer)}return"renderer"in e&&e.renderer?!!("displayFilterInfo"in e&&e.displayFilterInfo&&fe(e.renderer))||this._isRendererScaleDriven(e.renderer):this._isLayerScaleDriven(this.layer)}get version(){return this._get("version")+1}async buildLegendElementsForFeatureCollections(e){if(this.hideLayersNotInCurrentView&&!await this._isLayerInCurrentView())return this.legendElements=[],void this.notifyChange("ready");const t=Array.from(e,(e=>{if((0,F.Te)(e))return this._getRendererLegendElements(e.renderer,{title:e.title});if(e.featureSet?.features.length){const t=e.layerDefinition,i=t?.drawingInfo,n=i&&(0,z.i)(i.renderer),o=ae.read(t.geometryType);return n?this._getRendererLegendElements(n,{title:e.name,geometryType:o}):(h.Z.getLogger(this).warn("drawingInfo not available!"),null)}return null}));try{const e=[],i=await Promise.allSettled(t);for(const t of i)if("fulfilled"===t.status)for(const i of t.value??[])e.push(i);this.legendElements=e,this.notifyChange("ready")}catch(e){h.Z.getLogger(this).warn("error while building legend for layer!",e)}}async buildLegendElementsForRenderer(e){try{const t=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=t?await this._getRendererLegendElements(e):[],this.notifyChange("ready")}catch(e){h.Z.getLogger(this).warn("error while building legend for layer!",e)}}async buildLegendElementsForFeatureReduction(e){try{const t=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=t?await this._getLegendElementsForFeatureReduction(e):[],this.notifyChange("ready")}catch(e){h.Z.getLogger(this).warn("error while building legend for layer!",e)}}async buildLegendElementsForTools(){const e=this.layer;if(function(e){return"esri.layers.VoxelLayer"===e.declaredClass}(e))this._constructLegendElementsForVoxelLayer();else if(function(e){return"esri.layers.WMTSLayer"===e.declaredClass}(e))this._constructLegendElementsForWMTSlayer();else if(function(e){return"esri.layers.WMSLayer"===e.declaredClass}(e))await this._constructLegendElementsForWMSSublayers();else if(function(e){return"esri.layers.BuildingSceneLayer"===e.declaredClass}(e))await this._constructLegendElementsForBuildingSceneLayer();else if(Ee(e)||ke(e)||Se(e))await this._constructLegendElementsForSublayers();else{this.removeHandles("imageryLayers-watcher");let t="default";if(Le(e)){t=(e?.rasterFunction?.functionName||"default")+"_"+(e.bandIds?.length?e.bandIds.join(""):"###")}if(Te(e)||"link-chart"===e.type)return;await this._getLegendLayers(`${e.uid}-${t}`).then((async t=>{this.legendElements=[],this.notifyChange("ready");const i=t.map((async t=>{if(Le(e)){const t=(0,o.YP)((()=>[e.rasterFunction,e.bandIds]),(()=>(0,w.Ds)((async()=>{Ae.default=null,e.renderer?await this.buildLegendElementsForRenderer(e.renderer):await this.buildLegendElementsForTools()}))()));this.addHandles(t,"imageryLayers-watcher")}const i=this._generateSymbolTableElementForLegendLayer(t);i?.infos.length&&(Le(e)&&(i.title=e.title),this.legendElements.push(i)),this.notifyChange("ready")}));await Promise.allSettled(i)})).catch((e=>{h.Z.getLogger(this).warn("Request to server for legend has failed!",e)}))}}async _isLayerInCurrentView(){const e=this.layer,t=this.layerView,i=t&&"createQuery"in t&&"queryFeatureCount"in t;if(!(i||t&&"createQuery"in e&&"queryFeatureCount"in e))return!0;await(0,o.N1)((()=>!t.updating));const n=i?"createQuery"in t&&t.createQuery():"createQuery"in e&&e.createQuery();return!n||(n.geometry=this.view.extent,0!==(i?"queryFeatureCount"in t&&await t.queryFeatureCount(n):"queryFeatureCount"in e&&await e.queryFeatureCount(n)))}_getParentLayerOpacity(e){let t=1;const i=e.parent;return i&&"uid"in i&&(t=this._getParentLayerOpacity(i)),e.opacity*t}_isGroupActive(){return this.children.some((e=>e.ready))}_isRendererScaleDriven(e){if("dot-density"===e.type)return!0;const t="valueExpression"in e?e.valueExpression:null;if(re.test(t))return!0;return!!("visualVariables"in e?e.visualVariables:null)?.some((e=>this._isScaleDrivenSizeVariable(e)))||this._hasScaleDrivenSymbols(e)}_hasScaleDrivenSymbols(e){switch(e.type){case"simple":return this._isScaleDrivenSymbol(e.symbol);case"class-breaks":return this._isScaleDrivenSymbol(e.defaultSymbol)||e.classBreakInfos.some((e=>this._isScaleDrivenSymbol(e.symbol)));case"unique-value":return this._isScaleDrivenSymbol(e.defaultSymbol)||!!e.uniqueValueInfos?.some((e=>this._isScaleDrivenSymbol(e.symbol)))}return!1}_isScaleDrivenSymbol(e){if("cim"===e?.type){const{primitiveOverrides:t,minScale:i,maxScale:n}=e.data,o=t?.some((e=>/\$view\.scale/.test(e.valueExpressionInfo?.expression||"")))??!1;return null!=i||null!=n||o}return!1}_isScaleDrivenSizeVariable(e){if(e&&"size"!==e.type)return!1;const t=e,i=t.minSize,n=t.maxSize;return!("object"!=typeof i||!i||!this._isScaleDrivenSizeVariable(i))||!("object"!=typeof n||!n||!this._isScaleDrivenSizeVariable(n))||re.test(t.valueExpression)}_isLayerScaleDriven(e){if("minScale"in e&&e.minScale>0||"maxScale"in e&&e.maxScale>0)return!0;if("sublayers"in e&&e.sublayers)return e.sublayers.some((e=>this._isLayerScaleDriven(e)));const t=e.parent;if(!1===e.loaded&&t&&Ee(t)&&"source"in e&&e.source&&"map-layer"===e.source.type)for(const i of t.sourceJSON.layers??[])if(i.id===e.source.mapLayerId&&(i.minScale>0||i.maxScale>0))return!0;return!1}async _constructLegendElementsForVoxelLayer(){this.legendElements=[],this.removeHandles("voxel-style-watcher"),this.removeHandles("voxel-current-variable");const e=this.layer;this.addHandles((0,o.YP)((()=>e.currentVariableId),(()=>this._constructLegendElementsForVoxelLayer())),"voxel-current-variable"),this.addHandles((0,o.YP)((()=>e.getVariableStyles()),(()=>this._constructLegendElementsForVoxelLayer())),"voxel-style-watcher");const t=e.getVariableStyle(null),i=[];if(t)if(t.uniqueValues?.length){const e=[];t.uniqueValues.forEach((t=>{t.enabled&&e.push({label:t.label||`${t.value}`,value:t.value,symbol:new G.Z({color:t.color,outline:null})})})),e.length&&i.push({type:"symbol-table",title:t.label,infos:e})}else if(t.transferFunction){const{colorStops:e,stretchRange:n}=t.transferFunction,o=e.toArray().reverse(),s=n.map(((e,t)=>`${0===t?ie.z4:ie.Z8} ${function(e){const t=Math.floor(Math.log10(Math.abs(e)))+1,i=t<4||t>6?4:t,n=Math.abs(e)>=1e6?"compact":"standard";return(0,ne.uf)(e,{notation:n,minimumSignificantDigits:2,maximumSignificantDigits:i})}(e)}`)).reverse(),r=o.map((e=>({color:e.color,value:null,label:null})));r[0].label=s[0],r[r.length-1].label=s[1],i.push({type:"color-ramp",title:t.label,infos:r,preview:(0,q.jT)(o.map((e=>e.color)),{ariaLabel:await Oe("previewColorRampAriaLabel")})})}await this._generatePreviewsForLegendElements(i,{opacity:e.opacity}),this.legendElements=i,this.notifyChange("ready")}_constructLegendElementsForWMTSlayer(){this.legendElements=[],this.removeHandles("wmts-activeLayer-watcher");const e=this.layer.activeLayer;this.addHandles((0,o.YP)((()=>{const{layer:e}=this;return e&&"activeLayer"in e&&e.activeLayer}),(()=>this._constructLegendElementsForWMTSlayer())),"wmts-activeLayer-watcher");const t=e.styleId?e.styles?.find((({id:t})=>t===e.styleId))?.legendUrl:void 0;t&&(this.legendElements=[{type:"symbol-table",title:e.title,infos:[{src:t,opacity:this.opacity}]}]),this.notifyChange("ready")}async _constructLegendElementsForWMSSublayers(){this.legendElements=[],this.removeHandles("wms-sublayers-watcher");const e=this.layer;let t=null;(e.customParameters||e.customLayerParameters)&&(t={...e.customParameters,...e.customLayerParameters}),this.addHandles((0,o.YP)((()=>{const{layer:e}=this;return e&&"sublayers"in e&&e.sublayers}),(()=>this._constructLegendElementsForWMSSublayers())),"wms-sublayers-watcher"),this.legendElements=await this._generateLegendElementsForWMSSublayers(e.sublayers,t),this.notifyChange("ready")}async _generateLegendElementsForWMSSublayers(e,t){const i=this.layer,n=[];this.addHandles(e.on("change",(()=>this._constructLegendElementsForWMSSublayers())),"wms-sublayers-watcher");const s=this.sublayerIds?.map((e=>i.findSublayerById(e)))?.filter(v.pC)??[],r=s.length?s:e.toArray();for(const e of r){const i=(0,o.YP)((()=>[e.title,e.visible,e.legendEnabled]),(()=>this._constructLegendElementsForWMSSublayers()));if(this.addHandles(i,"wms-sublayers-watcher"),!this.respectLayerVisibility||e.visible&&e.legendEnabled){const i=await this._generateSymbolTableElementForWMSSublayer(e,t);i?.infos.length&&n.unshift(i)}}return n}async _generateSymbolTableElementForWMSSublayer(e,t){if(!e.legendUrl&&e.sublayers){const i=(await this._generateLegendElementsForWMSSublayers(e.sublayers,t)).filter((e=>e));return{type:"symbol-table",title:e.title,infos:i}}return this._generateSymbolTableElementForLegendUrl(e,t)}async _generateSymbolTableElementForLegendUrl(e,t){let i=e.legendUrl;if(!i)return;const n={type:"symbol-table",title:e.title||e.name||String(e.id??""),infos:[]};t&&(i=(0,S.fl)(i,t));let o=null;const s=e.layer?.opacity;try{o=(await(0,f.Z)(i,{responseType:"image"})).data,o&&(o.style.opacity=s)}catch{}return n.infos.push({src:i,preview:o,opacity:s}),n}_getLegendLayers(e,t){const i=Ae&&Ae[e];return i?Promise.resolve(i):this._legendRequest(t).then((t=>{const i=t.layers;return Ae[e]=i,i}))}_legendRequest(e){const t=this.layer;let i={f:"json",dynamicLayers:e};if(Le(t)){const e=t.exportImageServiceParameters.rasterFunction;if(e&&(i.renderingRule=JSON.stringify(e.functionDefinition?.toJSON()||e.toJSON())),t.bandIds&&(i.bandIds=t.bandIds.join()),t.raster||t.viewId||t.customParameters){const{raster:e,viewId:n,customParameters:o}=t;i={raster:e,viewId:n,...i,...o}}}let n=t.url.replace(/(\/)+$/,"");if("version"in t&&+t.version>=10.01){const e=n.indexOf("?");e>-1?n=n.slice(0,e)+"/legend"+n.slice(e):n+="/legend"}else{const e=n.toLowerCase().indexOf("/rest/"),t=-1===e?n:n.slice(0,e)+n.slice(e+5);n="https://utility.arcgis.com/sharing/tools/legend?soapUrl="+encodeURI(t)+"&returnbytes=true"}return(0,f.Z)(n,{query:i}).then((e=>e.data))}async _constructLegendElementsForBuildingSceneLayer(){this.legendElements=[],this.removeHandles("sublayers-watcher");const e=this.layer;this.addHandles((0,o.YP)((()=>e.sublayers),(()=>this._constructLegendElementsForBuildingSceneLayer())),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForBuildingSublayers(e.sublayers,this.opacity),this.notifyChange("ready")}catch(e){h.Z.getLogger(this).warn("Request to server for legend has failed!",e)}}async _generateLegendElementsForBuildingSublayers(e,t){let i=[];this.addHandles(e.on("change",(()=>this._constructLegendElementsForBuildingSceneLayer())),"sublayers-watcher");const n=e.toArray();for(const e of n){const n=(0,o.YP)((()=>["renderer"in e&&e.renderer,e.opacity,e.title,e.visible]),(()=>this._constructLegendElementsForBuildingSceneLayer()));if(this.addHandles(n,"sublayers-watcher"),!this.respectLayerVisibility||e.visible){const n=null!=e?.opacity?e.opacity:null,o=null!=n?n*t:t;if("building-group"===e.type){const t={type:"symbol-table",title:e.title,infos:[]},n=await this._generateLegendElementsForBuildingSublayers(e.sublayers,o);t.infos.push(...n),i=[t,...i]}else e.renderer&&(i=[...await this._getRendererLegendElements(e.renderer,{title:e.title,opacity:o,sublayer:e}),...i])}}return i.filter((e=>!!e&&(!("infos"in e)||!e.infos||e.infos.length>0)))}async _constructLegendElementsForSublayers(){this.legendElements=[],this.removeHandles("sublayers-watcher");const e=this.layer;if(Ee(e)||ke(e)||Se(e)){this.addHandles((0,o.YP)((()=>e.sublayers),(()=>this._constructLegendElementsForSublayers)),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForSublayers(e.sublayers,this.opacity),this.notifyChange("ready")}catch(e){h.Z.getLogger(this).warn("Request to server for legend has failed!",e)}}}async _generateLegendElementsForSublayers(e,t,i){const n=this.layer;let s=[];this.addHandles(e.on("change",(()=>this._constructLegendElementsForSublayers())),"sublayers-watcher");let r=e.toArray();!i&&this.sublayerIds&&this.sublayerIds.length&&(r=Se(n)?this.sublayerIds.map((e=>n.findSublayerForSubtypeCode(e))).filter(v.pC):this.sublayerIds.map((e=>n.findSublayerById(e))).filter(v.pC));for(const e of r){const n=(0,o.YP)((()=>[e.renderer,e.opacity,e.title,e.visible,e.legendEnabled]),(()=>this._constructLegendElementsForSublayers()));if(this.addHandles(n,"sublayers-watcher"),!this.respectLayerVisibility||e.visible&&e.legendEnabled&&this._isSublayerInScale(e)){const n=null!=e?.opacity?e.opacity:null,o=null!=n?n*t:t,r=!Me(e)||e.originIdOf("renderer")>E.s3.SERVICE&&!e.sublayers;if(e.renderer&&r)await e.load(),s=[...await this._getRendererLegendElements(e.renderer,{title:e.title,opacity:o,sublayer:e}),...s];else if(Me(e)){const t=await this._generateSymbolTableElementForSublayer(e,o,i);t&&s.unshift(t)}}}return s.filter((e=>!!e&&(!("infos"in e)||!e.infos||e.infos.length>0)))}async _generateSymbolTableElementForSublayer(e,t,i){if(!i){i=new Map;const t=this.layer,n=e.source;let o=null;if(n&&("map-layer"!==n.type||n.mapLayerId!==e.id||n.gdbVersion&&n.gdbVersion!==("gdbVersion"in t&&t.gdbVersion))||e.originIdOf("renderer")>E.s3.SERVICE||e.originIdOf("labelingInfo")>E.s3.SERVICE||e.originIdOf("labelsVisible")>E.s3.SERVICE){const e=new $.R({layer:this.layer});o=e.hasDynamicLayers?e.dynamicLayers:null,e.destroy()}const s=o||`${t.uid}-default`;(await this._getLegendLayers(s,o)).forEach((e=>i.set(e.layerId,e)))}const n=i.get(e.id);if((!n||n?.subLayerIds&&n.defaultVisibility)&&e.sublayers){const n=await this._generateLegendElementsForSublayers(e.sublayers,t,i);return{type:"symbol-table",title:e.title,infos:n}}return this._generateSymbolTableElementForLegendLayer(n,e,t)}_generateSymbolTableElementForLegendLayer(e,t,i){if(!e?.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(e,t))return null;const n=t?.renderer;let o=t?.title||e.layerName;if(n&&(!t||t?.originIdOf("renderer")>E.s3.SERVICE)){const e=t?.title||this._getRendererTitle(n,t);e&&(o&&"string"!=typeof e&&"title"in e&&(e.title=o),o=e)}const s={type:"symbol-table",title:o,legendType:e.legendType||null,infos:[]},r=t?this._sanitizeLegendForSublayer(e.legend.slice(),t):e.legend;return e.legendGroups&&e.legendGroups.length>0?e.legendGroups.forEach((t=>{const n={type:"symbol-table",title:t.heading,legendType:e.legendType||null,infos:this._generateSymbolTableElementInfosForLegendLayer(r.filter((e=>e.groupId===t.id)),e.layerId,i)};n.infos?.length>0&&s.infos.push(n)})):s.infos=this._generateSymbolTableElementInfosForLegendLayer(r,e.layerId,i),s.infos.length>0?s:null}_generateSymbolTableElementInfosForLegendLayer(e,t,i){return e.map((e=>{let n=e.url;if(e.imageData&&e.imageData.length>0)n=`data:image/png;base64,${e.imageData}`;else{if(0===n.indexOf("http"))return null;n=(0,m.Dp)(`${this.layer.url}/${t}/images/${n}`)}return{label:e.label,src:n,opacity:i??this.opacity,width:e.width,height:e.height}})).filter(v.pC)}_isSublayerInScale(e){const t=e.minScale||0,i=e.maxScale||0;return!(t>0&&t<this.scale||i>this.scale)}_isLegendLayerInScale(e,t){const i=t||this.layer;let n=null,o=null,s=!0;return!i.minScale&&0!==i.minScale||!i.maxScale&&0!==i.maxScale?(0===e.minScale&&i.tileInfo&&(n=i.tileInfo.lods[0].scale),0===e.maxScale&&i.tileInfo&&(o=i.tileInfo.lods[i.tileInfo.lods.length-1].scale)):(n=Math.min(i.minScale,e.minScale)||i.minScale||e.minScale,o=Math.max(i.maxScale,e.maxScale)),(n>0&&n<this.scale||o>this.scale)&&(s=!1),s}_sanitizeLegendForSublayer(e,t){if("version"in this.layer&&+this.layer.version<10.1||0===e.length)return e;const i=t.renderer,n=e.some((e=>e.values));let o=0,s=null;return n&&e.some(((e,t)=>(e.values||(o=t,s=e,s.label||(s.label="others")),null!=s))),i?"unique-value"===i.type?s&&(e.splice(o,1),e.push(s)):"class-breaks"===i.type&&(s&&e.splice(o,1),i.legendOptions?.order||e.reverse(),s&&e.push(s)):s&&(e.splice(o,1),e.push(s)),e}async _getRendererLegendElements(e,t={}){if(!function(e,t){return ge(e)||me(e)||fe(e)||ve(e)||Ce(e)||xe(e)?"2d"===t.type||(0,Z.e)(e):pe(e)||he(e)||ye(e)||be(e)||_e(e)||we(e)||ue(e)||de(e)}(e,this.view))return h.Z.getLogger(this).warn(`Renderer of type '${e.type}' not supported!`),[];if(function(e){return be(e)||_e(e)||we(e)||function(e){return"esri.renderers.PointCloudRGBRenderer"===e.declaredClass}(e)}(e))return this._constructPointCloudRendererLegendElements(e,t);if(Ce(e))return this._constructDotDensityRendererLegendElements(e);const i=await this._loadRenderer(e);return xe(i)?this._constructPieChartRendererLegendElements(i):this._constructRendererLegendElements(i,t)}async _getLegendElementsForFeatureReduction(e){let t=null;return"binning"===e.type?t=e.renderer:"cluster"===e.type&&(t=this._getClusterRenderer(e)),t?this._getRendererLegendElements(t):[]}_getPointCloudRendererTitle(e){return(e.legendOptions?.title||e.field)??""}async _constructPointCloudRendererLegendElements(e,t={}){const i=t.title,n=[];let o=null,s=null;if(be(e))o={type:"symbol-table",title:i||this._getPointCloudRendererTitle(e),infos:[]},e.colorClassBreakInfos.forEach((e=>{o.infos.unshift({label:e.label||e.minValue+" - "+e.maxValue,value:[e.minValue,e.maxValue],symbol:this._getAppliedCloneSymbol(le,e.color)})}));else if(_e(e)){const t=e.stops;let n=null;if(t?.length&&(1===t.length&&(n=t[0].color),!n)){const e=t[0].value,i=t[t.length-1].value;null!=e&&null!=i&&(n=(0,J.QQ)(e+(i-e)/2,t))}o={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(le,n||le.color)}]};const r=(0,J.NA)(e.stops??[])??[];s={type:"color-ramp",title:i||this._getPointCloudRendererTitle(e),infos:r,preview:(0,q.jT)(r.map((e=>e.color)),{ariaLabel:await Oe("previewColorRampAriaLabel")})}}else we(e)&&(o={type:"symbol-table",title:i||this._getPointCloudRendererTitle(e),infos:[]},e.colorUniqueValueInfos?.forEach((e=>{o.infos.push({label:e.label||e.values.join(", "),value:e.values.join(", "),symbol:this._getAppliedCloneSymbol(le,e.color)})})));return o?.infos.length&&n.push(o),s?.infos.length&&n.push(s),await this._generatePreviewsForLegendElements(n,{opacity:this.opacity,symbolConfig:{applyColorModulation:!!e.colorModulation}}),n}async _getElementInfoForDotDensity(e,t){const{color:i,label:n,valueExpressionTitle:o}=t,{backgroundColor:s,outline:r,dotSize:a}=e,l=this.effectList?.effects.map((e=>e.toJSON())),c=(0,R.rM)(l),d=await Oe("previewTemplateAriaLabel",n||o),u=a+"-"+i+"-"+s+"-"+(r&&JSON.stringify(r.toJSON()))+"-"+c,h=this._dotDensityUrlCache,p=h.has(u)?h.get(u):(0,q.k)(e,i,{ariaLabel:d});h.set(u,p);const y={shape:{type:"image",x:0,y:0,width:p.width,height:p.height,src:p.src},fill:null,stroke:null,offset:[0,0]},g=(0,Y.wh)([[y]],[p.width,p.height],{effectView:this.effectList,ariaLabel:d});return{opacity:1,src:p.src,preview:g,width:p.width,height:p.height}}async _constructDotDensityRendererLegendElements(e){const t=e.calculateDotValue(this.view.scale),i=e.legendOptions?.unit,n={type:"symbol-table",title:{value:t&&Math.round(t),unit:i||""},infos:[]};for(const t of e.attributes){const i=await this._getElementInfoForDotDensity(e,t);i.label=t.label||t.valueExpressionTitle||t.field,n.infos.push(i)}return[n]}async _constructPieChartRendererLegendElements(e){const t=[];let i=null;const n=e.outline;e.attributes.forEach((e=>{const i=new j.Z({color:e.color,outline:n}),o=e.label||e.valueExpressionTitle||e.field;t.push({label:o,symbol:i})}));const o=t.length?[...t]:[];if(e.othersCategory?.color&&0!==e.othersCategory?.threshold){const o=new j.Z({color:e.othersCategory.color,outline:n});i=e.othersCategory.label||"Other",t.push({label:i,symbol:o})}if(e.defaultColor?.a){const i=new j.Z({color:e.defaultColor,outline:n});t.push({label:e.defaultLabel,symbol:i})}const s=await this._getVisualVariableLegendElements(e,this.layer)||[];if(t.length){s.unshift({type:"symbol-table",title:null,infos:t});const r=o.filter((e=>e.label!==i)).map((e=>e.symbol.color)).filter(Boolean),a=(0,q.LC)(r,{holePercentage:e.holePercentage,backgroundColor:e.backgroundFillSymbol?.color,effectList:this.effectList,outline:n,ariaLabel:await Oe("previewPieChartAriaLabel")});s.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(e,this.layer),infos:t,preview:a})}return await this._generatePreviewsForLegendElements(s,{opacity:this.layer.opacity,effectView:this.effectList}),s}async _getWhereClause(e,t,i){const n=await(0,x.EP)(e,i),o=new Set,{field:s,field2:r,field3:a}=t;(0,N.gd)(o,i,[s,r,a]),(0,N.io)(o,i,t.valueExpression);const l=new Set(Array.from(o,(e=>e.toLowerCase()))),c=n?.fieldNames.map((e=>e.toLowerCase()));return c?.some((e=>!l.has(e)))?null:n}async _processDefinitionExpression(e,t){if(!("definitionExpression"in e))return;const i=e.definitionExpression;i&&this.respectLayerDefinitionExpression?this._layerDefinitionExpression!==i&&(this._layerDefinitionExpressionClause=await this._getWhereClause(i,t,e.fieldsIndex)):this._layerDefinitionExpressionClause=null,this._layerDefinitionExpression=i}async _processDisplayFilter(e,t){if(!("displayFilterInfo"in e))return;const i=e.displayFilterInfo?(0,D.UO)(e.displayFilterInfo,this.view):null;return i?.where?this._layerDisplayFilterId!==i?.id&&(this._layerDisplayFilterClause=await this._getWhereClause(i.where,t,e.fieldsIndex)):this._layerDisplayFilterClause=null,this._layerDisplayFilterId=i?.id,i}async _constructRendererLegendElements(e,t={}){const{title:i,sublayer:n}=t,o=n||this.layer,s=(0,ie.$1)(e,"reference-size"),r=(0,ie.$1)(e,"spike");let a=null;fe(e)&&(await this._processDefinitionExpression(o,e),a=await this._processDisplayFilter(o,e)),this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._scaleDrivenSizeVariable=null;const l=await this._getVisualVariableLegendElements(e,o)||[],c={type:"symbol-table",title:i||this._getRendererTitle(e,o),infos:[]};let d=null,u=!1;const h=new Set;if(de(e)&&!this._hasSizeRamp){const t=await(0,ie.y$)(e);c.infos.push({label:null,symbol:t})}else if(function(e){return"univariate-color-size"===("authoringInfo"in e?e?.authoringInfo:null)?.type}(e)){let t=i;const n=function(e){const t="authoringInfo"in e?e?.authoringInfo:null;return"univariate-color-size"===t?.type&&"above-and-below"===t?.univariateTheme}(e)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",o=l.findIndex((e=>"color-ramp"===e.type)),s=-1!==o?l.splice(o,1)[0]:null,r=l.findIndex((e=>"size-ramp"===e.type)),a=-1!==r?l.splice(r,1)[0]:null,c=[];s&&(t=s.title,c.push(s)),a&&(t=a.title,c.push(a)),c.length>0&&l.push({type:n,title:t,infos:c})}else if(ve(e)){const t=(0,Q.h)(e);l.push({type:"heatmap-ramp",title:i||this._getRendererTitle(e,o),infos:t,preview:(0,q.jT)(t.map((e=>e.color)),{effectList:this.effectList,ariaLabel:await Oe("previewColorRampAriaLabel")})})}else if(fe(e)){const t=e.authoringInfo;if(t&&"relationship"===t.type){const{numClasses:i,field1:n,field2:s}=t,r=t.focus;if(i&&n&&s){const t=[n,s];let a=(0,ee.N_)(r)||0;for(const e of t){const{field:t,normalizationField:i,label:n}=e,s=n||{field:this._getFieldAlias(t,o),normField:i&&this._getFieldAlias(i,o)},r=Pe.clone();r.angle=a,c.infos.push({label:s,symbol:r}),h.add(r),a+=90}const d=(0,ee.mg)({focus:r,numClasses:i,infos:e.uniqueValueInfos??[]});l.unshift(d)}}else if(Le(this.layer)||Te(this.layer))e.uniqueValueInfos?.forEach((t=>{t.symbol&&this._checkClausesForUVR(e,t.value)&&c.infos.push({label:t.label||t.value,value:t.value,symbol:t.symbol})}));else{const{field:t,field2:n,field3:r,fieldDelimiter:l,valueExpression:d,defaultSymbol:h}=e,p=!(!t&&!d||!n&&!r),y=this._layerDisplayFilterClause?a?.title:null,g=[];if(e.uniqueValueGroups?.forEach((i=>{const a={type:"symbol-table",title:y||i.heading,infos:[]};i.classes?.forEach((i=>{const{symbol:c,values:u}=i;if(c){const h=[],y=[];for(const e of u??[]){const{value:i,value2:s,value3:a}=e,c=[],u=[];(t||d)&&(c.push(i),u.push(this._getDomainName(t,i,o))),n&&(c.push(s),u.push(this._getDomainName(n,s,o))),r&&(c.push(a),u.push(this._getDomainName(r,a,o))),h.push(p?c.join(l||""):c[0]),y.push(u.join(" - "))}const g=h.join(", ");let m=i.label;if(!m){const e=y.filter(Boolean);m=e.length?e.join(", "):g}const f=c.clone();"cim"===f.type&&s&&(0,H.r6)(f,{innerDotSize:8,outerRingSize:16}),h.some((t=>this._checkClausesForUVR(e,t)))&&a.infos.push({label:m,value:g,symbol:f})}})),a.infos.length&&g.push(a)})),g.length){const t=g[0];if(1===g.length&&"title"in t&&!t.title){const e=t.infos?.filter(Ie)??[];c.infos.push(...e)}else h&&(g.push({type:"symbol-table",infos:[{label:e.defaultLabel||"others",symbol:h}]}),u=!0),c.infos.push(...g);i||e.legendOptions?.title||e.valueExpressionTitle||(c.title=null)}}e.defaultSymbol&&!u&&(c.infos.push({label:e.defaultLabel||"others",symbol:e.defaultSymbol}),u=!0)}else if(me(e)){if(!s&&!r){if(d=this._isUnclassedRenderer(e),!d||!this._hasSizeRamp){const t=e.classBreakInfos.filter((({symbol:e})=>e)),i="ascending-values"===e.legendOptions?.order;for(const{label:e,minValue:n,maxValue:o,symbol:s}of t){const t={label:e||(d?null:`${n} - ${o}`),value:[n,o],symbol:s};i?c.infos.push(t):c.infos.unshift(t)}d&&(c.title=null),this._updateInfosForClassedSizeRenderer(e,c.infos)}e.defaultSymbol&&!d&&(c.infos.push({label:e.defaultLabel||"others",symbol:e.defaultSymbol}),u=!0)}}else if(pe(e))if(Te(this.layer)||function(e){return"esri.layers.WCSLayer"===e.declaredClass}(this.layer)){const t=await this._constructTileImageryStretchRendererElements(e);!function(e){return"stretch-ramp"===e.type}(t)?c.infos=t:l.push(t)}else{const t=this.layer;let i,n;e.customStatistics?.length&&({min:i,max:n}=e.customStatistics[0]);let o=[],s=t.serviceRasterInfo;if(t.rasterFunction)try{s=await t.generateRasterInfo(t.rasterFunction)}catch{}const r=(0,V.rL)(s.pixelType);if(1===s.bandCount){const o=t.bandIds?.[0]||0;i=null!=i?i:s.statistics?s.statistics[o].min:r[0],n=null!=n?n:s.statistics?s.statistics[o].max:r[1],i||n?l.push(await this._getStretchLegendElements(e,{min:i,max:n})):this._getServerSideLegend()}else if(t.bandIds&&1===t.bandIds.length)i=null!=i?i:s.statistics?s.statistics[t.bandIds[0]].min:r[0],n=null!=n?n:s.statistics?s.statistics[t.bandIds[0]].max:r[1],i||n?l.push(await this._getStretchLegendElements(e,{min:i,max:n})):this._getServerSideLegend();else if(s.bandCount>=3){const{bandInfos:e}=s,{bandIds:i}=t;e.length>=s.bandCount?3===i?.length?(o=i.map((t=>e[t].name)),c.infos=this._createSymbolTableElementMultiBand(o)):"lerc"===t.format?(o=[0,1,2].map((t=>e[t].name)),c.infos=this._createSymbolTableElementMultiBand(o)):this._getServerSideLegend():"lerc"===t.format?(o=["band1","band2","band3"],c.infos=this._createSymbolTableElementMultiBand(o)):this._getServerSideLegend()}else this._getServerSideLegend()}else if(he(e))e.colormapInfos.forEach((e=>{c.infos.push({label:e.label,value:e.value,symbol:this._getAppliedCloneSymbol(ce,e.color)})}));else if(ge(e)){let i=e.symbol;switch(t.geometryType){case"point":i="pointSymbol"in o?o.pointSymbol:null;break;case"polyline":i="lineSymbol"in o?o.lineSymbol:null;break;case"polygon":i="polygonSymbol"in o?o.polygonSymbol:null}const n=this._hasClusterSizeVariable&&this._getClusterSymbol()||!this._hasSizeRamp;e.symbol&&n&&c.infos.push({label:e.label,symbol:i})}else if(ue(e)){e.outputUnit&&(this.title="("+e.toJSON().outputUnit+")"),c.title=e.attributeField;const t=e.getClassBreakInfos();t?.length?t.forEach((e=>{c.infos.push({label:e.minValue+" - "+e.maxValue,symbol:e.symbol})})):c.infos.push({label:e.attributeField,symbol:e.getDefaultSymbol()})}else ye(e)&&l.push(await this._getStretchLegendElements(e,{min:0,max:255}));const p=e.defaultSymbol;!p||u||ge(e)||d&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||l.push({type:"symbol-table",infos:[{label:e.defaultLabel||"others",symbol:p}]}),c.infos.length&&l.unshift(c);const y=null==t.opacity?this.opacity:t.opacity,g=this._isTallSymbol("visualVariables"in e?e.visualVariables:null),m=Le(this.layer)||Te(this.layer);return await this._generatePreviewsForLegendElements(l,{opacity:y,symbolConfig:{isTall:g,isSquareFill:m},effectView:this.effectList},{defaultSymbol:p,arrowMarkerSymbols:h}),e=null,l}_checkClausesForUVR(e,t){const i=function(e,t){const{field:i,field2:n,field3:o,fieldDelimiter:s,valueExpression:r}=e;if(!i)return null;const a=(i||r)&&(n||o)?t?.toString().split(s||""):[t],l=i?{[i]:a?.[0]}:null;return l&&(n&&(l[n]=a?.[1]),o&&(l[o]=a?.[2])),l}(e,t);return!i||(!this._layerDefinitionExpressionClause||this._layerDefinitionExpressionClause.testFeature(i))&&(!this._layerDisplayFilterClause||this._layerDisplayFilterClause.testFeature(i))}_getServerSideLegend(){setTimeout((()=>this.buildLegendElementsForTools()),0)}_getAllInfos(e){const t=e?.infos;return t?t.reduce(((e,t)=>e.concat(this._getAllInfos(t))),[]):[e]}async _constructTileImageryStretchRendererElements(e){const t=this.layer,i=t.symbolizer.rasterInfo??t.raster.rasterInfo;let n,o;const s=e?.customStatistics?.length?e.customStatistics:i?.statistics;if(s)({min:n,max:o}=s[0]);else{const e=(0,V.rL)(i.pixelType);n=e[0],o=e[1]}if(t.hasStandardTime()&&(n=t.getStandardTimeValue(n),o=t.getStandardTimeValue(o)),1===i.bandCount||1===t.bandIds?.length)return this._getStretchLegendElements(e,{min:n,max:o});const r=(t?.bandIds?.length?t.bandIds:Array.from(Array(Math.min(i.bandCount,3)).keys())).map((e=>i.bandInfos[e].name));return r.length<3?r.push(r[1]):r.length>3&&r.splice(3),this._createSymbolTableElementMultiBand(r)}async _getStretchLegendElements(e,t){const i=e.colorRamp,n=(0,J.XO)(i,t);return{type:"stretch-ramp",title:"",infos:n,preview:(0,q.jT)(n.map((e=>e.color)),{ariaLabel:await Oe("previewColorRampAriaLabel")})}}_getClusterSymbol(){const e=this.layer,t="featureReduction"in e&&e.featureReduction,i=t&&"symbol"in t&&t.renderer;return i&&!0!==i?.authoringInfo?.isAutoGenerated?null:t&&"symbol"in t?t.symbol:null}async _getSizeLegendElement(e,t,i,n){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(t):e,infos:await(0,te.getRampStops)(i,t,await(0,ie.jb)(i),this.scale,this.view,n,this._hasClusterSizeVariable?this._getClusterSymbol():null)}}_createSymbolTableElementMultiBand(e){const t=[],i=["red","green","blue"];return e.forEach(((e,n)=>{t.push({label:{colorName:i[n],bandName:e},src:ie.iP[n],opacity:this.opacity??1})})),t}_updateInfosForClassedSizeRenderer(e,t){const i=e.authoringInfo&&"class-breaks-size"===e.authoringInfo.type,n=e.classBreakInfos.some((e=>(0,X.YW)(e.symbol)));if(i&&n){const i=te.p5,n=te.QB,o=e.classBreakInfos.length,s=(i-n)/(o>1?o-1:o);t.forEach(((e,t)=>{e.size=i-s*t}))}}_isTallSymbol(e){let t=!1,i=!1;if(e)for(let n=0;n<e.length&&(!t||!i);n++){const o=e[n];"size"===o.type&&("height"===o.axis&&(t=!0),"width-and-depth"===o.axis&&(i=!0))}return t&&i}async _generatePreviewsForLegendElements(e,t,i){const n=[];for(const o of e)for(const e of o.infos??[])if("infos"in e&&e.infos&&n.push(this._generatePreviewsForLegendElements([e],t,i)),Ie(e)&&e.symbol&&!e.preview){let s=!0;if("cim"===e.symbol.type){const{minScale:t,maxScale:i}=e.symbol.data;(t&&t<this.scale||i&&i>this.scale)&&(s=!1)}s&&n.push(this._generateSymbolPreviewForInfo(e,{...t,clipBloomEffect:"theme"in o&&"spike"===o.theme,effectView:i?.arrowMarkerSymbols?.has(e.symbol)?null:t.effectView},i?{isDefault:e.symbol===i.defaultSymbol,applyScaleDrivenSize:!i.arrowMarkerSymbols?.has(e.symbol)}:void 0))}await Promise.all(n)}async _generateSymbolPreviewForInfo(e,t,n){try{let o=!n?.isDefault&&null==e.size&&this._hasSizeRamp?(0,C.Wz)(W.b_.size):e.size;if(this._scaleDrivenSizeVariable&&n?.applyScaleDrivenSize){const{getSize:t}=await Promise.resolve().then(i.bind(i,71618));o=t(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:"simple-marker"===e.symbol.type?e.symbol.style:null})}const s="cim"===e.symbol.type?{style:"legend",cimOptions:{allowScalingUp:!n?.isDefault&&this._hasSizeRamp||!(!this._scaleDrivenSizeVariable||!n?.applyScaleDrivenSize),viewParams:this.isScaleDriven?{viewingMode:"2d"===this.view?.type?"map":this.view?.viewingMode,scale:this.view?.scale}:null}}:{},r=e.label&&"string"!=typeof e.label?null:await Oe("previewTemplateAriaLabel",e.label);e.preview=await(0,q.l3)(e.symbol,{size:o,scale:!1,ariaLabel:r,...t,...s})}catch{e.preview=null,h.Z.getLogger(this).warn(`Generating symbol preview failed for symbol type: ${e.symbol?.type}`)}}_getClusterRenderer(e){this._hasClusterSizeVariable=!1;const t="renderer"in this.layer?this.layer.renderer:null,i=e.renderer?.clone()||t?.clone(),n=function(e,t,i){const n=e.effectiveClusterRenderer;if(!n||!("visualVariables"in n)||!n.visualVariables)return null;const o=n.visualVariables.find((e=>"size"===e.type));if(!("stops"in o)||!o.stops)return null;const s=o.stops.find((e=>e.useMinValue)),r=o.stops.find((e=>e.useMaxValue));if(null==s||null==r)return null;const a=i.featuresTilingScheme.getClosestInfoForScale(i.scale).level,l=o.field,c=t.getDisplayStatistics(a,l);return c?new B.Z({field:o.field,minSize:e.clusterMinSize,minDataValue:c.minValue,maxSize:e.clusterMaxSize,maxDataValue:c.maxValue}):null}(e,this.layerView,this.view);if(n&&null!=i&&"visualVariables"in i){const t=i.visualVariables?.some((e=>"size"===e.type&&"outline"!==e.target&&!re.test(e.valueExpression)));if(!t){if("clusterMinSize"in e&&"clusterMaxSize"in e){const{clusterMinSize:t,clusterMaxSize:i}=e;n.legendOptions=new U.Z({showLegend:t!==i})}const t=i.visualVariables||[];i.visualVariables=t.concat([n]),this._hasClusterSizeVariable=!0}}return i}async _loadRenderer(e){const t=[],i=e.clone(),n=await(0,ie.jb)(i);if(me(i)||fe(i)){const e=(i.classBreakInfos||i.uniqueValueInfos).map((e=>this._fetchSymbol(e.symbol,n).then((t=>{e.symbol=t})).catch((()=>{e.symbol=null}))));Array.prototype.push.apply(t,e)}return t.push(this._fetchSymbol(i.symbol||i.defaultSymbol,i.defaultSymbol?null:n).then((e=>{this._applySymbolToRenderer(i,e,ge(i))})).catch((()=>{this._applySymbolToRenderer(i,null,ge(i))}))),await Promise.allSettled(t),i}_applySymbolToRenderer(e,t,i){i?e.symbol=t:e.defaultSymbol=t}async _fetchSymbol(e,t){if(!e)throw new Error;if("web-style"===e.type){const i=this._webStyleSymbolCache;try{const n=await e.fetchSymbol({cache:i});return this._getAppliedCloneSymbol(n,t)}catch{throw h.Z.getLogger(this).warn("Fetching web-style failed!"),new Error}}return this._getAppliedCloneSymbol(e,t)}_getAppliedCloneSymbol(e,t){if(!e||!t)return e;const i=e.clone(),n=t&&t.toRgba();return i.type.includes("3d")?this._applyColorTo3dSymbol(i,n):"cim"===i.type?(0,K.ZB)(i,t):i.color&&(i.color=new g.Z(n||i.color)),i}_applyColorTo3dSymbol(e,t){t&&e.symbolLayers.forEach((e=>{e&&(e.material||(e.material={}),e.material.color=new g.Z(t))}))}async _getVisualVariableLegendElements(e,t){if(!("visualVariables"in e)||"vector-field"===e.type)return null;const i=e.visualVariables??[],n=[],o=[],s=[],r=(0,ie.$1)(e,"reference-size")??(0,ie.$1)(e,"spike");let a;if(2===r?.sizeStops?.length&&(me(e)||fe(e))){const[e,t]=r.sizeStops;a=new B.Z({field:r.field??void 0,normalizationField:r.normalizationField,minSize:(0,_.uZ)(e.size,10,100),maxSize:(0,_.uZ)(t.size,50,150),minDataValue:e.value,maxDataValue:t.value}),o.push(a)}for(const e of i)"color"===e.type?n.push(e):"size"===e.type?o.push(e):"opacity"===e.type&&s.push(e);const l=[...n,...o,...s];let c,d;if(0===n.length&&me(e)&&e.classBreakInfos&&1===e.classBreakInfos.length){const t=e.classBreakInfos[0];c=t&&t.symbol}if(0===n.length&&ge(e)&&(c=e.symbol),c)if(c.type.includes("3d")){const e=c.symbolLayers.at(0);"water"===e.type?null!=e.color&&(d=e.color):null!=e.material?.color&&(d=e.material.color)}else c.url||(d=c.color);const u=this.effectList;return(await Promise.all(l.map((async i=>{if(!i.legendOptions||!1!==i.legendOptions.showLegend){const n=de(e)?i.field:this._getRampTitle(i,t);let o=null;const s=(0,ie.getDateFormatOptions)(t,i,this.view.timeZone);if("color"===i.type){const e=await(0,J.getRampStops)(i,null,s)??[];o={type:"color-ramp",title:n,infos:e,preview:(0,q.jT)(e.map((e=>e.color)),{effectList:u,ariaLabel:await Oe("previewColorRampAriaLabel")})},this._hasColorRamp||(this._hasColorRamp=e.length>0)}else if("size"===i.type&&"outline"!==i.target)re.test(i.valueExpression)?this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=i):(o=await this._getSizeLegendElement(n,i,e,s),a===i&&"spike"===r?.theme&&(o.theme=r.theme),this._hasSizeRamp||(this._hasSizeRamp=!(null==o.infos||!o.infos.length)));else if("opacity"===i.type){const e=await(0,J.getRampStops)(i,d,s)??[];o={type:"opacity-ramp",title:n,infos:e,preview:(0,q.jT)(e.map((e=>e.color)),{effectList:u,ariaLabel:await Oe("previewColorRampAriaLabel")})},this._hasOpacityRamp||(this._hasOpacityRamp=e.length>0)}return o?.infos?o:null}})))).filter(v.pC)}_getDomainName(e,t,i){if(e&&"function"!=typeof e){const n="getField"in i&&i.getField?.(e),o=n&&"getFieldDomain"in i&&i.getFieldDomain?i.getFieldDomain(n.name,{excludeImpliedDomains:(0,a.Z)("esri-widget-legacy-field-domain-calculation")}):null;return"coded-value"===o?.type?o.getName(t):null}return null}_getClusterTitle(e){const t=this.layer,i=e.field;if("featureReduction"in t&&t.featureReduction&&"cluster"===t.featureReduction.type){const e=t.featureReduction,n="popupTemplate"in e&&e.popupTemplate,o=n&&n.fieldInfos;if(o)for(const e of o)if(e.fieldName===i)return"cluster_count"===i?e.label||{showCount:!0}:e.label}return{showCount:!0}}_getRampTitle(e,t){let i=e.field,n=e.normalizationField,o=!1,s=!1,r=!1,a=null;i="function"==typeof i?null:i,n="function"==typeof n?null:n;const l=e.legendOptions?.title;if(null!=l)a=l;else if(e.valueExpressionTitle)a=e.valueExpressionTitle;else{if("renderer"in t&&t.renderer&&"authoringInfo"in t.renderer&&t.renderer.authoringInfo?.visualVariables){const e=t.renderer.authoringInfo.visualVariables;for(let t=0;t<e.length;t++){const i=e[t];if("color"===i.type){if("ratio"===i.style){o=!0;break}if("percent"===i.style){s=!0;break}if("percent-of-total"===i.style){r=!0;break}}}}a={field:i&&this._getFieldAlias(i,t),normField:n&&this._getFieldAlias(n,t),ratio:o,ratioPercent:s,ratioPercentTotal:r}}return a}_getRendererTitle(e,t){const i=e;if(i.legendOptions?.title)return i.legendOptions.title;if(i.valueExpressionTitle)return i.valueExpressionTitle;let n=i.field,o=null,s=null;if(me(i)&&(o=i.normalizationField,s="percent-of-total"===i.normalizationType),n="function"==typeof n?null:n,o="function"==typeof o?null:o,fe(i)){const{field2:e,field3:o,fieldDelimiter:s}=i;let r=n&&this._getFieldAlias(n,t);return e&&(r=`<${r}>${s}<${this._getFieldAlias(e,t)}>`,o&&(r=`${r}${s}<${this._getFieldAlias(o,t)}>`)),r}let r=null;return(n||o)&&(r={field:n&&this._getFieldAlias(n,t),normField:o&&this._getFieldAlias(o,t),normByPct:s}),r}_getFieldAlias(e,t){const i=("popupTemplate"in t?t.popupTemplate:null)?.fieldInfos;let n=i?.find((t=>e===t.fieldName)),o=null;"getField"in t&&t.getField?o=t.getField(e):"fieldsIndex"in t&&t.fieldsIndex&&(o=t.fieldsIndex.get(e));let s=null;const r="featureReduction"in t&&t.featureReduction;r&&(n??="popupTemplate"in r?r.popupTemplate?.fieldInfos?.find((t=>e?.toLowerCase()===t.fieldName?.toLowerCase())):void 0,"fields"in r&&r.fields&&(s=r.fields.find((t=>t.name?.toLowerCase()===e?.toLowerCase()))));const a=n||o||s;let l=null;return a&&(l=n?.label||o?.alias||s?.alias||"name"in a&&a.name||"fieldName"in a&&a.fieldName||null),l}_isUnclassedRenderer(e){const t=e.visualVariables;let i=!1;return me(e)&&e.classBreakInfos&&1===e.classBreakInfos.length&&t&&(i=e.field?t.some((t=>!(!t||e.field!==t.field||(e.normalizationField||t.normalizationField)&&e.normalizationField!==t.normalizationField))):!!t.length),i}};(0,n._)([(0,s.Cb)()],Re.prototype,"children",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],Re.prototype,"effectList",null),(0,n._)([(0,s.Cb)()],Re.prototype,"layerView",void 0),(0,n._)([(0,s.Cb)()],Re.prototype,"layer",void 0),(0,n._)([(0,s.Cb)()],Re.prototype,"legendElements",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],Re.prototype,"opacity",null),(0,n._)([(0,s.Cb)()],Re.prototype,"parent",void 0),(0,n._)([(0,s.Cb)({readOnly:!0,dependsOn:[]})],Re.prototype,"ready",null),(0,n._)([(0,s.Cb)()],Re.prototype,"hideLayersNotInCurrentView",void 0),(0,n._)([(0,s.Cb)()],Re.prototype,"keepCacheOnDestroy",void 0),(0,n._)([(0,s.Cb)()],Re.prototype,"respectLayerDefinitionExpression",void 0),(0,n._)([(0,s.Cb)()],Re.prototype,"respectLayerVisibility",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],Re.prototype,"scale",null),(0,n._)([(0,s.Cb)()],Re.prototype,"sublayerIds",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],Re.prototype,"isScaleDriven",null),(0,n._)([(0,s.Cb)()],Re.prototype,"title",void 0),(0,n._)([(0,s.Cb)({readOnly:!0,dependsOn:["ready"],value:0})],Re.prototype,"version",null),(0,n._)([(0,s.Cb)()],Re.prototype,"view",void 0),Re=(0,n._)([(0,l.j)("esri.widgets.Legend.support.ActiveLayerInfo")],Re);var De=i(74765);const $e="state",Ne="view",Fe="all-layer-views",Ve="legend-properties",ze=u.Z.ofType(Re),Ze=new Set(["esri.layers.BuildingSceneLayer","esri.layers.CatalogLayer","esri.layers.CSVLayer","esri.layers.FeatureLayer","esri.layers.GeoJSONLayer","esri.layers.GeoRSSLayer","esri.layers.GroupLayer","esri.layers.HeatmapLayer","esri.layers.ImageryLayer","esri.layers.ImageryTileLayer","esri.layers.MapImageLayer","esri.layers.OGCFeatureLayer","esri.layers.OrientedImageryLayer","esri.layers.ParquetLayer","esri.layers.PointCloudLayer","esri.layers.StreamLayer","esri.layers.SceneLayer","esri.layers.SubtypeGroupLayer","esri.layers.TileLayer","esri.layers.VoxelLayer","esri.layers.WFSLayer","esri.layers.WMSLayer","esri.layers.WMTSLayer","esri.layers.WCSLayer","esri.layers.LinkChartLayer","esri.layers.catalog.CatalogFootprintLayer","esri.layers.catalog.CatalogDynamicGroupLayer","esri.layers.knowledgeGraph.KnowledgeGraphSublayer","esri.layers.KnowledgeGraphLayer"]),Be="view.basemapView.baseLayerViews",Ue="view.groundView.layerViews",He="view.basemapView.referenceLayerViews",Ge=[Be,Ue,"view.layerViews",He];let je=class extends d.Z{constructor(e){super(e),this._layerViewByLayerId={},this._layerInfosByLayerViewId={},this._activeLayerInfosByLayerViewId={},this._activeLayerInfosWithNoParent=new u.Z,this.activeLayerInfos=new ze,this.basemapLegendVisible=!1,this.groundLegendVisible=!1,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerDefinitionExpression=!1,this.respectLayerVisibility=!0,this.layerInfos=[],this.view=null}initialize(){this.addHandles((0,o.YP)((()=>this.view),(()=>this._viewHandles()),o.nn),Ne),this.addHandles((0,De.qe)((()=>this._refresh())))}destroy(){this._destroyViewActiveLayerInfos(),this.view=null}get state(){return this.view?.ready?"ready":"disabled"}_viewHandles(){this.removeHandles($e),this.view&&this.addHandles((0,o.YP)((()=>this.state),(()=>this._stateHandles()),o.nn),$e)}_stateHandles(){this._resetAll(),"ready"===this.state&&this._watchPropertiesAndAllLayerViews()}_resetAll(){this.removeHandles([Fe,Ve]),this._destroyViewActiveLayerInfos(),this.activeLayerInfos.removeAll()}_destroyViewActiveLayerInfos(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)}_destroyViewActiveLayerInfo(e){this.removeHandles(e);const t=this._activeLayerInfosByLayerViewId[e];delete this._activeLayerInfosByLayerViewId[e],t?.parent&&t.parent.children.remove(t)}_watchPropertiesAndAllLayerViews(){const{view:e}=this;if(!e)return;const{allLayerViews:t}=e;t.length&&this._refresh(),this.addHandles(t.on("change",(e=>this._allLayerViewsChangeHandle(e))),Fe),this.addHandles((0,o.YP)((()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible]),(()=>this._propertiesChangeHandle())),Ve)}_allLayerViewsChangeHandle(e){e.moved.length?this._propertiesChangeHandle():(e.removed.forEach((e=>this._destroyViewActiveLayerInfo(e.uid))),this._refresh())}_propertiesChangeHandle(){this._destroyViewActiveLayerInfos(),this._refresh()}_refresh(){this._layerInfosByLayerViewId={},this.activeLayerInfos.removeAll(),this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this),this._sortActiveLayerInfos(this.activeLayerInfos)}_sortActiveLayerInfos(e){const t=this.view;if(e.length<2||!t)return;const i=[];e.forEach((t=>{if(!t.parent){const n=t.layer.parent,o=n&&"uid"in n&&this._layerViewByLayerId[n.uid],s=o&&this._activeLayerInfosByLayerViewId[o.uid];s&&e.includes(s)&&(i.push(t),t.parent=s,s.children.add(t),this._sortActiveLayerInfos(s.children))}})),e.removeMany(i);const n={};t.allLayerViews.forEach(((e,t)=>n[e.layer.uid]=t)),e.sort(((e,t)=>{const i=n[e.layer.uid]||0;return(n[t.layer.uid]||0)-i}))}_generateLayerViews(){const e=[];return Ge.filter(this._filterLayerViews,this).map((e=>(0,p.U2)(this,e))).filter((e=>null!=e)).forEach(this._collectLayerViews("layerViews",e)),e}_filterLayerViews(e){const t=!this.basemapLegendVisible&&(e===Be||e===He),i=!this.groundLegendVisible&&e===Ue;return!t&&!i}_collectLayerViews(e,t){const i=n=>(n&&n.forEach((n=>{t.push(n),i(n[e])})),t);return i}_filterLayerViewsByLayerInfos(e){const t=this.layerInfos;return!t||!t.length||t.some((t=>this._hasLayerInfo(t,e)))}_hasLayerInfo(e,t){const i=this._isLayerUIDMatching(e.layer,t.layer.uid);return i&&(this._layerInfosByLayerViewId[t.uid]=e),i}_isLayerUIDMatching(e,t){return e&&(e.uid===t||this._hasLayerUID(e.layers,t))}_hasLayerUID(e,t){return e&&e.some((e=>this._isLayerUIDMatching(e,t)))}_isLayerViewSupported(e){return!!Ze.has(e.layer.declaredClass)&&(this._layerViewByLayerId[e.layer.uid]=e,!0)}_generateActiveLayerInfo(e){this._isLayerActive(e)?this._buildActiveLayerInfo(e):(this.removeHandles(e.uid),this.addHandles((0,o.YP)((()=>[e.legendEnabled,e.layer?.legendEnabled]),(()=>this._layerActiveHandle(e))),e.uid))}_layerActiveHandle(e){this._isLayerActive(e)&&(this.removeHandles(e.uid),this._buildActiveLayerInfo(e))}_isLayerActive(e){return!this.respectLayerVisibility||e.legendEnabled&&e.layer?.legendEnabled}_buildActiveLayerInfo(e){const t=e.layer,i=e.uid,n=this._layerInfosByLayerViewId[i];let s=this._activeLayerInfosByLayerViewId[i];if(!s){const o=void 0!==n?.title&&n.layer.uid===t.uid;s=new Re({layer:t,layerView:e,title:o?n.title:t.title,view:this.view??void 0,respectLayerDefinitionExpression:this.respectLayerDefinitionExpression,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:n?.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[i]=s}const r=t.parent&&"uid"in t.parent?this._layerViewByLayerId[t.parent?.uid]:null;if(s.parent=this._activeLayerInfosByLayerViewId[r?.uid],!this.hasHandles(i)){const n=[(0,o.YP)((()=>t.title),(e=>this._titleHandle(e,s))),(0,o.YP)((()=>[t.opacity,"renderer"in t&&t.renderer,"pointSymbol"in t&&t.pointSymbol,"lineSymbol"in t&&t.lineSymbol,"polygonSymbol"in t&&t.polygonSymbol]),(()=>this._constructLegendElements(s))),(0,o.gx)((()=>!0===this.view?.stationary),(()=>this._scaleHandle(s)),o.nn),(0,o.YP)((()=>e.layer?y(e.layer,e.view):null),(()=>this._constructLegendElements(s))),(0,o.YP)((()=>e.updating),(()=>{null!=e.layer&&null!=y(e.layer,e.view)&&this._constructLegendElements(s)})),(0,o.YP)((()=>"effect"in t&&t.effect),(()=>this._constructLegendElements(s))),(0,o.gx)((()=>this.view?.timeZone),(()=>this._constructLegendElements(s)),o.nn)];if(this.respectLayerVisibility){const i=(0,o.YP)((()=>e.legendEnabled),(e=>this._legendEnabledHandle(e,s))),r=(0,o.YP)((()=>t.legendEnabled),(e=>this._legendEnabledHandle(e,s)));n.push(i,r)}if(this.respectLayerDefinitionExpression&&"definitionExpression"in t){const e=(0,o.YP)((()=>[t.definitionExpression,this.respectLayerDefinitionExpression]),(()=>{s.respectLayerDefinitionExpression=this.respectLayerDefinitionExpression,this._constructLegendElements(s)}));n.push(e)}this.addHandles(n,i)}s.isScaleDriven||this._constructLegendElements(s),this._addActiveLayerInfo(s)}_titleHandle(e,t){t.title=e,this._constructLegendElements(t)}_legendEnabledHandle(e,t){e?this._addActiveLayerInfo(t):this._removeActiveLayerInfo(t)}_scaleHandle(e){(e.isScaleDriven||e.hideLayersNotInCurrentView)&&this._constructLegendElements(e)}_addActiveLayerInfo(e){const{layerView:t,layer:i}=e;if(this._isLayerActive(t)&&!this.activeLayerInfos.includes(e)){const t=e.parent;if(t)t.children.includes(e)||t.children.push(e),this._sortActiveLayerInfos(t.children);else{const t=this.layerInfos?.some((e=>e.layer.uid===i.uid)),n=i.parent;n&&"uid"in n&&this._layerViewByLayerId[n.uid]&&!t?this._activeLayerInfosWithNoParent.add(e):(this.activeLayerInfos.add(e),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const e=[];this._activeLayerInfosWithNoParent.forEach((t=>{const i=t.layer.parent,n=i&&"uid"in i?this._layerViewByLayerId[i?.uid]:null,o=this._activeLayerInfosByLayerViewId[n?.uid];o&&(e.push(t),t.parent=o)})),e.length&&(this._activeLayerInfosWithNoParent.removeMany(e),e.forEach((e=>this._addActiveLayerInfo(e))))}}}_removeActiveLayerInfo(e){const t=e.parent;t?t.children.remove(e):this.activeLayerInfos.remove(e)}_constructLegendElements(e){const t=e.layer;"featureCollections"in t&&t.featureCollections?e.buildLegendElementsForFeatureCollections(t.featureCollections):"featureReduction"in t&&t.featureReduction&&"renderer"in t.featureReduction&&("binning"===t.featureReduction.type||"cluster"===t.featureReduction.type)&&(!this.view||t.featureReduction.maxScale<=this.view.scale)?e.buildLegendElementsForFeatureReduction(t.featureReduction):"renderer"in t&&t.renderer&&!("sublayers"in t)?e.buildLegendElementsForRenderer(t.renderer):"url"in t&&t.url&&"catalog"!==t.type&&"knowledge-graph"!==t.type?e.buildLegendElementsForTools():e.children.forEach((e=>this._constructLegendElements(e)))}};(0,n._)([(0,s.Cb)({type:ze})],je.prototype,"activeLayerInfos",void 0),(0,n._)([(0,s.Cb)()],je.prototype,"basemapLegendVisible",void 0),(0,n._)([(0,s.Cb)()],je.prototype,"groundLegendVisible",void 0),(0,n._)([(0,s.Cb)()],je.prototype,"hideLayersNotInCurrentView",void 0),(0,n._)([(0,s.Cb)()],je.prototype,"keepCacheOnDestroy",void 0),(0,n._)([(0,s.Cb)()],je.prototype,"respectLayerDefinitionExpression",void 0),(0,n._)([(0,s.Cb)()],je.prototype,"respectLayerVisibility",void 0),(0,n._)([(0,s.Cb)()],je.prototype,"layerInfos",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],je.prototype,"state",null),(0,n._)([(0,s.Cb)()],je.prototype,"view",void 0),je=(0,n._)([(0,l.j)("esri.widgets.Legend.LegendViewModel")],je);const Ke="esri-legend--card",We="esri-legend",Ye={activated:`${Ke}__carousel-indicator--activated`,base:Ke,stacked:`${We}--stacked`,carouselTitle:`${Ke}__carousel-title`,indicator:`${Ke}__carousel-indicator`,intervalSeparator:`${Ke}__interval-separator`,imageryLayerStretchedImage:`${Ke}__imagery-layer-image--stretched`,imageLabel:`${Ke}__image-label`,layerCaption:`${Ke}__layer-caption`,labelElement:`${Ke}__label-element`,layerRow:`${Ke}__layer-row`,labelCell:`${Ke}__label-cell`,message:`${Ke}__message`,rampLabel:`${Ke}__ramp-label`,section:`${Ke}__section`,relationshipSection:`${Ke}__relationship-section`,serviceCaptionText:`${Ke}__service-caption-text`,serviceContent:`${Ke}__service-content`,service:`${Ke}__service`,groupLayer:`${Ke}__group-layer`,groupLayerChild:`${Ke}__group-layer-child`,symbol:`${Ke}__symbol`,sizeRampRow:`${Ke}__size-ramp-row`,symbolRow:`${Ke}__symbol-row`,symbolCell:`${Ke}__symbol-cell`,carousel:`${Ke}__carousel`,carouselItem:`${Ke}__carousel-item`,indicatorContainer:`${Ke}__carousel-indicator-container`,intervalSeparatorsContainer:`${Ke}__interval-separators-container`,relationshipLabelContainer:`${Ke}__relationship-label-container`,labelContainer:`${Ke}__label-container`,serviceCaptionContainer:`${Ke}__service-caption-container`,symbolContainer:`${Ke}__symbol-container`,colorRampContainer:`${Ke}__color-ramp-container`,sizeRampContainer:`${Ke}__size-ramp-container`,sizeRampPreview:`${Ke}__size-ramp-preview`,pieChartRampPreview:`${Ke}__pie-chart-ramp-preview`,rampContainer:`${We}__ramps`,sizeRampHorizontal:`${We}__size-ramp--horizontal`,rampLabelsContainer:`${We}__ramp-labels`,layerInfo:`${We}__layer-cell ${We}__layer-cell--info`,univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card"};var qe=i(74783),Xe=i(29138);function Je(e){e.appendChild(this)}function Qe(e,t,i){if(!t)return;if("number"==typeof t)return t;if("string"==typeof t)return(0,Xe.Cb)(t);if("value"in t||"unit"in t)return(0,se.n)(e.dotValue,t);if("colorName"in t&&"bandName"in t)return e[t.colorName]+": "+(e[t.bandName]||t.bandName);if("showCount"in t)return t.showCount?e.clusterCountTitle:void 0;let n=null;return function(e,t){return t}(0,i)?n=t.ratioPercentTotal?"showRatioPercentTotal":t.ratioPercent?"showRatioPercent":t.ratio?"showRatio":t.normField?"showNormField":t.field?"showField":null:et(t,i)&&(n=t.normField?"showNormField":t.normByPct?"showNormPct":t.field?"showField":null),n?(0,se.n)("showField"===n?"{field}":e[n],{field:t.field,normField:t.normField}):void 0}function et(e,t){return!t}function tt(e,t){return!!(t&&"Stretched"===t&&"version"in e&&"number"==typeof e.version&&e.version>=10.3&&"esri.layers.ImageryLayer"===e.declaredClass)}function it(e,t,i){switch(t){case"heatmap-ramp":return i[e.label]||e.label;case"stretch-ramp":return function(e,t){return e.label?t[e.label]+": "+("string"==typeof e.value?e.value:(0,ne.uf)(e.value??0,{style:"decimal",notation:e.value?.toString().toLowerCase().includes("e")?"scientific":"standard"})):""}(e,i);default:return e.label}}function nt(e,t){if(!e.title||"string"==typeof e.title)return e.title;const i="color-ramp"===e.type||"opacity-ramp"===e.type,n=e.title,o=Qe(t,n,i);return et(0,i)&&n.title?`${n.title} (${o})`:o}function ot(e){return!(!e||"object"!=typeof e)}var st=i(68808),rt=i(23039);let at=class extends c.Z{constructor(e,t){super(e,t),this.effectList=null,this.legendElement=null,this.opacity=1}render(){const e=this.legendElement.infos.slice().reverse();return(0,rt.u)("div",{class:this.classes(Ye.layerRow,Ye.colorRampContainer)},this._renderRampLabel(e[0]),(0,rt.u)("div",{class:Ye.symbolContainer},this._renderPreview(e),this._renderMiddleStopRampLabel(e)),this._renderRampLabel(e.at(-1)))}_renderPreview(e){const{opacity:t}=this,i="heatmap-ramp"===this.legendElement.type,n=e.length-1,o=25,s=n>2&&!i?25*n:100,r=s+20,a=10,l=[[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:e[0].color,stroke:{width:0}},{shape:{type:"rect",x:a,y:0,width:s,height:o},fill:{type:"linear",x1:a,y1:0,x2:s+a,y2:0,colors:e.map(((e,t)=>({color:e.color,offset:i&&"ratio"in e?e.ratio:t/n})))},stroke:{width:0}},{shape:{type:"path",path:`M${s+a} 0 L${r} 12.5 L${s+a} 25 Z`},fill:e[e.length-1].color,stroke:{width:0}}]],c=(0,qe.KB)(l,r,o),d={filter:(0,X.wJ)(this.effectList)??void 0,opacity:null==t?void 0:`${t}`};return(0,rt.u)("div",{styles:d},c)}_renderMiddleStopRampLabel(e){const t=e.length%2!=0?e[e.length/2|0]:null;return t?(0,rt.u)("div",{class:Ye.intervalSeparatorsContainer},(0,rt.u)("div",{class:Ye.intervalSeparator},"|"),this._renderRampLabel(t)):null}_renderRampLabel(e){return(0,rt.u)("div",{class:Ye.rampLabel},it(e,this.legendElement.type,this.messages))}};(0,n._)([(0,s.Cb)()],at.prototype,"effectList",void 0),(0,n._)([(0,s.Cb)()],at.prototype,"legendElement",void 0),(0,n._)([(0,s.Cb)()],at.prototype,"messages",void 0),(0,n._)([(0,s.Cb)()],at.prototype,"opacity",void 0),at=(0,n._)([(0,l.j)("esri.widgets.Legend.styles.card.ColorRamp")],at);const lt="#ddd",ct=window.devicePixelRatio,dt="esri-spike-ramp",ut={spikeRampContainer:`${dt}__container`,spikeRampPreviewContainer:`${dt}__preview-container`,spikeRampPreview:`${dt}__preview`,spikeRampSymbolPreview:`${dt}__symbol-preview`,spikeRampLines:`${dt}__lines`,spikeRampLabelsContainer:`${dt}__labels-container`,spikeRampLabel:`${dt}__label`};function ht(e){return 5!==e.infos.length?null:(0,rt.u)("div",{class:ut.spikeRampContainer},(0,rt.u)("div",{class:ut.spikeRampPreviewContainer},function(e){const[t,i,n]=pt(e).map((({preview:e})=>{if(!e)return null;const t=e.cloneNode(!0);return t.classList.add(ut.spikeRampSymbolPreview),t}));return t&&i&&n?(0,rt.u)("div",{class:ut.spikeRampPreview},(0,rt.u)("div",{afterCreate:Je,bind:n}),(0,rt.u)("div",{afterCreate:Je,bind:i}),(0,rt.u)("div",{afterCreate:Je,bind:t})):null}(e),function(e){const[{width:t,height:i},{width:n},{width:o,height:s}]=pt(e).map((({size:e})=>ot(e)?{width:(0,C.F2)(e.width),height:(0,C.F2)(e.height)}:{width:0,height:0})),r=10,a=8,l=t+n+o+3*r,c=i,d=document.createElement("canvas");d.width=(l+r)*ct,d.height=c*ct,d.style.width=d.width/ct+"px",d.style.height=d.height/ct+"px";const u=d.getContext("2d");u.beginPath();const h=l-(t/2+r),p=0,y=l+a,g=0;u.moveTo(h*ct,p*ct),u.lineTo(y*ct,g*ct);const m=(l-a)/2,f=(i-s)/2,v=l+a,b=(i-s)/2;u.moveTo(m*ct,f*ct),u.lineTo(v*ct,b*ct);const _=o/2,w=c-s,x=l+a,S=c-s;return u.moveTo(_*ct,w*ct),u.lineTo(x*ct,S*ct),u.strokeStyle=lt,u.lineWidth=.5*ct,u.stroke(),(0,rt.u)("div",{afterCreate:Je,bind:d,class:ut.spikeRampLines})}(e)),function(e){const[{label:t,height:i},{label:n},{label:o,height:s}]=pt(e).map((({label:e,size:t})=>({label:e,height:ot(t)?(0,C.F2)(t.height):0}))),r=i-s,a={position:"absolute",top:"0"},l={position:"absolute",top:r/2+"px"},c={position:"absolute",top:`${r}px`};return(0,rt.u)("div",{class:ut.spikeRampLabelsContainer},(0,rt.u)("div",{class:ut.spikeRampLabel,styles:a},t),(0,rt.u)("div",{class:ut.spikeRampLabel,styles:l},n),(0,rt.u)("div",{class:ut.spikeRampLabel,styles:c},o))}(e))}function pt(e){return e.infos.filter(((e,t)=>t%2==0))}const yt=window.devicePixelRatio;let gt=class extends c.Z{constructor(e,t){super(e,t),this.hasIndicators=!1,this.legendElement=null,this.opacity=1}render(){if("spike"===this.legendElement.theme)return(0,rt.u)("div",{styles:{display:"flex",flex:"1",justifyContent:"center"}},ht(this.legendElement));const{legendElement:e,hasIndicators:t,opacity:i}=this,n=e.infos,o=n.at(0),s=n.at(-1);if(!o||!s)return null;const{label:r,...a}=o,{label:l,...c}=s;let d=a.preview,u=c.preview;const h={"flex-direction":t?"column":"row-reverse"};if(!d||!u)return null;d=d.cloneNode(!0),d.style.display="flex",u=u.cloneNode(!0),u.style.display="flex";const p={opacity:`${i??""}`};return(0,rt.u)("div",{class:this.classes(Ye.layerRow,{[Ye.sizeRampRow]:t})},(0,rt.u)("div",{class:Ye.rampLabel},t?r:l),(0,rt.u)("div",{class:Ye.sizeRampContainer,styles:h},(0,rt.u)("div",{afterCreate:Je,bind:d,class:Ye.sizeRampPreview,styles:p}),this._renderSizeRampLines(e),(0,rt.u)("div",{afterCreate:Je,bind:u,class:Ye.sizeRampPreview,styles:p})),(0,rt.u)("div",{class:Ye.rampLabel},t?l:r))}_renderSizeRampLines(e){const t=e.infos,i=t.at(0),n=t.at(-1);if(!i||!n)return null;const o=i.symbol,s=this.hasIndicators,r=i.size&&"number"==typeof i.size?i.size:0,a=n.size&&"number"==typeof n.size?n.size:0,l=i.outlineSize||0,c=n.outlineSize||0,d=(0,C.F2)(r+l)*yt,u=(0,C.F2)(a+c)*yt,h=s?d:d+50*yt,p=s?d/2+50*yt:d,y=function(e){if(e){if(e.type.includes("3d")){if(!e.symbolLayers?.length)return;const t=e.symbolLayers.at(-1)?.resource?.primitive;return"triangle"===t||"cone"===t||"tetrahedron"===t}return"triangle"===e.style}}(o),g=function(e){if(!e)return;if(e.type.includes("3d")){if(!e.symbolLayers?.length)return;const t=e.symbolLayers.at(-1).resource?.primitive;return"circle"===t||"cross"===t||"kite"===t||"sphere"===t||"cube"===t||"diamond"===t}const t=e.style;return"circle"===t||"diamond"===t||"cross"===t}(o),m=document.createElement("canvas");m.width=h,m.height=p,m.style.width=m.width/yt+"px",m.style.height=m.height/yt+"px";const f=m.getContext("2d");if(s){f.beginPath();const e=0,t=0,i=h/2-u/2,n=p;f.moveTo(e,t),f.lineTo(i,n);const o=h,s=0,r=h/2+u/2,a=p;f.moveTo(o,s),f.lineTo(r,a)}else{f.beginPath();const e=0,t=p/2-u/2,i=h,n=0;f.moveTo(e,t),f.lineTo(i,n);const o=0,s=p/2+u/2,r=h,a=p;f.moveTo(o,s),f.lineTo(r,a)}return f.strokeStyle="#ddd",f.stroke(),(0,rt.u)("div",{afterCreate:Je,bind:m,styles:s?{display:"flex",marginTop:`-${y?0:g?d/2:0}px`,marginBottom:`-${y?u:g?u/2:0}px`}:{display:"flex",marginRight:`-${y?0:g?d/2:0}px`,marginLeft:`-${y?0:g?u/2:0}px`}})}};(0,n._)([(0,s.Cb)()],gt.prototype,"hasIndicators",void 0),(0,n._)([(0,s.Cb)()],gt.prototype,"legendElement",void 0),(0,n._)([(0,s.Cb)()],gt.prototype,"messages",void 0),(0,n._)([(0,s.Cb)()],gt.prototype,"opacity",void 0),gt=(0,n._)([(0,l.j)("esri.widgets.Legend.styles.card.SizeRamp")],gt);i(45357);var mt=i(59143),ft=i(43462);const vt=(0,mt.E)(),bt="esri-univariate-above-and-below-ramp__symbol",_t="esri-legend__color-ramp";function wt(e="vertical"){const t="stroke:rgb(200, 200, 200);stroke-width:1";return"vertical"===e?(0,rt.u)("svg",{height:"4",width:"10"},(0,rt.u)("line",{style:t,x1:"0",x2:"10",y1:"2",y2:"2"})):(0,rt.u)("svg",{height:"10",width:"10"},(0,rt.u)("line",{style:t,x1:"5",x2:"5",y1:"0",y2:"10"}))}function Ct(e,t="vertical"){const i=document.createElement("div");return i.style.height="20px",i.className=bt,null!=e&&(i.style.opacity=e.toString()),vt.append(i,wt.bind(null,t)),i}function xt(e,t,i="vertical",n){e.infos.forEach(((e,o)=>{if(n&&2===o)e.preview=Ct(t,i);else{const t=((0,ft.hj)(e.size)?(0,C.F2)(e.size):0)+("horizontal"===i?20:10),n=e.preview,o="div"===n?.tagName.toLowerCase(),s=o?n:document.createElement("div");s.className=bt,"horizontal"===i?s.style.width=`${t}px`:s.style.height=`${t}px`,!o&&n&&s.appendChild(n),e.preview=s}}))}function St(e,t="classic"){const i=e.infos,n=i.at(0),o=i.at(-1),s=(0,ft.hj)(n.size)?(0,C.F2)(n.size):0,r=(0,ft.hj)(o.size)?(0,C.F2)(o.size):0;return"classic"===t?(s+10)/2:(s-r)/2}function Et(e,t){if(!e)return null;const i=e.infos.map((e=>e.color)),n=(0,q.jT)("full"===t.type?i:"above"===t.type?i.slice(0,3):i.slice(2,5),{width:t.width,height:t.height,align:t.rampAlignment,effectList:t.effectList,ariaLabel:t.ariaLabel});return n.className=_t,null!=t.opacity&&(n.style.opacity=t.opacity.toString()),n}function kt(e,t,i,n="vertical"){let o=0;const s=e.infos,r=Math.floor(s.length/2),a="full"===t||"above"===t?0:r,l="full"===t||"below"===t?s.length-1:r;for(let e=a;e<=l;e++)if(i&&e===r)o+="horizontal"===n?10:20;else{const t=s[e].size;o+=((0,ft.hj)(t)?(0,C.F2)(t):0)+("horizontal"===n?20:10)}return Math.round(o)}function Lt(e,t,i,n="vertical"){const o=kt(e,t,i,n),s=e.infos,r=Math.floor(s.length/2),a="full"===t||"above"===t?0:r,l="full"===t||"below"===t?s.length-1:r,c=(0,ft.hj)(s[a].size)?s[a].size:0,d=(0,ft.hj)(s[l].size)?s[l].size:0,u="full"===t?c+d:"above"===t?c:d,h=i?"vertical"===n?20:10:0,p="vertical"===n?10*("full"===t?2:1):20*("full"===t?2:1);return Math.round(o-((0,C.F2)(u)/2+h/2+p/2))}function Tt(e,t,i="vertical"){const n=e.infos;let o=n.find((({type:e})=>"size-ramp"===e)),s=n.find((({type:e})=>"color-ramp"===e));return o&&(o={...o},o.infos=[...o.infos],xt(o,t,i,!0)),s&&(s={...s},s.infos=[...s.infos]),"horizontal"===i&&(o?.infos.reverse(),s?.infos.reverse()),{sizeRampElement:o,colorRampElement:s}}function Mt(e,t="vertical"){const i=e.infos;let n=i.find((({type:e})=>"size-ramp"===e)),o=i.find((({type:e})=>"color-ramp"===e));return n&&(n={...n},n.infos=[...n.infos],xt(n,null,t,!1)),o&&(o={...o},o.infos=[...o.infos]),"horizontal"===t&&(n?.infos.reverse(),o?.infos.reverse()),{sizeRampElement:n,colorRampElement:o}}const It={marginLeft:"3px"},Ot={display:"table-cell",verticalAlign:"middle"},Pt={display:"flex",alignItems:"flex-start"};let At=class extends c.Z{constructor(e,t){super(e,t),this.effectList=null,this.legendElement=null,this.opacity=1}render(){const{legendElement:e,opacity:t,effectList:i,key:n}=this,{sizeRampElement:o,colorRampElement:s}=Tt(e,t,"horizontal");if(!o)return null;const r=kt(o,"full",!0,"horizontal"),a=Lt(o,"above",!0,"horizontal"),l=Lt(o,"below",!0,"horizontal"),c=this.messages?.previewColorRampAriaLabel,d=Et(s,{width:a,height:12,rampAlignment:"horizontal",opacity:t,type:"above",effectList:i,ariaLabel:c}),u=Et(s,{width:l,height:12,rampAlignment:"horizontal",opacity:t,type:"below",effectList:i,ariaLabel:c}),h=St(o,"card"),p=o.infos.map((e=>e.label)),y=p.length-1,g=p.map(((e,t)=>0===t||t===y?(0,rt.u)("div",{key:t},e):null)),m={marginTop:"3px",display:"flex"};(0,st.dZ)(this.container)?m.marginRight=`${h}px`:m.marginLeft=`${h}px`;const f={width:`${r}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return(0,rt.u)("div",{class:Ye.layerRow,key:`${n}-container`,styles:{display:"flex",flexDirection:"column"}},(0,rt.u)("div",{class:this.classes(Ye.symbolContainer,Ye.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},o.infos.map(((e,t)=>(0,rt.u)("div",{afterCreate:Je,bind:e.preview,class:Ye.symbol,key:t})))),d?(0,rt.u)("div",{class:Ye.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:m},(0,rt.u)("div",{afterCreate:Je,bind:d}),(0,rt.u)("div",{afterCreate:Je,bind:u})):null,(0,rt.u)("div",{class:Ye.layerInfo},(0,rt.u)("div",{class:Ye.rampLabelsContainer,styles:f},g)))}};(0,n._)([(0,s.Cb)()],At.prototype,"effectList",void 0),(0,n._)([(0,s.Cb)()],At.prototype,"legendElement",void 0),(0,n._)([(0,s.Cb)()],At.prototype,"messages",void 0),(0,n._)([(0,s.Cb)()],At.prototype,"opacity",void 0),At=(0,n._)([(0,l.j)("esri.widgets.Legend.styles.card.UnivariateAboveAndBelowRamp")],At);let Rt=class extends c.Z{constructor(e,t){super(e,t),this.effectList=null,this.legendElement=null,this.opacity=1}render(){const{legendElement:e,opacity:t,effectList:i,key:n}=this,{sizeRampElement:o,colorRampElement:s}=Mt(e,"horizontal");if(!o)return null;const r=kt(o,"full",!1,"horizontal"),a=Et(s,{width:Lt(o,"full",!1,"horizontal"),height:12,rampAlignment:"horizontal",opacity:t,type:"full",effectList:i,ariaLabel:this.messages?.previewColorRampAriaLabel}),l=St(o,"card"),c=o.infos.length-1,d=o.infos.map(((e,t)=>0===t||t===c?(0,rt.u)("div",{key:t},e.label):null)),u={marginTop:"3px",display:"flex"};(0,st.dZ)(this.container)?u.marginRight=`${l}px`:u.marginLeft=`${l}px`;const h={width:`${r}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return(0,rt.u)("div",{class:Ye.layerRow,key:`${n}-container`,styles:{display:"flex",flexDirection:"column"}},(0,rt.u)("div",{class:this.classes(Ye.symbolContainer,Ye.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},o.infos.map(((e,t)=>(0,rt.u)("div",{afterCreate:Je,bind:e.preview,class:Ye.symbol,key:t})))),(0,rt.u)("div",{class:Ye.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:u},(0,rt.u)("div",{afterCreate:Je,bind:a})),(0,rt.u)("div",{class:Ye.layerInfo},(0,rt.u)("div",{class:Ye.rampLabelsContainer,styles:h},d)))}};(0,n._)([(0,s.Cb)()],Rt.prototype,"effectList",void 0),(0,n._)([(0,s.Cb)()],Rt.prototype,"legendElement",void 0),(0,n._)([(0,s.Cb)()],Rt.prototype,"messages",void 0),(0,n._)([(0,s.Cb)()],Rt.prototype,"opacity",void 0),Rt=(0,n._)([(0,l.j)("esri.widgets.Legend.styles.card.UnivariateColorSizeRamp")],Rt);var Dt,$t=i(4219),Nt=i(79691);let Ft=Dt=class extends c.Z{constructor(e,t){super(e,t),this.effectList=null,this.hasIndicators=!1,this.headingLevel=3,this.isChild=!1,this.legendElement=null}render(){const e=this._renderLegendElement(),t=nt(this.legendElement,this.messages),i=this.hasIndicators&&!this.isChild?(0,rt.u)("div",null,(0,rt.u)(Nt.X,{class:Ye.carouselTitle,level:this.headingLevel},this.activeLayerInfo.title),(0,rt.u)(Nt.X,{class:Ye.layerCaption,level:(0,Nt.M)(this.headingLevel)},t)):t?(0,rt.u)(Nt.X,{class:Ye.layerCaption,level:this.headingLevel},t):null;return(0,rt.u)("section",{"aria-labelledby":this.key,class:Ye.section,id:`${this.key}-panel`,key:this.key,role:"tabpanel",tabIndex:0},i,e)}_renderLegendElement(){switch(this.legendElement.type){case"symbol-table":return this._renderSymbolTable(this.legendElement);case"size-ramp":return(0,rt.u)(gt,{hasIndicators:this.hasIndicators,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"color-ramp":case"opacity-ramp":case"heatmap-ramp":case"stretch-ramp":return(0,rt.u)(at,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"relationship-ramp":return(0,$t.g)(this.legendElement,this.id,{opacity:this.layer.opacity,effectList:this.effectList,ariaLabel:this.messages.previewRelationshipRampAriaLabel,key:this.key});case"pie-chart-ramp":return(0,rt.u)("div",{afterCreate:Je,bind:this.legendElement.preview,class:Ye.pieChartRampPreview,key:`${this.key}-preview`});case"univariate-above-and-below-ramp":return(0,rt.u)(At,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"univariate-color-size-ramp":return(0,rt.u)(Rt,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});default:return null}}_renderSymbolTable(e){const t=e.infos.map((t=>this._renderElementInfo(t,e.legendType))).filter(Boolean);if(!t.length)return null;const i=this.activeLayerInfo.legendElements.some((({type:e})=>"relationship-ramp"===e)),n=t[0]?.properties?.classes?.[Ye.symbolRow],o={[Ye.labelContainer]:!n&&!i,[Ye.relationshipLabelContainer]:i};return(0,rt.u)("div",{class:this.classes(o)},t)}_renderElementInfo(e,t){const{layer:i}=this,n="label"in e?e.label:null,o=`${this.key}-${n}`;if("type"in e&&e.type)return(0,rt.u)(Dt,{activeLayerInfo:this.activeLayerInfo,effectList:this.effectList,hasIndicators:this.hasIndicators,headingLevel:this.headingLevel,isChild:!0,key:o,layer:i,legendElement:e,messages:this.messages});if(!("preview"in e&&e.preview||"src"in e&&e.src))return null;const s=tt(i,t),r=Qe(this.messages,n,!1)||"";if("src"in e&&e.src)return(0,rt.u)("div",{class:Ye.layerRow,key:`${o}-row`},this._renderImage(e,i,s),(0,rt.u)("div",{class:Ye.imageLabel},r));if("symbol"in e&&e.preview){if(!e.symbol?.type.includes("simple-fill")){if(!e.label)return(0,rt.u)("div",{afterCreate:Je,bind:e.preview,key:`${o}-row`});const t={[Ye.symbolCell]:this.hasIndicators};return(0,rt.u)("div",{class:this.classes(Ye.layerRow,{[Ye.symbolRow]:this.hasIndicators}),key:`${o}-row`},(0,rt.u)("div",{afterCreate:Je,bind:e.preview,class:this.classes(t)}),(0,rt.u)("div",{class:this.classes(Ye.imageLabel,{[Ye.labelCell]:this.hasIndicators})},r))}return(0,rt.u)("div",{class:Ye.layerRow,key:`${o}-row`},(0,rt.u)("div",{class:Ye.labelElement,styles:this._getBackgroundStyles(e)},r))}return null}_getBackgroundStyles(e){const t=e.symbol,i=t.color,n=!!i?.a,o="outline"in t?t.outline:null,s=!!o?.color?.a,r=new g.Z(n&&i?[i.r,i.g,i.b,i.a*this.layer.opacity]:[255,255,255,0]),a=s&&o.color?new g.Z([o.color.r,o.color.g,o.color.b,o.color.a*this.layer.opacity]):new g.Z([255,255,255,0]),l=e.symbol.color?.isBright??!0,c=l?"black":"white",d=l?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";return{background:n?r.toCss(!0):"none",color:c,textShadow:`-1px -1px 0 ${d},\n                  1px -1px 0 ${d},\n                  -1px 1px 0 ${d},\n                  1px 1px 0 ${d}`,border:s?`1px solid ${a.toCss(!0)}`:"none",filter:(0,X.wJ)(this.effectList)??void 0}}_renderImage(e,t,i){const{label:n,src:o,opacity:s}=e,r={[Ye.imageryLayerStretchedImage]:i,[Ye.symbol]:!i},a={opacity:`${s??t.opacity}`},l=Qe(this.messages,n,!1);return(0,rt.u)("img",{alt:l,"aria-label":l,border:0,class:this.classes(r),height:e.height,src:o,styles:a,width:e.width})}};(0,n._)([(0,s.Cb)()],Ft.prototype,"activeLayerInfo",void 0),(0,n._)([(0,s.Cb)()],Ft.prototype,"effectList",void 0),(0,n._)([(0,s.Cb)()],Ft.prototype,"hasIndicators",void 0),(0,n._)([(0,s.Cb)()],Ft.prototype,"headingLevel",void 0),(0,n._)([(0,s.Cb)()],Ft.prototype,"isChild",void 0),(0,n._)([(0,s.Cb)()],Ft.prototype,"layer",void 0),(0,n._)([(0,s.Cb)()],Ft.prototype,"legendElement",void 0),(0,n._)([(0,s.Cb)()],Ft.prototype,"messages",void 0),Ft=Dt=(0,n._)([(0,l.j)("esri.widgets.Legend.styles.card.LegendElement")],Ft);var Vt=i(84644),zt=i(24225);let Zt=class extends c.Z{constructor(e,t){super(e,t),this._hasIndicators=!1,this.activeLayerInfos=null,this.headingLevel=3,this.layout="stack",this.messages=null,this.messagesCommon=null,this.type="card",this.view=null}loadDependencies(){return(0,Vt.h)({carousel:()=>i.e(68684).then(i.bind(i,68684)),"carousel-item":()=>i.e(62666).then(i.bind(i,62666))})}render(){this._hasIndicators="auto"===this.layout&&this.view&&this.view.container.clientWidth<=768||"stack"===this.layout;const e=this._hasIndicators?this._renderCarousel():this._renderLayers(),t={[Ye.stacked]:this._hasIndicators};return(0,rt.u)("div",{class:this.classes(Ye.base,t)},e||(0,rt.u)("div",{class:Ye.message},this.messages.noLegend))}_renderCarousel(){const e=[],t=this.activeLayerInfos;if(t)for(const i of t)this._renderSections(i,e);return e?.length?(0,rt.u)("calcite-carousel",{class:Ye.carousel,label:this.messages.carousel},e.map(((t,i)=>(0,rt.u)("calcite-carousel-item",{class:Ye.carouselItem,key:i,label:(0,se.n)(this.messagesCommon.pagination.pageText,{index:i+1,total:e.length})},t)))):null}_renderLayers(){const e=this.activeLayerInfos?.toArray()?.map((e=>this._renderLegendForLayer(e))).filter(Boolean);return e?.length?e:null}_renderLegendForLayer(e){if(!e.ready)return null;if(e.children.length){const t=e.children.toArray().map(this._renderLegendForLayer,this);return(0,rt.u)("section",{class:this.classes(Ye.service,Ye.groupLayer),key:e.layer.uid},(0,rt.u)("div",{class:Ye.serviceCaptionContainer},e.title),t)}return this._renderLegendElementsForLayer(e)}_renderLegendElementsForLayer(e){const t=e.legendElements?.filter(Boolean);if(!t?.length)return null;const i=t.map((t=>(0,rt.u)(Ft,{activeLayerInfo:e,effectList:e.effectList,hasIndicators:this._hasIndicators,headingLevel:this.headingLevel,isChild:!1,key:`${e.layer.uid}-${t.type}`,layer:e.layer,legendElement:t,messages:this.messages}))),n={[Ye.groupLayerChild]:!!e.parent};return(0,rt.u)("section",{class:this.classes(Ye.service,n),key:e.layer.uid},(0,rt.u)("div",{class:Ye.serviceCaptionContainer},(0,rt.u)("div",{class:Ye.serviceCaptionText},e.title)),(0,rt.u)("div",{class:Ye.serviceContent},i))}_renderSections(e,t){if(!e.ready)return;if(e.children.length)for(const i of e.children)this._renderSections(i,t);const i=e.legendElements;if(i?.length)for(const n of i){const i=(0,rt.u)(Ft,{activeLayerInfo:e,effectList:e.effectList,hasIndicators:this._hasIndicators,headingLevel:this.headingLevel,isChild:!1,key:`${e.layer.uid}-${n.type}`,layer:e.layer,legendElement:n,messages:this.messages});i&&t.push(i)}}};(0,n._)([(0,s.Cb)()],Zt.prototype,"activeLayerInfos",void 0),(0,n._)([(0,s.Cb)()],Zt.prototype,"headingLevel",void 0),(0,n._)([(0,s.Cb)()],Zt.prototype,"layout",void 0),(0,n._)([(0,s.Cb)(),(0,zt.H)("esri/widgets/Legend/t9n/Legend")],Zt.prototype,"messages",void 0),(0,n._)([(0,s.Cb)(),(0,zt.H)("esri/t9n/common")],Zt.prototype,"messagesCommon",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],Zt.prototype,"type",void 0),(0,n._)([(0,s.Cb)()],Zt.prototype,"view",void 0),Zt=(0,n._)([(0,l.j)("esri.widgets.Legend.styles.card.CardView")],Zt);const Bt="esri-legend",Ut={service:`${Bt}__service`,label:`${Bt}__service-label`,layer:`${Bt}__layer`,groupLayer:`${Bt}__group-layer`,groupLayerChild:`${Bt}__group-layer-child`,layerTable:`${Bt}__layer-table`,layerTableSizeRamp:`${Bt}__layer-table--size-ramp`,layerChildTable:`${Bt}__layer-child-table`,layerCaption:`${Bt}__layer-caption`,layerBody:`${Bt}__layer-body`,layerRow:`${Bt}__layer-row`,layerCell:`${Bt}__layer-cell`,layerInfo:`${Bt}__layer-cell ${Bt}__layer-cell--info`,imageryLayerStretchedImage:`${Bt}__imagery-layer-image--stretched`,imageryLayerCellStretched:`${Bt}__imagery-layer-cell--stretched`,imageryLayerInfoStretched:`${Bt}__imagery-layer-info--stretched`,symbolContainer:`${Bt}__layer-cell ${Bt}__layer-cell--symbols`,symbol:`${Bt}__symbol`,rampContainer:`${Bt}__ramps`,sizeRamp:`${Bt}__size-ramp`,colorRamp:`${Bt}__color-ramp`,opacityRamp:`${Bt}__opacity-ramp`,borderlessRamp:`${Bt}__borderless-ramp`,rampTick:`${Bt}__ramp-tick`,rampFirstTick:`${Bt}__ramp-tick-first`,rampLastTick:`${Bt}__ramp-tick-last`,rampLabelsContainer:`${Bt}__ramp-labels`,rampLabel:`${Bt}__ramp-label`,message:`${Bt}__message`,univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label"};let Ht=class extends c.Z{constructor(e,t){super(e,t),this.legendElement=null,this.opacity=1}get _preview(){const e=this.legendElement.preview;if(!e)return null;const t="opacity-ramp"===this.legendElement.type?Ut.opacityRamp:"";return e.className=`${Ut.colorRamp} ${t}`,null!=this.opacity&&(e.style.opacity=this.opacity.toString()),e}render(){const{legendElement:e,_preview:t}=this;if(!t)return null;const i={width:"24px"},n={height:t.style.height};return(0,rt.u)("div",{class:Ut.layerRow,key:`${this.key}-row`},(0,rt.u)("div",{class:Ut.symbolContainer,styles:i},(0,rt.u)("div",{afterCreate:Je,bind:t,class:Ut.rampContainer})),(0,rt.u)("div",{class:Ut.layerInfo},(0,rt.u)("div",{class:Ut.rampLabelsContainer,styles:n},e.infos.map(((t,i)=>this._renderRampLabel(t,i,e.type))))))}_renderRampLabel(e,t,i){return(0,rt.u)("div",{class:e.label?Ut.rampLabel:void 0,key:`${this.key}-stop-${e.label??t}-label`},it(e,i,this.messages))}};(0,n._)([(0,s.Cb)()],Ht.prototype,"_preview",null),(0,n._)([(0,s.Cb)()],Ht.prototype,"legendElement",void 0),(0,n._)([(0,s.Cb)()],Ht.prototype,"messages",void 0),(0,n._)([(0,s.Cb)()],Ht.prototype,"opacity",void 0),Ht=(0,n._)([(0,l.j)("esri.widgets.Legend.styles.classic.ColorRamp")],Ht);let Gt=class extends c.Z{constructor(e,t){super(e,t),this.legendElement=null}render(){const e=this.legendElement.infos.map((e=>this._renderRow(e))).filter(Boolean);return e.length?"spike"===this.legendElement.theme?ht(this.legendElement):(0,rt.u)("div",{class:Ut.layerBody},e):null}_renderRow(e){return e.preview?(0,rt.u)("div",{class:Ut.layerRow,key:`${this.key}-${e.label}-row`},(0,rt.u)("div",{class:this.classes(Ut.symbolContainer,Ut.sizeRamp)},(0,rt.u)("div",{afterCreate:Je,bind:e.preview,class:Ut.symbol})),(0,rt.u)("div",{class:Ut.layerInfo},Qe(this.messages,e.label,!1)||"")):null}};(0,n._)([(0,s.Cb)()],Gt.prototype,"legendElement",void 0),(0,n._)([(0,s.Cb)()],Gt.prototype,"messages",void 0),Gt=(0,n._)([(0,l.j)("esri.widgets.Legend.styles.classic.SizeRamp")],Gt);let jt=class extends c.Z{constructor(e,t){super(e,t),this.effectList=null,this.legendElement=null,this.opacity=1}render(){const{legendElement:e,opacity:t,effectList:i,key:n}=this,{sizeRampElement:o,colorRampElement:s}=Tt(e,t);if(!o)return null;const r=this.messages.previewColorRampAriaLabel,a=Lt(o,"above",!0),l=Lt(o,"below",!0),c=Et(s,{width:12,height:a,rampAlignment:"vertical",opacity:t,type:"above",effectList:i,ariaLabel:r}),d=Et(s,{width:12,height:l,rampAlignment:"vertical",opacity:t,type:"below",effectList:i,ariaLabel:r}),u=St(o),h=o.infos.map((e=>e.label)),p=h.map(((e,t)=>{const i=2===t;return 0===t?(0,rt.u)("div",{class:e?c?Ut.univariateAboveAndBelowLabel:Ut.rampLabel:void 0,key:`${n}-color-ramp-above-label-${e??t}`},e):i?(0,rt.u)("div",null):null})),y=h.length-1,g=Math.floor(h.length/2),m=h.map(((e,t)=>t===g||t===y?(0,rt.u)("div",{class:e?c?Ut.univariateAboveAndBelowLabel:Ut.rampLabel:void 0,key:`${n}-color-ramp-below-label-${e??t}`},e):null)),f={display:"table-cell",verticalAlign:"middle"},v={marginTop:`${u}px`},b={height:`${a}px`},_={height:`${l}px`};return(0,rt.u)("div",{key:`${n}-container`,styles:Pt},(0,rt.u)("div",{class:Ut.layerBody},o.infos.map(((e,t)=>(0,rt.u)("div",{class:this.classes(Ut.layerRow,Ut.sizeRamp),key:`${n}-row-${t}`},(0,rt.u)("div",{afterCreate:Je,bind:e.preview,class:Ut.symbol,styles:f}),c||t%2!=0?null:(0,rt.u)("div",{class:Ut.layerInfo},h[t]))))),c?(0,rt.u)("div",{styles:v},(0,rt.u)("div",{styles:It},(0,rt.u)("div",{styles:Ot},(0,rt.u)("div",{afterCreate:Je,bind:c,class:Ut.rampContainer})),(0,rt.u)("div",{styles:Ot},(0,rt.u)("div",{class:Ut.rampLabelsContainer,styles:b},p))),(0,rt.u)("div",{styles:It},(0,rt.u)("div",{styles:Ot},(0,rt.u)("div",{afterCreate:Je,bind:d,class:Ut.rampContainer})),(0,rt.u)("div",{styles:Ot},(0,rt.u)("div",{class:Ut.rampLabelsContainer,styles:_},m)))):null)}};(0,n._)([(0,s.Cb)()],jt.prototype,"effectList",void 0),(0,n._)([(0,s.Cb)()],jt.prototype,"legendElement",void 0),(0,n._)([(0,s.Cb)()],jt.prototype,"messages",void 0),(0,n._)([(0,s.Cb)()],jt.prototype,"opacity",void 0),jt=(0,n._)([(0,l.j)("esri.widgets.Legend.styles.classic.UnivariateAboveAndBelowRamp")],jt);let Kt=class extends c.Z{constructor(e,t){super(e,t),this.effectList=null,this.legendElement=null,this.opacity=1}render(){const{legendElement:e,opacity:t,effectList:i,key:n}=this,{sizeRampElement:o,colorRampElement:s}=Mt(e);if(!o)return null;const r=St(o),a=Lt(o,"full",!1),l=Et(s,{width:12,height:a,rampAlignment:"vertical",opacity:t,type:"full",effectList:i,ariaLabel:this.messages?.previewColorRampAriaLabel}),c=o.infos.length-1,d=o.infos.map(((e,t)=>0===t||t===c?(0,rt.u)("div",{class:e.label?s?Ut.univariateAboveAndBelowLabel:Ut.rampLabel:void 0,key:`${n}-color-ramp-label-${e.label??t}`},e.label):null)),u={display:"table-cell",verticalAlign:"middle"},h={marginTop:`${r}px`},p={height:`${a}px`};return(0,rt.u)("div",{key:`${n}-container`,styles:Pt},(0,rt.u)("div",{class:Ut.layerBody},o.infos.map(((e,t)=>(0,rt.u)("div",{class:this.classes(Ut.layerRow,Ut.sizeRamp),key:`${n}-row-${t}`},(0,rt.u)("div",{afterCreate:Je,bind:e.preview,class:Ut.symbol,styles:u}))))),(0,rt.u)("div",{styles:h},(0,rt.u)("div",{styles:It},(0,rt.u)("div",{styles:Ot},(0,rt.u)("div",{afterCreate:Je,bind:l,class:Ut.rampContainer})),(0,rt.u)("div",{styles:Ot},(0,rt.u)("div",{class:Ut.rampLabelsContainer,styles:p},d)))))}};var Wt;(0,n._)([(0,s.Cb)()],Kt.prototype,"effectList",void 0),(0,n._)([(0,s.Cb)()],Kt.prototype,"legendElement",void 0),(0,n._)([(0,s.Cb)()],Kt.prototype,"messages",void 0),(0,n._)([(0,s.Cb)()],Kt.prototype,"opacity",void 0),Kt=(0,n._)([(0,l.j)("esri.widgets.Legend.styles.classic.UnivariateColorSizeRamp")],Kt);let Yt=Wt=class extends c.Z{constructor(e,t){super(e,t),this.effectList=null,this.isChild=!1,this.legendElement=null}render(){const e=this._renderLegendElement(),t=nt(this.legendElement,this.messages),i=this.isChild?Ut.layerChildTable:Ut.layerTable,n=t?(0,rt.u)("div",{class:Ut.layerCaption},t):null,o={[Ut.layerTableSizeRamp]:"size-ramp"===this.legendElement.type||!this.isChild};return(0,rt.u)("section",{class:this.classes(i,o),key:`${this.key}-table`},n,e)}_renderLegendElement(){switch(this.legendElement.type){case"symbol-table":return this._renderSymbolTable(this.legendElement);case"size-ramp":return(0,rt.u)(Gt,{key:this.key,legendElement:this.legendElement,messages:this.messages});case"color-ramp":case"opacity-ramp":case"heatmap-ramp":case"stretch-ramp":return(0,rt.u)(Ht,{key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"relationship-ramp":return(0,$t.g)(this.legendElement,this.id,{opacity:this.layer.opacity,effectList:this.effectList,ariaLabel:this.messages.previewRelationshipRampAriaLabel,key:this.key});case"pie-chart-ramp":return(0,rt.u)("div",{afterCreate:Je,bind:this.legendElement.preview,key:`${this.key}-preview`});case"univariate-above-and-below-ramp":return(0,rt.u)(jt,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"univariate-color-size-ramp":return(0,rt.u)(Kt,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});default:return null}}_renderSymbolTable(e){const t=e.infos.map((t=>this._renderElementInfo(t,e.legendType))).filter(Boolean);return t.length?(0,rt.u)("div",{class:Ut.layerBody},t):null}_renderElementInfo(e,t){const{layer:i}=this,n="label"in e?e.label:null,o=`${this.key}-${n}`;if("type"in e&&e.type)return(0,rt.u)(Wt,{effectList:this.effectList,isChild:!0,key:o,layer:i,legendElement:e,messages:this.messages});if(!("preview"in e&&e.preview||"src"in e&&e.src))return null;const s=tt(i,t),r={[Ut.imageryLayerInfoStretched]:s},a={[Ut.imageryLayerInfoStretched]:s};return(0,rt.u)("div",{class:Ut.layerRow,key:`${o}-row`},(0,rt.u)("div",{class:this.classes(Ut.symbolContainer,a)},this._renderPreview(e,s)),(0,rt.u)("div",{class:this.classes(Ut.layerInfo,r)},Qe(this.messages,n,!1)||""))}_renderPreview(e,t){const{layer:i}=this;return"preview"in e&&e.preview?(0,rt.u)("div",{afterCreate:Je,bind:e.preview,class:Ut.symbol}):"src"in e&&e.src?this._renderImage(e,i,t):null}_renderImage(e,t,i){const{label:n,src:o,opacity:s}=e,r={[Ut.imageryLayerStretchedImage]:i,[Ut.symbol]:!i},a={opacity:`${s??t.opacity}`},l=Qe(this.messages,n,!1);return(0,rt.u)("img",{alt:l,"aria-label":l,border:0,class:this.classes(r),height:e.height,src:o,styles:a,width:e.width})}};(0,n._)([(0,s.Cb)()],Yt.prototype,"effectList",void 0),(0,n._)([(0,s.Cb)()],Yt.prototype,"isChild",void 0),(0,n._)([(0,s.Cb)()],Yt.prototype,"layer",void 0),(0,n._)([(0,s.Cb)()],Yt.prototype,"legendElement",void 0),(0,n._)([(0,s.Cb)()],Yt.prototype,"messages",void 0),Yt=Wt=(0,n._)([(0,l.j)("esri.widgets.Legend.styles.classic.LegendElement")],Yt);var qt=i(46512);const Xt=`${Bt}__`;let Jt=class extends c.Z{constructor(e,t){super(e,t),this.activeLayerInfos=null,this.headingLevel=3,this.messages=null,this.type="classic"}render(){const e=this.activeLayerInfos?.toArray().map((e=>this._renderLegendForLayer(e))).filter(Boolean);return e?.length?(0,rt.u)("section",null,e):(0,rt.u)("div",{class:Ut.message,key:"no-legend"},this.messages.noLegend)}_renderLegendForLayer(e,t){if(!e.ready)return null;const i=`${e.layer.uid}-version-${e.version}`,n=`${Xt}${t?`${t}-`:""}${i}`,o=e.title?(0,Nt.X)({level:this.headingLevel,class:this.classes(qt.z.heading,Ut.label)},e.title):null;if(e.children.length){const t=e.children.toArray().map((e=>this._renderLegendForLayer(e,i)));return(0,rt.u)("section",{class:this.classes(Ut.service,Ut.groupLayer),key:n},o,t)}return this._renderLegendElementsForLayer(e,o,n)}_renderLegendElementsForLayer(e,t,i){const n=e.legendElements?.filter(Boolean);if(!n?.length)return null;const o=n.map((t=>(0,rt.u)(Yt,{effectList:e.effectList,isChild:!1,key:`${i}-${t.type}`,layer:e.layer,legendElement:t,messages:this.messages}))),s={[Ut.groupLayerChild]:!!e.parent};return(0,rt.u)("section",{class:this.classes(Ut.service,s),key:i},t,(0,rt.u)("div",{class:Ut.layer},o))}};(0,n._)([(0,s.Cb)()],Jt.prototype,"activeLayerInfos",void 0),(0,n._)([(0,s.Cb)()],Jt.prototype,"headingLevel",void 0),(0,n._)([(0,s.Cb)(),(0,zt.H)("esri/widgets/Legend/t9n/Legend")],Jt.prototype,"messages",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],Jt.prototype,"type",void 0),Jt=(0,n._)([(0,l.j)("esri.widgets.Legend.styles.classic.ClassicView")],Jt);const Qt="esri-legend";let ei=class extends c.Z{constructor(e,t){super(e,t),this.headingLevel=3,this.messages=null,this.viewModel=new je,this.style=new Jt}initialize(){this.addHandles([(0,o.on)((()=>this.view),"resize",(()=>this.scheduleRender())),(0,o.on)((()=>this.activeLayerInfos),"change",(()=>this._refreshActiveLayerInfos(this.activeLayerInfos))),(0,o.YP)((()=>this.headingLevel),(e=>{const{style:t}=this;t&&(t.headingLevel=e)})),(0,o.YP)((()=>this.style),((e,t)=>{t&&e!==t&&t.destroy(),e&&(e.activeLayerInfos=this.activeLayerInfos,"card"===e.type&&(e.view=this.view),e.headingLevel=this.headingLevel)}),o.nn)])}destroy(){this.style?.destroy()}get activeLayerInfos(){return this.viewModel.activeLayerInfos}set activeLayerInfos(e){this.viewModel.activeLayerInfos=e}get basemapLegendVisible(){return this.viewModel.basemapLegendVisible}set basemapLegendVisible(e){this.viewModel.basemapLegendVisible=e}get groundLegendVisible(){return this.viewModel.groundLegendVisible}set groundLegendVisible(e){this.viewModel.groundLegendVisible=e}get hideLayersNotInCurrentView(){return this.viewModel.hideLayersNotInCurrentView}set hideLayersNotInCurrentView(e){this.viewModel.hideLayersNotInCurrentView=e}get keepCacheOnDestroy(){return this.viewModel.keepCacheOnDestroy}set keepCacheOnDestroy(e){this.viewModel.keepCacheOnDestroy=e}get respectLayerDefinitionExpression(){return this.viewModel.respectLayerDefinitionExpression}set respectLayerDefinitionExpression(e){this.viewModel.respectLayerDefinitionExpression=e}get respectLayerVisibility(){return this.viewModel.respectLayerVisibility}set respectLayerVisibility(e){this.viewModel.respectLayerVisibility=e}get icon(){return"legend"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(e){this.viewModel.layerInfos=e}set style(e){const t=this._get("style");e!==t&&t?.destroy(),this._set("style",e)}castStyle(e){if(e instanceof Zt||e instanceof Jt)return e;if("string"==typeof e)return"card"===e?new Zt:new Jt;if(e&&"string"==typeof e.type){const t={...e};return delete t.type,"card"===e.type?new Zt(t):new Jt(t)}return new Jt}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){return(0,rt.u)("div",{class:this.classes(Qt,qt.z.widget,this.style instanceof Jt?qt.z.panel:null)},this.style.render())}_refreshActiveLayerInfos(e){e.forEach((e=>{this.removeHandles(`version_${e.layer.uid}`),this._renderOnActiveLayerInfoChange(e)})),this.scheduleRender()}_renderOnActiveLayerInfoChange(e){const t=(0,o.YP)((()=>e.version),(()=>this.scheduleRender()));this.addHandles(t,`version_${e.layer.uid}`);const i=(0,o.on)((()=>e.children),"change",(()=>e.children.forEach((e=>this._renderOnActiveLayerInfoChange(e)))),o.nn);this.addHandles(i,`version_${e.layer.uid}`),e.children.forEach((e=>this._renderOnActiveLayerInfoChange(e)))}};(0,n._)([(0,s.Cb)()],ei.prototype,"activeLayerInfos",null),(0,n._)([(0,s.Cb)()],ei.prototype,"basemapLegendVisible",null),(0,n._)([(0,s.Cb)()],ei.prototype,"groundLegendVisible",null),(0,n._)([(0,s.Cb)()],ei.prototype,"headingLevel",void 0),(0,n._)([(0,s.Cb)()],ei.prototype,"hideLayersNotInCurrentView",null),(0,n._)([(0,s.Cb)()],ei.prototype,"keepCacheOnDestroy",null),(0,n._)([(0,s.Cb)()],ei.prototype,"respectLayerDefinitionExpression",null),(0,n._)([(0,s.Cb)()],ei.prototype,"respectLayerVisibility",null),(0,n._)([(0,s.Cb)()],ei.prototype,"icon",null),(0,n._)([(0,s.Cb)()],ei.prototype,"label",null),(0,n._)([(0,s.Cb)()],ei.prototype,"layerInfos",null),(0,n._)([(0,s.Cb)(),(0,zt.H)("esri/widgets/Legend/t9n/Legend")],ei.prototype,"messages",void 0),(0,n._)([(0,s.Cb)()],ei.prototype,"style",null),(0,n._)([(0,r.p)("style")],ei.prototype,"castStyle",null),(0,n._)([(0,s.Cb)()],ei.prototype,"view",null),(0,n._)([(0,s.Cb)()],ei.prototype,"viewModel",void 0),ei=(0,n._)([(0,l.j)("esri.widgets.Legend")],ei);const ti=ei},90378:function(e,t,i){"use strict";i.d(t,{getRampStops:function(){return M},p5:function(){return S},QB:function(){return E}});var n=i(53147),o=i(92643),s=i(89151),r=i(95365),a=i(28947),l=i(96094),c=(i(44783),i(44252));const d="spike-height-override";(0,l.Wz)(8),(0,l.Wz)(20);function u(e){const{strokeColor:t,strokeWidth:i,symbolStyle:n}=e,o=n?.includes("solid-fill")||n?.includes("gradient-fill");let s=t?.toArray(),r=!1;return n?.includes("outline")&&o?r=!0:s=e.color?.toArray(),{type:"CIMSolidStroke",effects:h(n),enable:!0,colorLocked:r,capStyle:c.kP.Round,joinStyle:c.r4.Round,lineStyle3D:c.mC.Strip,miterLimit:4,width:i??(0,l.Wz)(1),color:s}}function h(e){if(!e?.includes("closed"))return[{type:"CIMGeometricEffectAddControlPoints",angleTolerance:90,primitiveName:"spike-control-points"},{type:"CIMGeometricEffectSuppress",suppress:!0,invert:!0,primitiveName:"spike-stroke-suppress"}]}function p(e){const{color:t,symbolStyle:i}=e,n=i?.includes("solid-fill"),o=i?.includes("gradient-fill");if(!n&&!o||!t)return;if(n)return{type:"CIMSolidFill",enable:!0,colorLocked:!1,color:t?.toArray()};const s=t.clone();return s.a=0,{type:"CIMGradientFill",enable:!0,angle:90,colorRamp:{type:"CIMMultipartColorRamp",colorRamps:[{type:"CIMLinearContinuousColorRamp",fromColor:t.toArray(),toColor:s.toArray()}],weights:[1]},gradientMethod:"Linear",gradientSize:70,gradientSizeUnits:"Relative",gradientType:"Continuous"}}function y(e,t){const{defaultHeight:i,baseWidth:o,color:s,strokeColor:r,primitiveOverrides:l,symbolStyle:c,strokeWidth:h}=t,y="CIMPointSymbol"===e.data.symbol?.type?e.data.symbol:null,m=y?.symbolLayers;if(!m)return e;const f=y.effects,v=f?.find((e=>"CIMGeometricEffectTaperedPolygon"===e.type)),b=f?.find((e=>"CIMGeometricEffectRadial"===e.type&&e.primitiveName===d));null!=o&&v&&(v.fromWidth=o),null!=i&&b&&(b.length=i);const _=m?.find((e=>"CIMSolidStroke"===e.type)),w=m?.find((e=>"CIMSolidFill"===e.type)),C=m?.find((e=>"CIMGradientFill"===e.type)),x="CIMMultipartColorRamp"===C?.colorRamp?.type&&"CIMLinearContinuousColorRamp"===C.colorRamp.colorRamps[0]?.type?C.colorRamp.colorRamps[0]:null;if(c){const e=w?.color??x?.fromColor??_?.color,i=s??(e?new n.Z(e):void 0),o=_?.color??e,a=r??(o?new n.Z(o):void 0),l=c.includes("solid-fill"),d=c.includes("gradient-fill");if(l||d||g(m,w??C),i)if(l)g(m,C),w?w.color=i?.toArray():m.push(p({...t,color:i}));else if(d)if(g(m,w),C){if(x&&s){const e=i.clone();e.a=0,x.fromColor=i.toArray(),x.toColor=e.toArray()}}else m.push(p({...t,color:i}));if(_){const e=u({...t,strokeColor:a,color:i});_.effects=e.effects,_.color=e.color,_.width=e.width,_.colorLocked=e.colorLocked}}else if(_&&(r&&(_.color=r.toArray()),null!=h&&(_.width=h)),w&&s&&(w.color=s.toArray()),x&&s){const e=s.clone();e.a=0,x.fromColor=s.toArray(),x.toColor=e.toArray()}return void 0!==l&&(e.data.primitiveOverrides=(0,a.d9)(l)),e}function g(e,t){if(!t)return;const i=e.indexOf(t);-1!==i&&e.splice(i,1)}var m=i(38096),f=i(19886),v=i(27737),b=i(82738),_=i(68578),w=i(30903),C=i(94117),x=(i(68808),i(48207));const S=30,E=12,k=[255,255,255],L=[200,200,200],T=[128,128,128];async function M(e,t,n,o,r,a,l){const c=t.legendOptions?.customValues,d=l||await O(e,n),u=t.stops,h=!!d,p=!!c,y=null!=t.minSize&&null!=t.maxSize,g=u&&u.length>1,m=!!t.target;if(!h||!p&&!(y||g&&!m))return;const f=(0,w.YW)(d);let v=!1,_=null,x=null;_=f&&!g?(0,s.NM)([t.minDataValue,t.maxDataValue]):c??await async function(e,t,n,o){const r=(await Promise.resolve().then(i.bind(i,71618))).getSizeRangeAtScale(e,n,o),a=r&&R(r);if(!r||!a)return;let l=a.map((t=>function(e,t,i){const n=i.minSize,o=i.maxSize,s=t.minDataValue,r=t.maxDataValue;let a;a=e<=n?s:e>=o?r:(e-n)/(o-n)*(r-s)+s;return a}(t,e,r)));l=(0,s.NM)(l);for(let i=1;i<l.length-1;i++){const s=await D(e,t,l[i],l[i-1],n,o);s&&(l[i]=s[0],a[i]=s[1])}return l}(t,d,o,r?.type);const S=e?.authoringInfo,E="univariate-color-size"===S?.type,k=E&&"above-and-below"===S?.univariateTheme,L=!!(0,C.$1)(e,"reference-size"),T=!!(0,C.$1)(e,"spike");if(!_&&g&&(_=u.map((e=>e.value)),v=u.some((e=>!!e.label)),"flow"===e.type&&(_=(0,s.NM)(_)),v&&(x=u.map((e=>e.label)))),f&&null!=_&&_?.length>2&&!k&&(_=[_[0],_[_.length-1]]),!_)return null;E&&5!==_?.length&&(_=R({minSize:_[0],maxSize:_[_.length-1]}));const M=f?I(e,_):null,P=(0,w.Y6)(d),A=v?null:function(e,t){const i=e.length-1;return e.map(((e,n)=>(0,C.MN)(e,n,i,t)))}(_,a),F=await Promise.all(_.map((async(i,n)=>{let s=f?M[n]:await $(t,d,i,o,r?.type),a=s;L&&(s*=24/t.maxSize||1,a=24);const l=N(d,s,e,n);return T&&"cim"===l.type&&(a=await(0,b.S)(l)),{value:i,symbol:l,label:v?x[n]:A[n],size:a,outlineSize:P}})));return F.reverse()}function I(e,t){const i=e?.authoringInfo,n="univariate-color-size"===i?.type;let o=[E,S];if(n){const e=t[0],i=t[t.length-1],n=E,s=S;o=t.map((t=>n+(t-e)/(i-e)*(s-n)))}return n&&"below"===i?.univariateTheme&&o.reverse(),o}async function O(e,t){if("flow"===e.type)return(0,C.y$)(e,t);if("pie-chart"===e.type)return new f.Z({color:null,outline:e.outline?.width?e.outline:new m.Z});let i=null,s=null;if("simple"===e.type)i=e.symbol;else if("class-breaks"===e.type){const t=e.classBreakInfos;i=t&&t[0]&&t[0].symbol,s=t.length>1}else if("unique-value"===e.type){const t=e.uniqueValueInfos;i=t?.[0]?.symbol,s=null!=t&&t.length>1}if(!i||function(e){return(0,_.dU)(e)?e.symbolLayers?.some((e=>"fill"===e?.type))??!1:e?.type.includes("fill")??!1}(i))return null;if(i=i.clone(),t||s)if(i.type.includes("3d"))P(i);else if((0,C.$1)(e,"reference-size")&&"cim"===i.type)(0,r.r6)(i,{color:t??("class-breaks"!==e.type?new n.Z(L):null)});else if((0,C.$1)(e,"spike")&&"cim"===i.type){const e=new n.Z(L),s=new n.Z(T),r=!!("CIMPointSymbol"===i.data.symbol?.type?i.data.symbol:null)?.symbolLayers?.find((({type:e})=>"CIMSolidStroke"===e))?.colorLocked;let a,l=t??void 0;if(l){const t=(0,o.EX)(l),i=(0,x.Yc)();(!i&&t>225||i&&t<25)&&(l=e,a=r?s:e)}else l=e,a=r?s:e;y(i,{color:l,strokeColor:a})}else A(i);return i}function P(e){"line-3d"===e.type?e.symbolLayers.forEach((e=>{e.material={color:T}})):e.symbolLayers.forEach((e=>{"icon"!==e.type||e.resource?.href?e.material={color:L}:(e.material={color:k},e.outline={color:T,size:1.5})}))}function A(e){const t=(0,x.Yc)();if("cim"===e.type)(0,v.ZB)(e,new n.Z(L));else if(e.type.includes("line"))e.color=T;else if(e.color=t?T:k,"simple-marker"===e.type)if(e.outline){const t=e.outline?.color?.toHex();"#ffffff"===t&&(e.outline.color=T)}else e.outline={color:T,width:1.5}}function R(e){const t=e.minSize,i=(e.maxSize-t)/4,n=[];for(let e=0;e<5;e++)n.push(t+i*e);return n}async function D(e,t,i,n,o,r){const a=await $(e,t,i,o,r),l=await $(e,t,n,o,r),c=(0,s.D2)(i),d=c.fractional;let u=c.integer,h=null,p=null;i>0&&i<1&&(h=10**d,u=(0,s.D2)(i*=h).integer);for(let n=u-1;n>=0;n--){const c=10**n;let d=Math.floor(i/c)*c,u=Math.ceil(i/c)*c;null!=h&&(d/=h,u/=h);let y=(d+u)/2;[,y]=(0,s.NM)([d,y,u],{indexes:[1]});const g=await $(e,t,d,o,r),m=await $(e,t,u,o,r),f=await $(e,t,y,o,r),v=(0,s.f1)(a,g,l,null),b=(0,s.f1)(a,m,l,null),_=(0,s.f1)(a,f,l,null);let w=v.previous<=20,C=b.previous<=20;if(w&&C&&(v.previous<=b.previous?(w=!0,C=!1):(C=!0,w=!1)),w?p=[d,g]:C?p=[u,m]:_.previous<=20&&(p=[y,f]),p)break}return p}async function $(e,t,n,o,s){const{getSize:r}=await Promise.resolve().then(i.bind(i,71618));return r(e,n,{scale:o,view:s,shape:"simple-marker"===t.type?t.style:null})}function N(e,t,i,n){"univariate-color-size"===i?.authoringInfo?.type&&"above-and-below"===i?.authoringInfo?.univariateTheme&&"class-breaks"===i.type&&(e=function(e,t){const i=e.classBreakInfos,n=i.length,o=n<2||!(t>=2)?i[0].symbol.clone():i[n-1].symbol.clone(),s=e.visualVariables?.some((e=>"color"===e.type));return s&&(o.type.includes("3d")?P(o):A(o)),o}(i,n));const o=e.clone();if((0,_.dU)(o))(0,w.YW)(o)||o.symbolLayers.forEach((e=>{"fill"!==e.type&&(e.size=t)}));else if(function(e){return"esri.symbols.SimpleMarkerSymbol"===e.declaredClass}(o))o.size=t;else if(function(e){return"esri.symbols.PictureMarkerSymbol"===e.declaredClass}(o)){const e=o.width,i=o.height;o.height=t,o.width=t*(e/i)}else!function(e){return"esri.symbols.SimpleLineSymbol"===e.declaredClass}(o)?function(e){return"esri.symbols.TextSymbol"===e.declaredClass}(o)?o.font&&(o.font.size=t):"cim"===o.type&&(0,C.$1)(i,"reference-size")?(0,r.r6)(o,{innerDotSize:t,outerRingSize:24}):"cim"===o.type&&(0,C.$1)(i,"spike")&&y(o,{defaultHeight:t,primitiveOverrides:null}):o.width=t;return o}},73577:function(e,t,i){"use strict";i.d(t,{Z:function(){return V}});var n=i(73440),o=i(85168),s=(i(61432),i(96711)),r=i(93568),a=i(17155),l=(i(83850),i(48023)),c=i(1803),d=i(51741),u=i(49052),h=i(99965),p=i(43254),y=i(41145),g=i(50702),m=i(90403),f=i(60508),v=i(51870),b=i(46451),_=i(70880);let w=class extends _.Z{constructor(e){super(e),this.location=null,this.intersectedLocation=null,this.intersectedGraphic=null,this.visible=void 0,(0,o.x9)(s.Z.getLogger(this),"LineOfSightTarget",{replacement:"Use the LineOfSightAnalysisTarget on LineOfSightAnalysis instead.",warnOnce:!0,version:"4.33"})}};(0,n._)([(0,a.Cb)({type:f.Z})],w.prototype,"location",void 0),(0,n._)([(0,a.Cb)({type:f.Z})],w.prototype,"intersectedLocation",void 0),(0,n._)([(0,a.Cb)({type:b.Z})],w.prototype,"intersectedGraphic",void 0),(0,n._)([(0,a.Cb)({type:Boolean})],w.prototype,"visible",void 0),w=(0,n._)([(0,l.j)("esri.widgets.LineOfSight.LineOfSightTarget")],w);const C=w;var x,S=i(29292),E=i(61100);!function(e){e[e.PENDING=0]="PENDING",e[e.WAIT_FOR_VIEW_READY=1]="WAIT_FOR_VIEW_READY",e[e.RUNNING=2]="RUNNING"}(x||(x={}));let k=class extends _.Z{constructor(e={}){super(e),this.view=null,this.analysisView=null,this._reconnectViewTask=null,this._forceInteractiveHandle=null,this._changeFromReconnect=!1,this._startUserOperation=null;const t=e?.analysis;null!=t?this.analysis=t:(this._set("analysis",this.constructAnalysis()),this._set("isAnalysisOwner",!0)),null!=e?.visible&&(this.visible=e.visible)}normalizeCtorArgs(e){const{analysis:t,isDefaultViewModel:i,...n}=e;return n}initialize(){const e=()=>{this._changeFromReconnect||this._viewHasAnalysis||this._set("isAnalysisOwner",!1);const e=!this._changeFromReconnect;this._changeFromReconnect=!1,e&&this._scheduleViewReconnect()};this.addHandles([(0,m.gx)((()=>null!=this.view&&this.view.ready&&!this.supported),(()=>s.Z.getLogger(this).errorOnce(this.unsupportedErrorMessage)),m.tX),(0,m.YP)((()=>[this.analysis,this._viewHasAnalysis]),e,m.Z_),(0,m.on)((()=>this.view),"analysis-view-destroy",(t=>{t.analysis===this.analysis&&e()})),(0,m.YP)((()=>({view:this.view,ready:null!=this.view&&this.view.ready,supported:this.supported})),(({view:e},t)=>{const i=t?.view;e!==i&&(this._startUserOperation=(0,E.IM)(this._startUserOperation),this._disconnectFromView(i)),this._scheduleViewReconnect()}),m.tX)])}destroy(){this._reconnectViewTask=(0,E.IM)(this._reconnectViewTask),this._startUserOperation=(0,E.IM)(this._startUserOperation),null!=this.analysisView&&(this.analysisView.visible=void 0),this._disconnectFromView(this.view),this._set("view",null),null!=this.analysis&&this.isAnalysisOwner&&(this.analysis.destroy(),this._set("analysis",null))}get supported(){return null==this.view||this.view.type===this.supportedViewType}set visible(e){this._set("visible",e),null!=this.analysisView&&(this.analysisView.visible=e)}get active(){return null!=this.tool&&this.tool.active}get disabled(){return null==this.view||!this.view.ready||!this.supported}set analysis(e){e!==this._get("analysis")&&(this._startUserOperation=(0,E.IM)(this._startUserOperation),this._disconnectFromView(this.view),this._setExternalAnalysis(e),this._scheduleViewReconnect())}get ready(){return null!=this.analysisView&&!this.connectingToView}get connectingToView(){return null!=this._reconnectViewTask}get isAnalysisOwner(){return this._get("isAnalysisOwner")}get _viewHasAnalysis(){const{view:e}=this;return null!=e&&e.analyses.includes(this.analysis)}get tool(){return this.analysisView?.tool}clear(){this._startUserOperation=(0,E.IM)(this._startUserOperation),this._resetInteractiveCreationState(),null!=this.tool&&null!=this.view&&this.view.activeTool===this.tool&&(this.view.activeTool=null)}async start(){if(!this.visible)return void s.Z.getLogger(this).warn("Cannot start analysis when not visible");this.clear();const e={task:null,abort:null,state:x.PENDING},t=(0,S.vr)((async t=>{if(e.state=x.WAIT_FOR_VIEW_READY,await(0,m.N1)((()=>this.ready),t),e.state=x.RUNNING,null==this.analysisView||null==this.view)return;const i=this.analysisView.tool;null!=i&&(this.view.activeTool=i,(0,m.gx)((()=>i.created),(()=>{i.active&&null!=this.view&&(this.view.activeTool=null)}),{initial:!0,once:!0}))}));return e.task=t,e.abort=()=>t.abort(),this._startUserOperation=e,t.promise}onConnectToAnalysisView(e){}onDisconnectFromAnalysisView(){}_scheduleViewReconnect(){this._reconnectViewTask=(0,E.IM)(this._reconnectViewTask);const e=(0,S.vr)((async t=>{try{await this._reconnectView(t)}catch(e){if((0,r.k_)(t),!(0,r.D_)(e))return void s.Z.getLogger(this).warn("Failed to use analysis in view model",e);throw e}finally{e===this._reconnectViewTask&&(this._reconnectViewTask=null)}}));this._reconnectViewTask=e}async _reconnectView(e){const{view:t}=this,i=null!=t&&t.ready&&this.supported,n=this.analysis;this._startUserOperation=L(this._startUserOperation),this._disconnectFromView(t),i&&null!=t&&null!=n&&(this.isAnalysisOwner&&(this._changeFromReconnect=!0,t.analyses.add(n)),this.analysisView=await t.whenAnalysisView(n),(0,r.Hc)(e)?this._startUserOperation=L(this._startUserOperation):(this.analysisView.visible=this.visible,this._forceInteractiveHandle=this.analysisView.forceInteractive(),this.addHandles(this._forceInteractiveHandle),this.onConnectToAnalysisView(this.analysisView)))}_disconnectFromView(e){null!=e&&this.isAnalysisOwner&&e.analyses.includes(this.analysis)&&(this._changeFromReconnect=!0,this.analysis.clear(),e.analyses.remove(this.analysis)),this.onDisconnectFromAnalysisView(),this._forceInteractiveHandle=(0,E.hw)(this._forceInteractiveHandle),this.analysisView=null}_setExternalAnalysis(e){null==this.analysisView||this.isAnalysisOwner||(this.analysisView.visible=void 0,this._forceInteractiveHandle=(0,E.hw)(this._forceInteractiveHandle)),this.analysisView=null,this._set("isAnalysisOwner",!1),this._set("analysis",e),this._changeFromReconnect=!1}_resetInteractiveCreationState(){this.analysis.clear(),this.tool?.resetCreated()}get testInfo(){}};function L(e){return null!=e&&e.state>=x.RUNNING?(e.abort(),null):e}(0,n._)([(0,a.Cb)()],k.prototype,"supported",null),(0,n._)([(0,a.Cb)()],k.prototype,"view",void 0),(0,n._)([(0,a.Cb)({type:Boolean,value:!0})],k.prototype,"visible",null),(0,n._)([(0,a.Cb)()],k.prototype,"active",null),(0,n._)([(0,a.Cb)()],k.prototype,"disabled",null),(0,n._)([(0,a.Cb)({nonNullable:!0})],k.prototype,"analysis",null),(0,n._)([(0,a.Cb)()],k.prototype,"analysisView",void 0),(0,n._)([(0,a.Cb)()],k.prototype,"ready",null),(0,n._)([(0,a.Cb)()],k.prototype,"connectingToView",null),(0,n._)([(0,a.Cb)({readOnly:!0})],k.prototype,"isAnalysisOwner",null),(0,n._)([(0,a.Cb)()],k.prototype,"_viewHasAnalysis",null),(0,n._)([(0,a.Cb)()],k.prototype,"_reconnectViewTask",void 0),(0,n._)([(0,a.Cb)()],k.prototype,"_forceInteractiveHandle",void 0),(0,n._)([(0,a.Cb)()],k.prototype,"tool",null),k=(0,n._)([(0,l.j)("esri.widgets.support.AnalysisViewModel")],k);const T=p.Z.ofType(C);let M=class extends k{constructor(e){super(e),this.analysis=null,this.supportedViewType="3d",this.unsupportedErrorMessage="LineOfSightViewModel is only supported in 3D views.",this._vmTargetsToConnection=new Map,this._analysisTargetsToConnection=new Map,e?.isDefaultViewModel||(0,o._O)(s.Z.getLogger(this),"Line Of Sight","arcgis-line-of-sight",{version:"4.33"})}initialize(){this.addHandles([this.targets.on("after-add",(e=>this._onViewModelTargetAdded(e.item))),this.targets.on("after-remove",(e=>this._onViewModelTargetRemoved(e.item))),(0,m.YP)((()=>this.analysis),(e=>this._onAnalysisChange(e)),m.tX)])}destroy(){this._analysisTargetsToConnection.forEach((e=>e.remove()))}get state(){return this.disabled||!this.ready?"disabled":null==this.tool?"ready":this.tool.state}get observer(){const{observer:e}=this.analysis;return null==e?.position?null:this._convertAnalysisPointToAbsoluteHeight(e.position,e.elevationInfo)}set observer(e){let t=null;e&&(t=e.clone(),t.hasZ||(t.z=0)),this.analysis.observer=new u.Z({position:t})}get targets(){return this._get("targets")||new T}set targets(e){this._set("targets",(0,y.Z)(e,this.targets,T))}continue(){null!=this.tool&&this.tool.continue()}stop(){null!=this.tool&&this.tool.stop()}get testInfo(){}constructAnalysis(){return new d.Z}async onConnectToAnalysisView(e){this.addHandles([e.on("result-changed",(e=>{const t=this._analysisTargetsToConnection.get(e.target);t&&(null!=e.result?(t.viewModelTarget.intersectedGraphic=e.result.intersectedGraphic,t.viewModelTarget.intersectedLocation=e.result.intersectedLocation,t.viewModelTarget.visible=e.result.visible):(t.viewModelTarget.intersectedGraphic=null,t.viewModelTarget.intersectedLocation=null,t.viewModelTarget.visible=void 0))}))],"view")}onDisconnectFromAnalysisView(){this.removeHandles("view")}_onViewModelTargetAdded(e){if(this._vmTargetsToConnection.get(e))return;const t=new h.Z({position:e.location});this._connectViewModelWithAnalysisTarget(e,t),this.analysis.targets.add(t)}_onViewModelTargetRemoved(e){const t=this._vmTargetsToConnection.get(e);t&&(t.remove(),this.analysis.targets.remove(t.analysisTarget))}_onAnalysisTargetAdded(e){if(this._analysisTargetsToConnection.get(e))return;const{position:t}=e,i=new C({location:t?this._convertAnalysisPointToAbsoluteHeight(t,e.elevationInfo):null});this._connectViewModelWithAnalysisTarget(i,e),this.targets.add(i)}_onAnalysisTargetRemoved(e){const t=this._analysisTargetsToConnection.get(e);t&&(t.remove(),this.targets.remove(t.viewModelTarget))}_connectViewModelWithAnalysisTarget(e,t){let i=!1;const n=(0,g.AL)([(0,m.YP)((()=>({position:t.position,elevationInfo:t.elevationInfo})),(({position:t,elevationInfo:n})=>{i||(i=!0,e.location=t?this._convertAnalysisPointToAbsoluteHeight(t,n):null,i=!1)}),m.Z_),(0,m.YP)((()=>e.location),(e=>{if(!i){i=!0;let n=null;e&&(n=e.clone(),n.hasZ||(n.z=0)),t.position=n,t.elevationInfo=null,i=!1}}),m.Z_)]),o={analysisTarget:t,viewModelTarget:e,remove:()=>{n.remove(),this._vmTargetsToConnection.delete(e),this._analysisTargetsToConnection.delete(t)}};this._vmTargetsToConnection.set(e,o),this._analysisTargetsToConnection.set(t,o)}_onAnalysisChange(e){const t="analysis";this.removeHandles(t),this.addHandles([this.analysis.targets.on("after-add",(e=>this._onAnalysisTargetAdded(e.item))),this.analysis.targets.on("after-remove",(e=>this._onAnalysisTargetRemoved(e.item)))],t),this.targets.removeAll(),e.targets.forEach((e=>{this._onAnalysisTargetAdded(e)}))}_convertAnalysisPointToAbsoluteHeight(e,t){const i=e.clone();if(null!=this.view){const n=(0,v.mF)(e.hasZ,t);i.z=(0,v.vQ)(this.view,e,n,v.jG)}return i}};(0,n._)([(0,a.Cb)({type:d.Z})],M.prototype,"analysis",void 0),(0,n._)([(0,a.Cb)({readOnly:!0})],M.prototype,"state",null),(0,n._)([(0,a.Cb)({type:f.Z})],M.prototype,"observer",null),(0,n._)([(0,a.Cb)({type:T,cast:y.R,nonNullable:!0})],M.prototype,"targets",null),M=(0,n._)([(0,l.j)("esri.widgets.LineOfSight.LineOfSightViewModel")],M);const I=M;var O=i(84644),P=i(46512),A=(i(68808),i(24225)),R=i(23039);const D="esri-line-of-sight",$={base:D,actions:`${D}__actions`,container:`${D}__container`,error:`${D}__error`,hint:`${D}__hint`,hintText:`${D}__hint-text`,newAnalysisButton:`${D}__new-analysis-button`},N={newAnalysisButton:`${D}__new-button`,doneButton:`${D}__done-button`};let F=class extends c.Z{constructor(e,t){super(e,t),this.messages=null,this.viewModel=new I({isDefaultViewModel:!0}),this._onNewAnalysis=()=>{(0,r.R8)(this.viewModel.start())},this._onDone=()=>{this.viewModel.stop()},this._onContinue=()=>{this.viewModel.continue()},(0,o.Pq)(s.Z.getLogger(this),"Line Of Sight","arcgis-line-of-sight",{version:"4.33"})}loadDependencies(){return(0,O.h)({button:()=>Promise.resolve().then(i.bind(i,61637))})}get active(){return this.viewModel.active}get analysis(){return this.viewModel.analysis}set analysis(e){this.viewModel.analysis=e}get icon(){return"line-of-sight"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}render(){return(0,R.u)("div",{class:this.classes($.base,P.z.widget,P.z.panel),role:"presentation"},this._renderContainerNode())}_renderContainerNode(){if(!this.visible)return null;if(!this.viewModel.supported)return this._renderUnsupportedMessage();let e=null;const t=[this._renderNewAnalysisButton()];return"creating"===this.viewModel.state?(e=this._renderHint(),t.unshift(this._renderDoneButton())):"created"===this.viewModel.state&&this.viewModel.targets.length>0&&t.unshift(this._renderContinueButton()),(0,R.u)("div",{class:$.container},e,(0,R.u)("div",{class:$.actions},t))}_renderUnsupportedMessage(){return(0,R.u)("div",{class:$.error,key:"esri-line-of-sight__unsupported"},(0,R.u)("p",null,this.messages.unsupported))}_renderHint(){return(0,R.u)("div",{class:$.hint,key:"esri-line-of-sight__hint"},(0,R.u)("p",{class:$.hintText},this.messages.hint))}_renderNewAnalysisButton(){return this._renderButton({className:$.newAnalysisButton,id:N.newAnalysisButton,label:this.messages.newAnalysis,onClick:this._onNewAnalysis,primary:!0})}_renderDoneButton(){return this._renderButton({id:N.doneButton,label:this.messages.done,onClick:this._onDone,primary:!1})}_renderContinueButton(){return this._renderButton({id:N.newAnalysisButton,label:this.messages.continueAnalysis,onClick:this._onContinue,primary:!1})}_renderButton({className:e,id:t,label:i,onClick:n,primary:o}){const s="disabled"===this.viewModel.state;return(0,R.u)("calcite-button",{appearance:o?"solid":"outline-fill",class:e,"data-id":t,disabled:s,key:t,onclick:n},i)}get test(){}};(0,n._)([(0,a.Cb)()],F.prototype,"active",null),(0,n._)([(0,a.Cb)({nonNullable:!0})],F.prototype,"analysis",null),(0,n._)([(0,a.Cb)()],F.prototype,"icon",null),(0,n._)([(0,a.Cb)()],F.prototype,"label",null),(0,n._)([(0,a.Cb)(),(0,A.H)("esri/widgets/LineOfSight/t9n/LineOfSight")],F.prototype,"messages",void 0),(0,n._)([(0,a.Cb)()],F.prototype,"view",null),(0,n._)([(0,a.Cb)({type:I})],F.prototype,"viewModel",void 0),(0,n._)([(0,a.Cb)()],F.prototype,"visible",null),F=(0,n._)([(0,l.j)("esri.widgets.LineOfSight")],F);const V=F},88512:function(e,t,i){"use strict";i.d(t,{Z:function(){return l}});var n=i(73440),o=i(70880),s=i(17155),r=(i(61432),i(96711),i(83850),i(48023));let a=class extends o.Z{constructor(e){super(e),this.colorSelection=!0,this.dynamicScaleToggle=!0,this.gridEnabledToggle=!0,this.numericInputs=!0,this.gridSnapEnabledToggle=!0,this.lineIntervalInput=!0,this.outOfScaleWarning=!0,this.placementButtons=!0,this.rotateWithMapToggle=!0}};(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],a.prototype,"colorSelection",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],a.prototype,"dynamicScaleToggle",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],a.prototype,"gridEnabledToggle",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],a.prototype,"numericInputs",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],a.prototype,"gridSnapEnabledToggle",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],a.prototype,"lineIntervalInput",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],a.prototype,"outOfScaleWarning",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],a.prototype,"placementButtons",void 0),(0,n._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],a.prototype,"rotateWithMapToggle",void 0),a=(0,n._)([(0,r.j)("esri.widgets.support.GridControls.VisibleElements")],a);const l=a},82504:function(e,t,i){"use strict";i.d(t,{n:function(){return s},t:function(){return l}});var n=i(84644),o=(i(68808),i(23039));const s=()=>(0,n.h)({icon:()=>Promise.resolve().then(i.bind(i,4204)),label:()=>Promise.resolve().then(i.bind(i,36650)),switch:()=>i.e(95636).then(i.bind(i,95636)),tooltip:()=>Promise.all([i.e(62737),i.e(94637)]).then(i.bind(i,70514))}),r="esri-labeled-switch",a={label:`${r}__label`,labelContent:`${r}__label-content`,iconInfo:`${r}__icon_info`,iconWarning:`${r}__icon_warning`,tooltip:`${r}__tooltip`};function l({checked:e,disabled:t,hint:i,key:n,label:s,onChange:r,hintIcon:l,hintKind:c}){return(0,o.u)("calcite-label",{class:a.label,disabled:t,key:n,layout:"inline-space-between",scale:"s"},i?(0,o.u)("div",{class:a.labelContent,key:"label-content"},(0,o.u)("div",null,s),(0,o.u)("calcite-icon",{class:"warning"!==c?a.iconInfo:a.iconWarning,icon:l??"information",id:n,onclick:e=>e.stopPropagation(),onpointerdown:e=>{e.preventDefault(),e.stopPropagation();const t=e.target.nextElementSibling;t.open=!t.open},scale:"s",tabIndex:0}),(0,o.u)("calcite-tooltip",{class:a.tooltip,overlayPositioning:"fixed",referenceElement:n},i)):s,(0,o.u)("calcite-switch",{checked:e,disabled:t,scale:"s",onCalciteSwitchChange:e=>r(e.currentTarget.checked)}))}},58639:function(e,t,i){"use strict";i.d(t,{I:function(){return n}});const n=["label","description","metadata"]},20803:function(e,t,i){"use strict";i.d(t,{MS:function(){return n.G},OR:function(){return h},Rh:function(){return n.n},YI:function(){return a},iD:function(){return n.l},j8:function(){return o.p},qK:function(){return d}});var n=i(42850),o=i(57392),s=(i(73444),i(21042));const r=e=>c(void 0,e),a=e=>t=>c(t,e);class l extends n.C{constructor(e,t){super(e);const i=this.exports;try{(0,n.s)(this.component);const e=t(this.component,this),o=this.exports!==i;if((0,n.i)(e)){o||this.setProvisionalExports(e);const t=e.then((e=>{this.exports=e,super.catchUpLifecycle()})).catch((e=>{this.P.reject(e),console.error(e)}));this.onLoad((async()=>await t))}else o&&void 0===e||(this.exports=e),queueMicrotask((()=>super.catchUpLifecycle()))}catch(e){this.P.reject(e),console.error(e)}}catchUpLifecycle(){}}const c=(0,o.p)(l);const d=e=>(t={})=>r(((i,n)=>{const o=(0,s.aS)(i.el),r={_lang:o.lang,_t9nLocale:o.t9nLocale,_loading:!0},a=i;n.onLifecycle((()=>(0,s.Kn)(i.el,(()=>e("./assets")),(({t9nLocale:e,t9nStrings:t,lang:o})=>{const s={...t,_lang:o,_t9nLocale:e,_loading:!1};n.exports=s;const r=t.componentLabel;"string"==typeof r&&"label"in i&&null==i.label&&(i.label??=r),l(a.messageOverrides)}),t.name)));const l=e=>{const t=n.exports,i=t._original??t,o=u(i,e);e&&(o._original=i),n.exports=o};return"messageOverrides"in a&&n.onUpdate((e=>{e.has("messageOverrides")&&l(a.messageOverrides)})),t.blocking?(n.setProvisionalExports(r,!1),n.ready):r})),u=(e,t)=>{if(!t)return e;const i={...e};return Object.entries(t).forEach((([t,n])=>{i[t]="object"==typeof n?u(e[t],n):n??e[t]})),i},h=e=>p,p=(...e)=>{const t=(0,n.r)(),i=(0,n.f)("arcgisPropertyChange",void 0,t);let o=!0;return t.manager.onUpdated((n=>{if(!o&&t.el.isConnected)for(const t of e)n.has(t)&&i.emit({name:t});else o=!1})),i}},47650:function(e,t,i){"use strict";i.d(t,{V:function(){return a}});var n=i(20803),o=i(90403),s=i(9099),r=i(52043);class a extends n.MS{#e=(0,s.td)(void 0);#t=void 0;#i=!1;constructor(e){super(e);const{el:t}=e,i=t.view;this.setProvisionalExports(void 0),Object.defineProperty(t,"view",{get:()=>this.#e.value,set:e=>{if(this.exports===e)return;const i=t.view;this.#e.value=e,this.exports=e,this.component.requestUpdate("view",i),this.#n()},configurable:!0,enumerable:!0}),e!==t&&Object.defineProperty(e,"view",{get:()=>t.view,set:e=>{t.view=e}}),queueMicrotask((()=>i?t.view=i:0))}hostConnected(){this.component.manager.hasDestroy&&(this.#t??=o.gx((()=>this.#e.value?.destroyed),(()=>{this.component.destroy?.().catch(console.error)}),{sync:!0}),this.onDestroy((()=>this.#t?.remove()))),this.component.manager.loadedCalled&&(0,r.a)(this.component)}hostLoad(){this.component.manager.destroyed}hostLoaded(){const{el:e}=this.component,t=e.shadowRoot?.firstElementChild??e.firstElementChild??void 0;e.childElem??=t,this.#i=!0,this.#n(),e.isConnected&&(0,r.a)(this.component)}hostDisconnected(){"object"==typeof this.component.el.childElem&&this.#e.value?.ui?.remove(this.component.el.childElem)}hostUpdate(e){e.has("position")&&null!=this.component.el.childElem&&"string"==typeof this.component.position&&(0,r.a)(this.component),e.has("referenceElement")&&(0,r.a)(this.component)}#n(){!this.#i||null==this.#e.value||(this.#i=!1,this.component.arcgisReady.emit())}}(0,n.j8)(a)},8403:function(e,t,i){"use strict";i.d(t,{m:function(){return a}});var n=i(20803),o=i(46789),s=i(47650),r=i(90403);const a=(e,t)=>t=>c(t,e);class l extends o.lZ{#t=new Map;#e;#i;constructor(e,t){super(e,t),new s.V(e);const i=this,r=i.instance;let a=r.viewModel,l=r.visibleElements;const c=new Proxy(this.exports,{get(e,t,i){return"viewModel"===t?a:"visibleElements"===t?l:Reflect.get(e,t,i)}});if(i.#i=r,i.instance=c,i.exports=c,a){const t={component:e,get exports(){return i.instance.viewModel}};(0,o.ZJ)(i).set("viewModel","viewModel"),e.addController(t),a=(0,o.we)(e,new WeakRef(t),(0,n.Rh)(e)-1,a,i.#t)}i.instance.visibleElements&&(l=i.#o(r))}hostConnected(){this.instance=this.#i,super.hostConnected()}hostLoad(){this.#e=(0,r.YP)((()=>this.component.el.view),(e=>{const t=this.instance;"view"in t||"object"!=typeof t.viewModel?t.view=e:t.viewModel.view=e,"map"in t||"object"!=typeof t.viewModel?t.map=e?.map:t.viewModel.map=e?.map}),{sync:!0,initial:!0})}hostUpdate(e){e.has("closed")&&(this.instance.visible=!this.component.closed)}hostLoaded(){const{el:e}=this.component;e.childElem??=document.createElement("div"),this.instance.container=e.childElem,void 0!==this.component.closed&&this.onLifecycle((()=>(0,r.YP)((()=>this.instance.visible),(e=>this.component.closed=!e),{initial:!0})))}#o(e){return new Proxy(e.visibleElements,{get:(t,i)=>{if("symbol"==typeof i||i in Promise.prototype)return t[i];const o=[i],s=this.#n(o);return(0,n.iD)(this.component,(t=>{const i=t;this.component[i]=!1;let n,s=e.visibleElements??{};for(const e of o.slice(0,-1)){if("object"!=typeof s[e]||null===s[e]){n=!!s[e];break}s=s[e]}void 0===n&&(n=!!(s[o.slice(-1)[0]]??1));const r=i.startsWith("hide")||i.startsWith("show")?i.startsWith("hide"):n;this.onUpdate((e=>{if(e.has(i)){const e=this.component[i];this.#s(o,e,r)}}))}),s)}})}#n(e){const t=new Proxy({},{get:(i,n)=>{const o=Reflect.get(i,n);return"symbol"==typeof n||n in Promise.prototype?o:(e.push(n),t)}});return t}#s(e,t,i){let n=this.instance.visibleElements??{};for(const t of e.slice(0,-1))("object"!=typeof n[t]||null===n[t])&&(n[t]={}),n=n[t];const o=!!(i?!t:t);n[e.at(-1)]=o}hostDestroy(){this.#e?.remove(),super.hostDestroy()}}const c=(0,n.j8)(l)},97017:function(e,t,i){"use strict";var n=i(64297),o=i(73440),s=i(96711),r=i(90403),a=i(17155),l=(i(61432),i(83850),i(48023)),c=i(74765),d=i(1803);const u="esri-daylight",h=`${u}__container`,p="esri-slider",y={base:u,dayContainer:`${h} ${u}__day-container`,dateContainer:`${h} ${u}__date-container`,containerDisabled:`${h}--disabled`,slider:p,sliderAmPmOn:`${p}--ampm-on`,sliderDateOff:`${p}--date-off`,sliderDateOn:`${p}--date-on`,playPauseButton:`${u}__play-pause-button`,datePicker:`${u}__date-picker`,seasonPicker:`${u}__season-picker`,panelError:`${u}__panel--error`,sunLightingCheckbox:`${u}__sun-lighting-checkbox`,shadowsCheckbox:`${u}__shadows-checkbox`};var g,m=i(87833),f=i(50702),v=i(61100),b=i(99153),_=i(92161),w=i(74558),C=i(24127),x=i(32185);!function(e){e[e.NORTHERN=0]="NORTHERN",e[e.SOUTHERN=1]="SOUTHERN"}(g||(g={}));const S={spring:{dayOfMonth:20,month:2},summer:{dayOfMonth:21,month:5},fall:{dayOfMonth:23,month:8},winter:{dayOfMonth:21,month:11}},E=["spring","summer","fall","winter"];function k(e,t,i){const n=T(t,i),{dayOfMonth:o,month:s}=S[n],r=new Date(e.getTime());return r.setMonth(s,o),r}function L(e,t){return T(function(e){const t=e.getTime(),i=k(e,"spring",g.NORTHERN).getTime(),n=k(e,"summer",g.NORTHERN).getTime(),o=k(e,"fall",g.NORTHERN).getTime(),s=k(e,"winter",g.NORTHERN).getTime();return t>=i&&t<n?"spring":t>=n&&t<o?"summer":t>=o&&t<s?"fall":"winter"}(e),t)}function T(e,t){return t===g.NORTHERN?e:function(e){const t=E.indexOf(e);return E[(t+2)%4]}(e)}var M=i(70880),I=i(88194);let O=class extends M.Z{constructor(e){super(e),this.precision=4,this.thumbsConstrained=!0}set effectiveMax(e){this.setEffectiveMax(e)}set effectiveMin(e){this.setEffectiveMin(e)}set labelFormatFunction(e){this._set("labelFormatFunction",e)}set inputFormatFunction(e){this._set("inputFormatFunction",e)}set inputParseFunction(e){this._set("inputParseFunction",e)}get labels(){const{max:e,min:t,values:i}=this,n=i?.length?i.map(((e,t)=>this.getLabelForValue(e,"value",t))):[];return{max:this.getLabelForValue(e,"max"),min:this.getLabelForValue(t,"min"),values:n}}set max(e){this.setMax(e)}set min(e){this.setMin(e)}get state(){const{max:e,min:t}=this;return null!=e&&null!=t&&e>t?"ready":"disabled"}set values(e){const{max:t,min:i}=this,n=this.values;n&&e&&n.length===e.length&&n.every(((t,i)=>t===e[i]))||(this._set("values",null),e?.length&&(null!=i&&e.some((e=>e<i))&&(this.min=Math.min(...e)),null!=t&&e.some((e=>e>t))&&(this.max=Math.max(...e))),this._set("values",e))}toPrecision(e){return parseFloat(e.toFixed(this.precision))}defaultLabelFormatFunction(e){const{max:t,min:i,precision:n}=this,o=null!=t&&null!=i&&t-i>10?2:n;return parseFloat(e.toFixed(o)).toString()}defaultInputFormatFunction(e){return e.toString()}defaultInputParseFunction(e){return parseFloat(e)}getBounds(){const{effectiveMax:e,effectiveMin:t,max:i,min:n}=this;return{min:null!=t&&null!=n?Math.max(n,t):n,max:null!=e&&null!=i?Math.min(i,e):i}}getBoundsForValueAtIndex(e){const{thumbsConstrained:t,values:i}=this,{min:n,max:o}=this.getBounds();if(t&&i){const t=e-1,s=e+1;return{min:null!=i[t]?i[t]:n,max:null!=i[s]?i[s]:o}}return{min:n,max:o}}getLabelForValue(e,t,i){return null==e?null:this.labelFormatFunction?this.labelFormatFunction(e,t,i):this.defaultLabelFormatFunction(e)}setMax(e){const{max:t,values:i}=this;if(null==e)return void this._set("max",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'max' is NaN.");const n=this.toPrecision(e);if(t!==n&&(this._set("max",n),i?.length))for(let e=0;e<i.length;e++)n<i[e]&&this.setValue(e,n)}setMin(e){const{min:t,values:i}=this;if(null==e)return void this._set("min",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'min' is NaN.");const n=this.toPrecision(e);if(t!==n&&(this._set("min",n),i?.length))for(let e=0;e<i.length;e++)n>i[e]&&this.setValue(e,n)}setEffectiveMax(e){if(null==e)return void this._set("effectiveMax",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'effectiveMax' is NaN.");const t=this.toPrecision(e);this.effectiveMax!==t&&this._set("effectiveMax",this._applyBoundsToValue(t))}setEffectiveMin(e){if(null==e)return void this._set("effectiveMin",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'effectiveMin' is NaN.");const t=this.toPrecision(e);this.effectiveMin!==t&&this._set("effectiveMin",this._applyBoundsToValue(t))}setValue(e,t){if(isNaN(t))return void this._logError("slider:invalid-value","Supplied value for member of property 'values' is NaN.");const{values:i}=this;if(null==i)return void this._logError("slider:invalid-value","Supplied value for member of property 'values' is null.");const n=i[e],o=this.toPrecision(t);if(n===o)return;const s=[...i];s[e]=o,this._set("values",s)}_applyBoundsToValue(e){const{max:t,min:i}=this;return null!=i&&e<i?i:null!=t&&e>t?t:e}_logError(e,t,i){s.Z.getLogger(this).error(new I.Z(e,t,i))}};(0,o._)([(0,a.Cb)()],O.prototype,"effectiveMax",null),(0,o._)([(0,a.Cb)()],O.prototype,"effectiveMin",null),(0,o._)([(0,a.Cb)()],O.prototype,"labelFormatFunction",null),(0,o._)([(0,a.Cb)()],O.prototype,"inputFormatFunction",null),(0,o._)([(0,a.Cb)()],O.prototype,"inputParseFunction",null),(0,o._)([(0,a.Cb)({readOnly:!0})],O.prototype,"labels",null),(0,o._)([(0,a.Cb)()],O.prototype,"max",null),(0,o._)([(0,a.Cb)()],O.prototype,"min",null),(0,o._)([(0,a.Cb)()],O.prototype,"precision",void 0),(0,o._)([(0,a.Cb)({readOnly:!0})],O.prototype,"state",null),(0,o._)([(0,a.Cb)()],O.prototype,"thumbsConstrained",void 0),(0,o._)([(0,a.Cb)()],O.prototype,"values",null),O=(0,o._)([(0,l.j)("esri.widgets.Slider.SliderViewModel")],O);const P=O;let A=class extends P{constructor(){super(...arguments),this.utcOffset=null,this.timezonePickerOpen=!1}};(0,o._)([(0,a.Cb)()],A.prototype,"utcOffset",void 0),(0,o._)([(0,a.Cb)()],A.prototype,"timezonePickerOpen",void 0),A=(0,o._)([(0,l.j)("esri.widgets.Daylight.support.SliderWithDropdownViewModel")],A);var R=i(60646),D=i(69069);const $="esri-slider",N={base:$,reversed:`${$}--reversed`,horizontalLayout:`${$}--horizontal`,verticalLayout:`${$}--vertical`,contentElement:`${$}__content`,extraContentElement:`${$}__extra-content`,trackElement:`${$}__track`,ticksContainerElement:`${$}__ticks`,tickElement:`${$}__tick`,tickLabelElement:`${$}__tick-label`,maxElement:`${$}__max`,minElement:`${$}__min`,maxElementInteractive:`${$}__max--interactive`,minElementInteractive:`${$}__min--interactive`,rangeElementActive:`${$}__range--active`,rangeInput:`${$}__range-input`,anchorElement:`${$}__anchor`,movingAnchorElement:`${$}__anchor--moving`,lastMovedAnchorElement:`${$}__anchor--moved`,anchorElementActive:`${$}__anchor--active`,anchorElementIndexPrefix:`${$}__anchor-`,segmentElement:`${$}__segment`,segmentElementIndexPrefix:`${$}__segment-`,segmentElementInteractive:`${$}__segment--interactive`,segmentElementActive:`${$}__segment--active`,effectiveSegmentElement:`${$}__effective-segment`,effectiveMaxSegmentElement:`${$}__effective-max-segment`,effectiveMinSegmentElement:`${$}__effective-min-segment`,thumbElement:`${$}__thumb`,labelElement:`${$}__label`,labelElementInteractive:`${$}__label--interactive`,labelInput:`${$}__label-input`};var F=i(46512);const V={hour:"numeric",minute:"numeric",timeZone:"UTC"},z={hour:"numeric",timeZone:"UTC"};function Z(e,t){const i=U(e,t);let n=(0,R.p6)(i,V);return 0!==e&&"00:00"===n&&(n="24:00"),"tick"===t&&n.includes(" ")&&(n=(0,R.p6)(i,z),n=n.replace(":00","")),n}function B(e){e.classList.toggle(F.z.primaryTickLabelKeepAll,"ko"===(0,c.v2)()?.language)}function U(e,t){if("tick"===t){const t=Math.round((0,_.rJ)(e,"minutes","hours"));return new Date((0,_.rJ)(t,"hours","milliseconds"))}return new Date(6e4*e)}let H=class extends m.Z.EventedAccessor{constructor(e){super(e),this.view=null,this.timeSliderViewModel=new A({min:0,max:1439,values:[0],labelFormatFunction:Z,inputFormatFunction:Z}),this.lightingUpdateInterval=200,this._oldLighting=null,this.playSpeedMultiplier=1,this._lastTime=null,this._sunrise=null,this._sunset=null,this._cachedLightingDateUTC=new Date(0),this._cachedDisplayUTCOffset=0,this._lastLightingUpdate=0,this._lightingUpdateHandle=null}initialize(){this.addHandles([(0,r.gx)((()=>this.view),(e=>e.when((()=>this._updateLighting()))),r.nn),(0,r.YP)((()=>{const e=this._lighting;return"sun"===e?.type?e.date:null}),(e=>this._scheduleLightingUpdate(e))),(0,r.on)((()=>this._lighting),"timezone-will-change",(e=>this._timezoneWillChange(e)),{onListenerAdd:()=>this._timezoneWillChange(null)}),(0,r.YP)((()=>!0===this.view?.stationary),(()=>{(this.dayPlaying||this.yearPlaying)&&this._updateSunriseAndSunset()}),r.nn),(0,r.YP)((()=>{const e=this.timeSliderViewModel;return{vm:e,state:e.state,sliderPosition:this.timeSliderPosition}}),(({vm:e,state:t,sliderPosition:i})=>{"ready"===t&&e.setValue(0,i)})),(0,r.YP)((()=>this.timeSliderViewModel?.utcOffset),(e=>{null!=e&&(this.utcOffset=e)})),(0,r.YP)((()=>({utcOffset:this.utcOffset,sliderViewModel:this.timeSliderViewModel})),(({utcOffset:e,sliderViewModel:t})=>{t&&(t.utcOffset=e)}),r.tX),(0,r.YP)((()=>this.timeSliderViewModel.timezonePickerOpen),(()=>this.stopPlaying())),(0,r.YP)((()=>this.timeSliderViewModel.values),(e=>this._setTimeSliderPosition(e?.[0]??0,{forceLightingUpdate:!1})))])}destroy(){this._cancelLightingUpdate(),this.view=null}get isSupported(){return null==this.view||"3d"===this.view.type}get utcOffset(){return this._cachedDisplayUTCOffset}set utcOffset(e){e!==this.utcOffset&&null!=this._lighting&&"virtual"!==this._lighting.type&&(this._lighting.displayUTCOffset=e,this._updateLighting())}get localDate(){return(0,_.cH)(this._lightingDateDisplay)}set localDate(e){this.view?.ready?(0,_.qb)(e)&&e.getTime()!==this.localDate.getTime()&&(this._lightingDateDisplay=(0,_.y7)(this._lightingDateDisplay,e)):s.Z.getLogger(this).error("The localDate property cannot be set before the view and the widget are ready.")}get timeSliderPosition(){return function(e){return(0,_.Ni)(e,"minutes")}(this._lightingDateDisplay)}set timeSliderPosition(e){this.view?.ready&&"ready"===this.timeSliderViewModel?.state?this._setTimeSliderPosition(e,{forceLightingUpdate:!0}):s.Z.getLogger(this).error("The timeSliderPosition property cannot be set before the view and the widget are ready.")}_setTimeSliderPosition(e,t){Math.abs(e-this.timeSliderPosition)<=1/60||(this.stopPlaying(),this._onUserDateTimeChange(),t.forceLightingUpdate&&(this._cancelLightingUpdate(),this._updateLighting()),this._lightingDateDisplay=function(e,t){return(0,_.cl)(e,t,"minutes")}(this._lightingDateDisplay,e))}_timezoneFromCamera(e,t){if(null==t||!e.cameraTrackingEnabled)return 0;const i=(0,x.dF)([t.longitude,t.latitude]);return null==i?0:Math.round(i.hours+i.minutes/60+i.seconds/3600)}get directShadowsEnabled(){return this._lighting?.directShadowsEnabled??!1}set directShadowsEnabled(e){const t=this._lighting;t&&(t.directShadowsEnabled=e)}get sunLightingEnabled(){return"sun"===this._lightingType}set sunLightingEnabled(e){const t=this._environment;if(e===this._get("sunLightingEnabled")||null==t)return;const i=t.lighting,n=this._oldLighting;this._oldLighting=i;const o={directShadowsEnabled:i.directShadowsEnabled,cameraTrackingEnabled:i.cameraTrackingEnabled},s=e?"sun":"virtual";let r;r=null!=n&&n.type===s?n:e?new w.Z:new C.Z,r.set(o),t.lighting=r,e||(this.stopPlaying(),this.timeSliderViewModel.timezonePickerOpen=!1)}set playingState(e){this.playingState!==e&&(this._set("playingState",e),"none"!==e&&this.sunLightingEnabled&&(this._updateSunriseAndSunset(),this._lastTime=Date.now(),this._play(),this._onUserDateTimeChange()))}get dayPlaying(){return"day"===this.playingState}set dayPlaying(e){e?this.playingState="day":this.dayPlaying&&(this.playingState="none")}get yearPlaying(){return"year"===this.playingState}set yearPlaying(e){e?this.playingState="year":this.yearPlaying&&(this.playingState="none")}get currentSeason(){return L(this.localDate,this._currentHemisphere)}set currentSeason(e){this.stopPlaying(),this._onUserDateTimeChange();const t=T(e,this._currentHemisphere);this.localDate=k(this.localDate,t,g.NORTHERN)}get _currentHemisphere(){const e=this.view?.camera?.position?.latitude;return null==e||e>=0?g.NORTHERN:g.SOUTHERN}get _environment(){return this.view?.environment}get _lighting(){return this._environment?.lighting}get _lightingType(){return this._lighting?.type}get _lightingDateDisplay(){return(0,_.Nm)(this._cachedLightingDateUTC,this._cachedDisplayUTCOffset,"hours")}set _lightingDateDisplay(e){const t=this._lighting;if(null==t||!this.sunLightingEnabled||"virtual"===t.type||!(0,_.qb)(e))return;const i=t.date,n=(0,_.Nm)(e,-this._cachedDisplayUTCOffset,"hours");n.getTime()!==i.getTime()&&(t.date=n,this._updateLighting())}stopPlaying(){this.playingState="none"}toggleDayPlaying(){this.dayPlaying=!this.dayPlaying}toggleYearPlaying(){this.yearPlaying=!this.yearPlaying}toggleSunLightingEnabled(){this.stopPlaying(),this.sunLightingEnabled=!this.sunLightingEnabled}toggleDirectShadowsEnabled(){this.stopPlaying(),this.directShadowsEnabled=!this.directShadowsEnabled}onDateChange(e){this.dayPlaying=!1,this.localDate=e,this._onUserDateTimeChange()}_updateLighting(e){const t=Date.now();this._lastLightingUpdate=t;const{view:i}=this,n=this._lighting;if(null==i||null==n||"virtual"===n.type)return;e??=n.date;const o=n.displayUTCOffset,s=null!=o?o:this._timezoneFromCamera(n,i.camera?.position);this._cachedLightingDateUTC.getTime()!==e.getTime()&&(this._cachedLightingDateUTC=new Date(e.getTime())),this._cachedDisplayUTCOffset!==s&&(this._cachedDisplayUTCOffset=s)}_timezoneWillChange(e){const t=this._lighting;if(null==t||"virtual"===t.type||!t.cameraTrackingEnabled)return;let i;if(e)i=e.timezoneOffset;else{if(null!=t.displayUTCOffset)return;i=w.Z.calculateTimezoneOffset(t.positionTimezoneInfo)}t.displayUTCOffset=i,this._scheduleLightingUpdate()}_scheduleLightingUpdate(e){if(e&&(this._lightingUpdateHandle=(0,v.hw)(this._lightingUpdateHandle),!(0,_.qb)(e)))return;if(this._lightingUpdateHandle)return;const t=Date.now()-this._lastLightingUpdate,i=this.lightingUpdateInterval-t;let n=null;const o=()=>{this._updateLighting(e),this._lightingUpdateHandle===n&&(this._lightingUpdateHandle=null)};if(i<=0)this._lightingUpdateHandle=n=(0,b.Os)(o);else{const e=setTimeout(o,i);this._lightingUpdateHandle=n=(0,f.kB)((()=>clearTimeout(e)))}}_cancelLightingUpdate(){this._lightingUpdateHandle=(0,v.hw)(this._lightingUpdateHandle)}_play(){const e=this._lighting;if(null==e||!this.sunLightingEnabled||"virtual"===e.type)return;const t=e.date;if(this.dayPlaying||this.yearPlaying){const i=Date.now()-(this._lastTime??0);if(this.dayPlaying){this._lastTime=Date.now();const n=function(e,t,i){const n=12e5,o=n/4,s=18e5,r=o/3*2,a=72e5;if(null==e||null==t||isNaN(e.getTime())&&isNaN(t.getTime()))return o;const l=i.getTime(),c=e.getTime(),d=t.getTime(),u=c-a/2,h=c+a/2,p=d-a/3*2,y=d+a/3;let g=o;return l>=u&&l<=h?g=l-u<=n?s-(l-u)/n*(s-r):h-l<=n/2?o-(h-l)/n*2*(o-r):r:l>=p&&l<=y?g=l-p<=n/2?o-(l-p)/n*2*(o-r):y-l<=n?s-(y-l)/n*(s-r):r:(l<c||l>d)&&(g=s),g}(this._sunrise,this._sunset,t)*this.playSpeedMultiplier/100*i;if(n>0){let i=new Date(t.getTime()+n);const o=e.displayUTCOffset??0;if(((i.getUTCHours()+o)%24+24)%24<((t.getUTCHours()+o)%24+24)%24){const e=864e5;i=new Date(t.getTime()+n-e)}e.date=i}}else if(i>1e3){this._lastTime=Date.now();const i=(t.getUTCMonth()+1)%12,n=new Date(t.getTime());n.setUTCMonth(i),e.date=n}requestAnimationFrame((()=>this._play()))}}_updateSunriseAndSunset(){const e=this._lighting;if(null==e||"virtual"===e.type||!this.sunLightingEnabled)return;const t=this.view?.camera?.position;if(null==t)return;const{latitude:i,longitude:n}=t,{date:o,displayUTCOffset:s}=e,r=function(e,t,i,n){if(null==t||null==i)return null;const o=D.S.getTimes(e,t,i),s=o.sunrise,r=o.sunset,a=(0,_.Nm)(e,n,"hours"),l=(0,_.Nm)(s,n,"hours"),c=(0,_.Nm)(r,n,"hours");if(a.getUTCDate()!==l.getUTCDate()||a.getUTCDate()!==c.getUTCDate()){const e=a.getTime()-l.getTime()>0?1:-1;s.setUTCDate(s.getUTCDate()+e),r.setUTCDate(r.getUTCDate()+e)}return{sunrise:s,sunset:r}}(o,i,n,s??0);r&&(this._sunrise=new Date(r.sunrise),this._sunset=new Date(r.sunset))}_onUserDateTimeChange(){this.emit("user-date-time-change",{})}};(0,o._)([(0,a.Cb)()],H.prototype,"view",void 0),(0,o._)([(0,a.Cb)({type:A,nonNullable:!0})],H.prototype,"timeSliderViewModel",void 0),(0,o._)([(0,a.Cb)()],H.prototype,"isSupported",null),(0,o._)([(0,a.Cb)()],H.prototype,"lightingUpdateInterval",void 0),(0,o._)([(0,a.Cb)()],H.prototype,"utcOffset",null),(0,o._)([(0,a.Cb)({type:Date})],H.prototype,"localDate",null),(0,o._)([(0,a.Cb)()],H.prototype,"timeSliderPosition",null),(0,o._)([(0,a.Cb)()],H.prototype,"directShadowsEnabled",null),(0,o._)([(0,a.Cb)()],H.prototype,"sunLightingEnabled",null),(0,o._)([(0,a.Cb)({type:["none","day","year"],value:"none"})],H.prototype,"playingState",null),(0,o._)([(0,a.Cb)()],H.prototype,"dayPlaying",null),(0,o._)([(0,a.Cb)()],H.prototype,"yearPlaying",null),(0,o._)([(0,a.Cb)()],H.prototype,"playSpeedMultiplier",void 0),(0,o._)([(0,a.Cb)()],H.prototype,"currentSeason",null),(0,o._)([(0,a.Cb)()],H.prototype,"_lastTime",void 0),(0,o._)([(0,a.Cb)()],H.prototype,"_sunrise",void 0),(0,o._)([(0,a.Cb)()],H.prototype,"_sunset",void 0),(0,o._)([(0,a.Cb)()],H.prototype,"_cachedLightingDateUTC",void 0),(0,o._)([(0,a.Cb)()],H.prototype,"_cachedDisplayUTCOffset",void 0),(0,o._)([(0,a.Cb)()],H.prototype,"_currentHemisphere",null),(0,o._)([(0,a.Cb)()],H.prototype,"_environment",null),(0,o._)([(0,a.Cb)()],H.prototype,"_lighting",null),(0,o._)([(0,a.Cb)()],H.prototype,"_lightingType",null),(0,o._)([(0,a.Cb)()],H.prototype,"_lightingDateDisplay",null),H=(0,o._)([(0,l.j)("esri.widgets.Daylight.DaylightViewModel")],H);const G=H;let j=class extends M.Z{constructor(e){super(e),this.header=!0,this.playButtons=!0,this.datePicker=!0,this.timezone=!0,this.sunLightingToggle=!0,this.shadowsToggle=!0}};(0,o._)([(0,a.Cb)({type:Boolean,nonNullable:!0})],j.prototype,"header",void 0),(0,o._)([(0,a.Cb)({type:Boolean,nonNullable:!0})],j.prototype,"playButtons",void 0),(0,o._)([(0,a.Cb)({type:Boolean,nonNullable:!0})],j.prototype,"datePicker",void 0),(0,o._)([(0,a.Cb)({type:Boolean,nonNullable:!0})],j.prototype,"timezone",void 0),(0,o._)([(0,a.Cb)({type:Boolean,nonNullable:!0})],j.prototype,"sunLightingToggle",void 0),(0,o._)([(0,a.Cb)({type:Boolean,nonNullable:!0})],j.prototype,"shadowsToggle",void 0),j=(0,o._)([(0,l.j)("esri.widgets.Daylight.VisibleElements")],j);const K=j;i(55214);var W=i(43254),Y=i(90775),q=i(68808),X=i(24225),J=i(23039),Q=i(37964);const ee={showInput:"Enter",hideInput1:"Enter",hideInput2:"Escape",hideInput3:"Tab",moveAnchorUp:"ArrowUp",moveAnchorDown:"ArrowDown",moveAnchorLeft:"ArrowLeft",moveAnchorRight:"ArrowRight",moveAnchorToMax:"End",moveAnchorToMin:"Home"},te={labels:!1,rangeLabels:!1};let ie=class extends d.Z{constructor(e,t){super(e,t),this._activeLabelInputIndex=null,this._anchorElements=[],this._dragged=!1,this._dragStartInfo=null,this._focusedAnchorIndex=null,this._isMinInputActive=!1,this._isMaxInputActive=!1,this._lastMovedHandleIndex=null,this._positionPrecision=5,this._segmentDragStartInfo=null,this._trackHeight=null,this._trackWidth=null,this._zIndices=[],this._zIndexOffset=3,this.disabled=!1,this.draggableSegmentsEnabled=!0,this.effectiveSegmentElements=new W.Z,this.extraNodes=[],this.inputCreatedFunction=null,this.labelElements=new W.Z,this.labelInputsEnabled=!1,this.maxLabelElement=null,this.messages=null,this.minLabelElement=null,this.rangeLabelInputsEnabled=!1,this.segmentElements=new W.Z,this.snapOnClickEnabled=!0,this.steps=null,this.syncedSegmentsEnabled=!1,this.thumbCreatedFunction=null,this.thumbElements=new W.Z,this.tickElements=new W.Z,this.trackElement=null,this.viewModel=new P,this.visibleElements={...te},this._onAnchorPointerDown=this._onAnchorPointerDown.bind(this),this._onAnchorPointerMove=this._onAnchorPointerMove.bind(this),this._onAnchorPointerUp=this._onAnchorPointerUp.bind(this),this._onLabelPointerDown=this._onLabelPointerDown.bind(this),this._onLabelPointerUp=this._onLabelPointerUp.bind(this),this._onSegmentPointerDown=this._onSegmentPointerDown.bind(this),this._onSegmentPointerMove=this._onSegmentPointerMove.bind(this),this._onSegmentPointerUp=this._onSegmentPointerUp.bind(this),this._onTrackPointerDown=this._onTrackPointerDown.bind(this),this._onTrackPointerMove=this._onTrackPointerMove.bind(this),this._onTrackPointerUp=this._onTrackPointerUp.bind(this)}destroy(){document.removeEventListener("pointerup",this._onLabelPointerUp),document.removeEventListener("pointermove",this._onLabelPointerMove),document.removeEventListener("pointerup",this._onAnchorPointerUp),document.removeEventListener("pointermove",this._onAnchorPointerMove),this.labelElements.removeAll(),this.labelElements.destroy(),this.segmentElements.removeAll(),this.segmentElements.destroy(),this.effectiveSegmentElements.removeAll(),this.effectiveSegmentElements.destroy(),this.thumbElements.removeAll(),this.thumbElements.destroy(),this.tickElements.removeAll(),this.tickElements.destroy()}get _isDisabled(){return this.disabled||"disabled"===this.state}get effectiveMax(){return this.viewModel.effectiveMax}set effectiveMax(e){this.viewModel.effectiveMax=e}get effectiveMin(){return this.viewModel.effectiveMin}set effectiveMin(e){this.viewModel.effectiveMin=e}get inputFormatFunction(){return this.viewModel.inputFormatFunction}set inputFormatFunction(e){this.viewModel.inputFormatFunction=e}get inputParseFunction(){return this.viewModel.inputParseFunction}set inputParseFunction(e){this.viewModel.inputParseFunction=e}get icon(){return"caret-double-horizontal"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get labelFormatFunction(){return this.viewModel.labelFormatFunction}set labelFormatFunction(e){this.viewModel.labelFormatFunction=e}get labels(){return this.viewModel.labels}set layout(e){["vertical","vertical-reversed","horizontal","horizontal-reversed"].includes(e)||(e="horizontal"),this._set("layout",e)}get max(){return this.viewModel.max}set max(e){this.viewModel.max=e}get min(){return this.viewModel.min}set min(e){this.viewModel.min=e}get precision(){return this.viewModel.precision}set precision(e){this.viewModel.precision=e}get state(){const{_activeLabelInputIndex:e,_isMaxInputActive:t,_isMinInputActive:i,_dragStartInfo:n,_segmentDragStartInfo:o,disabled:s,viewModel:r}=this;return s?"disabled":null!==e||t||i?"editing":null!=n||null!=o?"dragging":r.state}get thumbsConstrained(){return this.viewModel.thumbsConstrained}set thumbsConstrained(e){this.viewModel.thumbsConstrained=e}set tickConfigs(e){this._set("tickConfigs",e),this.scheduleRender()}get values(){return this.viewModel.values}set values(e){this.viewModel.values=e}castVisibleElements(e){return{...te,...e}}render(){const{label:e}=this,t=this.classes(N.base,F.z.widget,this._isHorizontalLayout()?N.horizontalLayout:N.verticalLayout,this._isReversedLayout()?N.reversed:null,this._isDisabled?F.z.disabled:null);return this._storeTrackDimensions(),(0,J.u)("div",{afterCreate:this._afterContainerCreate,"aria-label":e,bind:this,class:t,"touch-action":"none"},this._renderContent())}toNextStep(e){this._toStep(e,1)}toPreviousStep(e){this._toStep(e,-1)}getCurrentPosition(){return this._positionFromValue(this.values?.[0]??0)}_renderContent(){const{max:e,min:t}=this;if(!(null==t||null==e||t>=e))return[this._renderMin(),this._renderSliderContainer(),this._renderMax()]}_renderSliderContainer(){return(0,J.u)("div",{bind:this,class:N.contentElement,key:"slider-container"},this._renderTrackElement(),this._renderTicksContainer(),this._renderExtraContentElements())}_renderTrackElement(){return(0,J.u)("div",{afterCreate:this._afterTrackCreate,afterRemoved:this._afterTrackRemoved,bind:this,class:N.trackElement,"touch-action":"none"},this._renderEffectiveSegmentElements(),this._renderSegmentElements(),this._renderAnchorElements())}_renderEffectiveSegmentElements(){if(!this.trackElement||!this.values?.length)return;const e=null!=this.effectiveMax,t=null!=this.effectiveMin;if(!e&&!t)return;const{max:i,min:n,viewModel:o}=this,s=o.getBounds(),r=[];return t&&r.push(this._renderEffectiveSegmentElement(n,s.min,!0)),e&&r.push(this._renderEffectiveSegmentElement(s.max,i,!1)),r}_renderSegmentElements(){if(!this.trackElement||!this.values?.length)return;const e=this.values.length,t=[];for(let i=0;i<=e;i++)t.push(this._renderSegmentElement(i));return t}_renderSegmentElement(e){const{_trackHeight:t,_trackWidth:i,draggableSegmentsEnabled:n,id:o,state:s}=this,r=this.values,a=this._isHorizontalLayout(),l=a?i:t,c=this.viewModel.getBounds(),d=this._positionFromValue(c.max),u=this._positionFromValue(c.min),h=e===r?.length?null:e,p=0===e?null:e-1,y=null!=h,g=null!=p;let m,f;const v=[...r].sort(((e,t)=>e-t));this._isReversedLayout()?(m=g?this._positionFromValue(v[p]):u,f=y?this._positionFromValue(v[h]):d):(m=y?this._positionFromValue(v[h]):d,f=g?this._positionFromValue(v[p]):u);const b=this._applyPrecisionToPosition(100*f/l),_=(m-f)/l,w=a?`transform: translate(${b}%, 0px) scale(${_}, 1);`:`transform: translate(0px, ${b}%) scale(1, ${_});`,C=this.classes(N.segmentElement,N.segmentElementIndexPrefix+e,n&&y&&g&&"disabled"!==s?N.segmentElementInteractive:null);return(0,J.u)("div",{afterCreate:this._afterSegmentCreate,afterRemoved:this._afterSegmentRemoved,bind:this,class:C,"data-max-thumb-index":h,"data-min-thumb-index":p,"data-segment-index":e,key:`${o}-segment-${e}`,style:w,"touch-action":"none"})}_renderEffectiveSegmentElement(e,t,i){const{_trackHeight:n,_trackWidth:o,layout:s}=this,r=this._positionFromValue(e),a=this._positionFromValue(t),l=this._isHorizontalLayout(),c=l?o:n,d=this._applyPrecisionToPosition(100*r/c);let u=null;if("horizontal"===s){const e=i?c-a:a,t=r===c?0:d;u=`clip-path: inset(0% ${a===c?0:this._applyPrecisionToPosition(e/c*100)}% 0% ${t}%);`}else{const e=(a-r)/c;u=l?`transform: translate(${d}%, 0px) scale(${e}, 1);`:`transform: translate(0px, ${d}%) scale(1, ${e});`}const h=i?N.effectiveMinSegmentElement:N.effectiveMaxSegmentElement,p=this.classes(N.segmentElement,N.effectiveSegmentElement,h);return(0,J.u)("div",{afterCreate:this._afterEffectiveSegmentCreate,afterRemoved:this._afterEffectiveSegmentRemoved,bind:this,class:p,style:u,"touch-action":"none"})}_renderAnchorElements(){const{trackElement:e,values:t}=this;if(t?.length)return this._zIndices=t.map(((e,i)=>{const n=this._positionFromValue(e),o=this._positionToPercent(n),s=(this._isHorizontalLayout()?o>50:o<50)?-1:1;return this._zIndexOffset+(t.length+s*i)})),e&&t&&t.length?t.map(((e,t)=>this._renderAnchorElement(e,t))):null}_renderAnchorElement(e,t){const i=this._positionFromValue(e),n=this._valueFromPosition(i);if(null==n||isNaN(n))return;const{_dragStartInfo:o,_lastMovedHandleIndex:s,id:r,layout:a,visibleElements:{labels:l}}=this,c=this.values,d=o&&o.index===t,u=s===t,h=this.classes(N.anchorElement,N.anchorElementIndexPrefix+t,d?N.movingAnchorElement:null,u?N.lastMovedAnchorElement:null),p=this.labels.values[t],y=this._getStyleForAnchor(e,t,d||u),{min:g,max:m}=this.viewModel.getBoundsForValueAtIndex(t),{disabled:f,messages:v}=this,b=2===c.length?(0,Q.n)(0===t?v.rangeMinimum:v.rangeMaximum,{value:e}):p,_=1===c.length?null:0===t?`${r}-handle-${t+1}`:t===c.length-1?`${r}-handle-${t-1}`:`${r}-handle-${t-1} ${r}-handle-${t+1}`;return(0,J.u)("div",{afterCreate:this._afterAnchorCreate,afterRemoved:this._afterAnchorRemoved,afterUpdate:this._afterAnchorUpdate,"aria-controls":_,"aria-label":v.sliderValue,"aria-labelledby":l?`${r}-label-${t}`:null,"aria-orientation":a,"aria-valuemax":m?.toString(),"aria-valuemin":g?.toString(),"aria-valuenow":e.toString(),"aria-valuetext":b,bind:this,class:h,"data-thumb-index":t,"data-value":e,id:`${r}-handle-${t}`,key:`${r}-handle-${t}`,onkeydown:this._onAnchorKeyDown,role:"slider",style:y,tabIndex:f?-1:0,"touch-action":"none"},(0,J.u)("span",{afterCreate:this._afterThumbCreate,afterRemoved:this._afterThumbRemoved,bind:this,class:N.thumbElement,"data-thumb-index":t,"touch-action":"none"}),this.renderThumbLabel(t))}renderThumbLabel(e){const{id:t,labels:i,labelInputsEnabled:n,state:o}=this,s=this.visibleElements.labels,r=i.values[e],a=this.classes(N.labelElement,s?null:F.z.hidden,n&&"disabled"!==o?N.labelElementInteractive:null);return(0,J.u)("span",{afterCreate:this._afterLabelCreate,afterRemoved:this._afterLabelRemoved,"aria-hidden":(!s).toString(),bind:this,class:a,"data-thumb-index":e,id:`${t}-label-${e}`,key:`${t}-label-${e}`,role:n?"button":void 0,"touch-action":"none"},this._activeLabelInputIndex===e?this._renderValueInput(e):r)}_renderValueInput(e){const{disabled:t,values:i}=this;if(null==i)return;const n=i[e];return(0,J.u)("input",{afterCreate:this._afterInputCreate,"aria-label":this.messages.sliderValue,bind:this,class:N.labelInput,"data-input-index":e,"data-input-type":"thumb",key:`value-input-${e}`,onblur:this._onLabelInputBlur,onkeydown:this._onInputKeyDown,required:!0,tabIndex:t?-1:0,type:"text",value:this._formatInputValue(n,"value",e)})}_renderMax(){const{_isMaxInputActive:e,labels:t,rangeLabelInputsEnabled:i,state:n}=this,o=this.visibleElements.rangeLabels,s=this.classes(N.maxElement,{[F.z.hidden]:!o,[N.maxElementInteractive]:i&&"disabled"!==n,[N.rangeElementActive]:e});return(0,J.u)("div",{afterCreate:this._afterMaxLabelCreate,"aria-hidden":(!o).toString(),bind:this,class:s,onclick:this._onMaxLabelClick,onkeydown:this._onMaxLabelKeyDown,role:i?"button":void 0,tabIndex:!this.disabled&&i?0:-1},e?this._renderMaxInput():t.max)}_renderMin(){const{_isMinInputActive:e,labels:t,rangeLabelInputsEnabled:i,state:n}=this,o=this.visibleElements.rangeLabels,s=this.classes(N.minElement,{[F.z.hidden]:!o,[N.minElementInteractive]:i&&"disabled"!==n,[N.rangeElementActive]:e});return(0,J.u)("div",{afterCreate:this._afterMinLabelCreate,"aria-hidden":(!o).toString(),bind:this,class:s,onclick:this._onMinLabelClick,onkeydown:this._onMinLabelKeyDown,role:i?"button":void 0,tabIndex:!this.disabled&&i?0:-1},e?this._renderMinInput():t.min)}_renderMaxInput(){return(0,J.u)("input",{afterCreate:this._afterInputCreate,"aria-label":this.messages.maximumValue,bind:this,class:N.rangeInput,"data-input-type":"max",onblur:this._onMaxInputBlur,onkeydown:this._onInputKeyDown,required:!0,tabIndex:this.disabled?-1:0,type:"text",value:this._formatInputValue(this.max,"max")})}_renderMinInput(){return(0,J.u)("input",{afterCreate:this._afterInputCreate,"aria-label":this.messages.minimumValue,bind:this,class:N.rangeInput,"data-input-type":"min",onblur:this._onMinInputBlur,onkeydown:this._onInputKeyDown,required:!0,tabIndex:this.disabled?-1:0,type:"text",value:this._formatInputValue(this.min,"min")})}_renderExtraContentElements(){return(0,J.u)("div",{bind:this,class:N.extraContentElement},this.extraNodes)}_renderTicksContainer(){if(this.tickConfigs&&this.trackElement&&(0!==this._trackHeight||0!==this._trackWidth))return this.tickConfigs.map(((e,t)=>(0,J.u)("div",{class:this.classes(N.ticksContainerElement),key:"ticks-container"},this._renderTicks(e,t))))}_renderTicks(e,t){const{mode:i,values:n}=e;if(this.tickElements.at(t)||this.tickElements.add(new W.Z,t),"position"===i){const i=Array.isArray(n)?n:[n];return this._calculateTickPositions(i).map(((i,n)=>this._renderTickGroup(e,n,t,i)))}if("percent"===i&&Array.isArray(n)){const i=this.min??0,o=(this.max??0)-i,s=n.map((e=>this._applyPrecisionToPosition(e/100*o+i)));return this._calculateTickPositions(s).map(((i,n)=>this._renderTickGroup(e,n,t,i)))}const o=Array.isArray(n)&&n.length?n[0]:isNaN(n)?null:n,s=this._getTickCounts(o,e);return this._calculateEquidistantTickPositions(s).map(((i,n)=>this._renderTickGroup(e,n,t,i)))}_renderTickGroup(e,t,i,n){const o="position"===e.mode?Array.isArray(e.values)?e.values[t]:e.values:this._valueFromPosition(n);if(null!=o&&!isNaN(o))return(0,J.u)("div",{afterCreate:this._afterTickGroupCreate,afterRemoved:this._afterTickGroupRemoved,bind:this,"data-config":e,"data-position":n,"data-tick-config-index":i,"data-tick-group-index":t,"data-value":o,key:`tick-group-${t}`,onclick:this._onTickGroupClick},this._renderTickLine(e,t,i,o),e.labelsVisible?this._renderTickLabel(e,t,i,o):null)}_renderTickLine(e,t,i,n){return(0,J.u)("div",{afterCreate:this._afterTickLineCreate,"aria-valuenow":n.toString(),bind:this,class:N.tickElement,"data-config":e,"data-tick-config-index":i,"data-tick-group-index":t,"data-value":n,key:`tick-label-${t}`,style:this._getPositionStyleForElement(n)})}_renderTickLabel(e,t,i,n){const o=e.labelFormatFunction?e.labelFormatFunction(n,"tick",t):this.viewModel.getLabelForValue(n,"tick",t);return(0,J.u)("div",{afterCreate:this._afterTickLabelCreate,"aria-label":o,"aria-valuenow":n.toString(),"aria-valuetext":o,bind:this,class:N.tickLabelElement,"data-config":e,"data-tick-config-index":i,"data-tick-group-index":t,"data-value":n,key:`tick-label-${t}`,style:`transform: translate(-50%); ${this._getPositionStyleForElement(n)}`},o)}_afterContainerCreate(e){this.addHandles((0,q.ib)(e,(()=>this.scheduleRender())))}_afterTrackCreate(e){this._set("trackElement",e),e.addEventListener("pointerdown",this._onTrackPointerDown),this.scheduleRender()}_afterTrackRemoved(e){e.removeEventListener("pointerdown",this._onTrackPointerDown),document.removeEventListener("pointermove",this._onTrackPointerMove),document.removeEventListener("pointerup",this._onTrackPointerUp)}_afterSegmentCreate(e){this.segmentElements.add(e),e.addEventListener("pointerdown",this._onSegmentPointerDown)}_afterSegmentRemoved(e){this.segmentElements.remove(e),e.removeEventListener("pointerdown",this._onSegmentPointerDown)}_afterEffectiveSegmentCreate(e){this.effectiveSegmentElements.add(e)}_afterEffectiveSegmentRemoved(e){this.effectiveSegmentElements.remove(e)}_afterAnchorCreate(e){if(this._anchorElements.push(e),e.addEventListener("pointerdown",this._onAnchorPointerDown),this.thumbCreatedFunction){const t=ne(e),i=oe(e),n=this.thumbElements.at(t),o=this.labelElements.at(t)||null;this.thumbCreatedFunction(t,i,n,o)}}_afterAnchorUpdate(e){null!=this._focusedAnchorIndex&&ne(e)===this._focusedAnchorIndex&&(e.focus(),this._focusedAnchorIndex=null)}_afterAnchorRemoved(e){const t=this._anchorElements.indexOf(e,0);t>-1&&this._anchorElements.splice(t,1),e.removeEventListener("pointerdown",this._onAnchorPointerDown)}_afterThumbCreate(e){this.thumbElements.add(e)}_afterThumbRemoved(e){this.thumbElements.remove(e)}_afterLabelCreate(e){this.labelElements.add(e),e.addEventListener("pointerdown",this._onLabelPointerDown),e.addEventListener("pointerup",this._onLabelPointerUp)}_afterLabelRemoved(e){this.labelElements.remove(e),e.removeEventListener("pointerdown",this._onLabelPointerDown),e.removeEventListener("pointerup",this._onLabelPointerUp)}_afterInputCreate(e){if(e.focus(),e.select(),this.inputCreatedFunction){const t=e.getAttribute("data-input-type"),i="thumb"===t?function(e){return e?.["data-input-index"]}(e):null;this.inputCreatedFunction(e,t,i)}}_afterTickLineCreate(e){const t=se(e),i=re(e),n=this.tickElements.at(t),o=n.at(i);o?o.tickElement=e:n.add({groupElement:null,tickElement:e,labelElement:null},i)}_afterTickLabelCreate(e){const t=se(e),i=re(e),n=this.tickElements.at(t),o=n.at(i);o?o.labelElement=e:n.add({groupElement:null,labelElement:e,tickElement:null},i)}_afterTickGroupRemoved(e){const t=se(e),i=this.tickElements.items[t],n=i?.find((t=>t.groupElement===e));n&&i.remove(n)}_afterTickGroupCreate(e){const t=ae(e);if(t?.tickCreatedFunction){const i=se(e),n=re(e),o=oe(e),s=this.tickElements?.at(i)?.at(n);if(s){s.groupElement=e;const i=s.tickElement||null,n=s.labelElement||null;t.tickCreatedFunction(o,i,n)}}}_afterMaxLabelCreate(e){this._set("maxLabelElement",e)}_afterMinLabelCreate(e){this._set("minLabelElement",e)}_onAnchorKeyDown(e){if(this._isDisabled||"editing"===this.state)return;const{key:t,target:i}=e,n=this.values,o=ne(i),s=this._anchorElements[o],r=n[o],a=[ee.moveAnchorUp,ee.moveAnchorDown,ee.moveAnchorLeft,ee.moveAnchorRight];if(t===ee.showInput&&this.labelInputsEnabled)this._activeLabelInputIndex=o;else if(a.includes(t)){e.preventDefault();const{steps:i}=this,n=t===ee.moveAnchorUp||t===ee.moveAnchorRight?1:-1;if(null!=i)this._toStep(o,this._isReversedLayout()?-1*n:n);else{const{precision:e}=this,t=this._getPositionOfElement(s),i=this._valueFromPosition(t),r=this._isHorizontalLayout()?n:-1*n;let a;a=0===e?this._positionFromValue(i+r):1===e?this._positionFromValue(i+.1*r):t+r,this._toPosition(o,a)}const a=this.values[o];r!==a&&this._emitThumbChangeEvent({index:o,oldValue:r,value:a})}else if(t===ee.moveAnchorToMax||t===ee.moveAnchorToMin){e.preventDefault();const{min:i,max:n}=this._getAnchorBoundsInPixels(o),s=this._isPositionInverted()?t===ee.moveAnchorToMax?i:n:t===ee.moveAnchorToMin?i:n;this._toPosition(o,s);const a=this.values[o];r!==a&&this._emitThumbChangeEvent({index:o,oldValue:r,value:a})}}_onAnchorPointerDown(e){if(this._isDisabled)return;const{target:t,clientX:i,clientY:n}=e,o=ne(t);null!=o&&(e.preventDefault(),this._anchorElements[o]&&this._anchorElements[o].focus(),this._storeTrackDimensions(),this._dragStartInfo={clientX:i,clientY:n,index:o,position:this._getPositionOfElement(this._anchorElements[o])},document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove))}_onAnchorPointerMove(e){if("editing"===this.state||!this._dragStartInfo)return;e.preventDefault();const{values:t,_anchorElements:i,_dragged:n,_dragStartInfo:o,_dragStartInfo:{index:s,position:r}}=this,{clientX:a,clientY:l}=e,c=n?"drag":"start",d=i[s],u=this._getPositionOfElement(d),h=this._applyPrecisionToPosition(this._isHorizontalLayout()?r+a-o.clientX:r+l-o.clientY);if(u===h)return;const p=t[s];this._dragged=!0,this._toPosition(s,h);const y=this.values[s];n?p!==y&&this._emitThumbDragEvent({index:s,state:c,value:y}):this._emitThumbDragEvent({index:s,state:c,value:p})}_onAnchorPointerUp(e){if(document.removeEventListener("pointerup",this._onAnchorPointerUp),document.removeEventListener("pointermove",this._onAnchorPointerMove),!this._dragStartInfo)return;e.preventDefault();const{index:t}=this._dragStartInfo,i=this._dragged,n=this.values[t];this._dragged=!1,this._dragStartInfo=null,this._lastMovedHandleIndex=t,i?this._emitThumbDragEvent({index:t,state:"stop",value:n}):(this.scheduleRender(),"editing"!==this.state&&this._emitThumbClickEvent({index:t,value:n}))}_onTrackPointerDown(e){const{_dragStartInfo:t,snapOnClickEnabled:i,state:n,values:o}=this;if(this._isDisabled||"editing"===n||t)return;if(document.addEventListener("pointermove",this._onTrackPointerMove),document.addEventListener("pointerup",this._onTrackPointerUp),!i||!o?.length)return;const{steps:s}=this,{clientX:r,clientY:a}=e,l=this._getCursorPositionFromEvent(e),c=this._valueFromPosition(l),d=this._getIndexOfNearestValue(c),u=o[d],h=o.some(((e,t)=>e===u&&t!==d))&&c>u?o.lastIndexOf(u):d;if(null==h)return;const p=o[h],y=null!=s?this._calculateNearestStepPosition(l):l;this._toPosition(h,y),this._dragged=!0,this._dragStartInfo={clientX:r,clientY:a,index:h,position:y},this._focusedAnchorIndex=h,this._emitThumbDragEvent({index:h,state:"start",value:p});const g=this.values[h];p!==g&&this._emitThumbDragEvent({index:h,state:"drag",value:g}),document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove)}_onTrackPointerMove(e){e.preventDefault(),this._dragged=!0}_onTrackPointerUp(e){if(e.preventDefault(),document.removeEventListener("pointermove",this._onTrackPointerMove),document.removeEventListener("pointerup",this._onTrackPointerUp),this.snapOnClickEnabled||(this._dragged=!1),!this._dragged){const t=this._getCursorPositionFromEvent(e),i=this._valueFromPosition(t);this._emitTrackClickEvent({value:i})}}_onSegmentPointerDown(e){e.preventDefault();const t=e.target,i=function(e){return e?.["data-segment-index"]}(t),n=function(e){return e?.["data-min-thumb-index"]}(t),o=function(e){return e?.["data-max-thumb-index"]}(t);if(this._isDisabled||null==n||null==o)return;e.stopPropagation(),this._storeTrackDimensions(),document.addEventListener("pointerup",this._onSegmentPointerUp);const s=this._getAnchorDetails(n),r=this._getAnchorDetails(o);this.syncedSegmentsEnabled?(this.segmentElements.forEach((e=>e.classList.add(N.segmentElementActive))),this._anchorElements.forEach((e=>e.classList.add(N.anchorElementActive)))):(this.segmentElements.at(i).classList.add(N.segmentElementActive),this._anchorElements[s.index]?.classList.add(N.anchorElementActive),this._anchorElements[r.index]?.classList.add(N.anchorElementActive)),this._segmentDragStartInfo={cursorPosition:this._getCursorPositionFromEvent(e),index:i,details:this._normalizeSegmentDetails({min:s,max:r})},this.draggableSegmentsEnabled&&(document.addEventListener("pointermove",this._onSegmentPointerMove),this._emitSegmentDragEvent({index:i,state:"start",thumbIndices:[n,o]}))}_onSegmentPointerMove(e){if(!this._segmentDragStartInfo)return;e.preventDefault();const{_trackHeight:t,_trackWidth:i,_segmentDragStartInfo:{index:n,cursorPosition:o,details:{min:s,max:r}}}=this,{index:a,position:l,value:c}=s,{index:d,position:u,value:h}=r;this._dragged=!0;const p=this._getCursorPositionFromEvent(e);if(p===o)return;const y=this._positionToPercent(o),g=this._positionToPercent(p)-y,m=this._positionToPercent(l)+g,f=this._positionToPercent(u)+g,{min:v}=this._getAnchorBoundsAsPercents(a),{max:b}=this._getAnchorBoundsAsPercents(d);let _=!1,w=!1;if(m<v?_=!0:f>b&&(w=!0),_){const{min:e,max:t}=this.viewModel.getBoundsForValueAtIndex(a),i=this._isPositionInverted()?t:e,n=i,o=h+(i-c),s=o-this.values[d];return void(this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(s):this._updateAnchorValues([a,d],[n,o]))}if(w){const{min:e,max:t}=this.viewModel.getBoundsForValueAtIndex(d),i=this._isPositionInverted()?e:t,n=i,o=c+(i-h),s=o-this.values[a];return void(this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(s):this._updateAnchorValues([a,d],[o,n]))}const C=this._isHorizontalLayout()?i:t,x=f/100*C,S=m/100*C,E=this.values,k=[E[a],E[d]],L=this._getValueForAnchorAtPosition(a,S),T=this._getValueForAnchorAtPosition(d,x);this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(L-k[0]):this._updateAnchorValues([a,d],[L,T]),[this.values[a],this.values[d]].every(((e,t)=>e===k[t]))||this._emitSegmentDragEvent({index:n,state:"drag",thumbIndices:[a,d]})}_onSegmentPointerUp(e){if(e.preventDefault(),document.removeEventListener("pointerup",this._onSegmentPointerUp),document.removeEventListener("pointermove",this._onSegmentPointerMove),!this._segmentDragStartInfo)return;const{_dragged:t}=this,i=this.min,n=this.max,o=this.values,{index:s,details:{min:{index:r},max:{index:a}}}=this._segmentDragStartInfo;if(this.segmentElements.forEach((e=>e.classList.remove(N.segmentElementActive))),this._anchorElements.forEach((e=>e.classList.remove(N.anchorElementActive))),this.draggableSegmentsEnabled){const e=n-i,t=o[r],l=o[a];this._lastMovedHandleIndex=t===l?t>e/2?r:a:null,this._dragged=!1,this._segmentDragStartInfo=null,this._emitSegmentDragEvent({index:s,state:"stop",thumbIndices:[r,a]})}if(!t){const t=this._getCursorPositionFromEvent(e),i=this._valueFromPosition(t);this._emitSegmentClickEvent({index:s,value:i,thumbIndices:[r,a]})}}_onTickGroupClick(e){const t=e.target;if(ae(t)){const e=se(t),i=re(t),n=oe(t);this._emitTickClickEvent({configIndex:e,groupIndex:i,value:n})}}_storeTrackDimensions(){if(this.trackElement){const e=this._getDimensions(this.trackElement);this._trackHeight=this._applyPrecisionToPosition(e.height),this._trackWidth=this._applyPrecisionToPosition(e.width)}}_onLabelPointerDown(){this._isDisabled||(this._dragged=!1,document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove))}_onLabelPointerMove(){this._isDisabled||(this._dragged=!0)}_onLabelPointerUp(e){if(this._isDisabled)return;const t=ne(e.target);this.labelInputsEnabled&&!this._dragged&&null!=t&&(this._activeLabelInputIndex=t),this._dragged=!1,document.removeEventListener("pointerup",this._onLabelPointerUp),document.removeEventListener("pointermove",this._onLabelPointerMove)}_onLabelInputBlur(e){const{_activeLabelInputIndex:t,values:i,viewModel:n}=this,o=e.target.value;if(this._activeLabelInputIndex=null,!o||null==t||null==i)return;const s=this._parseInputValue(o,"value",t),r=i[t],{min:a,max:l}=this.viewModel.getBoundsForValueAtIndex(t);if(s<a||s>l)return;n.setValue(t,s);const c=this.values[t];r!==c&&this._emitThumbChangeEvent({index:t,oldValue:r,value:c})}_onInputKeyDown(e){if(this._isDisabled)return;const{key:t,target:i}=e,{hideInput1:n,hideInput2:o,hideInput3:s}=ee,{_activeLabelInputIndex:r,_anchorElements:a}=this,l=i;if(t===n||t===o||t===s){e.stopPropagation();const t=r;l.blur(),null!=t?a[t].focus():l.parentElement?.focus()}}_onMaxLabelClick(){this._isDisabled||(this._emitMaxRangeLabelClickEvent({type:"max-click",value:this.max}),this.rangeLabelInputsEnabled&&(this._isMaxInputActive=!0))}_onMaxLabelKeyDown({key:e}){this._isDisabled||e!==ee.showInput||(this._isMaxInputActive=!0)}_onMaxInputBlur(e){const t=e.target.value;if(this._isMaxInputActive=!1,!t)return;const i=this.max,n=this._parseInputValue(t,"max");n<=this.min||(this.viewModel.set("max",n),this.max!==i&&this._emitMaxChangeEvent({oldValue:i,value:this.max}))}_onMinLabelClick(){this._isDisabled||(this._emitMinRangeLabelClickEvent({type:"min-click",value:this.min}),this.rangeLabelInputsEnabled&&(this._isMinInputActive=!0))}_onMinLabelKeyDown({key:e}){this._isDisabled||e!==ee.showInput||(this._isMinInputActive=!0)}_onMinInputBlur(e){const t=e.target.value;if(this._isMinInputActive=!1,!t)return;const i=this.min,n=this._parseInputValue(t,"min");n>=this.max||(this.viewModel.set("min",n),this.min!==i&&this._emitMinChangeEvent({oldValue:i,value:this.min}))}_positionFromValue(e){const{_trackHeight:t,_trackWidth:i}=this,n=this.min??0,o=this.max??0,s=o-n;if(0===s||null==e)return 0;const r=this._isHorizontalLayout();let a=r?this._applyPrecisionToPosition(i*(e-n)/s):this._applyPrecisionToPosition(t*(o-e)/s);return this._isReversedLayout()&&(a=r?i-a:t-a),a}_valueFromPosition(e){const{_trackHeight:t,_trackWidth:i,precision:n}=this,o=this.min??0,s=this.max??0,r=s-o;let a=this._isHorizontalLayout()?e*r/i+o:r*(1e3-e/t*1e3)/1e3+o;return this._isReversedLayout()&&(a=s+o-a),parseFloat(a.toFixed(n))}_positionToPercent(e){const{_trackHeight:t,_trackWidth:i}=this,n=100*e/(this._isHorizontalLayout()?i:t);return this._applyPrecisionToPosition(n)}_applyPrecisionToPosition(e){return parseFloat(e.toFixed(this._positionPrecision))}_isPositionInverted(){const{layout:e}=this;return"horizontal-reversed"===e||"vertical"===e}_isHorizontalLayout(){return this.layout.includes("horizontal")}_isReversedLayout(){return this.layout.includes("reversed")}_normalizeSegmentDetails(e){if(this._isPositionInverted()){const{min:t,max:i}=e;return{min:i,max:t}}return e}_parseInputValue(e,t,i){return this.inputParseFunction?this.inputParseFunction(e,t,i):this.viewModel.defaultInputParseFunction(e)}_formatInputValue(e,t,i){return this.inputFormatFunction?this.inputFormatFunction(e,t,i):this.viewModel.defaultInputFormatFunction(e)}_getAnchorDetails(e){const t=this.values,i=[...t].sort(((e,t)=>e-t))[e],n=t.indexOf(i);return{index:n,position:this._getPositionOfElement(this._anchorElements[n]),value:i}}_updateAnchorStyle(e,t){const i=this._anchorElements[e];i&&(this._isHorizontalLayout()?i.style.left=`${t}`:i.style.top=`${t}`)}_getStyleForAnchor(e,t,i){const n=this._getPositionStyleForElement(e);if(1===this.values?.length)return`${n}`;const o=this._zIndices[t];return`${n}; z-index: ${i?this._zIndexOffset+o:o}`}_getPositionStyleForElement(e){const t=this._positionFromValue(e),i=this._positionToPercent(t);return`${this._isHorizontalLayout()?"left":"top"}: ${i}%`}_getPositionOfElement(e){const t=this._getDimensions(e.offsetParent),i=this._getDimensions(e);return this._isHorizontalLayout()?this._applyPrecisionToPosition(i.left-t.left):this._applyPrecisionToPosition(i.top-t.top)}_updateAnchorValues(e,t){e.forEach(((e,i)=>this._toValue(e,t[i])))}_updateAnchorValuesByDifference(e){const{min:t,max:i,values:n}=this;n?.forEach(((n,o)=>this._toValue(o,Math.max(Math.min(n+e,i),t))))}_toValue(e,t){null!=this.steps&&(t=this._getStepValues()[this._getIndexOfNearestStepValue(t)]),this._updateAnchorStyle(e,this._getPositionStyleForElement(t)),this.viewModel.setValue(e,t)}_toPosition(e,t){const i=null!=this.steps?this._getStepValueForAnchorAtPosition(e,t):this._getValueForAnchorAtPosition(e,t);this._updateAnchorStyle(e,this._getPositionStyleForElement(i)),this.viewModel.setValue(e,i)}_getValueForAnchorAtPosition(e,t){const{min:i,max:n}=this._getAnchorBoundsInPixels(e),{min:o,max:s}=this.viewModel.getBoundsForValueAtIndex(e);let r,a,l=null;return this._isPositionInverted()?(r=o,a=s):(r=s,a=o),l=t>n?r:t<i?a:this._valueFromPosition(t),l>s?l=s:l<o&&(l=o),l}_getStepValueForAnchorAtPosition(e,t){const i=this._getStepValues(),n=this._calculateNearestStepPosition(t),o=this._getValueForAnchorAtPosition(e,n);return i[this._getIndexOfNearestStepValue(o)]}_getAnchorBoundsAsPercents(e){const{min:t,max:i}=this._getAnchorBoundsInPixels(e);return{min:this._positionToPercent(t),max:this._positionToPercent(i)}}_getAnchorBoundsInPixels(e){const{_anchorElements:t,_trackHeight:i,_trackWidth:n,effectiveMax:o,effectiveMin:s,thumbsConstrained:r}=this,a=t[e-1],l=t[e+1],c=this._isHorizontalLayout()?n:i;let d,u;return this._isPositionInverted()?(d=null!=s?this._positionFromValue(s):c,u=null!=o?this._positionFromValue(o):0):(d=null!=o?this._positionFromValue(o):c,u=null!=s?this._positionFromValue(s):0),r?this._isPositionInverted()?{max:a?this._getPositionOfElement(a):d,min:l?this._getPositionOfElement(l):u}:{max:l?this._getPositionOfElement(l):d,min:a?this._getPositionOfElement(a):u}:{max:d,min:u}}_getIndexOfNearestValue(e){const t=this.values;return t.indexOf(t.reduce(((t,i)=>Math.abs(i-e)<Math.abs(t-e)?i:t)))}_getCursorPositionFromEvent(e){const t=this._getDimensions(this.trackElement);return this._isHorizontalLayout()?this._applyPrecisionToPosition(e.clientX-t.left):this._applyPrecisionToPosition(e.clientY-t.top)}_getStepValues(){const{steps:e}=this;if(Array.isArray(e))return e;const{max:t,min:i}=this;if(null==i||null==t||null==e)return[];const n=Math.ceil((t-i)/e),o=[];for(let s=0;s<=n;s++){const n=i+e*s;o.push(n>t?t:n)}return o}_toStep(e,t){const i=this.values[e],n=this._getStepValues(),o=n.indexOf(i);let s=null;if(o>-1){let i=n[o+t];isNaN(i)&&(i=n[o]);const r=this._positionFromValue(i);s=this._getStepValueForAnchorAtPosition(e,r)}else s=n[this._getIndexOfNearestStepValue(i)+t];this.viewModel.setValue(e,s)}_getIndexOfNearestStepValue(e){const{steps:t}=this;if(null==t)return null;const i=this._getStepValues(),n=i.reduce(((t,i)=>Math.abs(i-e)<Math.abs(t-e)?i:t));return i.indexOf(n)}_calculateNearestStepPosition(e){const t=this._valueFromPosition(e),i=this._getIndexOfNearestStepValue(t),n=this._getStepValues();return this._positionFromValue(n[i])}_getTickCounts(e,t){const{mode:i}=t;return"count"===i||"position"===i?e||0:"percent"===i&&100/e||0}_calculateTickPositions(e){return e.map((e=>this._positionFromValue(e)))}_calculateEquidistantTickPositions(e){const{_trackWidth:t,_trackHeight:i}=this,n=this._isHorizontalLayout()?t:i,o=n/(e-1),s=[];if(1===e)return[n/2];for(let t=0;t<e;t++){const e=t*o;e<=n&&s.push(e)}return s}_getDimensions(e){try{return(0,v.O3)(e),e.getBoundingClientRect()}catch(e){if("object"==typeof e&&null!==e)return new DOMRect(0,0,0,0);throw e}}_emitTrackClickEvent(e){this.emit("track-click",{...e,type:"track-click"})}_emitTickClickEvent(e){this.emit("tick-click",{...e,type:"tick-click"})}_emitMaxChangeEvent(e){this.emit("max-change",{...e,type:"max-change"})}_emitMinChangeEvent(e){this.emit("min-change",{...e,type:"min-change"})}_emitThumbChangeEvent(e){this.emit("thumb-change",{...e,type:"thumb-change"})}_emitThumbClickEvent(e){this.emit("thumb-click",{...e,type:"thumb-click"})}_emitThumbDragEvent(e){this.emit("thumb-drag",{...e,type:"thumb-drag"})}_emitSegmentClickEvent(e){this.emit("segment-click",{...e,type:"segment-click"})}_emitSegmentDragEvent(e){this.emit("segment-drag",{...e,type:"segment-drag"})}_emitMinRangeLabelClickEvent(e){this.emit("min-click",e)}_emitMaxRangeLabelClickEvent(e){this.emit("min-click",e)}};function ne(e){return e?.["data-thumb-index"]}function oe(e){return e?.["data-value"]}function se(e){return e?.["data-tick-config-index"]}function re(e){return e?.["data-tick-group-index"]}function ae(e){return e?.["data-config"]}(0,o._)([(0,a.Cb)()],ie.prototype,"_activeLabelInputIndex",void 0),(0,o._)([(0,a.Cb)()],ie.prototype,"_dragStartInfo",void 0),(0,o._)([(0,a.Cb)()],ie.prototype,"_isMinInputActive",void 0),(0,o._)([(0,a.Cb)()],ie.prototype,"_isMaxInputActive",void 0),(0,o._)([(0,a.Cb)()],ie.prototype,"_segmentDragStartInfo",void 0),(0,o._)([(0,a.Cb)({readOnly:!0})],ie.prototype,"_isDisabled",null),(0,o._)([(0,a.Cb)()],ie.prototype,"disabled",void 0),(0,o._)([(0,a.Cb)()],ie.prototype,"draggableSegmentsEnabled",void 0),(0,o._)([(0,a.Cb)()],ie.prototype,"effectiveMax",null),(0,o._)([(0,a.Cb)()],ie.prototype,"effectiveMin",null),(0,o._)([(0,a.Cb)({readOnly:!0})],ie.prototype,"effectiveSegmentElements",void 0),(0,o._)([(0,a.Cb)()],ie.prototype,"extraNodes",void 0),(0,o._)([(0,a.Cb)()],ie.prototype,"inputCreatedFunction",void 0),(0,o._)([(0,a.Cb)()],ie.prototype,"inputFormatFunction",null),(0,o._)([(0,a.Cb)()],ie.prototype,"inputParseFunction",null),(0,o._)([(0,a.Cb)()],ie.prototype,"icon",null),(0,o._)([(0,a.Cb)()],ie.prototype,"label",null),(0,o._)([(0,a.Cb)({readOnly:!0})],ie.prototype,"labelElements",void 0),(0,o._)([(0,a.Cb)()],ie.prototype,"labelInputsEnabled",void 0),(0,o._)([(0,a.Cb)()],ie.prototype,"labelFormatFunction",null),(0,o._)([(0,a.Cb)({readOnly:!0})],ie.prototype,"labels",null),(0,o._)([(0,a.Cb)({value:"horizontal"})],ie.prototype,"layout",null),(0,o._)([(0,a.Cb)()],ie.prototype,"max",null),(0,o._)([(0,a.Cb)({readOnly:!0})],ie.prototype,"maxLabelElement",void 0),(0,o._)([(0,a.Cb)(),(0,X.H)("esri/widgets/Slider/t9n/Slider")],ie.prototype,"messages",void 0),(0,o._)([(0,a.Cb)()],ie.prototype,"min",null),(0,o._)([(0,a.Cb)({readOnly:!0})],ie.prototype,"minLabelElement",void 0),(0,o._)([(0,a.Cb)()],ie.prototype,"precision",null),(0,o._)([(0,a.Cb)()],ie.prototype,"rangeLabelInputsEnabled",void 0),(0,o._)([(0,a.Cb)({readOnly:!0})],ie.prototype,"segmentElements",void 0),(0,o._)([(0,a.Cb)()],ie.prototype,"snapOnClickEnabled",void 0),(0,o._)([(0,a.Cb)({readOnly:!0})],ie.prototype,"state",null),(0,o._)([(0,a.Cb)()],ie.prototype,"steps",void 0),(0,o._)([(0,a.Cb)()],ie.prototype,"syncedSegmentsEnabled",void 0),(0,o._)([(0,a.Cb)()],ie.prototype,"thumbsConstrained",null),(0,o._)([(0,a.Cb)()],ie.prototype,"thumbCreatedFunction",void 0),(0,o._)([(0,a.Cb)({readOnly:!0})],ie.prototype,"thumbElements",void 0),(0,o._)([(0,a.Cb)()],ie.prototype,"tickConfigs",null),(0,o._)([(0,a.Cb)({readOnly:!0})],ie.prototype,"tickElements",void 0),(0,o._)([(0,a.Cb)({readOnly:!0})],ie.prototype,"trackElement",void 0),(0,o._)([(0,a.Cb)()],ie.prototype,"values",null),(0,o._)([(0,a.Cb)({type:P})],ie.prototype,"viewModel",void 0),(0,o._)([(0,a.Cb)()],ie.prototype,"visibleElements",void 0),(0,o._)([(0,Y.p)("visibleElements")],ie.prototype,"castVisibleElements",null),ie=(0,o._)([(0,l.j)("esri.widgets.Slider")],ie);const le=ie;var ce=i(84644);const de="esri-timezone-picker",ue={base:de,trigger:`${de}__trigger`,itemTitle:`${de}__item-title`,itemDescription:`${de}__item_description`};let he=class extends d.Z{constructor(e,t){super(e,t),this.disabled=!1,this.value=null,this.onChange=null,this.open=!1,this.onOpen=null,this.onClose=null,this._selectedId=null,this._onOpen=()=>{this.open=!0,this.onOpen?.()},this._onClose=()=>{this.open=!1,this.onClose?.()},this._killEvent=e=>(e.stopPropagation(),!0),this._onChange=e=>{const t=e.target.selectedItems?.[0].getAttribute("data-id"),i=pe(this._gmtOffsets,t)?.utcOffset;null!=i&&(this._selectedId=t,this.onChange?.(i))}}loadDependencies(){return(0,ce.h)({button:()=>Promise.resolve().then(i.bind(i,61637)),dropdown:()=>Promise.all([i.e(62737),i.e(7608)]).then(i.bind(i,54027)),"dropdown-group":()=>i.e(66280).then(i.bind(i,64367)),"dropdown-item":()=>i.e(2729).then(i.bind(i,97325))})}render(){const e=this._messages;if(!e)return(0,J.u)("div",{class:ue.base,key:"empty"});const t=this._selectedItem,i=ye(t);return(0,J.u)("div",{class:ue.base,key:"container",onpointerdown:this._killEvent},(0,J.u)("calcite-dropdown",{disabled:this.disabled,open:this.open,overlayPositioning:"fixed",placement:"bottom-end",scale:"s",onCalciteDropdownClose:this._onClose,onCalciteDropdownOpen:this._onOpen,onCalciteDropdownSelect:this._onChange},(0,J.u)("calcite-button",{appearance:"transparent",class:ue.trigger,"data-testid":"timezone-picker-button",disabled:this.disabled,key:"trigger",kind:"neutral",scale:"s",slot:"trigger",title:e.chooseTimezone},t?.short??""),(0,J.u)("calcite-dropdown-group",{selectionMode:"single"},this._gmtOffsets.map((e=>{const t=ye(e);return(0,J.u)("calcite-dropdown-item",{"data-id":t,"data-testid":t,key:t,selected:i===t},(0,J.u)("div",{class:ue.itemTitle,key:"title"},e.shortWithUTC),(0,J.u)("div",{class:ue.itemDescription,key:"description"},e.long))})))))}get _gmtOffsets(){const e=this._messages;return e?function(e){return[{utcOffset:-12,short:"UTC-12",long:e.timezoneDateline},{utcOffset:-11,short:"UTC-11",long:e.timezoneSamoa},{utcOffset:-10,short:e.timezoneHAST,long:e.timezoneHawaii},{utcOffset:-9,short:e.timezoneAKST,long:e.timezoneAlaska},{utcOffset:-8,short:e.timezonePST,long:e.timezoneBaja},{utcOffset:-7,short:e.timezoneMST,long:e.timezoneMountain},{utcOffset:-7,short:e.timezoneMST,long:e.timezoneLaPaz},{utcOffset:-7,short:e.timezoneMST,long:e.timezoneArizona},{utcOffset:-6,short:e.timezoneCST,long:e.timezoneSaskatchewan},{utcOffset:-6,short:e.timezoneCST,long:e.timezoneCentralAmerica},{utcOffset:-6,short:e.timezoneCST,long:e.timezoneCentralTime},{utcOffset:-6,short:e.timezoneCST,long:e.timezoneMexico},{utcOffset:-5,short:e.timezoneEST,long:e.timezoneEasternUS},{utcOffset:-5,short:e.timezoneEST,long:e.timezoneLima},{utcOffset:-5,short:e.timezoneEST,long:e.timezoneIndiana},{utcOffset:-4,short:null,long:e.timezoneAtlantic},{utcOffset:-4,short:null,long:e.timezoneCuiaba},{utcOffset:-4,short:null,long:e.timezoneSantiago},{utcOffset:-4,short:null,long:e.timezoneManaus},{utcOffset:-4,short:null,long:e.timezoneAsuncion},{utcOffset:-3,short:null,long:e.timezoneBrasilia},{utcOffset:-3,short:null,long:e.timezoneGreenland},{utcOffset:-3,short:null,long:e.timezoneMontevideo},{utcOffset:-3,short:null,long:e.timezoneCayenne},{utcOffset:-3,short:null,long:e.timezoneBuenosAires},{utcOffset:-2,short:null,long:e.timezoneMidAtlantic},{utcOffset:-1,short:null,long:e.timezoneAzores},{utcOffset:-1,short:null,long:e.timezoneCaboVerde},{utcOffset:0,short:null,long:e.timezoneDublin},{utcOffset:0,short:null,long:e.timezoneReykjavik},{utcOffset:0,short:null,long:e.timezoneCasablanca},{utcOffset:1,short:e.timezoneCET,long:e.timezoneBelgrade},{utcOffset:1,short:e.timezoneCET,long:e.timezoneSarajevo},{utcOffset:1,short:e.timezoneCET,long:e.timezoneBrussels},{utcOffset:1,short:e.timezoneCET,long:e.timezoneWCAfrica},{utcOffset:1,short:e.timezoneCET,long:e.timezoneAmsterdam},{utcOffset:1,short:e.timezoneCET,long:e.timezoneWindhoek},{utcOffset:2,short:e.timezoneEET,long:e.timezoneMinsk},{utcOffset:2,short:e.timezoneEET,long:e.timezoneCairo},{utcOffset:2,short:e.timezoneEET,long:e.timezoneHelsinki},{utcOffset:2,short:e.timezoneEET,long:e.timezoneAthens},{utcOffset:2,short:e.timezoneEET,long:e.timezoneJerusalem},{utcOffset:2,short:e.timezoneEET,long:e.timezoneAmman},{utcOffset:2,short:e.timezoneEET,long:e.timezoneBeirut},{utcOffset:2,short:e.timezoneEET,long:e.timezoneHarare},{utcOffset:2,short:e.timezoneEET,long:e.timezoneDamascus},{utcOffset:2,short:e.timezoneEET,long:e.timezoneIstanbul},{utcOffset:3,short:e.timezoneMSK,long:e.timezoneKuwait},{utcOffset:3,short:e.timezoneMSK,long:e.timezoneBaghdad},{utcOffset:3,short:e.timezoneMSK,long:e.timezoneNairobi},{utcOffset:3,short:e.timezoneMSK,long:e.timezoneKaliningrad},{utcOffset:4,short:e.timezoneGST,long:e.timezoneMoscow},{utcOffset:4,short:e.timezoneGST,long:e.timezoneMuscat},{utcOffset:4,short:e.timezoneGST,long:e.timezoneBaku},{utcOffset:4,short:e.timezoneGST,long:e.timezoneYerevan},{utcOffset:4,short:e.timezoneGST,long:e.timezoneTbilisi},{utcOffset:4,short:e.timezoneGST,long:e.timezonePortLouis},{utcOffset:5,short:null,long:e.timezoneTashkent},{utcOffset:5,short:null,long:e.timezoneIslamabad},{utcOffset:6,short:null,long:e.timezoneEkaterinburg},{utcOffset:6,short:null,long:e.timezoneAstana},{utcOffset:6,short:null,long:e.timezoneDhaka},{utcOffset:7,short:e.timezoneICT,long:e.timezoneNovosibirsk},{utcOffset:7,short:e.timezoneICT,long:e.timezoneBangkok},{utcOffset:8,short:e.timezoneCCT,long:e.timezoneKrasnoyarsk},{utcOffset:8,short:e.timezoneCCT,long:e.timezoneBeijing},{utcOffset:8,short:e.timezoneCCT,long:e.timezoneSingapore},{utcOffset:8,short:e.timezoneCCT,long:e.timezoneTaipei},{utcOffset:8,short:e.timezoneCCT,long:e.timezonePerth},{utcOffset:8,short:e.timezoneCCT,long:e.timezoneUlaanbaatar},{utcOffset:9,short:e.timezoneJST,long:e.timezoneIrkutsk},{utcOffset:9,short:e.timezoneJST,long:e.timezoneSeoul},{utcOffset:9,short:e.timezoneJST,long:e.timezoneOsaka},{utcOffset:10,short:e.timezoneAEST,long:e.timezoneYakutsk},{utcOffset:10,short:e.timezoneAEST,long:e.timezoneCanberra},{utcOffset:10,short:e.timezoneAEST,long:e.timezoneBrisbane},{utcOffset:10,short:e.timezoneAEST,long:e.timezoneHobart},{utcOffset:10,short:e.timezoneAEST,long:e.timezoneGuam},{utcOffset:11,short:null,long:e.timezoneVladivostok},{utcOffset:11,short:null,long:e.timezoneSolomon},{utcOffset:12,short:e.timezoneNZST,long:e.timezoneMagadan},{utcOffset:12,short:e.timezoneNZST,long:e.timezoneFiji},{utcOffset:12,short:e.timezoneNZST,long:e.timezoneAuckland},{utcOffset:12,short:e.timezoneNZST,long:e.timezoneNukualofa}].map((({utcOffset:e,short:t,long:i})=>{const n=e>0?`UTC+${e}`:e<0?`UTC${e}`:"GMT";return t?{utcOffset:e,short:t,shortWithUTC:`${n} (${t})`,long:i}:{utcOffset:e,short:n,shortWithUTC:n,long:i}}))}(e):[]}get _selectedItem(){const e=this._gmtOffsets,t=this.value,i=pe(e,this._selectedId);return i?.utcOffset===t?i:function(e,t){return e.find((e=>e.utcOffset===t))}(e,t)}};function pe(e,t){return e.find((e=>ye(e)===t))}function ye(e){return e?`${e.utcOffset}-${e.long}`:void 0}(0,o._)([(0,a.Cb)()],he.prototype,"disabled",void 0),(0,o._)([(0,a.Cb)()],he.prototype,"value",void 0),(0,o._)([(0,a.Cb)()],he.prototype,"onChange",void 0),(0,o._)([(0,a.Cb)()],he.prototype,"open",void 0),(0,o._)([(0,a.Cb)()],he.prototype,"onOpen",void 0),(0,o._)([(0,a.Cb)()],he.prototype,"onClose",void 0),(0,o._)([(0,a.Cb)(),(0,X.H)("esri/widgets/support/t9n/timezone")],he.prototype,"_messages",void 0),(0,o._)([(0,a.Cb)()],he.prototype,"_gmtOffsets",null),(0,o._)([(0,a.Cb)()],he.prototype,"_selectedItem",null),(0,o._)([(0,a.Cb)()],he.prototype,"_selectedId",void 0),he=(0,o._)([(0,l.j)("esri.widgets.support.TimezonePicker")],he);const ge="esri-slider-with-dropdown",me="esri-slider__label",fe=`${ge}__box`,ve=`${ge}__box--drop-down-on`,be=`${ge}__box--drop-down-off`;let _e=class extends le{constructor(e,t){super(e,t),this.viewModel=new A,this.showDropDown=!0,this._labelWidth=0,this._onLabelAfterCreate=e=>{const t="label-size-observer";this.removeHandles(t),this.addHandles((0,q.ib)(e,(({contentRect:e})=>{this._labelWidth=e.width})),t)},this._getLabelStyles=()=>{if(!this.trackElement)return;const e=this._trackWidth,t=this._labelWidth/2,i=this.getCurrentPosition(),n=i-t,o=i+t;let s=-t;return n<0?s+=-n:o>e&&(s+=e-o),{left:`${s}px`}},this._onTimezoneChange=e=>{this.viewModel.utcOffset=e},this._onTimezonePickerOpen=()=>{this.viewModel.timezonePickerOpen=!0},this._onTimezonePickerClose=()=>{this.viewModel.timezonePickerOpen=!1}}renderThumbLabel(e){const{showDropDown:t,viewModel:i}=this;return(0,J.u)("div",{afterCreate:this._onLabelAfterCreate,class:this.classes({[fe]:!0,[me]:!0,[ve]:t,[be]:!t}),key:"thumb-label",styles:this._getLabelStyles()},super.renderThumbLabel(e),t?(0,J.u)(he,{disabled:this.disabled,open:i.timezonePickerOpen,value:i.utcOffset,onChange:this._onTimezoneChange,onClose:this._onTimezonePickerClose,onOpen:this._onTimezonePickerOpen}):null)}};(0,o._)([(0,a.Cb)()],_e.prototype,"viewModel",void 0),(0,o._)([(0,a.Cb)()],_e.prototype,"showDropDown",void 0),(0,o._)([(0,a.Cb)()],_e.prototype,"_labelWidth",void 0),_e=(0,o._)([(0,l.j)("esri.widgets.Daylight.support.SliderWithDropdown")],_e);const we=_e;var Ce=i(79691),xe=i(29629);const Se="date";let Ee=class extends d.Z{constructor(e,t){super(e,t),this.headingLevel=3,this.viewModel=new G,this.visibleElements=new K,this.dateOrSeason=Se,this._timeSlider=new we({viewModel:this.viewModel.timeSliderViewModel,steps:this.timeSliderSteps,labelInputsEnabled:!1,visibleElements:{labels:!0},tickConfigs:[{mode:"position",values:[0,360,720,1080,1439],labelsVisible:!0,tickCreatedFunction:(e,t,i)=>function({tickElement:e,labelElement:t,tickClasses:i=[],onClick:n}){e&&t&&(e.classList.add(...i,F.z.primaryTick),t.classList.add(...i,F.z.primaryTickLabel),B(t),n&&(t.onclick=e.onclick=()=>n()))}({tickElement:t,labelElement:i,tickClasses:ke,onClick:this._makeGoToTime(e)})},{mode:"position",values:[120,240,480,600,840,960,1200,1320],tickCreatedFunction:(e,t)=>function({tickElement:e,tickClasses:t=[],onClick:i}){e&&(e.classList.add(...t,F.z.secondaryTick),i&&(e.onclick=()=>i()))}({tickElement:t,tickClasses:ke,onClick:this._makeGoToTime(e)})}]}),this._onPlayDayClick=()=>{this.viewModel.toggleDayPlaying()},this._onDateChange=e=>{const t=e.currentTarget.valueAsDate;this.viewModel.onDateChange(Array.isArray(t)?t[0]:t)},this._onYearPlayClick=()=>{this.viewModel.toggleYearPlaying()},this._onSeasonChange=e=>{this.viewModel.currentSeason=e.currentTarget.value},this._onSunLightingCheckboxChange=()=>{this.viewModel.toggleSunLightingEnabled()},this._onShadowCheckboxChange=()=>{this.viewModel.toggleDirectShadowsEnabled()}}get icon(){return"brightness"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.title??""}set label(e){this._overrideIfSome("label",e)}get playSpeedMultiplier(){return this.viewModel.playSpeedMultiplier}set playSpeedMultiplier(e){this.viewModel.playSpeedMultiplier=e}get timeSliderSteps(){return this._timeSlider?.steps??5}set timeSliderSteps(e){this._timeSlider.steps=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}postInitialize(){this.viewModel.isSupported&&(this.addHandles([(0,r.YP)((()=>this.viewModel.timeSliderViewModel),(e=>this._timeSlider.viewModel=e),r.tX),(0,r.YP)((()=>this.visibleElements?.timezone),(e=>this._timeSlider.showDropDown=e),r.tX),(0,r.YP)((()=>!this.viewModel.sunLightingEnabled),(e=>{this._timeSlider.disabled=e}),r.tX),(0,c.qe)((()=>this._adjustTimeSliderPadding()))]),this._adjustTimeSliderPadding())}destroy(){this._timeSlider.destroy()}render(){const{messages:e,viewModel:t,visibleElements:i}=this,n=t.isSupported;return(0,J.u)("div",{class:this.classes(y.base,F.z.widget)},n?(0,J.u)(J.D,null,i.header?(0,J.u)(Ce.X,{level:this.headingLevel},e.title):null,this._renderTimeOptions(),i.datePicker?this._renderDateOrSeason():null,i.sunLightingToggle?this._renderSunLightingToggle():null,i.shadowsToggle?this._renderShadowsToggle():null):(0,J.u)("div",{class:y.panelError,key:"unsupported"},(0,J.u)("p",null,e.unsupported)))}loadDependencies(){return(0,ce.h)({button:()=>Promise.resolve().then(i.bind(i,61637)),checkbox:()=>Promise.resolve().then(i.bind(i,69397)),label:()=>Promise.resolve().then(i.bind(i,36650)),"input-date-picker":()=>Promise.all([i.e(62737),i.e(32029),i.e(63243),i.e(39556)]).then(i.bind(i,29628)),option:()=>i.e(26344).then(i.bind(i,26344)),select:()=>i.e(44015).then(i.bind(i,44015))})}_adjustTimeSliderPadding(){!function(e){if(!e)return;const t=(0,c.v2)(),i=t?.language??"",n=t?.region??"";e.querySelectorAll(`.${N.tickLabelElement}`).forEach((e=>{B(e)}));const o=["ar","bg","el","en","ko"].includes(i)||"zh"===i&&["HK","TW"].includes(n);e.style.paddingBlockEnd=o?"42px":"28px"}(this.domNode?.querySelector(`.${N.base}`))}_renderTimeOptions(){const{viewModel:e,visibleElements:t,messages:i}=this,{dayPlaying:n}=e,o=!e.sunLightingEnabled;return(0,J.u)("div",{class:this.classes(y.dayContainer,{[y.sliderDateOn]:t.datePicker,[y.sliderDateOff]:!t.datePicker,[y.sliderAmPmOn]:(0,R.Sh)(z).formatToParts(U(0,"value")).some((({type:e})=>"dayPeriod"===e)),[y.containerDisabled]:o}),key:"daylight-time-options"},this._timeSlider.render(),t.playButtons?this._renderPlayPauseButton({playing:n,disabled:o,label:i.playDay,onClick:this._onPlayDayClick}):null)}_renderDateOptions(){const{viewModel:e,visibleElements:t,messages:i}=this,{yearPlaying:n}=e,o=!e.sunLightingEnabled;return(0,J.u)("div",{class:this.classes(y.dateContainer,o&&y.containerDisabled),key:y.dateContainer},(0,J.u)("calcite-input-date-picker",{class:y.datePicker,"data-testid":"daylight-date-picker",disabled:o,key:y.datePicker,overlayPositioning:"fixed",placement:"bottom",valueAsDate:e.localDate,onCalciteInputDatePickerChange:this._onDateChange}),t.playButtons?this._renderPlayPauseButton({playing:n,disabled:o,label:i.playYear,onClick:this._onYearPlayClick}):null)}_renderPlayPauseButton({playing:e,disabled:t,label:i,onClick:n}){return(0,J.u)("calcite-button",{appearance:"solid",class:y.playPauseButton,disabled:t,iconStart:e?"pause-f":"play-f",label:i,onclick:n,round:!0,title:i,type:"button"})}_renderSeasonSelect(){const{messages:e,viewModel:t}=this,i=!t.sunLightingEnabled;return(0,J.u)("calcite-select",{class:this.classes(y.seasonPicker),disabled:i,label:e.season,onCalciteSelectChange:this._onSeasonChange},E.map((i=>(0,J.u)("calcite-option",{selected:t.currentSeason===i,value:i},e[i]))))}_renderDateOrSeason(){return"date"===this.dateOrSeason?this._renderDateOptions():this._renderSeasonSelect()}_renderSunLightingToggle(){const e=this.messages?.sunLightingToggle;return(0,J.u)("calcite-label",{key:"date-time-toggle",layout:"inline",scale:"s",title:e?.tooltip},(0,J.u)("calcite-checkbox",{checked:this.viewModel.sunLightingEnabled,class:y.sunLightingCheckbox,onCalciteCheckboxChange:this._onSunLightingCheckboxChange}),e?.label)}_renderShadowsToggle(){const e=this.messages.shadowsToggle;return(0,J.u)("calcite-label",{key:"shadow-toggle",layout:"inline",scale:"s",title:e?.tooltip},(0,J.u)("calcite-checkbox",{checked:this.viewModel.directShadowsEnabled,class:y.shadowsCheckbox,onCalciteCheckboxChange:this._onShadowCheckboxChange}),e.label)}_makeGoToTime(e){return()=>{this.viewModel.timeSliderPosition=e}}};(0,o._)([(0,a.Cb)(),(0,X.H)("esri/widgets/Daylight/t9n/Daylight")],Ee.prototype,"messages",void 0),(0,o._)([(0,a.Cb)(),(0,X.H)("esri/widgets/support/t9n/timezone")],Ee.prototype,"timezoneMessages",void 0),(0,o._)([(0,a.Cb)()],Ee.prototype,"headingLevel",void 0),(0,o._)([(0,a.Cb)()],Ee.prototype,"icon",null),(0,o._)([(0,a.Cb)()],Ee.prototype,"label",null),(0,o._)([(0,a.Cb)()],Ee.prototype,"playSpeedMultiplier",null),(0,o._)([(0,a.Cb)()],Ee.prototype,"timeSliderSteps",null),(0,o._)([(0,a.Cb)()],Ee.prototype,"view",null),(0,o._)([(0,xe.s)("user-date-time-change"),(0,a.Cb)({type:G})],Ee.prototype,"viewModel",void 0),(0,o._)([(0,a.Cb)({type:K,nonNullable:!0})],Ee.prototype,"visibleElements",void 0),(0,o._)([(0,a.Cb)({cast(e){return"season"===e||"date"===e?e:(s.Z.getLogger(this).warn(`"${e}" is not a valid option. Acceptable values are only "date" or "season". Defaulting to "${Se}".`),Se)}})],Ee.prototype,"dateOrSeason",void 0),(0,o._)([(0,a.Cb)()],Ee.prototype,"_timeSlider",void 0),Ee=(0,o._)([(0,l.j)("esri.widgets.Daylight")],Ee);const ke=[F.z.interactive,F.z.anchor],Le=Ee;var Te=i(54503),Me=i(8403),Ie=i(49006),Oe=i(46789);const Pe=Ie.iv`@layer{arcgis-daylight{display:block}}`,Ae=(0,Me.m)(Le);class Re extends Te.oi{constructor(){super(...arguments),this.widget=Ae(this),this.viewModel=this.widget.viewModel,this.autoDestroyDisabled=!1,this.currentSeason=this.viewModel.currentSeason,this.dateOrSeason=this.widget.dateOrSeason,this.dayPlaying=this.viewModel.dayPlaying,this.headingLevel=this.widget.headingLevel,this.hideDatePicker=this.widget.visibleElements.datePicker,this.hideHeader=this.widget.visibleElements.header,this.hidePlayButtons=this.widget.visibleElements.playButtons,this.hideShadowsToggle=this.widget.visibleElements.shadowsToggle,this.hideSunLightingToggle=this.widget.visibleElements.sunLightingToggle,this.hideTimezone=this.widget.visibleElements.timezone,this.icon=this.widget.icon,this.label=this.widget.label,this.playSpeedMultiplier=this.widget.playSpeedMultiplier,this.position="bottom-left",this.timeSliderSteps=this.widget.timeSliderSteps,this.yearPlaying=this.viewModel.yearPlaying,this.arcgisReady=(0,Te.yM)(),this.arcgisUserDateTimeChange=(0,Oe.Wk)((()=>this.viewModel),"user-date-time-change")}static{this.properties={autoDestroyDisabled:5,currentSeason:1,dateOrSeason:1,dayPlaying:5,headingLevel:9,hideDatePicker:5,hideHeader:5,hidePlayButtons:5,hideShadowsToggle:5,hideSunLightingToggle:5,hideTimezone:5,icon:1,label:1,playSpeedMultiplier:9,position:1,referenceElement:1,timeSliderSteps:9,yearPlaying:5}}static{this.shadowRootOptions=Te.hZ}static{this.styles=Pe}async destroy(){await this.manager.destroy()}}(0,n.c)("arcgis-daylight",Re)},2814:function(e,t,i){"use strict";var n=i(64297),o=i(20803),s=i(46789),r=i(73440),a=i(43254),l=i(15894),c=i(87422),d=i(90403),u=i(17155),h=(i(61432),i(96711),i(83850),i(48023)),p=i(1803);const y="esri-layer-list",g=`${y}__item`,m={base:y,actionMenu:`${y}__action-menu`,actionGroup:`${y}__action-group`,filterNoResults:`${y}__filter-no-results`,item:g,itemActive:`${g}--active`,itemContentBottom:`${g}-content-bottom`,itemMessage:`${g}-message`,itemActionIcon:`${g}-action-icon`,itemActionImage:`${g}-action-image`,itemTemporaryIcon:`${g}-temporary-icon`,itemTableIcon:`${g}-table-icon`,itemCatalogIcon:`${g}-catalog-icon`,statusIndicator:`${y}__status-indicator`,publishing:`${y}__publishing`,updating:`${y}__updating`,connectionStatus:`${y}__connection-status`,connectionStatusConnected:`${y}__connection-status--connected`,visibleToggle:`${y}__visible-toggle`,visibleIcon:`${y}__visible-icon`};var f=i(59339),v=i(94027),b=i(70880);let _=class extends b.Z{constructor(){super(...arguments),this.catalogLayerList=!0,this.closeButton=!1,this.collapseButton=!1,this.errors=!1,this.filter=!1,this.flow=!0,this.heading=!1,this.statusIndicators=!0,this.temporaryLayerIndicators=!1}};(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],_.prototype,"catalogLayerList",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],_.prototype,"closeButton",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],_.prototype,"collapseButton",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],_.prototype,"errors",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],_.prototype,"filter",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],_.prototype,"flow",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],_.prototype,"heading",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],_.prototype,"statusIndicators",void 0),(0,r._)([(0,u.Cb)({type:Boolean,nonNullable:!0})],_.prototype,"temporaryLayerIndicators",void 0),_=(0,r._)([(0,h.j)("esri.widgets.LayerList.LayerListVisibleElements")],_);const w=_;var C=i(48804),x=i(5221),S=i(84644),E=i(46512),k=i(58639),L=i(68808),T=i(24225),M=i(29629),I=i(23039);const O=a.Z.ofType(C.Z),P="nested";let A=class extends(l.Z.IdentifiableMixin(p.Z)){constructor(e,t){super(e,t),this._rootListEl=null,this._activeItem=null,this._tooltipReferenceMap=new c.Z,this._focusRootFlowItem=!1,this._focusPanelFlowItem=!1,this._focusLayerFlowItem=null,this._layerListMap=new c.Z,this._lastDragDetail=null,this._selectedDragItemLayerUid=null,this._rootGroupUid=`operational-${this.uid}`,this._openedLayersController=null,this.catalogLayerList=null,this.catalogOptions=null,this.collapsed=!1,this.dragEnabled=!1,this.filterPlaceholder="",this.filterPredicate=null,this.filterText="",this.headingLevel=2,this.knowledgeGraphOptions=null,this.layerTablesEnabled=new a.Z(["knowledge-graph"]),this.listItemCanGiveFunction=null,this.listItemCanReceiveFunction=null,this.mapImageOptions=null,this.messages=null,this.messagesCommon=null,this.minDragEnabledItems=x.MZ,this.minFilterItems=x.Kp,this.openedLayers=new a.Z,this.openedLayerLists=new a.Z,this.selectedItems=new O,this.selectionMode="none",this.tableList=null,this.tileOptions=null,this.viewModel=new v.Z,this.visibilityAppearance="default",this.visibleElements=new w,this._canMove=({dragEl:e,fromEl:t,toEl:i},n)=>{const o="pull"===n?this.listItemCanGiveFunction:this.listItemCanReceiveFunction,s=(0,x.rV)(e);if(!s?.sortable)return!1;const r=(0,x.rV)(t),a=(0,x.Gr)(t),l=(0,x.rV)(i),c=(0,x.Gr)(i),d=!!a&&!!c&&a===c,u={selected:s,from:r,to:l},h=t.group,p=i.group,y=r?.layer?.type??"",g=l?.layer?.type??"",m=new Set(["map-image","catalog","knowledge-graph"]);return h&&p&&"function"==typeof o?o.call(null,u):d&&!m.has(y)&&!m.has(g)&&"sublayer"!==s?.layer?.type},this._onCatalogOpen=e=>{this.openedLayers.push(e.layer?.parent),this._focusLayerFlowItem=e.layer?.uid},this._onTablesOpen=e=>{this.openedLayers.push(e.layer),this._focusLayerFlowItem=e.layer?.uid},this._onPanelOpen=()=>{this._focusPanelFlowItem=!0},this._onTooltipReferenceChange=(e,t)=>{t?this._tooltipReferenceMap.set(e,t):this._tooltipReferenceMap.delete(e)},this._onSelectedDragItemLayerUidChange=e=>{this._selectedDragItemLayerUid=e},this._onTriggerAction=(e,t)=>{this.triggerAction(e,t)},this._clearActiveItem=()=>{this._activeItem=null},this._setActiveItem=e=>{if("default"!==this.visibilityAppearance)return;const t=Array.from(e.composedPath()).find((e=>e.classList?.contains(m.item)));this._activeItem=(0,x.rV)(t)},this._onCalciteListOrderChange=e=>{const{_lastDragDetail:t}=this,{toEl:i,fromEl:n,dragEl:o,newIndex:s}=e;if(n&&i&&(t?.newIndex!==s||t?.dragEl!==o||t?.toEl!==i||t?.fromEl!==n))if(this._lastDragDetail=e,this._selectedDragItemLayerUid=o.value,n!==i)this._moveLayerFromChildList({toEl:i,fromEl:n,dragEl:o,newIndex:s});else{const e=Array.from(n.children).filter((e=>e?.matches("calcite-list-item"))).map((e=>e.value));this._sortLayers(n,e)}}}initialize(){this.addHandles([(0,d.on)((()=>this.openedLayers),"change",(()=>this._handleOpenedLayersChange()),d.nn),(0,d.on)((()=>this.viewModel.operationalItems),"change",(()=>(0,x.gX)(this.selectedItems)),d.nn),(0,d.YP)((()=>[this.filterPredicate,this._rootListEl]),(()=>(0,x.j5)(this._rootListEl,this.filterPredicate)))])}loadDependencies(){return(0,S.h)({button:()=>Promise.resolve().then(i.bind(i,61637)),flow:()=>i.e(16414).then(i.bind(i,16414)),"flow-item":()=>Promise.all([i.e(62737),i.e(32029),i.e(79767),i.e(34722),i.e(77506)]).then(i.bind(i,77506)),list:()=>Promise.all([i.e(75014),i.e(29749)]).then(i.bind(i,29749)),notice:()=>i.e(16615).then(i.bind(i,40473)),tooltip:()=>Promise.all([i.e(62737),i.e(94637)]).then(i.bind(i,70514))})}destroy(){this._destroyOpenedLayerLists(),this._tooltipReferenceMap.clear()}get _totalItems(){return this.viewModel.operationalItems.flatten((e=>e.children.filter((e=>"catalog-dynamic-group"!==e.layer?.type)))).length}get _visibleItems(){return this.operationalItems?.filter((e=>!e.hidden&&(this.visibleElements.errors||!e.error)))}get _openedPanelItems(){return this._visibleItems.flatten((e=>e.children)).filter((({hidden:e,panel:t})=>!e&&t?.open&&!t.disabled&&t.flowEnabled))}get _dragEnabled(){return this._totalItems>=this.minDragEnabledItems&&this.dragEnabled}get _filterEnabled(){return this._totalItems>=this.minFilterItems&&this.visibleElements.filter}get _renderedOpenLayerFlowItems(){const{openedLayers:e}=this;return e.toArray().map(((t,i)=>this._renderLayerFlowItem(t,i===e.length-1)))}get icon(){return"layers"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get listItemCreatedFunction(){return this.viewModel.listItemCreatedFunction}set listItemCreatedFunction(e){this.viewModel.listItemCreatedFunction=e}get operationalItems(){return this.viewModel.operationalItems}set operationalItems(e){this.viewModel.operationalItems=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}triggerAction(e,t){return this.viewModel.triggerAction(e,t)}render(){const e=this.viewModel?.state,t={[E.z.hidden]:"loading"===e,[E.z.disabled]:"disabled"===e};return(0,I.u)("div",{class:this.classes(m.base,E.z.widget,E.z.panel,t)},this._renderItemTooltips(),this._renderItems())}async _createFlowList(e,t){const{_layerListMap:i}=this,n=i.get(e);if(n)return n;const o="catalog"===e.type?await this._createCatalogLayerList(e):await this._createTableList(e);return t.aborted||i.set(e,o),o}async _handleOpenedLayersChange(){const{_layerListMap:e,openedLayers:t,openedLayerLists:i}=this;this._openedLayersController?.abort();const n=new AbortController,{signal:o}=n;this._openedLayersController=n,e.forEach(((i,n)=>{t.includes(n)||(i.destroy(),e.delete(n))}));const s=await Promise.all(t.map((e=>this._createFlowList(e,o))));if(o.aborted)return;i.removeAll(),i.addMany(s);const r=i.at(-1);r?"catalogLayer"in r?(this._set("catalogLayerList",r),this._set("tableList",null)):(this._set("catalogLayerList",null),this._set("tableList",r)):(this._set("catalogLayerList",null),this._set("tableList",null))}_destroyOpenedLayerLists(){this.openedLayerLists.destroyAll(),this.openedLayers.removeAll(),this._layerListMap.clear()}_renderItemTooltip(e){const{_tooltipReferenceMap:t,messages:i}=this;return e?(0,I.u)("calcite-tooltip",{key:`tooltip-${e.layer?.uid}`,overlayPositioning:"fixed",referenceElement:t.get(e.layer?.uid)},i.layerIncompatibleTooltip):null}_renderItemTooltipNodes(e){return e.incompatible?this._renderItemTooltip(e):e.children?.filter((e=>!e.hidden)).toArray().map((e=>this._renderItemTooltipNodes(e)))}_renderItemTooltips(){return this._visibleItems?.toArray().map((e=>this._renderItemTooltipNodes(e)))}_renderNoItemsMessage(){return(0,I.u)("div",{slot:"message"},this.messages.noItemsToDisplay)}_renderNoItems(){return(0,I.u)("div",{class:m.itemMessage,key:"esri-layer-list__no-items"},(0,I.u)("calcite-notice",{icon:"information",kind:"info",open:!0,width:"full"},this._renderNoItemsMessage()))}async _createCatalogLayerList(e){const{default:t}=await i.e(71151).then(i.bind(i,71151)),{headingLevel:n,catalogOptions:o,view:s,filterPlaceholder:r,listItemCreatedFunction:a,minFilterItems:l,selectionMode:c,visibilityAppearance:d,_onCatalogOpen:u,_onTablesOpen:h,layerTablesEnabled:p}=this;return new t({headingLevel:n,view:s,filterPlaceholder:r,listItemCreatedFunction:a,minFilterItems:l,selectionMode:c,visibilityAppearance:d,...o,catalogLayer:e,layerTablesEnabled:p,onCatalogOpen:u,onTablesOpen:h})}_getTableListParams(e){switch(e.type){case"knowledge-graph":return{...this.knowledgeGraphOptions,tables:e.tables};case"map-image":return{...this.mapImageOptions,tables:e.subtables};case"tile":return{...this.tileOptions,tables:e.subtables};default:return null}}async _createTableList(e){const{default:t}=await i.e(28941).then(i.bind(i,28941)),{headingLevel:n,selectionMode:o,dragEnabled:s}=this;return new t({headingLevel:n,selectionMode:o,dragEnabled:s,...this._getTableListParams(e)})}_renderLayerFlowItem(e,t){const{messages:i,openedLayers:n}=this,o=e.title||this.messages.untitledLayer;return(0,I.u)("calcite-flow-item",{afterCreate:this._focusLayerFlowItemNode,afterUpdate:this._focusLayerFlowItemNode,bind:this,"data-layer-uid":e.uid,description:o,heading:i["catalog"===e.type?"catalogLayers":"tables"],headingLevel:this.headingLevel,key:`flow-layer-list-${e.uid}`,selected:t,onCalciteFlowItemBack:e=>{e.preventDefault(),n.pop();const t=n.at(-1);t?this._focusLayerFlowItem=t.uid:this._focusRootFlowItem=!0}},this._layerListMap.get(e)?.render())}_renderPanelFlowItems(){const{_openedPanelItems:e,openedLayers:t}=this;return e.toArray().map((({title:i,panel:n},o)=>{const s=()=>this._handlePanelFlowItemBack(n);return(0,I.u)("calcite-flow-item",{afterCreate:this._focusPanelFlowItemNode,afterUpdate:this._focusPanelFlowItemNode,bind:this,description:i,heading:n.title,headingLevel:this.headingLevel,key:`flow-panel-${n.uid}`,selected:!t.length&&o===e.length-1,onCalciteFlowItemBack:e=>{e.preventDefault(),s()}},n.render(),(0,I.u)("calcite-button",{appearance:"transparent",onclick:s,slot:"footer-actions",width:"full"},this.messagesCommon.back))}))}_handlePanelFlowItemBack(e){e.open=!1,this._focusRootFlowItem=!0}_focusRootFlowItemNode(e){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,(0,L.kW)(e))}_focusLayerFlowItemNode(e){this._focusLayerFlowItem===e.dataset.layerUid&&(this._focusLayerFlowItem=null,(0,L.kW)(e))}_focusPanelFlowItemNode(e){this._focusPanelFlowItem&&(this._focusPanelFlowItem=!1,(0,L.kW)(e))}_renderItems(){const{visible:e,collapsed:t,_visibleItems:i,_openedPanelItems:n,_filterEnabled:o,_rootGroupUid:s,visibleElements:{closeButton:r,collapseButton:a,heading:l,flow:c},_dragEnabled:d,selectionMode:u,filterText:h,openedLayers:p,filterPlaceholder:y,messages:g}=this,f=[(0,I.u)("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:r,closed:!e,collapsed:t,collapsible:a,heading:l?g.widgetLabel:void 0,headingLevel:this.headingLevel,key:"root-flow-item",selected:!p.length&&!n.length,onCalciteFlowItemClose:()=>this.visible=!1},i?.length?null:this._renderNoItems(),(0,I.u)("calcite-list",{afterCreate:e=>{this._rootListEl=e,e.addEventListener("focusin",this._setActiveItem),e.addEventListener("focusout",this._clearActiveItem)},afterRemoved:e=>{this._rootListEl=null,e.removeEventListener("focusin",this._setActiveItem),e.removeEventListener("focusout",this._clearActiveItem)},canPull:e=>this._canMove(e,"pull"),canPut:e=>this._canMove(e,"put"),"data-layer-type":s,displayMode:P,dragEnabled:d,filterEnabled:o,filterPlaceholder:y,filterProps:k.I,filterText:o?h:"",group:s,key:"root-list",label:g.widgetLabel,onmouseleave:this._clearActiveItem,onmouseover:this._setActiveItem,selectionAppearance:"border",selectionMode:u,onCalciteListChange:e=>this._handleCalciteListChange(e),onCalciteListDragEnd:e=>this._handleCalciteListDragEnd(e.detail),onCalciteListFilter:e=>this.filterText=e.currentTarget?.filterText??"",onCalciteListOrderChange:e=>this._onCalciteListOrderChange(e.detail)},i.toArray().map((e=>this._renderItem(e))),o?(0,I.u)("div",{class:m.filterNoResults,slot:"filter-no-results"},(0,I.u)("calcite-notice",{kind:"info",open:!0,width:"full"},this._renderNoItemsMessage())):null)),this._renderPanelFlowItems(),this._renderedOpenLayerFlowItems];return e?c?(0,I.u)("calcite-flow",{key:"root-flow"},f):f:null}_renderItem(e,t,i){return(0,I.u)(f.Z,{activeItem:this._activeItem,canMove:this._canMove,css:m,displayMode:P,dragEnabled:this.dragEnabled,item:e,key:`layerListItem-${e.layer?.uid}`,layerTablesEnabled:this.layerTablesEnabled,listModeDisabled:this.viewModel.listModeDisabled,messages:this.messages,messagesCommon:this.messagesCommon,parent:t,parentTitles:i,rootGroupUid:this._rootGroupUid,selectedDragItemLayerUid:this._selectedDragItemLayerUid,selectedItems:this.selectedItems,selectionMode:this.selectionMode,visibilityAppearance:this.visibilityAppearance,visibleElements:this.visibleElements,onAction:this._onTriggerAction,onCatalogOpen:this._onCatalogOpen,onPanelOpen:this._onPanelOpen,onSelectedDragItemLayerUidChange:this._onSelectedDragItemLayerUidChange,onTablesOpen:this._onTablesOpen,onTooltipReferenceChange:this._onTooltipReferenceChange})}_moveLayerFromChildList({toEl:e,fromEl:t,dragEl:i,newIndex:n}){const o=(0,x.rV)(i),s=(0,x.rV)(e),r=(0,x.rV)(t);this.viewModel.moveListItem(o,r,s,n)}_handleCalciteListDragEnd(e){const{fromEl:t,dragEl:i,oldIndex:n}=e;t.insertBefore(i,t.children[n])}_sortLayers(e,t){if(e)if(e===this._rootListEl)(0,x.Cl)(this.view?.map?.layers,t);else{const i=(0,x.rV)(e);if(!i)return;(0,x.YO)(i,t)}}_handleCalciteListChange(e){const{selectionMode:t,selectedItems:i}=this;if("none"===t)return;const n=e.target.selectedItems.map((e=>(0,x.rV)(e))).filter(Boolean);i.removeAll(),i.addMany(n)}};(0,r._)([(0,u.Cb)()],A.prototype,"_rootListEl",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"_activeItem",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"_tooltipReferenceMap",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"_focusRootFlowItem",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"_focusPanelFlowItem",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"_focusLayerFlowItem",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"_layerListMap",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"_totalItems",null),(0,r._)([(0,u.Cb)()],A.prototype,"_visibleItems",null),(0,r._)([(0,u.Cb)()],A.prototype,"_openedPanelItems",null),(0,r._)([(0,u.Cb)()],A.prototype,"_dragEnabled",null),(0,r._)([(0,u.Cb)()],A.prototype,"_filterEnabled",null),(0,r._)([(0,u.Cb)()],A.prototype,"_renderedOpenLayerFlowItems",null),(0,r._)([(0,u.Cb)({readOnly:!0})],A.prototype,"catalogLayerList",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"catalogOptions",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"collapsed",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"dragEnabled",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"filterPlaceholder",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"filterPredicate",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"filterText",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"headingLevel",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"icon",null),(0,r._)([(0,u.Cb)()],A.prototype,"knowledgeGraphOptions",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"label",null),(0,r._)([(0,u.Cb)()],A.prototype,"layerTablesEnabled",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"listItemCanGiveFunction",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"listItemCanReceiveFunction",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"listItemCreatedFunction",null),(0,r._)([(0,u.Cb)()],A.prototype,"mapImageOptions",void 0),(0,r._)([(0,u.Cb)(),(0,T.H)("esri/widgets/LayerList/t9n/LayerList")],A.prototype,"messages",void 0),(0,r._)([(0,u.Cb)(),(0,T.H)("esri/t9n/common")],A.prototype,"messagesCommon",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"minDragEnabledItems",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"minFilterItems",void 0),(0,r._)([(0,u.Cb)({readOnly:!0})],A.prototype,"openedLayers",void 0),(0,r._)([(0,u.Cb)({readOnly:!0})],A.prototype,"openedLayerLists",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"operationalItems",null),(0,r._)([(0,u.Cb)()],A.prototype,"selectedItems",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"selectionMode",void 0),(0,r._)([(0,u.Cb)({readOnly:!0})],A.prototype,"tableList",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"tileOptions",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"view",null),(0,r._)([(0,M.s)("trigger-action"),(0,u.Cb)({type:v.Z})],A.prototype,"viewModel",void 0),(0,r._)([(0,u.Cb)()],A.prototype,"visibilityAppearance",void 0),(0,r._)([(0,u.Cb)({type:w,nonNullable:!0})],A.prototype,"visibleElements",void 0),A=(0,r._)([(0,h.j)("esri.widgets.LayerList")],A);const R=A;var D=i(54503),$=i(8403);const N=i(49006).iv`@layer{arcgis-layer-list{display:block;.arcgis-layer-list{display:flex}.arcgis-layer-list__filter-no-results{padding:var(--calcite-spacing-md) var(--calcite-spacing-lg)}.arcgis-layer-list__item{--calcite-list-item-icon-center: 8.5px}.arcgis-layer-list__item-table-icon,.arcgis-layer-list__item-catalog-icon{margin-inline-end:0}.arcgis-layer-list__item-action-image{flex:0 0 var(--calcite-spacing-xl);background-position:50%;background-repeat:no-repeat;background-size:contain;width:var(--calcite-spacing-xl);height:var(--calcite-spacing-xl);text-align:center;font-size:var(--calcite-font-size)}.arcgis-layer-list__action-menu .arcgis-layer-list__action-group{display:none}.arcgis-layer-list__action-menu[open] .arcgis-layer-list__action-group{display:flex}.arcgis-layer-list__visible-icon{visibility:hidden}.arcgis-layer-list__item--active:hover,.arcgis-layer-list__item--active:focus,.arcgis-layer-list__item--active:focus-within{>.arcgis-layer-list__visible-toggle>.arcgis-layer-list__visible-icon{visibility:visible}}.arcgis-layer-list__status-indicator{visibility:hidden;margin-inline:0;color:transparent}.arcgis-layer-list__publishing{visibility:visible;color:var(--calcite-color-foreground-2);transform-origin:var(--calcite-list-item-icon-center) var(--calcite-list-item-icon-center);animation:arcgis-layer-list__publishing-anim 2s normal infinite}.arcgis-layer-list__updating{visibility:visible;animation:arcgis-layer-list__updating-anim 2s normal infinite}.arcgis-layer-list__connection-status{visibility:visible;margin-inline:calc(var(--calcite-spacing-lg) * .5);width:calc(var(--calcite-spacing-xxxl) * .5);height:calc(var(--calcite-spacing-xxxl) * .5);color:var(--calcite-color-status-danger)}.arcgis-layer-list__connection-status--connected{color:var(--calcite-color-status-success)}.arcgis-layer-list__item-content-bottom{margin:var(--calcite-spacing-md) var(--calcite-spacing-lg)}.arcgis-layer-list__item-content-bottom .arcgis-legend__service{padding:0 0 var(--calcite-spacing-md) 0}.arcgis-layer-list__item-message{margin:var(--calcite-spacing-md) var(--calcite-spacing-lg)}@keyframes arcgis-layer-list__updating-anim{0%,40%{color:transparent}50%,80%{color:var(--calcite-color-brand)}to{color:transparent}}@keyframes arcgis-layer-list__publishing-anim{0%,20%{transform:rotate(45deg)}80%,to{transform:rotate(135deg)}}}}`,F=(0,o.YI)(((e,t)=>(t.onLoaded((()=>{const t=e.el;e.listenOn(t.childElem,"calciteFlowItemClose",(()=>{e.arcgisClose.emit(),e.autoDestroyDisabled||e.destroy()}))})),(0,D.yM)()))),V=(0,$.m)(R);class z extends D.oi{constructor(){super(...arguments),this.widget=V(this),this.viewModel=this.widget.viewModel,this.arcgisClose=F(this),this.autoDestroyDisabled=!1,this.catalogOptions=this.widget.catalogOptions,this.closed=!1,this.collapsed=this.widget.collapsed,this.dragEnabled=this.widget.dragEnabled,this.filterPlaceholder=this.widget.filterPlaceholder,this.filterPredicate=this.widget.filterPredicate,this.filterText=this.widget.filterText,this.headingLevel=this.widget.headingLevel,this.hideCatalogLayerList=this.widget.visibleElements.catalogLayerList,this.hideFlow=this.widget.visibleElements.flow,this.hideStatusIndicators=this.widget.visibleElements.statusIndicators,this.icon=this.widget.icon,this.knowledgeGraphOptions=this.widget.knowledgeGraphOptions,this.label=this.widget.label,this.listItemCreatedFunction=this.widget.listItemCreatedFunction,this.minDragEnabledItems=this.widget.minDragEnabledItems,this.minFilterItems=this.widget.minFilterItems,this.openedLayers=this.widget.openedLayers,this.position="bottom-left",this.selectedItems=this.widget.selectedItems,this.selectionMode=this.widget.selectionMode,this.showCloseButton=this.widget.visibleElements.closeButton,this.showCollapseButton=this.widget.visibleElements.collapseButton,this.showErrors=this.widget.visibleElements.errors,this.showFilter=this.widget.visibleElements.filter,this.showHeading=this.widget.visibleElements.heading,this.showTemporaryLayerIndicators=this.widget.visibleElements.temporaryLayerIndicators,this.state=this.viewModel.state,this.visibilityAppearance=this.widget.visibilityAppearance,this.arcgisPropertyChange=(0,o.OR)()("state"),this.arcgisReady=(0,D.yM)(),this.arcgisTriggerAction=(0,s.Wk)((()=>this.widget),"trigger-action")}static{this.properties={autoDestroyDisabled:5,catalogLayerList:32,catalogOptions:0,closed:5,collapsed:7,dragEnabled:5,filterPlaceholder:1,filterPredicate:0,filterText:1,headingLevel:9,hideCatalogLayerList:5,hideFlow:5,hideStatusIndicators:5,icon:1,knowledgeGraphOptions:0,label:1,listItemCreatedFunction:0,minDragEnabledItems:9,minFilterItems:9,openedLayers:0,operationalItems:32,position:1,referenceElement:1,selectedItems:0,selectionMode:1,showCloseButton:5,showCollapseButton:5,showErrors:5,showFilter:5,showHeading:5,showTemporaryLayerIndicators:5,state:3,tableList:32,visibilityAppearance:1}}static{this.shadowRootOptions=D.hZ}static{this.styles=N}get catalogLayerList(){return this.widget.catalogLayerList}get operationalItems(){return this.widget.operationalItems}get tableList(){return this.widget.tableList}async destroy(){await this.manager.destroy()}async triggerAction(e,t){this.widget?.triggerAction(e,t)}}(0,n.c)("arcgis-layer-list",z)},81714:function(e,t,i){"use strict";var n=i(64297),o=i(20803),s=i(83861),r=i(54503),a=i(8403);const l=i(49006).iv`@layer{arcgis-legend{display:block}}`,c=(0,a.m)(s.default);class d extends r.oi{constructor(){super(...arguments),this.widget=c(this),this.viewModel=this.widget.viewModel,this.activeLayerInfos=this.widget.activeLayerInfos,this.autoDestroyDisabled=!1,this.basemapLegendVisible=this.widget.basemapLegendVisible,this.headingLevel=this.widget.headingLevel,this.hideLayersNotInCurrentView=this.widget.hideLayersNotInCurrentView,this.icon=this.widget.icon,this.label=this.widget.label,this.layerInfos=this.widget.layerInfos,this.legendStyle=this.widget.style,this.position="bottom-left",this.respectLayerDefinitionExpression=this.widget.respectLayerDefinitionExpression,this.respectLayerVisibilityDisabled=this.widget.respectLayerVisibility,this.state=this.viewModel.state,this.arcgisPropertyChange=(0,o.OR)()("state"),this.arcgisReady=(0,r.yM)()}static{this.properties={activeLayerInfos:0,autoDestroyDisabled:5,basemapLegendVisible:5,headingLevel:9,hideLayersNotInCurrentView:5,icon:1,label:1,layerInfos:0,legendStyle:1,position:1,referenceElement:1,respectLayerDefinitionExpression:5,respectLayerVisibilityDisabled:5,state:3}}static{this.shadowRootOptions=r.hZ}static{this.styles=l}async destroy(){await this.manager.destroy()}}(0,n.c)("arcgis-legend",d)},53553:function(e,t,i){"use strict";var n=i(64297),o=i(20803),s=i(46789),r=i(53447),a=i(73440),l=(i(55214),i(3480)),c=i(50702),d=i(96711),u=i(61100),h=i(93568),p=i(90403),y=i(17155),g=(i(61432),i(48023)),m=i(57440),f=i(1803),v=i(43254),b=i(88194),_=i(87833),w=(i(83850),i(60147)),C=i(47925),x=i(13132),S=i(28931),E=i(8554),k=i(75428),L=i(24584),T=i(85357),M=i(89636),I=i(38096),O=i(19886),P=i(68578),A=i(85164),R=i(51413),D=i(51870);function $(e){return function(e){if(e.graphic&&"graphics"!==e.graphic.layer?.type)return{result:A.h.GRAPHICS_LAYER_MISSING};if(!e.operations)return{result:A.h.GEOMETRY_MISSING};if((0,D.XH)(e.elevationInfo))return{result:A.h.ELEVATION_MODE_UNSUPPORTED};const t=e.operations.data.type,i=e.operations.data.geometry;return"point"===t||"mesh"===t||"polyline"===t||"polygon"===t?{result:A.h.SUPPORTED,geometry:i}:{result:A.h.GEOMETRY_TYPE_UNSUPPORTED}}(e).result}var N=i(77308),F=i(96620),V=i(18753),z=i(60396),Z=i(41943),B=i(69660),U=i(9217),H=i(81972),G=i(29668),j=i(54074),K=i(8316),W=i(43295),Y=i(22455),q=i(70134),X=i(79487);let J=class extends _.Z.EventedAccessor{constructor(e){super(e),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":case"draw-3d":return this.activeComponent.geometryType;default:(0,X.Bg)(this.activeComponent)}return null}addToHistory(e){this.history.redo=[],this.history.undo.push(e)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){this.activeComponent?.reset()}refreshComponent(){const e=this.activeComponent;e&&("box"!==e.type&&"reshape"!==e.type&&"graphic-mover"!==e.type||e.refresh())}set undo(e){this._set("undo",(()=>{this.canUndo()&&e()}))}set redo(e){this._set("redo",(()=>{this.canRedo()&&e()}))}};(0,a._)([(0,y.Cb)()],J.prototype,"activeComponent",void 0),(0,a._)([(0,y.Cb)()],J.prototype,"cancelled",void 0),(0,a._)([(0,y.Cb)()],J.prototype,"history",void 0),(0,a._)([(0,y.Cb)()],J.prototype,"tool",null),(0,a._)([(0,y.Cb)()],J.prototype,"type",void 0),(0,a._)([(0,y.Cb)()],J.prototype,"canUndo",null),(0,a._)([(0,y.Cb)()],J.prototype,"canRedo",null),(0,a._)([(0,y.Cb)()],J.prototype,"onEnd",void 0),(0,a._)([(0,y.Cb)()],J.prototype,"undo",null),(0,a._)([(0,y.Cb)()],J.prototype,"redo",null),(0,a._)([(0,y.Cb)()],J.prototype,"toggleTool",void 0),(0,a._)([(0,y.Cb)()],J.prototype,"addToSelection",void 0),(0,a._)([(0,y.Cb)()],J.prototype,"removeFromSelection",void 0),J=(0,a._)([(0,g.j)("esri.widgets.Sketch.support.OperationHandle")],J);let Q=class extends J{};(0,a._)([(0,y.Cb)()],Q.prototype,"activeComponent",void 0),Q=(0,a._)([(0,g.j)("esri.widgets.Sketch.support.OperationHandle.CreateOperationHandle")],Q);let ee=class extends J{};var te;(0,a._)([(0,y.Cb)()],ee.prototype,"activeComponent",void 0),ee=(0,a._)([(0,g.j)("esri.widgets.Sketch.support.OperationHandle.UpdateOperationHandle")],ee),function(e){e[e.ForceCollapse=-1]="ForceCollapse",e[e.Low=0]="Low",e[e.Medium=10]="Medium",e[e.High=100]="High",e[e.Max=1e3]="Max"}(te||(te={}));const ie={defaultZ:0},ne={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0,name:W.b},tool:"transform"};let oe=class extends _.Z.EventedAccessor{constructor(e){super(e),this._defaultSnappingManager=null,this._updatingHandles=new w.R,this._internalGraphicsLayer=new r.Z({listMode:"hide",internal:!0,title:"SVM Internal"}),this._operationHandle=null,this._viewHandlesKey="viewHandles",this.activeFillSymbol=null,this.activeLineSymbol=null,this.activeVertexSymbol=null,this.allowDeleteKey=!0,this.layer=null,this.pointSymbol=new O.Z({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.polygonSymbol=new M.Z({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}}),this.polylineSymbol=new I.Z({color:[130,130,130,1],width:2}),this.meshSymbol=new T.Z({symbolLayers:new v.Z([new L.Z])}),this.updateGraphics=new v.Z,this.updateOnGraphicClick=!0,this.creationMode="single",this.vertexSymbol=new O.Z({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.sketchOptions=new Z.Z,this._moduleLoaderAbortController=null,this._viewReadyAbortController=null,this._sketchContinuationFlag=!1,this._originalPopupEnabled=null,this.defaultCreateOptions=ie,this.defaultUpdateOptions=ne,this.snappingOptions=e?.snappingManager?.options??e?.snappingOptions??new H.Z}initialize(){this.addHandles([(0,p.on)((()=>this.view?.map?.layers),"change",(e=>{e.removed.includes(this.layer)&&this.cancel()})),(0,p.on)((()=>this.layer?.graphics),"change",(e=>{if(null!=this._operationHandle)for(const t of e.removed)this.updateGraphics.includes(t)&&(this.updateGraphics.length>1?this._operationHandle.removeFromSelection(t):this._operationHandle.cancel())})),(0,p.YP)((()=>this.layer?.elevationInfo??null),(e=>{e!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=e)}),p.tX),(0,p.YP)((()=>this.view),(e=>{this._defaultSnappingManager=(0,u.SC)(this._defaultSnappingManager),e&&(this.snappingManager||(this._defaultSnappingManager=new U.N({view:e,options:this.snappingOptions})),"2d"===e.type?Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(18208),i.e(52846),i.e(48044),i.e(72997),i.e(20144),i.e(5648),i.e(72906),i.e(78478)]).then(i.bind(i,78478)):"3d"===e.type&&(Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(18208),i.e(93891),i.e(79841),i.e(43825),i.e(82845),i.e(52846),i.e(8455),i.e(72133),i.e(48044),i.e(48119),i.e(72997),i.e(20144),i.e(93151),i.e(36891),i.e(15601),i.e(232),i.e(92889),i.e(37727),i.e(56034),i.e(57486)]).then(i.bind(i,56034)),Promise.all([i.e(88534),i.e(93891),i.e(79841),i.e(96477),i.e(72133),i.e(35720),i.e(36891),i.e(15601),i.e(75029),i.e(46969)]).then(i.bind(i,39088))))}),p.tX),(0,p.YP)((()=>this.view?.spatialReference),((e,t)=>{e&&t&&!e.equals(t)&&this.cancel()}))]),(0,G.Ob)(this)}destroy(){this.cancel(),this._removeDefaultLayer(),this._defaultSnappingManager=(0,u.SC)(this._defaultSnappingManager),this._set("snappingManager",null),this._set("view",null),this._updatingHandles.destroy(),this.emit("destroy")}get updating(){return this._updatingHandles.updating||null!=this.snappingManager&&this.snappingManager.updating}get activeTool(){return this._operationHandle?.tool??null}get activeCreateToolDrawMode(){return"create"===this._operationHandle?.type&&this._operationHandle.activeComponent&&"mode"in this._operationHandle.activeComponent?this._operationHandle.activeComponent.mode:null}get activeTooltip(){const{activeComponent:e,destroyed:t}=this,i=!t&&e&&"tooltip"in e?e.tooltip:null;return i?.visible?i:null}get activeComponent(){return this._operationHandle?.activeComponent??null}get createGraphic(){return null==this.activeComponent||"draw-3d"!==this.activeComponent.type&&"draw-2d"!==this.activeComponent.type?this._get("createGraphic"):this.activeComponent.graphic}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...ie,...e})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(e){this._set("defaultUpdateOptions",{...ne,...e,reshapeOptions:{...ne.reshapeOptions,...e?.reshapeOptions},highlightOptions:{...ne.highlightOptions,...e?.highlightOptions}})}get labelOptions(){return this.sketchOptions.labels}set labelOptions(e){this.sketchOptions.labels=e}get snappingOptions(){return this.snappingManager?.options??this._get("snappingOptions")}set snappingOptions(e){null!=this._defaultSnappingManager&&(this._defaultSnappingManager.options=e),this._set("snappingOptions",e)}get snappingManager(){return this._isOverridden("snappingManager")&&this._get("snappingManager"),this._defaultSnappingManager}set snappingManager(e){if(e)this._isOverridden("snappingManager")||(this._defaultSnappingManager=(0,u.SC)(this._defaultSnappingManager)),this._override("snappingManager",e);else{const{view:e}=this;!this._defaultSnappingManager&&e&&(this._defaultSnappingManager=new U.N({options:this.snappingOptions,view:e})),this._clearOverride("snappingManager")}}get state(){const e=!(!this.view?.ready||!this.layer),t=this._operationHandle;return e&&t?"active":e?"ready":"disabled"}get tooltipOptions(){return this.sketchOptions.tooltips}set tooltipOptions(e){this.sketchOptions.tooltips=e}get valueOptions(){return this.sketchOptions.values}set valueOptions(e){this.sketchOptions.values=e}get view(){return this._get("view")}set view(e){const t=this._get("view");if(t){const{container:e,map:i}=t;e&&(t.cursor=null),i?.remove(this._internalGraphicsLayer),this.removeHandles(this._viewHandlesKey),this.cancel()}const i="view-ready";this.removeHandles(i),e&&this.addHandles((0,p.gx)((()=>e.ready),(t=>{this.removeHandles(this._viewHandlesKey),t&&this.addHandles(this._generateViewHandles(e),this._viewHandlesKey)}),p.tX),i),this._set("view",e)}cancel(){this._moduleLoaderAbortController=(0,u.IM)(this._moduleLoaderAbortController),this._viewReadyAbortController=(0,u.IM)(this._viewReadyAbortController),this._sketchContinuationFlag=!0,this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){const{state:e,updateGraphics:t}=this;if("active"===e&&t.length){const{activeTool:e,layer:i}=this,n=t.toArray();i.removeMany(n),this.cancel(),this._emitDeleteEvent({graphics:n,tool:e})}}duplicate(){if("active"===this.state&&this.updateGraphics.length){const e=this.updateGraphics.map((e=>e.clone())).toArray();return this.layer.addMany(e),this.emit("duplicate",{graphics:e,type:"duplicate"}),e}return[]}async create(e,t){this.cancel(),await this._waitViewReady();const{view:i,layer:n}=this;if(!i||"disabled"===this.state)throw n||this._logMissingLayer(),(0,h.zE)();if(null!=i.activeTool&&(i.activeTool=null),!e)return void this._logError("sketch:missing-parameter","Missing parameter 'tool'.");(0,N.p)(i,this._internalGraphicsLayer);const o=await this._updatingHandles.addPromise(this._setupCreateOperation(e,t));if(null==o||this.destroyed)return void i.map.remove(this._internalGraphicsLayer);o.on("complete",(()=>{if(o===this._operationHandle){const i=this.createGraphic,s=this._operationHandle.cancelled;if(this._operationHandle.destroy(),this._operationHandle=null,this._set("createGraphic",null),this.view?.map&&this.view.map.remove(this._internalGraphicsLayer),o.cancelled||null==i||n.add(i),this._sketchContinuationFlag=!1,this.emit("create",{graphic:i,state:s?"cancel":"complete",tool:e,toolEventInfo:null,type:"create"}),s||this._sketchContinuationFlag)return;const{creationMode:r}=this;if("continuous"===r){if(t?.geometryToPlace)return;this._updatingHandles.addPromise((0,h.R8)(this.create(e,t)))}else"update"===r&&i&&this._updatingHandles.addPromise((0,h.R8)(this.update([i])))}})),this._operationHandle=o,i.ready&&i.focus()}async place(e,t){return this.create("mesh",{mode:"click",hasZ:e.hasZ,geometryToPlace:e,...t})}async update(e,t){this.cancel(),await this._waitViewReady();const{layer:i,view:n,state:o}=this;if(!n||"disabled"===o)throw i||this._logMissingLayer(),(0,h.zE)();null!=n.activeTool&&(n.activeTool=null);const s=Array.isArray(e)?e:[e];if(null==e||!s?.length)return void this._logError("sketch:missing-parameter","Missing parameter 'graphics'.");if(s.some((e=>e.layer!==i?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):null==e.geometry&&(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0))))return;const r=await this._updatingHandles.addPromise(this._setupUpdateOperation(s,t));this.destroyed||null==r||ye(r)||((0,N.p)(n,this._internalGraphicsLayer),this._setUpdateOperationHandle(r,t),this.emit("update",{graphics:s,state:"start",aborted:!1,tool:r.tool,toolEventInfo:null,type:"update"}))}async _updateSpatialReference(e){const t=this.view;if(t){e=Array.isArray(e)?e:[e];for(const i of e)null==i.geometry||"mesh"===i.geometry.type||(0,E.fS)(i.geometry.spatialReference,t.spatialReference)||((0,x.canProjectWithoutEngine)(i.geometry.spatialReference,t.spatialReference)||(0,x.isLoaded)()||await(0,x.load)(),i.geometry=(0,x.project)(i.geometry,t.spatialReference))}else this._logMissingView()}undo(){this.canUndo()&&this._operationHandle?.undo()}redo(){this.canRedo()&&this._operationHandle?.redo()}canUndo(){return!!this._operationHandle?.canUndo()}canRedo(){return!!this._operationHandle?.canRedo()}toggleUpdateTool(){this._operationHandle?.toggleTool()}async _getFirstHit(e){const t=this.view;if(!t)return this._logMissingView(),null;if("2d"===t.type){const i=[];t.map.allLayers.forEach((e=>{"vector-tile"!==e.type&&"imagery"!==e.type||i.push(e)}));const n=await t.hitTest(e,{exclude:i});return(0,Y.qm)(n.results)}const i=[t.map.ground];t.map.allLayers.forEach((e=>{(0,k.nx)(e.type)&&i.push(e)}));const n=await t.hitTest(e,{exclude:i});if(n.results.length>0){const e=n.results[0];if(null!=e&&"graphic"===e.type&&e.graphic&&(!n.ground.mapPoint||t.map.ground.opacity<1||n.ground.distance-(e.distance??0)>-Math.min(3*n.ground.distance,"global"===t.viewingMode?(0,C.Iu)(t.renderCoordsHelper.spatialReference).radius/t.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return e}return null}_generateViewHandles(e){return[e.on("immediate-click",(async e=>{const t="active"===this.state&&"create"===this._operationHandle?.type;"disabled"!==this.state&&!t&&this.updateOnGraphicClick&&await this._updatingHandles.addPromise(this._handleImmediateClick(e))}),F.f.WIDGET)]}async _handleImmediateClick(e){const t=await e.defer((()=>this._getFirstHit((0,q.vT)(e))));let i=null;if(null!=t){const n=t.graphic;this.updateGraphics.includes(n)||n.layer===this.layer?(e.stopPropagation(),i=n):"2d"!==this.view?.type||this._isComponentGraphic(n)||"active"!==this.state||this.cancel()}else"active"===this.state&&this.cancel();null==i||this.updateGraphics.includes(i)||await this.update([i],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}})}async _setupCreateOperation(e,t){const i=this.view;if(!i)return this._logMissingView(),null;const n={hasZ:"3d"===i.type,...this.defaultCreateOptions,...t},o=await this._setupDrawGraphicTool(e,i,n);return null==o?null:(i.tools.add(o),i.activeTool=o,this._setupCreateOperationHandle(o))}async _setupDrawGraphicTool(e,t,i){if("multipoint"===e&&"3d"===t.type)return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!t)return this._logMissingView(),null;const{cursor:n,defaultZ:o,hasZ:s,geometryToPlace:r,graphicProperties:a,mode:l,preserveAspectRatio:c}=i,d=function(e,t){return"freehandPolygon"===t||"freehandPolyline"===t?"freehand":e??("rectangle"===t||"circle"===t?"hybrid":"click")}(l,e),u=function(e){switch(e){case"freehandPolygon":return"polygon";case"freehandPolyline":return"polyline";default:return e}}(e),h=i?.optionsPerTool?.has(e)?i.optionsPerTool.get(e):{},p=h?.preserveAspectRatio??c??"rectangle"!==e,y={centered:"rectangle"!==e&&!("circle"===e&&!p),cursor:n,defaultZ:o,forceUniformSize:p,graphicProperties:{...a,attributes:{...a?.attributes}},geometryToPlace:r,geometryType:u,mode:d,graphicSymbol:this._getGraphicSymbolFromTool(e),hasZ:s,snappingManager:this.snappingManager,snapToScene:!1,view:t,...h};return"2d"===t.type?this._makeDrawGraphicTool2D(y):this._makeDrawGraphicTool3D(y)}async _makeDrawGraphicTool2D(e){const[t,n,o]=await Promise.all([this._requireModule(Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(18208),i.e(52846),i.e(48044),i.e(72997),i.e(20144),i.e(5648),i.e(72906),i.e(78478)]).then(i.bind(i,78478))),(0,j.A)(),(0,K.U)()]);return ye(t)||this.destroyed?null:new t.module.DrawGraphicTool2D({...e,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:ae(e.geometryType)?this.activeFillSymbol:null,sketchOptions:this.sketchOptions,automaticAreaMeasurementUtils:n,automaticLengthMeasurementUtils:o})}async _makeDrawGraphicTool3D(e){const[t,n,o]=await Promise.all([this._requireModule(Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(18208),i.e(93891),i.e(79841),i.e(43825),i.e(82845),i.e(52846),i.e(8455),i.e(72133),i.e(48044),i.e(48119),i.e(72997),i.e(20144),i.e(93151),i.e(36891),i.e(15601),i.e(232),i.e(92889),i.e(37727),i.e(56034),i.e(57486)]).then(i.bind(i,56034))),(0,j.A)(),(0,K.U)()]);if(ye(t)||this.destroyed)return null;const{elevationInfo:s}=this.layer;return new t.module.DrawGraphicTool3D({...e,elevationInfo:s,snapToScene:!0,sketchOptions:this.sketchOptions,automaticAreaMeasurementUtils:n,automaticLengthMeasurementUtils:o})}_setupCreateOperationHandle(e){const t=this.view;if(!t)return this._logMissingView(),null;let i=null;const n=e.forceUniformSize,o=e.centered,s=[t.on("key-down",(t=>{if(t.key===V.Sn.pan)t.stopPropagation(),t.repeat||(e.enabled=!1);else if(t.key===V.Sn.complete)t.stopPropagation(),e.completeCreateOperation();else if(t.key!==V.Sn.vertexAdd||t.repeat)t.key===V.Sn.undo?(t.stopPropagation(),r.undo()):t.key===V.Sn.redo?(t.stopPropagation(),r.redo()):t.key!==V.Sn.constraint||"rectangle"!==e.geometryType&&"circle"!==e.geometryType||t.repeat?t.key===V.Sn.center&&(t.repeat||(e.centered=!o,t.stopPropagation())):(e.forceUniformSize=!n,t.stopPropagation());else{const i=e.drawOperation.geometryType;"polyline"!==i&&"polygon"!==i&&"multipoint"!==i||(t.stopPropagation(),e.drawOperation.commitStagedVertex())}}),F.f.WIDGET),t.on("key-up",(t=>{t.key===V.Sn.pan?e.enabled=!0:t.key!==V.Sn.constraint||"rectangle"!==e.geometryType&&"circle"!==e.geometryType?t.key===V.Sn.center&&(e.centered=o,t.stopPropagation()):(e.forceUniformSize=n,t.stopPropagation())}),F.f.WIDGET),e.on("vertex-add",(t=>{switch(i=null==i?"start":"active",t.operation){case"apply":this.emit("create",{graphic:e.graphic,state:i,tool:this.activeTool,toolEventInfo:t,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}})),e.on("cursor-update",(t=>{e.drawOperation.numCommittedVertices>0&&this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:t.vertices[0].coordinates,type:"cursor-update"},type:"create"})})),e.on("vertex-remove",(t=>{switch(t.operation){case"apply":this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:t,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}})),e.on("complete",(e=>{this._set("createGraphic",e.graphic),i="complete",e.aborted?r&&r.cancel():r&&r.complete()})),(0,p.YP)((()=>this._getGraphicSymbolFromTool(e.geometryType)),(t=>{e.graphicSymbol=t}))],r=new Q({activeComponent:e,tool:e.geometryType,type:"create",onEnd:()=>{(0,c.yV)(s),t.tools?.remove(e)},undo:()=>{e.canUndo&&e.undo()},redo:()=>{e.canRedo&&e.redo()},canUndo:()=>e.canUndo,canRedo:()=>e.canRedo});return r}_getGraphicSymbolFromTool(e){switch(e){case"point":case"multipoint":return this.pointSymbol;case"polyline":case"freehandPolyline":return this.polylineSymbol;case"circle":case"rectangle":case"polygon":case"freehandPolygon":return this.polygonSymbol;case"mesh":return this.meshSymbol}}async _setupUpdateOperation(e,t){const{layer:i,view:n}=this;if(!n)return this._logMissingView(),null;const o={...this.defaultUpdateOptions,...t,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...t?.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,...t?.highlightOptions}};let s=o.tool??ne.tool;for(const t of e)i.remove(t),i.add(t);if("3d"===n.type){if(0===e.length)return null;switch(s){case"move":return this._setupMove3DOperation(e,o,n,s);case"reshape":return e.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupReshape3DOperation(e[0],o,n);case"transform":return this._setupGraphicTransform3DOperation(e,o,n)}}switch(s){case"move":return this._setupMove2DOperation(e,o,n);case"reshape":return e.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupTransformOrReshape2DOperation(e,s,o,n);case"transform":if(1===e.length){const t=e[0].geometry?.type;"point"!==t&&"multipoint"!==t||(s="reshape")}return this._setupTransformOrReshape2DOperation(e,s,o,n)}}async _setupMove3DOperation(e,t,n,o,s=!1){const[r,a]=await Promise.all([this._requireModule(Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(18208),i.e(93891),i.e(79841),i.e(43825),i.e(82845),i.e(52846),i.e(8455),i.e(72133),i.e(48044),i.e(48119),i.e(72997),i.e(20144),i.e(93151),i.e(36891),i.e(15601),i.e(232),i.e(92889),i.e(37727),i.e(56034),i.e(57486)]).then(i.bind(i,56034))),(0,K.U)()]);if(ye(r))return r;const{ManipulatedObject3DGraphic:l,MoveTool3D:d}=r.module,u=new Map,h=()=>{u.forEach((e=>e.destroy())),u.clear()};for(const t of e){const e=new l({view:n,graphic:t}),i=(0,R.Y)(e);if(i!==A.h.SUPPORTED)return h(),this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${(0,A.O)(i)}).`),null;u.set(t,e)}const p=new d({view:n,enableZ:t.enableZ,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,autoLengthMeasurementUtils:a});n.tools.add(p),p.objects.addMany(Array.from(u.values())),s||this.updateGraphics.addMany(e);const y=[],g=new ee({activeComponent:p,tool:o,type:"update",onEnd:()=>{(0,c.yV)(y),pe(n,p),h()},undo:()=>{ue(this.view,p),le(g,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o})},redo:()=>{ce(g,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o})},addToSelection:e=>{this.updateGraphics.push(e);const t=new l({view:n,graphic:e});u.set(e,t),p.objects.push(t),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:e=>{const t=this.updateGraphics.indexOf(e);if(g.history.undo.forEach((e=>e.updates.splice(t,1))),g.history.redo.forEach((e=>e.updates.splice(t,1))),this.updateGraphics.remove(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"}),0===this.updateGraphics.length)return void g.complete();const i=u.get(e);i&&(p.objects.remove(i),i.destroy(),u.delete(e))},toggleTool:async()=>{if(1!==this.updateGraphics.length||!1===t.toggleToolOnClick)return;if("transform"!==o)return;const e=this.updateGraphics.at(0),i=await this._setupReshape3DOperation(e,t,n,!0);i&&!ye(i)&&(g.onEnd(),g.destroy(),this._setUpdateOperationHandle(i,t))}});return y.push(...this._getHandlesForComponent(g,t),n.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(g,e,t)),F.f.WIDGET),n.on("key-down",(e=>{this._getCommonUpdateOperationKeyDownHandlers(g,e)}),F.f.WIDGET)),g}_setupGraphicTransform3DOperation(e,t,i,n=!1){if(1===e.length&&function(e){if("graphics"!==e.layer?.type)return A.h.GRAPHICS_LAYER_MISSING;if(null==e.geometry)return A.h.GEOMETRY_MISSING;switch(e.geometry.type){case"point":break;case"polygon":case"polyline":case"multipoint":case"extent":case"mesh":return A.h.SUPPORTED;default:return A.h.GEOMETRY_TYPE_UNSUPPORTED}const t=null!=e.symbol&&"point-3d"===e.symbol.type&&e.symbol.symbolLayers;return t&&t.some((e=>"object"===e.type))?"on-the-ground"!==(0,D.vu)(e)&&(0,D.Lt)(e)?A.h.ELEVATION_MODE_UNSUPPORTED:A.h.SUPPORTED:A.h.SYMBOL_TYPE_UNSUPPORTED}(e[0])===A.h.SUPPORTED){const o=e[0],s=o.geometry;if(null!=s&&("point"===s.type||"mesh"===s.type))return this._setupPointTransform3DOperation(o,t,i);if(null!=s&&("polygon"===s.type||"polyline"===s.type))return this._setupPolyTransform3DOperation(o,t,i,n)}return this._setupMove3DOperation(e,t,i,"transform",n)}async _setupPointTransform3DOperation(e,t,n){const o="transform",{enableRotation:s,enableScaling:r,enableZ:a}=t,l=await this._requireModule(Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(18208),i.e(93891),i.e(79841),i.e(43825),i.e(82845),i.e(52846),i.e(8455),i.e(72133),i.e(48044),i.e(48119),i.e(72997),i.e(20144),i.e(93151),i.e(36891),i.e(15601),i.e(232),i.e(92889),i.e(37727),i.e(56034),i.e(57486)]).then(i.bind(i,56034)));if(ye(l))return l;const{TransformTool3D:d,ManipulatedObject3DGraphic:u}=l.module,h=new u({graphic:e,view:n}),p=new d({object:h,view:n,enableRotation:s,enableScaling:r,enableZ:a,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});n.tools.add(p),this.updateGraphics.add(e);const y=[],g=new ee({activeComponent:p,tool:o,type:"update",onEnd:()=>{(0,c.yV)(y),pe(n,p),h.destroy()},undo:()=>{ue(this.view,p),le(g,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o})},redo:()=>{ce(g,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o})},addToSelection:async e=>{this.updateGraphics.add(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"}),g.onEnd(),g.destroy();const i=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,n,"transform",!0);ye(i)||this._setUpdateOperationHandle(i,t)},removeFromSelection:e=>{this.updateGraphics.remove(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"}),g.complete()},toggleTool:()=>{}});return y.push(...this._getHandlesForComponent(g,t),n.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(g,e,t)),F.f.WIDGET),n.on("key-down",(e=>{this._getCommonUpdateOperationKeyDownHandlers(g,e)}),F.f.WIDGET)),g}async _setupPolyTransform3DOperation(e,t,n,o=!1){const s="transform",{enableRotation:r,enableScaling:a,enableZ:l,preserveAspectRatio:d}=t,[u,h]=await Promise.all([this._requireModule(Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(18208),i.e(93891),i.e(79841),i.e(43825),i.e(82845),i.e(52846),i.e(8455),i.e(72133),i.e(48044),i.e(48119),i.e(72997),i.e(20144),i.e(93151),i.e(36891),i.e(15601),i.e(232),i.e(92889),i.e(37727),i.e(56034),i.e(57486)]).then(i.bind(i,56034))),(0,K.U)()]);if(ye(u))return u;const{ManipulatedObject3DGraphic:p,ExtentTransformTool:y}=u.module,g=this.view?.inputManager?.isModifierKeyDown(V.Sn.constraint),m=new p({view:n,graphic:e}),f=new y({object:m,view:n,enableRotation:r,enableScaling:a,enableZ:l,preserveAspectRatio:!!d!=!!g,sketchOptions:this.sketchOptions,automaticLengthMeasurementUtils:h});n.tools.add(f),o||this.updateGraphics.add(e);const v=[],b=new ee({activeComponent:f,tool:s,type:"update",onEnd:()=>{(0,c.yV)(v),pe(n,f),m.destroy()},canUndo:()=>!f.destroyed&&f.canUndo,undo:()=>{f.destroyed||(f.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:s}))},canRedo:()=>!f.destroyed&&f.canRedo,redo:()=>{f.destroyed||(f.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:s}))},addToSelection:async e=>{this.updateGraphics.add(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"}),b.onEnd(),b.destroy();const i=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,n,"transform",!0);ye(i)||this._setUpdateOperationHandle(i,t)},removeFromSelection:e=>{this.updateGraphics.remove(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"}),b.complete()},toggleTool:async()=>{if(1!==this.updateGraphics.length||!1===t.toggleToolOnClick)return;const i=await this._setupReshape3DOperation(e,t,n,!0);i&&!ye(i)&&(b.onEnd(),b.destroy(),this._setUpdateOperationHandle(i,t))}});return v.push(...this._getHandlesForComponent(b,t),n.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(b,e,t)),F.f.WIDGET),n.on("key-down",(e=>this._getCommonUpdateOperationKeyDownHandlers(b,e)),F.f.WIDGET),n.on("key-down",(e=>{e.key!==V.Sn.constraint||e.repeat||(f.preserveAspectRatio=!f.preserveAspectRatio,e.stopPropagation())}),F.f.WIDGET),n.on("key-up",(e=>{e.key===V.Sn.constraint&&(f.preserveAspectRatio=!f.preserveAspectRatio,e.stopPropagation())}),F.f.WIDGET)),b}async _setupMove2DOperation(e,t,i){const n="move";this.updateGraphics.addMany(e),await this._updatingHandles.addPromise(this._updateSpatialReference(e));const o=await this._getGraphicMover(e,t,i);if(ye(o))return o;const s=new ee({activeComponent:o,tool:n,type:"update",onEnd:()=>{this._displayDefaultCursor(),(0,c.yV)(l),(0,c.yV)(a),o.destroy(),this._internalGraphicsLayer?.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const e=this.updateGraphics.toArray();le(s,e),s.refreshComponent(),this._emitUndoEvent({graphics:e,tool:n})},redo:()=>{const e=this.updateGraphics.toArray();ce(s,e),s.refreshComponent(),this._emitRedoEvent({graphics:e,tool:n})},addToSelection:async e=>{await this._updatingHandles.addPromise(this._updateSpatialReference(e)),this.updateGraphics.push(e),o.graphics=this.updateGraphics.toArray(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:e=>{const t=this.updateGraphics.indexOf(e);s.history.undo.forEach((e=>e.updates.splice(t,1))),s.history.redo.forEach((e=>e.updates.splice(t,1))),this.updateGraphics.remove(e);const i=this.updateGraphics.toArray();this.emit("update",{graphics:i,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"}),0!==this.updateGraphics.length?o.graphics=i:s.complete()}});let r=!1;const a=[i.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(s,e,t)),F.f.WIDGET),i.on("key-down",(e=>{this._getCommonUpdateOperationKeyDownHandlers(s,e),e.key!==V.Sn.constraint||e.repeat||(r=!0,o.enableMoveAllGraphics=!o.enableMoveAllGraphics)}),F.f.WIDGET),i.on("key-up",(e=>{e.key===V.Sn.constraint&&r&&(r=!1,o.enableMoveAllGraphics=!o.enableMoveAllGraphics)}),F.f.WIDGET)],l=this._getHandlesForComponent(s,t);return s}async _setupReshape3DOperation(e,t,n,o=!1){const s="reshape",[r,a,l]=await Promise.all([this._requireModule(Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(18208),i.e(93891),i.e(79841),i.e(43825),i.e(82845),i.e(52846),i.e(8455),i.e(72133),i.e(48044),i.e(48119),i.e(72997),i.e(20144),i.e(93151),i.e(36891),i.e(15601),i.e(232),i.e(92889),i.e(37727),i.e(56034),i.e(57486)]).then(i.bind(i,56034))),(0,j.A)(),(0,K.U)()]);if(ye(r))return r;const{ManipulatedObject3DGraphic:d,ReshapeTool3D:u}=r.module,h=new d({view:n,graphic:e}),p=$(h);if(p!==A.h.SUPPORTED)return h.destroy(),this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${(0,A.O)(p)}).`),null;const y=t.reshapeOptions,g=new u({view:n,object:h,enableZVertex:t.enableZ&&"move"===y?.vertexOperation,enableZShape:t.enableZ&&"move"===y?.shapeOperation,enableMoveObject:"move"===y?.shapeOperation||"move-xy"===y?.shapeOperation,enableMidpoints:"split"===y?.edgeOperation,enableEdgeOffset:"offset"===y?.edgeOperation,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,automaticAreaMeasurementUtils:a,automaticLengthMeasurementUtils:l});n.tools.add(g),o||this.updateGraphics.add(h.graphic);const m=[],f=new ee({activeComponent:g,tool:s,type:"update",onEnd:()=>{(0,c.yV)(m),pe(n,g),h.destroy()},canUndo:()=>!g.destroyed&&g.canUndo,undo:()=>{g.destroyed||(g.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:s}))},canRedo:()=>!g.destroyed&&g.canRedo,redo:()=>{g.destroyed||(g.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:s}))},addToSelection:async e=>{this.updateGraphics.add(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"}),f.onEnd(),f.destroy();const i=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,n,"transform",!0);ye(i)||this._setUpdateOperationHandle(i,t)},removeFromSelection:e=>{this.updateGraphics.remove(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"}),f.complete()},toggleTool:async()=>{if(!1===t.toggleToolOnClick)return;f.onEnd(),f.destroy();const e=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),t,n,!0);ye(e)||this._setUpdateOperationHandle(e,t)}});return m.push(...this._getHandlesForComponent(f,t),n.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(f,e,t)),F.f.WIDGET),n.on("key-down",(e=>{this._getCommonUpdateOperationKeyDownHandlers(f,e)}),F.f.WIDGET)),f}async _setupTransformOrReshape2DOperation(e,t,i,n){this.updateGraphics.addMany(e),await this._updatingHandles.addPromise(this._updateSpatialReference(e));const o="transform"===t?await this._getBox(e,i,n):await this._getReshape(e,i,n);if(ye(o))return o;const s=new ee({activeComponent:o,type:"update",onEnd:()=>{(0,c.yV)(a),(0,c.yV)(r),s.activeComponent&&!s.activeComponent.destroyed&&s.activeComponent.destroy(),this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{le(s,this.updateGraphics.toArray()),s.refreshComponent(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:s.tool})},redo:()=>{ce(s,this.updateGraphics.toArray()),s.refreshComponent(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:s.tool})},addToSelection:async e=>{let t=s.activeComponent;if("reshape"===t?.type){const t=[...this.updateGraphics,e];this.updateGraphics.removeAll(),s.onEnd(),s.destroy();const o=await this._setupTransformOrReshape2DOperation(t,"transform",i,n);if(ye(o))return;this._setUpdateOperationHandle(o,i)}else this.updateGraphics.add(e),t.graphics=this.updateGraphics.toArray(),t.refresh(),s.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async e=>{const t=this.updateGraphics.indexOf(e);s.history.undo.forEach((e=>e.updates.splice(t,1))),s.history.redo.forEach((e=>e.updates.splice(t,1))),this.updateGraphics.remove(e);const i=this.updateGraphics.toArray();if(0===i.length)s.complete();else{const e=i[0].geometry;1!==i.length||null==e||"point"!==e.type&&"multipoint"!==e.type?s.activeComponent.graphics=i:s.toggleTool()}this.emit("update",{graphics:i,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"})},toggleTool:async()=>{if(this.updateGraphics.length>1)return;const e=this.updateGraphics.at(0),t=e.geometry;if(null!=t&&("reshape"===s.tool&&("point"===t.type||"multipoint"===t.type)||"transform"===s.tool&&"extent"===t.type))return;let o=null;"transform"===s.tool?o=await this._getReshape([e],i,n):"reshape"===s.tool&&(o=await this._getBox([e],i,n)),ye(o)||(s.activeComponent?.destroy(),s.activeComponent=o,s.activeComponent&&((0,c.yV)(a),a=this._getHandlesForComponent(s,i)))}}),r=[n.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(s,e,i)),F.f.WIDGET),n.on("key-down",(e=>{if(this._getCommonUpdateOperationKeyDownHandlers(s,e),e.key===V.Sn.constraint&&!e.repeat&&s){const e=s.activeComponent;e&&"box"===e.type&&(e.preserveAspectRatio=!e.preserveAspectRatio)}}),F.f.WIDGET),n.on("key-up",(e=>{if(e.key===V.Sn.constraint&&s){const e=s.activeComponent;e&&"box"===e.type&&(e.preserveAspectRatio=!e.preserveAspectRatio)}}),F.f.WIDGET)];let a=this._getHandlesForComponent(s,i);return s}async _getGraphicMover(e,t,n){const{enableMoveAllGraphics:o,highlightOptions:s}=t,r=await this._requireModule(i.e(54339).then(i.bind(i,54339)));return ye(r)?r:new r.module.default({enableMoveAllGraphics:o,highlightName:s?.name,highlightsEnabled:!!s?.enabled,indicatorsEnabled:!1,graphics:e,view:n,callbacks:{onGraphicMoveStart:({dx:e,dy:t,graphic:i})=>{this._displayGrabbingCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:e,dy:t,mover:i,type:"move-start"},type:"update"})},onGraphicMove:({dx:e,dy:t,graphic:i})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:e,dy:t,mover:i,type:"move"},type:"update"}),onGraphicMoveStop:({dx:e,dy:t,graphic:i})=>{this._displayPointerCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:e,dy:t,mover:i,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayMoveCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(e,t,n){const{enableRotation:o,enableScaling:s,highlightOptions:r,preserveAspectRatio:a}=t,[l,c]=await Promise.all([this._requireModule(Promise.all([i.e(52846),i.e(18530)]).then(i.bind(i,1499))),(0,K.U)()]);if(ye(l))return l;const d=this.view?.inputManager?.isModifierKeyDown(V.Sn.constraint);return new l.module.default({graphics:e,enableRotation:o,enableScaling:s,highlightName:r?.name,highlightsEnabled:!!r?.enabled,preserveAspectRatio:!!a!=!!d,layer:this._internalGraphicsLayer,view:n,sketchOptions:this.sketchOptions,automaticLengthMeasurementUtils:c,callbacks:{onMoveStart:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onMove:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onMoveStop:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onScaleStart:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onScale:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onScaleStop:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onRotateStart:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onRotate:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onRotateStop:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"})}})}async _getReshape(e,t,n){const{highlightOptions:o,reshapeOptions:s}=t,r="split"===s?.edgeOperation,a="move"===s?.shapeOperation,[l,c,d]=await Promise.all([this._requireModule(Promise.all([i.e(18208),i.e(52846),i.e(5648),i.e(17794)]).then(i.bind(i,20607))),(0,j.A)(),(0,K.U)()]);return ye(l)?l:new l.module.default({enableMidpoints:r,enableMovement:a,graphic:e[0],highlightName:o?.name,highlightsEnabled:!!o?.enabled,layer:this._internalGraphicsLayer,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,automaticAreaMeasurementUtils:c,automaticLengthMeasurementUtils:d,view:n,callbacks:{onReshapeStart:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onReshape:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onReshapeStop:({mover:e,type:t})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e,type:t},type:"update"}),onMoveStart:({dx:e,dy:t,mover:i,type:n})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:e,dy:t,mover:i,type:n},type:"update"}),onMove:({dx:e,dy:t,mover:i,type:n})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:e,dy:t,mover:i,type:n},type:"update"}),onMoveStop:({dx:e,dy:t,mover:i,type:n})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:e,dy:t,mover:i,type:n},type:"update"}),onVertexAdd:({added:e,type:t,vertices:i})=>{const n=e.map((e=>(0,S.nA)(e.geometry)));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:n,vertices:i,type:t},type:"update"})},onVertexRemove:({removed:e,type:t,vertices:i})=>{const n=e.map((e=>(0,S.nA)(e.geometry)));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:n,vertices:i,type:t},type:"update"})}}})}_getHandlesForComponent(e,t){const i=e.activeComponent;if(!i)return[];switch(i.type){case"graphic-mover":return[i.on("graphic-click",(({graphic:i,viewEvent:n})=>{n.native?.shiftKey&&t.multipleSelectionEnabled&&(n.stopPropagation(),e.removeFromSelection(i))})),i.on("graphic-move-start",(t=>e.addToHistory(he(t.allGraphics))))];case"box":return[i.on("graphic-click",(i=>this._onTransformOrReshape2DGraphicClick(e,t,i))),i.on("move-start",(t=>e.addToHistory(he(t.graphics)))),i.on("rotate-start",(t=>e.addToHistory(he(t.graphics)))),i.on("scale-start",(t=>e.addToHistory(he(t.graphics))))];case"reshape":return[i.on("graphic-click",(i=>this._onTransformOrReshape2DGraphicClick(e,t,i))),i.on("move-start",(t=>e.addToHistory(he([t.mover])))),i.on("reshape-start",(t=>e.addToHistory(he([t.graphic])))),i.on("vertex-add",(t=>e.addToHistory(he([t.oldGraphic])))),i.on("vertex-remove",(t=>e.addToHistory(he([t.oldGraphic]))))];case"move-3d":return[i.events.on("record-undo",(({updates:t})=>{e.addToHistory({updates:t})})),i.events.on("move-start",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:e.objects.length>0?e.objects[0].graphic:null,type:"move-start"},type:"update"})})),i.events.on("move",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:e.dx,dy:e.dy,mover:e.objects.length>0?e.objects[0].graphic:null,type:"move"},type:"update"})})),i.events.on("move-stop",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:e.objects.length>0?e.objects[0].graphic:null,type:"move-stop"},type:"update"})})),i.events.on("immediate-click",(i=>{i.shiftKey?this._toggleSelection([i.object.graphic],e,t):e.toggleTool()}))];case"transform-3d":return[i.events.on("record-undo",(({updates:t})=>{e.addToHistory({updates:t})})),i.events.on("translate-start",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.object.graphic,dx:e.dxScreen,dy:e.dyScreen,type:"move-start"},type:"update"})})),i.events.on("translate-stop",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.object.graphic,dx:e.dxScreen,dy:e.dyScreen,type:"move-stop"},type:"update"})})),i.events.on("rotate-start",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.object.graphic,angle:e.angle,type:"rotate-start"},type:"update"})})),i.events.on("rotate-stop",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.object.graphic,angle:e.angle,type:"rotate-stop"},type:"update"})})),i.events.on("scale-start",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.object.graphic,xScale:e.xScale,yScale:e.yScale,type:"scale-start"},type:"update"})})),i.events.on("scale-stop",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.object.graphic,xScale:e.xScale,yScale:e.yScale,type:"scale-stop"},type:"update"})})),i.events.on("translate",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.object.graphic,dx:e.dxScreen,dy:e.dyScreen,type:"move"},type:"update"})})),i.events.on("rotate",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.object.graphic,angle:e.angle,type:"rotate"},type:"update"})})),i.events.on("scale",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.object.graphic,xScale:e.xScale,yScale:e.yScale,type:"scale"},type:"update"})})),i.events.on("immediate-click",(i=>{i.shiftKey?this._toggleSelection([i.object.graphic],e,t):e.toggleTool()}))];case"reshape-3d":return[i.events.on("reshape",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e,mover:e.object.graphic},type:"update"})})),i.events.on("move",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e,mover:e.object.graphic},type:"update"})})),i.events.on("vertex-add",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:e,type:"update"})})),i.events.on("vertex-remove",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:e,type:"update"})})),i.events.on("immediate-click",(i=>{i.shiftKey?this._toggleSelection([i.object.graphic],e,t):e.toggleTool()}))]}}_onTransformOrReshape2DGraphicClick(e,t,i){const{graphic:n,viewEvent:o}=i;return o.native?.shiftKey&&n.layer===this.layer?(o.stopPropagation(),e.removeFromSelection(n)):t.toggleToolOnClick?(o.stopPropagation(),e.toggleTool()):void 0}_setUpdateOperationHandle(e,t){this._operationHandle=e;const i=this.view?.map;this._disablePopup(t);e.on("complete",(()=>{if(e===this._operationHandle){const n=this.updateGraphics.toArray(),o=this._operationHandle.tool;this._operationHandle.destroy(),this._operationHandle=null,this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()),this.updateGraphics.removeAll(),i&&i.remove(this._internalGraphicsLayer),this._restorePopup(t),this.emit("update",{graphics:n,state:"complete",aborted:e.cancelled,tool:o,toolEventInfo:null,type:"update"})}}))}async _getCommonUpdateOperationClickHandlers(e,t,i){const n=(0,q.vT)(t),o=await t.defer((()=>this._getFirstHit(n)));null!=o&&(t.native.shiftKey&&this._toggleSelection([o.graphic],e,i)||this.updateGraphics.includes(o.graphic))?t.stopPropagation():e.complete()}_toggleSelection(e,t,i){const n=!!i.multipleSelectionEnabled;return e.some((e=>!(null==e||!n||e.layer!==this.layer||(this.updateGraphics.includes(e)?t.removeFromSelection(e):t.addToSelection(e),0))))}_getCommonUpdateOperationKeyDownHandlers(e,t){if(!e)return;const i=t.key;i===V.Sn.undo&&e.canUndo()?(t.stopPropagation(),e.undo()):i===V.Sn.redo&&e.canRedo()?(t.stopPropagation(),e.redo()):i===V.Sn.cancel?(t.stopPropagation(),e.cancel()):this.allowDeleteKey&&V.Sn.delete.includes(i)&&this._onDeleteKey(t)}_onDeleteKey(e){if(!this._operationHandle||"update"!==this._operationHandle.type)return;const t=this.activeComponent,i=this.updateGraphics.toArray();null!=t&&("reshape"!==t.type||1===i.length&&"point"===i[0].geometry?.type)&&(e.stopPropagation(),this.delete())}_removeDefaultLayer(){this._internalGraphicsLayer&&(this.view?.map?.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=(0,u.SC)(this._internalGraphicsLayer))}_isComponentGraphic(e){const{activeComponent:t}=this;return!(!e||null==t)&&(e.attributes?.esriSketchTool||"draw-2d"===t.type&&t.graphic===e||("box"===t.type||"reshape"===t.type)&&t.isUIGraphic(e))}_displayPointerCursor(){this.view?.container&&"pointer"!==this.view.cursor&&(this.view.cursor="pointer")}_displayGrabbingCursor(){this.view?.container&&"grabbing"!==this.view.cursor&&(this.view.cursor="grabbing")}_displayMoveCursor(){this.view?.container&&"move"!==this.view.cursor&&(this.view.cursor="move")}_displayDefaultCursor(){this.view?.container&&null!==this.view.cursor&&(this.view.cursor=null)}_logError(e,t,i){d.Z.getLogger(this).error(new b.Z(e,t,i))}async _requireModule(e){const t=new AbortController;this._moduleLoaderAbortController=t;const i=await e;return this._moduleLoaderAbortController!==t||t.signal.aborted?{requireError:"aborted"}:{module:i}}_emitUndoEvent(e){this.emit("undo",{...e,type:"undo"})}_emitRedoEvent(e){this.emit("redo",{...e,type:"redo"})}_emitDeleteEvent(e){this.emit("delete",{...e,type:"delete"})}get test(){}wait(){return(0,p.N1)((()=>!this.updating))}_disablePopupEnabled(e){return"3d"!==this.view?.type||this.updateOnGraphicClick||(e?.toggleToolOnClick??!1)}_disablePopup(e){this._disablePopupEnabled(e)&&this.view&&null==this._originalPopupEnabled&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)}_restorePopup(e){this._disablePopupEnabled(e)&&this.view&&null!=this._originalPopupEnabled&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)}async _waitViewReady(){const e=this.view;e?((0,u.IM)(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await(0,h.Hl)((0,p.N1)((()=>e?.ready)),this._viewReadyAbortController.signal)):this._logMissingView()}_logMissingView(){this._logError("sketch:missing-property",re("view"))}_logMissingLayer(){this._logError(se,re("layer"))}};(0,a._)([(0,y.Cb)()],oe.prototype,"_defaultSnappingManager",void 0),(0,a._)([(0,y.Cb)()],oe.prototype,"updating",null),(0,a._)([(0,y.Cb)({readOnly:!0})],oe.prototype,"_updatingHandles",void 0),(0,a._)([(0,y.Cb)()],oe.prototype,"_operationHandle",void 0),(0,a._)([(0,y.Cb)({readOnly:!0})],oe.prototype,"activeTool",null),(0,a._)([(0,y.Cb)({readOnly:!0})],oe.prototype,"activeCreateToolDrawMode",null),(0,a._)([(0,y.Cb)()],oe.prototype,"activeTooltip",null),(0,a._)([(0,y.Cb)({types:P.LB})],oe.prototype,"activeFillSymbol",void 0),(0,a._)([(0,y.Cb)()],oe.prototype,"activeLineSymbol",void 0),(0,a._)([(0,y.Cb)()],oe.prototype,"activeVertexSymbol",void 0),(0,a._)([(0,y.Cb)()],oe.prototype,"allowDeleteKey",void 0),(0,a._)([(0,y.Cb)({readOnly:!0})],oe.prototype,"createGraphic",null),(0,a._)([(0,y.Cb)()],oe.prototype,"defaultCreateOptions",null),(0,a._)([(0,y.Cb)()],oe.prototype,"defaultUpdateOptions",null),(0,a._)([(0,y.Cb)({type:z.Z,nonNullable:!0})],oe.prototype,"labelOptions",null),(0,a._)([(0,y.Cb)()],oe.prototype,"layer",void 0),(0,a._)([(0,y.Cb)({types:P.LB})],oe.prototype,"pointSymbol",void 0),(0,a._)([(0,y.Cb)({types:P.LB})],oe.prototype,"polygonSymbol",void 0),(0,a._)([(0,y.Cb)({types:P.LB})],oe.prototype,"polylineSymbol",void 0),(0,a._)([(0,y.Cb)()],oe.prototype,"meshSymbol",void 0),(0,a._)([(0,y.Cb)({type:H.Z,nonNullable:!0})],oe.prototype,"snappingOptions",null),(0,a._)([(0,y.Cb)()],oe.prototype,"snappingManager",null),(0,a._)([(0,y.Cb)({readOnly:!0})],oe.prototype,"state",null),(0,a._)([(0,y.Cb)({type:B.Z,nonNullable:!0})],oe.prototype,"tooltipOptions",null),(0,a._)([(0,y.Cb)({readOnly:!0})],oe.prototype,"updateGraphics",void 0),(0,a._)([(0,y.Cb)()],oe.prototype,"updateOnGraphicClick",void 0),(0,a._)([(0,y.Cb)()],oe.prototype,"creationMode",void 0),(0,a._)([(0,y.Cb)({type:m.Z,nonNullable:!0})],oe.prototype,"valueOptions",null),(0,a._)([(0,y.Cb)({types:P.LB})],oe.prototype,"vertexSymbol",void 0),(0,a._)([(0,y.Cb)({value:null})],oe.prototype,"view",null),(0,a._)([(0,y.Cb)({constructOnly:!0,type:Z.Z})],oe.prototype,"sketchOptions",void 0),oe=(0,a._)([(0,g.j)("esri.widgets.Sketch.SketchViewModel")],oe);const se="sketch:missing-property",re=e=>`Property '${e}' is missing on SketchViewModel.`;function ae(e){return"polygon"===e||"rectangle"===e||"circle"===e}function le(e,t){de("undo",e.history.undo,e.history.redo,t)}function ce(e,t){de("redo",e.history.redo,e.history.undo,t)}function de(e,t,i,n){const o=t.pop();if(!o)return;const s=o.updates,r=[];n.forEach(((t,i)=>{const n=s[i];null!=n&&("geometry"in n&&null!=n.geometry&&(r.push({geometry:t.geometry}),t.geometry=n.geometry),"symbol"in n&&null!=n.symbol&&(r.push({symbol:t.symbol}),t.symbol=n.symbol),"undo"in n&&(r.push(n),n[e](t)))})),i.push({updates:r})}function ue(e,t){null!=e&&t.hasGrabbedManipulators&&(e.activeTool=null)}function he(e){return{updates:e.map((({geometry:e})=>"mesh"===e?.type?{geometry:e.cloneShallow()}:{geometry:e}))}}function pe(e,t){e.tools?.remove(t),t.destroyed||t.destroy()}function ye(e){return"requireError"in e&&"aborted"===e.requireError}var ge=i(70880),me=i(88512);let fe=class extends ge.Z{constructor(e){super(e),this.enabledToggle=!0,this.featureEnabledToggle=!0,this.gridEnabledToggle=!0,this.header=!1,this.layerList=!0,this.gridControls=!0,this.gridControlsElements=new me.Z({gridSnapEnabledToggle:!1,gridEnabledToggle:!1}),this.layerListToggleLayersButton=!0,this.selfEnabledToggle=!0}};(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],fe.prototype,"enabledToggle",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],fe.prototype,"featureEnabledToggle",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],fe.prototype,"gridEnabledToggle",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],fe.prototype,"header",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],fe.prototype,"layerList",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],fe.prototype,"gridControls",void 0),(0,a._)([(0,y.Cb)({type:me.Z,nonNullable:!0})],fe.prototype,"gridControlsElements",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],fe.prototype,"layerListToggleLayersButton",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],fe.prototype,"selfEnabledToggle",void 0),fe=(0,a._)([(0,g.j)("esri.widgets.support.SnappingControls.VisibleElements")],fe);const ve=fe;let be=class extends ge.Z{constructor(e){super(e),this.point=!0,this.polyline=!0,this.polygon=!0,this.rectangle=!0,this.circle=!0,this.multipoint=!0,this.mesh=!0,this.freehandPolyline=!1,this.freehandPolygon=!1}};(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],be.prototype,"point",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],be.prototype,"polyline",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],be.prototype,"polygon",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],be.prototype,"rectangle",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],be.prototype,"circle",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],be.prototype,"multipoint",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],be.prototype,"mesh",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],be.prototype,"freehandPolyline",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],be.prototype,"freehandPolygon",void 0),be=(0,a._)([(0,g.j)("esri.widgets.Sketch.VisibleElements.CreateToolVisibilityMap")],be);let _e=class extends ge.Z{constructor(e){super(e),this["rectangle-selection"]=!0,this["lasso-selection"]=!0,this["custom-selection"]=!0}};(0,a._)([(0,y.Cb)({nonNullable:!0})],_e.prototype,"rectangle-selection",void 0),(0,a._)([(0,y.Cb)({nonNullable:!0})],_e.prototype,"lasso-selection",void 0),(0,a._)([(0,y.Cb)({nonNullable:!0})],_e.prototype,"custom-selection",void 0),_e=(0,a._)([(0,g.j)("esri.widgets.Sketch.VisibleElements.SelectionToolVisibilityMap")],_e);let we=class extends ge.Z{constructor(e){super(e),this.createTools=new be,this.directionModePicker=!1,this.duplicateButton=!0,this.deleteButton=!0,this.selectionCountLabel=!0,this.labelsToggle=!0,this.selectionTools=new _e,this.settingsMenu=!0,this.snappingControls=!0,this.snappingControlsElements=new ve,this.tooltipsToggle=!0,this.undoRedoMenu=!0}};(0,a._)([(0,y.Cb)({type:be,nonNullable:!0})],we.prototype,"createTools",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],we.prototype,"directionModePicker",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],we.prototype,"duplicateButton",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],we.prototype,"deleteButton",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],we.prototype,"selectionCountLabel",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],we.prototype,"labelsToggle",void 0),(0,a._)([(0,y.Cb)({type:_e,nonNullable:!0})],we.prototype,"selectionTools",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],we.prototype,"settingsMenu",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],we.prototype,"snappingControls",void 0),(0,a._)([(0,y.Cb)({type:ve,nonNullable:!0})],we.prototype,"snappingControlsElements",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],we.prototype,"tooltipsToggle",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],we.prototype,"undoRedoMenu",void 0),we=(0,a._)([(0,g.j)("esri.widgets.Sketch.VisibleElements")],we);const Ce=1,xe={s:32,m:48,l:64},Se={horizontal:{s:16,m:16,l:24},vertical:{s:16,m:24,l:40}},Ee={splitButton:{horizontal:"chevron-down",vertical:"ellipsis"},overflow:"ellipsis"};function ke(e,t){return e.vnodeSelector===t?[e]:e.children?.flatMap((e=>ke(e,t)))??[]}const Le=e=>{let t=class extends e{constructor(){super(...arguments),this.priority=0,this.scale="m",this.slot=void 0,this.lastActiveKey=null,this.layout="horizontal"}destroy(){this.measurementManager?.managedElements.remove(this),this.measurementManager=null}set measurementManager(e){const t=this._get("measurementManager");e!==t&&(t&&t.managedElements.remove(this),this._set("measurementManager",e),e?.managedElements.add(this))}set budgetedLength(e){this.budgetedLength!==e&&(this._set("budgetedLength",e),this.scheduleRender())}get actionChildren(){return this.children?.flatMap((e=>ke(e,"calcite-action")))??[]}get activeChildElement(){const e=this.actionChildren.find((e=>!0===e.properties?.active));return e?(this._set("lastActiveKey",e.properties?.key),e):this.lastActiveKey?this.actionChildren.find((e=>e.properties?.key===this.lastActiveKey)):void 0}_handleClick(e){e?.dataset&&"dataset"in e&&e.dataset.actionKey&&(this.lastActiveKey=e.dataset.actionKey)}};return(0,a._)([(0,y.Cb)()],t.prototype,"priority",void 0),(0,a._)([(0,y.Cb)()],t.prototype,"measurementManager",null),(0,a._)([(0,y.Cb)()],t.prototype,"budgetedLength",null),(0,a._)([(0,y.Cb)()],t.prototype,"actionChildren",null),(0,a._)([(0,y.Cb)()],t.prototype,"activeChildElement",null),(0,a._)([(0,y.Cb)()],t.prototype,"scale",void 0),(0,a._)([(0,y.Cb)()],t.prototype,"slot",void 0),(0,a._)([(0,y.Cb)()],t.prototype,"lastActiveKey",void 0),(0,a._)([(0,y.Cb)()],t.prototype,"layout",void 0),t=(0,a._)([(0,g.j)("esri.widgets.Sketch.support.ResponsiveToolbar.ToolbarGroupBase")],t),t};var Te=i(68808),Me=i(23039);const Ie=Symbol("on-resize-handle-key");let Oe=class extends(Le(f.Z)){constructor(e){super(e),this._measuredWidth=0,this._measuredHeight=0,this._measuredElement=null}destroy(){this._measuredElement=null}get lengthOptions(){return["horizontal"===this.layout?this._measuredWidth:this._measuredHeight]}render(){return(0,Me.u)("div",{afterCreate:e=>{this._measuredElement=e.firstElementChild,this.addHandles((0,Te.ib)(this._measuredElement,(()=>{this._measuredWidth=this._measuredElement?.clientWidth??0,this._measuredHeight=this._measuredElement?.clientHeight??0})),Ie)},afterRemoved:()=>this.removeHandles(Ie)},this.children)}};(0,a._)([(0,y.Cb)()],Oe.prototype,"_measuredWidth",void 0),(0,a._)([(0,y.Cb)()],Oe.prototype,"_measuredHeight",void 0),(0,a._)([(0,y.Cb)()],Oe.prototype,"lengthOptions",null),(0,a._)([(0,y.Cb)()],Oe.prototype,"_measuredElement",void 0),Oe=(0,a._)([(0,g.j)("esri.widgets.Sketch.support.ResponsiveToolbar.MeasuredContentGroup")],Oe);var Pe=i(84644),Ae=i(24225);let Re=class extends(Le(f.Z)){constructor(e){super(e),this.allowCollapse=!0,this.messagesCommon=null}loadDependencies(){return(0,Pe.h)({action:()=>i.e(77606).then(i.bind(i,11030)),"action-group":()=>Promise.all([i.e(62737),i.e(32029),i.e(79767),i.e(22655)]).then(i.bind(i,22655)),"action-menu":()=>Promise.all([i.e(62737),i.e(32029),i.e(79767)]).then(i.bind(i,79767))})}static{this.vnodeSelector="calcite-action-group"}get minimumLength(){const{actionChildren:e,scale:t}=this;return e.length?this.allowCollapse?Ce+xe[t]*Math.min(e.length,2):Ce+xe[t]*e.length:0}get lengthOptions(){const{actionChildren:e,scale:t,minimumLength:i,allowCollapse:n,priority:o}=this,s=[i];if(e.length<=2||!n||o<1)return s;for(let n=1;n<e.length-1;n++)s.push(i+xe[t]*n);return s}render(){if(!this.actionChildren.length)return(0,Me.u)(Me.D,null,void 0);const{budgetedLength:e,actionChildren:t,activeChildElement:i,layout:n,slot:o,scale:s}=this,r=Math.floor(e/xe[s]),a=[],l=[];if(r>=t.length)a.push(...t);else{const e=i??a.at(0);if(a.push(...t.slice(0,r-1)),l.push(...t.slice(r-1)),e&&l.includes(e)){const[t]=l.splice(l.indexOf(e),1),i=a.pop();a.push(t),i&&l.unshift(i)}}return(0,Me.u)("calcite-action-group",{key:"overflow-button-group",layout:n,onclick:e=>this._handleClick(e.target),slot:o},a.map((e=>this._renderManagedAction(e))),l.length>0?(0,Me.u)("calcite-action-menu",{key:"split-button-dropdown",label:this.messagesCommon.more,overlayPositioning:"fixed"},(0,Me.u)("calcite-action",{icon:Ee.overflow,key:"split-button-dropdown-trigger",scale:s,slot:"trigger",text:this.messagesCommon.more}),l.map((e=>this._renderManagedAction(e)))):void 0)}_renderManagedAction(e){return(0,Me.u)("calcite-action",{...e?.properties,"data-action-key":e?.properties?.key,text:e?.properties?.text??""})}};(0,a._)([(0,y.Cb)()],Re.prototype,"allowCollapse",void 0),(0,a._)([(0,y.Cb)()],Re.prototype,"minimumLength",null),(0,a._)([(0,y.Cb)(),(0,Ae.H)("esri/t9n/common")],Re.prototype,"messagesCommon",void 0),(0,a._)([(0,y.Cb)()],Re.prototype,"lengthOptions",null),Re=(0,a._)([(0,g.j)("esri.widgets.Sketch.support.ResponsiveToolbar.OverflowGroup")],Re);let De=class extends ge.Z{constructor(){super(...arguments),this.measuredElement=null,this.managedElements=new v.Z,this.availableLength=0,this.layout="horizontal",this._resizeObserver=new ResizeObserver((()=>{this._measure()}))}get _sortedElements(){return[...this.managedElements].sort(((e,t)=>t.priority-e.priority))}connect(e){this._resizeObserver.disconnect(),this.measuredElement=e,this._resizeObserver.observe(e),this._measure()}allocate(){const e=new Map,{availableLength:t,_sortedElements:i}=this;let n=0;for(const t of i){const i=t.lengthOptions[0];e.set(t,i),n+=i}for(const o of i)for(;n<t;){const i=e.get(o);if(!i)break;const s=o.lengthOptions.find((e=>e>i));if(!s)break;const r=n-i+s;if(r>t)break;e.set(o,s),n=r}for(const[t,i]of e)t.budgetedLength=i}_measure(){const e=this.measuredElement;this.availableLength=e?"horizontal"===this.layout?e.clientWidth??0:e.clientHeight??0:0,this.allocate()}destroy(){this._resizeObserver.disconnect()}};(0,a._)([(0,y.Cb)()],De.prototype,"measuredElement",void 0),(0,a._)([(0,y.Cb)()],De.prototype,"managedElements",void 0),(0,a._)([(0,y.Cb)()],De.prototype,"_sortedElements",null),(0,a._)([(0,y.Cb)()],De.prototype,"availableLength",void 0),(0,a._)([(0,y.Cb)()],De.prototype,"layout",void 0),De=(0,a._)([(0,g.j)("esri.widgets.Sketch.support.ResponsiveToolbar.ResponsiveToolbarManager")],De);const $e="esri-split-button--split-part";let Ne=class extends(Le(f.Z)){constructor(e){super(e),this.allowCollapse=!0,this.messagesCommon=null}loadDependencies(){return(0,Pe.h)({action:()=>i.e(77606).then(i.bind(i,11030)),"action-group":()=>Promise.all([i.e(62737),i.e(32029),i.e(79767),i.e(22655)]).then(i.bind(i,22655)),"action-menu":()=>Promise.all([i.e(62737),i.e(32029),i.e(79767)]).then(i.bind(i,79767))})}static{this.vnodeSelector="calcite-action-group"}get minimumLength(){const e=this.actionChildren;return e.length?1===e.length?xe[this.scale]+Ce:this.allowCollapse?xe[this.scale]+Se[this.layout][this.scale]+Ce:xe[this.scale]*e.length+Ce:0}get lengthOptions(){const{actionChildren:e,minimumLength:t,layout:i,scale:n,priority:o,allowCollapse:s}=this;if(e.length<2||o<0||!s)return[t];const r=Ce+xe[n]*e.length;return[Ce+xe[n]+Se[i][n],r]}render(){if(!this.actionChildren.length)return(0,Me.u)(Me.D,null,void 0);const{actionChildren:e,minimumLength:t,budgetedLength:i,layout:n,slot:o,allowCollapse:s}=this,r=!s||e.length<2||i>t;return(0,Me.u)("calcite-action-group",{key:"split-button-group",layout:n,onclick:e=>this._handleClick(e.target),slot:o},r?this._renderUnSplit():this._renderSplit())}_renderSplit(){const{activeChildElement:e,layout:t,actionChildren:i,scale:n,messagesCommon:o}=this,s=e??i.at(0);if(!s)return;const r=i.filter((e=>e!==s));return[this._renderManagedAction(s),(0,Me.u)("calcite-action-menu",{key:"split-button-dropdown",label:o.more,overlayPositioning:"fixed",placement:"horizontal"===t?"bottom-end":"right-end"},(0,Me.u)("calcite-action",{class:`${$e}--${t}--${this.scale}`,compact:"horizontal"===t,icon:Ee.splitButton[t],key:"split-button-dropdown-trigger",scale:n,slot:"trigger",text:o.more}),r?.map((e=>this._renderManagedAction(e))))]}_renderUnSplit(){return this.actionChildren.map((e=>this._renderManagedAction(e)))}_renderManagedAction(e){return(0,Me.u)("calcite-action",{...e?.properties,"data-action-key":e?.properties?.key,text:e?.properties?.text??""})}};(0,a._)([(0,y.Cb)()],Ne.prototype,"minimumLength",null),(0,a._)([(0,y.Cb)()],Ne.prototype,"allowCollapse",void 0),(0,a._)([(0,y.Cb)()],Ne.prototype,"lengthOptions",null),(0,a._)([(0,y.Cb)(),(0,Ae.H)("esri/t9n/common")],Ne.prototype,"messagesCommon",void 0),Ne=(0,a._)([(0,g.j)("esri.widgets.Sketch.support.ResponsiveToolbar.SplitButton")],Ne);const Fe="esri-responsive-toolbar",Ve={rulerBase:`${Fe}__ruler`,rulerBarHorizontal:`${Fe}__ruler--bar`,rulerBarVertical:`${Fe}__ruler--bar--vertical`,rulerPadVertical:`${Fe}__ruler--pad--vertical`,rulerPadHorizontal:`${Fe}__ruler--pad--horizontal`,bar:`${Fe}__bar`,barHorizontal:`${Fe}__bar--horizontal`,barVertical:`${Fe}__bar--vertical`,pad:`${Fe}__pad`,padVertical:`${Fe}__pad--vertical`,padHorizontal:`${Fe}__pad--horizontal`};let ze=class extends f.Z{constructor(e){super(e),this.scale="m",this.barStyle="floating",this._measurementManager=new De,this._managedWidgets=new Map}loadDependencies(){return(0,Pe.h)({"action-bar":()=>Promise.all([i.e(62737),i.e(32029),i.e(79767),i.e(4649)]).then(i.bind(i,4649))})}destroy(){this._measurementManager=(0,u.SC)(this._measurementManager),this._managedWidgets.forEach((e=>e.destroy())),this._managedWidgets.clear()}set layout(e){const t=this._get("layout");this._set("layout",e),this._measurementManager&&(this._measurementManager.layout=e),t!==e&&this.scheduleRender()}get _barClasses(){const e="docked"===this.barStyle,t="vertical"===this.layout;return{[Ve.barHorizontal]:e&&!t,[Ve.barVertical]:e&&t,[Ve.bar]:e,[Ve.padHorizontal]:!e&&!t,[Ve.padVertical]:!e&&t,[Ve.pad]:!e}}render(){const{layout:e,scale:t,barStyle:i}=this,n={layout:e,scale:t,expandDisabled:!0,key:"measured-toolbar"},o="docked"===i?"vertical"===e?Ve.rulerBarVertical:Ve.rulerBarHorizontal:"horizontal"===e?Ve.rulerPadHorizontal:Ve.rulerPadVertical;return(0,Me.u)("div",null,(0,Me.u)("div",{afterCreate:e=>{this._measurementManager?.connect(e)},class:this.classes(Ve.rulerBase,o)}),(0,Me.u)("calcite-action-bar",{...n,classes:this._barClasses,floating:"docked"!==i,overflowActionsDisabled:!0},this._renderChildren()))}_renderChildren(){if(!this.children)return;const e=this.children.filter((e=>void 0!==e.properties?.key&&"group-kind"in e.properties)),t=new Set,i=e.map((e=>{const i=e.properties,n=i.key;t.add(n);const o="docked"===this.barStyle?i.slot??void 0:void 0,s=i.priority??0,r=i["group-kind"]??"overflow-group",a=i["allow-collapse"]??!0,l=this._managedWidgets.get(n);if(l)return l.children=e.children,l.priority=s,"allowCollapse"in l&&(l.allowCollapse=a),l.slot=o,l.layout=this.layout,l.scale=this.scale,l.measurementManager=this._measurementManager,l;const c={scale:this.scale,priority:s,measurementManager:this._measurementManager,children:e.children,slot:o,layout:this.layout};switch(r){case"split-button":{const e=new Ne({...c,allowCollapse:a});return this._managedWidgets.set(n,e),e}case"overflow-group":{const e=new Re({...c,allowCollapse:a});return this._managedWidgets.set(n,e),e}case"measured-content":{const e=new Oe({...c});return this._managedWidgets.set(n,e),e}}})).filter(l.pC);return Array.from(this._managedWidgets.keys()).filter((e=>!t.has(e))).forEach((e=>{this._managedWidgets.get(e)?.destroy(),this._managedWidgets.delete(e)})),this._measurementManager?.allocate(),i.map((e=>e.render()))}};(0,a._)([(0,y.Cb)()],ze.prototype,"scale",void 0),(0,a._)([(0,y.Cb)({value:"horizontal"})],ze.prototype,"layout",null),(0,a._)([(0,y.Cb)()],ze.prototype,"barStyle",void 0),(0,a._)([(0,y.Cb)()],ze.prototype,"_measurementManager",void 0),(0,a._)([(0,y.Cb)()],ze.prototype,"_managedWidgets",void 0),(0,a._)([(0,y.Cb)()],ze.prototype,"_barClasses",null),ze=(0,a._)([(0,g.j)("esri.widgets.Sketch.support.ResponsiveToolbar.ResponsiveToolbar")],ze);var Ze=i(85168),Be=i(46512),Ue=i(27546),He=i(29292),Ge=i(96094),je=i(60508),Ke=i(67764),We=i(76554),Ye=i(71730),qe=i(54318);async function Xe(e){const{returnFeatureTitleFields:t,returnGeometry:i,selector:n,signal:o,sources:s,view:r}=e;if(!s?.length)return[];const{layers:a,layerViews:l,graphicsLayers:c}=function(e){const t=[],i=[],n=[];return e.forEach((e=>{(0,k.Te)(e)||(0,k.e9)(e)||(0,k.Hd)(e)?t.push(e):((0,k.Q2)(e)||(0,k.Ux)(e))&&e.layers?.length?t.push(...e.layers.toArray()):(0,k.aw)(e)&&e.sublayers?.length?n.push(...e.sublayers.toArray()):(0,k.ik)(e)?n.push(e):(0,Ue.Xi)(e)&&i.push(e)})),{layers:t,layerViews:i,graphicsLayers:n}}(s),d=[];return await(0,h.R8)((0,h.Hl)(Promise.all([Qe({candidates:d,layers:a,returnFeatureTitleFields:t,returnGeometry:i,selector:n,signal:o,view:r}),Je({candidates:d,layerViews:l,returnGeometry:i,selector:n,signal:o,view:r}),tt({candidates:d,graphicsLayers:c,selector:n})]),o)),d}async function Je(e){const{candidates:t,layerViews:i,returnGeometry:n,selector:o,signal:s,view:r}=e;"point"!==o.type?await(0,h.Hl)(Promise.allSettled(i.map((async e=>{const i=function(e,t,i,n=!0){const o=e.createQuery();return o.outFields=["*"],o.geometry=et(t,e.layer,i),o.returnGeometry=n,o.outSpatialReference=i.spatialReference,o}(e,o,r,n),a=await e.queryFeatures(i,{signal:s});(0,l.w6)(t,a.features)}))),s):await async function({candidates:e,layerViews:t,selector:i,view:n}){const o=n.toScreen(i);if(!o)return;const s=t.map((e=>e.layer)),{results:r}=await n.hitTest(o,{include:s});r.forEach((t=>{"graphic"in t&&t.graphic&&e.push(t.graphic)}))}({candidates:t,layerViews:i,selector:o,view:r})}async function Qe(e){const{candidates:t,layers:i,returnFeatureTitleFields:n,returnGeometry:o,selector:s,signal:r,view:a}=e;await(0,h.Hl)(Promise.allSettled(i.map((async e=>{if("isTable"in e&&e.isTable)return;const i=function(e,t,i,n=!1,o=!0){const s=e.createQuery();return s.outFields=function(e,t,i){const{fields:n,fieldsIndex:o}=e,s=new Set([e.objectIdField]);"globalIdField"in e&&null!=e.globalIdField&&o.has(e.globalIdField)&&s.add(o.get(e.globalIdField).name);const r="displayField"in e?e.displayField:null,a=(0,We.O5)({displayField:r,fields:n});if(null!=a&&o.has(a)&&s.add(a),"subtypeField"in e&&null!=e.subtypeField){const i=o.get(e.subtypeField)?.name;if(null!=i&&s.add(i),"utilityNetworks"in t.map&&t.map.utilityNetworks?.length){const e=o.get("assetgroup");e?.name&&s.add(e.name);const t=o.get("assettype");t?.name&&s.add(t.name)}}return(i||t.requiredFieldsOptions.featureTitleFields)&&"featureTitleFields"in e&&e.featureTitleFields&&e.featureTitleFields.forEach((e=>s.add(e))),Array.from(s.values())}(e,i,n),s.geometry=et(t,e,i),s.returnGeometry=o,s.outSpatialReference=i.spatialReference,s}(e,s,a,n,o),c=await e.queryFeatures(i,{signal:r});(0,l.w6)(t,c.features)}))),r)}function et(e,t,i){return"point"===e.type?(0,qe.K)(e,"renderer"in t?(0,Ye.k)({renderer:t.renderer}):0,i):e}async function tt(e){const{candidates:t,graphicsLayers:n,selector:o}=e,s=n.flatMap((e=>e.graphics.toArray()))??[];if(!s?.length||!o)return;const r=await Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(60629)]).then(i.bind(i,98379));r.accelerateGeometry(o),s.forEach((e=>{e.geometry&&"mesh"!==e.geometry.type&&r.execute(o,e.geometry)&&t.push(e)}))}let it=class extends _.Z.EventedAccessor{constructor(e){super(e),this._completed=!1,this._isConstraintKeyDown=!1,this._processTask=null,this.createTool="rectangle",this.mode=null,this.persistSelection=!0,this.returnFeatureTitleFields=!1,this.returnGeometry=!0,this.selection=new v.Z,this.selectionManager=null,this.selectOnComplete=!0,this.sources=null,this.toolName="",this.type="add",this._process=(0,h.Ds)((async(e,t)=>{const{callback:i,selector:n,completed:o}=e,s=(0,He.vr)((async e=>{const{effectiveSelectionManager:t,returnFeatureTitleFields:s,returnGeometry:r,selection:a,sources:l,view:c}=this;if((l?.length||t.sources.length)&&c){if(n&&null!=l){const i=await Xe({returnFeatureTitleFields:s,returnGeometry:r,selector:n,signal:e,sources:l,view:c});if(a.removeAll(),a.addMany(i),o&&this.persistSelection)switch(this.effectiveType){case"remove":t.updateSelection({current:[],added:[],removed:i});break;case"replace":t.clear(),t.updateSelection({current:i,added:[],removed:[]});break;default:t.updateSelection({current:i,added:[],removed:[]})}}i&&i()}else a.removeAll()}));return(0,h.fu)(t,(()=>s.abort())),this._processTask=s,s.promise}),100),this._onOperationFinish=this._onOperationFinish.bind(this)}initialize(){this._setup()}get _defaultMode(){return"polygon"===this.createTool?"click":"hybrid"}get _selectionArea(){const e=this._tool.coordinates;if(0===e.length)return;const t=(0,Ge.vW)(),i=this.view.spatialReference,n=e=>{t.x=e[0],t.y=e[1];const i=this.view.toMap(t);return[i?.x??0,i?.y??0]};if(1===e.length||e.every((([t,i])=>t===e[0][0]&&i===e[0][1]))){const[t,o]=n(e[0]);return new je.Z({x:t,y:o,spatialReference:i})}const o=e.map(n);return 0!==o.length?((0,S.bu)(o)||o.reverse(),new Ke.Z({spatialReference:i,rings:[o]})):void 0}get completed(){return this._completed}get effectiveSelectionManager(){return this.selectionManager??this.view.selectionManager}get effectiveType(){const e=this.type??"add";if(this._isConstraintKeyDown)switch(e){case"add":return"remove";case"remove":case"replace":return"add";default:return e}return e}get processingFinalSelection(){return!(!this._processTask||!this._tool?.drawOperation?.isCompleted)}cancel(){this.selection.removeAll(),this._onOperationFinish(!0)}destroy(){this._toolImportController=(0,u.IM)(this._toolImportController)}async _setup(){const{createTool:e,view:t}=this;if(await t.whenReady(),this.destroyed||this._toolImportController)return;const n=new AbortController;this._toolImportController=n;const[o,s]=await Promise.all([Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(18208),i.e(48044),i.e(72997),i.e(22860)]).then(i.bind(i,76473)),(0,K.U)()]);if(n.signal.aborted)return;const r=Symbol();try{this._tool=new o.DrawScreenTool({view:t,mode:this.mode??this._defaultMode,geometryType:e,cursor:"point"===e?"default":"crosshair",automaticLengthMeasurementUtils:s})}finally{this._toolImportController=null}this._tool?(this.selectOnComplete||this.addHandles(this._tool.on(["cursor-update","vertex-add","vertex-remove"],(()=>{this._syncConstraintKeyDown(),(0,h.R8)(this._process({selector:this._selectionArea}))})),r),this.addHandles([t.on("key-down",(e=>{if(!e.repeat)switch(e.key){case V.Sn.constraint:this._tool.uniformSizeToggled=!0,e.stopPropagation();break;case V.Sn.center:this._tool.centeredToggled=!0,e.stopPropagation()}})),t.on("key-up",(e=>{switch(e.key){case V.Sn.constraint:this._tool.uniformSizeToggled=!1,e.stopPropagation();break;case V.Sn.center:this._tool.centeredToggled=!1,e.stopPropagation()}})),this.selection.on("change",(({added:e,removed:t})=>this.emit("selection-change",{operationType:this.effectiveType,added:e,removed:t}))),this._tool.on("complete",(async e=>{this._syncConstraintKeyDown(),this.removeHandles(r),e.aborted?this.cancel():(this._tool.cursor="progress",await this._process({selector:this._selectionArea,callback:this._onOperationFinish,completed:!0}))}))],r),this.addHandles((0,c.kB)((()=>t.tools.remove(this._tool)))),t.addAndActivateTool(this._tool)):d.Z.getLogger(this).warn("Unable to import Draw module. SelectionOperation failed to load.")}_syncConstraintKeyDown(){const{inputManager:e}=this.view;this._isConstraintKeyDown=V.a8.invertType.some((t=>e.isModifierKeyDown(t)))}_onOperationFinish(e=!1){this.removeAllHandles(),this._processTask?.abort(),this.emit("complete",{aborted:e,operationType:this.effectiveType,selection:this.selection.toArray(),toolName:this.toolName}),this._completed=!0}};(0,a._)([(0,y.Cb)()],it.prototype,"_completed",void 0),(0,a._)([(0,y.Cb)()],it.prototype,"_defaultMode",null),(0,a._)([(0,y.Cb)()],it.prototype,"_isConstraintKeyDown",void 0),(0,a._)([(0,y.Cb)()],it.prototype,"_processTask",void 0),(0,a._)([(0,y.Cb)()],it.prototype,"_selectionArea",null),(0,a._)([(0,y.Cb)()],it.prototype,"completed",null),(0,a._)([(0,y.Cb)({constructOnly:!0})],it.prototype,"createTool",void 0),(0,a._)([(0,y.Cb)()],it.prototype,"effectiveSelectionManager",null),(0,a._)([(0,y.Cb)()],it.prototype,"effectiveType",null),(0,a._)([(0,y.Cb)({constructOnly:!0})],it.prototype,"mode",void 0),(0,a._)([(0,y.Cb)()],it.prototype,"persistSelection",void 0),(0,a._)([(0,y.Cb)()],it.prototype,"processingFinalSelection",null),(0,a._)([(0,y.Cb)()],it.prototype,"returnFeatureTitleFields",void 0),(0,a._)([(0,y.Cb)()],it.prototype,"returnGeometry",void 0),(0,a._)([(0,y.Cb)({readOnly:!0})],it.prototype,"selection",void 0),(0,a._)([(0,y.Cb)({constructOnly:!0})],it.prototype,"selectionManager",void 0),(0,a._)([(0,y.Cb)({constructOnly:!0})],it.prototype,"selectOnComplete",void 0),(0,a._)([(0,y.Cb)()],it.prototype,"sources",void 0),(0,a._)([(0,y.Cb)({constructOnly:!0})],it.prototype,"toolName",void 0),(0,a._)([(0,y.Cb)({constructOnly:!0})],it.prototype,"type",void 0),(0,a._)([(0,y.Cb)({constructOnly:!0})],it.prototype,"view",void 0),it=(0,a._)([(0,g.j)("esri.widgets.support.Selector2D.SelectionOperation")],it);const nt=it;let ot=class extends _.Z.EventedAccessor{constructor(e){super(e),this._operationHandlesGroup=null,this.activeOperation=null,this.continuousSelectionEnabled=!1,this.defaultLassoToolOptions={createTool:"polygon",mode:"hybrid",toolName:"lasso"},this.defaultOperationType="add",this.defaultPointToolOptions={createTool:"point",toolName:"point"},this.defaultRectangleToolOptions={createTool:"rectangle",toolName:"rectangle"},this.layerViewPreferenceEnabled=!0,this.persistSelection=!0,this.selectionManager=null,this.returnFeatureTitleFields=!1,this.returnGeometry=!0,this.selectOnComplete=!0,this.sources=null,this.toolConfigs=[]}initialize(){this.addHandles([(0,p.YP)((()=>this.effectiveSources),(e=>{this.activeOperation&&(this.activeOperation.sources=e)}))])}destroy(){this._operationHandlesGroup=(0,u.hw)(this._operationHandlesGroup)}get effectiveSelectionManager(){return this.selectionManager??this.view?.selectionManager}get effectiveSources(){const{layerViewPreferenceEnabled:e,sources:t,view:i}=this,n=t??this.effectiveSelectionManager?.sources;if(!n?.length)return[];const o=[];return n.forEach((t=>{if((0,Ue.Xi)(t))o.push(t);else if((0,k.Q2)(t)||(0,k.Ux)(t))(t.layers||[]).forEach((t=>{const n=i?(0,N.j)(i,t):void 0,s=e&&(0,Ue.Xi)(n)?n:t;o.push(s)}));else if(e){const e=i?(0,N.j)(i,t):void 0,n=(0,Ue.Xi)(e)?e:t;o.push(n)}else o.push(t)})),o}get layers(){return(0,Ze.Mr)(d.Z.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.sources}set layers(e){(0,Ze.Mr)(d.Z.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.sources=e}get state(){return this.activeOperation?"active":this.view?.ready&&this.effectiveSources.length?"ready":"disabled"}activate(e){const{state:t}=this,i=e?.view||this.view,n=e?.sources||this.effectiveSources;if("disabled"===t||!i)return void d.Z.getLogger(this).warn("Unable to start selection operation.");"active"===t&&this.cancel();const o=new CustomEvent("before-activate",{cancelable:!0,detail:{toolName:e?.toolName??null}});if(this.emit("before-activate",o),o.defaultPrevented)return;const s={type:this.defaultOperationType,persistSelection:this.persistSelection,returnFeatureTitleFields:this.returnFeatureTitleFields,returnGeometry:this.returnGeometry,selectOnComplete:this.selectOnComplete,selectionManager:this.effectiveSelectionManager,...e,sources:n,view:i},r=new nt({...s});return this._operationHandlesGroup=(0,c.AL)([r.on("selection-change",(e=>this.emit("selection-change",e))),r.once("complete",(e=>this._onOperationComplete(e,s)))]),this._set("activeOperation",r),r}activateTool(e){this.cancel();const t=this._getToolOptions(e);if(t)return this.activate(t);d.Z.getLogger(this).warn("Unable to activate tool: unable to determine options.")}cancel(){this.activeOperation?.cancel(),this._set("activeOperation",null)}toggleTool(e){const{activeOperation:t}=this;if(t){const i=t.toolName;if(this.cancel(),i===e)return}return this.activateTool(e)}_onOperationComplete(e,t){this._operationHandlesGroup=(0,u.hw)(this._operationHandlesGroup),this._set("activeOperation",null),this.emit("complete",e),this.continuousSelectionEnabled&&!e.aborted&&this.activate(t)}_getToolOptions(e){return this.toolConfigs.find((t=>t.toolName===e))||("lasso"===e?this.defaultLassoToolOptions:"point"===e?this.defaultPointToolOptions:"rectangle"===e?this.defaultRectangleToolOptions:void 0)}};(0,a._)([(0,y.Cb)({readOnly:!0})],ot.prototype,"activeOperation",void 0),(0,a._)([(0,y.Cb)()],ot.prototype,"continuousSelectionEnabled",void 0),(0,a._)([(0,y.Cb)()],ot.prototype,"defaultLassoToolOptions",void 0),(0,a._)([(0,y.Cb)()],ot.prototype,"defaultOperationType",void 0),(0,a._)([(0,y.Cb)()],ot.prototype,"defaultPointToolOptions",void 0),(0,a._)([(0,y.Cb)()],ot.prototype,"defaultRectangleToolOptions",void 0),(0,a._)([(0,y.Cb)()],ot.prototype,"effectiveSelectionManager",null),(0,a._)([(0,y.Cb)()],ot.prototype,"effectiveSources",null),(0,a._)([(0,y.Cb)()],ot.prototype,"layers",null),(0,a._)([(0,y.Cb)()],ot.prototype,"layerViewPreferenceEnabled",void 0),(0,a._)([(0,y.Cb)()],ot.prototype,"persistSelection",void 0),(0,a._)([(0,y.Cb)()],ot.prototype,"selectionManager",void 0),(0,a._)([(0,y.Cb)()],ot.prototype,"returnFeatureTitleFields",void 0),(0,a._)([(0,y.Cb)()],ot.prototype,"returnGeometry",void 0),(0,a._)([(0,y.Cb)()],ot.prototype,"selectOnComplete",void 0),(0,a._)([(0,y.Cb)()],ot.prototype,"sources",void 0),(0,a._)([(0,y.Cb)({readOnly:!0})],ot.prototype,"state",null),(0,a._)([(0,y.Cb)()],ot.prototype,"toolConfigs",void 0),(0,a._)([(0,y.Cb)()],ot.prototype,"view",void 0),ot=(0,a._)([(0,g.j)("esri.widgets.support.SelectionToolbar.SelectionToolbarViewModel")],ot);const st=ot;let rt=class extends ge.Z{constructor(e){super(e),this.chip=!0,this.lassoTool=!0,this.pan=!0,this.pointTool=!0,this.rectangleTool=!0}};(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],rt.prototype,"chip",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],rt.prototype,"lassoTool",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],rt.prototype,"pan",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],rt.prototype,"pointTool",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],rt.prototype,"rectangleTool",void 0),rt=(0,a._)([(0,g.j)("esri.widgets.support.SelectionToolbar.VisibleElements")],rt);const at=rt;var lt=i(40030);const ct="esri-selection-toolbar",dt={base:ct,container:`${ct}__container`,toolButton:`${ct}__tool-button`};let ut=class extends f.Z{constructor(e,t){super(e,t),this._viewModelHandlesGroup=null,this.disabled=!1,this.layout="horizontal",this.messages=null,this.scale="s",this.viewModel=new st,this.visibleElements=new at}initialize(){this._viewModelHandlesGroup=(0,c.AL)([(0,p.on)((()=>this.viewModel),"before-activate",(e=>this.emit("before-activate",e))),(0,p.on)((()=>this.viewModel),"complete",(e=>this.emit("complete",e))),(0,p.on)((()=>this.viewModel),"selection-change",(e=>this.emit("selection-change",e)))])}destroy(){this._viewModelHandlesGroup=(0,u.hw)(this._viewModelHandlesGroup)}loadDependencies(){return(0,Pe.h)({action:()=>i.e(77606).then(i.bind(i,11030)),"action-bar":()=>Promise.all([i.e(62737),i.e(32029),i.e(79767),i.e(4649)]).then(i.bind(i,4649)),chip:()=>i.e(70316).then(i.bind(i,70316))})}get _effectiveDisabled(){return this.disabled||"disabled"===this.state}get activeOperation(){return this.viewModel.activeOperation}get continuousSelectionEnabled(){return this.viewModel.continuousSelectionEnabled}set continuousSelectionEnabled(e){this.viewModel.continuousSelectionEnabled=e}get defaultLassoToolOptions(){return this.viewModel.defaultLassoToolOptions}set defaultLassoToolOptions(e){this.viewModel.defaultLassoToolOptions=e}get defaultOperationType(){return this.viewModel.defaultOperationType}set defaultOperationType(e){this.viewModel.defaultOperationType=e}get defaultPointToolOptions(){return this.viewModel.defaultPointToolOptions}set defaultPointToolOptions(e){this.viewModel.defaultPointToolOptions=e}get defaultRectangleToolOptions(){return this.viewModel.defaultRectangleToolOptions}set defaultRectangleToolOptions(e){this.viewModel.defaultRectangleToolOptions=e}get effectiveSelectionManager(){return this.viewModel.effectiveSelectionManager}get effectiveSources(){return this.viewModel.effectiveSources}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get layers(){return(0,Ze.Mr)(d.Z.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.viewModel.sources}set layers(e){(0,Ze.Mr)(d.Z.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.viewModel.sources=e}get layerViewPreferenceEnabled(){return this.viewModel.layerViewPreferenceEnabled}set layerViewPreferenceEnabled(e){this.viewModel.layerViewPreferenceEnabled=e}get persistSelection(){return this.viewModel.persistSelection}set persistSelection(e){this.viewModel.persistSelection=e}get returnFeatureTitleFields(){return this.viewModel.returnFeatureTitleFields}set returnFeatureTitleFields(e){this.viewModel.returnFeatureTitleFields=e}get returnGeometry(){return this.viewModel.returnGeometry}set returnGeometry(e){this.viewModel.returnGeometry=e}get selectOnComplete(){return this.viewModel.selectOnComplete}set selectOnComplete(e){this.viewModel.selectOnComplete=e}get selectionManager(){return this.viewModel.selectionManager}set selectionManager(e){this.viewModel.selectionManager=e}get state(){return this.viewModel.state}get sources(){return this.viewModel.sources}set sources(e){this.viewModel.sources=e}get toolConfigs(){return this.viewModel.toolConfigs}set toolConfigs(e){this.viewModel.toolConfigs=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visibleToolCount(){const{visibleElements:e}=this;return this.toolConfigs.length+(e.lassoTool?1:0)+(e.rectangleTool?1:0)}activate(e){if(this.cancel(),!this._effectiveDisabled)return this.viewModel.activate(e)}activateTool(e){if(!this._effectiveDisabled)return this.viewModel.activateTool(e)}cancel(){this.viewModel.cancel()}toggleTool(e){if(!this._effectiveDisabled)return this.viewModel.toggleTool(e)}render(){return(0,Me.u)("div",{"aria-label":this.label,class:this.classes(dt.base,Be.z.widget)},(0,Me.u)("div",{class:dt.container},(0,Me.u)("calcite-action-bar",{expandDisabled:!0,layout:"horizontal",scale:this.scale},this._renderDefaultTools(),this._renderCustomTools(),this._renderChip())))}_renderDefaultTools(){return[this._renderPanAction(),this._renderPointTool(),this._renderRectangleTool(),this._renderLassoTool()]}_renderPanAction(){if(!this.visibleElements.pan)return;const e=this.messages.pan,t=`${this.id}-tool-pan`;return this._renderAction({active:!this.activeOperation,disabled:this._effectiveDisabled,icon:"pan",id:t,key:t,onclick:()=>this.cancel(),text:e,title:e})}_renderChip(){if(!this.visibleElements.chip)return;const{effectiveSelectionManager:e}=this,t=e?.count??0,i=(0,lt.uf)(t);return(0,Me.u)("calcite-chip",{appearance:"outline",closable:t>0,closed:0===t,disabled:this._effectiveDisabled||0===t,label:i,scale:this.scale,slot:"actions-end",title:this.messages.clearSelection,onCalciteChipClose:()=>e?.clear()},i)}_renderCustomTools(){return this.toolConfigs.map((({toolName:e,icon:t})=>this._renderToolWithTooltip(e,t)))}_renderPointTool(){if(this.visibleElements.pointTool)return this._renderToolWithTooltip("point","selection-set",this.messages.selectByPoint)}_renderLassoTool(){if(this.visibleElements.lassoTool)return this._renderToolWithTooltip("lasso","lasso-select",this.messages.selectByLasso)}_renderRectangleTool(){if(this.visibleElements.rectangleTool)return this._renderToolWithTooltip("rectangle","cursor-marquee",this.messages.selectByRectangle)}_renderToolWithTooltip(e,t,i=e){const n=`${this.id}-tool-${e}`;return this._renderAction({active:this.activeOperation?.toolName===e,disabled:this._effectiveDisabled,icon:t||"selection",id:n,key:n,onclick:()=>this.toggleTool(e),text:i,title:i})}_renderAction(e){return(0,Me.u)("calcite-action",{...e,bind:this,class:dt.toolButton,scale:this.scale})}};(0,a._)([(0,y.Cb)()],ut.prototype,"_effectiveDisabled",null),(0,a._)([(0,y.Cb)()],ut.prototype,"activeOperation",null),(0,a._)([(0,y.Cb)()],ut.prototype,"continuousSelectionEnabled",null),(0,a._)([(0,y.Cb)()],ut.prototype,"defaultLassoToolOptions",null),(0,a._)([(0,y.Cb)()],ut.prototype,"defaultOperationType",null),(0,a._)([(0,y.Cb)()],ut.prototype,"defaultPointToolOptions",null),(0,a._)([(0,y.Cb)()],ut.prototype,"defaultRectangleToolOptions",null),(0,a._)([(0,y.Cb)()],ut.prototype,"disabled",void 0),(0,a._)([(0,y.Cb)()],ut.prototype,"effectiveSelectionManager",null),(0,a._)([(0,y.Cb)()],ut.prototype,"effectiveSources",null),(0,a._)([(0,y.Cb)()],ut.prototype,"label",null),(0,a._)([(0,y.Cb)()],ut.prototype,"layers",null),(0,a._)([(0,y.Cb)()],ut.prototype,"layerViewPreferenceEnabled",null),(0,a._)([(0,y.Cb)()],ut.prototype,"layout",void 0),(0,a._)([(0,y.Cb)(),(0,Ae.H)("esri/widgets/support/SelectionToolbar/t9n/SelectionToolbar")],ut.prototype,"messages",void 0),(0,a._)([(0,y.Cb)()],ut.prototype,"persistSelection",null),(0,a._)([(0,y.Cb)()],ut.prototype,"returnFeatureTitleFields",null),(0,a._)([(0,y.Cb)()],ut.prototype,"returnGeometry",null),(0,a._)([(0,y.Cb)()],ut.prototype,"selectOnComplete",null),(0,a._)([(0,y.Cb)()],ut.prototype,"scale",void 0),(0,a._)([(0,y.Cb)()],ut.prototype,"selectionManager",null),(0,a._)([(0,y.Cb)()],ut.prototype,"state",null),(0,a._)([(0,y.Cb)()],ut.prototype,"sources",null),(0,a._)([(0,y.Cb)()],ut.prototype,"toolConfigs",null),(0,a._)([(0,y.Cb)()],ut.prototype,"view",null),(0,a._)([(0,y.Cb)()],ut.prototype,"viewModel",void 0),(0,a._)([(0,y.Cb)({type:at,nonNullable:!0})],ut.prototype,"visibleElements",void 0),(0,a._)([(0,y.Cb)()],ut.prototype,"visibleToolCount",null),ut=(0,a._)([(0,g.j)("esri.widgets.support.SelectionToolbar")],ut);const ht=ut;var pt=i(31066),yt=i(82504);let gt=class extends ge.Z{constructor(e){super(e),this.directionModePicker=!1,this.header=!1,this.labelsToggle=!0,this.tooltipsToggle=!0}};(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],gt.prototype,"directionModePicker",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],gt.prototype,"header",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],gt.prototype,"labelsToggle",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],gt.prototype,"tooltipsToggle",void 0),gt=(0,a._)([(0,g.j)("esri.widgets.support.SketchTooltipControls.VisibleElements")],gt);const mt=gt,ft="esri-sketch-tooltip-controls",vt={base:ft,block:`${ft}__block`,blockContent:`${ft}__block-content`,radioButtonLabelWrapper:`${ft}__radio-button-label-wrapper`};let bt=class extends f.Z{constructor(e,t){super(e,t),this.viewModel=null,this.visibleElements=new mt,this.sketchOptions=new Z.Z,this.viewType=void 0,this._onTooltipsEnabledChange=e=>{this.sketchOptions.tooltips.enabled=e},this._onLabelsEnabledChange=e=>{this.sketchOptions.labels.enabled=e},this._onDirectionModeChange=e=>{this.sketchOptions.values.directionMode=e.currentTarget.selectedItem.value}}loadDependencies(){return Promise.all([(0,Pe.h)({block:()=>Promise.all([i.e(62737),i.e(32029),i.e(79767),i.e(8112),i.e(79429)]).then(i.bind(i,79429)),label:()=>Promise.resolve().then(i.bind(i,36650)),icon:()=>Promise.resolve().then(i.bind(i,4204)),"radio-button":()=>i.e(76013).then(i.bind(i,76013)),"radio-button-group":()=>i.e(27859).then(i.bind(i,27859))}),(0,yt.n)()])}render(){const{label:e,visibleElements:t}=this,i=this._renderContent();return(0,Me.u)("div",{"aria-label":e,class:this.classes(vt.base,Be.z.widget)},i?(0,Me.u)("calcite-block",{class:vt.block,expanded:!0,heading:t.header?this.label:"",key:"content-block",label:this.label},(0,Me.u)("div",{class:vt.blockContent,key:"content"},i)):void 0)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}_renderContent(){const{visibleElements:e,viewType:t}=this,i=[e.tooltipsToggle?this._renderTooltipsToggle():null,e.labelsToggle&&"2d"!==t?this._renderLabelsToggle():null,e.directionModePicker?this._renderDirectionModePicker():null].filter(l.pC);return 0===i.length?null:i}_renderTooltipsToggle(){const{messages:e,sketchOptions:t}=this;return(0,Me.u)(yt.t,{checked:t.tooltips.effectiveEnabled,hint:e.tooltipsToggleHint,key:`${this.id}__tooltips`,label:e.tooltipsToggle,onChange:this._onTooltipsEnabledChange})}_renderLabelsToggle(){const{messages:e,sketchOptions:t}=this;return(0,Me.u)(yt.t,{checked:t.labels.enabled,hint:e.labelsToggleHint,key:`${this.id}__labels`,label:e.labelsToggle,onChange:this._onLabelsEnabledChange})}_renderDirectionModePicker(){const{messages:e,sketchOptions:t}=this,{directionMode:i}=t.values;return(0,Me.u)("calcite-label",{key:"direction-mode",layout:"default",scale:"s"},e.directionModePicker,(0,Me.u)("calcite-radio-button-group",{key:"radio-button-group",layout:"horizontal",name:this.id,scale:"s",value:i,onCalciteRadioButtonGroupChange:this._onDirectionModeChange},this._renderDirectionModeOption("relative",i,e.directionModeRelative),this._renderDirectionModeOption("absolute",i,e.directionModeAbsolute)))}_renderDirectionModeOption(e,t,i){return(0,Me.u)("calcite-label",{key:e,layout:"inline",scale:"s"},(0,Me.u)("calcite-radio-button",{checked:e===t,scale:"s",value:e}),(0,Me.u)("div",{class:vt.radioButtonLabelWrapper,key:"label-wrapper"},(0,Me.u)("calcite-icon",{icon:pt.M[e],scale:"s"}),i))}};(0,a._)([(0,y.Cb)()],bt.prototype,"label",null),(0,a._)([(0,y.Cb)({type:mt,nonNullable:!0})],bt.prototype,"visibleElements",void 0),(0,a._)([(0,y.Cb)(),(0,Ae.H)("esri/widgets/support/SketchTooltipControls/t9n/SketchTooltipControls")],bt.prototype,"messages",void 0),(0,a._)([(0,y.Cb)({nonNullable:!0,type:Z.Z})],bt.prototype,"sketchOptions",void 0),(0,a._)([(0,y.Cb)({type:String})],bt.prototype,"viewType",void 0),bt=(0,a._)([(0,g.j)("esri.widgets.support.SketchTooltipControls")],bt);const _t=bt;var wt=i(67908),Ct=i(676),xt=i(5221),St=i(94027);const Et=e=>kt(e)||Lt(e),kt=e=>{if(!("type"in e))return!1;switch(e.type){case"feature":case"geojson":case"csv":case"graphics":case"wfs":case"map-notes":case"oriented-imagery":case"scene":case"building-scene":case"subtype-sublayer":return!0;default:return!1}},Lt=e=>{const t=(0,xt.Ff)(e);if(null!=t&&e.hasOwnProperty(t)&&null!=e[t])for(const i of e[t])if(Et(i))return!0;return!1},Tt=(e,t)=>null!=t&&null!=e&&(t.test(e.title)?"self":!!e.children.some((e=>!1!==Tt(e,t)))&&"children");var Mt,It=i(48804);let Ot=Mt=class extends It.Z{constructor(e){super(e),this.children=new v.Z,this.parent=null}get enabled(){const{children:e}=this;if(0===e.length)return null!=this.featureSource&&this.featureSource.enabled?"enabled":"disabled";let t=!1,i=!1;for(const n of e){if("indeterminate"===n.enabled)return n.enabled;if("enabled"===n.enabled?t=!0:"disabled"===n.enabled&&(i=!0),i&&t)return"indeterminate"}return i?"disabled":"enabled"}get childLayerIds(){return this.children.toArray().flatMap((e=>[e.layer?.id,...e.childLayerIds]))}get featureSource(){const{layer:e,getFeatureSnappingSources:t}=this;return t().find((t=>t.layer===e))}_initializeChildLayers(e){if(!e)return;const t=e.filter(Et);super._initializeChildLayers(t)}_createChildItems(e){return e.map((e=>(0,xt.gF)(e)?new Mt({layer:e,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):null)).filter(l.pC).reverse()}};(0,a._)([(0,y.Cb)()],Ot.prototype,"enabled",null),(0,a._)([(0,y.Cb)()],Ot.prototype,"children",void 0),(0,a._)([(0,y.Cb)()],Ot.prototype,"childLayerIds",null),(0,a._)([(0,y.Cb)()],Ot.prototype,"featureSource",null),(0,a._)([(0,y.Cb)({constructOnly:!0})],Ot.prototype,"getFeatureSnappingSources",void 0),(0,a._)([(0,y.Cb)()],Ot.prototype,"parent",void 0),Ot=Mt=(0,a._)([(0,g.j)("esri.widgets.support.SnappingControls.SnappingListItem")],Ot);let Pt=class extends St.Z{constructor(){super(...arguments),this.featureSnappingSources=new v.Z}get operationalItemsFlat(){return this.operationalItems.flatten((e=>e.children))}get selectableItems(){return this.operationalItemsFlat.filter((e=>!e.children?.length))}_compileList(){const e=this.view?.map?.layers;if(!e)return;const t=e.filter(Et);this._watchLayersListMode(t);const i=this._getViewableLayers(t);i?.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}_createListItem(e){return new Ot({layer:e,view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})}};(0,a._)([(0,y.Cb)()],Pt.prototype,"featureSnappingSources",void 0),(0,a._)([(0,y.Cb)()],Pt.prototype,"operationalItems",void 0),(0,a._)([(0,y.Cb)()],Pt.prototype,"operationalItemsFlat",null),(0,a._)([(0,y.Cb)()],Pt.prototype,"selectableItems",null),Pt=(0,a._)([(0,g.j)("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],Pt);let At=class extends ge.Z{constructor(e){super(e),this.layerListViewModel=new Pt,this.snappingOptions=new H.Z,this.view=null}initialize(){this.addHandles([(0,p.YP)((()=>({viewModel:this.layerListViewModel,view:this.view})),(({viewModel:e,view:t})=>{e.view=t}),p.nn),(0,p.YP)((()=>({viewModel:this.layerListViewModel,sources:this.snappingOptions?.featureSources})),(({viewModel:e,sources:t})=>{e.featureSnappingSources=t}),p.nn)])}get allLayersEnabled(){return(this.layerListViewModel?.selectableItems??[]).every((e=>"enabled"===e.enabled))}get allLayersDisabled(){return(this.layerListViewModel?.selectableItems??[]).every((e=>!e.enabled))}get layersEnabledCount(){return this.layerListViewModel?.selectableItems?.filter((e=>"enabled"===e.enabled)).length??0}get state(){return this.snappingOptions?"ready":"disabled"}toggleSnappingForLayers(e,t){e?.forEach((e=>t?this.enableSnappingForLayer(e):this.disableSnappingForLayer(e)))}toggleSnappingForAllLayers(e){this.layerListViewModel.selectableItems.forEach((({layer:t})=>{const i=t?.id;e?this.enableSnappingForLayer(i):this.disableSnappingForLayer(i)}))}enableSnappingForLayer(e){const t=this._findSnappingSourceForLayer(e)??this._makeSnappingSourceForLayer(e);t&&(t.enabled=!0)}disableSnappingForLayer(e){const t=this._findSnappingSourceForLayer(e);t&&(t.enabled=!1)}updateEnabledFeatureSources(e){for(const t of this.snappingOptions.featureSources)(0,xt.gF)(t.layer)&&(t.enabled=e.includes(t.layer.id))}_findSnappingSourceForLayer(e){return this.snappingOptions.featureSources.find((t=>t.layer.id===e))}_makeSnappingSourceForLayer(e){const t=this.layerListViewModel.operationalItemsFlat.find((t=>t.layer?.id===e))?.layer;if(!t)throw new b.Z("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${e} because no such layer was found in the view`);if("group"===t.type)return;const i=new Ct.Z({layer:t});return this.snappingOptions.featureSources.add(i),i}};(0,a._)([(0,y.Cb)()],At.prototype,"allLayersEnabled",null),(0,a._)([(0,y.Cb)()],At.prototype,"allLayersDisabled",null),(0,a._)([(0,y.Cb)({constructOnly:!0})],At.prototype,"layerListViewModel",void 0),(0,a._)([(0,y.Cb)()],At.prototype,"layersEnabledCount",null),(0,a._)([(0,y.Cb)({type:H.Z,nonNullable:!0})],At.prototype,"snappingOptions",void 0),(0,a._)([(0,y.Cb)()],At.prototype,"state",null),(0,a._)([(0,y.Cb)()],At.prototype,"view",void 0),At=(0,a._)([(0,g.j)("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],At);const Rt=At,Dt="esri-snapping-controls",$t={base:Dt,container:`${Dt}__container`,toggleBlock:`${Dt}__toggle-block`,layerListBlock:`${Dt}__layer-list-block`,layerList:`${Dt}__layer-list`,layerListFilter:`${Dt}__layer-list__filter`,layerListButton:`${Dt}__layer-list__button`,layerListItem:`${Dt}__layer-list__item`,layerListGroup:`${Dt}__layer-list__group`,nestedContainer:`${Dt}__nested-container`};let Nt=class extends f.Z{constructor(e,t){super(e,t),this._defaultViewModel=null,this._layerListFilter=null,this._gridLoadTask=null,this.layerListOpen=!0,this.gridOptionsOpen=!1,this.messages=null,this.messagesCommon=null,this.snappingManager=null,this.visibleElements=new ve,this._enableSnappingSwitchChange=e=>{this.snappingOptions.enabled=e},this._featureEnabledSwitchChange=e=>{this.snappingOptions.featureEnabled=e},this._gridEnabledSwitchChange=e=>{this.snappingOptions.gridEnabled=e,e&&this._startLoadGrid()},this._selfEnabledSwitchChange=e=>{this.snappingOptions.selfEnabled=e},this._onToggleLayersButtonClick=e=>{this.viewModel.toggleSnappingForAllLayers(!this.viewModel.allLayersEnabled),(0,Te.kW)(e.target)};const{snappingOptions:i,view:n,viewModel:o}=e;this.viewModel=o??(this._defaultViewModel=new Rt({snappingOptions:i,view:n}))}normalizeCtorArgs(e){const{snappingOptions:t,view:i,viewModel:n,...o}=e;return o}destroy(){this.viewModel!==this._defaultViewModel&&(this._defaultViewModel=(0,u.SC)(this._defaultViewModel))}loadDependencies(){return Promise.all([(0,Pe.h)({block:()=>Promise.all([i.e(62737),i.e(32029),i.e(79767),i.e(8112),i.e(79429)]).then(i.bind(i,79429)),button:()=>Promise.resolve().then(i.bind(i,61637)),input:()=>i.e(75014).then(i.bind(i,75014)),list:()=>Promise.all([i.e(75014),i.e(29749)]).then(i.bind(i,29749)),"list-item":()=>Promise.all([i.e(62737),i.e(8112),i.e(96326)]).then(i.bind(i,96326)),checkbox:()=>Promise.resolve().then(i.bind(i,69397)),loader:()=>Promise.resolve().then(i.bind(i,55001))}),(0,yt.n)()])}initialize(){this.addHandles((0,p.YP)((()=>"2d"===this.view?.type&&!!this.view.grid),(e=>{this.visibleElements.gridControls&&(this.snappingOptions.gridEnabled=e)})))}get _openAndReady(){return this.gridOptionsOpen&&this.snappingOptions.gridEnabled&&this.snappingOptions.enabled}get icon(){return"snap-to-point"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set viewModel(e){e!==this._get("viewModel")&&(null!=this._defaultViewModel&&this._defaultViewModel===e||(this._defaultViewModel=(0,u.SC)(this._defaultViewModel)),this._set("viewModel",e))}render(){const{label:e}=this;return(0,Me.u)("div",{"aria-label":e,class:this.classes($t.base,Be.z.widget)},(0,Me.u)("div",{class:$t.container},this._renderContent()))}_renderContent(){return[this._renderToggles(),this._renderLayerList(),"2d"===this.view?.type&&this.visibleElements.gridControls?this._renderGridOptions():null]}_renderToggles(){const{visibleElements:e,view:t}=this,i=[e.selfEnabledToggle?this._renderSelfEnabledToggle():null,e.featureEnabledToggle?this._renderFeatureEnabledToggle():null,e.gridEnabledToggle&&"2d"===t?.type?this._renderGridEnabledToggle():null].filter(l.pC),n=[e.enabledToggle?this._renderEnabledToggle():null,i.length>0?(0,Me.u)("div",{class:$t.nestedContainer},i):null].filter(l.pC);return 0===n.length?null:(0,Me.u)("calcite-block",{class:$t.toggleBlock,expanded:!0,heading:e.header?this.label:"",key:"toggle-block",label:this.label},n)}_renderEnabledToggle(){return(0,Me.u)(yt.t,{checked:this.viewModel.snappingOptions.enabled,disabled:this._enabledToggleDisabled,key:`${this.id}__enabled-toggle`,label:this.messages.enableSnapping,onChange:this._enableSnappingSwitchChange})}_renderSelfEnabledToggle(){return(0,Me.u)(yt.t,{checked:this.viewModel.snappingOptions.selfEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__self-enabled-toggle`,label:this.messages.geometryGuides,onChange:this._selfEnabledSwitchChange})}_renderFeatureEnabledToggle(){return(0,Me.u)(yt.t,{checked:this.viewModel.snappingOptions.featureEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__feature-enabled-toggle`,label:this.messages.featureToFeature,onChange:this._featureEnabledSwitchChange})}_renderGridEnabledToggle(){return(0,Me.u)(yt.t,{checked:this.viewModel.snappingOptions.gridEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__grid-enabled-toggle`,label:this.messages.grid,onChange:this._gridEnabledSwitchChange})}_renderLayerList(){if(!this.visibleElements.layerList)return null;const{messages:e,viewModel:t}=this,i=t.layerListViewModel.operationalItems.length>9?(0,Me.u)("calcite-input",{class:$t.layerListFilter,clearable:!0,placeholder:e?.searchLayers,onCalciteInputInput:({currentTarget:{value:e}})=>{this._layerListFilter=""===e?null:new RegExp(e,"i")}}):null,n=this._secondaryElementsDisabled,o=this.layerListOpen&&!n,s=t.layerListViewModel.operationalItems?.find((e=>!!e.children.length));return(0,Me.u)("calcite-block",{class:$t.layerListBlock,collapsible:!0,disabled:this._secondaryElementsDisabled,expanded:o,heading:e.snappingLayers,key:"list-block",onCalciteBlockToggle:e=>this.layerListOpen=e.currentTarget.expanded},i,this._renderToggleLayersButton(),(0,Me.u)("calcite-list",{class:$t.layerList,displayMode:s?"nested":"flat",label:e?.snappingLayers,selectionMode:"none"},this._renderLayerListItemCollection(t.layerListViewModel.operationalItems)))}_renderGridOptions(){const{view:e,visibleElements:t,snappingManager:i,snappingOptions:n,_openAndReady:o}=this,{gridEnabled:s,enabled:r}=n;(o||"2d"===e?.type&&e.grid)&&this._startLoadGrid();const a=this._gridLoadTask?.value,l=a&&"2d"===e?.type&&(0,Me.u)(a,{snappingManager:i,snappingOptions:n,view:e,visibleElements:t.gridControlsElements});return(0,Me.u)("calcite-block",{class:$t.layerListBlock,collapsible:!0,disabled:!s||!r,expanded:o,heading:this.messages.gridOptionsHeading,key:"grid-block",onCalciteBlockClose:()=>this.gridOptionsOpen=!1,onCalciteBlockOpen:()=>this.gridOptionsOpen=!0},l??(0,Me.u)("calcite-loader",{label:this.messagesCommon.loading,scale:"s",text:this.messagesCommon.loading}))}async _startLoadGrid(){!this._gridLoadTask&&this.visibleElements.gridControls&&"2d"===this.view?.type&&(this._gridLoadTask=(0,He.vr)((async()=>(await Promise.all([i.e(9519),i.e(66288),i.e(65513),i.e(56870),i.e(18208),i.e(52846),i.e(48044),i.e(72997),i.e(20144),i.e(5648),i.e(72906),i.e(54781)]).then(i.bind(i,54781))).default)))}_renderLayerListItemCollection(e){const t=this._layerListFilter;return e.map((e=>{switch(t?Tt(e,t):null){case"children":{const i=e.children.filter((e=>!1!==Tt(e,t)));return this._renderLayerListItemGroup(e,i)}case"self":case null:return this._renderLayerListItemOrGroup(e);case!1:return"self"===Tt(e.parent,t)?this._renderLayerListItemOrGroup(e):null}})).toArray().filter(l.pC)}_renderToggleLayersButton(){if(!this.visibleElements.layerListToggleLayersButton)return null;const{viewModel:{allLayersEnabled:e},messages:t}=this,i=e?t.disableAllLayers:t.enableAllLayers;return(0,Me.u)("calcite-button",{appearance:"transparent",class:$t.layerListButton,label:i,name:"layer-toggle",onclick:this._onToggleLayersButtonClick},i)}_renderLayerListItemOrGroup(e){if(e.children.length)return this._renderLayerListItemGroup(e);const{messages:{untitledLayer:t}}=this,i=e.title||t,n=()=>{this.viewModel.toggleSnappingForLayers([e.layer?.id],"enabled"!==e.enabled)};return(0,Me.u)("calcite-list-item",{class:$t.layerListItem,key:`${this.id}-list-item-${e.uid}`,label:i,onCalciteListItemSelect:e=>{e.stopPropagation(),n()}},(0,Me.u)("calcite-checkbox",{checked:"enabled"===e.enabled,slot:"actions-start",onCalciteCheckboxChange:n}))}_renderLayerListItemGroup(e,t){const{messages:i}=this,{children:n,title:o}=e,s=o||i.untitledLayer,r=o&&""!==o?o:(0,wt.D)(),a=!!t?.length,l=t??n,c=()=>{this.viewModel.toggleSnappingForLayers(e.childLayerIds,"enabled"!==e.enabled)},d=l?.find((e=>!!e.children.length));return(0,Me.u)("calcite-list-item",{class:$t.layerListGroup,expanded:a,key:r,label:s,onCalciteListItemSelect:e=>{e.stopPropagation(),c()}},(0,Me.u)("calcite-checkbox",{checked:"enabled"===e.enabled,indeterminate:"indeterminate"===e.enabled,slot:"actions-start",onCalciteCheckboxChange:c}),(0,Me.u)("calcite-list",{displayMode:d?"nested":"flat",label:i?.snappingLayers,selectionMode:"none"},this._renderLayerListItemCollection(l)))}get _enabledToggleDisabled(){const e=this.snappingOptions;return e.enabledToggled||e.forceDisabled}get _secondaryElementsDisabled(){return this._enabledToggleDisabled||!this.snappingOptions.enabled}};(0,a._)([(0,y.Cb)()],Nt.prototype,"_defaultViewModel",void 0),(0,a._)([(0,y.Cb)()],Nt.prototype,"_layerListFilter",void 0),(0,a._)([(0,y.Cb)()],Nt.prototype,"_gridLoadTask",void 0),(0,a._)([(0,y.Cb)()],Nt.prototype,"_openAndReady",null),(0,a._)([(0,y.Cb)()],Nt.prototype,"label",null),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],Nt.prototype,"layerListOpen",void 0),(0,a._)([(0,y.Cb)({type:Boolean,nonNullable:!0})],Nt.prototype,"gridOptionsOpen",void 0),(0,a._)([(0,y.Cb)(),(0,Ae.H)("esri/widgets/support/SnappingControls/t9n/SnappingControls")],Nt.prototype,"messages",void 0),(0,a._)([(0,y.Cb)(),(0,Ae.H)("esri/t9n/common")],Nt.prototype,"messagesCommon",void 0),(0,a._)([(0,y.Cb)()],Nt.prototype,"snappingOptions",null),(0,a._)([(0,y.Cb)()],Nt.prototype,"snappingManager",void 0),(0,a._)([(0,y.Cb)()],Nt.prototype,"view",null),(0,a._)([(0,y.Cb)()],Nt.prototype,"viewModel",null),(0,a._)([(0,y.Cb)({type:ve,nonNullable:!0})],Nt.prototype,"visibleElements",void 0),(0,a._)([(0,y.Cb)()],Nt.prototype,"_enabledToggleDisabled",null),(0,a._)([(0,y.Cb)()],Nt.prototype,"_secondaryElementsDisabled",null),Nt=(0,a._)([(0,g.j)("esri.widgets.support.SnappingControls")],Nt);const Ft=Nt;var Vt=i(29629),zt=i(37964);const Zt="esri-sketch",Bt={base:Zt,vertical:`${Zt}--vertical`,docked:`${Zt}-bar`,floating:`${Zt}-pad`,chipHorizontal:`${Zt}__selection-count-chip--horizontal`,chipVertical:`${Zt}__selection-count-chip--vertical`,chipVerticalSmall:`${Zt}__selection-count-chip--vertical--s`,popoverWrapper:`${Zt}__popover-wrapper`},Ut={point:"pin",polyline:"line",polygon:"polygon",rectangle:"rectangle",circle:"circle",multipoint:"pins",mesh:"i3d-building",freehandPolygon:"freehand-area",freehandPolyline:"freehand"};let Ht=class extends f.Z{constructor(e,t){super(e,t),this._activeCustomToolOptions=null,this._selectionToolbar=null,this._viewModelHandlesGroup=null,this.availableCreateTools=["point","polyline","polygon","rectangle","circle"],this.customToolOptions=null,this.customActions=null,this.toolbarKind="floating",this.contextualToolLocation="separate",this.groupCollapsePriorities=null,this.groupAllowCollapseOptions=null,this.messages=null,this.messagesCommon=null,this.visibleElements=new we,this._defaultViewModel=null,this._calcitePopoverReferenceElement=null,this._relativeLocation="top",this._popoverOpen=!1,this._activateCreateTool=this._activateCreateTool.bind(this),this.viewModel=e?.viewModel||(this._defaultViewModel=new oe({creationMode:e?.creationMode??"continuous"}))}initialize(){const{layer:e,view:t}=this,i="2d"===t?.type,n=new ht({persistSelection:!1,visibleElements:new at({chip:!1,pan:!1,pointTool:!1,lassoTool:i,rectangleTool:i}),view:t,sources:e?[e]:null,scale:this.scale});this.addHandles([(0,p.YP)((()=>this.viewModel),(e=>{this._viewModelHandlesGroup=(0,u.hw)(this._viewModelHandlesGroup),e&&(this._viewModelHandlesGroup=(0,c.AL)([e.on("create",(()=>this.scheduleRender())),e.on("update",(()=>this.scheduleRender())),e.on("delete",(e=>this.emit("delete",e))),e.on("undo",(()=>this.scheduleRender())),e.on("redo",(()=>this.scheduleRender())),(0,p.YP)((()=>e.layer),(e=>{this._selectionToolbar&&(this._selectionToolbar.sources=e?[e]:null)})),(0,p.YP)((()=>e.view),(e=>{this._selectionToolbar&&(this._selectionToolbar.view=e)})),(0,p.YP)((()=>e.state),(()=>this.notifyChange("state")))]))}),p.tX),(0,p.gx)((()=>n.activeOperation),(()=>this.viewModel.cancel())),n.on("complete",(e=>this._onSelectionOperationComplete(e))),(0,p.YP)((()=>{const{view:e,visibleElements:{selectionTools:t}}=this;return{lassoTool:"3d"!==e?.type&&!!t?.["lasso-selection"],rectangleTool:"3d"!==e?.type&&!!t?.["rectangle-selection"]}}),(e=>{Object.assign(n.visibleElements,e)}),p.tX)]),this._selectionToolbar=n}loadDependencies(){return(0,Pe.h)({action:()=>i.e(77606).then(i.bind(i,11030)),chip:()=>i.e(70316).then(i.bind(i,70316)),popover:()=>Promise.all([i.e(62737),i.e(32029),i.e(24006)]).then(i.bind(i,24006))})}destroy(){this._selectionToolbar?.destroy(),this._viewModelHandlesGroup=(0,u.hw)(this._viewModelHandlesGroup)}get activeTool(){const e=this._selectionToolbar?.activeOperation;if(e)switch(e.toolName){case"lasso":return"lasso-selection";case"rectangle":return"rectangle-selection";case"default":return"custom-selection"}const t=this._effectiveAvailableCreateTools,{activeTool:i,activeCreateToolDrawMode:n}=this.viewModel;return"polygon"===i&&"freehand"===n&&t?.includes("freehandPolygon")?"freehandPolygon":"polyline"===i&&"freehand"===n&&t?.includes("freehandPolyline")?"freehandPolyline":this.viewModel.activeTool}get activeTooltip(){return this.viewModel.activeTooltip}get createGraphic(){return this.viewModel.createGraphic}get creationMode(){return this.viewModel.creationMode}set creationMode(e){this.viewModel.creationMode=e}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(e){this.viewModel.defaultCreateOptions=e}get defaultUpdateOptions(){return this.viewModel.defaultUpdateOptions}set defaultUpdateOptions(e){this.viewModel.defaultUpdateOptions=e}get icon(){return"pencil"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(e){this.viewModel.labelOptions=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}set layout(e){this._set("layout",e),this._selectionToolbar&&(this._selectionToolbar.layout=e)}set scale(e){this._set("scale",e),this._selectionToolbar&&(this._selectionToolbar.scale=e)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get state(){return this._selectionToolbar?.activeOperation?"active":this.viewModel.state}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(e){this.viewModel.tooltipOptions=e}get updateGraphics(){return this.viewModel.updateGraphics}get valueOptions(){return this.viewModel.valueOptions}set valueOptions(e){this.viewModel.valueOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set viewModel(e){const t=this._get("viewModel");e!==t&&(t&&t===this._defaultViewModel&&(0,u.SC)(t),this._set("viewModel",e))}get _effectiveAvailableCreateTools(){const{availableCreateTools:e,view:t,visibleElements:i}=this,n=e?.filter((e=>!!i.createTools?.[e]));return"3d"===t?.type?n?.filter((e=>"multipoint"!==e)):n}create(e,t,i){const n=i?.createOptions??t;return this._activeCustomToolOptions=i,(0,h.R8)(this.viewModel.create(e,n))}update(e,t){return(0,h.R8)(this.viewModel.update(e,t))}complete(){this.viewModel.complete()}cancel(){this._selectionToolbar?.cancel(),this.viewModel.cancel(),this._activeCustomToolOptions=null}undo(){this.viewModel.undo(),this.view?.focus()}redo(){this.viewModel.redo(),this.view?.focus()}delete(){this.viewModel.delete()}duplicate(){return this.viewModel.duplicate()}dismissFloatingElements(){this._popoverOpen=!1}render(){const{toolbarKind:e,layout:t,scale:i}=this,n=this.customActions?.filter((e=>"selection-toolbar"===e.position));return(0,Me.u)("div",null,(0,Me.u)("div",{classes:{[Bt.base]:!0,[Bt.floating]:"floating"===e,[Bt.docked]:"docked"===e,[Bt.vertical]:"vertical"===t}},(0,Me.u)(ze,{barStyle:e,layout:t,scale:i},this._renderSelectionSetItemGroupInline(),(0,Me.u)("div",{"allow-collapse":this.groupAllowCollapseOptions?.get("selectionTools")??!0,"group-kind":"split-button",key:"selection-split-button",priority:this.groupCollapsePriorities?.get("selectionTools")??te.Low},this._renderDefaultSelectionButton(),this._selectionToolbar?.render(),n?.map((e=>this._renderToolbarItem(e)))),this._renderCreateToolActionGroup(),this._renderUndoRedoMenuItemGroup(),this._renderSettingsMenuItemGroup()),this._renderSelectionSetToolbar(),this._renderSettingsMenuPopover()))}_renderSettingsMenuPopover(){const{messagesCommon:e,snappingOptions:t,view:i,viewModel:n,visibleElements:o}=this;if(!this._calcitePopoverReferenceElement)return;const s={directionModePicker:o.directionModePicker,labelsToggle:o.labelsToggle,tooltipsToggle:o.tooltipsToggle},r="horizontal"===this.layout?"top"===this._relativeLocation?"bottom-end":"top-end":"right-end";return(0,Me.u)("calcite-popover",{closable:!0,focusTrapDisabled:!0,heading:e.settings,label:e.settings,open:this._popoverOpen,overlayPositioning:"fixed",placement:r,referenceElement:this._calcitePopoverReferenceElement,scale:this.scale,onCalcitePopoverBeforeClose:()=>this._popoverOpen=!1,onCalcitePopoverBeforeOpen:e=>this._remeasurePopoverSizes(e.currentTarget),onCalcitePopoverClose:()=>this._refocusOnView()},(0,Me.u)("div",{class:Bt.popoverWrapper},Object.values(s).includes(!0)?(0,Me.u)(_t,{sketchOptions:n.sketchOptions,viewType:i?.type,visibleElements:new mt(s)}):void 0,o.snappingControls&&i&&t?(0,Me.u)(Ft,{snappingManager:this.viewModel.snappingManager,snappingOptions:t,view:i,visibleElements:o.snappingControlsElements}):void 0))}_renderSelectionSetToolbar(){if("separate"!==this.contextualToolLocation)return;const e=this._renderSelectionSetItemGroup();return e?.length?(0,Me.u)(ze,{barStyle:this.toolbarKind,layout:this.layout,scale:this.scale},e):void 0}_renderSelectionSetItemGroupInline(){return"separate"===this.contextualToolLocation?[]:this._renderSelectionSetItemGroup()}_renderUndoRedoMenuItemGroup(){return(0,Me.u)("div",{"allow-collapse":this.groupAllowCollapseOptions?.get("undoRedo")??!0,"group-kind":"split-button",key:"undo-redo-menu",priority:this.groupCollapsePriorities?.get("undoRedo")??te.Medium,slot:"actions-end"},this._renderUndoButton(),this._renderRedoButton())}_renderSettingsMenuItemGroup(){const e=[],t=[];this.customActions?.forEach((i=>{"settings-before"===i.position?t.push(i):"settings-after"===i.position&&e.push(i)}));const i=[...t.map((e=>this._renderToolbarItem(e))),this._renderSettingsMenuButton(),...e.map((e=>this._renderToolbarItem(e)))].filter(l.pC);if(i.length)return(0,Me.u)("div",{"allow-collapse":this.groupAllowCollapseOptions?.get("settings")??!1,"group-kind":"overflow-group",key:"settings-menu",priority:this.groupCollapsePriorities?.get("settings")??te.Max,slot:"actions-end"},i)}_renderSelectionSetItemGroup(){if(!this.updateGraphics.length)return[];const e="inline-end"===this.contextualToolLocation?"actions-end":void 0,t=this.customActions?.filter((e=>"before-selection-set"===e.position)),i=this.customActions?.filter((e=>"after-selection-set"===e.position)),n=this.groupCollapsePriorities?.get("selectionSet")??te.High;return[(0,Me.u)("div",{"group-kind":"measured-content",key:"selection-count-chip-group",priority:n,slot:e},this._renderFeatureCountChip()),(0,Me.u)("div",{"allow-collapse":this.groupAllowCollapseOptions?.get("selectionSet")??!1,"group-kind":"overflow-group",key:"selection-set-tool-group",priority:n,slot:e},t?.map((e=>this._renderToolbarItem(e))),this._renderDuplicateButton(),this._renderDeleteButton(),i?.map((e=>this._renderToolbarItem(e))))]}_renderDefaultSelectionButton(){if(!this.viewModel.updateOnGraphicClick)return[];const{messages:e,state:t}=this;return this._renderToolbarItem({id:"pointer-select",text:e.selectFeature,icon:"cursor",onclick:this._activateDefaultSelectTool,active:"ready"===t})}_renderCreateToolActionGroup(){const e=this._effectiveAvailableCreateTools?.flatMap((e=>this._renderBuiltInCreateToolItem(e)))??[],t=this.customToolOptions?.flatMap((e=>this._renderCustomToolItem(e)))??[];return(0,Me.u)("div",{"allow-collapse":this.groupAllowCollapseOptions?.get("createTools")??!0,"group-kind":"overflow-group",key:"create-tools-group",priority:this.groupCollapsePriorities?.get("createTools")??te.High},e,t)}_renderBuiltInCreateToolItem(e){return this._renderToolbarItem({id:`${e}-button`,text:this.messages.draw[e],icon:Ut[e],onclick:()=>this._activateCreateTool(e),active:this.activeTool===e&&!this._activeCustomToolOptions})}_renderCustomToolItem(e){const{toolKey:t}=e;return this._renderToolbarItem({id:`custom-${e.toolKey}`,text:e.label,icon:e.icon,onclick:()=>this._activateCreateTool(e.toolName,null,e),active:this._activeCustomToolOptions?.toolKey===t})}_renderUndoButton(){return this.visibleElements.undoRedoMenu?this._renderToolbarItem({id:"undo-button",text:this.messages.undo,icon:"undo",disabled:!this.viewModel.canUndo(),onclick:this.undo,flipRTL:!0}):[]}_renderRedoButton(){return this.visibleElements.undoRedoMenu?this._renderToolbarItem({id:"redo-button",text:this.messages.redo,icon:"redo",disabled:!this.viewModel.canRedo(),onclick:this.redo,flipRTL:!0}):[]}_renderSettingsMenuButton(){return this.visibleElements.settingsMenu?this._renderToolbarItem({id:"settings-menu-action",text:this.messagesCommon.settings,icon:"gear",active:this._popoverOpen,onclick:()=>this._popoverOpen=!this._popoverOpen,afterCreate:e=>this._calcitePopoverReferenceElement=e,afterUpdate:e=>this._calcitePopoverReferenceElement=e,afterRemoved:()=>this._calcitePopoverReferenceElement=null}):[]}_renderFeatureCountChip(){if(!this.visibleElements.selectionCountLabel)return[];const{layout:e,messages:t,scale:i,id:n,updateGraphics:{length:o}}=this,s=(0,zt.n)(t.selectedCount,{count:o}),r="s"===i?99:999,a=o>r?(0,zt.n)(t.selectedCountTruncated,{truncated:r}):o,l="s"===i&&"vertical"===e,c=l?`${n}-selection-chip-small`:`${n}-selection-chip`;return[l?(0,Me.u)("span",{classes:{[Bt.chipVertical]:!0,[Bt.chipVerticalSmall]:"s"===this.scale},id:c,tabIndex:0,title:s},a):(0,Me.u)("calcite-chip",{appearance:"outline",class:"horizontal"===e?Bt.chipHorizontal:Bt.chipVertical,id:c,kind:"brand",label:s,scale:"l"===i?"m":"s",tabIndex:0,title:"vertical"===e?s:void 0},"vertical"===e?a:s)]}_renderDuplicateButton(){if(!this.visibleElements.duplicateButton)return[];const{messages:e}=this;return this._renderToolbarItem({id:"duplicate",text:this.updateGraphics.length>1?e.duplicateFeatures:e.duplicateFeature,icon:"copy",onclick:this._onDuplicateSelect})}_renderDeleteButton(){if(!this.visibleElements.deleteButton)return[];const{messages:e}=this,t=this.updateGraphics.length>1?e.deleteFeatures:e.deleteFeature;return this._renderToolbarItem({id:"delete",text:t,icon:"trash",onclick:this.delete})}_renderToolbarItem({id:e,text:t,icon:i,disabled:n,onclick:o,active:s,flipRTL:r,afterCreate:a,afterUpdate:l,afterRemoved:c}){const d=`${this.id}-${e}`;return[(0,Me.u)("calcite-action",{active:s,afterCreate:a,afterRemoved:c,afterUpdate:l,bind:this,"data-testid":e,disabled:n||"disabled"===this.state,icon:i,iconFlipRtl:r??!1,id:d,key:e,onclick:o,scale:this.scale,text:t,title:t})]}_remeasurePopoverSizes(e){try{const t=e.parentElement,i=this?.view?.container?.getBoundingClientRect(),n=t?.style;if(!(t&&i&&n&&this.view?.container?.contains(t)))return;const o=this._calcitePopoverReferenceElement;if(!o)return;const{bottom:s,top:r}=o.getBoundingClientRect();if("horizontal"===this.layout){const e=s<i.height/2;e!==("top"===this._relativeLocation)&&(this._relativeLocation=e?"top":"bottom"),e?(n?.setProperty("--sketch-view-height-offset",s-i.top+"px"),n?.setProperty("--sketch-view-margin-offset","30px")):(n?.setProperty("--sketch-view-height-offset",i.bottom-r+"px"),n?.setProperty("--sketch-view-margin-offset","15px"))}else"vertical"===this.layout&&(n.setProperty("--sketch-view-height-offset","15px"),n.setProperty("--sketch-view-margin-offset","15px"));const a=e.shadowRoot?.querySelector("div.header")?.getBoundingClientRect().height;n.setProperty("--sketch-popover-header-offset",`${a}px`)}catch(e){d.Z.getLogger(this.declaredClass).warnOnce("Sketch failed to lay out settings menu.",e)}}_activateCreateTool(e,t,i){const n=this._activeCustomToolOptions;if(i||n){if(i?.toolKey===n?.toolKey)return void this.cancel()}else if(this.activeTool===e)return void this.cancel();this._selectionToolbar?.cancel(),this.create(e,t,i)}_onDuplicateSelect(){const e=this.duplicate(),t=this.viewModel.activeTool;"transform"!==t&&"reshape"!==t||this.update(e,{tool:t})}_onSelectionOperationComplete(e){const{viewModel:{defaultUpdateOptions:t}}=this,{selection:i}=e;if(!e.aborted&&i.length){const e=t.tool,n=i.length>1&&"reshape"===e?"transform":e;this.update(i,{...t,tool:n})}this.notifyChange("state")}_activateDefaultSelectTool(){this.cancel(),this.view?.focus()}_refocusOnView(){this.activeTool&&this.view?.focus()}};(0,a._)([(0,y.Cb)()],Ht.prototype,"_activeCustomToolOptions",void 0),(0,a._)([(0,y.Cb)()],Ht.prototype,"activeTool",null),(0,a._)([(0,y.Cb)({readOnly:!0})],Ht.prototype,"activeTooltip",null),(0,a._)([(0,y.Cb)({cast:e=>{if(!e?.length)return null;const t=new Set(["point","polyline","polygon","rectangle","circle","multipoint","freehandPolyline","freehandPolygon","mesh"]);return e.filter((e=>t.has(e)))}})],Ht.prototype,"availableCreateTools",void 0),(0,a._)([(0,y.Cb)({readOnly:!0})],Ht.prototype,"createGraphic",null),(0,a._)([(0,y.Cb)()],Ht.prototype,"creationMode",null),(0,a._)([(0,y.Cb)()],Ht.prototype,"customToolOptions",void 0),(0,a._)([(0,y.Cb)()],Ht.prototype,"customActions",void 0),(0,a._)([(0,y.Cb)()],Ht.prototype,"defaultCreateOptions",null),(0,a._)([(0,y.Cb)()],Ht.prototype,"defaultUpdateOptions",null),(0,a._)([(0,y.Cb)()],Ht.prototype,"icon",null),(0,a._)([(0,y.Cb)()],Ht.prototype,"label",null),(0,a._)([(0,y.Cb)()],Ht.prototype,"labelOptions",null),(0,a._)([(0,y.Cb)()],Ht.prototype,"layer",null),(0,a._)([(0,y.Cb)({type:["horizontal","vertical"],value:"horizontal"})],Ht.prototype,"layout",null),(0,a._)([(0,y.Cb)({value:"m"})],Ht.prototype,"scale",null),(0,a._)([(0,y.Cb)()],Ht.prototype,"toolbarKind",void 0),(0,a._)([(0,y.Cb)()],Ht.prototype,"contextualToolLocation",void 0),(0,a._)([(0,y.Cb)()],Ht.prototype,"groupCollapsePriorities",void 0),(0,a._)([(0,y.Cb)()],Ht.prototype,"groupAllowCollapseOptions",void 0),(0,a._)([(0,y.Cb)(),(0,Ae.H)("esri/widgets/Sketch/t9n/Sketch")],Ht.prototype,"messages",void 0),(0,a._)([(0,y.Cb)(),(0,Ae.H)("esri/t9n/common")],Ht.prototype,"messagesCommon",void 0),(0,a._)([(0,y.Cb)()],Ht.prototype,"snappingOptions",null),(0,a._)([(0,y.Cb)()],Ht.prototype,"state",null),(0,a._)([(0,y.Cb)()],Ht.prototype,"tooltipOptions",null),(0,a._)([(0,y.Cb)({readOnly:!0})],Ht.prototype,"updateGraphics",null),(0,a._)([(0,y.Cb)({type:m.Z,nonNullable:!0})],Ht.prototype,"valueOptions",null),(0,a._)([(0,y.Cb)()],Ht.prototype,"view",null),(0,a._)([(0,y.Cb)({type:oe}),(0,Vt.s)(["create","update","undo","redo"])],Ht.prototype,"viewModel",null),(0,a._)([(0,y.Cb)({type:we,nonNullable:!0})],Ht.prototype,"visibleElements",void 0),(0,a._)([(0,y.Cb)()],Ht.prototype,"_effectiveAvailableCreateTools",null),(0,a._)([(0,y.Cb)()],Ht.prototype,"_defaultViewModel",void 0),(0,a._)([(0,y.Cb)()],Ht.prototype,"_calcitePopoverReferenceElement",void 0),(0,a._)([(0,y.Cb)()],Ht.prototype,"_relativeLocation",void 0),(0,a._)([(0,y.Cb)()],Ht.prototype,"_popoverOpen",void 0),Ht=(0,a._)([(0,g.j)("esri.widgets.Sketch")],Ht);const Gt=Ht;var jt=i(54503),Kt=i(8403);const Wt=i(49006).iv`@layer{arcgis-sketch{display:block}}`,Yt=(0,Kt.m)(Gt);class qt extends jt.oi{constructor(){super(),this.widget=Yt(this),this.viewModel=this.widget.viewModel,this._defaultGraphicsLayer=null,this.activeTool=this.widget.activeTool,this.autoDestroyDisabled=!1,this.availableCreateTools=this.widget.availableCreateTools,this.createGraphic=this.widget.createGraphic,this.creationMode=this.widget.creationMode,this.defaultCreateOptions=this.widget.defaultCreateOptions,this.defaultGraphicsLayerDisabled=!1,this.defaultUpdateOptions=this.widget.defaultUpdateOptions,this.hideCreateToolsCircle=this.widget.visibleElements.createTools.circle,this.hideCreateToolsPoint=this.widget.visibleElements.createTools.point,this.hideCreateToolsPolygon=this.widget.visibleElements.createTools.polygon,this.hideCreateToolsPolyline=this.widget.visibleElements.createTools.polyline,this.hideCreateToolsRectangle=this.widget.visibleElements.createTools.rectangle,this.hideDuplicateButton=this.widget.visibleElements.duplicateButton,this.hideDeleteButton=this.widget.visibleElements.deleteButton,this.hideSelectionCountLabel=this.widget.visibleElements.selectionCountLabel,this.hideLabelsToggle=this.widget.visibleElements.labelsToggle,this.hideSelectionToolsLassoSelection=this.widget.visibleElements.selectionTools["lasso-selection"],this.hideSelectionToolsRectangleSelection=this.widget.visibleElements.selectionTools["rectangle-selection"],this.hideSettingsMenu=this.widget.visibleElements.settingsMenu,this.hideSnappingControls=this.widget.visibleElements.snappingControls,this.hideSnappingControlsElementsEnabledToggle=this.widget.visibleElements.snappingControlsElements.enabledToggle,this.hideSnappingControlsElementsFeatureEnabledToggle=this.widget.visibleElements.snappingControlsElements.featureEnabledToggle,this.hideSnappingControlsElementsLayerList=this.widget.visibleElements.snappingControlsElements.layerList,this.hideSnappingControlsElementsSelfEnabledToggle=this.widget.visibleElements.snappingControlsElements.selfEnabledToggle,this.hideTooltipsToggle=this.widget.visibleElements.tooltipsToggle,this.hideUndoRedoMenu=this.widget.visibleElements.undoRedoMenu,this.icon=this.widget.icon,this.label=this.widget.label,this.labelOptions=this.widget.labelOptions,this.layer=this.widget.layer,this.layout=this.widget.layout,this.pointSymbol=this.viewModel.pointSymbol,this.polygonSymbol=this.viewModel.polygonSymbol,this.polylineSymbol=this.viewModel.polylineSymbol,this.position="bottom-left",this.scale=this.widget.scale,this.toolbarKind=this.widget.toolbarKind,this.showSnappingControlsElementsHeader=this.widget.visibleElements.snappingControlsElements.header,this.snappingOptions=this.widget.snappingOptions,this.state=this.widget.state,this.tooltipOptions=this.widget.tooltipOptions,this.updateGraphics=this.widget.updateGraphics,this.arcgisCreate=(0,s.Wk)((()=>this.widget),"create"),this.arcgisDelete=(0,s.Wk)((()=>this.widget),"delete"),this.arcgisPropertyChange=(0,o.OR)()("state"),this.arcgisReady=(0,jt.yM)(),this.arcgisRedo=(0,s.Wk)((()=>this.widget),"redo"),this.arcgisUndo=(0,s.Wk)((()=>this.widget),"undo"),this.arcgisUpdate=(0,s.Wk)((()=>this.widget),"update"),this.listen("arcgisReady",this._arcgisReadyHandler)}static{this.properties={activeTool:3,autoDestroyDisabled:5,availableCreateTools:0,createGraphic:0,creationMode:1,defaultCreateOptions:0,defaultGraphicsLayerDisabled:5,defaultUpdateOptions:0,hideCreateToolsCircle:5,hideCreateToolsPoint:5,hideCreateToolsPolygon:5,hideCreateToolsPolyline:5,hideCreateToolsRectangle:5,hideDuplicateButton:5,hideDeleteButton:5,hideSelectionCountLabel:5,hideLabelsToggle:5,hideSelectionToolsLassoSelection:5,hideSelectionToolsRectangleSelection:5,hideSettingsMenu:5,hideSnappingControls:5,hideSnappingControlsElementsEnabledToggle:5,hideSnappingControlsElementsFeatureEnabledToggle:5,hideSnappingControlsElementsLayerList:5,hideSnappingControlsElementsSelfEnabledToggle:5,hideTooltipsToggle:5,hideUndoRedoMenu:5,icon:1,label:1,labelOptions:0,layer:0,layout:1,pointSymbol:0,polygonSymbol:0,polylineSymbol:0,position:1,referenceElement:1,scale:1,toolbarKind:1,showSnappingControlsElementsHeader:5,snappingOptions:0,state:3,tooltipOptions:0,updateGraphics:0}}static{this.shadowRootOptions=jt.hZ}static{this.styles=Wt}async cancel(){this.widget?.cancel()}async complete(){this.widget?.complete()}async create(e,t){await(this.widget?.create(e,t))}async delete(){this.widget?.delete()}async destroy(){await this.manager.destroy()}async duplicate(){this.widget?.duplicate()}async redo(){this.widget?.redo()}async triggerUpdate(e,t){this.widget?.update(e,t)}async undo(){this.widget?.undo()}_arcgisReadyHandler(){this.defaultGraphicsLayerDisabled||(this._defaultGraphicsLayer=new r.Z({title:"Sketch Layer"}),this.widget.layer=this._defaultGraphicsLayer,this.el.view?.map?.add(this.widget.layer),this.manager.onLifecycle((()=>(0,p.YP)((()=>this.el.view?.map),((e,t)=>{if(this.widget.layer!==this._defaultGraphicsLayer)return;const i=this._defaultGraphicsLayer;t?.allLayers.includes(i)&&t.allLayers.remove(i),e?.add(i)})))),this.manager.onDestroy((()=>{this._defaultGraphicsLayer&&this.el.view?.map?.allLayers.includes(this._defaultGraphicsLayer)&&this.el.view?.map?.remove(this._defaultGraphicsLayer),this._defaultGraphicsLayer?.destroy(),this._defaultGraphicsLayer=null})))}}(0,n.c)("arcgis-sketch",qt)},47692:function(e,t,i){"use strict";i(36650),i(7337);var n=i(43625),o=i(15294),s=i(23230),r=i(54181),a=i(52642),l=i(49006);function c(e,t,i){const n=t[0]-e[0],o=t[1]-e[1];return n?(3*o/n-i)/2:i}function d(e,t,i,n,o){const[s,r]=e,[a,l]=t,c=(a-s)/3;return`C ${o([s+c,r+c*i]).join(",")} ${o([a-c,l-c*n]).join(",")} ${o([a,l]).join(",")}`}function u({data:e,min:t,max:i,t:n}){if(0===e.length)return"";const[o,s]=n(e[0]),[r,a]=n(t),[l]=n(i);let u,h,p;const y=e.reduce(((t,i,o)=>{if(h=e[o-2],p=e[o-1],o>1){const e=function(e,t,i){const n=t[0]-e[0],o=i[0]-t[0],s=(t[1]-e[1])/(n||o<0&&0),r=(i[1]-t[1])/(o||n<0&&0),a=(s*o+r*n)/(n+o);return(Math.sign(s)+Math.sign(r))*Math.min(Math.abs(s),Math.abs(r),.5*Math.abs(a))||0}(h,p,i),o=void 0===u?c(h,p,e):u,s=d(h,p,o,e,n);return u=e,`${t} ${s}`}return t}),`M ${r},${a} L ${r},${s} L ${o},${s}`),g=e[e.length-1];return`${y} ${d(p,g,u,c(p,g,u),n)} L ${l},${a} Z`}const h=l.iv`:host{display:block;block-size:100%}.svg{fill:currentColor;stroke:transparent;margin:0;display:block;block-size:100%;inline-size:100%;padding:0}.svg .graph-path--highlight{fill:var(--calcite-graph-highlight-fill-color, var(--calcite-color-brand));opacity:.5}:host([hidden]){display:none}[hidden]{display:none}`,p="svg",y="graph-path",g="graph-path--highlight";class m extends s.oi{constructor(){super(...arguments),this.graphId=`calcite-graph-${(0,r.g)()}`,this.resizeObserver=(0,a.c)("resize",(()=>this.requestUpdate())),this.data=[]}static{this.properties={colorStops:[0,{},{attribute:!1}],data:[0,{},{attribute:!1}],highlightMax:[9,{},{type:Number}],highlightMin:[9,{},{type:Number}],max:[11,{},{reflect:!0,type:Number}],min:[11,{},{reflect:!0,type:Number}]}}static{this.styles=h}connectedCallback(){super.connectedCallback(),this.resizeObserver?.observe(this.el)}disconnectedCallback(){super.disconnectedCallback(),this.resizeObserver?.disconnect()}render(){const{data:e,colorStops:t,el:i,highlightMax:n,highlightMin:r,min:a,max:l}=this,c=this.graphId,{clientHeight:d,clientWidth:h}=i;if(!e||0===e.length)return o.dy`<svg aria-hidden=true class=${(0,s.Vp)(p)} height=${d??s.Ld} preserveAspectRatio=none viewBox=${`0 0 ${h} ${d}`} width=${h??s.Ld}></svg>`;const{min:m,max:f}=function(e){const[t,i]=e[0],n=[t,i],o=[t,i];return e.reduce((({min:e,max:t},[i,n])=>({min:[Math.min(e[0],i),Math.min(e[1],n)],max:[Math.max(t[0],i),Math.max(t[1],n)]})),{min:n,max:o})}(e);let v=m,b=f;(a<m[0]||a>m[0])&&(v=[a,0]),(l>f[0]||l<f[0])&&(b=[l,f[1]]);const _=function({width:e,height:t,min:i,max:n}){const o=n[0]-i[0],s=n[1]-i[1];return n=>[(n[0]-i[0])/o*e,t-(n[1]-i[1])/s*t]}({min:v,max:b,width:h,height:d}),[w]=_([r,b[1]]),[C]=_([n,b[1]]),x=u({data:e,min:m,max:f,t:_}),S=t?`url(#linear-gradient-${c})`:void 0;return o.dy`<svg aria-hidden=true class=${(0,s.Vp)(p)} height=${d??s.Ld} preserveAspectRatio=none viewBox=${`0 0 ${h} ${d}`} width=${h??s.Ld}>${t?o.YP`<defs><linearGradient .id=${`linear-gradient-${c}`} x1=0 x2=1 y1=0 y2=0>${t.map((({offset:e,color:t,opacity:i})=>o.YP`<stop offset=${100*e+"%"} stop-color=${t??s.Ld} stop-opacity=${i??s.Ld} />`))}</linearGradient></defs>`:null}${void 0!==r?[o.YP`<mask height=100% .id=${`${c}1`} width=100% x=0% y=0%><path d=${`\n            M 0,0\n            L ${w-1},0\n            L ${w-1},${d}\n            L 0,${d}\n            Z\n          `} fill=white /></mask>`,o.YP`<mask height=100% .id=${`${c}2`} width=100% x=0% y=0%><path d=${`\n            M ${w+1},0\n            L ${C-1},0\n            L ${C-1},${d}\n            L ${w+1}, ${d}\n            Z\n          `} fill=white /></mask>`,o.YP`<mask height=100% .id=${`${c}3`} width=100% x=0% y=0%><path d=${`\n                M ${C+1},0\n                L ${h},0\n                L ${h},${d}\n                L ${C+1}, ${d}\n                Z\n              `} fill=white /></mask>`,o.YP`<path class=${(0,s.Vp)(y)} d=${x??s.Ld} fill=${S??s.Ld} mask=${`url(#${c}1)`} />`,o.YP`<path class=${(0,s.Vp)(g)} d=${x??s.Ld} fill=${S??s.Ld} mask=${`url(#${c}2)`} />`,o.YP`<path class=${(0,s.Vp)(y)} d=${x??s.Ld} fill=${S??s.Ld} mask=${`url(#${c}3)`} />`]:o.YP`<path class=${(0,s.Vp)(y)} d=${x??s.Ld} fill=${S??s.Ld} />`}</svg>`}}(0,n.c)("calcite-graph",m);var f=i(81879),v=i(73733),b=i(73444),_=i(58268),w=i(57618),C=i(15022),x=i(4431),S=i(113),E=i(44002),k=i(25064),L=i(54113),T=i(902),M=i(76299);const I="container",O="container--range",P="graph",A="handle",R="handle-extension",D="handle__label",$="handle__label--minValue",N="handle__label--value",F="hyphen",V="hyphen--wrap",z="static",Z="thumb",B="thumb--active",U="thumb-container",H="thumb--minValue",G="thumb--precise",j="thumb--value",K="tick",W="tick--active",Y="tick__label",q="tick__label--max",X="tick__label--min",J="ticks",Q="track",ee="track__range",te="transformed",ie="validationMessage",ne=l.iv`@charset "UTF-8";:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}.scale--s{--calcite-slider-handle-size: .625rem;--calcite-slider-handle-extension-height: .4rem;--calcite-slider-container-font-size: var(--calcite-font-size--3)}.scale--s .handle__label,.scale--s .tick__label{line-height:.75rem}.scale--m{--calcite-slider-handle-size: .875rem;--calcite-slider-handle-extension-height: .5rem;--calcite-slider-container-font-size: var(--calcite-font-size--2)}.scale--m .handle__label,.scale--m .tick__label{line-height:1rem}.scale--l{--calcite-slider-handle-size: 1rem;--calcite-slider-handle-extension-height: .65rem;--calcite-slider-container-font-size: var(--calcite-font-size--1)}.scale--l .handle__label,.scale--l .tick__label{line-height:1rem}.handle__label,.tick__label{font-weight:var(--calcite-font-weight-medium);color:var(--calcite-slider-text-color, var(--calcite-color-text-2));font-size:var(--calcite-slider-container-font-size)}:host{display:block}:host .validation-container{padding-block-start:0!important}.container{position:relative;display:block;overflow-wrap:normal;word-break:normal;padding-inline:calc(var(--calcite-slider-handle-size) * .5);padding-block:calc(var(--calcite-slider-handle-size) * .5);margin-block:calc(var(--calcite-slider-handle-size) * .5);margin-inline:0;--calcite-slider-full-handle-height: calc( var(--calcite-slider-handle-size) + var(--calcite-slider-handle-extension-height) );touch-action:none;-webkit-user-select:none;user-select:none}:host([disabled]) .track__range,:host([disabled]) .tick--active{background-color:var(--calcite-color-text-3)}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}.scale--s .thumb:not(.thumb--precise){--calcite-slider-thumb-y-offset: -.375rem}.scale--m .thumb:not(.thumb--precise){--calcite-slider-thumb-y-offset: -.5rem}.scale--l .thumb:not(.thumb--precise){--calcite-slider-thumb-y-offset: -.55rem}:host([precise]:not([has-histogram])) .container .thumb--value{--calcite-slider-thumb-y-offset: calc(var(--calcite-slider-full-handle-height) * -1)}.thumb-container{position:relative;max-inline-size:100%}.thumb{--calcite-slider-thumb-x-offset: calc(var(--calcite-slider-handle-size) * .5);position:absolute;margin:0;display:flex;cursor:pointer;flex-direction:column;align-items:center;border-style:none;background-color:transparent;padding:0;font-family:inherit;outline:2px solid transparent;outline-offset:2px;transform:translate(var(--calcite-slider-thumb-x-offset),var(--calcite-slider-thumb-y-offset))}.thumb .handle__label{white-space:nowrap}.thumb .handle__label.static,.thumb .handle__label.transformed{position:absolute;inset-block:0px;opacity:0}.thumb .handle__label.hyphen:after{content:"\u2014";display:inline-block;inline-size:1em}.thumb .handle__label.hyphen--wrap{display:flex}.thumb .handle{box-sizing:border-box;border-radius:9999px;outline-color:transparent;background-color:var(--calcite-slider-handle-fill-color, var(--calcite-color-foreground-1));block-size:var(--calcite-slider-handle-size);inline-size:var(--calcite-slider-handle-size);box-shadow:0 0 0 2px var(--calcite-color-text-3) inset;transition:border var(--calcite-internal-animation-timing-medium) ease,background-color var(--calcite-internal-animation-timing-medium) ease,box-shadow var(--calcite-animation-timing) ease}.thumb .handle-extension{inline-size:.125rem;block-size:var(--calcite-slider-handle-extension-height);background-color:var(--calcite-slider-handle-extension-color, var(--calcite-color-text-3))}.thumb:hover .handle{box-shadow:0 0 0 3px var(--calcite-color-brand) inset}.thumb:hover .handle-extension{background-color:var(--calcite-slider-accent-color, var(--calcite-color-brand))}.thumb:focus .handle{outline:2px solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline-offset:calc(2px*(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}.thumb:focus .handle-extension{background-color:var(--calcite-slider-accent-color, var(--calcite-color-brand))}.thumb.thumb--minValue{transform:translate(calc(var(--calcite-slider-thumb-x-offset) * -1),var(--calcite-slider-thumb-y-offset))}.thumb.thumb--precise{--calcite-slider-thumb-y-offset: -.125rem}:host([label-handles]) .thumb{--calcite-slider-thumb-x-offset: 50%}:host([label-handles]):host(:not([has-histogram])) .scale--s .thumb:not(.thumb--precise){--calcite-slider-thumb-y-offset: -1.4375rem}:host([label-handles]):host(:not([has-histogram])) .scale--m .thumb:not(.thumb--precise){--calcite-slider-thumb-y-offset: -1.875rem}:host([label-handles]):host(:not([has-histogram])) .scale--l .thumb:not(.thumb--precise){--calcite-slider-thumb-y-offset: -2rem}:host([has-histogram][label-handles]) .handle__label,:host([label-handles]:not([has-histogram])) .thumb--minValue.thumb--precise .handle__label{margin-block-start:.5em}:host(:not([has-histogram]):not([precise])) .handle__label,:host([label-handles]:not([has-histogram])) .thumb--value .handle__label{margin-block-end:.5em}:host([label-handles][precise]):host(:not([has-histogram])) .scale--s .thumb--value{--calcite-slider-thumb-y-offset: -2.075rem}:host([label-handles][precise]):host(:not([has-histogram])) .scale--m .thumb--value{--calcite-slider-thumb-y-offset: -2.75rem}:host([label-handles][precise]):host(:not([has-histogram])) .scale--l .thumb--value{--calcite-slider-thumb-y-offset: -3.0625rem}.thumb:focus .handle,.thumb--active .handle{background-color:var(--calcite-slider-accent-color, var(--calcite-color-brand));box-shadow:0 0 8px #00000029}.thumb:hover.thumb--precise:after,.thumb:focus.thumb--precise:after,.thumb--active.thumb--precise:after{background-color:var(--calcite-slider-accent-color, var(--calcite-color-brand))}.track{position:relative;block-size:.125rem;border-radius:0;background-color:var(--calcite-slider-track-color, var(--calcite-color-border-2));transition:all var(--calcite-internal-animation-timing-medium) ease-in}.track__range{position:absolute;inset-block-start:0px;block-size:.125rem;background-color:var(--calcite-slider-track-fill-color, var(--calcite-color-brand))}.container--range .track__range:hover{cursor:ew-resize}.container--range .track__range:after{position:absolute;inline-size:100%;content:"";inset-block-start:calc(var(--calcite-slider-full-handle-height) * .5 * -1);block-size:calc(var(--calcite-slider-handle-size) + var(--calcite-slider-handle-extension-height))}@media (forced-colors: active){.thumb{outline-width:0;outline-offset:0}.handle{outline:2px solid transparent;outline-offset:2px}.thumb:focus .handle,.thumb .handle-extension,.thumb:hover .handle-extension,.thumb:focus .handle-extension,.thumb:active .handle-extension{background-color:canvasText}.track{background-color:canvasText}.track__range{background-color:highlight}}.tick{position:absolute;block-size:.25rem;inline-size:.125rem;border-width:1px;border-style:solid;background-color:var(--calcite-slider-tick-color, var(--calcite-color-border-input));border-color:var(--calcite-slider-tick-border-color, var(--calcite-color-foreground-1));inset-block-start:-2px;pointer-events:none;margin-inline-start:-.125rem}.tick--active{background-color:var(--calcite-slider-tick-selected-color, var(--calcite-color-brand))}.tick__label{pointer-events:none;margin-block-start:.875rem;display:flex;justify-content:center}.tick__label--min{transition:opacity var(--calcite-animation-timing)}.tick__label--max{transition:opacity var(--calcite-internal-animation-timing-fast)}:host([has-histogram][label-handles]) .tick__label--min,:host([has-histogram][label-handles]) .tick__label--max,:host([has-histogram][precise]) .tick__label--min,:host([has-histogram][precise]) .tick__label--max{font-weight:var(--calcite-font-weight-normal);color:var(--calcite-color-text-3)}.graph{color:var(--calcite-slider-graph-color, var(--calcite-color-foreground-3));block-size:48px}:host([label-ticks][ticks]) .container{padding-block-end:calc(.875rem + var(--calcite-slider-container-font-size))}:host([has-histogram]):host([precise][label-handles]) .container{padding-block-end:calc(var(--calcite-slider-full-handle-height) + 1em)}:host([has-histogram]):host([label-handles]:not([precise])) .container{padding-block-end:calc(var(--calcite-slider-handle-size) * .5 + 1em)}:host([has-histogram]):host([precise]:not([label-handles])) .container{padding-block-end:var(--calcite-slider-full-handle-height)}:host(:not([has-histogram])):host([precise]:not([label-handles])) .container{padding-block-start:var(--calcite-slider-full-handle-height)}:host(:not([has-histogram])):host([precise]:not([label-handles])) .container--range{padding-block-end:var(--calcite-slider-full-handle-height)}:host(:not([has-histogram])):host([label-handles]:not([precise])) .container{padding-block-start:calc(var(--calcite-slider-full-handle-height) + 4px)}:host(:not([has-histogram])):host([label-handles][precise]) .container{padding-block-start:calc(var(--calcite-slider-full-handle-height) + var(--calcite-slider-container-font-size) + 4px)}:host(:not([has-histogram])):host([label-handles][precise]) .container--range{padding-block-end:calc(var(--calcite-slider-full-handle-height) + var(--calcite-slider-container-font-size) + 4px)}.validation-container{display:flex;flex-direction:column;align-items:flex-start;align-self:stretch}:host([scale=m]) .validation-container,:host([scale=l]) .validation-container{padding-block-start:.5rem}:host([scale=s]) .validation-container{padding-block-start:.25rem}::slotted(input[slot=hidden-form-input]){margin:0!important;opacity:0!important;outline:none!important;padding:0!important;position:absolute!important;inset:0!important;transform:none!important;-webkit-appearance:none!important;z-index:-1!important}:host([hidden]){display:none}[hidden]{display:none}`;function oe(e){return Array.isArray(e)}class se extends s.oi{constructor(){super(),this.activeProp="value",this.dragEnd=e=>{this.disabled||(this.removeDragListeners(),this.focusActiveHandle(e.clientX),this.lastDragPropValue!=this[this.dragProp]&&this.emitChange(),this.dragProp=null,this.lastDragPropValue=null,this.minValueDragRange=null,this.maxValueDragRange=null,this.minMaxValueRange=null)},this.dragUpdate=e=>{if(!this.disabled&&(e.preventDefault(),this.dragProp)){const t=this.mapToRange(e.clientX||e.pageX);if(oe(this.value)&&"minMaxValue"===this.dragProp)if(this.minValueDragRange&&this.maxValueDragRange&&this.minMaxValueRange){const e=t-this.minValueDragRange,i=t+this.maxValueDragRange;i<=this.max&&e>=this.min&&i-e===this.minMaxValueRange&&this.setValue({minValue:this.clamp(e,"minValue"),maxValue:this.clamp(i,"maxValue")})}else this.minValueDragRange=t-this.minValue,this.maxValueDragRange=this.maxValue-t,this.minMaxValueRange=this.maxValue-this.minValue;else this.setValue({[this.dragProp]:this.clamp(t,this.dragProp)})}},this.formatValue=e=>(L.n.numberFormatOptions={locale:this.messages._lang,numberingSystem:this.numberingSystem,useGrouping:this.groupSeparator},L.n.localize(e.toString())),this.guid=`calcite-slider-${(0,r.g)()}`,this.messages=(0,M.u)({name:null}),this.pointerUpDragEnd=e=>{!this.disabled&&(0,_.i)(e)&&this.dragEnd(e)},this.maxValueDragRange=null,this.minMaxValueRange=null,this.minValueDragRange=null,this.tickValues=[],this.disabled=!1,this.fillPlacement="start",this.groupSeparator=!1,this.hasHistogram=!1,this.labelHandles=!1,this.labelTicks=!1,this.max=100,this.min=0,this.mirrored=!1,this.precise=!1,this.required=!1,this.scale="m",this.snap=!1,this.status="idle",this.step=1,this.validity={valid:!1,badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1},this.value=0,this.calciteSliderChange=(0,s.yM)({cancelable:!1}),this.calciteSliderInput=(0,s.yM)({cancelable:!1}),this.listen("pointerdown",this.pointerDownHandler),this.listen("keydown",this.handleKeyDown),this.listen("touchstart",this.handleTouchStart)}static{this.properties={maxValueDragRange:[16,{},{state:!0}],minMaxValueRange:[16,{},{state:!0}],minValueDragRange:[16,{},{state:!0}],tickValues:[16,{},{state:!0}],disabled:[7,{},{reflect:!0,type:Boolean}],fillPlacement:[3,{},{reflect:!0}],form:[3,{},{reflect:!0}],groupSeparator:[7,{},{reflect:!0,type:Boolean}],hasHistogram:[7,{},{reflect:!0,type:Boolean}],histogram:[0,{},{attribute:!1}],histogramStops:[0,{},{attribute:!1}],labelFormatter:[0,{},{attribute:!1}],labelHandles:[7,{},{reflect:!0,type:Boolean}],labelTicks:[7,{},{reflect:!0,type:Boolean}],max:[11,{},{reflect:!0,type:Number}],maxLabel:1,maxValue:[9,{},{type:Number}],min:[11,{},{reflect:!0,type:Number}],minLabel:1,minValue:[9,{},{type:Number}],mirrored:[7,{},{reflect:!0,type:Boolean}],name:[3,{},{reflect:!0}],numberingSystem:1,pageStep:[11,{},{reflect:!0,type:Number}],precise:[7,{},{reflect:!0,type:Boolean}],required:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],snap:[7,{},{reflect:!0,type:Boolean}],status:[3,{},{reflect:!0}],step:[11,{},{reflect:!0,type:Number}],ticks:[11,{},{reflect:!0,type:Number}],validationIcon:[3,{converter:s.Kb},{reflect:!0}],validationMessage:1,validity:[0,{},{attribute:!1}],value:[11,{},{type:Number,reflect:!0}]}}static{this.shadowRootOptions={mode:"open",delegatesFocus:!0}}static{this.styles=ne}async setFocus(){await(0,k.c)(this);(this.minHandle?this.minHandle:this.maxHandle)?.focus()}connectedCallback(){super.connectedCallback(),this.setMinMaxFromValue(),this.setValueFromMinMax(),(0,E.c)(this),(0,C.c)(this)}load(){oe(this.value)||(this.value=this.snap?this.getClosestStep(this.value):this.clamp(this.value)),(0,C.a)(this,this.value)}willUpdate(e){e.has("histogram")&&(this.hasHistogram=!!this.histogram),e.has("ticks")&&(this.tickValues=this.generateTickValues()),e.has("value")&&(this.hasUpdated||0!==this.value)&&this.setMinMaxFromValue(),(e.has("minValue")||e.has("maxValue"))&&this.setValueFromMinMax()}updated(){this.labelHandles&&(this.adjustHostObscuredHandleLabel("value"),oe(this.value)&&(this.adjustHostObscuredHandleLabel("minValue"),this.precise&&!this.hasHistogram||this.hyphenateCollidingRangeHandleLabels())),this.hideObscuredBoundingTickLabels(),(0,x.u)(this)}disconnectedCallback(){super.disconnectedCallback(),(0,E.d)(this),(0,C.d)(this),this.removeDragListeners()}handleKeyDown(e){const t=this.shouldMirror(),{activeProp:i,max:n,min:o,pageStep:s,step:r}=this,a=this[i],{key:l}=e;if((0,S.i)(l))return void e.preventDefault();let c;if("ArrowUp"===l||"ArrowRight"===l){c=a+r*(t&&"ArrowRight"===l?-1:1)}else if("ArrowDown"===l||"ArrowLeft"===l){c=a-r*(t&&"ArrowLeft"===l?-1:1)}else"PageUp"===l?s&&(c=a+s):"PageDown"===l?s&&(c=a-s):"Home"===l?c=o:"End"===l&&(c=n);if(isNaN(c))return;e.preventDefault();const d=Number(c.toFixed((0,T.d)(r)));this.setValue({[i]:this.clamp(d,i)})}pointerDownHandler(e){if(this.disabled||!(0,_.i)(e))return;const t=e.clientX||e.pageX,i=this.mapToRange(t);let n="value";if(oe(this.value)){if(i>=this.minValue&&i<=this.maxValue&&"minMaxValue"===this.lastDragProp)n="minMaxValue";else{n=Math.abs(this.maxValue-i)<Math.abs(this.minValue-i)||i>=this.maxValue?"maxValue":"minValue"}}this.lastDragPropValue=this[n],this.dragStart(n);this.el.shadowRoot.querySelector(`.${Z}:active`)||this.setValue({[n]:this.clamp(i,n)}),this.focusActiveHandle(t)}handleTouchStart(e){e.preventDefault()}buildThumbType(e){const t=[e];return this.labelHandles&&t.push("labeled"),this.precise&&t.push("precise"),this.hasHistogram&&t.push("histogram"),t.join("-")}setValueFromMinMax(){const{minValue:e,maxValue:t}=this;"number"==typeof e&&"number"==typeof t&&(this.value=[e,t])}setMinMaxFromValue(){const{value:e}=this;oe(e)&&(this.minValue=e[0],this.maxValue=e[1])}onLabelClick(){this.setFocus()}shouldMirror(){return this.mirrored&&!this.hasHistogram}shouldUseMinValue(){return!!oe(this.value)&&(this.hasHistogram&&0===this.maxValue||!this.hasHistogram&&0===this.minValue)}getTickDensity(){const e=(this.max-this.min)/this.ticks/250;return e<1?1:e}generateTickValues(){const e=this.ticks??0;if(e<=0)return[];const t=[this.min],i=e*this.getTickDensity();let n=this.min;for(;n<this.max;)n+=i,t.push(Math.min(n,this.max));return t.includes(this.max)||t.push(this.max),t}onThumbBlur(){this.activeProp=null}onThumbFocus(e){const t=e.currentTarget;this.activeProp=t.getAttribute("data-value-prop")}onThumbPointerDown(e){const t=e.currentTarget;this.pointerDownDragStart(e,t.getAttribute("data-value-prop"))}onTrackPointerDown(e){this.pointerDownDragStart(e,"minMaxValue")}pointerDownDragStart(e,t){(0,_.i)(e)&&this.dragStart(t)}dragStart(e){this.dragProp=e,this.lastDragProp=this.dragProp,this.activeProp=e,window.addEventListener("pointermove",this.dragUpdate),window.addEventListener("pointerup",this.pointerUpDragEnd),window.addEventListener("pointercancel",this.dragEnd)}focusActiveHandle(e){"minValue"===this.dragProp?this.minHandle.focus():"maxValue"===this.dragProp||"value"===this.dragProp?this.maxHandle.focus():"minMaxValue"===this.dragProp&&this.getClosestHandle(e).focus()}emitInput(){this.calciteSliderInput.emit()}emitChange(){this.calciteSliderChange.emit()}removeDragListeners(){window.removeEventListener("pointermove",this.dragUpdate),window.removeEventListener("pointerup",this.pointerUpDragEnd),window.removeEventListener("pointercancel",this.dragEnd)}setValue(e){let t;if(Object.keys(e).forEach((i=>{const n=e[i];if(!t){const e=this[i];t=e!==n}this[i]=n})),!t)return;this.dragProp||this.emitChange(),this.emitInput()}storeTrackRef(e){this.trackEl=e}storeThumbRef(e){if(!e)return;"minValue"===e.getAttribute("data-value-prop")?this.minHandle=e:this.maxHandle=e}clamp(e,t){return e=(0,T.c)(e,this.min,this.max),"maxValue"===t&&(e=Math.max(e,this.minValue)),"minValue"===t&&(e=Math.min(e,this.maxValue)),e}mapToRange(e){const t=this.max-this.min,{left:i,width:n}=this.trackEl.getBoundingClientRect(),o=(e-i)/n,s=this.shouldMirror(),r=this.clamp(this.min+t*(s?1-o:o)),a=Number(r.toFixed((0,T.d)(this.step)));return this.snap&&this.step?this.getClosestStep(a):a}getClosestStep(e){const{max:t,min:i,step:n}=this,o=new L.B(`${Math.floor((e-i)/n)}`).multiply(`${n}`).add(`${i}`).toString();let s=this.clamp(Number(o));return s>t&&(s-=n),s}getClosestHandle(e){return this.getDistanceX(this.maxHandle,e)>this.getDistanceX(this.minHandle,e)?this.minHandle:this.maxHandle}getDistanceX(e,t){return Math.abs(e.getBoundingClientRect().left-t)}getFontSizeForElement(e){return Number(window.getComputedStyle(e).getPropertyValue("font-size").match(/\d+/)[0])}getUnitInterval(e){e=this.clamp(e);const t=this.max-this.min;return(e-this.min)/t}adjustHostObscuredHandleLabel(e){const t=this.el.shadowRoot.querySelector(`.handle__label--${e}`),i=this.el.shadowRoot.querySelector(`.handle__label--${e}.static`),n=this.el.shadowRoot.querySelector(`.handle__label--${e}.transformed`),o=i.getBoundingClientRect(),s=this.getHostOffset(o.left,o.right);t.style.transform=`translateX(${s}px)`,n.style.transform=`translateX(${s}px)`}hyphenateCollidingRangeHandleLabels(){const{shadowRoot:e}=this.el,t=this.shouldMirror(),i=t?"value":"minValue",n=t?"minValue":"value",o=e.querySelector(`.handle__label--${i}`),s=e.querySelector(`.handle__label--${i}.static`),r=e.querySelector(`.handle__label--${i}.transformed`),a=this.getHostOffset(s.getBoundingClientRect().left,s.getBoundingClientRect().right),l=e.querySelector(`.handle__label--${n}`),c=e.querySelector(`.handle__label--${n}.static`),d=e.querySelector(`.handle__label--${n}.transformed`),u=this.getHostOffset(c.getBoundingClientRect().left,c.getBoundingClientRect().right),h=this.getFontSizeForElement(o),p=this.getRangeLabelOverlap(r,d),y=o,g=h/2;if(p>0){if(y.classList.add(F,V),0===u&&0===a){let e=p/2-g;e=-1===Math.sign(e)?Math.abs(e):-e;const t=this.getHostOffset(r.getBoundingClientRect().left+e-g,r.getBoundingClientRect().right+e-g);let i=p/2;const n=this.getHostOffset(d.getBoundingClientRect().left+i,d.getBoundingClientRect().right+i);0!==t&&(e+=t,i+=t),0!==n&&(e+=n,i+=n),o.style.transform=`translateX(${e}px)`,r.style.transform=`translateX(${e-g}px)`,l.style.transform=`translateX(${i}px)`,d.style.transform=`translateX(${i}px)`}else if(a>0||u>0)o.style.transform=`translateX(${a+g}px)`,l.style.transform=`translateX(${p+u}px)`,d.style.transform=`translateX(${p+u}px)`;else if(a<0||u<0){let e=Math.abs(a)+p-g;e=-1===Math.sign(e)?Math.abs(e):-e,o.style.transform=`translateX(${e}px)`,r.style.transform=`translateX(${e-g}px)`}}else y.classList.remove(F,V),o.style.transform=`translateX(${a}px)`,r.style.transform=`translateX(${a}px)`,l.style.transform=`translateX(${u}px)`,d.style.transform=`translateX(${u}px)`}hideObscuredBoundingTickLabels(){const e=oe(this.value);if(!(this.hasHistogram||e||this.labelHandles||this.precise))return;if(!this.hasHistogram&&!e&&this.labelHandles&&!this.precise)return;if(!this.hasHistogram&&!e&&!this.labelHandles&&this.precise)return;if(!this.hasHistogram&&!e&&this.labelHandles&&this.precise)return;if(!this.hasHistogram&&e&&!this.precise)return;if(this.hasHistogram&&!this.precise&&!this.labelHandles)return;const t=this.el.shadowRoot.querySelector(`.${H}`),i=this.el.shadowRoot.querySelector(`.${j}`),n=this.el.shadowRoot.querySelector(`.${X}`),o=this.el.shadowRoot.querySelector(`.${q}`);!t&&i&&n&&o&&(n.style.opacity=this.isMinTickLabelObscured(n,i)?"0":"1",o.style.opacity=this.isMaxTickLabelObscured(o,i)?"0":"1"),t&&i&&n&&o&&(n.style.opacity=this.isMinTickLabelObscured(n,t)||this.isMinTickLabelObscured(n,i)?"0":"1",o.style.opacity=this.isMaxTickLabelObscured(o,t)||this.isMaxTickLabelObscured(o,i)&&this.hasHistogram?"0":"1")}getHostOffset(e,t){const{left:i,right:n}=this.el.getBoundingClientRect();return e<i?i-e:t>n?-(t-n):0}getRangeLabelOverlap(e,t){const i=e.getBoundingClientRect(),n=t.getBoundingClientRect(),o=this.getFontSizeForElement(e),s=i.right+o-n.left;return Math.max(s,0)}isMinTickLabelObscured(e,t){const i=e.getBoundingClientRect(),n=t.getBoundingClientRect();return(0,_.j)(i,n)}isMaxTickLabelObscured(e,t){const i=e.getBoundingClientRect(),n=t.getBoundingClientRect();return(0,_.j)(i,n)}internalLabelFormatter(e,t){const i=this.labelFormatter;if(!i)return this.formatValue(e);const n=i(e,t,this.formatValue);return null==n?this.formatValue(e):n}render(){const e=this.el.id||this.guid,t=oe(this.value)?this.maxValue:this.value,i=this.minValue||this.min,n=this.shouldUseMinValue(),o=100*this.getUnitInterval(n?this.minValue:i),r=100*this.getUnitInterval(t),a=this.shouldMirror(),l=oe(this.value),c=this.buildThumbType("max"),d=this.renderThumb({type:c,thumbPlacement:c.includes("histogram")?"below":"above",maxInterval:r,minInterval:o,mirror:a}),u=this.buildThumbType("min"),h=l?this.renderThumb({type:u,thumbPlacement:u.includes("histogram")||u.includes("precise")?"below":"above",maxInterval:r,minInterval:o,mirror:a}):null,p=l?"start":this.fillPlacement,y="none"===p?{left:"unset",right:"unset"}:"end"===p?{left:`${a?o:r}%`,right:`${a?r:o}%`}:{left:`${a?100-r:o}%`,right:`${a?o:100-r}%`};return(0,s.P$)(this.el,"id",e),(0,x.I)({disabled:this.disabled,children:b.dy`<div aria-errormessage=${ie} .ariaInvalid=${"invalid"===this.status} .ariaLabel=${(0,E.g)(this)} class=${(0,s.Vp)({[I]:!0,[O]:l,[`scale--${this.scale}`]:!0})}>${this.renderGraph()}<div class=${(0,s.Vp)(Q)} ${(0,f.i)(this.storeTrackRef)}><div class=${(0,s.Vp)(ee)} @pointerdown=${this.onTrackPointerDown} style=${(0,s.kA)(y)}></div><div class=${(0,s.Vp)(J)}>${this.tickValues.map((e=>{const o=100*this.getUnitInterval(e)+"%";let r=!1;if("start"===p||"end"===p)if(n)r=e>=this.minValue&&e<=this.maxValue;else{const n="start"===p?i:t,o="start"===p?t:this.max;r=e>=n&&e<=o}return b.dy`<span class=${(0,s.Vp)({[K]:!0,[W]:r})} style=${(0,s.kA)({left:a?"":o,right:a?o:""})}>${this.renderTickLabel(e)}</span>`}))}</div></div><div class=${(0,s.Vp)(U)}>${h}${d}${(0,C.H)({component:this})}</div></div>${this.validationMessage&&"invalid"===this.status?(0,w.V)({icon:this.validationIcon,id:ie,message:this.validationMessage,scale:this.scale,status:this.status}):null}`})}renderThumb({type:e,mirror:t,thumbPlacement:i,minInterval:n,maxInterval:o}){const r=e.includes("labeled"),a=e.includes("precise"),l=e.includes("min"),c=oe(this.value),d=l?this.minValue:c?this.maxValue:this.value,u=l?"minValue":c?"maxValue":"value",h=l?this.minLabel:c?this.maxLabel:this.minLabel,p=l?this.minValue:d,y="minValue"===u?this.internalLabelFormatter(this.minValue,"min"):"maxValue"===u?this.internalLabelFormatter(this.maxValue,"max"):this.internalLabelFormatter(d,"value"),g=l?{left:`${t?100-n:n}%`}:{right:`${t?o:100-o}%`},m=`${D} ${l?$:N}`,_=[...r?[b.dy`<span aria-hidden=true class=${(0,s.Vp)(m)}>${y}</span>`,b.dy`<span aria-hidden=true class=${`${m} ${z}`}>${y}</span>`,b.dy`<span aria-hidden=true class=${`${m} ${te}`}>${y}</span>`]:[],b.dy`<div class=${(0,s.Vp)(A)}></div>`,a&&b.dy`<div class=${(0,s.Vp)(R)}></div>`||""];return"below"===i&&_.reverse(),(0,v.U)(e,b.dy`<div .ariaLabel=${h} aria-orientation=horizontal .ariaValueMax=${this.max} .ariaValueMin=${this.min} .ariaValueNow=${p} class=${(0,s.Vp)({[Z]:!0,[j]:!l,[B]:"minMaxValue"!==this.lastDragProp&&this.dragProp===u,[G]:a,[H]:l})} data-value-prop=${u??b.Ld} @blur=${this.onThumbBlur} @focus=${this.onThumbFocus} @pointerdown=${this.onThumbPointerDown} role=slider style=${(0,s.kA)(g)} tabindex=0 ${(0,f.i)(this.storeThumbRef)}>${_}</div>`)}renderGraph(){return this.histogram?b.dy`<calcite-graph class=${(0,s.Vp)(P)} .colorStops=${this.histogramStops} .data=${this.histogram} .highlightMax=${oe(this.value)?this.maxValue:this.value} .highlightMin=${oe(this.value)?this.minValue:this.min} .max=${this.max} .min=${this.min}></calcite-graph>`:null}renderTickLabel(e){const{hasHistogram:t,labelHandles:i,labelTicks:n,max:o,min:r,precise:a,value:l}=this,c=oe(l),d=e===r,u=e===o,h=d||u;return n&&(!t&&(h||!a||!c)||t&&(h||!a&&!i))?b.dy`<span class=${(0,s.Vp)({[Y]:!0,[X]:d,[q]:u})}>${this.internalLabelFormatter(e,"tick")}</span>`:null}}(0,n.c)("calcite-slider",se);i(61637),i(69397),i(4204);var re=i(64297),ae=i(20803),le=i(21042),ce=i(54503);const de=(0,ae.qK)(re.g);var ue=i(46789),he=i(47650),pe=i(90403);class ye extends ue.lZ{#t=void 0;constructor(e,t){super(e,t),new he.V(this.component)}hostLoad(){this.#t=(0,pe.YP)((()=>this.component.el.view),(e=>{this.instance.view=e,this.instance.map=e?.map}),{sync:!0,initial:!0})}hostDestroy(){this.#t?.remove(),super.hostDestroy()}}const ge=(0,ae.j8)(ye);var me=i(46490);const fe="esri-widget__heading",ve="esri-widget esri-component",be="esri-widget--disabled";function _e({level:e,class:t,children:i}){const n=function(e){return function(e,t,i){return Math.min(Math.max(e,t),i)}(Math.ceil(e),1,6)}(e),o=`h${n}`,s=(0,me.s2)(o);return me.dy`<${s} .ariaLevel=${String(n)} class=${(0,ce.Vp)((0,le.Sh)(fe,t))} role=heading>${i}</${s}>`}var we=i(70880),Ce=i(49898),xe=i(76224),Se=i(85953),Ee=i(86470),ke=i(26221),Le=i(47826);const Te="arcgis-weather",Me={base:Te,content:`${Te}__content`,hasError:`${Te}__content--has-error`,selector:`${Te}__selector`,options:`${Te}__options`,optionsHidden:`${Te}__options--hidden`,error:`${Te}__error`,warning:`${Te}__warning`},Ie=l.iv`@layer{.arcgis-weather{position:relative;padding:var(--esri-widget-padding);width:fit-content}.arcgis-weather__content{display:flex;flex-direction:column;gap:var(--calcite-spacing-md);width:min-content}.arcgis-weather__content--has-error{visibility:hidden;height:0;overflow:hidden;pointer-events:none}.arcgis-weather__selector{display:flex;flex-direction:row;gap:var(--calcite-spacing-sm);align-items:center}.arcgis-weather__options{display:flex;flex-direction:column;gap:var(--calcite-spacing-sm);calcite-label:last-child{--calcite-label-margin-bottom: 0}}.arcgis-weather__options--hidden{display:none}.arcgis-weather__warning{display:flex;flex-direction:row;gap:var(--calcite-spacing-xs);align-items:center;font-size:var(--calcite-font-size-sm);calcite-icon{color:var(--calcite-color-status-warning)}}}`;var Oe=Object.defineProperty,Pe=Object.getOwnPropertyDescriptor,Ae=(e,t,i,n)=>{for(var o,s=n>1?void 0:n?Pe(t,i):t,r=e.length-1;r>=0;r--)(o=e[r])&&(s=(n?o(t,i,s):o(s))||s);return n&&s&&Oe(t,i,s),s};const Re={sunny:Le.Z,cloudy:xe.Z,rainy:Ee.Z,snowy:ke.Z,foggy:Se.Z},De=Object.keys(Re);let $e=class extends we.Z{constructor(e){super(e),this.view=null,this._settingWeather=!1,this._weatherByType={sunny:new Le.Z,cloudy:new xe.Z,rainy:new Ee.Z,snowy:new ke.Z,foggy:new Se.Z}}initialize(){this.addHandles([(0,pe.YP)((()=>this.current),(e=>{this._settingWeather||null==e||(this._weatherByType={...this._weatherByType,[e.type]:e})}),{sync:!0,initial:!0})])}get state(){if(!this.view?.ready)return"disabled";if(null!=this.error){if("not-visible"===this.error)return"ready";return"error"}return"ready"}get disabled(){return"disabled"===this.state}get weatherByType(){return this._weatherByType}get error(){const e=this.view;return e?.ready?"3d"!==e.type?"unsupported-view":"local"===e.viewingMode?"local-scene":e.environment.atmosphereEnabled?e.environment.weatherAvailable?null:"not-visible":"no-atmosphere":null}get current(){return this._environment?.weather??this._weatherByType.sunny}set current(e){const t=this._environment;t&&(t.weather=e)}get _environment(){const e=this.view;return null!=e&&"3d"===e.type?e.environment:null}setWeatherByType(e){if(!De.includes(e))return void console.warn(`arcgis-weather - "${e}" is not a valid weather type`);const t=this._environment;null!=t&&(this._settingWeather=!0,t.weather=this._weatherByType[e],this._settingWeather=!1)}setSnowCoverEnabled(e){const t=this.current;"snowCover"in t&&(t.snowCover=e?"enabled":"disabled")}};function Ne({label:e,value:t,disabled:i,onChange:n}){const s=e=>{const t=e.currentTarget.value;n?.(t)};return o.dy`<calcite-label scale=s>${e}<calcite-slider aria-label=${e??ce.Ld} .disabled=${i} style=${(0,ce.kA)({marginInline:"-7px",marginBottom:"-7px"})} max=1 min=0 step=0.01 .value=${t??0} @calciteSliderChange=${s} @calciteSliderInput=${s}></calcite-slider></calcite-label>`}Ae([(0,Ce.Cb)()],$e.prototype,"view",2),Ae([(0,Ce.Cb)()],$e.prototype,"state",1),Ae([(0,Ce.Cb)()],$e.prototype,"disabled",1),Ae([(0,Ce.Cb)()],$e.prototype,"weatherByType",1),Ae([(0,Ce.Cb)()],$e.prototype,"error",1),Ae([(0,Ce.Cb)()],$e.prototype,"current",1),Ae([(0,Ce.Cb)()],$e.prototype,"_weatherByType",2),Ae([(0,Ce.Cb)()],$e.prototype,"_environment",1),$e=Ae([(0,Ce.jY)("components.weather.WeatherViewModel")],$e);const Fe=((e,t)=>t=>ge(t,e))($e),Ve={sunny:"brightness",cloudy:"partly-cloudy",rainy:"rain",snowy:"snow",foggy:"fog"};class ze extends ce.oi{constructor(){super(...arguments),this.viewModel=Fe(this),this.messages=de(),this.autoDestroyDisabled=!1,this.headingLevel=4,this.hideHeader=!1,this.icon="partly-cloudy",this.label=this.messages.componentLabel,this.position="bottom-left",this.state=this.viewModel.state,this.arcgisPropertyChange=(0,ae.OR)()("state"),this.arcgisReady=(0,ce.yM)()}static{this.properties={autoDestroyDisabled:5,headingLevel:9,hideHeader:5,icon:1,label:1,messageOverrides:0,position:1,referenceElement:1,state:35}}static{this.shadowRootOptions=ce.hZ}static{this.styles=Ie}async destroy(){await this.manager.destroy()}_getWarningMessage(){if("not-visible"===this.viewModel.error){const{view:e}=this.viewModel;return"3d"===e?.type&&e.environment.atmosphereEnabled?this.messages.error?.notVisible:void 0}}_getErrorMessage(){const e=this.messages.error;if(e)switch(this.viewModel.error){case"local-scene":return e.localScene;case"no-atmosphere":return e.noAtmosphere;case"unsupported-view":return e.unsupported;default:return}}render(){return o.dy`<div aria-label=${this.messages.componentLabelAccessible??ce.Ld} class=${(0,ce.Vp)((0,le.Sh)(Me.base,ve,this.viewModel.disabled&&be))} role=region>${this._renderContent()}</div>`}_renderContent(){const{headingLevel:e,messages:t,viewModel:i}=this,n=this._getWarningMessage(),s=i.current,r="error"===i.state;return o.dy`${this.hideHeader?void 0:_e({level:e,children:t.componentLabel})}${r?o.dy`<div class=${(0,ce.Vp)(Me.error)}>${this._getErrorMessage()}</div>`:void 0}<div class=${(0,ce.Vp)((0,le.Sh)({[Me.content]:!0,[Me.hasError]:r}))}><div aria-label=${t.weatherType??ce.Ld} class=${(0,ce.Vp)(Me.selector)} role=radiogroup>${De.map(this._renderWeatherTypeButton,this)}</div>${Object.values(i.weatherByType).map((e=>o.dy`<div class=${(0,ce.Vp)((0,le.Sh)({[Me.options]:!0,[Me.optionsHidden]:e.type!==s?.type}))}>${this._renderOptions(e)}</div>`))}${n?this._renderWarning(n):void 0}</div>`}_renderWeatherTypeButton(e){const t=this.messages[e]?.label??"",{disabled:i}=this.viewModel,n=!i&&this.viewModel.current.type===e;return o.dy`<calcite-button .appearance=${n?"solid":"outline"} aria-checked=${n?"true":"false"} .disabled=${i} .iconStart=${Ve[e]} .kind=${n?"brand":"neutral"} .label=${t} @click=${()=>{n||this.viewModel.setWeatherByType(e)}} scale=l title=${t??ce.Ld}></calcite-button>`}_renderOptions(e){switch(e.type){case"sunny":return this._renderSunnyOptions(e);case"cloudy":return this._renderCloudyOptions(e);case"rainy":return this._renderRainyOptions(e);case"snowy":return this._renderSnowyOptions(e);case"foggy":return this._renderFoggyOptions(e)}}_renderSunnyOptions(e){return Ne({disabled:this.viewModel.disabled,label:this.messages.sunny?.cloudCover,value:e.cloudCover,onChange:t=>{e.cloudCover=t}})}_renderCloudyOptions(e){return Ne({disabled:this.viewModel.disabled,label:this.messages.cloudy?.cloudCover,value:e.cloudCover,onChange:t=>{e.cloudCover=t}})}_renderRainyOptions(e){const{disabled:t}=this.viewModel,i=this.messages.rainy;return o.dy`${Ne({disabled:t,label:i?.cloudCover,value:e.cloudCover,onChange:t=>{e.cloudCover=t}})}${Ne({disabled:t,label:i?.precipitation,value:e.precipitation,onChange:t=>{e.precipitation=t}})}`}_renderSnowyOptions(e){const{disabled:t}=this.viewModel,i=this.messages.snowy;return o.dy`${Ne({disabled:t,label:i?.cloudCover,value:e.cloudCover,onChange:t=>{e.cloudCover=t}})}${Ne({disabled:t,label:i?.precipitation,value:e.precipitation,onChange:t=>{e.precipitation=t}})}<calcite-label layout=inline scale=s title=${i?.snowCoverTooltip??ce.Ld}><calcite-checkbox .checked=${"enabled"===e.snowCover} .disabled=${t} @calciteCheckboxChange=${e=>{this.viewModel.setSnowCoverEnabled(e.currentTarget.checked)}}></calcite-checkbox>${i?.snowCover}</calcite-label>`}_renderFoggyOptions(e){return Ne({disabled:this.viewModel.disabled,label:this.messages.foggy?.fogStrength,value:e.fogStrength,onChange:t=>{e.fogStrength=t}})}_renderWarning(e){return o.dy`<div class=${(0,ce.Vp)(Me.warning)}><calcite-icon icon=exclamation-mark-triangle scale=s></calcite-icon>${e}</div>`}}(0,re.c)("arcgis-weather",ze)},902:function(e,t,i){"use strict";i.d(t,{a:function(){return a},c:function(){return n},d:function(){return s},r:function(){return r}});const n=(e,t,i)=>Math.max(t,Math.min(e,i)),o=new RegExp(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/),s=e=>{const t=(""+e).match(o);return t&&0!==parseInt(t[1])?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0};function r(e,t,i,n,o){return(e-t)*(o-n)/(i-t)+n}function a(e,t,i){return e<i?-1:e>t-i?1:0}},61637:function(e,t,i){"use strict";i.r(t),i.d(t,{Button:function(){return I}});i(55001),i(4204);var n=i(43625),o=i(73444),s=i(81879),r=i(46490),a=i(23230),l=i(7940),c=i(15022),d=i(4431),u=i(44002),h=i(25064),p=i(52642),y=i(76299),g=i(58268),m=i(49006);const f="calcite-button--loader",v="content",b="content--slotted",_="icon",w="icon--start",C="icon--end",x="loading-in",S="loading-out",E="icon-start-empty",k="icon-end-empty",L="button-padding",T="button-padding--shrunk",M=m.iv`:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:inline-block;inline-size:auto;vertical-align:middle;border-radius:var(--calcite-button-corner-radius, var(--calcite-internal-button-corner-radius, 0))}:host a,:host button{--calcite-internal-button-content-margin: .5rem;--calcite-internal-button-padding-x: 7px;--calcite-internal-button-padding-y: 3px;position:relative;box-sizing:border-box;display:flex;block-size:100%;inline-size:100%;cursor:pointer;-webkit-user-select:none;user-select:none;appearance:none;align-items:center;justify-content:center;border-style:none;text-align:center;font-family:inherit;font-weight:var(--calcite-font-weight-normal);text-decoration-line:none;outline-color:transparent;background-color:var(--calcite-button-background-color, var(--calcite-internal-button-background-color, var(--calcite-color-transparent)));border-block-start-color:var(--calcite-button-border-color, var(--calcite-internal-button-border-block-start-color, var(--calcite-internal-button-border-color, var(--calcite-color-transparent))));border-block-end-color:var(--calcite-button-border-color, var(--calcite-internal-button-border-block-end-color, var(--calcite-internal-button-border-color, var(--calcite-color-transparent))));border-inline-start-color:var(--calcite-button-border-color, var(--calcite-internal-button-border-inline-start-color, var(--calcite-internal-button-border-color, var(--calcite-color-transparent))));border-inline-end-color:var(--calcite-button-border-color, var(--calcite-internal-button-border-inline-end-color, var(--calcite-internal-button-border-color, var(--calcite-color-transparent))));border-style:solid;border-width:var(--calcite-border-width-sm);box-shadow:inset 0 0 0 0 var(--calcite-button-shadow-color, var(--calcite-internal-button-shadow-color, var(--calcite-color-transparent)));border-radius:var(--calcite-button-corner-radius, var(--calcite-internal-button-corner-radius, 0));color:var(--calcite-button-text-color, var(--calcite-internal-button-text-color, currentColor));padding-block:var(--calcite-internal-button-padding-y);padding-inline:var(--calcite-internal-button-padding-x);transition:color var(--calcite-animation-timing) ease-in-out,background-color var(--calcite-animation-timing) ease-in-out,box-shadow var(--calcite-animation-timing) ease-in-out,outline-color var(--calcite-internal-animation-timing-fast) ease-in-out}:host a:hover,:host button:hover{text-decoration-line:none}:host a:focus,:host button:focus{outline:2px solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline-offset:calc(2px*(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}:host a span,:host button span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host a calcite-loader,:host button calcite-loader{color:var(--calcite-button-loader-color, var(--calcite-internal-button-loader-color, var(--calcite-button-text-color, var(--calcite-internal-button-text-color))))}:host([round]){--calcite-internal-button-corner-radius: 50px}.content{margin-inline:var(--calcite-internal-button-content-margin)}.icon-start-empty .content{margin-inline-start:unset}.icon-end-empty .content{margin-inline-end:unset}:host([scale=m]) button,:host([scale=m]) a{--calcite-internal-button-content-margin: .75rem}:host([scale=l]) button,:host([scale=l]) a{--calcite-internal-button-content-margin: 1rem}:host([width=auto]){inline-size:auto}:host([width=half]){inline-size:50%}:host([width=full]){inline-size:100%}:host([alignment=center]:not([width=auto])) a,:host([alignment=center]:not([width=auto])) button{justify-content:center}:host([alignment=start]:not([width=auto])) a,:host([alignment=start]:not([width=auto])) button{justify-content:flex-start}:host([alignment=end]:not([width=auto])) a,:host([alignment=end]:not([width=auto])) button{justify-content:flex-end}:host([alignment*=space-between]:not([width=auto])) a,:host([alignment*=space-between]:not([width=auto])) button{justify-content:space-between}:host([alignment=icon-start-space-between]:not([width=auto])) .icon--start{margin-inline-end:auto}:host([alignment=icon-start-space-between]:not([width=auto])) a,:host([alignment=icon-start-space-between]:not([width=auto])) button{text-align:unset}:host([alignment=icon-end-space-between]:not([width=auto])) .icon--end{margin-inline-start:auto}:host([alignment=icon-end-space-between]:not([width=auto])) a,:host([alignment=icon-end-space-between]:not([width=auto])) button{text-align:unset}:host([alignment=center]) a:not(.content--slotted) .icon--start+.icon--end,:host([alignment=center]) button:not(.content--slotted) .icon--start+.icon--end{margin-inline-start:var(--calcite-internal-button-content-margin)}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}@keyframes loader-in{0%{inline-size:0;opacity:0;transform:scale(.5)}to{inline-size:1em;opacity:1;transform:scale(1)}}@keyframes loader-out{0%{inline-size:1em;opacity:1;transform:scale(1)}to{inline-size:0;opacity:0;transform:scale(.5)}}.calcite-button--loader{display:flex}.calcite-button--loader calcite-loader{margin:0}:host([loading]) button.content--slotted .calcite-button--loader calcite-loader,:host([loading]) a.content--slotted .calcite-button--loader calcite-loader{margin-inline-end:var(--calcite-internal-button-content-margin)}:host([loading]) button:not(.content--slotted) .icon--start,:host([loading]) button:not(.content--slotted) .icon--end,:host([loading]) a:not(.content--slotted) .icon--start,:host([loading]) a:not(.content--slotted) .icon--end{display:none}:host([appearance]) button,:host([appearance]) a{--calcite-internal-button-border-color: var(--calcite-color-transparent);border-style:solid;border-width:var(--calcite-button-border-size, 1px)}:host([kind=brand]) button,:host([kind=brand]) a{--calcite-internal-button-text-color: var(--calcite-color-text-inverse);--calcite-internal-button-background-color: var(--calcite-color-brand);--calcite-internal-button-loader-color: var(--calcite-color-text-inverse)}:host([kind=brand]) button:hover,:host([kind=brand]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-brand-hover)}:host([kind=brand]) button:active,:host([kind=brand]) a:active{--calcite-internal-button-background-color: var(--calcite-color-brand-press)}:host([kind=danger]) button,:host([kind=danger]) a{--calcite-internal-button-text-color: var(--calcite-color-text-inverse);--calcite-internal-button-background-color: var(--calcite-color-status-danger);--calcite-internal-button-loader-color: var(--calcite-color-text-inverse)}:host([kind=danger]) button:hover,:host([kind=danger]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-status-danger-hover)}:host([kind=danger]) button:active,:host([kind=danger]) a:active{--calcite-internal-button-background-color: var(--calcite-color-status-danger-press)}:host([kind=neutral]) button,:host([kind=neutral]) a{--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-background-color: var(--calcite-color-foreground-3);--calcite-internal-button-loader-color: var(--calcite-color-text-1)}:host([kind=neutral]) button:hover,:host([kind=neutral]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-foreground-2)}:host([kind=neutral]) button:active,:host([kind=neutral]) a:active{--calcite-internal-button-background-color: var(--calcite-color-foreground-1)}:host([kind=inverse]) button,:host([kind=inverse]) a{--calcite-internal-button-text-color: var(--calcite-color-text-inverse);--calcite-internal-button-background-color: var(--calcite-color-inverse);--calcite-internal-button-loader-color: var(--calcite-color-text-inverse)}:host([kind=inverse]) button:hover,:host([kind=inverse]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-inverse-hover)}:host([kind=inverse]) button:active,:host([kind=inverse]) a:active{--calcite-internal-button-background-color: var(--calcite-color-inverse-press)}:host([appearance=outline-fill]) button,:host([appearance=outline-fill]) a{--calcite-internal-button-background-color: var(--calcite-color-foreground-1);border-style:solid;border-width:var(--calcite-button-border-size, 1px)}:host([appearance=outline-fill]) button:hover,:host([appearance=outline-fill]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-foreground-2)}:host([appearance=outline-fill]) button:active,:host([appearance=outline-fill]) a:active{--calcite-internal-button-background-color: var(--calcite-color-foreground-3)}:host([appearance=outline-fill][kind=brand]) button,:host([appearance=outline-fill][kind=brand]) a{--calcite-internal-button-border-color: var(--calcite-color-brand);--calcite-internal-button-text-color: var(--calcite-color-brand);--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=outline-fill][kind=brand]) button:hover,:host([appearance=outline-fill][kind=brand]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-brand-hover);--calcite-internal-button-text-color: var(--calcite-color-brand-hover);--calcite-internal-button-shadow-color: var(--calcite-color-brand-hover)}:host([appearance=outline-fill][kind=brand]) button:focus,:host([appearance=outline-fill][kind=brand]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-brand);--calcite-internal-button-text-color: var(--calcite-color-brand);--calcite-internal-button-shadow-color: var(--calcite-color-brand)}:host([appearance=outline-fill][kind=brand]) button:active,:host([appearance=outline-fill][kind=brand]) a:active{--calcite-internal-button-border-color: var(--calcite-color-brand-press);--calcite-internal-button-text-color: var(--calcite-color-brand-press);--calcite-internal-button-shadow-color: var(--calcite-color-brand-press)}:host([appearance=outline-fill][kind=brand]) button calcite-loader,:host([appearance=outline-fill][kind=brand]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=outline-fill][kind=danger]) button,:host([appearance=outline-fill][kind=danger]) a{--calcite-internal-button-border-color: var(--calcite-color-status-danger);--calcite-internal-button-text-color: var(--calcite-color-status-danger);--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=outline-fill][kind=danger]) button:hover,:host([appearance=outline-fill][kind=danger]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-status-danger-hover);--calcite-internal-button-text-color: var(--calcite-color-status-danger-hover);--calcite-internal-button-shadow-color: var(--calcite-color-status-danger-hover)}:host([appearance=outline-fill][kind=danger]) button:focus,:host([appearance=outline-fill][kind=danger]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-status-danger);--calcite-internal-button-text-color: var(--calcite-color-status-danger);--calcite-internal-button-shadow-color: var(--calcite-color-status-danger)}:host([appearance=outline-fill][kind=danger]) button:active,:host([appearance=outline-fill][kind=danger]) a:active{--calcite-internal-button-border-color: var(--calcite-color-status-danger-press);--calcite-internal-button-text-color: var(--calcite-color-status-danger-press);--calcite-internal-button-shadow-color: var(--calcite-color-status-danger-press)}:host([appearance=outline-fill][kind=danger]) button calcite-loader,:host([appearance=outline-fill][kind=danger]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=outline-fill][kind=neutral]) button,:host([appearance=outline-fill][kind=neutral]) a{--calcite-internal-button-border-color: var(--calcite-color-border-1);--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-loader-color: var(--calcite-color-text-1)}:host([appearance=outline-fill][kind=neutral]) button:hover,:host([appearance=outline-fill][kind=neutral]) a:hover{--calcite-internal-button-shadow-color: var(--calcite-color-foreground-3);--calcite-internal-button-border-color: var(--calcite-color-border-input)}:host([appearance=outline-fill][kind=neutral]) button:focus,:host([appearance=outline-fill][kind=neutral]) a:focus{--calcite-internal-button-shadow-color: var(--calcite-color-foreground-3)}:host([appearance=outline-fill][kind=neutral]) button:active,:host([appearance=outline-fill][kind=neutral]) a:active{--calcite-internal-button-shadow-color: var(--calcite-color-foreground-3);--calcite-internal-button-border-color: var(--calcite-color-text-3)}:host([appearance=solid][kind=neutral]) button:hover,:host([appearance=solid][kind=neutral]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-border-3)}:host([appearance=solid][kind=neutral]) button:active,:host([appearance=solid][kind=neutral]) a:active{--calcite-internal-button-background-color: var(--calcite-color-border-2)}:host([appearance=outline-fill][kind=inverse]) button,:host([appearance=outline-fill][kind=inverse]) a{--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-border-color: var(--calcite-color-inverse);--calcite-internal-button-loader-color: var(--calcite-color-text-1)}:host([appearance=outline-fill][kind=inverse]) button:hover,:host([appearance=outline-fill][kind=inverse]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-inverse-hover);--calcite-internal-button-shadow-color: var(--calcite-color-inverse-hover)}:host([appearance=outline-fill][kind=inverse]) button:focus,:host([appearance=outline-fill][kind=inverse]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-inverse);--calcite-internal-button-shadow-color: var(--calcite-color-inverse)}:host([appearance=outline-fill][kind=inverse]) button:active,:host([appearance=outline-fill][kind=inverse]) a:active{--calcite-internal-button-border-color: var(--calcite-color-inverse-press);--calcite-internal-button-shadow-color: var(--calcite-color-inverse-press)}:host([appearance=outline]) button,:host([appearance=outline]) a{--calcite-internal-button-background-color: var(--calcite-color-transparent);border-style:solid;border-width:var(--calcite-button-border-size, 1px)}:host([appearance=outline]) button:hover,:host([appearance=outline]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-transparent-hover)}:host([appearance=outline]) button:active,:host([appearance=outline]) a:active{--calcite-internal-button-background-color: var(--calcite-color-transparent-press)}:host([appearance=outline][kind=brand]) button,:host([appearance=outline][kind=brand]) a{--calcite-internal-button-border-color: var(--calcite-color-brand);--calcite-internal-button-text-color: var(--calcite-color-brand);--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=outline][kind=brand]) button:hover,:host([appearance=outline][kind=brand]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-brand-hover);--calcite-internal-button-text-color: var(--calcite-color-brand-hover);--calcite-internal-button-shadow-color: var(--calcite-color-brand-hover)}:host([appearance=outline][kind=brand]) button:focus,:host([appearance=outline][kind=brand]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-brand);--calcite-internal-button-text-color: var(--calcite-color-brand);--calcite-internal-button-shadow-color: var(--calcite-color-brand)}:host([appearance=outline][kind=brand]) button:active,:host([appearance=outline][kind=brand]) a:active{--calcite-internal-button-border-color: var(--calcite-color-brand-press);--calcite-internal-button-text-color: var(--calcite-color-brand-press);--calcite-internal-button-shadow-color: var(--calcite-color-brand-press)}:host([appearance=outline][kind=brand]) button calcite-loader,:host([appearance=outline][kind=brand]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=outline][kind=danger]) button,:host([appearance=outline][kind=danger]) a{--calcite-internal-button-border-color: var(--calcite-color-status-danger);--calcite-internal-button-text-color: var(--calcite-color-status-danger);--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=outline][kind=danger]) button:hover,:host([appearance=outline][kind=danger]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-status-danger-hover);--calcite-internal-button-text-color: var(--calcite-color-status-danger-hover);--calcite-internal-button-shadow-color: var(--calcite-color-status-danger-hover)}:host([appearance=outline][kind=danger]) button:focus,:host([appearance=outline][kind=danger]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-status-danger);--calcite-internal-button-text-color: var(--calcite-color-status-danger);--calcite-internal-button-shadow-color: var(--calcite-color-status-danger)}:host([appearance=outline][kind=danger]) button:active,:host([appearance=outline][kind=danger]) a:active{--calcite-internal-button-border-color: var(--calcite-color-status-danger-press);--calcite-internal-button-text-color: var(--calcite-color-status-danger-press);--calcite-internal-button-shadow-color: var(--calcite-color-status-danger-press)}:host([appearance=outline][kind=danger]) button calcite-loader,:host([appearance=outline][kind=danger]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=outline][kind=neutral]) button,:host([appearance=outline][kind=neutral]) a{--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-border-color: var(--calcite-color-border-1);--calcite-internal-button-loader-color: var(--calcite-color-text-1)}:host([appearance=outline][kind=neutral]) button:hover,:host([appearance=outline][kind=neutral]) a:hover{--calcite-internal-button-shadow-color: var(--calcite-color-foreground-3);--calcite-internal-button-border-color: var(--calcite-color-border-input)}:host([appearance=outline][kind=neutral]) button:focus,:host([appearance=outline][kind=neutral]) a:focus{--calcite-internal-button-shadow-color: var(--calcite-color-foreground-3)}:host([appearance=outline][kind=neutral]) button:active,:host([appearance=outline][kind=neutral]) a:active{--calcite-internal-button-shadow-color: var(--calcite-color-foreground-3);--calcite-internal-button-border-color: var(--calcite-color-text-3)}:host([appearance=outline][kind=inverse]) button,:host([appearance=outline][kind=inverse]) a{--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-border-color: var(--calcite-color-inverse);--calcite-internal-button-loader-color: var(--calcite-color-text-1)}:host([appearance=outline][kind=inverse]) button:hover,:host([appearance=outline][kind=inverse]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-inverse-hover);--calcite-internal-button-shadow-color: var(--calcite-color-inverse-hover)}:host([appearance=outline][kind=inverse]) button:focus,:host([appearance=outline][kind=inverse]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-inverse);--calcite-internal-button-shadow-color: var(--calcite-color-inverse)}:host([appearance=outline][kind=inverse]) button:active,:host([appearance=outline][kind=inverse]) a:active{--calcite-internal-button-border-color: var(--calcite-color-inverse-press);--calcite-internal-button-shadow-color: var(--calcite-color-inverse-press)}:host([appearance=outline-fill][split-child=primary]) button,:host([appearance=outline][split-child=primary]) button,:host([appearance=outline-fill][split-child=primary]) a,:host([appearance=outline][split-child=primary]) a{border-inline-end-width:0;border-inline-start-width:1px}:host([appearance=outline-fill][split-child=secondary]) button,:host([appearance=outline][split-child=secondary]) button,:host([appearance=outline-fill][split-child=secondary]) a,:host([appearance=outline][split-child=secondary]) a{border-inline-start-width:0;border-inline-end-width:1px}:host([appearance=transparent]) button,:host([appearance=transparent]) a{--calcite-internal-button-background-color: var(--calcite-color-transparent)}:host([appearance=transparent]) button:hover,:host([appearance=transparent]) button:focus,:host([appearance=transparent]) a:hover,:host([appearance=transparent]) a:focus{--calcite-internal-button-background-color: var(--calcite-color-transparent-hover)}:host([appearance=transparent]) button:active,:host([appearance=transparent]) a:active{--calcite-internal-button-background-color: var(--calcite-color-transparent-press)}:host([appearance=transparent]:not(.enable-editing-button)) button,:host([appearance=transparent]:not(.enable-editing-button)) a{background-color:var(--calcite-color-transparent)}:host([appearance=transparent]:not(.enable-editing-button)) button:hover,:host([appearance=transparent]:not(.enable-editing-button)) a:hover{background-color:var(--calcite-color-transparent-hover)}:host([appearance=transparent]:not(.enable-editing-button)) button:active,:host([appearance=transparent]:not(.enable-editing-button)) a:active{background-color:var(--calcite-color-transparent-press)}:host([appearance=transparent][kind=brand]) button,:host([appearance=transparent][kind=brand]) a{--calcite-internal-button-text-color: var(--calcite-color-brand);--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=transparent][kind=brand]) button:hover,:host([appearance=transparent][kind=brand]) a:hover{--calcite-internal-button-text-color: var(--calcite-color-brand-hover)}:host([appearance=transparent][kind=brand]) button:focus,:host([appearance=transparent][kind=brand]) a:focus{--calcite-internal-button-text-color: var(--calcite-color-brand)}:host([appearance=transparent][kind=brand]) button:active,:host([appearance=transparent][kind=brand]) a:active{--calcite-internal-button-text-color: var(--calcite-color-brand-press)}:host([appearance=transparent][kind=brand]) button calcite-loader,:host([appearance=transparent][kind=brand]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=transparent][kind=danger]) button,:host([appearance=transparent][kind=danger]) a{--calcite-internal-button-text-color: var(--calcite-color-status-danger);--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=transparent][kind=danger]) button:hover,:host([appearance=transparent][kind=danger]) a:hover{--calcite-internal-button-text-color: var(--calcite-color-status-danger-hover)}:host([appearance=transparent][kind=danger]) button:focus,:host([appearance=transparent][kind=danger]) a:focus{--calcite-internal-button-text-color: var(--calcite-color-status-danger)}:host([appearance=transparent][kind=danger]) button:active,:host([appearance=transparent][kind=danger]) a:active{--calcite-internal-button-text-color: var(--calcite-color-status-danger-press)}:host([appearance=transparent][kind=danger]) button calcite-loader,:host([appearance=transparent][kind=danger]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=transparent][kind=neutral]:not(.cancel-editing-button)) button,:host([appearance=transparent][kind=neutral]:not(.cancel-editing-button)) a,:host([appearance=transparent][kind=neutral]:not(.cancel-editing-button)) calcite-loader{--calcite-internal-button-text-color: var(--calcite-color-text-1)}:host([appearance=transparent][kind=neutral].cancel-editing-button) button{--calcite-internal-button-text-color: var(--calcite-color-text-3)}:host([appearance=transparent][kind=neutral].cancel-editing-button) button:hover{--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-padding-y: 0}:host(.confirm-changes-button) button:focus,:host(.cancel-editing-button) button:focus,:host(.enable-editing-button) button:focus{outline-offset:-2px}:host([appearance=transparent][kind=inverse]) button:hover,:host([appearance=transparent][kind=inverse]) a:hover{background-color:var(--calcite-color-transparent-inverse-hover)}:host([appearance=transparent][kind=inverse]) button:active,:host([appearance=transparent][kind=inverse]) a:active{background-color:var(--calcite-color-transparent-inverse-press)}:host([appearance=transparent][kind=inverse]) button calcite-loader,:host([appearance=transparent][kind=inverse]) a calcite-loader{--calcite-internal-button-text-color: var(--calcite-color-text-inverse)}:host([scale=s]) button.content--slotted,:host([scale=s]) a.content--slotted{font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=s][appearance=transparent]) button.content--slotted,:host([scale=s][appearance=transparent]) a.content--slotted{--calcite-internal-button-padding-x: .5rem}:host([scale=s]) button,:host([scale=s]) a{--calcite-internal-button-padding-y: 3px}:host([scale=m]) button.content--slotted,:host([scale=m]) a.content--slotted{--calcite-internal-button-padding-x: 11px;font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=m]) button,:host([scale=m]) a{--calcite-internal-button-padding-y: 7px}:host([scale=m][appearance=transparent]) button.content--slotted,:host([scale=m][appearance=transparent]) a.content--slotted{--calcite-internal-button-padding-x: .75rem}:host([scale=l]) button.content--slotted,:host([scale=l]) a.content--slotted{--calcite-internal-button-padding-x: 15px;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l]) .button-padding{--calcite-internal-button-padding-x: 1rem;--calcite-internal-button-padding-y: 11px}:host([scale=l]) .button-padding--shrunk{--calcite-internal-button-padding-y: 9px}:host([scale=s]) button:not(.content--slotted),:host([scale=s]) a:not(.content--slotted){--calcite-internal-button-padding-x: .125rem;--calcite-internal-button-padding-y: 3px;inline-size:1.5rem;font-size:var(--calcite-font-size-0);line-height:1.25rem;min-block-size:1.5rem}:host([scale=m]) button:not(.content--slotted),:host([scale=m]) a:not(.content--slotted){--calcite-internal-button-padding-x: .125rem;--calcite-internal-button-padding-y: 7px;inline-size:2rem;font-size:var(--calcite-font-size-0);line-height:1.25rem;min-block-size:2rem}:host([scale=l]) button:not(.content--slotted),:host([scale=l]) a:not(.content--slotted){--calcite-internal-button-padding-x: .125rem;--calcite-internal-button-padding-y: 9px;inline-size:2.75rem;font-size:var(--calcite-font-size-0);line-height:1.25rem;min-block-size:2.75rem}:host(:is([scale=s],[scale=m],[scale=l])[width=full]) a:not(.content--slotted),:host(:is([scale=s],[scale=m],[scale=l])[width=full]) button:not(.content--slotted){inline-size:var(--calcite-container-size-content-fluid)}:host([scale=l][appearance=transparent]) button:not(.content--slotted),:host([scale=l][appearance=transparent]) a:not(.content--slotted){--calcite-internal-button-padding-y: .625rem}:host([scale=s][icon-start][icon-end]) button:not(.content--slotted),:host([scale=s][icon-start][icon-end]) a:not(.content--slotted){--calcite-internal-button-padding-x: 23px;block-size:1.5rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=s][icon-start][icon-end][appearance=transparent]) button:not(.content--slotted),:host([scale=s][icon-start][icon-end][appearance=transparent]) a:not(.content--slotted){--calcite-internal-button-padding-x: 1.5rem}:host([scale=m][icon-start][icon-end]) button:not(.content--slotted),:host([scale=m][icon-start][icon-end]) a:not(.content--slotted){--calcite-internal-button-padding-x: 2rem;block-size:2rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=m][icon-start][icon-end][appearance=transparent]) button:not(.content--slotted),:host([scale=m][icon-start][icon-end][appearance=transparent]) a:not(.content--slotted){--calcite-internal-button-padding-x: 33px}:host([scale=l][icon-start][icon-end]) button:not(.content--slotted),:host([scale=l][icon-start][icon-end]) a:not(.content--slotted){--calcite-internal-button-padding-x: 43px;block-size:2.75rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l][icon-start][icon-end]) button:not(.content--slotted) .icon--start+.icon--end,:host([scale=l][icon-start][icon-end]) a:not(.content--slotted) .icon--start+.icon--end{margin-inline-start:1rem}:host([scale=l][icon-start][icon-end][appearance=transparent]) button:not(.content--slotted),:host([scale=l][icon-start][icon-end][appearance=transparent]) a:not(.content--slotted){--calcite-internal-button-padding-x: 2.75rem}:host([hidden]){display:none}[hidden]{display:none}`;class I extends a.oi{constructor(){super(...arguments),this.attributeWatch=(0,l.g0)(["aria-expanded"],this.handleGlobalAttributesChanged),this.contentEl=(0,s.V)(),this.mutationObserver=(0,p.c)("mutation",(()=>this.updateHasContent())),this.resizeObserver=(0,p.c)("resize",(()=>this.setTooltipText())),this.messages=(0,y.u)(),this.hasContent=!1,this.alignment="center",this.appearance="solid",this.disabled=!1,this.download=!1,this.kind="brand",this.loading=!1,this.round=!1,this.scale="m",this.splitChild=!1,this.type="button",this.width="auto"}static{this.properties={hasContent:[16,{},{state:!0}],tooltipText:[16,{},{state:!0}],alignment:[3,{},{reflect:!0}],appearance:[3,{},{reflect:!0}],disabled:[7,{},{reflect:!0,type:Boolean}],download:[3,{converter:a.Kb},{reflect:!0}],form:[3,{},{reflect:!0}],href:[3,{},{reflect:!0}],iconEnd:[3,{},{reflect:!0}],iconFlipRtl:[3,{},{reflect:!0}],iconStart:[3,{},{reflect:!0}],kind:[3,{},{reflect:!0}],label:1,loading:[7,{},{reflect:!0,type:Boolean}],messageOverrides:[0,{},{attribute:!1}],name:[3,{},{reflect:!0}],rel:[3,{},{reflect:!0}],round:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],splitChild:[3,{},{reflect:!0}],target:[3,{},{reflect:!0}],type:[3,{},{reflect:!0}],width:[3,{},{reflect:!0}]}}static{this.styles=M}async setFocus(){await(0,h.c)(this),this.childEl?.focus()}connectedCallback(){super.connectedCallback(),this.setupTextContentObserver(),(0,u.c)(this),this.formEl=(0,c.f)(this)}async load(){o.sk||this.updateHasContent()}updated(){(0,d.u)(this)}loaded(){this.setTooltipText()}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver?.disconnect(),(0,u.d)(this),this.resizeObserver?.disconnect(),this.formEl=null}handleGlobalAttributesChanged(){this.requestUpdate()}updateHasContent(){this.hasContent=(0,g.D)(this.el)}setupTextContentObserver(){this.mutationObserver?.observe(this.el,{childList:!0,subtree:!0})}onLabelClick(){this.handleClick(),this.setFocus()}handleClick(){const{type:e}=this;this.href||("submit"===e?(0,c.s)(this):"reset"===e&&(0,c.r)(this))}setTooltipText(){const{contentEl:{value:e}}=this;e&&(this.tooltipText=e.offsetWidth<e.scrollWidth&&this.el.innerText||null)}setChildEl(e){this.childEl=e,e&&this.resizeObserver?.observe(e)}render(){const e=this.href?"a":"button",t=this.href?r.i0`a`:r.i0`button`,i=this.loading?o.dy`<div class=${(0,a.Vp)(f)}><calcite-loader class=${(0,a.Vp)(this.loading?x:S)} inline .label=${this.messages.loading} .scale=${"l"===this.scale?"m":"s"}></calcite-loader></div>`:null,n=!this.iconStart&&!this.iconEnd,l=o.dy`<calcite-icon class=${(0,a.Vp)({[_]:!0,[w]:!0})} .flipRtl=${"start"===this.iconFlipRtl||"both"===this.iconFlipRtl} .icon=${this.iconStart} .scale=${(0,h.g)(this.scale)}></calcite-icon>`,c=o.dy`<calcite-icon class=${(0,a.Vp)({[_]:!0,[C]:!0})} .flipRtl=${"end"===this.iconFlipRtl||"both"===this.iconFlipRtl} .icon=${this.iconEnd} .scale=${(0,h.g)(this.scale)}></calcite-icon>`,p=o.dy`<span class=${(0,a.Vp)(v)} ${(0,s.i)(this.contentEl)}><slot></slot></span>`;return(0,d.I)({disabled:this.disabled,children:r.dy`<${t} .ariaBusy=${this.loading} .ariaExpanded=${this.el.ariaExpanded?this.el.ariaExpanded:null} .ariaLabel=${this.loading?this.messages.loading:(0,u.g)(this)} aria-live=polite class=${(0,a.Vp)({[L]:n,[T]:!n,[b]:this.hasContent,[E]:!this.iconStart,[k]:!this.iconEnd})} .disabled=${"button"===e?this.disabled:null} download=${("a"===e?!0===this.download||""===this.download?"":this.download||null:null)??o.Ld} href=${("a"===e&&this.href)??o.Ld} name=${("button"===e&&this.name)??o.Ld} @click=${this.handleClick} rel=${("a"===e&&this.rel)??o.Ld} tabindex=${(this.disabled?-1:null)??o.Ld} target=${("a"===e&&this.target)??o.Ld} title=${this.tooltipText??o.Ld} type=${("button"===e?this.type:null)??o.Ld} ${(0,s.i)(this.setChildEl)}>${i}${this.iconStart?l:null}${this.hasContent?p:null}${this.iconEnd?c:null}</${t}>`})}}(0,n.c)("calcite-button",I)},69397:function(e,t,i){"use strict";i.r(t),i.d(t,{Checkbox:function(){return f}});var n=i(43625),o=i(15294),s=i(81879),r=i(23230),a=i(58268),l=i(15022),c=i(4431),d=i(113),u=i(44002),h=i(25064),p=i(49006);const y="toggle",g="check-svg",m=p.iv`:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host([scale=s]) .check-svg,:host([scale=s]) .toggle{inline-size:var(--calcite-checkbox-size, .75rem);block-size:var(--calcite-checkbox-size, .75rem)}:host([scale=m]) .check-svg,:host([scale=m]) .toggle{inline-size:var(--calcite-checkbox-size, var(--calcite-font-size--1));block-size:var(--calcite-checkbox-size, var(--calcite-font-size--1))}:host([scale=l]) .check-svg,:host([scale=l]) .toggle{inline-size:var(--calcite-checkbox-size, 1rem);block-size:var(--calcite-checkbox-size, 1rem)}:host{position:relative;display:inline-flex;cursor:pointer;-webkit-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}:host .check-svg{pointer-events:none;box-sizing:border-box;display:block;overflow:hidden;background-color:var(--calcite-color-foreground-1);fill:currentColor;stroke:currentColor;stroke-width:1;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;box-shadow:inset 0 0 0 1px var(--calcite-checkbox-border-color, var(--calcite-color-border-input));color:var(--calcite-checkbox-icon-color, var(--calcite-color-background))}:host([status=invalid]:not([checked])) .check-svg{box-shadow:inset 0 0 0 1px var(--calcite-color-status-danger)}:host([status=invalid]:not([checked])) .toggle:focus{outline:2px solid var(--calcite-color-status-danger);outline-offset:calc(2px*(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}:host([checked]) .check-svg,:host([indeterminate]) .check-svg{background-color:var(--calcite-color-brand);box-shadow:inset 0 0 0 1px var(--calcite-color-brand)}:host([hovered]) .toggle .check-svg,:host .toggle:hover .check-svg{box-shadow:inset 0 0 0 2px var(--calcite-checkbox-border-color-hover, var(--calcite-color-brand))}.toggle{position:relative;outline-color:transparent}.toggle:active,.toggle:focus,.toggle:focus-visible{outline:2px solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline-offset:calc(2px*(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}.toggle:after,.toggle:before{inset-block-start:50%;inset-inline-start:50%;min-block-size:1.5rem;min-inline-size:1.5rem;position:absolute}.toggle:not(.calcite--rtl):after{content:"";transform:translate(-50%) translateY(-50%)}.toggle.calcite--rtl:before{content:"";transform:translate(50%) translateY(-50%)}@media (forced-colors: active){.check-svg{border:1px solid currentColor}}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}::slotted(input[slot=hidden-form-input]){margin:0!important;opacity:0!important;outline:none!important;padding:0!important;position:absolute!important;inset:0!important;transform:none!important;-webkit-appearance:none!important;z-index:-1!important}:host([hidden]){display:none}[hidden]{display:none}`;class f extends r.oi{constructor(){super(),this.checkedPath="M5.5 12L2 8.689l.637-.636L5.5 10.727l8.022-7.87.637.637z",this.indeterminatePath="M13 8v1H3V8z",this.onLabelClick=()=>{this.toggle()},this.toggleEl=(0,s.V)(),this.checked=!1,this.disabled=!1,this.hovered=!1,this.indeterminate=!1,this.required=!1,this.scale="m",this.status="idle",this.validity={valid:!1,badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1},this.calciteCheckboxChange=(0,r.yM)({cancelable:!1}),this.calciteInternalCheckboxBlur=(0,r.yM)({cancelable:!1}),this.calciteInternalCheckboxFocus=(0,r.yM)({cancelable:!1}),this.listen("click",this.clickHandler),this.listen("keydown",this.keyDownHandler)}static{this.properties={checked:[7,{},{reflect:!0,type:Boolean}],disabled:[7,{},{reflect:!0,type:Boolean}],form:[3,{},{reflect:!0}],hovered:[7,{},{reflect:!0,type:Boolean}],indeterminate:[7,{},{reflect:!0,type:Boolean}],label:1,name:[3,{},{reflect:!0}],required:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],status:[3,{},{reflect:!0}],validity:[0,{},{attribute:!1}],value:1}}static{this.styles=m}async setFocus(){await(0,h.c)(this),this.toggleEl.value?.focus()}connectedCallback(){super.connectedCallback(),(0,u.c)(this),(0,l.c)(this)}updated(){(0,c.u)(this)}disconnectedCallback(){super.disconnectedCallback(),(0,u.d)(this),(0,l.d)(this)}syncHiddenFormInput(e){e.type="checkbox"}getPath(){return this.indeterminate?this.indeterminatePath:this.checked?this.checkedPath:""}toggle(){this.disabled||(this.checked=!this.checked,this.setFocus(),this.indeterminate=!1,this.calciteCheckboxChange.emit())}keyDownHandler(e){(0,d.i)(e.key)&&(this.toggle(),e.preventDefault())}clickHandler(){this.toggle()}onToggleBlur(){this.calciteInternalCheckboxBlur.emit(!1)}onToggleFocus(){this.calciteInternalCheckboxFocus.emit(!0)}render(){const e="rtl"===(0,a.g)(this.el);return(0,c.I)({disabled:this.disabled,children:o.dy`<div .ariaChecked=${this.checked} .ariaLabel=${(0,u.g)(this)} class=${(0,r.Vp)({[y]:!0,[n.C.rtl]:e})} @blur=${this.onToggleBlur} @focus=${this.onToggleFocus} role=checkbox tabindex=${(this.disabled?void 0:0)??r.Ld} ${(0,s.i)(this.toggleEl)}><svg aria-hidden=true class=${(0,r.Vp)(g)} viewBox="0 0 16 16">${o.YP`<path d=${this.getPath()??r.Ld} />`}</svg><slot></slot></div>${(0,l.H)({component:this})}`})}}(0,n.c)("calcite-checkbox",f)},36650:function(e,t,i){"use strict";i.r(t),i.d(t,{Label:function(){return d}});var n=i(43625),o=i(73444),s=i(23230),r=i(44002),a=i(49006);const l="container",c=a.iv`:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:flex}:host([alignment=start]){text-align:start}:host([alignment=end]){text-align:end}:host([alignment=center]){text-align:center}:host([scale=s]) .container{gap:.25rem;font-size:var(--calcite-font-size--2);line-height:1rem;margin-block-end:var(--calcite-label-margin-bottom, .5rem)}:host([scale=m]) .container{gap:.5rem;font-size:var(--calcite-font-size--1);line-height:1rem;margin-block-end:var(--calcite-label-margin-bottom, .75rem)}:host([scale=l]) .container{gap:.5rem;font-size:var(--calcite-font-size-0);line-height:1.25rem;margin-block-end:var(--calcite-label-margin-bottom, 1rem)}:host .container{margin-inline:0px;margin-block-start:0px;inline-size:100%;line-height:1.375;color:var(--calcite-color-text-1);color:var(--calcite-label-text-color, var(--calcite-color-text-1))}:host([layout=default]) .container{display:flex;flex-direction:column}:host([layout=inline]) .container,:host([layout=inline-space-between]) .container{display:flex;flex-direction:row;align-items:center;gap:.5rem}:host([layout=inline][scale=l]) .container{gap:.75rem}:host([layout=inline-space-between]) .container{justify-content:space-between}:host([disabled])>.container{opacity:var(--calcite-opacity-disabled)}:host([disabled]) ::slotted(*[disabled]),:host([disabled]) ::slotted(*[disabled] *){--tw-bg-opacity: 1}:host([disabled]) ::slotted(calcite-input-message:not([active])){--tw-bg-opacity: 0}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}:host([hidden]){display:none}[hidden]{display:none}`;class d extends s.oi{constructor(){super(),this.alignment="start",this.layout="default",this.scale="m",this.calciteInternalLabelClick=(0,s.yM)({bubbles:!1,cancelable:!1}),this.listen("click",this.labelClickHandler)}static{this.properties={alignment:[3,{},{reflect:!0}],for:[3,{},{reflect:!0}],layout:[3,{},{reflect:!0}],scale:[3,{},{reflect:!0}]}}static{this.styles=c}connectedCallback(){super.connectedCallback(),document.dispatchEvent(new CustomEvent(r.l))}willUpdate(e){e.has("for")&&(0,r.a)(this.el)}disconnectedCallback(){super.disconnectedCallback(),document.dispatchEvent(new CustomEvent(r.b))}labelClickHandler(e){"Range"!==window.getSelection()?.type&&this.calciteInternalLabelClick.emit({sourceEvent:e})}render(){return o.dy`<div class=${(0,s.Vp)(l)}><slot></slot></div>`}}(0,n.c)("calcite-label",d)},47307:function(e,t){"use strict";t.Z=function(){return!0}},43909:function(e,t,i){"use strict";i.d(t,{Z:function(){return w}});var n=i(12744),o=i(95598),s=i(11285),r=i(5393),a=i(92800),l=i(71082);function c(e){return'"'+e.replace(/\\/g,"\\\\").replace(/[\b]/g,"\\b").replace(/\f/g,"\\f").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\v/g,"\\v").replace(/\0/g,"\\0").replace(/"/g,'\\"')+'"'}var d=function(e){return(e<10?"0":"")+e},u="function"==typeof Date.prototype.toISOString?function(e){return e.toISOString()}:function(e){return e.getUTCFullYear()+"-"+d(e.getUTCMonth()+1)+"-"+d(e.getUTCDate())+"T"+d(e.getUTCHours())+":"+d(e.getUTCMinutes())+":"+d(e.getUTCSeconds())+"."+(e.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"},h=i(33598);var p=i(88801),y=(0,r.Z)((function(e,t){return(0,p.Z)((i=e,function(){return!i.apply(this,arguments)}),t);var i})),g=y;function m(e,t){var i=function(i){var n=t.concat([e]);return(0,a.Z)(i,n)?"<Circular>":m(i,n)},n=function(e,t){return(0,l.Z)((function(t){return c(t)+": "+i(e[t])}),t.slice().sort())};switch(Object.prototype.toString.call(e)){case"[object Arguments]":return"(function() { return arguments; }("+(0,l.Z)(i,e).join(", ")+"))";case"[object Array]":return"["+(0,l.Z)(i,e).concat(n(e,g((function(e){return/^\d+$/.test(e)}),(0,h.Z)(e)))).join(", ")+"]";case"[object Boolean]":return"object"==typeof e?"new Boolean("+i(e.valueOf())+")":e.toString();case"[object Date]":return"new Date("+(isNaN(e.valueOf())?i(NaN):c(u(e)))+")";case"[object Map]":return"new Map("+i(Array.from(e))+")";case"[object Null]":return"null";case"[object Number]":return"object"==typeof e?"new Number("+i(e.valueOf())+")":1/e==-1/0?"-0":e.toString(10);case"[object Set]":return"new Set("+i(Array.from(e).sort())+")";case"[object String]":return"object"==typeof e?"new String("+i(e.valueOf())+")":c(e);case"[object Undefined]":return"undefined";default:if("function"==typeof e.toString){var o=e.toString();if("[object Object]"!==o)return o}return"{"+n(e,(0,h.Z)(e)).join(", ")+"}"}}var f=(0,o.Z)((function(e){return m(e,[])})),v=(0,r.Z)((function(e,t){if(e===t)return t;function i(e,t){if(e>t!=t>e)return t>e?t:e}var n=i(e,t);if(void 0!==n)return n;var o=i(typeof e,typeof t);if(void 0!==o)return o===typeof e?e:t;var s=f(e),r=i(s,f(t));return void 0!==r&&r===s?e:t})),b=i(56943),_=(0,o.Z)((function(e){var t=(0,b.Z)(v,0,(0,s.Z)((function(e){return e[0].length}),e));return(0,n.Z)(t,(function(){for(var t=0;t<e.length;){if(e[t][0].apply(this,arguments))return e[t][1].apply(this,arguments);t+=1}}))})),w=_},52362:function(e,t,i){"use strict";i.d(t,{Z:function(){return a}});var n=i(5393),o=i(92800);function s(e,t,i){var n,s=typeof e;switch(s){case"string":case"number":return 0===e&&1/e==-1/0?!!i._items["-0"]||(t&&(i._items["-0"]=!0),!1):null!==i._nativeSet?t?(n=i._nativeSet.size,i._nativeSet.add(e),i._nativeSet.size===n):i._nativeSet.has(e):s in i._items?e in i._items[s]||(t&&(i._items[s][e]=!0),!1):(t&&(i._items[s]={},i._items[s][e]=!0),!1);case"boolean":if(s in i._items){var r=e?1:0;return!!i._items[s][r]||(t&&(i._items[s][r]=!0),!1)}return t&&(i._items[s]=e?[!1,!0]:[!0,!1]),!1;case"function":return null!==i._nativeSet?t?(n=i._nativeSet.size,i._nativeSet.add(e),i._nativeSet.size===n):i._nativeSet.has(e):s in i._items?!!(0,o.Z)(e,i._items[s])||(t&&i._items[s].push(e),!1):(t&&(i._items[s]=[e]),!1);case"undefined":return!!i._items[s]||(t&&(i._items[s]=!0),!1);case"object":if(null===e)return!!i._items.null||(t&&(i._items.null=!0),!1);default:return(s=Object.prototype.toString.call(e))in i._items?!!(0,o.Z)(e,i._items[s])||(t&&i._items[s].push(e),!1):(t&&(i._items[s]=[e]),!1)}}var r=function(){function e(){this._nativeSet="function"==typeof Set?new Set:null,this._items={}}return e.prototype.add=function(e){return!s(e,!0,this)},e.prototype.has=function(e){return s(e,!1,this)},e}(),a=(0,n.Z)((function(e,t){for(var i=[],n=0,o=e.length,s=t.length,a=new r,l=0;l<s;l+=1)a.add(t[l]);for(;n<o;)a.add(e[n])&&(i[i.length]=e[n]),n+=1;return i}))},90602:function(e,t,i){"use strict";i.d(t,{Z:function(){return a}});var n=i(5393),o=i(71927),s=(0,i(95598).Z)((function(e){return null==e})),r=(0,n.Z)((function(e,t){if(0===e.length||s(t))return!1;for(var i=t,n=0;n<e.length;){if(s(i)||!(0,o.Z)(e[n],i))return!1;i=i[e[n]],n+=1}return!0})),a=(0,n.Z)((function(e,t){return r([e],t)}))},92800:function(e,t,i){"use strict";i.d(t,{Z:function(){return o}});var n=i(50223);function o(e,t){return function(e,t,i){var o,s;if("function"==typeof e.indexOf)switch(typeof t){case"number":if(0===t){for(o=1/t;i<e.length;){if(0===(s=e[i])&&1/s===o)return i;i+=1}return-1}if(t!=t){for(;i<e.length;){if("number"==typeof(s=e[i])&&s!=s)return i;i+=1}return-1}return e.indexOf(t,i);case"string":case"boolean":case"function":case"undefined":return e.indexOf(t,i);case"object":if(null===t)return e.indexOf(t,i)}for(;i<e.length;){if((0,n.Z)(e[i],t))return i;i+=1}return-1}(t,e,0)>=0}}}]);