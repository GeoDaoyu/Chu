"use strict";(self.webpackChunkscene_pro=self.webpackChunkscene_pro||[]).push([[35151],{39909:function(e,t,n){n.d(t,{AA:function(){return a},XO:function(){return o},YI:function(){return s},xx:function(){return r}});var i=n(59384);function r(e,t=!1){return e<=i.c8?t?new Array(e).fill(0):new Array(e):new Float32Array(e)}function s(e){return Array.isArray(e)?e.length<i.c8?e:new Float32Array(e):e.length<i.c8?Array.from(e):e}function o(e){return(Array.isArray(e)?e.length:e.byteLength/8)<=i.c8?Array.from(e):new Float32Array(e)}function a(e,t,n){return Array.isArray(e)?e.slice(t,t+n):e.subarray(t,t+n)}},6567:function(e,t,n){function i(e){switch(e){case"u8":case"i8":return 1;case"u16":case"i16":case"f16":return 2;case"u32":case"i32":case"f32":return 4;case"f64":return 8}}n.d(t,{n1:function(){return i}})},91013:function(e,t,n){n.d(t,{j:function(){return r}});var i=n(10729);function r(e,t){return new Promise(((n,r)=>{e.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA?n():(t((0,i.IH)(e,"canplay",n)),t((0,i.IH)(e,"error",r)))}))}},85886:function(e,t,n){var i;n.d(t,{E:function(){return i}}),function(e){e[e.ETC1_RGB=0]="ETC1_RGB",e[e.ETC2_RGBA=1]="ETC2_RGBA",e[e.BC1_RGB=2]="BC1_RGB",e[e.BC3_RGBA=3]="BC3_RGBA",e[e.BC4_R=4]="BC4_R",e[e.BC5_RG=5]="BC5_RG",e[e.BC7_M6_RGB=6]="BC7_M6_RGB",e[e.BC7_M5_RGBA=7]="BC7_M5_RGBA",e[e.PVRTC1_4_RGB=8]="PVRTC1_4_RGB",e[e.PVRTC1_4_RGBA=9]="PVRTC1_4_RGBA",e[e.ASTC_4x4_RGBA=10]="ASTC_4x4_RGBA",e[e.ATC_RGB=11]="ATC_RGB",e[e.ATC_RGBA=12]="ATC_RGBA",e[e.FXT1_RGB=17]="FXT1_RGB",e[e.PVRTC2_4_RGB=18]="PVRTC2_4_RGB",e[e.PVRTC2_4_RGBA=19]="PVRTC2_4_RGBA",e[e.ETC2_EAC_R11=20]="ETC2_EAC_R11",e[e.ETC2_EAC_RG11=21]="ETC2_EAC_RG11",e[e.RGBA32=13]="RGBA32",e[e.RGB565=14]="RGB565",e[e.BGR565=15]="BGR565",e[e.RGBA4444=16]="RGBA4444"}(i||(i={}))},51880:function(e,t,n){n.d(t,{t:function(){return r}});var i=n(78619);async function r(e,t){const{data:n}=await(0,i.Z)(e,{responseType:"image",...t});return n}},76e3:function(e,t,n){n.d(t,{FE:function(){return G},Tc:function(){return U},Ve:function(){return F},Z3:function(){return x},kD:function(){return H},vT:function(){return L},z2:function(){return B}});n(61432);var i,r,s=n(99574),o=n(96373),a=n(30748),c=n(31865),u=n(10934),l=n(24910),d=n(82846),h=n(73749),f=n(27583),_=n(4207),p=n(43462),m=n(27762),E=n(95285),T=n(74826);!function(e){e[e.Undefined=0]="Undefined",e[e.DefinedSize=1]="DefinedSize",e[e.DefinedScale=2]="DefinedScale"}(i||(i={})),function(e){e[e.Undefined=0]="Undefined",e[e.DefinedAngle=1]="DefinedAngle"}(r||(r={}));class g{constructor(e){this.field=e}}class A extends g{constructor(e){super(e),this.minSize=[0,0,0],this.maxSize=[0,0,0],this.offset=[0,0,0],this.factor=[0,0,0],this.type=[i.Undefined,i.Undefined,i.Undefined],this.fallback=[0,0,0]}}class R extends g{constructor(e){super(e),this.colors=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.values=[0,0,0,0,0,0,0,0],this.fallback=[0,0,0,0]}}class v extends g{constructor(e,t=0){super(e),this.fallback=t,this.values=[0,0,0,0,0,0,0,0],this.opacityValues=[0,0,0,0,0,0,0,0]}}class S{}function I(e){return null!=e}function N(e,t){e&&e.push(t)}function P(e,t,n,r,s){const o=e.minSize,a=e.maxSize;if(e.useSymbolValue){const e=r.symbolSize[n];return t.minSize[n]=e,t.maxSize[n]=e,t.offset[n]=t.minSize[n],t.factor[n]=0,t.type[n]=i.DefinedSize,!0}if(I(e.field))return I(e.stops)?2===e.stops.length&&(0,p.hj)(e.stops[0].size)&&(0,p.hj)(e.stops[1].size)?(M(e.stops[0].size,e.stops[1].size,e.stops[0].value,e.stops[1].value,t,n),t.type[n]=i.DefinedSize,!0):(N(s,"Could not convert size info: stops only supported with 2 elements"),!1):(0,p.hj)(o)&&(0,p.hj)(a)&&I(e.minDataValue)&&I(e.maxDataValue)?(M(o,a,e.minDataValue,e.maxDataValue,t,n),t.type[n]=i.DefinedSize,!0):"unknown"===e.valueUnit?(N(s,"Could not convert size info: proportional size not supported"),!1):null!=_.a[e.valueUnit]?(t.minSize[n]=-1/0,t.maxSize[n]=1/0,t.offset[n]=0,t.factor[n]=1/_.a[e.valueUnit],t.type[n]=i.DefinedSize,!0):(N(s,"Could not convert size info: scale-dependent size not supported"),!1);if(!I(e.field)){if(e.stops?.[0]&&(0,p.hj)(e.stops[0].size))return t.minSize[n]=e.stops[0].size,t.maxSize[n]=e.stops[0].size,t.offset[n]=t.minSize[n],t.factor[n]=0,t.type[n]=i.DefinedSize,!0;if((0,p.hj)(o))return t.minSize[n]=o,t.maxSize[n]=o,t.offset[n]=o,t.factor[n]=0,t.type[n]=i.DefinedSize,!0}return N(s,"Could not convert size info: unsupported variant of sizeInfo"),!1}function M(e,t,n,i,r,s){const o=Math.abs(i-n)>0?(t-e)/(i-n):0;r.minSize[s]=o>0?e:t,r.maxSize[s]=o>0?t:e,r.offset[s]=e-n*o,r.factor[s]=o}function C(e,t,n){e[4*t]=n.r/255,e[4*t+1]=n.g/255,e[4*t+2]=n.b/255,e[4*t+3]=n.a}function O(e,t,n){const i=2===n&&"arithmetic"===e.rotationType;t.offset[n]=i?90:0,t.factor[n]=i?-1:1,t.type[n]=1}class x{constructor({supports:e,modelSize:t,symbolSize:n,unitInMeters:i,anchor:r,scale:s,rotation:o,fallbackColor:a,fallbackSize:c}){this.supports=e,this.modelSize=t??(0,d.iU)(),this.symbolSize=n??(0,d.iU)(),this.unitInMeters=i??1,this.anchor=r??(0,d.ll)(),this.scale=s??(0,d.iU)(),this.rotation=o??(0,d.ll)(),this.fallbackColor=a??(0,f.iU)(),this.fallbackSize=c??(0,d.iU)()}}function D(e,t,n){if(!e)return null;const r=e.reduce(((e,i)=>{if(!e)return e;if(i.valueExpression)return N(n,"Could not convert visual variables: arcade expressions not supported"),null;switch(i.type){case"size":return t.supports.size?function(e,t,n,i){if(e.normalizationField||e.valueRepresentation)return N(i,"Could not convert size info: unsupported property"),null;if(!(0,p.tM)(e.field))return N(i,"Could not convert size info: field is not a string"),null;if(t.size){if(e.field)if(t.size.field){if(e.field!==t.size.field)return N(i,"Could not convert size info: multiple fields in use"),null}else t.size.field=e.field}else t.size=new A(e.field),(0,l.c)(t.size.fallback,n.fallbackSize);let r;switch(e.axis){case"width":return r=P(e,t.size,0,n,i),r?t:null;case"height":return r=P(e,t.size,2,n,i),r?t:null;case"depth":return r=P(e,t.size,1,n,i),r?t:null;case"width-and-depth":return r=P(e,t.size,0,n,i),r&&P(e,t.size,1,n,i),r?t:null;case null:case void 0:case"all":return r=P(e,t.size,0,n,i),r=r&&P(e,t.size,1,n,i),r=r&&P(e,t.size,2,n,i),r?t:null;default:return N(i,`Could not convert size info: unknown axis "${e.axis}""`),null}}(i,e,t,n):e;case"color":return t.supports.color?function(e,t,n,i){if(e.normalizationField)return N(i,"Could not convert color info: unsupported property"),null;if((0,p.HD)(e.field)){if(!e.stops)return N(i,"Could not convert color info: missing stops or colors"),null;{if(e.stops.length>8)return N(i,"Could not convert color info: too many color stops"),null;t.color=new R(e.field);const r=e.stops;for(let e=0;e<8;++e){const n=r[Math.min(e,r.length-1)];t.color.values[e]=n.value,C(t.color.colors,e,n.color)}(0,h.c)(t.color.fallback,n.fallbackColor)}}else{if(!(e.stops&&e.stops.length>=0))return N(i,"Could not convert color info: no field and no colors/stops"),null;{const i=e.stops&&e.stops.length>=0&&e.stops[0].color;t.color=new R(null);for(let e=0;e<8;e++)t.color.values[e]=1/0,C(t.color.colors,e,i);(0,h.c)(t.color.fallback,n.fallbackColor)}}return t}(i,e,t,n):e;case"opacity":return t.supports.opacity?function(e,t,n,i){if(e.normalizationField)return N(i,"Could not convert opacity info: unsupported property"),null;if((0,p.HD)(e.field)){if(!e.stops)return N(i,"Could not convert opacity info: missing stops or opacities"),null;{if(e.stops.length>8)return N(i,"Could not convert opacity info: too many opacity stops"),null;t.opacity=new v(e.field,n.fallbackColor[3]);const r=e.stops;for(let e=0;e<8;++e){const n=r[Math.min(e,r.length-1)];t.opacity.values[e]=n.value,t.opacity.opacityValues[e]=n.opacity}}}else{if(!(e.stops&&e.stops.length>=0))return N(i,"Could not convert opacity info: no field and no opacities/stops"),null;{const i=e.stops&&e.stops.length>=0?e.stops[0].opacity:0;t.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0],fallback:n.fallbackColor[3]};for(let e=0;e<8;e++)t.opacity.values[e]=1/0,t.opacity.opacityValues[e]=i}}return t}(i,e,t,n):null;case"rotation":return t.supports.rotation?function(e,t,n){if(!(0,p.HD)(e.field))return N(n,"Could not convert rotation info: field is not a string"),null;if(t.rotation){if(e.field)if(t.rotation.field){if(e.field!==t.rotation.field)return N(n,"Could not convert rotation info: multiple fields in use"),null}else t.rotation.field=e.field}else t.rotation={field:e.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};switch(e.axis){case"tilt":return O(e,t.rotation,0),t;case"roll":return O(e,t.rotation,1),t;case null:case void 0:case"heading":return O(e,t.rotation,2),t;default:return N(n,`Could not convert rotation info: unknown axis "${e.axis}""`),null}}(i,e,n):e;default:return null}}),new S);return!(e.length>0&&r)||r.size||r.color||r.opacity||r.rotation?r?.size&&!function(e,t,n){for(let n=0;n<3;++n){let r=t.unitInMeters;e.type[n]===i.DefinedSize&&(r*=t.modelSize[n],e.type[n]=i.DefinedScale),e.minSize[n]=e.minSize[n]/r,e.maxSize[n]=e.maxSize[n]/r,e.offset[n]=e.offset[n]/r,e.factor[n]=e.factor[n]/r}let r;if(e.type[0]!==i.Undefined)r=0;else if(e.type[1]!==i.Undefined)r=1;else{if(e.type[2]===i.Undefined)return N(n,"No size axis contains a valid size or scale"),!1;r=2}for(let t=0;t<3;++t)e.type[t]===i.Undefined&&(e.minSize[t]=e.minSize[r],e.maxSize[t]=e.maxSize[r],e.offset[t]=e.offset[r],e.factor[t]=e.factor[r],e.type[t]=e.type[r]);return!0}(r.size,t,n)?null:r:null}class b{constructor(e,t,n){this.visualVariables=e,this.materialParameters=t,this.requiresShaderTransformation=n}}function L(e,t){if(!e)return null;if((0,E.B)())return null;if(m.h.TESTS_DISABLE_FAST_UPDATES)return null;const n=D(e.visualVariables,t);return n?new b(n,y(n,t),!!n.size):null}function U(e,t,n){if(!t||!e)return!1;const i=e.visualVariables,r=D(t.visualVariables,n);return!!r&&!!(w(i.size,r.size,"size")&&w(i.color,r.color,"color")&&w(i.rotation,r.rotation,"rotation")&&w(i.opacity,r.opacity,"opacity"))&&(e.visualVariables=r,e.materialParameters=y(r,n),e.requiresShaderTransformation=!!r.size,!0)}function w(e,t,n){if(!!e!=!!t)return!1;if(e&&e.field!==t?.field)return!1;if(e&&"rotation"===n){const n=e,i=t;for(let e=0;e<3;e++)if(n.type[e]!==i.type[e]||n.offset[e]!==i.offset[e]||n.factor[e]!==i.factor[e])return!1}return!0}class F extends T.K{constructor(e){super(),this.vvSize=e?.size??null,this.vvColor=e?.color??null,this.vvOpacity=e?.opacity??null}}function y(e,t){const n=new F(e);return n.vvSize&&(n.vvSymbolAnchor=t.anchor,(0,c.yR)(W),function(e,t,n,i=(0,u.Ue)()){const r=e||0,s=t||0,o=n||0;0!==r&&(0,c.jI)(i,i,-r/180*Math.PI),0!==s&&(0,c.lM)(i,i,s/180*Math.PI),0!==o&&(0,c.uD)(i,i,o/180*Math.PI)}(t.rotation[2],t.rotation[0],t.rotation[1],W),n.vvSymbolRotationMatrix=n.vvSymbolRotationMatrix||(0,a.Ue)(),(0,o.xO)(n.vvSymbolRotationMatrix,W)),n}function B(e,t,n){if(!e.vvSize)return n;(0,c.JG)(V,n);const i=e.vvSymbolRotationMatrix;return(0,c.t8)(W,i[0],i[1],i[2],0,i[3],i[4],i[5],0,i[6],i[7],i[8],0,0,0,0,1),(0,c.Jp)(V,V,W),G(z,e,t),(0,c.bA)(V,V,z),(0,c.Iu)(V,V,e.vvSymbolAnchor),V}function G(e,t,n){if(!t.vvSize)return(0,l.i)(e,1,1,1),e;if(Number.isNaN(n[0]))return(0,l.c)(e,t.vvSize.fallback);for(let i=0;i<3;++i){const r=t.vvSize.offset[i]+n[0]*t.vvSize.factor[i];e[i]=(0,s.uZ)(r,t.vvSize.minSize[i],t.vvSize.maxSize[i])}return e}function H(e,t){const n=null==e?0:t.attributes[e];return"number"==typeof n&&isFinite(n)?n:NaN}const V=(0,u.Ue)(),z=(0,d.Ue)(),W=(0,u.Ue)()},52890:function(e,t,n){n.d(t,{Gw:function(){return l},U$:function(){return u},pV:function(){return c}});var i=n(57192),r=n(81342),s=n(6567),o=n(61719);class a{constructor(e,t){this.layout=e,this.buffer="number"==typeof t?new ArrayBuffer(t*e.stride):t;for(const t of e.fields.keys()){const n=e.fields.get(t);this[t]=new n.constructor(this.buffer,n.offset,this.stride)}}get stride(){return this.layout.stride}get count(){return this.buffer.byteLength/this.stride}get byteLength(){return this.buffer.byteLength}getField(e,t){const n=this[e];return n&&n.elementCount===t.ElementCount&&n.elementType===t.ElementType?n:null}slice(e,t){return new a(this.layout,this.buffer.slice(e*this.stride,t*this.stride))}copyFrom(e,t=0,n=0,i=e.count){const r=this.stride;if(r%4==0){const s=new Uint32Array(e.buffer,t*r,i*r/4);new Uint32Array(this.buffer,n*r,i*r/4).set(s)}else{const s=new Uint8Array(e.buffer,t*r,i*r);new Uint8Array(this.buffer,n*r,i*r).set(s)}return this}get cachedMemory(){return this.byteLength}dispose(){}}class c{constructor(e){this._stride=0,this._fields=new Map,e&&(this._stride=e.stride,e.fields.forEach((e=>this._fields.set(e[0],{...e[1],constructor:f(e[1].constructor)}))))}freeze(){return this}vec2f16(e,t){return this._appendField(e,i.LL?r.hg:r.Eu,t),this}vec2f(e,t){return this._appendField(e,r.Eu,t),this}vec2f64(e,t){return this._appendField(e,r.q6,t),this}vec3f16(e,t){return this._appendField(e,i.LL?r.qx:r.ct,t),this}vec3f(e,t){return this._appendField(e,r.ct,t),this}vec3f64(e,t){return this._appendField(e,r.fP,t),this}vec4f16(e,t){return this._appendField(e,i.LL?r.R2:r.ek,t),this}vec4f(e,t){return this._appendField(e,r.ek,t),this}vec4f64(e,t){return this._appendField(e,r.Cd,t),this}mat3f(e,t){return this._appendField(e,r.gK,t),this}mat3f64(e,t){return this._appendField(e,r.ey,t),this}mat4f(e,t){return this._appendField(e,r.bj,t),this}mat4f64(e,t){return this._appendField(e,r.O1,t),this}vec4u8(e,t){return this._appendField(e,r.mc,t),this}f16(e,t){return this._appendField(e,i.LL?r.yT:r.ly,t),this}f32(e,t){return this._appendField(e,r.ly,t),this}f64(e,t){return this._appendField(e,r.oS,t),this}u8(e,t){return this._appendField(e,r.D_,t),this}u16(e,t){return this._appendField(e,r.av,t),this}i8(e,t){return this._appendField(e,r.Hz,t),this}vec2i8(e,t){return this._appendField(e,r.Vs,t),this}vec2i16(e,t){return this._appendField(e,r.or,t),this}vec2u8(e,t){return this._appendField(e,r.xA,t),this}vec2u16(e,t){return this._appendField(e,r.TS,t),this}vec4u16(e,t){return this._appendField(e,r.v6,t),this}u32(e,t){return this._appendField(e,r.Nu,t),this}_appendField(e,t,n){this._fields.has(e)&&(0,o.hu)(!1,`${e} already added to vertex buffer layout`);const i=t.ElementCount*(0,s.n1)(t.ElementType),r=this._stride;this._fields.set(e,{constructor:t,size:i,offset:r,optional:n}),this._alignFields()}_alignFields(){let e=0,t=1;this._fields.forEach((n=>{const i=(0,s.n1)(n.constructor.ElementType);e=Math.floor((e+i-1)/i)*i,n.offset=e,e+=n.size,t=Math.max(t,i)})),e=Math.floor((e+t-1)/t)*t,this._stride=e}createBuffer(e){return new a(this,e)}createView(e){return new a(this,e)}clone(){const e=new c;return e._stride=this._stride,e._fields=new Map,this._fields.forEach(((t,n)=>e._fields.set(n,t))),e.BufferType=this.BufferType,e}get stride(){return this._stride}get fields(){return this._fields}}function u(){return new c}class l{constructor(e){this.fields=new Array,e.fields.forEach(((e,t)=>{const n={...e,constructor:h(e.constructor)};this.fields.push([t,n])})),this.stride=e.stride}}const d=[r.ly,r.Eu,r.ct,r.ek,r.gK,r.bj,r.oS,r.q6,r.fP,r.Cd,r.ey,r.O1,r.D_,r.xA,r.ne,r.mc,r.av,r.TS,r.mw,r.v6,r.Nu,r.qt,r.G5,r.hu,r.Hz,r.Vs,r.P_,r.ir,r.o7,r.or,r.n1,r.zO,r.Jj,r.wA,r.PP,r.TN];function h(e){return`${e.ElementType}_${e.ElementCount}`}function f(e){return _.get(e)}const _=new Map;d.forEach((e=>_.set(h(e),e)))},69371:function(e,t,n){n.d(t,{NY:function(){return u},cc:function(){return A},gg:function(){return v},qk:function(){return r},qz:function(){return i}});var i,r,s,o=n(65650),a=n(35928),c=n(42377);(s=i||(i={}))[s.R8UNORM=0]="R8UNORM",s[s.R8UINT=1]="R8UINT",s[s.RG8UNORM=2]="RG8UNORM",s[s.RG8UINT=3]="RG8UINT",s[s.RGBA4UNORM=4]="RGBA4UNORM",s[s.RGBA8UNORM=5]="RGBA8UNORM",s[s.RGBA8UNORM_MIPMAP=6]="RGBA8UNORM_MIPMAP",s[s.R16FLOAT=7]="R16FLOAT",s[s.RGBA16FLOAT=8]="RGBA16FLOAT",s[s.R32FLOAT=9]="R32FLOAT",s[s.COUNT=10]="COUNT",function(e){e[e.DEPTH16=10]="DEPTH16",e[e.DEPTH24_STENCIL8=11]="DEPTH24_STENCIL8"}(r||(r={}));i.R8UNORM,i.R8UINT,i.R16FLOAT,i.R32FLOAT,i.RG8UNORM,i.RG8UINT,i.RGBA8UNORM,i.RGBA4UNORM,i.RGBA8UNORM_MIPMAP,i.RGBA16FLOAT,r.DEPTH16,r.DEPTH24_STENCIL8;function u(e){return e>=i.COUNT}const l=new a.X;l.pixelFormat=o.VI.RED,l.internalFormat=o.lP.R8,l.wrapMode=o.e8.CLAMP_TO_EDGE;const d=new a.X;d.pixelFormat=o.VI.RED_INTEGER,d.internalFormat=o.lP.R8UI,d.wrapMode=o.e8.CLAMP_TO_EDGE,d.samplingMode=o.cw.NEAREST;const h=new a.X;h.pixelFormat=o.VI.RG,h.internalFormat=o.lP.RG8,h.wrapMode=o.e8.CLAMP_TO_EDGE;const f=new a.X;f.pixelFormat=o.VI.RG_INTEGER,f.internalFormat=o.lP.RG8UI,f.wrapMode=o.e8.CLAMP_TO_EDGE,f.samplingMode=o.cw.NEAREST;const _=new a.X;_.internalFormat=o.lP.RGBA4,_.dataType=o.Br.UNSIGNED_SHORT_4_4_4_4,_.wrapMode=o.e8.CLAMP_TO_EDGE;const p=new a.X;p.wrapMode=o.e8.CLAMP_TO_EDGE;const m=new a.X;m.wrapMode=o.e8.CLAMP_TO_EDGE,m.samplingMode=o.cw.LINEAR_MIPMAP_LINEAR,m.hasMipmap=!0,m.maxAnisotropy=8;const E=new a.X;E.pixelFormat=o.VI.RED,E.dataType=o.Br.HALF_FLOAT,E.internalFormat=o.lP.R16F,E.samplingMode=o.cw.NEAREST;const T=new a.X;T.dataType=o.Br.HALF_FLOAT,T.internalFormat=o.lP.RGBA16F,T.wrapMode=o.e8.CLAMP_TO_EDGE;const g=new a.X;g.pixelFormat=o.VI.RED,g.dataType=o.Br.FLOAT,g.internalFormat=o.lP.R32F,g.samplingMode=o.cw.NEAREST;const A={[i.R8UNORM]:l,[i.R8UINT]:d,[i.RG8UNORM]:h,[i.RG8UINT]:f,[i.RGBA4UNORM]:_,[i.RGBA8UNORM]:p,[i.RGBA8UNORM_MIPMAP]:m,[i.R16FLOAT]:E,[i.RGBA16FLOAT]:T,[i.R32FLOAT]:g,[i.COUNT]:null},R={[o.DM.DEPTH_COMPONENT16]:o.Br.UNSIGNED_SHORT,[o.DM.DEPTH_COMPONENT24]:o.Br.UNSIGNED_INT,[o.DM.DEPTH_COMPONENT32F]:o.Br.FLOAT,[o.wo.DEPTH24_STENCIL8]:o.Br.UNSIGNED_INT_24_8,[o.wo.DEPTH32F_STENCIL8]:o.Br.FLOAT_32_UNSIGNED_INT_24_8_REV},v={[r.DEPTH24_STENCIL8]:S(o.wo.DEPTH24_STENCIL8),[r.DEPTH16]:S(o.DM.DEPTH_COMPONENT16)};function S(e){const t=new a.X;return t.pixelFormat=(0,c.M4)(e)?o.N2.DEPTH_COMPONENT:o.N2.DEPTH_STENCIL,t.dataType=R[e],t.samplingMode=o.cw.NEAREST,t.wrapMode=o.e8.CLAMP_TO_EDGE,t.internalFormat=e,t.hasMipmap=!1,t.isImmutable=!0,t}},57531:function(e,t,n){n.d(t,{D:function(){return r}});var i=n(48857);function r(e){const{fragment:t}=e;t.code.add(i.H`uint readChannelBits(uint channel, int highlightLevel) {
int llc = (highlightLevel & 3) << 1;
return (channel >> llc) & 3u;
}
uint readChannel(uvec2 texel, int highlightLevel) {
int lic = (highlightLevel >> 2) & 1;
return texel[lic];
}
uint readLevelBits(uvec2 texel, int highlightLevel) {
return readChannelBits(readChannel(texel, highlightLevel), highlightLevel);
}`)}},17904:function(e,t,n){n.d(t,{k:function(){return s}});var i=n(48857),r=n(52061);function s(e,t=!0){e.attributes.add(r.T.POSITION,"vec2"),t&&e.varyings.add("uv","vec2"),e.vertex.main.add(i.H`
      gl_Position = vec4(position, 0.0, 1.0);
      ${t?i.H`uv = position * 0.5 + vec2(0.5);`:""}
  `)}},27349:function(e,t,n){n.d(t,{$S:function(){return _},P_:function(){return h},UT:function(){return d},f5:function(){return f}});var i=n(31865),r=n(10934),s=n(24910),o=n(82846),a=n(80357),c=n(9535),u=n(48857),l=n(74826);class d extends l.K{constructor(e){super(),this.slicePlaneLocalOrigin=e}}function h(e,t){E(e,t,new c.J("slicePlaneOrigin",((e,n)=>R(t,e,n))),new c.J("slicePlaneBasis1",((e,n)=>v(t,e,n,n.slicePlane?.basis1))),new c.J("slicePlaneBasis2",((e,n)=>v(t,e,n,n.slicePlane?.basis2))))}function f(e,t){E(e,t,new a.B("slicePlaneOrigin",((e,n)=>R(t,e,n))),new a.B("slicePlaneBasis1",((e,n)=>v(t,e,n,n.slicePlane?.basis1))),new a.B("slicePlaneBasis2",((e,n)=>v(t,e,n,n.slicePlane?.basis2))))}function _(e,t){m(e,t,new a.B("slicePlaneOrigin",((e,n)=>R(t,e,n))),new a.B("slicePlaneBasis1",((e,n)=>v(t,e,n,n.slicePlane?.basis1))),new a.B("slicePlaneBasis2",((e,n)=>v(t,e,n,n.slicePlane?.basis2))))}const p=u.H`struct SliceFactors {
float front;
float side0;
float side1;
float side2;
float side3;
};
SliceFactors calculateSliceFactors(vec3 pos) {
vec3 rel = pos - slicePlaneOrigin;
vec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);
float slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);
float basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);
float basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);
float basis1Dot = dot(slicePlaneBasis1, rel);
float basis2Dot = dot(slicePlaneBasis2, rel);
return SliceFactors(
dot(slicePlaneNormal, pos) + slicePlaneW,
-basis1Dot - basis1Len2,
basis1Dot - basis1Len2,
-basis2Dot - basis2Len2,
basis2Dot - basis2Len2
);
}
bool sliceByFactors(SliceFactors factors) {
return factors.front < 0.0
&& factors.side0 < 0.0
&& factors.side1 < 0.0
&& factors.side2 < 0.0
&& factors.side3 < 0.0;
}
bool sliceEnabled() {
return dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;
}
bool sliceByPlane(vec3 pos) {
return sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));
}
bool rejectBySlice(vec3 pos) {
return sliceByPlane(pos);
}`;function m(e,t,...n){t.hasSlicePlane?(e.uniforms.add(...n),e.code.add(p)):e.code.add("bool rejectBySlice(vec3 pos) { return false; }")}function E(e,t,...n){m(e,t,...n),t.hasSlicePlane?e.code.add("\n    void discardBySlice(vec3 pos) {\n      if (sliceByPlane(pos)) {\n        discard;\n      }\n    }\n\n    vec4 applySliceOutline(vec4 color, vec3 pos) {\n      SliceFactors factors = calculateSliceFactors(pos);\n\n      factors.front /= 2.0 * fwidth(factors.front);\n      factors.side0 /= 2.0 * fwidth(factors.side0);\n      factors.side1 /= 2.0 * fwidth(factors.side1);\n      factors.side2 /= 2.0 * fwidth(factors.side2);\n      factors.side3 /= 2.0 * fwidth(factors.side3);\n\n      // return after calling fwidth, to avoid aliasing caused by discontinuities in the input to fwidth\n      if (sliceByFactors(factors)) {\n        return color;\n      }\n\n      float outlineFactor = (1.0 - step(0.5, factors.front))\n        * (1.0 - step(0.5, factors.side0))\n        * (1.0 - step(0.5, factors.side1))\n        * (1.0 - step(0.5, factors.side2))\n        * (1.0 - step(0.5, factors.side3));\n\n      return mix(color, vec4(vec3(0.0), color.a), outlineFactor * 0.3);\n    }\n\n    vec4 applySlice(vec4 color, vec3 pos) {\n      return sliceEnabled() ? applySliceOutline(color, pos) : color;\n    }\n  "):e.code.add(u.H`void discardBySlice(vec3 pos) { }
vec4 applySlice(vec4 color, vec3 pos) { return color; }`)}function T(e,t,n){return e.instancedDoublePrecision?(0,s.i)(S,n.camera.viewInverseTransposeMatrix[3],n.camera.viewInverseTransposeMatrix[7],n.camera.viewInverseTransposeMatrix[11]):t.slicePlaneLocalOrigin}function g(e,t){return null!=e?(0,s.d)(I,t.origin,e):t.origin}function A(e,t,n){return e.hasSliceTranslatedView?null!=t?(0,i.Iu)(P,n.camera.viewMatrix,t):n.camera.viewMatrix:null}function R(e,t,n){if(null==n.slicePlane)return o.AG;const i=T(e,t,n),r=g(i,n.slicePlane),a=A(e,i,n);return null!=a?(0,s.t)(I,r,a):r}function v(e,t,n,i){if(null==i||null==n.slicePlane)return o.AG;const r=T(e,t,n),a=g(r,n.slicePlane),c=A(e,r,n);return null!=c?((0,s.f)(N,i,a),(0,s.t)(I,a,c),(0,s.t)(N,N,c),(0,s.d)(N,N,I)):i}const S=(0,o.Ue)(),I=(0,o.Ue)(),N=(0,o.Ue)(),P=(0,r.Ue)()},68647:function(e,t,n){n.d(t,{R:function(){return o}});var i=n(41044),r=n(48857),s=n(52061);function o(e,t){if(t.output!==i.H_.ObjectAndLayerIdColor)return e.vertex.code.add(r.H`void forwardObjectAndLayerIdColor() {}`),void e.fragment.code.add(r.H`void outputObjectAndLayerIdColor() {}`);const n=t.objectAndLayerIdColorInstanced;e.varyings.add("objectAndLayerIdColorVarying","vec4"),e.attributes.add(n?s.T.INSTANCEOBJECTANDLAYERIDCOLOR:s.T.OLIDCOLOR,"vec4"),e.vertex.code.add(r.H`
    void forwardObjectAndLayerIdColor() {
      objectAndLayerIdColorVarying = ${n?"instanceObjectAndLayerIdColor":"objectAndLayerIdColor"} * 0.003921568627451;
    }`),e.fragment.code.add(r.H`void outputObjectAndLayerIdColor() {
fragColor = objectAndLayerIdColorVarying;
}`)}},31839:function(e,t,n){n.d(t,{D:function(){return a},I:function(){return i}});var i,r=n(79487),s=n(48857),o=n(52061);function a(e,t){switch(t.textureCoordinateType){case i.Default:return e.attributes.add(o.T.UV0,"vec2"),e.varyings.add("vuv0","vec2"),void e.vertex.code.add(s.H`void forwardTextureCoordinates() { vuv0 = uv0; }`);case i.Atlas:return e.attributes.add(o.T.UV0,"vec2"),e.attributes.add(o.T.UVREGION,"vec4"),e.varyings.add("vuv0","vec2"),e.varyings.add("vuvRegion","vec4"),void e.vertex.code.add(s.H`void forwardTextureCoordinates() {
vuv0 = uv0;
vuvRegion = uvRegion;
}`);default:(0,r.Bg)(t.textureCoordinateType);case i.None:return void e.vertex.code.add(s.H`void forwardTextureCoordinates() {}`);case i.COUNT:return}}!function(e){e[e.None=0]="None",e[e.Default=1]="Default",e[e.Atlas=2]="Atlas",e[e.COUNT=3]="COUNT"}(i||(i={}))},79786:function(e,t,n){n.d(t,{i:function(){return o}});var i=n(31839),r=n(48857);function s(e){e.fragment.code.add(r.H`vec4 textureAtlasLookup(sampler2D tex, vec2 textureCoordinates, vec4 atlasRegion) {
vec2 atlasScale = atlasRegion.zw - atlasRegion.xy;
vec2 uvAtlas = fract(textureCoordinates) * atlasScale + atlasRegion.xy;
float maxdUV = 0.125;
vec2 dUVdx = clamp(dFdx(textureCoordinates), -maxdUV, maxdUV) * atlasScale;
vec2 dUVdy = clamp(dFdy(textureCoordinates), -maxdUV, maxdUV) * atlasScale;
return textureGrad(tex, uvAtlas, dUVdx, dUVdy);
}`)}function o(e,t){const{textureCoordinateType:n}=t;if(n===i.I.None||n===i.I.COUNT)return;e.include(i.D,t);const o=n===i.I.Atlas;o&&e.include(s),e.fragment.code.add(r.H`
    vec4 textureLookup(sampler2D tex, vec2 uv) {
      return ${o?"textureAtlasLookup(tex, uv, vuvRegion)":"texture(tex, uv)"};
    }
  `)}},34479:function(e,t,n){n.d(t,{Ok:function(){return p},jo:function(){return i}});var i,r,s=n(41044),o=n(79786),a=n(80357),c=n(9535),u=n(30881),l=n(85119),d=n(48857),h=n(29193),f=n(34709),_=(n(40156),n(5998));(r=i||(i={}))[r.None=0]="None",r[r.SymbolColor=1]="SymbolColor",r[r.EmissiveColor=2]="EmissiveColor",r[r.Texture=3]="Texture",r[r.COUNT=4]="COUNT";function p(e,t){if(!(0,s.c1)(t.output))return;const{emissionSource:n,hasEmissiveTextureTransform:r,bindType:p}=t,m=n===i.Texture;m&&(e.include(o.i,t),e.fragment.uniforms.add(p===_.P.Pass?new f.A("texEmission",(e=>e.textureEmissive)):new h.R("texEmission",(e=>e.textureEmissive))));const E=n===i.EmissiveColor||m;E&&e.fragment.uniforms.add(p===_.P.Pass?new c.J("emissiveBaseColor",(e=>e.emissiveBaseColor)):new a.B("emissiveBaseColor",(e=>e.emissiveBaseColor)));const T=n!==i.None;T&&e.fragment.uniforms.add(p===_.P.Pass?new l.p("emissiveStrength",(e=>e.emissiveStrength)):new u.p("emissiveStrength",(e=>e.emissiveStrength)));const g=n===i.SymbolColor;e.fragment.code.add(d.H`
    vec4 getEmissions(vec3 symbolColor) {
      vec4 emissions = ${E?"vec4(emissiveBaseColor, 1.0)":g?"vec4(symbolColor, 1.0)":"vec4(0.0)"};
      ${(0,d.If)(m,`emissions *= textureLookup(texEmission, ${r?"emissiveUV":"vuv0"});\n         emissions.w = emissions.rgb == vec3(0.0) ? 0.0: emissions.w;`)}
      ${(0,d.If)(T,"emissions.rgb *= emissiveStrength;")}
      return emissions;
    }
  `)}},40122:function(e,t,n){n.d(t,{b:function(){return h}});var i=n(57531),r=n(41044),s=n(48857),o=n(5998),a=n(92217);class c extends a.x{constructor(e,t){super(e,"ivec2",o.P.Bind,((n,i)=>n.setUniform2iv(e,t(i))))}}var u=n(63981),l=n(71063);class d extends a.x{constructor(e,t){super(e,"usampler2D",o.P.Bind,((n,i)=>n.bindTexture(e,t(i))))}}function h(e,t){const{fragment:n}=e,{output:o,draped:a,hasHighlightMixTexture:h}=t;o===r.H_.Highlight?(n.uniforms.add(new u.Y("highlightLevel",(e=>e.highlightLevel??0)),new c("highlightMixOrigin",(e=>e.highlightMixOrigin))),e.outputs.add("fragHighlight","uvec2",0),e.include(i.D),h?n.uniforms.add(new d("highlightMixTexture",(e=>e.highlightMixTexture))).code.add(s.H`uvec2 getAccumulatedHighlight() {
return texelFetch(highlightMixTexture, ivec2(gl_FragCoord.xy) - highlightMixOrigin, 0).rg;
}
void outputHighlight(bool occluded) {
if (highlightLevel == 0) {
uint bits = occluded ? 3u : 1u;
fragHighlight = uvec2(bits, 0);
} else {
int ll = (highlightLevel & 3) << 1;
int li = (highlightLevel >> 2) & 3;
uint bits;
if (occluded) {
bits = 3u << ll;
} else {
bits = 1u << ll;
}
uvec2 combinedHighlight = getAccumulatedHighlight();
combinedHighlight[li] |= bits;
fragHighlight = combinedHighlight;
}
}`):n.code.add(s.H`void outputHighlight(bool occluded) {
uint bits = occluded ? 3u : 1u;
fragHighlight = uvec2(bits, 0);
}`),a?n.code.add(s.H`bool isHighlightOccluded() {
return false;
}`):n.uniforms.add(new l.e("depthTexture",(e=>e.mainDepth))).code.add(s.H`bool isHighlightOccluded() {
float sceneDepth = texelFetch(depthTexture, ivec2(gl_FragCoord.xy), 0).x;
return gl_FragCoord.z > sceneDepth + 5e-7;
}`),n.code.add(s.H`void calculateOcclusionAndOutputHighlight() {
outputHighlight(isHighlightOccluded());
}`)):n.code.add(s.H`void calculateOcclusionAndOutputHighlight() {}`)}},20638:function(e,t,n){n.d(t,{K:function(){return a}});var i=n(26821),r=n(41788),s=n(37124),o=n(48857);function a(e){e.uniforms.add(new s.$("zProjectionMap",(e=>function(e){const t=e.projectionMatrix;return(0,i.t8)(c,t[14],t[10])}(e.camera)))),e.code.add(o.H`float linearizeDepth(float depth) {
float depthNdc = depth * 2.0 - 1.0;
float c1 = zProjectionMap[0];
float c2 = zProjectionMap[1];
return -(c1 / (depthNdc + c2 + 1e-7));
}`),e.code.add(o.H`float depthFromTexture(sampler2D depthTexture, vec2 uv) {
ivec2 iuv = ivec2(uv * vec2(textureSize(depthTexture, 0)));
float depth = texelFetch(depthTexture, iuv, 0).r;
return depth;
}`),e.code.add(o.H`float linearDepthFromTexture(sampler2D depthTexture, vec2 uv) {
return linearizeDepth(depthFromTexture(depthTexture, uv));
}`)}const c=(0,r.Ue)()},32179:function(e,t,n){n.d(t,{F1:function(){return o},Pe:function(){return s},gz:function(){return a}});var i=n(87688),r=n(48857);function s(e){e.uniforms.add(new i.d("mainLightDirection",(e=>e.lighting.mainLight.direction)))}function o(e){e.uniforms.add(new i.d("mainLightIntensity",(e=>e.lighting.mainLight.intensity)))}function a(e){s(e.fragment),o(e.fragment),e.fragment.code.add(r.H`vec3 applyShading(vec3 shadingNormal, float shadow) {
float dotVal = clamp(dot(shadingNormal, mainLightDirection), 0.0, 1.0);
return mainLightIntensity * ((1.0 - shadow) * dotVal);
}`)}},4106:function(e,t,n){n.d(t,{T:function(){return a},g:function(){return c}});var i=n(48857);function r(e){e.code.add(i.H`vec3 evaluateDiffuseIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float NdotNG) {
return ((1.0 - NdotNG) * ambientGround + (1.0 + NdotNG) * ambientSky) * 0.5;
}`),e.code.add(i.H`float integratedRadiance(float cosTheta2, float roughness) {
return (cosTheta2 - 1.0) / (cosTheta2 * (1.0 - roughness * roughness) - 1.0);
}`),e.code.add(i.H`vec3 evaluateSpecularIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float RdotNG, float roughness) {
float cosTheta2 = 1.0 - RdotNG * RdotNG;
float intRadTheta = integratedRadiance(cosTheta2, roughness);
float ground = RdotNG < 0.0 ? 1.0 - intRadTheta : 1.0 + intRadTheta;
float sky = 2.0 - ground;
return (ground * ambientGround + sky * ambientSky) * 0.5;
}`)}var s=n(42510),o=n(28262);function a(e,t){e.include(o.e),t.pbrMode!==s.f7.Normal&&t.pbrMode!==s.f7.Schematic&&t.pbrMode!==s.f7.Simplified&&t.pbrMode!==s.f7.TerrainWithWater||(e.code.add(i.H`float normalDistribution(float NdotH, float roughness)
{
float a = NdotH * roughness;
float b = roughness / (1.0 - NdotH * NdotH + a * a);
return b * b * INV_PI;
}`),e.code.add(i.H`const vec4 c0 = vec4(-1.0, -0.0275, -0.572,  0.022);
const vec4 c1 = vec4( 1.0,  0.0425,  1.040, -0.040);
const vec2 c2 = vec2(-1.04, 1.04);
vec2 prefilteredDFGAnalytical(float roughness, float NdotV) {
vec4 r = roughness * c0 + c1;
float a004 = min(r.x * r.x, exp2(-9.28 * NdotV)) * r.x + r.y;
return c2 * a004 + r.zw;
}`)),t.pbrMode!==s.f7.Normal&&t.pbrMode!==s.f7.Schematic||(e.include(r),e.code.add(i.H`struct PBRShadingInfo
{
float NdotV;
float LdotH;
float NdotNG;
float RdotNG;
float NdotAmbDir;
float NdotH_Horizon;
vec3 skyRadianceToSurface;
vec3 groundRadianceToSurface;
vec3 skyIrradianceToSurface;
vec3 groundIrradianceToSurface;
float averageAmbientRadiance;
float ssao;
vec3 albedoLinear;
vec3 f0;
vec3 f90;
vec3 diffuseColor;
float metalness;
float roughness;
};`),e.code.add(i.H`vec3 evaluateEnvironmentIllumination(PBRShadingInfo inputs) {
vec3 indirectDiffuse = evaluateDiffuseIlluminationHemisphere(inputs.groundIrradianceToSurface, inputs.skyIrradianceToSurface, inputs.NdotNG);
vec3 indirectSpecular = evaluateSpecularIlluminationHemisphere(inputs.groundRadianceToSurface, inputs.skyRadianceToSurface, inputs.RdotNG, inputs.roughness);
vec3 diffuseComponent = inputs.diffuseColor * indirectDiffuse * INV_PI;
vec2 dfg = prefilteredDFGAnalytical(inputs.roughness, inputs.NdotV);
vec3 specularColor = inputs.f0 * dfg.x + inputs.f90 * dfg.y;
vec3 specularComponent = specularColor * indirectSpecular;
return (diffuseComponent + specularComponent);
}`))}function c(e,t){e.include(o.e),e.code.add(i.H`
  struct PBRShadingWater {
      float NdotL;   // cos angle between normal and light direction
      float NdotV;   // cos angle between normal and view direction
      float NdotH;   // cos angle between normal and half vector
      float VdotH;   // cos angle between view direction and half vector
      float LdotH;   // cos angle between light direction and half vector
      float VdotN;   // cos angle between view direction and normal vector
  };

  float dtrExponent = ${t.useCustomDTRExponentForWater?"2.2":"2.0"};
  `),e.code.add(i.H`vec3 fresnelReflection(float angle, vec3 f0, float f90) {
return f0 + (f90 - f0) * pow(1.0 - angle, 5.0);
}`),e.code.add(i.H`float normalDistributionWater(float NdotH, float roughness) {
float r2 = roughness * roughness;
float NdotH2 = NdotH * NdotH;
float denom = pow((NdotH2 * (r2 - 1.0) + 1.0), dtrExponent) * PI;
return r2 / denom;
}`),e.code.add(i.H`float geometricOcclusionKelemen(float LoH) {
return 0.25 / (LoH * LoH);
}`),e.code.add(i.H`vec3 brdfSpecularWater(in PBRShadingWater props, float roughness, vec3 F0, float F0Max) {
vec3  F = fresnelReflection(props.VdotH, F0, F0Max);
float dSun = normalDistributionWater(props.NdotH, roughness);
float V = geometricOcclusionKelemen(props.LdotH);
float diffusionSunHaze = mix(roughness + 0.045, roughness + 0.385, 1.0 - props.VdotH);
float strengthSunHaze  = 1.2;
float dSunHaze = normalDistributionWater(props.NdotH, diffusionSunHaze) * strengthSunHaze;
return ((dSun + dSunHaze) * V) * F;
}`)}},42510:function(e,t,n){n.d(t,{f7:function(){return i},jV:function(){return d}});var i,r=n(79786),s=n(80357),o=n(9535),a=n(48857),c=n(29193),u=n(34709),l=(n(18836),n(5998));n(74826);!function(e){e[e.Disabled=0]="Disabled",e[e.Normal=1]="Normal",e[e.Schematic=2]="Schematic",e[e.Water=3]="Water",e[e.WaterOnIntegratedMesh=4]="WaterOnIntegratedMesh",e[e.Simplified=5]="Simplified",e[e.TerrainWithWater=6]="TerrainWithWater",e[e.COUNT=7]="COUNT"}(i||(i={}));function d(e,t){const n=t.pbrMode,d=e.fragment;if(n!==i.Schematic&&n!==i.Disabled&&n!==i.Normal)return void d.code.add(a.H`void applyPBRFactors() {}`);if(n===i.Disabled)return void d.code.add(a.H`void applyPBRFactors() {}
float getBakedOcclusion() { return 1.0; }`);if(n===i.Schematic)return void d.code.add(a.H`vec3 mrr = vec3(0.0, 0.6, 0.2);
float occlusion = 1.0;
void applyPBRFactors() {}
float getBakedOcclusion() { return 1.0; }`);const{hasMetallicRoughnessTexture:h,hasMetallicRoughnessTextureTransform:f,hasOcclusionTexture:_,hasOcclusionTextureTransform:p,bindType:m}=t;(h||_)&&e.include(r.i,t),d.code.add(a.H`vec3 mrr;
float occlusion;`),h&&d.uniforms.add(m===l.P.Pass?new u.A("texMetallicRoughness",(e=>e.textureMetallicRoughness)):new c.R("texMetallicRoughness",(e=>e.textureMetallicRoughness))),_&&d.uniforms.add(m===l.P.Pass?new u.A("texOcclusion",(e=>e.textureOcclusion)):new c.R("texOcclusion",(e=>e.textureOcclusion))),d.uniforms.add(m===l.P.Pass?new o.J("mrrFactors",(e=>e.mrrFactors)):new s.B("mrrFactors",(e=>e.mrrFactors))),d.code.add(a.H`
    ${(0,a.If)(h,a.H`void applyMetallicRoughness(vec2 uv) {
            vec3 metallicRoughness = textureLookup(texMetallicRoughness, uv).rgb;
            mrr[0] *= metallicRoughness.b;
            mrr[1] *= metallicRoughness.g;
          }`)}

    ${(0,a.If)(_,"void applyOcclusion(vec2 uv) { occlusion *= textureLookup(texOcclusion, uv).r; }")}

    float getBakedOcclusion() {
      return ${_?"occlusion":"1.0"};
    }

    void applyPBRFactors() {
      mrr = mrrFactors;
      occlusion = 1.0;

      ${(0,a.If)(h,`applyMetallicRoughness(${f?"metallicRoughnessUV":"vuv0"});`)}
      ${(0,a.If)(_,`applyOcclusion(${p?"occlusionUV":"vuv0"});`)}
    }
  `)}},28262:function(e,t,n){function i(e){const t=.3183098861837907;e.constants.add("PI","float",3.141592653589793),e.constants.add("LIGHT_NORMALIZATION","float",t),e.constants.add("INV_PI","float",t),e.constants.add("HALF_PI","float",1.570796326794897),e.constants.add("TWO_PI","float",6.28318530717958)}n.d(t,{e:function(){return i}})},36553:function(e,t,n){n.d(t,{o:function(){return r},s:function(){return i}});const i=3e5,r=5e5},7086:function(e,t,n){n.d(t,{H:function(){return o}});var i=n(20638),r=n(48857),s=n(71063);function o(e,{occlusionPass:t,terrainDepthTest:n,cullAboveTerrain:o}){const{vertex:a,fragment:c,varyings:u}=e;if(!n)return a.code.add("void forwardViewPosDepth(vec3 pos) {}"),void c.code.add(`${t?"bool":"void"} discardByTerrainDepth() { ${(0,r.If)(t,"return false;")}}`);u.add("viewPosDepth","float",{invariant:!0}),a.code.add("void forwardViewPosDepth(vec3 pos) {\n    viewPosDepth = pos.z;\n  }"),c.include(i.K),c.uniforms.add(new s.e("terrainDepthTexture",(e=>e.terrainDepth?.attachment))).code.add(r.H`
    ${t?"bool":"void"} discardByTerrainDepth() {
      float depth = texelFetch(terrainDepthTexture, ivec2(gl_FragCoord.xy), 0).r;
      float linearDepth = linearizeDepth(depth);
      ${t?"return viewPosDepth < linearDepth && depth < 1.0;":`if(viewPosDepth ${o?">":"<="} linearDepth) discard;`}
    }`)}},88489:function(e,t,n){n.d(t,{k:function(){return d}});var i=n(9535),r=n(2013),s=n(69558),o=n(39163),a=n(48857),c=n(57798),u=n(52061),l=n(70218);function d(e,t){const{vertex:n,attributes:d}=e;t.hasVvInstancing&&(t.vvSize||t.vvColor)&&d.add(u.T.INSTANCEFEATUREATTRIBUTE,"vec4"),t.vvSize?(n.uniforms.add(new i.J("vvSizeMinSize",(e=>e.vvSize.minSize))),n.uniforms.add(new i.J("vvSizeMaxSize",(e=>e.vvSize.maxSize))),n.uniforms.add(new i.J("vvSizeOffset",(e=>e.vvSize.offset))),n.uniforms.add(new i.J("vvSizeFactor",(e=>e.vvSize.factor))),n.uniforms.add(new i.J("vvSizeFallback",(e=>e.vvSize.fallback))),n.uniforms.add(new c.c("vvSymbolRotationMatrix",(e=>e.vvSymbolRotationMatrix))),n.uniforms.add(new i.J("vvSymbolAnchor",(e=>e.vvSymbolAnchor))),n.code.add(a.H`vec3 vvScale(vec4 _featureAttribute) {
if (isnan(_featureAttribute.x)) {
return vvSizeFallback;
}
return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);
}
vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {
return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);
}`),n.code.add(a.H`
      const float eps = 1.192092896e-07;
      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {
        vec3 scale = max(vvScale(_featureAttribute), eps);
        return vec4(vvSymbolRotationMatrix * _normal / scale, 1.0);
      }

      ${t.hasVvInstancing?a.H`
      vec4 vvLocalNormal(vec3 _normal) {
        return vvTransformNormal(_normal, instanceFeatureAttribute);
      }

      vec4 localPosition() {
        return vvTransformPosition(position, instanceFeatureAttribute);
      }`:""}
    `)):n.code.add(a.H`vec4 localPosition() { return vec4(position, 1.0); }
vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }`),t.vvColor?(n.constants.add("vvColorNumber","int",l.x),n.uniforms.add(new o.O("vvColorValues",(e=>e.vvColor.values),l.x),new s.b("vvColorColors",(e=>e.vvColor.colors),l.x),new r.N("vvColorFallback",(e=>e.vvColor.fallback))),n.code.add(a.H`
      vec4 interpolateVVColor(float value) {
        if (isnan(value)) {
          return vvColorFallback;
        }

        if (value <= vvColorValues[0]) {
          return vvColorColors[0];
        }

        for (int i = 1; i < vvColorNumber; ++i) {
          if (vvColorValues[i] >= value) {
            float f = (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);
            return mix(vvColorColors[i-1], vvColorColors[i], f);
          }
        }
        return vvColorColors[vvColorNumber - 1];
      }

      vec4 vvGetColor(vec4 featureAttribute) {
        return interpolateVVColor(featureAttribute.y);
      }

      ${t.hasVvInstancing?a.H`
            vec4 vvColor() {
              return vvGetColor(instanceFeatureAttribute);
            }`:"vec4 vvColor() { return vec4(1.0); }"}
    `)):n.code.add(a.H`vec4 vvColor() { return vec4(1.0); }`)}},77983:function(e,t,n){n.d(t,{GZ:function(){return l}});var i=n(26821),r=n(41788),s=n(73749),o=n(27583),a=n(37124),c=n(23027),u=n(48857);function l(e){e.fragment.uniforms.add(new c.$("projInfo",(e=>function(e){const t=e.projectionMatrix;return 0===t[11]?(0,s.s)(d,2/(e.fullWidth*t[0]),2/(e.fullHeight*t[5]),(1+t[12])/t[0],(1+t[13])/t[5]):(0,s.s)(d,-2/(e.fullWidth*t[0]),-2/(e.fullHeight*t[5]),(1-t[8])/t[0],(1-t[9])/t[5])}(e.camera)))),e.fragment.uniforms.add(new a.$("zScale",(e=>function(e){return 0===e.projectionMatrix[11]?(0,i.t8)(h,0,1):(0,i.t8)(h,1,0)}(e.camera)))),e.fragment.code.add(u.H`vec3 reconstructPosition(vec2 fragCoord, float depth) {
return vec3((fragCoord * projInfo.xy + projInfo.zw) * (zScale.x * depth + zScale.y), depth);
}`)}const d=(0,o.Ue)();const h=(0,r.Ue)()},13743:function(e,t,n){n.d(t,{Y:function(){return r}});var i=n(48857);function r(e){e.code.add(i.H`vec4 premultiplyAlpha(vec4 v) {
return vec4(v.rgb * v.a, v.a);
}
vec3 rgb2hsv(vec3 c) {
vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);
vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);
float d = q.x - min(q.w, q.y);
float e = 1.0e-10;
return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);
}
vec3 hsv2rgb(vec3 c) {
vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}
float rgb2v(vec3 c) {
return max(c.x, max(c.y, c.z));
}`)}},96541:function(e,t,n){n.d(t,{Sv:function(){return f},ZI:function(){return E},_8:function(){return m},hY:function(){return h}});var i=n(31865),r=n(10934),s=n(24910),o=n(82846),a=n(87688),c=n(80357),u=n(13663),l=n(18489),d=n(10146);function h(e,t){t.instancedDoublePrecision?e.constants.add("cameraPosition","vec3",o.AG):e.uniforms.add(new c.B("cameraPosition",((e,t)=>(0,s.i)(p,t.camera.viewInverseTransposeMatrix[3]-e.origin[0],t.camera.viewInverseTransposeMatrix[7]-e.origin[1],t.camera.viewInverseTransposeMatrix[11]-e.origin[2]))))}function f(e,t){if(!t.instancedDoublePrecision)return void e.uniforms.add(new l.C("proj",(e=>e.camera.projectionMatrix)),new d.K("view",((e,t)=>(0,i.Iu)(_,t.camera.viewMatrix,e.origin))),new c.B("localOrigin",(e=>e.origin)));const n=({camera:e})=>(0,s.i)(p,e.viewInverseTransposeMatrix[3],e.viewInverseTransposeMatrix[7],e.viewInverseTransposeMatrix[11]);e.uniforms.add(new l.C("proj",(e=>e.camera.projectionMatrix)),new l.C("view",(e=>(0,i.Iu)(_,e.camera.viewMatrix,n(e)))),new a.d("localOrigin",(e=>n(e))))}const _=(0,r.Ue)(),p=(0,o.Ue)();function m(e){e.uniforms.add(new l.C("viewNormal",(e=>e.camera.viewInverseTransposeMatrix)))}function E(e){e.uniforms.add(new u.z("pixelRatio",(e=>e.camera.pixelRatio/e.overlayStretch)))}},79729:function(e,t,n){n.d(t,{U:function(){return s}});var i=n(5998),r=n(92217);class s extends r.x{constructor(e,t){super(e,"bool",i.P.Bind,((n,i)=>n.setUniform1b(e,t(i))))}}},37124:function(e,t,n){n.d(t,{$:function(){return s}});var i=n(5998),r=n(92217);class s extends r.x{constructor(e,t){super(e,"vec2",i.P.Bind,((n,i)=>n.setUniform2fv(e,t(i))))}}},19251:function(e,t,n){n.d(t,{q:function(){return s}});var i=n(5998),r=n(92217);class s extends r.x{constructor(e,t){super(e,"vec2",i.P.Draw,((n,i,r,s)=>n.setUniform2fv(e,t(i,r,s))))}}},19155:function(e,t,n){n.d(t,{A:function(){return s}});var i=n(5998),r=n(92217);class s extends r.x{constructor(e,t){super(e,"vec2",i.P.Pass,((n,i,r)=>n.setUniform2fv(e,t(i,r))))}}},87688:function(e,t,n){n.d(t,{d:function(){return s}});var i=n(5998),r=n(92217);class s extends r.x{constructor(e,t){super(e,"vec3",i.P.Bind,((n,i)=>n.setUniform3fv(e,t(i))))}}},23027:function(e,t,n){n.d(t,{$:function(){return s}});var i=n(5998),r=n(92217);class s extends r.x{constructor(e,t){super(e,"vec4",i.P.Bind,((n,i)=>n.setUniform4fv(e,t(i))))}}},2013:function(e,t,n){n.d(t,{N:function(){return s}});var i=n(5998),r=n(92217);class s extends r.x{constructor(e,t){super(e,"vec4",i.P.Pass,((n,i,r)=>n.setUniform4fv(e,t(i,r))))}}},69558:function(e,t,n){n.d(t,{b:function(){return s}});var i=n(5998),r=n(92217);class s extends r.x{constructor(e,t,n){super(e,"vec4",i.P.Pass,((n,i,r)=>n.setUniform4fv(e,t(i,r))),n)}}},30881:function(e,t,n){n.d(t,{p:function(){return s}});var i=n(5998),r=n(92217);class s extends r.x{constructor(e,t){super(e,"float",i.P.Draw,((n,i,r)=>n.setUniform1f(e,t(i,r))))}}},85119:function(e,t,n){n.d(t,{p:function(){return s}});var i=n(5998),r=n(92217);class s extends r.x{constructor(e,t){super(e,"float",i.P.Pass,((n,i,r)=>n.setUniform1f(e,t(i,r))))}}},39163:function(e,t,n){n.d(t,{O:function(){return s}});var i=n(5998),r=n(92217);class s extends r.x{constructor(e,t,n){super(e,"float",i.P.Pass,((n,i,r)=>n.setUniform1fv(e,t(i,r))),n)}}},63981:function(e,t,n){n.d(t,{Y:function(){return s}});var i=n(5998),r=n(92217);class s extends r.x{constructor(e,t){super(e,"int",i.P.Bind,((n,i)=>n.setUniform1i(e,t(i))))}}},20431:function(e,t,n){n.d(t,{_:function(){return s}});var i=n(5998),r=n(92217);class s extends r.x{constructor(e,t){super(e,"int",i.P.Pass,((n,i,r)=>n.setUniform1i(e,t(i,r))))}}},10146:function(e,t,n){n.d(t,{K:function(){return s}});var i=n(5998),r=n(92217);class s extends r.x{constructor(e,t){super(e,"mat4",i.P.Draw,((n,i,r)=>n.setUniformMatrix4fv(e,t(i,r))))}}},95334:function(e,t,n){n.d(t,{g:function(){return s}});var i=n(5998),r=n(92217);class s extends r.x{constructor(e,t){super(e,"mat4",i.P.Pass,((n,i,r)=>n.setUniformMatrix4fv(e,t(i,r))))}}},71063:function(e,t,n){n.d(t,{e:function(){return s}});var i=n(5998),r=n(92217);class s extends r.x{constructor(e,t){super(e,"sampler2D",i.P.Bind,((n,i)=>n.bindTexture(e,t(i))))}}},34709:function(e,t,n){n.d(t,{A:function(){return s}});var i=n(5998),r=n(92217);class s extends r.x{constructor(e,t){super(e,"sampler2D",i.P.Pass,((n,i,r)=>n.bindTexture(e,t(i,r))))}}},58257:function(e,t,n){n.d(t,{J:function(){return i}});class i{constructor(e,t){this._module=e,this._load=t}get(){return this._module}async reload(){return this._module=await this._load(),this._module}}},29107:function(e,t,n){n.d(t,{A:function(){return d},E:function(){return h}});var i=n(96711),r=n(61100),s=n(41044),o=n(75025),a=(n(61432),n(13e3));class c{constructor(e,t,n){this._context=e,this._locations=n,this._textures=new Map,this._glProgram=e.programCache.acquire(t.generate("vertex",!0),t.generate("fragment",!0),n),this._glProgram.stop=()=>{throw new Error("Wrapped _glProgram used directly")},this.bind=t.generateBind(this),this.bindPass=t.generateBindPass(this),this.bindDraw=t.generateBindDraw(this)}dispose(){this._glProgram.dispose()}get glName(){return this._glProgram.glName}get hasTransformFeedbackVaryings(){return this._glProgram.hasTransformFeedbackVaryings}get compiled(){return this._glProgram.compiled}setUniform1b(e,t){this._glProgram.setUniform1i(e,t?1:0)}setUniform1i(e,t){this._glProgram.setUniform1i(e,t)}setUniform1f(e,t){this._glProgram.setUniform1f(e,t)}setUniform2fv(e,t){this._glProgram.setUniform2fv(e,t)}setUniform3fv(e,t){this._glProgram.setUniform3fv(e,t)}setUniform4fv(e,t){this._glProgram.setUniform4fv(e,t)}setUniformMatrix3fv(e,t){this._glProgram.setUniformMatrix3fv(e,t)}setUniformMatrix4fv(e,t){this._glProgram.setUniformMatrix4fv(e,t)}setUniform1fv(e,t){this._glProgram.setUniform1fv(e,t)}setUniform1iv(e,t){this._glProgram.setUniform1iv(e,t)}setUniform2iv(e,t){this._glProgram.setUniform2iv(e,t)}setUniform3iv(e,t){this._glProgram.setUniform3iv(e,t)}setUniform4iv(e,t){this._glProgram.setUniform4iv(e,t)}assertCompatibleVertexAttributeLocations(e){e.locations!==this._locations&&console.error("VertexAttributeLocations are incompatible")}stop(){this._textures.clear()}bindTexture(e,t){t?.glName||((0,a.hZ)()&&console.error(`Texture sampler ${e} has no given Texture in ${(new Error).stack} `),t=this._context.emptyTexture);const n=this._ensureTextureUnit(e,t);this._context.useProgram(this),this.setUniform1i(e,n.unit),this._context.bindTexture(t,n.unit)}_ensureTextureUnit(e,t){let n=this._textures.get(e);return null==n?(n={texture:t,unit:this._textures.size},this._textures.set(e,n)):n.texture=t,n}}var u=n(65650),l=n(51135);class d{constructor(e,t,n,s=o.i){this.locations=s,this.primitiveType=u.MX.TRIANGLES,this.key=t.key,this._program=new c(e.rctx,n.get().build(t),s),this._pipeline=this.initializePipeline(t),this.reload=async o=>{o&&await n.reload(),this.key.equals(t.key)||i.Z.getLogger("esri.views.3d.webgl.ShaderTechnique").warn("Configuration was changed after construction, cannot reload shader.",n),(0,r.M2)(this._program),this._program=new c(e.rctx,n.get().build(t),s),this._pipeline=this.initializePipeline(t)}}destroy(){this._program=(0,r.M2)(this._program),this._pipeline=null}get program(){return this._program}get compiled(){return this.program.compiled}ensureAttributeLocations(e){this.program.assertCompatibleVertexAttributeLocations(e)}getPipeline(e,t){return this._pipeline}initializePipeline(e){return(0,l.sm)({blending:l.Zo,colorWrite:l.gf})}}function h(e,t){return(0,s.bB)(e)?{buffers:[u.Xg.NONE]}:t??null}},59770:function(e,t,n){n.d(t,{C:function(){return s}});var i=n(59384),r=n(57192);function s(e){if(e.length<i.c8)return Array.from(e);if(Array.isArray(e))return Float64Array.from(e);if(!("BYTES_PER_ELEMENT"in e))return Array.from(e);switch(e.BYTES_PER_ELEMENT){case 1:return Uint8Array.from(e);case 2:return(0,i.AP)(e)?(0,r.vz)().from(e):(0,i.Uc)(e)?Uint16Array.from(e):Int16Array.from(e);case 4:return Float32Array.from(e);default:return Float64Array.from(e)}}},77851:function(e,t,n){n.d(t,{fX:function(){return E},pk:function(){return T},$u:function(){return h},_h:function(){return f},rv:function(){return d}});var i=n(1800);let r;var s=n(85886),o=n(65650),a=n(8158),c=n(15483);let u=null,l=null;async function d(){return null==l&&(r??=(async()=>{const e=await n.e(31164).then(n.bind(n,31164)),t=await e.default({locateFile:e=>(0,i.V)(`esri/libs/basisu/${e}`)});return t.initializeBasis(),t})(),l=r,u=await l),l}function h(e,t){if(null==u)return e.byteLength;const n=new u.BasisFile(new Uint8Array(e)),i=p(n)?_(n.getNumLevels(0),n.getHasAlpha(),n.getImageWidth(0,0),n.getImageHeight(0,0),t):0;return n.close(),n.delete(),i}function f(e,t){if(null==u)return e.byteLength;const n=new u.KTX2File(new Uint8Array(e)),i=m(n)?_(n.getLevels(),n.getHasAlpha(),n.getWidth(),n.getHeight(),t):0;return n.close(),n.delete(),i}function _(e,t,n,i,r){const s=(0,c.RG)(t?o.q_.COMPRESSED_RGBA8_ETC2_EAC:o.q_.COMPRESSED_RGB8_ETC2),a=r&&e>1?(4**e-1)/(3*4**(e-1)):1;return Math.ceil(n*i*s*a)}function p(e){return e.getNumImages()>=1&&!e.isUASTC()}function m(e){return e.getFaces()>=1&&e.isETC1S()}async function E(e,t,n){null==u&&(u=await d());const i=new u.BasisFile(new Uint8Array(n));if(!p(i))return null;i.startTranscoding();const r=g(e,t,i.getNumLevels(0),i.getHasAlpha(),i.getImageWidth(0,0),i.getImageHeight(0,0),((e,t)=>i.getImageTranscodedSizeInBytes(0,e,t)),((e,t,n)=>i.transcodeImage(n,0,e,t,0,0)));return i.close(),i.delete(),r}async function T(e,t,n){null==u&&(u=await d());const i=new u.KTX2File(new Uint8Array(n));if(!m(i))return null;i.startTranscoding();const r=g(e,t,i.getLevels(),i.getHasAlpha(),i.getWidth(),i.getHeight(),((e,t)=>i.getImageTranscodedSizeInBytes(e,0,0,t)),((e,t,n)=>i.transcodeImage(n,e,0,0,t,0,-1,-1)));return i.close(),i.delete(),r}function g(e,t,n,i,r,c,u,l){const{compressedTextureETC:d,compressedTextureS3TC:h}=e.capabilities,[f,_]=d?i?[s.E.ETC2_RGBA,o.q_.COMPRESSED_RGBA8_ETC2_EAC]:[s.E.ETC1_RGB,o.q_.COMPRESSED_RGB8_ETC2]:h?i?[s.E.BC3_RGBA,o.q_.COMPRESSED_RGBA_S3TC_DXT5_EXT]:[s.E.BC1_RGB,o.q_.COMPRESSED_RGB_S3TC_DXT1_EXT]:[s.E.RGBA32,o.VI.RGBA],p=t.hasMipmap?n:Math.min(1,n),m=[];for(let e=0;e<p;e++)m.push(new Uint8Array(u(e,f))),l(e,f,m[e]);return t.internalFormat=_,t.hasMipmap=m.length>1,t.samplingMode=t.hasMipmap?o.cw.LINEAR_MIPMAP_LINEAR:o.cw.LINEAR,t.width=r,t.height=c,new a.x(e,t,{type:"compressed",levels:m})}},45953:function(e,t,n){n.d(t,{j:function(){return a}});var i=n(63974),r=n(24910),s=n(82846),o=n(61719);class a{constructor(e,t,n){this.primitiveIndices=e,this._numIndexPerPrimitive=t,this.position=n,this._children=void 0,(0,o.hu)(e.length>=1),(0,o.hu)(3===n.size||4===n.size);const{data:i,size:a,indices:u}=n;(0,o.hu)(u.length%this._numIndexPerPrimitive==0),(0,o.hu)(u.length>=e.length*this._numIndexPerPrimitive);const l=e.length;let d=a*u[this._numIndexPerPrimitive*e[0]];c.clear(),c.push(d);const h=(0,s.al)(i[d],i[d+1],i[d+2]),f=(0,s.d9)(h);for(let t=0;t<l;++t){const n=this._numIndexPerPrimitive*e[t];for(let e=0;e<this._numIndexPerPrimitive;++e){d=a*u[n+e],c.push(d);let t=i[d];h[0]=Math.min(t,h[0]),f[0]=Math.max(t,f[0]),t=i[d+1],h[1]=Math.min(t,h[1]),f[1]=Math.max(t,f[1]),t=i[d+2],h[2]=Math.min(t,h[2]),f[2]=Math.max(t,f[2])}}this.bbMin=h,this.bbMax=f;const _=(0,r.m)((0,s.Ue)(),this.bbMin,this.bbMax,.5);this.radius=.5*Math.max(Math.max(f[0]-h[0],f[1]-h[1]),f[2]-h[2]);let p=this.radius*this.radius;for(let e=0;e<c.length;++e){d=c.at(e);const t=i[d]-_[0],n=i[d+1]-_[1],r=i[d+2]-_[2],s=t*t+n*n+r*r;if(s<=p)continue;const o=Math.sqrt(s),a=.5*(o-this.radius);this.radius=this.radius+a,p=this.radius*this.radius;const u=a/o;_[0]+=t*u,_[1]+=n*u,_[2]+=r*u}this.center=_,c.clear()}getChildren(){if(this._children||(0,r.s)(this.bbMin,this.bbMax)<=1)return this._children;const e=(0,r.m)((0,s.Ue)(),this.bbMin,this.bbMax,.5),t=this.primitiveIndices.length,n=new Uint8Array(t),i=new Array(8);for(let e=0;e<8;++e)i[e]=0;const{data:o,size:c,indices:u}=this.position;for(let r=0;r<t;++r){let t=0;const s=this._numIndexPerPrimitive*this.primitiveIndices[r];let a=c*u[s],l=o[a],d=o[a+1],h=o[a+2];for(let e=1;e<this._numIndexPerPrimitive;++e){a=c*u[s+e];const t=o[a],n=o[a+1],i=o[a+2];t<l&&(l=t),n<d&&(d=n),i<h&&(h=i)}l<e[0]&&(t|=1),d<e[1]&&(t|=2),h<e[2]&&(t|=4),n[r]=t,++i[t]}let l=0;for(let e=0;e<8;++e)i[e]>0&&++l;if(l<2)return;const d=new Array(8);for(let e=0;e<8;++e)d[e]=i[e]>0?new Uint32Array(i[e]):void 0;for(let e=0;e<8;++e)i[e]=0;for(let e=0;e<t;++e){const t=n[e];d[t][i[t]++]=this.primitiveIndices[e]}this._children=new Array;for(let e=0;e<8;++e)void 0!==d[e]&&this._children.push(new a(d[e],this._numIndexPerPrimitive,this.position));return this._children}static prune(){c.prune()}}const c=new i.Z({deallocator:null})},59797:function(e,t,n){n.d(t,{Z:function(){return r}});var i=n(32420);class r{constructor(e){this._material=e.material,this._techniques=e.techniques,this._output=e.output}dispose(){}get _stippleTextures(){return this._techniques.context.stippleTextures}get _markerTextures(){return this._techniques.context.markerTextures}getTechnique(e,t){return this._techniques.get(e,this._material.getConfiguration(this._output,t))}ensureResources(e){return i.Rw.LOADED}}},40156:function(e,t,n){n.d(t,{EY:function(){return l},Fj:function(){return c}});var i=n(61100),r=n(93568),s=n(32420),o=n(59797),a=n(74826);class c extends o.Z{constructor(e){super(e),this._numLoading=0,this._disposed=!1,this._textures=e.textures,this.updateTexture(e.textureId),this._acquire(e.normalTextureId,(e=>this._textureNormal=e)),this._acquire(e.emissiveTextureId,(e=>this._textureEmissive=e)),this._acquire(e.occlusionTextureId,(e=>this._textureOcclusion=e)),this._acquire(e.metallicRoughnessTextureId,(e=>this._textureMetallicRoughness=e))}dispose(){super.dispose(),this._texture=(0,i.RY)(this._texture),this._textureNormal=(0,i.RY)(this._textureNormal),this._textureEmissive=(0,i.RY)(this._textureEmissive),this._textureOcclusion=(0,i.RY)(this._textureOcclusion),this._textureMetallicRoughness=(0,i.RY)(this._textureMetallicRoughness),this._disposed=!0}ensureResources(e){return 0===this._numLoading?s.Rw.LOADED:s.Rw.LOADING}get textureBindParameters(){return new l(this._texture?.glTexture??null,this._textureNormal?.glTexture??null,this._textureEmissive?.glTexture??null,this._textureOcclusion?.glTexture??null,this._textureMetallicRoughness?.glTexture??null)}updateTexture(e){null!=this._texture&&e===this._texture.id||(this._texture=(0,i.RY)(this._texture),this._acquire(e,(e=>this._texture=e)))}_acquire(e,t){if(null==e)return void t(null);const n=this._textures.acquire(e);if((0,r.y8)(n))return++this._numLoading,void n.then((e=>{if(this._disposed)return(0,i.RY)(e),void t(null);t(e)})).finally((()=>--this._numLoading));t(n)}}class u extends a.K{constructor(e=null){super(),this.textureEmissive=e}}class l extends u{constructor(e,t,n,i,r,s,o){super(n),this.texture=e,this.textureNormal=t,this.textureOcclusion=i,this.textureMetallicRoughness=r,this.scale=s,this.normalTextureTransformMatrix=o}}},25952:function(e,t,n){n.d(t,{Z:function(){return A}});var i=n(67908),r=n(10934),s=n(24910),o=n(38766),a=n(59770),c=n(45953),u=n(82846),l=n(79012);const d=(0,u.Ue)(),h=(0,u.Ue)(),f=(0,u.Ue)(),_=(0,u.Ue)();var p=n(52964),m=n(31097),E=n(61719),T=n(52061),g=n(13e3);class A{constructor(e,t,n=null,r=p.V.Mesh,s=null,a=-1){this.material=e,this.mapPositions=n,this.type=r,this.objectAndLayerIdColor=s,this.edgeIndicesLength=a,this.highlights=new Set,this._highlightOptionsCounts=new Map,this.id=(0,i.D)(),this.visible=!0,this._attributes=new Map,this._boundingInfo=null;for(const[e,n]of t)this._attributes.set(e,{...n,indices:(0,o.mi)(n.indices)}),e===T.T.POSITION&&(this.edgeIndicesLength=this.edgeIndicesLength<0?this._attributes.get(e).indices.length:this.edgeIndicesLength)}instantiate(e={}){const t=new A(e.material||this.material,[],this.mapPositions,this.type,this.objectAndLayerIdColor,this.edgeIndicesLength);return this._attributes.forEach(((e,n)=>{e.exclusive=!1,t._attributes.set(n,e)})),t._boundingInfo=this._boundingInfo,t.transformation=e.transformation||this.transformation,t}get attributes(){return this._attributes}getMutableAttribute(e){let t=this._attributes.get(e);return t&&!t.exclusive&&(t={...t,exclusive:!0,data:(0,a.C)(t.data)},this._attributes.set(e,t)),t}setAttributeData(e,t){const n=this._attributes.get(e);n?this._attributes.set(e,{...n,exclusive:!0,data:t}):(0,g.hZ)()&&console.warn(`Setting undefined attribute ${e} data`)}get indexCount(){const e=this._attributes.values().next().value?.indices;return e?.length??0}get faceCount(){return this.indexCount/3}get boundingInfo(){return this._boundingInfo??=this._calculateBoundingInfo(),this._boundingInfo}computeAttachmentOrigin(e){return!!(this.type===p.V.Mesh?this._computeAttachmentOriginTriangles(e):this.type===p.V.Line?this._computeAttachmentOriginLines(e):this._computeAttachmentOriginPoints(e))&&(null!=this._transformation&&(0,s.t)(e,e,this._transformation),!0)}_computeAttachmentOriginTriangles(e){return function(e,t){if(!e)return!1;const{size:n,data:i,indices:r}=e;(0,s.i)(t,0,0,0),(0,s.i)(_,0,0,0);let o=0,a=0;for(let e=0;e<r.length-2;e+=3){const c=r[e]*n,u=r[e+1]*n,p=r[e+2]*n;(0,s.i)(d,i[c],i[c+1],i[c+2]),(0,s.i)(h,i[u],i[u+1],i[u+2]),(0,s.i)(f,i[p],i[p+1],i[p+2]);const m=(0,l.bE)(d,h,f);m?((0,s.f)(d,d,h),(0,s.f)(d,d,f),(0,s.g)(d,d,1/3*m),(0,s.f)(t,t,d),o+=m):((0,s.f)(_,_,d),(0,s.f)(_,_,h),(0,s.f)(_,_,f),a+=3)}return!(0===a&&0===o||(0!==o?((0,s.g)(t,t,1/o),0):0===a||((0,s.g)(t,_,1/a),0)))}(this.attributes.get(T.T.POSITION),e)}_computeAttachmentOriginLines(e){const t=this.attributes.get(T.T.POSITION);return function(e,t,n){if(!e)return!1;(0,s.i)(n,0,0,0),(0,s.i)(_,0,0,0);let i=0,r=0;const{size:o,data:a,indices:c}=e,u=c.length-1,l=u+(t?2:0);for(let e=0;e<l;e+=2){const t=e<u?e+1:0,l=c[e<u?e:u]*o,f=c[t]*o;d[0]=a[l],d[1]=a[l+1],d[2]=a[l+2],h[0]=a[f],h[1]=a[f+1],h[2]=a[f+2],(0,s.g)(d,(0,s.f)(d,d,h),.5);const p=(0,s.F)(d,h);p>0?((0,s.f)(n,n,(0,s.g)(d,d,p)),i+=p):0===i&&((0,s.f)(_,_,d),r++)}return 0!==i?((0,s.g)(n,n,1/i),!0):0!==r&&((0,s.g)(n,_,1/r),!0)}(t,function(e,t){return!(!("isClosed"in e)||!e.isClosed)&&t.indices.length>2}(this.material.parameters,t),e)}_computeAttachmentOriginPoints(e){return function(e,t){if(!e)return!1;const{size:n,data:i,indices:r}=e;(0,s.i)(t,0,0,0);let o=-1,a=0;for(let e=0;e<r.length;e++){const s=r[e]*n;o!==s&&(t[0]+=i[s],t[1]+=i[s+1],t[2]+=i[s+2],a++),o=s}return a>1&&(0,s.g)(t,t,1/a),a>0}(this.attributes.get(T.T.POSITION),e)}invalidateBoundingInfo(){this._boundingInfo=null}_calculateBoundingInfo(){const e=this.attributes.get(T.T.POSITION);if(!e||0===e.indices.length)return null;const t=this.type===p.V.Mesh?3:1;(0,E.hu)(e.indices.length%t==0,"Indexing error: "+e.indices.length+" not divisible by "+t);const n=(0,o.KF)(e.indices.length/t);return new c.j(n,t,e)}get transformation(){return this._transformation??r.Wd}set transformation(e){this._transformation=e&&e!==r.Wd?(0,r.d9)(e):null}get highlightNames(){return this._highlightOptionsCounts}get hasHighlights(){return this._highlightOptionsCounts.size>0}foreachHighlightOptions(e){this._highlightOptionsCounts.forEach(((t,n)=>e(n)))}allocateIdAndHighlight(e){const t=new m.j(e);return this.addHighlight(t)}addHighlight(e){this.highlights.add(e);const{highlightName:t}=e,n=(this._highlightOptionsCounts.get(t)??0)+1;return this._highlightOptionsCounts.set(t,n),e}removeHighlight(e){if(this.highlights.delete(e)){const{highlightName:t}=e,n=this._highlightOptionsCounts.get(t)??0;n<=1?this._highlightOptionsCounts.delete(t):this._highlightOptionsCounts.set(t,n-1)}}}},52964:function(e,t,n){var i;n.d(t,{V:function(){return i}}),function(e){e[e.Mesh=0]="Mesh",e[e.Point=1]="Point",e[e.Line=2]="Line"}(i||(i={}))},31097:function(e,t,n){n.d(t,{Y:function(){return a},j:function(){return o}});var i=n(67908),r=n(32420);class s{constructor(){this.uid=(0,i.D)()}}class o extends s{constructor(e){super(),this.highlightName=e,this.channel=r.V_.Highlight}}class a extends s{constructor(){super(...arguments),this.channel=r.V_.MaskOccludee}}},61536:function(e,t,n){n.d(t,{Bh:function(){return _},E0:function(){return h},W$:function(){return l},Wo:function(){return u},eZ:function(){return f},j7:function(){return c},u_:function(){return p},ve:function(){return d}});var i=n(41044),r=n(33610),s=n(65650),o=n(51135);const a=(0,o.wK)(s.zi.ONE,s.zi.ZERO,s.zi.ONE,s.zi.ONE_MINUS_SRC_ALPHA);function c(e){return e===r.M.FrontFace?null:a}function u(e){switch(e){case r.M.NONE:return o.vf;case r.M.ColorAlpha:return a;case r.M.FrontFace:case r.M.COUNT:return null}}function l(e){if(e.draped)return null;switch(e.oitPass){case r.M.NONE:case r.M.FrontFace:return e.writeDepth?o.ck:null;case r.M.ColorAlpha:case r.M.COUNT:return null}}const d=5e5,h={factor:-1,units:-2};function f({oitPass:e,enableOffset:t}){return t&&e===r.M.ColorAlpha?h:null}function _(e,t=s.wb.LESS){return e===r.M.NONE||e===r.M.FrontFace?t:s.wb.LEQUAL}function p(e,t){const n=(0,i.qC)(t);return e===r.M.ColorAlpha?n?{buffers:[s.Ii,s.Ml,s.FF]}:{buffers:[s.Ii,s.Ml]}:n?{buffers:[s.Ii,s.Ml]}:null}},948:function(e,t,n){var i;n.d(t,{r:function(){return i}}),function(e){e[e.INTEGRATED_MESH=0]="INTEGRATED_MESH",e[e.OPAQUE_TERRAIN=1]="OPAQUE_TERRAIN",e[e.OPAQUE_MATERIAL=2]="OPAQUE_MATERIAL",e[e.OPAQUE_MATERIAL_WITHOUT_NORMALS=3]="OPAQUE_MATERIAL_WITHOUT_NORMALS",e[e.TRANSPARENT_MATERIAL=4]="TRANSPARENT_MATERIAL",e[e.TRANSPARENT_MATERIAL_WITHOUT_NORMALS=5]="TRANSPARENT_MATERIAL_WITHOUT_NORMALS",e[e.TRANSPARENT_TERRAIN=6]="TRANSPARENT_TERRAIN",e[e.TRANSPARENT_MATERIAL_WITHOUT_DEPTH=7]="TRANSPARENT_MATERIAL_WITHOUT_DEPTH",e[e.OCCLUDED_GROUND=8]="OCCLUDED_GROUND",e[e.OCCLUDER_MATERIAL=9]="OCCLUDER_MATERIAL",e[e.TRANSPARENT_OCCLUDER_MATERIAL=10]="TRANSPARENT_OCCLUDER_MATERIAL",e[e.OCCLUSION_PIXELS=11]="OCCLUSION_PIXELS",e[e.HUD_MATERIAL=12]="HUD_MATERIAL",e[e.LABEL_MATERIAL=13]="LABEL_MATERIAL",e[e.LINE_CALLOUTS=14]="LINE_CALLOUTS",e[e.LINE_CALLOUTS_HUD_DEPTH=15]="LINE_CALLOUTS_HUD_DEPTH",e[e.OVERLAY=16]="OVERLAY",e[e.DRAPED_MATERIAL=17]="DRAPED_MATERIAL",e[e.DRAPED_WATER=18]="DRAPED_WATER",e[e.VOXEL=19]="VOXEL",e[e.MAX_SLOTS=20]="MAX_SLOTS"}(i||(i={}))},26041:function(e,t,n){n.d(t,{JN:function(){return s},P7:function(){return c},RY:function(){return d},YD:function(){return _},eD:function(){return h},ec:function(){return l},iV:function(){return u},ii:function(){return f},s3:function(){return a},zV:function(){return o}});var i=n(32420),r=n(65650);const s={func:r.wb.LESS},o={func:r.wb.ALWAYS},a={mask:255},c={mask:0},u=e=>({function:{func:r.wb.NOTEQUAL,ref:e,mask:e},operation:{fail:r.xS.KEEP,zFail:r.xS.KEEP,zPass:r.xS.KEEP}}),l=e=>({function:{func:r.wb.ALWAYS,ref:e,mask:e},operation:{fail:r.xS.KEEP,zFail:r.xS.KEEP,zPass:r.xS.REPLACE}}),d={function:{func:r.wb.ALWAYS,ref:i.hU.OutlineVisualElementMask,mask:i.hU.OutlineVisualElementMask},operation:{fail:r.xS.KEEP,zFail:r.xS.KEEP,zPass:r.xS.ZERO}},h={function:{func:r.wb.ALWAYS,ref:i.hU.OutlineVisualElementMask,mask:i.hU.OutlineVisualElementMask},operation:{fail:r.xS.KEEP,zFail:r.xS.KEEP,zPass:r.xS.REPLACE}},f={function:{func:r.wb.EQUAL,ref:i.hU.OutlineVisualElementMask,mask:i.hU.OutlineVisualElementMask},operation:{fail:r.xS.KEEP,zFail:r.xS.KEEP,zPass:r.xS.KEEP}},_={function:{func:r.wb.NOTEQUAL,ref:i.hU.OutlineVisualElementMask,mask:i.hU.OutlineVisualElementMask},operation:{fail:r.xS.KEEP,zFail:r.xS.KEEP,zPass:r.xS.KEEP}}},28751:function(e,t,n){n.d(t,{x:function(){return M}});n(61432);var i=n(88194),r=n(87833),s=n(61100),o=n(93568),a=n(59384),c=n(67908),u=n(95490),l=n(91013),d=n(51880),h=n(52237),f=n(32420),_=n(77851),p=n(96711),m=n(65650),E=n(8158);const T=()=>p.Z.getLogger("esri.views.3d.webgl-engine.lib.DDSUtil");function g(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}const A=g("DXT1"),R=g("DXT3"),v=g("DXT5");function S(e,t){const n=new Int32Array(e.buffer,e.byteOffset,31);if(542327876!==n[0])return T().error("Invalid magic number in DDS header"),null;if(!(4&n[20]))return T().error("Unsupported format, must contain a FourCC code"),null;const i=n[21];let r,s;switch(i){case A:r=8,s=m.q_.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case R:r=16,s=m.q_.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case v:r=16,s=m.q_.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;default:return T().error("Unsupported FourCC code:",function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)}(i)),null}let o=1,a=n[4],c=n[3];(3&a||3&c)&&(T().warn("Rounding up compressed texture size to nearest multiple of 4."),a=a+3&-4,c=c+3&-4);const u=a,l=c;let d,h;131072&n[2]&&!1!==t&&(o=Math.max(1,n[7]));let f=e.byteOffset+n[1]+4;const _=[];for(let t=0;t<o;++t)h=(a+3>>2)*(c+3>>2)*r,d=new Uint8Array(e.buffer,f,h),_.push(d),f+=h,a=Math.max(1,a>>1),c=Math.max(1,c>>1);return{textureData:{type:"compressed",levels:_},internalFormat:s,width:u,height:l}}var I=n(51440),N=n(61719),P=n(35928);class M{constructor(e,t){this._data=e,this.id=(0,c.D)(),this.events=new r.Z,this._parameters={...O,...t},this._startPreload(e)}dispose(){this.unload(),this._data=this.update=void 0}_startPreload(e){e instanceof HTMLVideoElement?(this.update=t=>this._update(e,t),this._startPreloadVideoElement(e)):e instanceof HTMLImageElement&&this._startPreloadImageElement(e)}_startPreloadVideoElement(e){if(!((0,u.jc)(e.src)||"auto"===e.preload&&e.crossOrigin)&&(e.preload="auto",e.crossOrigin="anonymous",e.src=e.src,e.paused&&e.autoplay)){const t=[];(0,l.j)(e,(e=>t.push(e))).then((()=>{e.play()})).finally((()=>t.forEach((e=>e.remove()))))}}_startPreloadImageElement(e){(0,u.HK)(e.src)||(0,u.jc)(e.src)||e.crossOrigin||(e.crossOrigin="anonymous",e.src=e.src)}_createDescriptor(e){const t=new P.X;return t.wrapMode=this._parameters.wrap??m.e8.REPEAT,t.flipped=!this._parameters.noUnpackFlip,t.samplingMode=this._parameters.mipmap?m.cw.LINEAR_MIPMAP_LINEAR:m.cw.LINEAR,t.hasMipmap=!!this._parameters.mipmap,t.preMultiplyAlpha=!!this._parameters.preMultiplyAlpha,t.maxAnisotropy=this._parameters.maxAnisotropy??(this._parameters.mipmap?e.parameters.maxMaxAnisotropy:1),t}get glTexture(){return this._glTexture??this._emptyTexture}get loaded(){return null!=this._glTexture}get usedMemory(){return this._glTexture?.usedMemory||function(e,t){if(null==e)return 0;if((0,a.eP)(e)||(0,a.lq)(e))return t.encoding===f.Ti.KTX2_ENCODING?(0,_._h)(e,!!t.mipmap):t.encoding===f.Ti.BASIS_ENCODING?(0,_.$u)(e,!!t.mipmap):e.byteLength;const{width:n,height:i}=e instanceof Image||e instanceof ImageData||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement?C(e):t;return(t.mipmap?4/3:1)*n*i*(t.components||4)||0}(this._data,this._parameters)}load(e){if(this._loadingPromise)return this._loadingPromise;if(this._glTexture)return this._glTexture;const t=this._data;return null==t?(this._glTexture=new E.x(e,this._createDescriptor(e),null),this._glTexture):(this._emptyTexture=e.emptyTexture,this._parameters.reloadable||(this._data=void 0),"string"==typeof t?this._loadFromURL(e,t):t instanceof Image?this._loadFromImageElement(e,t):t instanceof HTMLVideoElement?this._loadFromVideoElement(e,t):t instanceof ImageData||t instanceof HTMLCanvasElement?this._loadFromImage(e,t):(0,a.lq)(t)&&this._parameters.encoding===f.Ti.DDS_ENCODING?this._loadFromDDSData(e,t):(0,a.eP)(t)&&this._parameters.encoding===f.Ti.DDS_ENCODING?this._loadFromDDSData(e,new Uint8Array(t)):((0,a.eP)(t)||(0,a.lq)(t))&&this._parameters.encoding===f.Ti.KTX2_ENCODING?this._loadFromKTX2(e,t):((0,a.eP)(t)||(0,a.lq)(t))&&this._parameters.encoding===f.Ti.BASIS_ENCODING?this._loadFromBasis(e,t):(0,a.lq)(t)?this._loadFromPixelData(e,t):(0,a.eP)(t)?this._loadFromPixelData(e,new Uint8Array(t)):null)}_update(e,t){return null==this._glTexture||e.readyState<HTMLMediaElement.HAVE_CURRENT_DATA||t===e.currentTime?t:(this._glTexture.setData(e),this._glTexture.descriptor.hasMipmap&&this._glTexture.generateMipmap(),this._parameters.updateCallback&&this._parameters.updateCallback(),e.currentTime)}_loadFromDDSData(e,t){return this._glTexture=function(e,t,n){const i=S(n,t.hasMipmap??!1);if(null==i)throw new Error("DDS texture data is null");const{textureData:r,internalFormat:s,width:o,height:a}=i;return t.samplingMode=r.levels.length>1?m.cw.LINEAR_MIPMAP_LINEAR:m.cw.LINEAR,t.hasMipmap=r.levels.length>1,t.internalFormat=s,t.width=o,t.height=a,new E.x(e,t,r)}(e,this._createDescriptor(e),t),this._emptyTexture=null,this._glTexture}_loadFromKTX2(e,t){return this._loadAsync((()=>(0,_.pk)(e,this._createDescriptor(e),t).then((e=>(this._glTexture=e,e)))))}_loadFromBasis(e,t){return this._loadAsync((()=>(0,_.fX)(e,this._createDescriptor(e),t).then((e=>(this._glTexture=e,e)))))}_loadFromPixelData(e,t){(0,N.hu)(this._parameters.width>0&&this._parameters.height>0);const n=this._createDescriptor(e);return n.pixelFormat=1===this._parameters.components?m.VI.LUMINANCE:3===this._parameters.components?m.VI.RGB:m.VI.RGBA,n.pixelFormat!==m.VI.RGB&&n.pixelFormat!==m.VI.RGBA||(n.compress=this._parameters.compressionOptions),n.width=this._parameters.width??0,n.height=this._parameters.height??0,this._glTexture=new E.x(e,n,t),this._glTexture}_loadFromURL(e,t){return this._loadAsync((async n=>{const i=await(0,d.t)(t,{signal:n});return(0,o.k_)(n),this._loadFromImage(e,i)}))}_loadFromImageElement(e,t){return t.complete?this._loadFromImage(e,t):this._loadAsync((async n=>{const i=await(0,h.fY)(t,t.src,!1,n);return(0,o.k_)(n),this._loadFromImage(e,i)}))}_loadFromVideoElement(e,t){return t.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA?this._loadFromImage(e,t):this._loadFromVideoElementAsync(e,t)}_loadFromVideoElementAsync(e,t){return this._loadAsync((n=>new Promise(((r,a)=>{const c=()=>{t.removeEventListener("loadeddata",u),t.removeEventListener("error",l),(0,s.hw)(d)},u=()=>{t.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA&&(c(),r(this._loadFromImage(e,t)))},l=e=>{c(),a(e||new i.Z("texture:load-error","Failed to load video"))};t.addEventListener("loadeddata",u),t.addEventListener("error",l);const d=(0,o.fu)(n,(()=>l((0,o.zE)())))}))))}_loadFromImage(e,t){let n=t;n instanceof HTMLVideoElement||(n=(0,I.qB)(n,e.parameters));const i=C(n);this._parameters.width=i.width,this._parameters.height=i.height;const r=this._createDescriptor(e);return r.pixelFormat=3===this._parameters.components?m.VI.RGB:m.VI.RGBA,r.width=i.width,r.height=i.height,r.compress=this._parameters.compressionOptions,this._glTexture=new E.x(e,r,n),this._emptyTexture=null,this.events.emit("loaded"),this._glTexture}_loadAsync(e){const t=new AbortController;this._loadingController=t;const n=e(t.signal);this._loadingPromise=n;const i=()=>{this._loadingController===t&&(this._loadingController=null),this._loadingPromise===n&&(this._loadingPromise=null),this._emptyTexture=null};return n.then(i,i),n}unload(){if(this._glTexture=(0,s.M2)(this._glTexture),this._emptyTexture=null,null!=this._loadingController){const e=this._loadingController;this._loadingController=null,this._loadingPromise=null,e.abort()}this.events.emit("unloaded")}get parameters(){return this._parameters}}function C(e){return e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e}const O={wrap:{s:m.e8.REPEAT,t:m.e8.REPEAT},mipmap:!0,noUnpackFlip:!1,preMultiplyAlpha:!1}},32420:function(e,t,n){var i,r,s,o,a,c,u,l;n.d(t,{Gv:function(){return r},JJ:function(){return u},Rw:function(){return o},Ti:function(){return l},V_:function(){return c},Vr:function(){return i},Xx:function(){return s},hU:function(){return a}}),function(e){e[e.None=0]="None",e[e.Front=1]="Front",e[e.Back=2]="Back",e[e.COUNT=3]="COUNT"}(i||(i={})),function(e){e[e.Less=0]="Less",e[e.Lequal=1]="Lequal",e[e.COUNT=2]="COUNT"}(r||(r={})),function(e){e[e.BACKGROUND=0]="BACKGROUND",e[e.UPDATE=1]="UPDATE"}(s||(s={})),function(e){e[e.NOT_LOADED=0]="NOT_LOADED",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED"}(o||(o={})),function(e){e[e.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded",e[e.OutlineVisualElementMask=2]="OutlineVisualElementMask"}(a||(a={})),function(e){e[e.Highlight=0]="Highlight",e[e.MaskOccludee=1]="MaskOccludee"}(c||(c={})),function(e){e[e.Blend=0]="Blend",e[e.Opaque=1]="Opaque",e[e.Mask=2]="Mask",e[e.MaskBlend=3]="MaskBlend",e[e.COUNT=4]="COUNT"}(u||(u={})),function(e){e.DDS_ENCODING="image/vnd-ms.dds",e.KTX2_ENCODING="image/ktx2",e.BASIS_ENCODING="image/x.basis"}(l||(l={}))},51440:function(e,t,n){n.d(t,{gu:function(){return o},nq:function(){return s},qB:function(){return a},tI:function(){return c}});var i=n(88194);const r=16;function s(e,t){return t=Math.floor(t/r)*r,Math.min(Math.round(e/r)*r,t)}function o(e,t){return t=Math.floor(t/r)*r,Math.min(Math.ceil(e/r)*r,t)}function a(e,t){const[n,i]=c(e,t);return e.width===n&&e.height===i?e:u(e,n,i)}function c({width:e,height:t},{maxPreferredTexturePixels:n,maxTextureSize:i}){const r=Math.max(e,t),o=e*t;if(r<=i&&o<=n)return[e,t];const a=Math.min(Math.sqrt(n/o),i/r);return[s(Math.round(e*a),i),s(Math.round(t*a),i)]}function u(e,t,n){if(e instanceof ImageData)return u(function(e){const t=document.createElement("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");if(null==n)throw new i.Z("texture:context-failed","Failed to create 2d context from HTMLCanvasElement");return n.putImageData(e,0,0),t}(e),t,n);const r=document.createElement("canvas");return r.width=t,r.height=n,r.getContext("2d").drawImage(e,0,0,r.width,r.height),r}},8562:function(e,t,n){n.d(t,{AM:function(){return s},Eg:function(){return o},Mi:function(){return r},Ur:function(){return a}});var i=n(82846);class r{constructor(e=(0,i.ll)()){this.intensity=e}}class s{constructor(e=(0,i.ll)(),t=(0,i.al)(.57735,.57735,.57735)){this.intensity=e,this.direction=t}}class o{constructor(e=(0,i.ll)(),t=(0,i.al)(.57735,.57735,.57735),n=!0,r=1,s=1){this.intensity=e,this.direction=t,this.castShadows=n,this.specularStrength=r,this.environmentStrength=s}}class a{constructor(){this.r=[0],this.g=[0],this.b=[0]}}},78142:function(e,t,n){n.d(t,{cI:function(){return N},Vt:function(){return I}});var i=n(99574),r=n(24910),s=n(82846),o=n(8562);function a(e,t,n){(n=n||e).length=e.length;for(let i=0;i<e.length;i++)n[i]=e[i]*t[i];return n}function c(e,t,n){(n=n||e).length=e.length;for(let i=0;i<e.length;i++)n[i]=e[i]*t;return n}function u(e,t,n){(n=n||e).length=e.length;for(let i=0;i<e.length;i++)n[i]=e[i]+t[i];return n}function l(e){return(e+1)*(e+1)}function d(e,t,n){const i=e[0],r=e[1],s=e[2],o=n||[];return o.length=l(t),t>=0&&(o[0]=.28209479177),t>=1&&(o[1]=.4886025119*i,o[2]=.4886025119*s,o[3]=.4886025119*r),t>=2&&(o[4]=1.09254843059*i*r,o[5]=1.09254843059*r*s,o[6]=.31539156525*(3*s*s-1),o[7]=1.09254843059*i*s,o[8]=.54627421529*(i*i-r*r)),o}function h(e,t){const n=l(e),i=t||{r:[],g:[],b:[]};i.r.length=i.g.length=i.b.length=n;for(let e=0;e<n;e++)i.r[e]=i.g[e]=i.b[e]=0;return i}function f(e,t){const n=function(e){return(0,i.uZ)(Math.floor(Math.sqrt(e)-1),0,2)}(t.r.length);for(const i of e)(0,r.u)(A,i.direction),d(A,n,T),a(T,R),c(T,i.intensity[0],g),u(t.r,g),c(T,i.intensity[1],g),u(t.g,g),c(T,i.intensity[2],g),u(t.b,g);return t}function _(e,t){d(A,0,T);for(const n of e)t.r[0]+=T[0]*R[0]*n.intensity[0]*4*Math.PI,t.g[0]+=T[0]*R[0]*n.intensity[1]*4*Math.PI,t.b[0]+=T[0]*R[0]*n.intensity[2]*4*Math.PI;return t}const p=[],m=[],E=[],T=[0],g=[0],A=(0,s.Ue)(),R=[3.141593,2.094395,2.094395,2.094395,.785398,.785398,.785398,.785398,.785398];class v{constructor(){this.color=(0,s.Ue)(),this.intensity=1}}class S{constructor(){this.direction=(0,s.Ue)(),this.ambient=new v,this.diffuse=new v}}const I=.4;class N{constructor(){this._shOrder=2,this._legacy=new S,this.globalFactor=.5,this.noonFactor=.5,this._sphericalHarmonics=new o.Ur,this._mainLight=new o.Eg((0,s.Ue)(),(0,s.al)(1,0,0),!1)}get legacy(){return this._legacy}get sh(){return this._sphericalHarmonics}get mainLight(){return this._mainLight}set(e){(function(e,t,n,i){h(t,i),(0,r.i)(n.intensity,0,0,0);let s=!1;const a=p,c=m,l=E;a.length=0,c.length=0,l.length=0;for(const t of e)t instanceof o.Eg&&!s?((0,r.c)(n.direction,t.direction),(0,r.c)(n.intensity,t.intensity),n.specularStrength=t.specularStrength,n.environmentStrength=t.environmentStrength,n.castShadows=t.castShadows,s=!0):t instanceof o.Eg||t instanceof o.AM?a.push(t):t instanceof o.Mi?c.push(t):t instanceof o.Ur&&l.push(t);f(a,i),_(c,i);for(const e of l)u(i.r,e.r),u(i.g,e.g),u(i.b,e.b)})(e,this._shOrder,this._mainLight,this._sphericalHarmonics),(0,r.c)(this._legacy.direction,this._mainLight.direction);const t=1/Math.PI;this._legacy.ambient.color[0]=.282095*this._sphericalHarmonics.r[0]*t,this._legacy.ambient.color[1]=.282095*this._sphericalHarmonics.g[0]*t,this._legacy.ambient.color[2]=.282095*this._sphericalHarmonics.b[0]*t,(0,r.g)(this._legacy.diffuse.color,this._mainLight.intensity,t),(0,r.c)(P,this._legacy.diffuse.color),(0,r.g)(P,P,I*this.globalFactor),(0,r.f)(this._legacy.ambient.color,this._legacy.ambient.color,P)}copyFrom(e){this._sphericalHarmonics.r=Array.from(e.sh.r),this._sphericalHarmonics.g=Array.from(e.sh.g),this._sphericalHarmonics.b=Array.from(e.sh.b),(0,r.c)(this._mainLight.direction,e.mainLight.direction),(0,r.c)(this._mainLight.intensity,e.mainLight.intensity),this._mainLight.castShadows=e.mainLight.castShadows,this._mainLight.specularStrength=e.mainLight.specularStrength,this._mainLight.environmentStrength=e.mainLight.environmentStrength,this.globalFactor=e.globalFactor,this.noonFactor=e.noonFactor}lerpLighting(e,t,n){if((0,r.m)(this._mainLight.intensity,e.mainLight.intensity,t.mainLight.intensity,n),this._mainLight.environmentStrength=(0,i.t7)(e.mainLight.environmentStrength,t.mainLight.environmentStrength,n),this._mainLight.specularStrength=(0,i.t7)(e.mainLight.specularStrength,t.mainLight.specularStrength,n),(0,r.c)(this._mainLight.direction,t.mainLight.direction),this._mainLight.castShadows=t.mainLight.castShadows,this.globalFactor=(0,i.t7)(e.globalFactor,t.globalFactor,n),this.noonFactor=(0,i.t7)(e.noonFactor,t.noonFactor,n),e.sh.r.length===t.sh.r.length)for(let r=0;r<t.sh.r.length;r++)this._sphericalHarmonics.r[r]=(0,i.t7)(e.sh.r[r],t.sh.r[r],n),this._sphericalHarmonics.g[r]=(0,i.t7)(e.sh.g[r],t.sh.g[r],n),this._sphericalHarmonics.b[r]=(0,i.t7)(e.sh.b[r],t.sh.b[r],n);else for(let e=0;e<t.sh.r.length;e++)this._sphericalHarmonics.r[e]=t.sh.r[e],this._sphericalHarmonics.g[e]=t.sh.g[e],this._sphericalHarmonics.b[e]=t.sh.b[e]}}const P=(0,s.Ue)()},70218:function(e,t,n){n.d(t,{n:function(){return s},x:function(){return o}});var i=n(76e3),r=n(19596);class s extends i.Ve{constructor(){super(...arguments),this.renderOccluded=r.yD.Occlude,this.isDecoration=!1}}const o=8},92991:function(e,t,n){n.d(t,{DO:function(){return E},NK:function(){return A},SW:function(){return h},Vq:function(){return g},Vs:function(){return m},WA:function(){return l},XW:function(){return u},h:function(){return f},ho:function(){return _},i9:function(){return R},s5:function(){return p}});var i=n(24910),r=n(82846),s=n(31865),o=n(81342),a=n(61719),c=n(52061);function u(e,t,n,i=1){const{data:r,indices:s}=e,o=t.typedBuffer,a=t.typedBufferStride,c=s.length;if(n*=a,1===i)for(let e=0;e<c;++e)o[n]=r[s[e]],n+=a;else for(let e=0;e<c;++e){const t=r[s[e]];for(let e=0;e<i;e++)o[n]=t,n+=a}}function l(e,t,n){const{data:i,indices:r}=e,s=t.typedBuffer,o=t.typedBufferStride,a=r.length;n*=o;for(let e=0;e<a;++e){const t=2*r[e];s[n]=i[t],s[n+1]=i[t+1],n+=o}}function d(e,t,n,i=1){const{data:r,indices:s}=e,o=t.typedBuffer,a=t.typedBufferStride,c=s.length;if(n*=a,1===i)for(let e=0;e<c;++e){const t=3*s[e];o[n]=r[t],o[n+1]=r[t+1],o[n+2]=r[t+2],n+=a}else for(let e=0;e<c;++e){const t=3*s[e];for(let e=0;e<i;++e)o[n]=r[t],o[n+1]=r[t+1],o[n+2]=r[t+2],n+=a}}function h(e,t,n,i=1){const{data:r,indices:s}=e,o=t.typedBuffer,a=t.typedBufferStride,c=s.length;if(n*=a,1===i)for(let e=0;e<c;++e){const t=4*s[e];o[n]=r[t],o[n+1]=r[t+1],o[n+2]=r[t+2],o[n+3]=r[t+3],n+=a}else for(let e=0;e<c;++e){const t=4*s[e];for(let e=0;e<i;++e)o[n]=r[t],o[n+1]=r[t+1],o[n+2]=r[t+2],o[n+3]=r[t+3],n+=a}}function f(e,t,n){const i=e.typedBuffer,r=e.typedBufferStride;t*=r;for(let e=0;e<n;++e)i[t]=0,i[t+1]=0,i[t+2]=0,i[t+3]=0,t+=r}function _(e,t,n,i,r=1){if(!t)return void d(e,n,i,r);const{data:o,indices:a}=e,c=n.typedBuffer,u=n.typedBufferStride,l=a.length,h=t[0],f=t[1],_=t[2],p=t[4],m=t[5],E=t[6],T=t[8],g=t[9],A=t[10],R=t[12],v=t[13],S=t[14];i*=u;let I=0,N=0,P=0;const M=(0,s.lv)(t)?e=>{I=o[e]+R,N=o[e+1]+v,P=o[e+2]+S}:e=>{const t=o[e],n=o[e+1],i=o[e+2];I=h*t+p*n+T*i+R,N=f*t+m*n+g*i+v,P=_*t+E*n+A*i+S};if(1===r)for(let e=0;e<l;++e)M(3*a[e]),c[i]=I,c[i+1]=N,c[i+2]=P,i+=u;else for(let e=0;e<l;++e){M(3*a[e]);for(let e=0;e<r;++e)c[i]=I,c[i+1]=N,c[i+2]=P,i+=u}}function p(e,t,n,i,r=1){if(!t)return void d(e,n,i,r);const{data:o,indices:a}=e,c=t,u=n.typedBuffer,l=n.typedBufferStride,h=a.length,f=c[0],_=c[1],p=c[2],m=c[4],E=c[5],T=c[6],g=c[8],A=c[9],R=c[10],v=!(0,s.pV)(c),S=1e-6,I=1-S;i*=l;let N=0,P=0,M=0;const C=(0,s.lv)(c)?e=>{N=o[e],P=o[e+1],M=o[e+2]}:e=>{const t=o[e],n=o[e+1],i=o[e+2];N=f*t+m*n+g*i,P=_*t+E*n+A*i,M=p*t+T*n+R*i};if(1===r)if(v)for(let e=0;e<h;++e){C(3*a[e]);const t=N*N+P*P+M*M;if(t<I&&t>S){const e=1/Math.sqrt(t);u[i]=N*e,u[i+1]=P*e,u[i+2]=M*e}else u[i]=N,u[i+1]=P,u[i+2]=M;i+=l}else for(let e=0;e<h;++e)C(3*a[e]),u[i]=N,u[i+1]=P,u[i+2]=M,i+=l;else for(let e=0;e<h;++e){if(C(3*a[e]),v){const e=N*N+P*P+M*M;if(e<I&&e>S){const t=1/Math.sqrt(e);N*=t,P*=t,M*=t}}for(let e=0;e<r;++e)u[i]=N,u[i+1]=P,u[i+2]=M,i+=l}}function m(e,t,n,i,r=1){const{data:s,indices:o}=e,a=n.typedBuffer,c=n.typedBufferStride,u=o.length;if(i*=c,t!==s.length||4!==t)if(1!==r)if(4!==t)for(let e=0;e<u;++e){const t=3*o[e];for(let e=0;e<r;++e)a[i]=s[t],a[i+1]=s[t+1],a[i+2]=s[t+2],a[i+3]=255,i+=c}else for(let e=0;e<u;++e){const t=4*o[e];for(let e=0;e<r;++e)a[i]=s[t],a[i+1]=s[t+1],a[i+2]=s[t+2],a[i+3]=s[t+3],i+=c}else{if(4===t){for(let e=0;e<u;++e){const t=4*o[e];a[i]=s[t],a[i+1]=s[t+1],a[i+2]=s[t+2],a[i+3]=s[t+3],i+=c}return}for(let e=0;e<u;++e){const t=3*o[e];a[i]=s[t],a[i+1]=s[t+1],a[i+2]=s[t+2],a[i+3]=255,i+=c}}else{a[i]=s[0],a[i+1]=s[1],a[i+2]=s[2],a[i+3]=s[3];const e=new Uint32Array(n.typedBuffer.buffer,n.start),t=c/4,o=e[i/=4];i+=t;const l=u*r;for(let n=1;n<l;++n)e[i]=o,i+=t}}function E(e,t,n,r){(0,i.d)(T,e,t);const s=Math.max(Math.sqrt((0,i.l)(T)),1e-4);(0,i.g)(T,T,1/s),n[r++]=T[0],n[r++]=T[1],n[r++]=T[2],n[r++]=s}const T=(0,r.Ue)();function g(e,t,n,i,r=1){const s=t.typedBuffer,o=t.typedBufferStride;if(i*=o,1===r)for(let t=0;t<n;++t)s[i]=e[0],s[i+1]=e[1],s[i+2]=e[2],s[i+3]=e[3],i+=o;else for(let t=0;t<n;++t)for(let t=0;t<r;++t)s[i]=e[0],s[i+1]=e[1],s[i+2]=e[2],s[i+3]=e[3],i+=o}function A(e,t,n,i,r,s,a){let u={numItems:0,numVerticesPerItem:0};for(const l of n.fields.keys()){const n=e.get(l),d=n?.indices;if(n&&d)l===c.T.POSITION&&(u={numItems:1,numVerticesPerItem:d.length}),R(l,n,i,r,s,a);else if(l===c.T.OLIDCOLOR&&null!=t){const n=e.get(c.T.POSITION)?.indices;if(n){const e=n.length;g(t,s.getField(l,o.mc),e,a)}}}return u}function R(e,t,n,i,r,u){switch(e){case c.T.POSITION:{(0,a.hu)(3===t.size);const i=r.getField(e,o.ct);(0,a.hu)(!!i,`No buffer view for ${e}`),_(t,n,i,u);break}case c.T.NORMAL:{(0,a.hu)(3===t.size);const n=r.getField(e,o.ct);(0,a.hu)(!!n,`No buffer view for ${e}`),p(t,i,n,u);break}case c.T.NORMALCOMPRESSED:case c.T.PROFILERIGHT:case c.T.PROFILEUP:{(0,a.hu)(2===t.size);const n=r.getField(e,o.or);(0,a.hu)(!!n,`No buffer view for ${e}`),l(t,n,u);break}case c.T.UV0:{(0,a.hu)(2===t.size);const n=r.getField(e,o.hg)??r.getField(e,o.Eu);(0,a.hu)(!!n,`No buffer view for ${e}`),l(t,n,u);break}case c.T.UVI:{(0,a.hu)(2===t.size);const n=r.getField(e,o.or);(0,a.hu)(!!n,`No buffer view for ${e}`),l(t,n,u);break}case c.T.COLOR:case c.T.SYMBOLCOLOR:{const n=r.getField(e,o.mc);(0,a.hu)(!!n,`No buffer view for ${e}`),(0,a.hu)(3===t.size||4===t.size),m(t,t.size,n,u);break}case c.T.COLORFEATUREATTRIBUTE:case c.T.OPACITYFEATUREATTRIBUTE:case c.T.SIZEFEATUREATTRIBUTE:{const n=r.getField(e,o.ly)??r.getField(e,o.ly);(0,a.hu)(!!n,`No buffer view for ${e}`),(0,a.hu)(1===t.size),function(e,t,n){const{data:i,indices:r}=e,s=t.typedBuffer,o=t.typedBufferStride,a=r.length,c=i[0];n*=o;for(let e=0;e<a;++e)s[n]=c,n+=o}(t,n,u);break}case c.T.TANGENT:{(0,a.hu)(4===t.size);const i=r.getField(e,o.ek);(0,a.hu)(!!i,`No buffer view for ${e}`),function(e,t,n,i,r=1){if(!t)return void h(e,n,i,r);const{data:o,indices:a}=e,c=t,u=n.typedBuffer,l=n.typedBufferStride,d=a.length,f=c[0],_=c[1],p=c[2],m=c[4],E=c[5],T=c[6],g=c[8],A=c[9],R=c[10],v=!(0,s.pV)(c),S=1e-6,I=1-S;if(i*=l,1===r)for(let e=0;e<d;++e){const t=4*a[e],n=o[t],r=o[t+1],s=o[t+2],c=o[t+3];let d=f*n+m*r+g*s,h=_*n+E*r+A*s,N=p*n+T*r+R*s;if(v){const e=d*d+h*h+N*N;if(e<I&&e>S){const t=1/Math.sqrt(e);d*=t,h*=t,N*=t}}u[i]=d,u[i+1]=h,u[i+2]=N,u[i+3]=c,i+=l}else for(let e=0;e<d;++e){const t=4*a[e],n=o[t],s=o[t+1],c=o[t+2],d=o[t+3];let h=f*n+m*s+g*c,N=_*n+E*s+A*c,P=p*n+T*s+R*c;if(v){const e=h*h+N*N+P*P;if(e<I&&e>S){const t=1/Math.sqrt(e);h*=t,N*=t,P*=t}}for(let e=0;e<r;++e)u[i]=h,u[i+1]=N,u[i+2]=P,u[i+3]=d,i+=l}}(t,n,i,u);break}case c.T.PROFILEVERTEXANDNORMAL:{(0,a.hu)(4===t.size);const n=r.getField(e,o.R2)??r.getField(e,o.ek);(0,a.hu)(!!n,`No buffer view for ${e}`),h(t,n,u);break}case c.T.PROFILEAUXDATA:{(0,a.hu)(3===t.size);const n=r.getField(e,o.qx)??r.getField(e,o.ct);(0,a.hu)(!!n,`No buffer view for ${e}`),d(t,n,u);break}}}},18836:function(e,t,n){n.d(t,{Ih:function(){return s},Ix:function(){return o},S7:function(){return c},eP:function(){return u},xq:function(){return a}});var i=n(24910),r=n(82846);function s({normalTexture:e,metallicRoughnessTexture:t,metallicFactor:n,roughnessFactor:s,emissiveTexture:o,emissiveFactor:a,occlusionTexture:c}){return null==e&&null==t&&null==o&&(null==a||(0,i.q)(a,r.AG))&&null==c&&(null==s||1===s)&&(null==n||1===n)}function o({normalTexture:e,metallicRoughnessTexture:t,metallicFactor:n,roughnessFactor:s,emissiveTexture:o,emissiveFactor:a,occlusionTexture:c}){return null==e&&null==t&&null==o&&(null==a||(0,i.q)(a,r.AG))&&null==c&&(null==s||1===s)&&(null==n||1===n||0===n)}const a=(0,r.vV)(1,1,.5),c=(0,r.vV)(0,.6,.2),u=(0,r.vV)(0,1,.2)},75047:function(e,t,n){n.d(t,{j:function(){return l}});var i=n(41044),r=n(34479),s=n(40122),o=n(13743),a=n(48857),c=n(33610),u=n(64801);function l(e,t){e.include(s.b,t),e.include(r.Ok,t),e.fragment.include(o.Y);const{output:n,oitPass:l,discardInvisibleFragments:d,snowCover:h}=t,f=n===i.H_.ObjectAndLayerIdColor,_=(0,i.qC)(n),p=(0,i.c1)(n)&&l===c.M.ColorAlpha,m=(0,i.c1)(n)&&l!==c.M.ColorAlpha;let E=0;(m||_||p)&&e.outputs.add("fragColor","vec4",E++),_&&e.outputs.add("fragEmission","vec4",E++),p&&e.outputs.add("fragAlpha","float",E++),e.fragment.code.add(a.H`
    void outputColorHighlightOID(vec4 finalColor, const in vec3 vWorldPosition, vec3 emissiveBaseColor ${(0,a.If)(h,", float snow")}) {
      ${(0,a.If)(f,"finalColor.a = 1.0;")}

      ${(0,a.If)(d,`if (finalColor.a < ${a.H.float(u.e)}) { discard; }`)}

      finalColor = applySlice(finalColor, vWorldPosition);
      ${(0,a.If)(p,a.H`fragColor = premultiplyAlpha(finalColor);
             fragAlpha = finalColor.a;`)}
      ${(0,a.If)(m,"fragColor = finalColor;")}
      ${(0,a.If)(_,`fragEmission = ${(0,a.If)(h,"mix(finalColor.a * getEmissions(emissiveBaseColor), vec4(0.0), snow);","finalColor.a * getEmissions(emissiveBaseColor);")}`)}
      calculateOcclusionAndOutputHighlight();
      ${(0,a.If)(f,"outputObjectAndLayerIdColor();")}
    }
  `)}},85797:function(e,t,n){n.d(t,{l:function(){return r}});var i=n(48857);function r(e){e.code.add(i.H`vec3 tonemapACES(vec3 x) {
return clamp((x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14), 0.0, 1.0);
}`)}},26173:function(e,t,n){n.d(t,{CM:function(){return r},lu:function(){return i}});var i,r;n(10934),n(74238),n(30146);!function(e){e.OPAQUE="opaque-color",e.TRANSPARENT="transparent-color",e.COMPOSITE="composite-color",e.FINAL="final-color"}(i||(i={})),function(e){e.SSAO="ssao",e.LASERLINES="laserline-color",e.ANTIALIASING="aa-color",e.HIGHLIGHTS="highlight-color",e.MAGNIFIER="magnifier-color",e.OCCLUDED="occluded-color",e.VIEWSHED="viewshed-color",e.OPAQUE_TERRAIN="opaque-terrain-color",e.OPAQUE_ENVIRONMENT="opaque-environment-color",e.TRANSPARENT_ENVIRONMENT="transparent-environment-color",e.FOCUSAREA="focusarea",e.FOCUSAREA_COLOR="focusarea-color"}(r||(r={}))},52054:function(e,t,n){n.d(t,{Z:function(){return d}});var i=n(73440),r=n(70880),s=n(88194),o=n(90403),a=n(17155),c=n(48023),u=n(26173),l=n(32420);let d=class extends r.Z{constructor(e){super(e),this.view=null,this.consumes={required:[]},this.produces=u.lu.COMPOSITE,this.requireGeometryDepth=!1,this._dirty=!0}initialize(){this.addHandles([(0,o.YP)((()=>this.view.ready),(e=>{e&&this.view.stage?.renderer.addRenderNode(this)}),o.nn)])}destroy(){this.view.stage?.renderer?.removeRenderNode(this)}precompile(){}render(){throw new s.Z("RenderNode:render-function-not-implemented","render() is not implemented.")}get camera(){return this.view.state.camera.clone()}get sunLight(){return this.bindParameters.lighting.legacy}get gl(){return this.view.stage.renderView.renderingContext.gl}get techniques(){return this.view.stage.renderView.techniques}acquireOutputFramebuffer(){const e=this._frameBuffer?.getTexture()?.descriptor,t=this.view.stage.renderer.fboCache.acquire(e?.width??640,e?.height??480,this.produces);return t.fbo?.initializeAndBind(),t}bindRenderTarget(){return this._frameBuffer?.fbo?.initializeAndBind(),this._frameBuffer}requestRender(e){e===l.Xx.UPDATE&&this.view.stage?.renderView.requestRender(e),this._dirty=!0}resetWebGLState(){this.renderingContext.resetState(),this.renderingContext.bindFramebuffer(this._frameBuffer?.fbo)}get fboCache(){return this.view.stage.renderer.fboCache}get bindParameters(){return this.renderContext.bind}get renderingContext(){return this.view.stage.renderView.renderingContext}get renderContext(){return this.view.stage?.renderer.renderContext}updateAnimation(e){return!!this._dirty&&(this._dirty=!1,!0)}doRender(e){this._frameBuffer=e.find((({name:e})=>e===this.produces));try{return this.render(e)}finally{this._frameBuffer=null}}};(0,i._)([(0,a.Cb)({constructOnly:!0})],d.prototype,"view",void 0),(0,i._)([(0,a.Cb)({constructOnly:!0})],d.prototype,"consumes",void 0),(0,i._)([(0,a.Cb)()],d.prototype,"produces",void 0),(0,i._)([(0,a.Cb)({readOnly:!0})],d.prototype,"techniques",null),d=(0,i._)([(0,c.j)("esri.views.3d.webgl.RenderNode")],d)},29870:function(e,t,n){var i;n.d(t,{R:function(){return i}}),function(e){e[e.TextureDescriptor=0]="TextureDescriptor",e[e.Texture=1]="Texture",e[e.Renderbuffer=2]="Renderbuffer"}(i||(i={}))},15150:function(e,t,n){n.d(t,{kG:function(){return c}});var i=n(88194),r=(n(61432),n(96711)),s=n(5998);const o=()=>r.Z.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");class a{constructor(){this._includedModules=new Map}include(e,t){this._includedModules.has(e)?this._includedModules.get(e):(this._includedModules.set(e,t),e(this.builder,t))}}class c extends a{constructor(){super(...arguments),this.vertex=new h,this.fragment=new h,this.attributes=new f,this.varyings=new _,this.extensions=new p,this.outputs=new m}get fragmentUniforms(){return this.fragment.uniforms.entries}get builder(){return this}generate(e,t=!1){const n=this.extensions.generateSource(e),i=this.attributes.generateSource(e),r=this.varyings.generateSource(e),s="vertex"===e?this.vertex:this.fragment,o=s.uniforms.generateSource(),a=s.code.generateSource(),c=s.main.generateSource(t),u="vertex"===e?g:T,l=s.constants.generateSource(),d=this.outputs.generateSource(e);return`#version 300 es\n${n.join("\n")}\n${u}\n${l.join("\n")}\n${o.join("\n")}\n${i.join("\n")}\n${r.join("\n")}\n${d.join("\n")}\n${a.join("\n")}\n${c.join("\n")}`}generateBind(e){const t=new Map;this.vertex.uniforms.entries.forEach((e=>{const n=e.bind[s.P.Bind];n&&t.set(e.name,n)})),this.fragment.uniforms.entries.forEach((e=>{const n=e.bind[s.P.Bind];n&&t.set(e.name,n)}));const n=Array.from(t.values()),i=n.length;return t=>{for(let r=0;r<i;++r)n[r](e,t)}}generateBindPass(e){const t=new Map;this.vertex.uniforms.entries.forEach((e=>{const n=e.bind[s.P.Pass];n&&t.set(e.name,n)})),this.fragment.uniforms.entries.forEach((e=>{const n=e.bind[s.P.Pass];n&&t.set(e.name,n)}));const n=Array.from(t.values()),i=n.length;return(t,r)=>{for(let s=0;s<i;++s)n[s](e,t,r)}}generateBindDraw(e){const t=new Map;this.vertex.uniforms.entries.forEach((e=>{const n=e.bind[s.P.Draw];n&&t.set(e.name,n)})),this.fragment.uniforms.entries.forEach((e=>{const n=e.bind[s.P.Draw];n&&t.set(e.name,n)}));const n=Array.from(t.values()),i=n.length;return(t,r,s)=>{for(let o=0;o<i;++o)n[o](e,s,t,r)}}}class u{constructor(e){this._stage=e,this._entries=new Map}add(...e){for(const t of e)this._add(t);return this._stage}get(e){return this._entries.get(e)}_add(e){if(null!=e){if(this._entries.has(e.name)&&!this._entries.get(e.name).equals(e))throw new i.Z("shaderbuilder:duplicate-uniform",`Duplicate uniform name ${e.name} for different uniform type`);this._entries.set(e.name,e)}else o().error(`Trying to add null Uniform from ${(new Error).stack}.`)}generateSource(){return Array.from(this._entries.values()).map((({name:e,arraySize:t,type:n})=>null!=t?`uniform ${n} ${e}[${t}];`:`uniform ${n} ${e};`))}get entries(){return Array.from(this._entries.values())}}class l{constructor(e){this._stage=e,this._bodies=new Array}add(e){return this._bodies.push(e),this._stage}generateSource(e){if(this._bodies.length>0)return[`void main() {\n ${this._bodies.join("\n")||""} \n}`];if(e)throw new i.Z("shaderbuilder:missing-main","Shader does not contain main function body.");return[]}}class d{constructor(e){this._stage=e,this._entries=new Array}add(e){return this._entries.push(e),this._stage}generateSource(){return this._entries}}class h extends a{constructor(){super(...arguments),this.uniforms=new u(this),this.main=new l(this),this.code=new d(this),this.constants=new E(this)}get builder(){return this}}class f{constructor(){this._entries=new Array}add(e,t){this._entries.push([e,t])}generateSource(e){return"fragment"===e?[]:this._entries.map((e=>`in ${e[1]} ${e[0]};`))}}class _{constructor(){this._entries=new Map}add(e,t,n){this._entries.has(e)?o().warn(`Ignoring duplicate varying ${t} ${e}`):this._entries.set(e,{type:t,invariant:n?.invariant??!1})}generateSource(e){const t=new Array;return this._entries.forEach(((n,i)=>t.push((n.invariant&&"vertex"===e?"invariant ":"")+("vertex"===e?"out":"in")+` ${n.type} ${i};`))),t}}class p{constructor(){this._entries=new Set}add(e){this._entries.add(e)}generateSource(e){const t="vertex"===e?p.ALLOWLIST_VERTEX:p.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter((e=>t.includes(e))).map((e=>`#extension ${e} : enable`))}static{this.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"]}static{this.ALLOWLIST_VERTEX=[]}}class m{constructor(){this._entries=new Map}add(e,t,n=0){const i=this._entries.get(n);i?.name!==e||i?.type!==t?this._entries.set(n,{name:e,type:t}):o().warn(`Fragment shader output location ${n} occupied`)}static{this.DEFAULT_TYPE="vec4"}static{this.DEFAULT_NAME="fragColor"}generateSource(e){if("vertex"===e)return[];0===this._entries.size&&this._entries.set(0,{name:m.DEFAULT_NAME,type:m.DEFAULT_TYPE});const t=new Array;return this._entries.forEach(((e,n)=>t.push(`layout(location = ${n}) out ${e.type} ${e.name};`))),t}}class E{constructor(e){this._stage=e,this._entries=new Set}add(e,t,n){let i="ERROR_CONSTRUCTOR_STRING";switch(t){case"float":i=E._numberToFloatStr(n);break;case"int":i=E._numberToIntStr(n);break;case"bool":i=n.toString();break;case"vec2":i=`vec2(${E._numberToFloatStr(n[0])},                            ${E._numberToFloatStr(n[1])})`;break;case"vec3":i=`vec3(${E._numberToFloatStr(n[0])},                            ${E._numberToFloatStr(n[1])},                            ${E._numberToFloatStr(n[2])})`;break;case"vec4":i=`vec4(${E._numberToFloatStr(n[0])},                            ${E._numberToFloatStr(n[1])},                            ${E._numberToFloatStr(n[2])},                            ${E._numberToFloatStr(n[3])})`;break;case"ivec2":i=`ivec2(${E._numberToIntStr(n[0])},                             ${E._numberToIntStr(n[1])})`;break;case"ivec3":i=`ivec3(${E._numberToIntStr(n[0])},                             ${E._numberToIntStr(n[1])},                             ${E._numberToIntStr(n[2])})`;break;case"ivec4":i=`ivec4(${E._numberToIntStr(n[0])},                             ${E._numberToIntStr(n[1])},                             ${E._numberToIntStr(n[2])},                             ${E._numberToIntStr(n[3])})`;break;case"uvec2":i=`uvec2(${E._numberToIntStr(n[0])},                             ${E._numberToIntStr(n[1])})`;break;case"uvec3":i=`uvec3(${E._numberToIntStr(n[0])},                             ${E._numberToIntStr(n[1])},                             ${E._numberToIntStr(n[2])})`;break;case"uvec4":i=`uvec4(${E._numberToIntStr(n[0])},                             ${E._numberToIntStr(n[1])},                             ${E._numberToIntStr(n[2])},                             ${E._numberToIntStr(n[3])})`;break;case"mat2":case"mat3":case"mat4":i=`${t}(${Array.prototype.map.call(n,(e=>E._numberToFloatStr(e))).join(", ")})`}return this._entries.add(`const ${t} ${e} = ${i};`),this._stage}static _numberToIntStr(e){return e.toFixed(0)}static _numberToFloatStr(e){return Number.isInteger(e)?e.toFixed(1):e.toString()}generateSource(){return Array.from(this._entries)}}const T="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp int;\n  precision highp sampler2D;\n  precision highp usampler2D;\n  precision highp sampler2DArray;\n  precision highp sampler2DShadow;\n#else\n  precision mediump float;\n  precision mediump int;\n  precision mediump sampler2D;\n  precision mediump usampler2D;\n  precision mediump sampler2DArray;\n  precision mediump sampler2DShadow;\n#endif",g="precision highp float;\n precision highp sampler2D;\n precision highp usampler2D;\n precision highp sampler2DArray;\n precision highp sampler2DShadow;\n\n\n invariant gl_Position;\n "},8158:function(e,t,n){n.d(t,{x:function(){return _}});var i=n(88194),r=(n(61432),n(96711)),s=n(61100),o=n(93568),a=n(13e3),c=n(65650),u=n(29870),l=n(35928),d=n(42377);class h extends l.X{constructor(e,t){switch(super(),this.context=e,Object.assign(this,t),this.internalFormat){case c.lP.R16F:case c.lP.R32F:case c.lP.R8_SNORM:case c.lP.R8:this.pixelFormat=c.VI.RED;break;case c.lP.R8I:case c.lP.R8UI:case c.lP.R16I:case c.lP.R16UI:case c.lP.R32I:case c.lP.R32UI:this.pixelFormat=c.VI.RED_INTEGER}}static validate(e,t){return new h(e,t)}}const f=()=>r.Z.getLogger("esri/views/webgl/Texture");let _=class e{static{this.TEXTURE_UNIT_FOR_UPDATES=0}static{this.compressionWorkerHandle=null}constructor(e,t=null,n=null){if(this.type=u.R.Texture,this._glName=null,this._samplingModeDirty=!1,this._wrapModeDirty=!1,this._shadowFilterDirty=!1,this._wasImmutablyAllocated=!1,"context"in e)this._descriptor=e,n=t;else{const n=h.validate(e,t);if(!n)throw new i.Z("texture:invalid-descriptor","Texture descriptor invalid");this._descriptor=n}this._descriptor.target===c.No.TEXTURE_CUBE_MAP?this._setDataCubeMap(n):this.setData(n)}get glName(){return this._glName}get descriptor(){return this._descriptor}get usedMemory(){return(0,l.G)(this._descriptor)}get cachedMemory(){return this.usedMemory}get isDirty(){return this._samplingModeDirty||this._wrapModeDirty||this._shadowFilterDirty}get hasWebGLTextureObject(){return!!this._glName}dispose(){this.abortCompression(),this._descriptor.context.gl&&this.hasWebGLTextureObject&&(this._descriptor.context.instanceCounter.decrement(c._g.Texture,this),this._descriptor.context.unbindTexture(this),this._descriptor.context.gl.deleteTexture(this._glName),this._glName=null)}release(){this.dispose()}resize(e,t){const n=this._descriptor;if(n.width!==e||n.height!==t){if(this._wasImmutablyAllocated)throw new i.Z("texture:immutable-resize","Immutable textures can't be resized!");n.width=e,n.height=t,this._descriptor.target===c.No.TEXTURE_CUBE_MAP?this._setDataCubeMap(null):this.setData(null)}}enableCompression(e){this._descriptor.compress=e}disableCompression(){this._descriptor.compress=void 0}setData(e){this.abortCompression(),!(0,d.w1)(e)&&this._descriptor.internalFormat&&this._descriptor.internalFormat in c.q_&&(this._descriptor.internalFormat=void 0),this._setData(e),!(0,d.w1)(e)&&this._descriptor.compress&&this._compressOnWorker(e)}updateData(t,n,r,s,o,a,c=0){a||f().error("An attempt to use uninitialized data!"),this.hasWebGLTextureObject||f().error("An attempt to update uninitialized texture!");const u=this._descriptor;u.internalFormat=(0,d.Sn)(u);const{context:l,pixelFormat:h,dataType:_,target:p,isImmutable:m}=u;if(m&&!this._wasImmutablyAllocated)throw new i.Z("texture:uninitialized","Cannot update immutable texture before allocation!");const E=l.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES,!0);(n<0||r<0||n+s>u.width||r+o>u.height)&&f().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:T}=l;c&&(s&&o||f().warn("Must pass width and height if `UNPACK_SKIP_ROWS` is used"),T.pixelStorei(T.UNPACK_SKIP_ROWS,c)),(0,d.E)(a)?T.texSubImage2D(p,t,n,r,s,o,h,_,a):(0,d.w1)(a)?T.compressedTexSubImage2D(p,t,n,r,s,o,u.internalFormat,a.levels[t]):T.texSubImage2D(p,t,n,r,s,o,h,_,a),c&&T.pixelStorei(T.UNPACK_SKIP_ROWS,0),l.bindTexture(E,e.TEXTURE_UNIT_FOR_UPDATES)}updateData3D(t,n,r,s,o,a,c,u){u||f().error("An attempt to use uninitialized data!"),this.hasWebGLTextureObject||f().error("An attempt to update an uninitialized texture!");const l=this._descriptor;l.internalFormat=(0,d.Sn)(l);const{context:h,pixelFormat:_,dataType:p,isImmutable:m,target:E}=l;if(m&&!this._wasImmutablyAllocated)throw new i.Z("texture:uninitialized","Cannot update immutable texture before allocation!");(0,d.px)(E)||f().warn("Attempting to set 3D texture data on a non-3D texture");const T=h.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES);h.setActiveTexture(e.TEXTURE_UNIT_FOR_UPDATES),(n<0||r<0||s<0||n+o>l.width||r+a>l.height||s+c>l.depth)&&f().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:g}=h;if((0,d.w1)(u))u=u.levels[t],g.compressedTexSubImage3D(E,t,n,r,s,o,a,c,l.internalFormat,u);else{const e=u;g.texSubImage3D(E,t,n,r,s,o,a,c,_,p,e)}h.bindTexture(T,e.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const t=this._descriptor;if(0===t.width||0===t.height)return;if(!t.hasMipmap){if(this._wasImmutablyAllocated)throw new i.Z("texture:immutable-change","Cannot add mipmaps to immutable texture after allocation");t.hasMipmap=!0,this._samplingModeDirty=!0,(0,d.QY)(t)}t.samplingMode===c.cw.LINEAR?(this._samplingModeDirty=!0,t.samplingMode=c.cw.LINEAR_MIPMAP_NEAREST):t.samplingMode===c.cw.NEAREST&&(this._samplingModeDirty=!0,t.samplingMode=c.cw.NEAREST_MIPMAP_NEAREST);const n=this._descriptor.context.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(e.TEXTURE_UNIT_FOR_UPDATES),this._descriptor.context.gl.generateMipmap(t.target),this._descriptor.context.bindTexture(n,e.TEXTURE_UNIT_FOR_UPDATES)}clearMipmap(){const e=this._descriptor;if(e.hasMipmap){if(this._wasImmutablyAllocated)throw new i.Z("texture:immutable-change","Cannot delete mipmaps to immutable texture after allocation");e.hasMipmap=!1,this._samplingModeDirty=!0,(0,d.QY)(e)}e.samplingMode===c.cw.LINEAR_MIPMAP_NEAREST?(this._samplingModeDirty=!0,e.samplingMode=c.cw.LINEAR):e.samplingMode===c.cw.NEAREST_MIPMAP_NEAREST&&(this._samplingModeDirty=!0,e.samplingMode=c.cw.NEAREST)}setSamplingMode(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,this._samplingModeDirty=!0)}setWrapMode(e){e!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=e,(0,d.QY)(this._descriptor),this._wrapModeDirty=!0)}setShadowFiltering(e){e!==this._descriptor.linearFilterDepth&&(this._descriptor.linearFilterDepth=this._descriptor.compareEnabled=e,this.setSamplingMode(e?c.cw.LINEAR:c.cw.NEAREST),(0,d.QY)(this._descriptor),this._shadowFilterDirty=!0)}applyChanges(){this._samplingModeDirty&&(this._applySamplingMode(),this._samplingModeDirty=!1),this._wrapModeDirty&&(this._applyWrapMode(),this._wrapModeDirty=!1),this._shadowFilterDirty&&(this._applyShadowMode(),this._shadowFilterDirty=!1)}abortCompression(){this._compressionAbortController=(0,s.IM)(this._compressionAbortController)}_setData(t,n){const r=this._descriptor,s=r.context?.gl;if(!s)return;(0,a.zu)(s),this.hasWebGLTextureObject||(this._glName=s.createTexture(),r.context.instanceCounter.increment(c._g.Texture,this)),(0,d.QY)(r);const o=r.context.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES);r.context.setActiveTexture(e.TEXTURE_UNIT_FOR_UPDATES),this._configurePixelStorage(),(0,a.zu)(s);const u=n??r.target,l=(0,d.px)(u);if((0,d.E)(t))this._setDataFromTexImageSource(t,u);else{const{width:e,height:n,depth:o}=r;if(null==e||null==n)throw new i.Z("texture:missing-size","Width and height must be specified!");if(l&&null==o)throw new i.Z("texture:missing-depth","Depth must be specified!");if(r.internalFormat=(0,d.Sn)(r),r.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(u,r.internalFormat,r.hasMipmap,e,n,o),(0,d.w1)(t)){if(!(0,d.gP)(r.internalFormat))throw new i.Z("texture:format-mismatch","Attempting to use compressed data with an uncompressed format!");this._setDataFromCompressedSource(t,r.internalFormat,u)}else this._texImage(u,0,r.internalFormat,e,n,o,t),(0,a.zu)(s),r.hasMipmap&&this.generateMipmap()}this._applySamplingMode(),this._applyWrapMode(),this._applyAnisotropicFilteringParameters(),this._applyShadowMode(),(0,a.zu)(s),r.context.bindTexture(o,e.TEXTURE_UNIT_FOR_UPDATES)}_setDataCubeMap(e=null){for(let t=c.No.TEXTURE_CUBE_MAP_POSITIVE_X;t<=c.No.TEXTURE_CUBE_MAP_NEGATIVE_Z;t++)this._setData(e,t)}_configurePixelStorage(){const e=this._descriptor.context.gl,{unpackAlignment:t,flipped:n,preMultiplyAlpha:i}=this._descriptor;e.pixelStorei(e.UNPACK_ALIGNMENT,t),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,n?1:0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i?1:0)}_setDataFromTexImageSource(e,t){const{gl:n}=this._descriptor.context,i=this._descriptor;i.internalFormat=(0,d.Sn)(i);const r=(0,d.px)(t),{width:s,height:o,depth:c}=(0,d.t_)(e);i.width&&i.height,i.width||(i.width=s),i.height||(i.height=o),r&&i.depth,r&&(i.depth=c),i.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(t,i.internalFormat,i.hasMipmap,s,o,c),this._texImage(t,0,i.internalFormat,s,o,c,e),(0,a.zu)(n),i.hasMipmap&&(this.generateMipmap(),(0,a.zu)(n))}_setDataFromCompressedSource(e,t,n){const i=this._descriptor,{width:r,height:s,depth:o}=i,a=e.levels,u=(0,d.eE)(n,r,s,o),l=Math.min(u,a.length)-1;this._descriptor.context.gl.texParameteri(i.target,c.Ow.MAX_LEVEL,l),this._forEachMipmapLevel(((e,i,r,s)=>{const o=a[Math.min(e,a.length-1)];this._compressedTexImage(n,e,t,i,r,s,o)}),l)}_texStorage(e,t,n,r,s,o){const{gl:a}=this._descriptor.context;if(!(0,d.av)(t)&&!(0,d.M4)(t)&&!(0,d.xR)(t))throw new i.Z("texture:missing-format","Immutable textures must have a sized internal format");if(!this._descriptor.isImmutable)return;const c=n?(0,d.eE)(e,r,s,o):1;if((0,d.px)(e)){if(null==o)throw new i.Z("texture:missing-depth","Missing depth dimension for 3D texture upload");a.texStorage3D(e,c,t,r,s,o)}else a.texStorage2D(e,c,t,r,s);this._wasImmutablyAllocated=!0}_texImage(e,t,n,r,s,o,a){const c=this._descriptor.context.gl,u=(0,d.px)(e),{isImmutable:l,pixelFormat:h,dataType:f}=this._descriptor;if(l){if(null!=a){const n=a;if(u){if(null==o)throw new i.Z("texture:missing-depth","Missing depth dimension for 3D texture upload");c.texSubImage3D(e,t,0,0,0,r,s,o,h,f,n)}else c.texSubImage2D(e,t,0,0,r,s,h,f,n)}}else{const l=a;if(u){if(null==o)throw new i.Z("texture:missing-depth","Missing depth dimension for 3D texture upload");c.texImage3D(e,t,n,r,s,o,0,h,f,l)}else c.texImage2D(e,t,n,r,s,0,h,f,l)}}_compressedTexImage(e,t,n,r,s,o,a){const c=this._descriptor.context.gl,u=(0,d.px)(e);if(this._descriptor.isImmutable){if(null!=a)if(u){if(null==o)throw new i.Z("texture:missing-depth","Missing depth dimension for 3D texture upload");c.compressedTexSubImage3D(e,t,0,0,0,r,s,o,n,a)}else c.compressedTexSubImage2D(e,t,0,0,r,s,n,a)}else if(u){if(null==o)throw new i.Z("texture:missing-depth","Missing depth dimension for 3D texture upload");c.compressedTexImage3D(e,t,n,r,s,o,0,a)}else c.compressedTexImage2D(e,t,n,r,s,0,a)}async _compressOnWorker(t){const{width:n,height:i,context:r,flipped:s,preMultiplyAlpha:a,hasMipmap:u}=this._descriptor,l=this._descriptor.compress?.compressionTracker,d=this._descriptor.compress?.compressionCallback,{compressedTextureETC:h,compressedTextureS3TC:_}=r.capabilities;if(!e.compressionWorkerHandle?.isCompressible(t,this._descriptor)||!h&&!_)return;this.abortCompression();const p=new AbortController;this._compressionAbortController=p,l?.increment();try{let r;t instanceof Uint8Array?r=t.buffer:(r=await createImageBitmap(t,{imageOrientation:s?"flipY":"none"}),(0,o.k_)(p));const l={data:r,width:n,height:i,needsFlip:t instanceof Uint8Array&&this.descriptor.flipped,components:this._descriptor.pixelFormat===c.VI.RGBA?4:3,preMultiplyAlpha:a,hasMipmap:u,hasETC:!!h,hasS3TC:!!_},f=await e.compressionWorkerHandle.invoke(l,p.signal,"low");if((0,o.k_)(p),f.compressedTexture&&this.hasWebGLTextureObject){const e=this.usedMemory;this._descriptor.internalFormat=f.internalFormat,this._setData(f.compressedTexture),d?.(e-this.usedMemory)}}catch(e){(0,o.D_)(e)||f().error("Texture compression failed!")}finally{f?.decrement(),this._compressionAbortController?.signal.aborted&&(this._compressionAbortController=null)}}_forEachMipmapLevel(e,t=1/0){let{width:n,height:r,depth:s,hasMipmap:o,target:a}=this._descriptor;const u=a===c.No.TEXTURE_3D;if(null==n||null==r||u&&null==s)throw new i.Z("texture:missing-size","Missing texture dimensions for mipmap calculation");for(let i=0;e(i,n,r,s),o&&(1!==n||1!==r||u&&1!==s)&&!(i>=t);++i)n=Math.max(1,n>>1),r=Math.max(1,r>>1),u&&(s=Math.max(1,s>>1))}_applySamplingMode(){const e=this._descriptor,t=e.context?.gl;let n=e.samplingMode,i=e.samplingMode;n===c.cw.LINEAR_MIPMAP_NEAREST||n===c.cw.LINEAR_MIPMAP_LINEAR?(n=c.cw.LINEAR,e.hasMipmap||(i=c.cw.LINEAR)):n!==c.cw.NEAREST_MIPMAP_NEAREST&&n!==c.cw.NEAREST_MIPMAP_LINEAR||(n=c.cw.NEAREST,e.hasMipmap||(i=c.cw.NEAREST)),t.texParameteri(e.target,t.TEXTURE_MAG_FILTER,n),t.texParameteri(e.target,t.TEXTURE_MIN_FILTER,i)}_applyWrapMode(){const e=this._descriptor,t=e.context?.gl;"number"==typeof e.wrapMode?(t.texParameteri(e.target,t.TEXTURE_WRAP_S,e.wrapMode),t.texParameteri(e.target,t.TEXTURE_WRAP_T,e.wrapMode)):(t.texParameteri(e.target,t.TEXTURE_WRAP_S,e.wrapMode.s),t.texParameteri(e.target,t.TEXTURE_WRAP_T,e.wrapMode.t))}_applyShadowMode(){const e=this._descriptor,t=e.context?.gl,n=e.compareEnabled?t.COMPARE_REF_TO_TEXTURE:t.NONE;t.texParameteri(e.target,t.TEXTURE_COMPARE_MODE,n),e.compareEnabled&&t.texParameteri(e.target,t.TEXTURE_COMPARE_FUNC,t.GREATER),(0,a.zu)(t)}_applyAnisotropicFilteringParameters(){const e=this._descriptor,t=e.context.capabilities.textureFilterAnisotropic;t&&e.context.gl.texParameterf(e.target,t.TEXTURE_MAX_ANISOTROPY,e.maxAnisotropy??1)}}},35928:function(e,t,n){n.d(t,{G:function(){return a},X:function(){return o}});var i=n(65650),r=n(29870),s=n(15483);class o{constructor(e=0,t=e){this.width=e,this.height=t,this.type=r.R.TextureDescriptor,this.target=i.No.TEXTURE_2D,this.pixelFormat=i.VI.RGBA,this.dataType=i.Br.UNSIGNED_BYTE,this.samplingMode=i.cw.LINEAR,this.wrapMode=i.e8.REPEAT,this.maxAnisotropy=1,this.flipped=!1,this.hasMipmap=!1,this.isOpaque=!1,this.unpackAlignment=4,this.preMultiplyAlpha=!1,this.compareEnabled=!1,this.linearFilterDepth=!1,this.depth=1,this.isImmutable=!1}}function a(e){return e.width<=0||e.height<=0||e.depth<=0?0:Math.round(e.width*e.height*e.depth*(e.hasMipmap?4/3:1)*(null==e.internalFormat?4:(0,s.RG)(e.internalFormat))*(e.target===i.No.TEXTURE_CUBE_MAP?6:1))}},15483:function(e,t,n){n.d(t,{HH:function(){return o},RG:function(){return l},UF:function(){return u},XP:function(){return c},_V:function(){return a}});n(61432);var i=n(13e3),r=n(65650),s=n(51423);function o(e){const t=e.gl;switch(t.getError()){case t.NO_ERROR:return null;case t.INVALID_ENUM:return"An unacceptable value has been specified for an enumerated argument";case t.INVALID_VALUE:return"An unacceptable value has been specified for an argument";case t.INVALID_OPERATION:return"The specified command is not allowed for the current state";case t.INVALID_FRAMEBUFFER_OPERATION:return"The currently bound framebuffer is not framebuffer complete";case t.OUT_OF_MEMORY:return"Not enough memory is left to execute the command";case t.CONTEXT_LOST_WEBGL:return"WebGL context is lost"}return"Unknown error"}function a(e,t){return(e.vertexBuffers.get(t)?.usedMemory??0)/function(e){return e[0].stride}(e.layout.get(t))}function c(e,t,n,r,a=0){const c=e.gl;e.bindBuffer(n);for(const n of r){const r=t.get(n.name);if(null==r){console.warn(`There is no location for vertex attribute '${n.name}' defined.`);continue}const u=a*n.stride;if(n.count<=4)c.vertexAttribPointer(r,n.count,n.type,n.normalized,n.stride,n.offset+u),c.enableVertexAttribArray(r),n.divisor>0&&e.gl.vertexAttribDivisor(r,n.divisor);else if(9===n.count)for(let t=0;t<3;t++)c.vertexAttribPointer(r+t,3,n.type,n.normalized,n.stride,n.offset+12*t+u),c.enableVertexAttribArray(r+t),n.divisor>0&&e.gl.vertexAttribDivisor(r+t,n.divisor);else if(16===n.count)for(let t=0;t<4;t++)c.vertexAttribPointer(r+t,4,n.type,n.normalized,n.stride,n.offset+16*t+u),c.enableVertexAttribArray(r+t),n.divisor>0&&e.gl?.vertexAttribDivisor(r+t,n.divisor);else console.error("Unsupported vertex attribute element count: "+n.count);if((0,i.hZ)()){const t=o(e),i=(0,s.S)(n.type),r=n.offset,a=Math.round(i/r)!==i/r?`. Offset not a multiple of stride. DataType requires ${i} bytes, but descriptor has an offset of ${r}`:"";t&&console.error(`Unable to bind vertex attribute "${n.name}" with baseInstanceOffset ${u}${a}:`,t,n)}}}function u(e,t,n,i){const s=e.gl;e.bindBuffer(n);for(const n of i){const i=t.get(n.name);if(n.count<=4)s.disableVertexAttribArray(i),n.divisor&&n.divisor>0&&e.gl?.vertexAttribDivisor(i,0);else if(9===n.count)for(let t=0;t<3;t++)s.disableVertexAttribArray(i+t),n.divisor&&n.divisor>0&&e.gl?.vertexAttribDivisor(i+t,0);else if(16===n.count)for(let t=0;t<4;t++)s.disableVertexAttribArray(i+t),n.divisor&&n.divisor>0&&e.gl?.vertexAttribDivisor(i+t,0);else console.error("Unsupported vertex attribute element count: "+n.count)}e.unbindBuffer(r.w0.ARRAY_BUFFER)}function l(e){switch(e){case r.VI.ALPHA:case r.VI.LUMINANCE:case r.VI.RED:case r.VI.RED_INTEGER:case r.lP.R8:case r.lP.R8I:case r.lP.R8UI:case r.lP.R8_SNORM:case r.YM.STENCIL_INDEX8:return 1;case r.VI.LUMINANCE_ALPHA:case r.VI.RG:case r.VI.RG_INTEGER:case r.lP.RGBA4:case r.lP.R16F:case r.lP.R16I:case r.lP.R16UI:case r.lP.RG8:case r.lP.RG8I:case r.lP.RG8UI:case r.lP.RG8_SNORM:case r.lP.RGB565:case r.lP.RGB5_A1:case r.DM.DEPTH_COMPONENT16:return 2;case r.VI.RGB:case r.VI.RGB_INTEGER:case r.lP.RGB8:case r.lP.RGB8I:case r.lP.RGB8UI:case r.lP.RGB8_SNORM:case r.lP.SRGB8:case r.DM.DEPTH_COMPONENT24:return 3;case r.VI.RGBA:case r.VI.RGBA_INTEGER:case r.lP.RGBA8:case r.lP.R32F:case r.lP.R11F_G11F_B10F:case r.lP.RG16F:case r.lP.R32I:case r.lP.R32UI:case r.lP.RG16I:case r.lP.RG16UI:case r.lP.RGBA8I:case r.lP.RGBA8UI:case r.lP.RGBA8_SNORM:case r.lP.SRGB8_ALPHA8:case r.lP.RGB9_E5:case r.lP.RGB10_A2UI:case r.lP.RGB10_A2:case r.DM.DEPTH_COMPONENT32F:case r.wo.DEPTH24_STENCIL8:return 4;case r.wo.DEPTH32F_STENCIL8:return 5;case r.lP.RGB16F:case r.lP.RGB16I:case r.lP.RGB16UI:return 6;case r.lP.RG32F:case r.lP.RG32I:case r.lP.RG32UI:case r.lP.RGBA16F:case r.lP.RGBA16I:case r.lP.RGBA16UI:return 8;case r.lP.RGB32F:case r.lP.RGB32I:case r.lP.RGB32UI:return 12;case r.lP.RGBA32F:case r.lP.RGBA32I:case r.lP.RGBA32UI:return 16;case r.q_.COMPRESSED_RGB_S3TC_DXT1_EXT:case r.q_.COMPRESSED_RGBA_S3TC_DXT1_EXT:return.5;case r.q_.COMPRESSED_RGBA_S3TC_DXT3_EXT:case r.q_.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case r.q_.COMPRESSED_R11_EAC:case r.q_.COMPRESSED_SIGNED_R11_EAC:case r.q_.COMPRESSED_RGB8_ETC2:case r.q_.COMPRESSED_SRGB8_ETC2:case r.q_.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case r.q_.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return.5;case r.q_.COMPRESSED_RG11_EAC:case r.q_.COMPRESSED_SIGNED_RG11_EAC:case r.q_.COMPRESSED_RGBA8_ETC2_EAC:case r.q_.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}},13e3:function(e,t,n){n.d(t,{CG:function(){return u},CM:function(){return a},hZ:function(){return c},zu:function(){return l}});var i=n(88194),r=n(61432),s=n(96711),o=n(65650);const a=!!(0,r.Z)("enable-feature:webgl-debug");function c(){return a}function u(){return a}function l(e,t=c()){if(t){const t=e.getError();if(t){const e=function(e){switch(e){case o.mA.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case o.mA.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case o.mA.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case o.mA.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case o.mA.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case o.mA.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}(t),n=(new Error).stack;s.Z.getLogger("esri.views.webgl.checkWebGLError").error(new i.Z("webgl-error","WebGL error occurred",{message:e,stack:n}))}}}},82969:function(e,t,n){function i(e,t,n){for(let i=0;i<n;++i)t[2*i]=e[i],t[2*i+1]=e[i]-t[2*i]}function r(e,t){const n=e.length;for(let i=0;i<n;++i)o[0]=e[i],t[i]=o[0];return t}function s(e,t){const n=e.length;for(let i=0;i<n;++i)o[0]=e[i],o[1]=e[i]-o[0],t[i]=o[1];return t}n.d(t,{GB:function(){return s},LF:function(){return i},U8:function(){return r}});const o=new Float32Array(2)},65650:function(e,t,n){var i,r,s,o,a,c,u,l,d,h,f,_,p,m,E,T,g,A,R,v,S,I,N,P,M;n.d(t,{Br:function(){return I},DM:function(){return v},FF:function(){return L},Hf:function(){return i},Ho:function(){return P},Ii:function(){return D},LR:function(){return u},Lu:function(){return U},MX:function(){return s},Ml:function(){return b},N2:function(){return A},No:function(){return m},Ow:function(){return E},V1:function(){return C},V7:function(){return z},VI:function(){return T},Wf:function(){return l},Xg:function(){return x},Y5:function(){return V},YM:function(){return S},_L:function(){return w},_g:function(){return O},cw:function(){return _},db:function(){return a},e8:function(){return p},g:function(){return d},hj:function(){return X},i5:function(){return r},l1:function(){return N},lP:function(){return g},mA:function(){return k},q_:function(){return y},qi:function(){return M},sQ:function(){return F},w0:function(){return c},wb:function(){return h},wo:function(){return R},xS:function(){return f},zi:function(){return o}}),function(e){e[e.DEPTH=256]="DEPTH",e[e.STENCIL=1024]="STENCIL",e[e.COLOR=16384]="COLOR"}(i||(i={})),function(e){e[e.COLOR=6144]="COLOR",e[e.DEPTH=6145]="DEPTH",e[e.STENCIL=6146]="STENCIL",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(r||(r={})),function(e){e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(s||(s={})),function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA"}(o||(o={})),function(e){e[e.ADD=32774]="ADD",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.SUBTRACT=32778]="SUBTRACT",e[e.REVERSE_SUBTRACT=32779]="REVERSE_SUBTRACT"}(a||(a={})),function(e){e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER"}(c||(c={})),function(e){e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK"}(u||(u={})),function(e){e[e.CW=2304]="CW",e[e.CCW=2305]="CCW"}(l||(l={})),function(e){e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.HALF_FLOAT=5131]="HALF_FLOAT"}(d||(d={})),function(e){e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS"}(h||(h={})),function(e){e[e.ZERO=0]="ZERO",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP"}(f||(f={})),function(e){e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"}(_||(_={})),function(e){e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(p||(p={})),function(e){e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY"}(m||(m={})),function(e){e[e.MIN_LOD=33082]="MIN_LOD",e[e.MAX_LOD=33083]="MAX_LOD",e[e.BASE_LEVEL=33084]="BASE_LEVEL",e[e.MAX_LEVEL=33085]="MAX_LEVEL",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE"}(E||(E={})),function(e){e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.RED=6403]="RED",e[e.RG=33319]="RG",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER"}(T||(T={})),function(e){e[e.RGBA4=32854]="RGBA4",e[e.R16F=33325]="R16F",e[e.RG16F=33327]="RG16F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.R32F=33326]="R32F",e[e.RG32F=33328]="RG32F",e[e.RGBA32F=34836]="RGBA32F",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB5_A1=32855]="RGB5_A1",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.RGB16F=34843]="RGB16F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.RGB565=36194]="RGB565",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2=32857]="RGB10_A2",e[e.RGB10_A2UI=36975]="RGB10_A2UI"}(g||(g={})),function(e){e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(A||(A={})),function(e){e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8"}(R||(R={})),function(e){e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F"}(v||(v={})),function(e){e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8"}(S||(S={})),function(e){e[e.FLOAT=5126]="FLOAT",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.INT=5124]="INT",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV"}(I||(I={})),function(e){e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_READ=35045]="STATIC_READ",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.STREAM_COPY=35042]="STREAM_COPY"}(N||(N={})),function(e){e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER"}(P||(P={})),function(e){e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER"}(M||(M={}));const C=33984;var O,x;!function(e){e[e.Texture=0]="Texture",e[e.TileTexture=1]="TileTexture",e[e.BufferObject=2]="BufferObject",e[e.VertexArrayObject=3]="VertexArrayObject",e[e.Shader=4]="Shader",e[e.Program=5]="Program",e[e.FramebufferObject=6]="FramebufferObject",e[e.Renderbuffer=7]="Renderbuffer",e[e.TransformFeedback=8]="TransformFeedback",e[e.Sync=9]="Sync",e[e.UNCOUNTED=10]="UNCOUNTED",e[e.LinesOfCode=10]="LinesOfCode",e[e.Uniform=11]="Uniform",e[e.COUNT=12]="COUNT"}(O||(O={})),function(e){e[e.NONE=0]="NONE",e[e.BACK=1029]="BACK"}(x||(x={}));const D=36064,b=36065,L=36066,U=33306,w=36096,F=36128;var y,B,G,H,V,z,W,k,X;!function(e){e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC"}(y||(y={})),function(e){e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT=5124]="INT",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY"}(B||(B={})),function(e){e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS"}(G||(G={})),function(e){e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED"}(H||(H={})),function(e){e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED"}(V||(V={})),function(e){e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE"}(z||(z={})),function(e){e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT"}(W||(W={})),function(e){e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL"}(k||(k={})),function(e){e[e.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR"}(X||(X={}))},51423:function(e,t,n){n.d(t,{S:function(){return r}});var i=n(65650);function r(e){switch(e){case i.g.BYTE:case i.g.UNSIGNED_BYTE:return 1;case i.g.SHORT:case i.g.UNSIGNED_SHORT:case i.g.HALF_FLOAT:return 2;case i.g.FLOAT:case i.g.INT:case i.g.UNSIGNED_INT:return 4}}},51135:function(e,t,n){n.d(t,{IH:function(){return u},LW:function(){return c},Rd:function(){return h},Zo:function(){return l},_x:function(){return a},ck:function(){return p},gf:function(){return m},if:function(){return s},jp:function(){return q},sg:function(){return f},sm:function(){return P},vf:function(){return d},wK:function(){return o},zp:function(){return _}});var i=n(32420),r=n(65650);function s(e,t,n=r.db.ADD,i=[0,0,0,0]){return{srcRgb:e,srcAlpha:e,dstRgb:t,dstAlpha:t,opRgb:n,opAlpha:n,color:{r:i[0],g:i[1],b:i[2],a:i[3]}}}function o(e,t,n,i,s=r.db.ADD,o=r.db.ADD,a=[0,0,0,0]){return{srcRgb:e,srcAlpha:t,dstRgb:n,dstAlpha:i,opRgb:s,opAlpha:o,color:{r:a[0],g:a[1],b:a[2],a:a[3]}}}const a=s(r.zi.ZERO,r.zi.ONE_MINUS_SRC_ALPHA),c=s(r.zi.ONE,r.zi.ZERO),u=s(r.zi.ONE,r.zi.ONE),l=s(r.zi.ONE,r.zi.ONE_MINUS_SRC_ALPHA),d=o(r.zi.SRC_ALPHA,r.zi.ONE,r.zi.ONE_MINUS_SRC_ALPHA,r.zi.ONE_MINUS_SRC_ALPHA),h={face:r.LR.BACK,mode:r.Wf.CCW},f={face:r.LR.FRONT,mode:r.Wf.CCW},_=e=>e===i.Vr.Back?h:e===i.Vr.Front?f:null,p={zNear:0,zFar:1},m={r:!0,g:!0,b:!0,a:!0};function E(e){return O.intern(e)}function T(e){return D.intern(e)}function g(e){return L.intern(e)}function A(e){return w.intern(e)}function R(e){return y.intern(e)}function v(e){return G.intern(e)}function S(e){return V.intern(e)}function I(e){return W.intern(e)}function N(e){return X.intern(e)}function P(e){return Y.intern(e)}class M{constructor(e,t){this._makeKey=e,this._makeRef=t,this._interns=new Map}intern(e){if(!e)return null;const t=this._makeKey(e),n=this._interns;return n.has(t)||n.set(t,this._makeRef(e)),n.get(t)??null}}function C(e){return"["+e.join(",")+"]"}const O=new M(x,(e=>({__tag:"Blending",...e})));function x(e){return e?C([e.srcRgb,e.srcAlpha,e.dstRgb,e.dstAlpha,e.opRgb,e.opAlpha,e.color.r,e.color.g,e.color.b,e.color.a]):null}const D=new M(b,(e=>({__tag:"Culling",...e})));function b(e){return e?C([e.face,e.mode]):null}const L=new M(U,(e=>({__tag:"PolygonOffset",...e})));function U(e){return e?C([e.factor,e.units]):null}const w=new M(F,(e=>({__tag:"DepthTest",...e})));function F(e){return e?C([e.func]):null}const y=new M(B,(e=>({__tag:"StencilTest",...e})));function B(e){return e?C([e.function.func,e.function.ref,e.function.mask,e.operation.fail,e.operation.zFail,e.operation.zPass]):null}const G=new M(H,(e=>({__tag:"DepthWrite",...e})));function H(e){return e?C([e.zNear,e.zFar]):null}const V=new M(z,(e=>({__tag:"ColorWrite",...e})));function z(e){return e?C([e.r,e.g,e.b,e.a]):null}const W=new M(k,(e=>({__tag:"StencilWrite",...e})));function k(e){return e?C([e.mask]):null}const X=new M($,(e=>({__tag:"DrawBuffers",...e})));function $(e){return e?C(e.buffers):null}const Y=new M((function(e){return e?C([x(e.blending),b(e.culling),U(e.polygonOffset),F(e.depthTest),B(e.stencilTest),H(e.depthWrite),z(e.colorWrite),k(e.stencilWrite),$(e.drawBuffers)]):null}),(e=>({blending:E(e.blending),culling:T(e.culling),polygonOffset:g(e.polygonOffset),depthTest:A(e.depthTest),stencilTest:R(e.stencilTest),depthWrite:v(e.depthWrite),colorWrite:S(e.colorWrite),stencilWrite:I(e.stencilWrite),drawBuffers:N(e.drawBuffers)})));class q{constructor(e){this._pipelineInvalid=!0,this._blendingInvalid=!0,this._cullingInvalid=!0,this._polygonOffsetInvalid=!0,this._depthTestInvalid=!0,this._stencilTestInvalid=!0,this._depthWriteInvalid=!0,this._colorWriteInvalid=!0,this._stencilWriteInvalid=!0,this._drawBuffersInvalid=!0,this._stateSetters=e}setPipeline(e){(this._pipelineInvalid||e!==this._pipeline)&&(this._setBlending(e.blending),this._setCulling(e.culling),this._setPolygonOffset(e.polygonOffset),this._setDepthTest(e.depthTest),this._setStencilTest(e.stencilTest),this._setDepthWrite(e.depthWrite),this._setColorWrite(e.colorWrite),this._setStencilWrite(e.stencilWrite),this._setDrawBuffers(e.drawBuffers),this._pipeline=e),this._pipelineInvalid=!1}invalidateBlending(){this._blendingInvalid=!0,this._pipelineInvalid=!0}invalidateCulling(){this._cullingInvalid=!0,this._pipelineInvalid=!0}invalidatePolygonOffset(){this._polygonOffsetInvalid=!0,this._pipelineInvalid=!0}invalidateDepthTest(){this._depthTestInvalid=!0,this._pipelineInvalid=!0}invalidateStencilTest(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}invalidateDepthWrite(){this._depthWriteInvalid=!0,this._pipelineInvalid=!0}invalidateColorWrite(){this._colorWriteInvalid=!0,this._pipelineInvalid=!0}invalidateStencilWrite(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}invalidateDrawBuffers(){this._drawBuffersInvalid=!0,this._pipelineInvalid=!0}_setBlending(e){this._blending=this._setSubState(e,this._blending,this._blendingInvalid,this._stateSetters.setBlending),this._blendingInvalid=!1}_setCulling(e){this._culling=this._setSubState(e,this._culling,this._cullingInvalid,this._stateSetters.setCulling),this._cullingInvalid=!1}_setPolygonOffset(e){this._polygonOffset=this._setSubState(e,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset),this._polygonOffsetInvalid=!1}_setDepthTest(e){this._depthTest=this._setSubState(e,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest),this._depthTestInvalid=!1}_setStencilTest(e){this._stencilTest=this._setSubState(e,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest),this._stencilTestInvalid=!1}_setDepthWrite(e){this._depthWrite=this._setSubState(e,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite),this._depthWriteInvalid=!1}_setColorWrite(e){this._colorWrite=this._setSubState(e,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite),this._colorWriteInvalid=!1}_setStencilWrite(e){this._stencilWrite=this._setSubState(e,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite),this._stencilTestInvalid=!1}_setDrawBuffers(e){this._drawBuffers=this._setSubState(e,this._drawBuffers,this._drawBuffersInvalid,this._stateSetters.setDrawBuffers),this._drawBuffersInvalid=!1}_setSubState(e,t,n,i){return(n||e!==t)&&(i(e),this._pipelineInvalid=!0),e}}},42377:function(e,t,n){n.d(t,{E:function(){return f},M4:function(){return u},QY:function(){return a},Sn:function(){return m},av:function(){return c},eE:function(){return p},gP:function(){return d},px:function(){return _},t_:function(){return E},w1:function(){return h},xR:function(){return l}});var i=n(88194),r=n(96711),s=n(65650);const o=()=>r.Z.getLogger("esri/views/webgl/textureUtils");function a(e){const{width:t,height:n,depth:i}=e;(null!=t&&t<0||null!=n&&n<0||null!=i&&i<0)&&o().error("Negative dimension parameters are not allowed!");const{internalFormat:r}=e;if(r&&(u(r)||l(r))){const{linearFilterDepth:t,compareEnabled:n,samplingMode:i,hasMipmap:r}=e;r&&o().error("Depth textures cannot have mipmaps"),t?i!==s.cw.LINEAR&&i!==s.cw.NEAREST&&o().error("Depth textures cannot sample mipmaps"):(i!==s.cw.NEAREST&&o().error("Depth textures without filtering must use NEAREST filtering"),n&&o().error("Depth textures without filtering cannot use compare function"))}}function c(e){return e in s.lP}function u(e){return e in s.DM}function l(e){return e in s.wo}function d(e){return null!=e&&e in s.q_}function h(e){return null!=e&&"type"in e&&"compressed"===e.type}function f(e){return null!=e&&!h(e)&&!function(e){return null!=e&&"byteLength"in e}(e)}function _(e){return e===s.No.TEXTURE_3D||e===s.No.TEXTURE_2D_ARRAY}function p(e,t,n,i=1){let r=Math.max(t,n);return e===s.No.TEXTURE_3D&&(r=Math.max(r,i)),Math.floor(Math.log2(r))+1}function m(e){if(null!=e.internalFormat)return e.internalFormat;switch(e.dataType){case s.Br.FLOAT:switch(e.pixelFormat){case s.VI.RGBA:return s.lP.RGBA32F;case s.VI.RGB:return s.lP.RGB32F;default:throw new i.Z("texture:unknown-format","Unable to derive format")}case s.Br.UNSIGNED_BYTE:switch(e.pixelFormat){case s.VI.RGBA:return s.lP.RGBA8;case s.VI.RGB:return s.lP.RGB8}}const{pixelFormat:t}=e;return e.internalFormat=t===s.N2.DEPTH_STENCIL?s.wo.DEPTH24_STENCIL8:t===s.N2.DEPTH_COMPONENT?s.DM.DEPTH_COMPONENT24:t,e.internalFormat}function E(e){let t="width"in e?e.width:e.codedWidth,n="height"in e?e.height:e.codedHeight;return e instanceof HTMLVideoElement&&(t=e.videoWidth,n=e.videoHeight),{width:t,height:n,depth:1}}},64801:function(e,t,n){n.d(t,{e:function(){return i}});const i=1/255.5}}]);